---
layout: default
permalink: /study
---

<style>
.study-container {
  display: flex;
  gap: 20px;
  min-height: 600px;
}

.study-sidebar {
  width: 280px;
  flex-shrink: 0;
  border-right: 1px solid #e0e0e0;
  padding-right: 20px;
  max-height: 80vh;
  overflow-y: auto;
}

.study-content {
  flex: 1;
  min-width: 0;
  max-height: 80vh;
  overflow-y: auto;
  padding-right: 10px;
}

.study-header {
  margin-bottom: 20px;
}

.study-header h2 {
  margin-bottom: 10px;
}

.study-header .github-link {
  font-size: 0.9em;
  color: #666;
}

.study-header .github-link a {
  color: #333;
}

/* Tree Navigation */
.category-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.category-item {
  margin-bottom: 5px;
}

.category-title {
  display: flex;
  align-items: center;
  padding: 8px 10px;
  cursor: pointer;
  border-radius: 4px;
  transition: background 0.2s;
  font-weight: 500;
}

.category-title:hover {
  background: #f5f5f5;
}

.category-title.active {
  background: #e8f4f8;
}

.category-title .toggle {
  margin-right: 8px;
  font-size: 0.8em;
  width: 12px;
}

.category-title .name {
  flex: 1;
}

.category-title .count {
  font-size: 0.8em;
  color: #888;
}

.file-list {
  list-style: none;
  padding-left: 25px;
  margin: 5px 0;
  display: none;
}

.file-list.expanded {
  display: block;
}

.file-item {
  padding: 5px 10px;
  cursor: pointer;
  border-radius: 4px;
  font-size: 0.9em;
  transition: background 0.2s;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.file-item:hover {
  background: #f5f5f5;
}

.file-item.active {
  background: #e8f4f8;
  font-weight: 500;
}

/* Content Area */
.content-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 400px;
  color: #888;
  text-align: center;
}

.content-placeholder i {
  font-size: 3em;
  margin-bottom: 15px;
  display: block;
}

.loading-spinner {
  text-align: center;
  padding: 40px;
  color: #666;
}

.loading-spinner i {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.markdown-content {
  line-height: 1.7;
}

.markdown-content h1,
.markdown-content h2,
.markdown-content h3,
.markdown-content h4 {
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  border-bottom: 1px solid #eee;
  padding-bottom: 0.3em;
}

.markdown-content h1:first-child {
  margin-top: 0;
}

.markdown-content pre {
  background: #f6f8fa;
  padding: 15px;
  border-radius: 6px;
  overflow-x: auto;
  font-size: 0.9em;
}

.markdown-content code {
  background: #f0f0f0;
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 0.9em;
}

.markdown-content pre code {
  background: none;
  padding: 0;
}

.markdown-content blockquote {
  border-left: 4px solid #ddd;
  margin: 1em 0;
  padding-left: 15px;
  color: #666;
}

.markdown-content table {
  border-collapse: collapse;
  width: 100%;
  margin: 1em 0;
}

.markdown-content th,
.markdown-content td {
  border: 1px solid #ddd;
  padding: 8px 12px;
  text-align: left;
}

.markdown-content th {
  background: #f6f8fa;
}

.markdown-content img {
  max-width: 100%;
  height: auto;
}

.error-message {
  background: #fff3cd;
  border: 1px solid #ffc107;
  border-radius: 6px;
  padding: 20px;
  text-align: center;
}

.error-message a {
  display: inline-block;
  margin-top: 10px;
  color: #007bff;
}

.file-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #333;
}

.file-header h3 {
  margin: 0;
  font-size: 1.2em;
}

.file-header .github-btn {
  font-size: 0.85em;
  color: #666;
  text-decoration: none;
  padding: 5px 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  transition: all 0.2s;
}

.file-header .github-btn:hover {
  background: #f5f5f5;
  border-color: #333;
  color: #333;
}

/* Rate limit warning */
.rate-limit-warning {
  background: #fff3cd;
  padding: 10px 15px;
  border-radius: 4px;
  font-size: 0.85em;
  margin-bottom: 15px;
}

/* Responsive */
@media (max-width: 768px) {
  .study-container {
    flex-direction: column;
  }

  .study-sidebar {
    width: 100%;
    border-right: none;
    border-bottom: 1px solid #e0e0e0;
    padding-right: 0;
    padding-bottom: 15px;
    max-height: 300px;
  }

  .study-content {
    max-height: none;
  }
}
</style>

<section class="section study-section">
  <div class="study-header">
    <h2 class="section-title"><i class="fas fa-graduation-cap"></i> Study with AI</h2>
    <p class="github-link">
      <a href="https://github.com/eunsu-park/study-with-ai" target="_blank">
        <i class="fab fa-github"></i> View on GitHub
      </a>
    </p>
  </div>

  <div id="rate-limit-warning" class="rate-limit-warning" style="display: none;">
    <i class="fas fa-exclamation-triangle"></i>
    <span id="rate-limit-text"></span>
  </div>

  <div class="study-container">
    <div class="study-sidebar">
      <div id="category-loading" class="loading-spinner">
        <i class="fas fa-spinner"></i> Loading categories...
      </div>
      <ul id="category-list" class="category-list"></ul>
    </div>

    <div class="study-content">
      <div id="content-area">
        <div class="content-placeholder">
          <div>
            <i class="fas fa-book-open"></i>
            <p>Select a file from the left to view its content</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Marked.js for Markdown rendering -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
(function() {
  const REPO = 'eunsu-park/study-with-ai';
  const API_BASE = 'https://api.github.com/repos/' + REPO + '/contents';
  const RAW_BASE = 'https://raw.githubusercontent.com/' + REPO + '/main';
  const GITHUB_BASE = 'https://github.com/' + REPO + '/blob/main';

  const CACHE_KEY = 'study-with-ai-cache';
  const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours

  // Cache utilities
  function getCache(key) {
    try {
      const cache = JSON.parse(localStorage.getItem(CACHE_KEY) || '{}');
      const item = cache[key];
      if (item && (Date.now() - item.timestamp < CACHE_DURATION)) {
        return item.data;
      }
    } catch (e) {}
    return null;
  }

  function setCache(key, data) {
    try {
      const cache = JSON.parse(localStorage.getItem(CACHE_KEY) || '{}');
      cache[key] = { data, timestamp: Date.now() };
      localStorage.setItem(CACHE_KEY, JSON.stringify(cache));
    } catch (e) {}
  }

  // Check rate limit
  function checkRateLimit(response) {
    const remaining = response.headers.get('X-RateLimit-Remaining');
    const limit = response.headers.get('X-RateLimit-Limit');

    if (remaining !== null && parseInt(remaining) < 10) {
      const warning = document.getElementById('rate-limit-warning');
      const text = document.getElementById('rate-limit-text');
      warning.style.display = 'block';
      text.textContent = `API rate limit: ${remaining}/${limit} requests remaining. Data is cached for 24 hours.`;
    }
  }

  // Fetch with cache
  async function fetchWithCache(url, cacheKey) {
    const cached = getCache(cacheKey);
    if (cached) return cached;

    const response = await fetch(url);
    checkRateLimit(response);

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }

    const data = await response.json();
    setCache(cacheKey, data);
    return data;
  }

  // Fetch raw content
  async function fetchRawContent(path) {
    const cacheKey = 'raw:' + path;
    const cached = getCache(cacheKey);
    if (cached) return cached;

    const response = await fetch(RAW_BASE + '/' + path);
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }

    const text = await response.text();
    setCache(cacheKey, text);
    return text;
  }

  // Load categories
  async function loadCategories() {
    const loadingEl = document.getElementById('category-loading');
    const listEl = document.getElementById('category-list');

    try {
      const items = await fetchWithCache(API_BASE, 'root');
      const folders = items
        .filter(item => item.type === 'dir' && !item.name.startsWith('.'))
        .sort((a, b) => a.name.localeCompare(b.name));

      loadingEl.style.display = 'none';

      folders.forEach(folder => {
        const li = document.createElement('li');
        li.className = 'category-item';
        li.innerHTML = `
          <div class="category-title" data-folder="${folder.name}">
            <span class="toggle"><i class="fas fa-chevron-right"></i></span>
            <span class="name">${folder.name.replace(/_/g, ' ')}</span>
            <span class="count"></span>
          </div>
          <ul class="file-list" id="files-${folder.name}"></ul>
        `;
        listEl.appendChild(li);

        li.querySelector('.category-title').addEventListener('click', function() {
          toggleCategory(folder.name, this);
        });
      });

    } catch (error) {
      loadingEl.innerHTML = `
        <div class="error-message">
          <i class="fas fa-exclamation-circle"></i>
          <p>Failed to load categories</p>
          <a href="https://github.com/${REPO}" target="_blank">View on GitHub</a>
        </div>
      `;
    }
  }

  // Toggle category
  async function toggleCategory(folderName, titleEl) {
    const fileList = document.getElementById('files-' + folderName);
    const toggle = titleEl.querySelector('.toggle i');

    if (fileList.classList.contains('expanded')) {
      fileList.classList.remove('expanded');
      titleEl.classList.remove('active');
      toggle.className = 'fas fa-chevron-right';
      return;
    }

    // Close other categories
    document.querySelectorAll('.file-list.expanded').forEach(el => {
      el.classList.remove('expanded');
    });
    document.querySelectorAll('.category-title.active').forEach(el => {
      el.classList.remove('active');
      el.querySelector('.toggle i').className = 'fas fa-chevron-right';
    });

    fileList.classList.add('expanded');
    titleEl.classList.add('active');
    toggle.className = 'fas fa-chevron-down';

    // Load files if not already loaded
    if (!fileList.dataset.loaded) {
      fileList.innerHTML = '<li class="loading-spinner"><i class="fas fa-spinner"></i></li>';

      try {
        const items = await fetchWithCache(API_BASE + '/' + folderName, 'folder:' + folderName);
        const files = items
          .filter(item => item.name.endsWith('.md'))
          .sort((a, b) => a.name.localeCompare(b.name));

        // Update count
        titleEl.querySelector('.count').textContent = `(${files.length})`;

        fileList.innerHTML = '';
        files.forEach(file => {
          const li = document.createElement('li');
          li.className = 'file-item';
          li.textContent = file.name.replace('.md', '').replace(/_/g, ' ');
          li.dataset.path = folderName + '/' + file.name;
          li.addEventListener('click', () => loadFile(file.path, li));
          fileList.appendChild(li);
        });

        fileList.dataset.loaded = 'true';

      } catch (error) {
        fileList.innerHTML = `
          <li class="error-message" style="margin: 10px 0; padding: 10px;">
            Failed to load files.
            <a href="${GITHUB_BASE}/${folderName}" target="_blank">View on GitHub</a>
          </li>
        `;
      }
    }
  }

  // Load file content
  async function loadFile(path, fileEl) {
    // Update active state
    document.querySelectorAll('.file-item.active').forEach(el => {
      el.classList.remove('active');
    });
    fileEl.classList.add('active');

    const contentArea = document.getElementById('content-area');
    contentArea.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner"></i> Loading content...</div>';

    try {
      const content = await fetchRawContent(path);
      const fileName = path.split('/').pop().replace('.md', '').replace(/_/g, ' ');

      contentArea.innerHTML = `
        <div class="file-header">
          <h3>${fileName}</h3>
          <a href="${GITHUB_BASE}/${path}" target="_blank" class="github-btn">
            <i class="fab fa-github"></i> View on GitHub
          </a>
        </div>
        <div class="markdown-content">${marked.parse(content)}</div>
      `;

    } catch (error) {
      contentArea.innerHTML = `
        <div class="error-message">
          <i class="fas fa-exclamation-circle"></i>
          <p>Failed to load content</p>
          <a href="${GITHUB_BASE}/${path}" target="_blank">View on GitHub</a>
        </div>
      `;
    }
  }

  // Initialize
  loadCategories();
})();
</script>
