{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPC (Virtual Private Cloud) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Cloud_Computing/">Cloud Computing</a>
    <span class="separator">/</span>
    <span class="current">VPC (Virtual Private Cloud)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>VPC (Virtual Private Cloud)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Cloud_Computing/08_Block_and_File_Storage.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Block and File Storage (EBS/EFS vs Persistent Disk/Filestore)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Cloud_Computing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Cloud_Computing/10_Load_Balancing_CDN.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Load Balancing & CDN</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#1-vpc-overview">1. VPC Overview</a><ul>
<li><a href="#11-what-is-vpc">1.1 What is VPC?</a></li>
<li><a href="#12-aws-vs-gcp-vpc-differences">1.2 AWS vs GCP VPC Differences</a></li>
</ul>
</li>
<li><a href="#2-subnets">2. Subnets</a><ul>
<li><a href="#21-public-vs-private-subnets">2.1 Public vs Private Subnets</a></li>
<li><a href="#22-aws-subnet-creation">2.2 AWS Subnet Creation</a></li>
<li><a href="#23-gcp-subnet-creation">2.3 GCP Subnet Creation</a></li>
</ul>
</li>
<li><a href="#3-internet-gateway">3. Internet Gateway</a><ul>
<li><a href="#31-aws-internet-gateway">3.1 AWS Internet Gateway</a></li>
<li><a href="#32-gcp-internet-access">3.2 GCP Internet Access</a></li>
</ul>
</li>
<li><a href="#4-nat-gateway">4. NAT Gateway</a><ul>
<li><a href="#41-aws-nat-gateway">4.1 AWS NAT Gateway</a></li>
<li><a href="#42-gcp-cloud-nat">4.2 GCP Cloud NAT</a></li>
</ul>
</li>
<li><a href="#5-security-groups-firewalls">5. Security Groups / Firewalls</a><ul>
<li><a href="#51-aws-security-groups">5.1 AWS Security Groups</a></li>
<li><a href="#52-gcp-firewall-rules">5.2 GCP Firewall Rules</a></li>
<li><a href="#53-aws-nacl-network-acl">5.3 AWS NACL (Network ACL)</a></li>
</ul>
</li>
<li><a href="#6-vpc-peering">6. VPC Peering</a><ul>
<li><a href="#61-aws-vpc-peering">6.1 AWS VPC Peering</a></li>
<li><a href="#62-gcp-vpc-peering">6.2 GCP VPC Peering</a></li>
</ul>
</li>
<li><a href="#7-private-endpoints">7. Private Endpoints</a><ul>
<li><a href="#71-aws-vpc-endpoints">7.1 AWS VPC Endpoints</a></li>
<li><a href="#72-gcp-private-service-connect">7.2 GCP Private Service Connect</a></li>
</ul>
</li>
<li><a href="#8-common-vpc-architectures">8. Common VPC Architectures</a><ul>
<li><a href="#81-3-tier-architecture">8.1 3-Tier Architecture</a></li>
<li><a href="#82-aws-vpc-example-terraform">8.2 AWS VPC Example (Terraform)</a></li>
</ul>
</li>
<li><a href="#9-troubleshooting">9. Troubleshooting</a><ul>
<li><a href="#91-connection-issue-checklist">9.1 Connection Issue Checklist</a></li>
<li><a href="#92-debugging-commands">9.2 Debugging Commands</a></li>
</ul>
</li>
<li><a href="#10-next-steps">10. Next Steps</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="vpc-virtual-private-cloud">VPC (Virtual Private Cloud)<a class="header-link" href="#vpc-virtual-private-cloud" title="Permanent link">&para;</a></h1>
<h2 id="1-vpc-overview">1. VPC Overview<a class="header-link" href="#1-vpc-overview" title="Permanent link">&para;</a></h2>
<h3 id="11-what-is-vpc">1.1 What is VPC?<a class="header-link" href="#11-what-is-vpc" title="Permanent link">&para;</a></h3>
<p>VPC is a logically isolated virtual network within the cloud.</p>
<p><strong>Core Concepts:</strong>
- Define your own IP address range
- Divide into subnets
- Control traffic with routing tables
- Access control with security groups/firewalls</p>
<h3 id="12-aws-vs-gcp-vpc-differences">1.2 AWS vs GCP VPC Differences<a class="header-link" href="#12-aws-vs-gcp-vpc-differences" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>AWS VPC</th>
<th>GCP VPC</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Scope</strong></td>
<td>Regional</td>
<td><strong>Global</strong></td>
</tr>
<tr>
<td><strong>Subnet Scope</strong></td>
<td>Availability Zone (AZ)</td>
<td>Regional</td>
</tr>
<tr>
<td><strong>Default VPC</strong></td>
<td>1 per region</td>
<td>1 per project (default)</td>
</tr>
<tr>
<td><strong>Peering</strong></td>
<td>Cross-region possible</td>
<td>Global automatic</td>
</tr>
<tr>
<td><strong>IP Range</strong></td>
<td>Fixed at creation</td>
<td>Subnets can be added</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code>AWS VPC Structure:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VPC (Region: ap-northeast-2)                                â”‚
â”‚  CIDR: 10.0.0.0/16                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Subnet-a (AZ-a)     â”‚  â”‚ Subnet-b (AZ-b)     â”‚            â”‚
â”‚  â”‚ 10.0.1.0/24         â”‚  â”‚ 10.0.2.0/24         â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

GCP VPC Structure:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VPC (Global)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Subnet-asia         â”‚  â”‚ Subnet-us           â”‚            â”‚
â”‚  â”‚ (asia-northeast3)   â”‚  â”‚ (us-central1)       â”‚            â”‚
â”‚  â”‚ 10.0.1.0/24         â”‚  â”‚ 10.0.2.0/24         â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-subnets">2. Subnets<a class="header-link" href="#2-subnets" title="Permanent link">&para;</a></h2>
<h3 id="21-public-vs-private-subnets">2.1 Public vs Private Subnets<a class="header-link" href="#21-public-vs-private-subnets" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>Internet Access</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Public</strong></td>
<td>Direct access</td>
<td>Web servers, Bastion</td>
</tr>
<tr>
<td><strong>Private</strong></td>
<td>Only through NAT</td>
<td>Applications, Databases</td>
</tr>
</tbody>
</table>
<h3 id="22-aws-subnet-creation">2.2 AWS Subnet Creation<a class="header-link" href="#22-aws-subnet-creation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. VPC ìƒì„±</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr-block<span class="w"> </span><span class="m">10</span>.0.0.0/16<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tag-specifications<span class="w"> </span><span class="s1">&#39;ResourceType=vpc,Tags=[{Key=Name,Value=MyVPC}]&#39;</span>

<span class="c1"># 2. í¼ë¸”ë¦­ ì„œë¸Œë„· ìƒì„±</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-subnet<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr-block<span class="w"> </span><span class="m">10</span>.0.1.0/24<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--availability-zone<span class="w"> </span>ap-northeast-2a<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tag-specifications<span class="w"> </span><span class="s1">&#39;ResourceType=subnet,Tags=[{Key=Name,Value=Public-Subnet-1}]&#39;</span>

<span class="c1"># 3. í”„ë¼ì´ë¹— ì„œë¸Œë„· ìƒì„±</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-subnet<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr-block<span class="w"> </span><span class="m">10</span>.0.10.0/24<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--availability-zone<span class="w"> </span>ap-northeast-2a<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tag-specifications<span class="w"> </span><span class="s1">&#39;ResourceType=subnet,Tags=[{Key=Name,Value=Private-Subnet-1}]&#39;</span>

<span class="c1"># 4. í¼ë¸”ë¦­ IP ìë™ í• ë‹¹ (í¼ë¸”ë¦­ ì„œë¸Œë„·)</span>
aws<span class="w"> </span>ec2<span class="w"> </span>modify-subnet-attribute<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet-id<span class="w"> </span>subnet-public<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--map-public-ip-on-launch
</code></pre></div>

<h3 id="23-gcp-subnet-creation">2.3 GCP Subnet Creation<a class="header-link" href="#23-gcp-subnet-creation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. ì»¤ìŠ¤í…€ ëª¨ë“œ VPC ìƒì„±</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>create<span class="w"> </span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet-mode<span class="o">=</span>custom

<span class="c1"># 2. ì„œë¸Œë„· ìƒì„± (ì„œìš¸)</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>subnets<span class="w"> </span>create<span class="w"> </span>subnet-asia<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--range<span class="o">=</span><span class="m">10</span>.0.1.0/24

<span class="c1"># 3. ì„œë¸Œë„· ìƒì„± (ë¯¸êµ­)</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>subnets<span class="w"> </span>create<span class="w"> </span>subnet-us<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>us-central1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--range<span class="o">=</span><span class="m">10</span>.0.2.0/24

<span class="c1"># 4. í”„ë¼ì´ë¹— Google ì•¡ì„¸ìŠ¤ í™œì„±í™”</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>subnets<span class="w"> </span>update<span class="w"> </span>subnet-asia<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--enable-private-ip-google-access
</code></pre></div>

<hr />
<h2 id="3-internet-gateway">3. Internet Gateway<a class="header-link" href="#3-internet-gateway" title="Permanent link">&para;</a></h2>
<h3 id="31-aws-internet-gateway">3.1 AWS Internet Gateway<a class="header-link" href="#31-aws-internet-gateway" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. IGW ìƒì„±</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-internet-gateway<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tag-specifications<span class="w"> </span><span class="s1">&#39;ResourceType=internet-gateway,Tags=[{Key=Name,Value=MyIGW}]&#39;</span>

<span class="c1"># 2. VPCì— ì—°ê²°</span>
aws<span class="w"> </span>ec2<span class="w"> </span>attach-internet-gateway<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--internet-gateway-id<span class="w"> </span>igw-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678

<span class="c1"># 3. ë¼ìš°íŒ… í…Œì´ë¸”ì— ê²½ë¡œ ì¶”ê°€</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-route<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--route-table-id<span class="w"> </span>rtb-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination-cidr-block<span class="w"> </span><span class="m">0</span>.0.0.0/0<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--gateway-id<span class="w"> </span>igw-12345678

<span class="c1"># 4. í¼ë¸”ë¦­ ì„œë¸Œë„·ì— ë¼ìš°íŒ… í…Œì´ë¸” ì—°ê²°</span>
aws<span class="w"> </span>ec2<span class="w"> </span>associate-route-table<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--route-table-id<span class="w"> </span>rtb-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet-id<span class="w"> </span>subnet-public
</code></pre></div>

<h3 id="32-gcp-internet-access">3.2 GCP Internet Access<a class="header-link" href="#32-gcp-internet-access" title="Permanent link">&para;</a></h3>
<p>GCP allows internet access without a separate internet gateway if an external IP is present.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ì™¸ë¶€ IP í• ë‹¹ (ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œ)</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>instances<span class="w"> </span>create<span class="w"> </span>my-instance<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--zone<span class="o">=</span>asia-northeast3-a<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet<span class="o">=</span>subnet-asia<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--address<span class="o">=</span>EXTERNAL_IP<span class="w">  </span><span class="c1"># ë˜ëŠ” ìƒëµí•˜ë©´ ì„ì‹œ IP í• ë‹¹</span>

<span class="c1"># ì •ì  IP ì˜ˆì•½</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>addresses<span class="w"> </span>create<span class="w"> </span>my-static-ip<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3
</code></pre></div>

<hr />
<h2 id="4-nat-gateway">4. NAT Gateway<a class="header-link" href="#4-nat-gateway" title="Permanent link">&para;</a></h2>
<p>Allows instances in private subnets to access the internet.</p>
<h3 id="41-aws-nat-gateway">4.1 AWS NAT Gateway<a class="header-link" href="#41-aws-nat-gateway" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Elastic IP í• ë‹¹</span>
aws<span class="w"> </span>ec2<span class="w"> </span>allocate-address<span class="w"> </span>--domain<span class="w"> </span>vpc

<span class="c1"># 2. NAT Gateway ìƒì„± (í¼ë¸”ë¦­ ì„œë¸Œë„·ì—)</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-nat-gateway<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet-id<span class="w"> </span>subnet-public<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--allocation-id<span class="w"> </span>eipalloc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tag-specifications<span class="w"> </span><span class="s1">&#39;ResourceType=natgateway,Tags=[{Key=Name,Value=MyNAT}]&#39;</span>

<span class="c1"># 3. í”„ë¼ì´ë¹— ë¼ìš°íŒ… í…Œì´ë¸”ì— ê²½ë¡œ ì¶”ê°€</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-route<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--route-table-id<span class="w"> </span>rtb-private<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination-cidr-block<span class="w"> </span><span class="m">0</span>.0.0.0/0<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--nat-gateway-id<span class="w"> </span>nat-12345678

<span class="c1"># 4. í”„ë¼ì´ë¹— ì„œë¸Œë„·ì— ë¼ìš°íŒ… í…Œì´ë¸” ì—°ê²°</span>
aws<span class="w"> </span>ec2<span class="w"> </span>associate-route-table<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--route-table-id<span class="w"> </span>rtb-private<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet-id<span class="w"> </span>subnet-private
</code></pre></div>

<h3 id="42-gcp-cloud-nat">4.2 GCP Cloud NAT<a class="header-link" href="#42-gcp-cloud-nat" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Cloud Router ìƒì„±</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>routers<span class="w"> </span>create<span class="w"> </span>my-router<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3

<span class="c1"># 2. Cloud NAT ìƒì„±</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>routers<span class="w"> </span>nats<span class="w"> </span>create<span class="w"> </span>my-nat<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--router<span class="o">=</span>my-router<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--auto-allocate-nat-external-ips<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--nat-all-subnet-ip-ranges
</code></pre></div>

<hr />
<h2 id="5-security-groups-firewalls">5. Security Groups / Firewalls<a class="header-link" href="#5-security-groups-firewalls" title="Permanent link">&para;</a></h2>
<h3 id="51-aws-security-groups">5.1 AWS Security Groups<a class="header-link" href="#51-aws-security-groups" title="Permanent link">&para;</a></h3>
<p>Security groups are instance-level <strong>stateful</strong> firewalls.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ë³´ì•ˆ ê·¸ë£¹ ìƒì„±</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-security-group<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--group-name<span class="w"> </span>web-sg<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--description<span class="w"> </span><span class="s2">&quot;Web server security group&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678

<span class="c1"># ì¸ë°”ìš´ë“œ ê·œì¹™ ì¶”ê°€</span>
aws<span class="w"> </span>ec2<span class="w"> </span>authorize-security-group-ingress<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--group-id<span class="w"> </span>sg-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="w"> </span>tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--port<span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr<span class="w"> </span><span class="m">0</span>.0.0.0/0

aws<span class="w"> </span>ec2<span class="w"> </span>authorize-security-group-ingress<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--group-id<span class="w"> </span>sg-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="w"> </span>tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--port<span class="w"> </span><span class="m">443</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr<span class="w"> </span><span class="m">0</span>.0.0.0/0

aws<span class="w"> </span>ec2<span class="w"> </span>authorize-security-group-ingress<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--group-id<span class="w"> </span>sg-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="w"> </span>tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--port<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr<span class="w"> </span><span class="m">203</span>.0.113.0/24<span class="w">  </span><span class="c1"># íŠ¹ì • IPë§Œ í—ˆìš©</span>

<span class="c1"># ë‹¤ë¥¸ ë³´ì•ˆ ê·¸ë£¹ì—ì„œ ì˜¤ëŠ” íŠ¸ë˜í”½ í—ˆìš©</span>
aws<span class="w"> </span>ec2<span class="w"> </span>authorize-security-group-ingress<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--group-id<span class="w"> </span>sg-db<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="w"> </span>tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--port<span class="w"> </span><span class="m">3306</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--source-group<span class="w"> </span>sg-web

<span class="c1"># ê·œì¹™ ì¡°íšŒ</span>
aws<span class="w"> </span>ec2<span class="w"> </span>describe-security-groups<span class="w"> </span>--group-ids<span class="w"> </span>sg-12345678
</code></pre></div>

<h3 id="52-gcp-firewall-rules">5.2 GCP Firewall Rules<a class="header-link" href="#52-gcp-firewall-rules" title="Permanent link">&para;</a></h3>
<p>GCP firewall rules operate at the VPC level and target resources using <strong>tags</strong> or service accounts.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># HTTP íŠ¸ë˜í”½ í—ˆìš© (íƒœê·¸ ê¸°ë°˜)</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>create<span class="w"> </span>allow-http<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--allow<span class="o">=</span>tcp:80,tcp:443<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--target-tags<span class="o">=</span>http-server<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--source-ranges<span class="o">=</span><span class="m">0</span>.0.0.0/0

<span class="c1"># SSH í—ˆìš© (íŠ¹ì • IP)</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>create<span class="w"> </span>allow-ssh<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--allow<span class="o">=</span>tcp:22<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--target-tags<span class="o">=</span>ssh-server<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--source-ranges<span class="o">=</span><span class="m">203</span>.0.113.0/24

<span class="c1"># ë‚´ë¶€ í†µì‹  í—ˆìš©</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>create<span class="w"> </span>allow-internal<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>my-vpc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--allow<span class="o">=</span>tcp,udp,icmp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--source-ranges<span class="o">=</span><span class="m">10</span>.0.0.0/8

<span class="c1"># ê·œì¹™ ëª©ë¡ ì¡°íšŒ</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>list<span class="w"> </span>--filter<span class="o">=</span><span class="s2">&quot;network:my-vpc&quot;</span>

<span class="c1"># ê·œì¹™ ì‚­ì œ</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>delete<span class="w"> </span>allow-http
</code></pre></div>

<h3 id="53-aws-nacl-network-acl">5.3 AWS NACL (Network ACL)<a class="header-link" href="#53-aws-nacl-network-acl" title="Permanent link">&para;</a></h3>
<p>NACL is a subnet-level <strong>stateless</strong> firewall.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># NACL ìƒì„±</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-network-acl<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tag-specifications<span class="w"> </span><span class="s1">&#39;ResourceType=network-acl,Tags=[{Key=Name,Value=MyNACL}]&#39;</span>

<span class="c1"># ì¸ë°”ìš´ë“œ ê·œì¹™ ì¶”ê°€ (ê·œì¹™ ë²ˆí˜¸ë¡œ ìš°ì„ ìˆœìœ„)</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-network-acl-entry<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network-acl-id<span class="w"> </span>acl-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ingress<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--rule-number<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="w"> </span>tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--port-range<span class="w"> </span><span class="nv">From</span><span class="o">=</span><span class="m">80</span>,To<span class="o">=</span><span class="m">80</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr-block<span class="w"> </span><span class="m">0</span>.0.0.0/0<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--rule-action<span class="w"> </span>allow

<span class="c1"># ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ë„ í•„ìš” (stateless)</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-network-acl-entry<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network-acl-id<span class="w"> </span>acl-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--egress<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--rule-number<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="w"> </span>tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--port-range<span class="w"> </span><span class="nv">From</span><span class="o">=</span><span class="m">1024</span>,To<span class="o">=</span><span class="m">65535</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cidr-block<span class="w"> </span><span class="m">0</span>.0.0.0/0<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--rule-action<span class="w"> </span>allow
</code></pre></div>

<hr />
<h2 id="6-vpc-peering">6. VPC Peering<a class="header-link" href="#6-vpc-peering" title="Permanent link">&para;</a></h2>
<h3 id="61-aws-vpc-peering">6.1 AWS VPC Peering<a class="header-link" href="#61-aws-vpc-peering" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. í”¼ì–´ë§ ì—°ê²° ìš”ì²­</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-vpc-peering-connection<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-requester<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--peer-vpc-id<span class="w"> </span>vpc-accepter<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--peer-region<span class="w"> </span>ap-northeast-1<span class="w">  </span><span class="c1"># ë‹¤ë¥¸ ë¦¬ì „ì¸ ê²½ìš°</span>

<span class="c1"># 2. í”¼ì–´ë§ ì—°ê²° ìˆ˜ë½</span>
aws<span class="w"> </span>ec2<span class="w"> </span>accept-vpc-peering-connection<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-peering-connection-id<span class="w"> </span>pcx-12345678

<span class="c1"># 3. ì–‘ìª½ VPCì˜ ë¼ìš°íŒ… í…Œì´ë¸”ì— ê²½ë¡œ ì¶”ê°€</span>
<span class="c1"># Requester VPC</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-route<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--route-table-id<span class="w"> </span>rtb-requester<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination-cidr-block<span class="w"> </span><span class="m">10</span>.1.0.0/16<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-peering-connection-id<span class="w"> </span>pcx-12345678

<span class="c1"># Accepter VPC</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-route<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--route-table-id<span class="w"> </span>rtb-accepter<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination-cidr-block<span class="w"> </span><span class="m">10</span>.0.0.0/16<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-peering-connection-id<span class="w"> </span>pcx-12345678
</code></pre></div>

<h3 id="62-gcp-vpc-peering">6.2 GCP VPC Peering<a class="header-link" href="#62-gcp-vpc-peering" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. ì²« ë²ˆì§¸ VPCì—ì„œ í”¼ì–´ë§ ìƒì„±</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>peerings<span class="w"> </span>create<span class="w"> </span>peer-vpc1-to-vpc2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>vpc1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--peer-network<span class="o">=</span>vpc2

<span class="c1"># 2. ë‘ ë²ˆì§¸ VPCì—ì„œ í”¼ì–´ë§ ìƒì„± (ì–‘ìª½ í•„ìš”)</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>peerings<span class="w"> </span>create<span class="w"> </span>peer-vpc2-to-vpc1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>vpc2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--peer-network<span class="o">=</span>vpc1

<span class="c1"># ë¼ìš°íŒ…ì€ ìë™ìœ¼ë¡œ ì¶”ê°€ë¨</span>
</code></pre></div>

<hr />
<h2 id="7-private-endpoints">7. Private Endpoints<a class="header-link" href="#7-private-endpoints" title="Permanent link">&para;</a></h2>
<p>Access AWS/GCP services without going through the internet.</p>
<h3 id="71-aws-vpc-endpoints">7.1 AWS VPC Endpoints<a class="header-link" href="#71-aws-vpc-endpoints" title="Permanent link">&para;</a></h3>
<p><strong>Gateway Endpoint (S3, DynamoDB):</strong></p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>ec2<span class="w"> </span>create-vpc-endpoint<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--service-name<span class="w"> </span>com.amazonaws.ap-northeast-2.s3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--route-table-ids<span class="w"> </span>rtb-12345678
</code></pre></div>

<p><strong>Interface Endpoint (Other Services):</strong></p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>ec2<span class="w"> </span>create-vpc-endpoint<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--service-name<span class="w"> </span>com.amazonaws.ap-northeast-2.secretsmanager<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-endpoint-type<span class="w"> </span>Interface<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet-ids<span class="w"> </span>subnet-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--security-group-ids<span class="w"> </span>sg-12345678
</code></pre></div>

<h3 id="72-gcp-private-service-connect">7.2 GCP Private Service Connect<a class="header-link" href="#72-gcp-private-service-connect" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Private Google Access í™œì„±í™”</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>subnets<span class="w"> </span>update<span class="w"> </span>subnet-asia<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--enable-private-ip-google-access

<span class="c1"># Private Service Connect ì—”ë“œí¬ì¸íŠ¸</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>addresses<span class="w"> </span>create<span class="w"> </span>psc-endpoint<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnet<span class="o">=</span>subnet-asia<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--purpose<span class="o">=</span>PRIVATE_SERVICE_CONNECT
</code></pre></div>

<hr />
<h2 id="8-common-vpc-architectures">8. Common VPC Architectures<a class="header-link" href="#8-common-vpc-architectures" title="Permanent link">&para;</a></h2>
<h3 id="81-3-tier-architecture">8.1 3-Tier Architecture<a class="header-link" href="#81-3-tier-architecture" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VPC (10.0.0.0/16)                                           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Public Subnets (10.0.1.0/24, 10.0.2.0/24)               â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚â”‚
â”‚  â”‚  â”‚    ALB      â”‚  â”‚   Bastion   â”‚                        â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                           â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Private Subnets - App (10.0.10.0/24, 10.0.11.0/24)      â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚â”‚
â”‚  â”‚  â”‚   App-1     â”‚  â”‚   App-2     â”‚                        â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                           â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Private Subnets - DB (10.0.20.0/24, 10.0.21.0/24)       â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚â”‚
â”‚  â”‚  â”‚  DB Primary â”‚  â”‚  DB Standby â”‚                        â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚     IGW      â”‚  â”‚   NAT GW     â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="82-aws-vpc-example-terraform">8.2 AWS VPC Example (Terraform)<a class="header-link" href="#82-aws-vpc-example-terraform" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># VPC</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_vpc&quot;</span><span class="w"> </span><span class="nv">&quot;main&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">cidr_block</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;10.0.0.0/16&quot;</span>
<span class="w">  </span><span class="na">enable_dns_hostnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="w">  </span><span class="nb">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="na">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;main-vpc&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Public Subnets</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_subnet&quot;</span><span class="w"> </span><span class="nv">&quot;public&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">count</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="w">  </span><span class="na">vpc_id</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.main.id</span>
<span class="w">  </span><span class="na">cidr_block</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;10.0.${count.index + 1}.0/24&quot;</span>
<span class="w">  </span><span class="na">availability_zone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_availability_zones.available.names[count.index</span><span class="p">]</span>
<span class="w">  </span><span class="na">map_public_ip_on_launch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="w">  </span><span class="nb">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="na">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;public-${count.index + 1}&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Private Subnets</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_subnet&quot;</span><span class="w"> </span><span class="nv">&quot;private&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">count</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="w">  </span><span class="na">vpc_id</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.main.id</span>
<span class="w">  </span><span class="na">cidr_block</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;10.0.${count.index + 10}.0/24&quot;</span>
<span class="w">  </span><span class="na">availability_zone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_availability_zones.available.names[count.index</span><span class="p">]</span>
<span class="w">  </span><span class="nb">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="na">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;private-${count.index + 1}&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Internet Gateway</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_internet_gateway&quot;</span><span class="w"> </span><span class="nv">&quot;main&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">vpc_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.main.id</span>
<span class="p">}</span>

<span class="c1"># NAT Gateway</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_nat_gateway&quot;</span><span class="w"> </span><span class="nv">&quot;main&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">allocation_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_eip.nat.id</span>
<span class="w">  </span><span class="na">subnet_id</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_subnet.public[0].id</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="9-troubleshooting">9. Troubleshooting<a class="header-link" href="#9-troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="91-connection-issue-checklist">9.1 Connection Issue Checklist<a class="header-link" href="#91-connection-issue-checklist" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â–¡ Check security group inbound rules
â–¡ Check NACL rules (AWS)
â–¡ Check firewall rules (GCP)
â–¡ Check routing tables
â–¡ Verify internet gateway attachment
â–¡ Check NAT gateway status
â–¡ Verify instance has public IP
â–¡ Check VPC peering routing
</code></pre></div>

<h3 id="92-debugging-commands">9.2 Debugging Commands<a class="header-link" href="#92-debugging-commands" title="Permanent link">&para;</a></h3>
<p><strong>AWS:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># VPC Flow Logs í™œì„±í™”</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-flow-logs<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--resource-type<span class="w"> </span>VPC<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--resource-ids<span class="w"> </span>vpc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--traffic-type<span class="w"> </span>ALL<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--log-destination-type<span class="w"> </span>cloud-watch-logs<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--log-group-name<span class="w"> </span>vpc-flow-logs

<span class="c1"># Reachability Analyzer</span>
aws<span class="w"> </span>ec2<span class="w"> </span>create-network-insights-path<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--source<span class="w"> </span>i-source<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination<span class="w"> </span>i-destination<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination-port<span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="w"> </span>tcp
</code></pre></div>

<p><strong>GCP:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># VPC Flow Logs í™œì„±í™”</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>subnets<span class="w"> </span>update<span class="w"> </span>subnet-asia<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>asia-northeast3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--enable-flow-logs

<span class="c1"># Connectivity Tests</span>
gcloud<span class="w"> </span>network-management<span class="w"> </span>connectivity-tests<span class="w"> </span>create<span class="w"> </span>my-test<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--source-instance<span class="o">=</span>projects/PROJECT/zones/ZONE/instances/source<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination-instance<span class="o">=</span>projects/PROJECT/zones/ZONE/instances/dest<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--destination-port<span class="o">=</span><span class="m">80</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--protocol<span class="o">=</span>TCP
</code></pre></div>

<hr />
<h2 id="10-next-steps">10. Next Steps<a class="header-link" href="#10-next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./10_Load_Balancing_CDN.md">10_Load_Balancing_CDN.md</a> - Load Balancing</li>
<li><a href="./14_Security_Services.md">14_Security_Services.md</a> - Security Details</li>
</ul>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.aws.amazon.com/vpc/">AWS VPC Documentation</a></li>
<li><a href="https://cloud.google.com/vpc/docs">GCP VPC Documentation</a></li>
<li><a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-best-practices.html">AWS VPC Best Practices</a></li>
<li><a href="../Networking/">Networking/</a> - Networking Fundamentals</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Cloud_Computing/08_Block_and_File_Storage.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Block and File Storage (EBS/EFS vs Persistent Disk/Filestore)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Cloud_Computing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Cloud_Computing/10_Load_Balancing_CDN.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Load Balancing & CDN</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}