{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compiler Design - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Compiler_Design/">Compiler Design</a>
    <span class="separator">/</span>
    <span class="current">Compiler Design</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Compiler Design</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <span class="nav-placeholder"></span>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Compiler_Design/01_Introduction_to_Compilers.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Lesson 1: Introduction to Compilers</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#topic-overview">Topic Overview</a></li>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#lesson-table">Lesson Table</a></li>
<li><a href="#learning-path-recommendations">Learning Path Recommendations</a><ul>
<li><a href="#path-1-foundations-first-recommended">Path 1: Foundations First (Recommended)</a></li>
<li><a href="#path-2-quick-practical-compiler">Path 2: Quick Practical Compiler</a></li>
<li><a href="#path-3-optimization-focus">Path 3: Optimization Focus</a></li>
<li><a href="#path-4-language-theory">Path 4: Language Theory</a></li>
</ul>
</li>
<li><a href="#related-topics-in-this-project">Related Topics in This Project</a></li>
<li><a href="#recommended-textbooks-and-references">Recommended Textbooks and References</a></li>
<li><a href="#example-code">Example Code</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="compiler-design">Compiler Design<a class="header-link" href="#compiler-design" title="Permanent link">&para;</a></h1>
<h2 id="topic-overview">Topic Overview<a class="header-link" href="#topic-overview" title="Permanent link">&para;</a></h2>
<p>Compiler design is one of the foundational areas of computer science, bridging the gap between human-readable programming languages and machine-executable code. A compiler translates source code written in a high-level language into a lower-level representation ‚Äî typically machine code, bytecode, or another programming language ‚Äî through a series of well-defined phases.</p>
<p>This topic covers the complete pipeline of compilation: from scanning raw characters into tokens, parsing tokens into structured representations, analyzing meaning, generating intermediate code, optimizing it, and finally producing target code. Along the way, you will encounter deep connections to formal language theory, algorithm design, graph theory, and computer architecture.</p>
<p>Understanding compiler design is valuable not only for building compilers but also for:</p>
<ul>
<li><strong>Language design</strong>: Creating domain-specific languages (DSLs) and configuration languages</li>
<li><strong>Tool building</strong>: Writing linters, formatters, transpilers, and static analyzers</li>
<li><strong>Performance understanding</strong>: Knowing what optimizations your compiler performs (and what it cannot do)</li>
<li><strong>Software engineering</strong>: Applying patterns like visitors, interpreters, and intermediate representations to general software design</li>
<li><strong>Security</strong>: Understanding how code injection, sandboxing, and code analysis tools work</li>
</ul>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>By completing this topic, you will be able to:</p>
<ol>
<li>Explain the phases of compilation and how they interact</li>
<li>Implement lexical analyzers using finite automata theory</li>
<li>Construct parsers using both top-down and bottom-up techniques</li>
<li>Design abstract syntax trees and perform semantic analysis</li>
<li>Generate intermediate representations and perform optimizations</li>
<li>Understand runtime environments, garbage collection, and virtual machines</li>
<li>Use modern compiler infrastructure (LLVM) for practical compilation tasks</li>
<li>Build a simple end-to-end compiler or interpreter for a small language</li>
</ol>
<h2 id="prerequisites">Prerequisites<a class="header-link" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>Before studying Compiler Design, you should be comfortable with:</p>
<ul>
<li><strong>Algorithm</strong> (this project): Particularly graph algorithms, trees, and dynamic programming</li>
<li><strong>Programming</strong> (this project): Strong grasp of data structures, recursion, and OOP</li>
<li><strong>Python</strong> (this project): Most examples use Python for clarity</li>
<li><strong>C_Programming</strong> (this project): Helpful for understanding low-level code generation</li>
<li><strong>Discrete mathematics</strong>: Sets, relations, functions, proof techniques (induction, contradiction)</li>
<li><strong>Basic computer architecture</strong>: Registers, memory, instruction sets (covered in Computer_Architecture)</li>
</ul>
<h2 id="lesson-table">Lesson Table<a class="header-link" href="#lesson-table" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>#</th>
<th>Title</th>
<th>Key Topics</th>
<th>Estimated Time</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./01_Introduction_to_Compilers.md">01</a></td>
<td>Introduction to Compilers</td>
<td>Compiler structure, phases, bootstrapping, T-diagrams</td>
<td>2-3 hours</td>
</tr>
<tr>
<td><a href="./02_Lexical_Analysis.md">02</a></td>
<td>Lexical Analysis</td>
<td>Tokens, regular expressions, DFA/NFA, lexer implementation</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./03_Finite_Automata.md">03</a></td>
<td>Finite Automata</td>
<td>NFA-to-DFA conversion, minimization, Myhill-Nerode, Lex/Flex</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./04_Context_Free_Grammars.md">04</a></td>
<td>Context-Free Grammars</td>
<td>BNF, derivations, parse trees, ambiguity, CNF, CYK</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./05_Top_Down_Parsing.md">05</a></td>
<td>Top-Down Parsing</td>
<td>Recursive descent, LL(1), FIRST/FOLLOW sets</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./06_Bottom_Up_Parsing.md">06</a></td>
<td>Bottom-Up Parsing</td>
<td>LR(0), SLR, LALR, parser generators (Yacc/Bison)</td>
<td>4-5 hours</td>
</tr>
<tr>
<td><a href="./07_Abstract_Syntax_Trees.md">07</a></td>
<td>Abstract Syntax Trees</td>
<td>AST design, visitor pattern, tree traversal strategies</td>
<td>2-3 hours</td>
</tr>
<tr>
<td><a href="./08_Semantic_Analysis.md">08</a></td>
<td>Semantic Analysis</td>
<td>Type checking, symbol tables, scoping rules</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./09_Intermediate_Representations.md">09</a></td>
<td>Intermediate Representations</td>
<td>Three-address code, SSA form, control flow graphs</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./10_Runtime_Environments.md">10</a></td>
<td>Runtime Environments</td>
<td>Activation records, calling conventions, stack frames</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./11_Code_Generation.md">11</a></td>
<td>Code Generation</td>
<td>Instruction selection, register allocation, tiling</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./12_Optimization_Local_and_Global.md">12</a></td>
<td>Optimization -- Local and Global</td>
<td>Data flow analysis, constant propagation, dead code elimination</td>
<td>4-5 hours</td>
</tr>
<tr>
<td><a href="./13_Loop_Optimization.md">13</a></td>
<td>Loop Optimization</td>
<td>Loop-invariant code motion, strength reduction, vectorization</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./14_Garbage_Collection.md">14</a></td>
<td>Garbage Collection</td>
<td>Mark-Sweep, Copying, Generational, Reference Counting</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./15_Interpreters_and_Virtual_Machines.md">15</a></td>
<td>Interpreters and Virtual Machines</td>
<td>Bytecode, stack-based VM, JIT compilation basics</td>
<td>3-4 hours</td>
</tr>
<tr>
<td><a href="./16_Modern_Compiler_Infrastructure.md">16</a></td>
<td>Modern Compiler Infrastructure</td>
<td>LLVM IR, pass structure, DSL design</td>
<td>3-4 hours</td>
</tr>
</tbody>
</table>
<p><strong>Total estimated time: 50-65 hours</strong></p>
<h2 id="learning-path-recommendations">Learning Path Recommendations<a class="header-link" href="#learning-path-recommendations" title="Permanent link">&para;</a></h2>
<h3 id="path-1-foundations-first-recommended">Path 1: Foundations First (Recommended)<a class="header-link" href="#path-1-foundations-first-recommended" title="Permanent link">&para;</a></h3>
<p>Follow the lessons in order. This path builds each concept on the previous ones:</p>
<div class="highlight"><pre><span></span><code><span class="mf">01</span><span class="w"> </span><span class="nb">Int</span><span class="n">roduction</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">02</span><span class="w"> </span><span class="n">Lexical</span><span class="w"> </span><span class="n">Analysis</span><span class="w">  </span><span class="o">---&gt;</span><span class="w">  </span><span class="mf">03</span><span class="w"> </span><span class="n">Finite</span><span class="w"> </span><span class="n">Automata</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">04</span><span class="w"> </span><span class="kr">Cont</span><span class="n">ext</span><span class="o">-</span><span class="nb">Fre</span><span class="n">e</span><span class="w"> </span><span class="n">Grammars</span>
<span class="w">    </span><span class="err">|</span>
<span class="w">    </span><span class="o">+---&gt;</span><span class="w"> </span><span class="mf">05</span><span class="w"> </span><span class="kr">To</span><span class="n">p</span><span class="o">-</span><span class="n">Down</span><span class="w"> </span><span class="n">Parsing</span>
<span class="w">    </span><span class="o">+---&gt;</span><span class="w"> </span><span class="mf">06</span><span class="w"> </span><span class="n">Bottom</span><span class="o">-</span><span class="n">Up</span><span class="w"> </span><span class="n">Parsing</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">07</span><span class="w"> </span><span class="nb">Abs</span><span class="n">tract</span><span class="w"> </span><span class="n">Syntax</span><span class="w"> </span><span class="n">Trees</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">08</span><span class="w"> </span><span class="n">Semantic</span><span class="w"> </span><span class="n">Analysis</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">09</span><span class="w"> </span><span class="nb">Int</span><span class="n">ermediate</span><span class="w"> </span><span class="n">Representations</span>
<span class="w">    </span><span class="err">|</span>
<span class="w">    </span><span class="o">+---&gt;</span><span class="w"> </span><span class="mf">10</span><span class="w"> </span><span class="kr">Run</span><span class="n">time</span><span class="w"> </span><span class="n">Environments</span>
<span class="w">    </span><span class="o">+---&gt;</span><span class="w"> </span><span class="mf">11</span><span class="w"> </span><span class="n">Code</span><span class="w"> </span><span class="n">Generation</span>
<span class="w">    </span><span class="o">+---&gt;</span><span class="w"> </span><span class="mf">12</span><span class="w"> </span><span class="n">Local</span><span class="o">/</span><span class="n">Global</span><span class="w"> </span><span class="n">Optimization</span>
<span class="w">    </span><span class="o">+---&gt;</span><span class="w"> </span><span class="mf">13</span><span class="w"> </span><span class="n">Loop</span><span class="w"> </span><span class="n">Optimization</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">14</span><span class="w"> </span><span class="n">Garbage</span><span class="w"> </span><span class="n">Collection</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">15</span><span class="w"> </span><span class="nb">Int</span><span class="n">erpreters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">VMs</span>
<span class="w">    </span><span class="err">|</span>
<span class="mf">16</span><span class="w"> </span><span class="n">Modern</span><span class="w"> </span><span class="n">Compiler</span><span class="w"> </span><span class="n">Infrastructure</span>
</code></pre></div>

<h3 id="path-2-quick-practical-compiler">Path 2: Quick Practical Compiler<a class="header-link" href="#path-2-quick-practical-compiler" title="Permanent link">&para;</a></h3>
<p>If you want to build a working compiler or interpreter quickly:</p>
<div class="highlight"><pre><span></span><code><span class="mf">01</span><span class="w"> </span><span class="nb">Int</span><span class="n">roduction</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">02</span><span class="w"> </span><span class="n">Lexical</span><span class="w"> </span><span class="n">Analysis</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">04</span><span class="w"> </span><span class="n">CFGs</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">05</span><span class="w"> </span><span class="kr">To</span><span class="n">p</span><span class="o">-</span><span class="n">Down</span><span class="w"> </span><span class="n">Parsing</span>
<span class="w">    </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">07</span><span class="w"> </span><span class="n">ASTs</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">08</span><span class="w"> </span><span class="n">Semantic</span><span class="w"> </span><span class="n">Analysis</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">15</span><span class="w"> </span><span class="nb">Int</span><span class="n">erpreters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">VMs</span>
</code></pre></div>

<h3 id="path-3-optimization-focus">Path 3: Optimization Focus<a class="header-link" href="#path-3-optimization-focus" title="Permanent link">&para;</a></h3>
<p>If you are interested in compiler optimizations and performance:</p>
<div class="highlight"><pre><span></span><code><span class="mf">01</span><span class="w"> </span><span class="nb">Int</span><span class="n">roduction</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">09</span><span class="w"> </span><span class="nb">Int</span><span class="n">ermediate</span><span class="w"> </span><span class="n">Representations</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">12</span><span class="w"> </span><span class="n">Local</span><span class="o">/</span><span class="n">Global</span><span class="w"> </span><span class="n">Optimization</span>
<span class="w">    </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">13</span><span class="w"> </span><span class="n">Loop</span><span class="w"> </span><span class="n">Optimization</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">11</span><span class="w"> </span><span class="n">Code</span><span class="w"> </span><span class="n">Generation</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">16</span><span class="w"> </span><span class="n">LLVM</span>
</code></pre></div>

<h3 id="path-4-language-theory">Path 4: Language Theory<a class="header-link" href="#path-4-language-theory" title="Permanent link">&para;</a></h3>
<p>If you are interested in formal language theory and parsing:</p>
<div class="highlight"><pre><span></span><code><span class="mf">02</span><span class="w"> </span><span class="n">Lexical</span><span class="w"> </span><span class="n">Analysis</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">03</span><span class="w"> </span><span class="n">Finite</span><span class="w"> </span><span class="n">Automata</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">04</span><span class="w"> </span><span class="n">CFGs</span>
<span class="w">    </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">05</span><span class="w"> </span><span class="kr">To</span><span class="n">p</span><span class="o">-</span><span class="n">Down</span><span class="w"> </span><span class="n">Parsing</span><span class="w">  </span><span class="o">--&gt;</span><span class="w">  </span><span class="mf">06</span><span class="w"> </span><span class="n">Bottom</span><span class="o">-</span><span class="n">Up</span><span class="w"> </span><span class="n">Parsing</span>
</code></pre></div>

<h2 id="related-topics-in-this-project">Related Topics in This Project<a class="header-link" href="#related-topics-in-this-project" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Relevance</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Algorithm</strong></td>
<td>Graph algorithms (DFS, topological sort) used in data flow analysis and optimization</td>
</tr>
<tr>
<td><strong>OS_Theory</strong></td>
<td>Process memory layout, linking, loading ‚Äî directly related to runtime environments</td>
</tr>
<tr>
<td><strong>Computer_Architecture</strong></td>
<td>Instruction sets, registers, caches ‚Äî essential for code generation</td>
</tr>
<tr>
<td><strong>Programming</strong></td>
<td>Design patterns (Visitor, Interpreter) used extensively in compiler construction</td>
</tr>
<tr>
<td><strong>Python</strong></td>
<td>Implementation language for most examples in this topic</td>
</tr>
<tr>
<td><strong>C_Programming</strong></td>
<td>Target language understanding; many compilers are written in C</td>
</tr>
<tr>
<td><strong>Math_for_AI</strong></td>
<td>Linear algebra and graph theory concepts overlap with optimization algorithms</td>
</tr>
</tbody>
</table>
<h2 id="recommended-textbooks-and-references">Recommended Textbooks and References<a class="header-link" href="#recommended-textbooks-and-references" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Aho, Lam, Sethi, Ullman</strong> ‚Äî <em>Compilers: Principles, Techniques, and Tools</em> (2nd ed., "The Dragon Book")</li>
<li><strong>Cooper, Torczon</strong> ‚Äî <em>Engineering a Compiler</em> (2nd ed.)</li>
<li><strong>Appel</strong> ‚Äî <em>Modern Compiler Implementation in ML/Java/C</em></li>
<li><strong>Muchnick</strong> ‚Äî <em>Advanced Compiler Design and Implementation</em></li>
<li><strong>Grune, Bal, Jacobs, Langendoen</strong> ‚Äî <em>Modern Compiler Design</em> (2nd ed.)</li>
</ol>
<h2 id="example-code">Example Code<a class="header-link" href="#example-code" title="Permanent link">&para;</a></h2>
<p>Example code for this topic can be found in <a href="../../../examples/Compiler_Design/"><code>examples/Compiler_Design/</code></a>.</p>
<p>Examples include:
- Lexer implementations (Python)
- Parser implementations (recursive descent, operator precedence)
- AST construction and traversal
- Simple interpreter and bytecode VM
- Optimization passes</p>
<hr />
<p><em>This topic is part of the <a href="../../README.md">Study Materials</a> collection.</em></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <span class="nav-placeholder"></span>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Compiler_Design/01_Introduction_to_Compilers.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Lesson 1: Introduction to Compilers</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}