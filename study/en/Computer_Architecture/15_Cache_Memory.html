{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cache Memory - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Computer_Architecture/">Computer Architecture</a>
    <span class="separator">/</span>
    <span class="current">Cache Memory</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Cache Memory</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Architecture/14_Memory_Hierarchy.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Memory Hierarchy</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Computer_Architecture/16_Virtual_Memory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Virtual Memory</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-cache-concept-and-operation">1. Cache Concept and Operation</a><ul>
<li><a href="#11-what-is-cache">1.1 What is Cache?</a></li>
<li><a href="#12-cache-structure-basics">1.2 Cache Structure Basics</a></li>
<li><a href="#13-address-decomposition">1.3 Address Decomposition</a></li>
<li><a href="#14-cache-operation-flow">1.4 Cache Operation Flow</a></li>
</ul>
</li>
<li><a href="#2-cache-mapping-schemes">2. Cache Mapping Schemes</a><ul>
<li><a href="#21-direct-mapped">2.1 Direct Mapped</a></li>
<li><a href="#22-fully-associative">2.2 Fully Associative</a></li>
<li><a href="#23-set-associative">2.3 Set Associative</a></li>
<li><a href="#24-mapping-scheme-comparison">2.4 Mapping Scheme Comparison</a></li>
</ul>
</li>
<li><a href="#3-cache-replacement-policies">3. Cache Replacement Policies</a><ul>
<li><a href="#31-need-for-replacement-policy">3.1 Need for Replacement Policy</a></li>
<li><a href="#32-lru-least-recently-used">3.2 LRU (Least Recently Used)</a></li>
<li><a href="#33-pseudo-lru-tree-based">3.3 Pseudo-LRU (Tree-based)</a></li>
<li><a href="#34-fifo-first-in-first-out">3.4 FIFO (First In, First Out)</a></li>
<li><a href="#35-random-replacement">3.5 Random Replacement</a></li>
<li><a href="#36-replacement-policy-comparison">3.6 Replacement Policy Comparison</a></li>
</ul>
</li>
<li><a href="#4-cache-write-policies">4. Cache Write Policies</a><ul>
<li><a href="#41-write-through">4.1 Write-Through</a></li>
<li><a href="#42-write-back">4.2 Write-Back</a></li>
<li><a href="#43-write-allocate-vs-no-write-allocate">4.3 Write Allocate vs No-Write Allocate</a></li>
<li><a href="#44-write-policy-comparison">4.4 Write Policy Comparison</a></li>
</ul>
</li>
<li><a href="#5-types-of-cache-misses">5. Types of Cache Misses</a><ul>
<li><a href="#51-3c-classification">5.1 3C Classification</a></li>
<li><a href="#52-cold-miss-compulsory-miss">5.2 Cold Miss (Compulsory Miss)</a></li>
<li><a href="#53-capacity-miss">5.3 Capacity Miss</a></li>
<li><a href="#54-conflict-miss">5.4 Conflict Miss</a></li>
<li><a href="#55-3c-miss-proportions">5.5 3C Miss Proportions</a></li>
</ul>
</li>
<li><a href="#6-multi-level-cache">6. Multi-Level Cache</a><ul>
<li><a href="#61-need-for-multi-level-cache">6.1 Need for Multi-Level Cache</a></li>
<li><a href="#62-inclusive-vs-exclusive-cache">6.2 Inclusive vs Exclusive Cache</a></li>
<li><a href="#63-private-vs-shared-cache">6.3 Private vs Shared Cache</a></li>
<li><a href="#64-local-vs-global-miss-rate">6.4 Local vs Global Miss Rate</a></li>
</ul>
</li>
<li><a href="#7-cache-optimization-techniques">7. Cache Optimization Techniques</a><ul>
<li><a href="#71-victim-cache">7.1 Victim Cache</a></li>
<li><a href="#72-prefetching">7.2 Prefetching</a></li>
<li><a href="#73-compiler-optimizations">7.3 Compiler Optimizations</a></li>
</ul>
</li>
<li><a href="#8-practice-problems">8. Practice Problems</a><ul>
<li><a href="#basic-problems">Basic Problems</a></li>
<li><a href="#intermediate-problems">Intermediate Problems</a></li>
<li><a href="#advanced-problems">Advanced Problems</a></li>
</ul>
</li>
<li><a href="#next-steps">Next Steps</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="cache-memory">Cache Memory<a class="header-link" href="#cache-memory" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>Cache memory is a high-speed buffer memory located between the CPU and main memory to bridge the speed gap between them. Cache design directly affects computer performance and requires various design decisions including mapping schemes, replacement policies, and write policies. In this lesson, we will learn about cache operation principles and various design techniques.</p>
<p><strong>Difficulty</strong>: â­â­â­</p>
<p><strong>Prerequisites</strong>: Memory Hierarchy, Principle of Locality</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-cache-concept-and-operation">Cache Concept and Operation</a></li>
<li><a href="#2-cache-mapping-schemes">Cache Mapping Schemes</a></li>
<li><a href="#3-cache-replacement-policies">Cache Replacement Policies</a></li>
<li><a href="#4-cache-write-policies">Cache Write Policies</a></li>
<li><a href="#5-types-of-cache-misses">Types of Cache Misses</a></li>
<li><a href="#6-multi-level-cache">Multi-Level Cache</a></li>
<li><a href="#7-cache-optimization-techniques">Cache Optimization Techniques</a></li>
<li><a href="#8-practice-problems">Practice Problems</a></li>
</ol>
<hr />
<h2 id="1-cache-concept-and-operation">1. Cache Concept and Operation<a class="header-link" href="#1-cache-concept-and-operation" title="Permanent link">&para;</a></h2>
<h3 id="11-what-is-cache">1.1 What is Cache?<a class="header-link" href="#11-what-is-cache" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Cache Etymology: French &quot;cacher&quot; (to hide)

Definition: Small, high-speed memory located between CPU and main memory
Purpose: Keep frequently used data accessible quickly

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Role of Cache                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚      CPU                   Cache               Main Memory  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚       â”‚  Fast     â”‚           â”‚  Slow    â”‚           â”‚  â”‚
â”‚   â”‚       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚  â”‚
â”‚   â”‚       â”‚  (~4 ns)  â”‚           â”‚ (~60 ns)  â”‚           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚   Reduce average access time by keeping frequently used     â”‚
â”‚   data in cache                                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12-cache-structure-basics">1.2 Cache Structure Basics<a class="header-link" href="#12-cache-structure-basics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Cache</span><span class="w"> </span><span class="nx">Line</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">Block</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Basic</span><span class="w"> </span><span class="nx">unit</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">transfer</span><span class="w"> </span><span class="nx">between</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">memory</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Typically</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="nx">bytes</span><span class="w"> </span><span class="p">(</span><span class="nx">modern</span><span class="w"> </span><span class="nx">processors</span><span class="p">)</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                      </span><span class="nx">Cache</span><span class="w"> </span><span class="nx">Line</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="w"> </span><span class="nx">bytes</span><span class="p">)</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Valid</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                     </span><span class="nx">Tag</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="p">(</span><span class="mi">1</span><span class="nx">b</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                </span><span class="p">(</span><span class="nx">upper</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">bits</span><span class="p">)</span><span class="w">              </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="nx">Data</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="w"> </span><span class="nx">bytes</span><span class="p">)</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x00</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="mh">0x02</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="mh">0x3E</span><span class="w"> </span><span class="mh">0x3F</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">Cache</span><span class="w"> </span><span class="nx">Terminology</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Hit</span><span class="p">:</span><span class="w"> </span><span class="nx">Requested</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">cache</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Miss</span><span class="p">:</span><span class="w"> </span><span class="nx">Requested</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">cache</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Hit</span><span class="w"> </span><span class="nx">Rate</span><span class="p">:</span><span class="w"> </span><span class="nx">Number</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">hits</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">Total</span><span class="w"> </span><span class="nx">accesses</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Miss</span><span class="w"> </span><span class="nx">Rate</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Hit</span><span class="w"> </span><span class="nx">Rate</span>
</code></pre></div>

<h3 id="13-address-decomposition">1.3 Address Decomposition<a class="header-link" href="#13-address-decomposition" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Decomposing</span><span class="w"> </span><span class="nx">memory</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="nx">access</span><span class="p">:</span>

<span class="mi">32</span><span class="o">-</span><span class="nx">bit</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">example</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="nx">KB</span><span class="w"> </span><span class="nx">cache</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="nx">B</span><span class="w"> </span><span class="nx">line</span><span class="p">,</span><span class="w"> </span><span class="nx">direct</span><span class="w"> </span><span class="nx">mapped</span><span class="p">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mi">31</span><span class="w">                    </span><span class="mi">12</span><span class="w"> </span><span class="mi">11</span><span class="w">          </span><span class="mi">6</span><span class="w"> </span><span class="mi">5</span><span class="w">               </span><span class="mi">0</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">         </span><span class="nx">Tag</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="nx">b</span><span class="p">)</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Index</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="nx">b</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Offset</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="nx">b</span><span class="p">)</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">Offset</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="nx">bits</span><span class="p">):</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Position</span><span class="w"> </span><span class="nx">within</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="nx">line</span>
<span class="o">-</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="nx">bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nx">thus</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="nx">bits</span>

<span class="nx">Index</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="nx">bits</span><span class="p">):</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Cache</span><span class="w"> </span><span class="nx">line</span><span class="w"> </span><span class="nx">selection</span>
<span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="nx">KB</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">64</span><span class="nx">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="nx">lines</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nx">thus</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="nx">bits</span>

<span class="nx">Tag</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="w"> </span><span class="nx">bits</span><span class="p">):</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Distinguishes</span><span class="w"> </span><span class="nx">different</span><span class="w"> </span><span class="nx">addresses</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">index</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Remaining</span><span class="w"> </span><span class="nx">bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="nx">bits</span>
</code></pre></div>

<h3 id="14-cache-operation-flow">1.4 Cache Operation Flow<a class="header-link" href="#14-cache-operation-flow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Cache</span><span class="w"> </span><span class="nv">Read</span><span class="w"> </span><span class="nv">Operation</span>:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                      </span><span class="nv">CPU</span><span class="w"> </span><span class="nv">Address</span><span class="w"> </span><span class="nv">Request</span><span class="w">                     </span>â”‚
â”‚<span class="w">                           </span>â”‚<span class="w">                                 </span>â”‚
â”‚<span class="w">                           </span>â–¼<span class="w">                                 </span>â”‚
â”‚<span class="w">              </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                     </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">Select</span><span class="w"> </span><span class="nv">cache</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">by</span><span class="w">   </span>â”‚<span class="w">                     </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w">      </span><span class="nv">Index</span><span class="w">             </span>â”‚<span class="w">                     </span>â”‚
â”‚<span class="w">              </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                     </span>â”‚
â”‚<span class="w">                           </span>â”‚<span class="w">                                 </span>â”‚
â”‚<span class="w">                           </span>â–¼<span class="w">                                 </span>â”‚
â”‚<span class="w">              </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                     </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">Compare</span><span class="w"> </span><span class="nv">Tag</span><span class="w"> </span><span class="o">&amp;</span><span class="w">          </span>â”‚<span class="w">                     </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w"> </span><span class="nv">Check</span><span class="w"> </span><span class="nv">Valid</span><span class="w">            </span>â”‚<span class="w">                     </span>â”‚
â”‚<span class="w">              </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                     </span>â”‚
â”‚<span class="w">                           </span>â”‚<span class="w">                                 </span>â”‚
â”‚<span class="w">              </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                    </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w">                         </span>â”‚<span class="w">                    </span>â”‚
â”‚<span class="w">         </span><span class="nv">Tag</span><span class="w"> </span><span class="nv">match</span><span class="w"> </span><span class="o">&amp;</span><span class="w">             </span><span class="nv">Tag</span><span class="w"> </span><span class="nv">mismatch</span><span class="w"> </span><span class="nv">or</span><span class="w">             </span>â”‚
â”‚<span class="w">         </span><span class="nv">Valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">               </span><span class="nv">Valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">                   </span>â”‚
â”‚<span class="w">              </span>â”‚<span class="w">                         </span>â”‚<span class="w">                    </span>â”‚
â”‚<span class="w">              </span>â–¼<span class="w">                         </span>â–¼<span class="w">                    </span>â”‚
â”‚<span class="w">    </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">      </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">        </span>â”‚
â”‚<span class="w">    </span>â”‚<span class="w">   </span><span class="nv">Cache</span><span class="w"> </span><span class="nv">Hit</span><span class="o">!</span><span class="w">    </span>â”‚<span class="w">      </span>â”‚<span class="w">    </span><span class="nv">Cache</span><span class="w"> </span><span class="nv">Miss</span><span class="o">!</span><span class="w">      </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Select</span><span class="o">/</span><span class="k">return</span><span class="w">   </span>â”‚<span class="w">      </span>â”‚<span class="w"> </span><span class="nv">Load</span><span class="w"> </span><span class="nv">block</span><span class="w"> </span><span class="nv">from</span><span class="w">     </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">    </span>â”‚<span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">Offset</span><span class="w">  </span>â”‚<span class="w">      </span>â”‚<span class="w"> </span><span class="nv">memory</span>,<span class="w"> </span><span class="nv">store</span><span class="w"> </span><span class="nv">in</span><span class="w">    </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">    </span>â”‚<span class="w">                 </span>â”‚<span class="w">      </span>â”‚<span class="w"> </span><span class="nv">cache</span>,<span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w">  </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">    </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">      </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">        </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-cache-mapping-schemes">2. Cache Mapping Schemes<a class="header-link" href="#2-cache-mapping-schemes" title="Permanent link">&para;</a></h2>
<h3 id="21-direct-mapped">2.1 Direct Mapped<a class="header-link" href="#21-direct-mapped" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Characteristic</span><span class="o">:</span><span class="w"> </span><span class="n">Each</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">location</span>

<span class="n">Calculation</span><span class="o">:</span>
<span class="n">Cache</span><span class="w"> </span><span class="n">Index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="n">Memory</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">Address</span><span class="o">)</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="o">(</span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">Lines</span><span class="o">)</span>

<span class="n">Example</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span><span class="o">-</span><span class="n">line</span><span class="w"> </span><span class="n">cache</span>

<span class="n">Memory</span><span class="w"> </span><span class="n">Block</span><span class="w">    </span><span class="n">Cache</span><span class="w"> </span><span class="n">Index</span>
<span class="w">   </span><span class="mi">0</span><span class="w">      </span><span class="err">â†’</span><span class="w">      </span><span class="mi">0</span>
<span class="w">   </span><span class="mi">1</span><span class="w">      </span><span class="err">â†’</span><span class="w">      </span><span class="mi">1</span>
<span class="w">   </span><span class="mi">2</span><span class="w">      </span><span class="err">â†’</span><span class="w">      </span><span class="mi">2</span>
<span class="w">   </span><span class="o">...</span>
<span class="w">   </span><span class="mi">7</span><span class="w">      </span><span class="err">â†’</span><span class="w">      </span><span class="mi">7</span>
<span class="w">   </span><span class="mi">8</span><span class="w">      </span><span class="err">â†’</span><span class="w">      </span><span class="mi">0</span><span class="w">  </span><span class="o">(</span><span class="n">conflict</span><span class="o">!)</span>
<span class="w">   </span><span class="mi">9</span><span class="w">      </span><span class="err">â†’</span><span class="w">      </span><span class="mi">1</span>
<span class="w">   </span><span class="o">...</span>
<span class="w">   </span><span class="mi">16</span><span class="w">     </span><span class="err">â†’</span><span class="w">      </span><span class="mi">0</span><span class="w">  </span><span class="o">(</span><span class="n">conflict</span><span class="o">!)</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="n">Direct</span><span class="w"> </span><span class="n">Mapped</span><span class="w"> </span><span class="n">Cache</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Index</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Valid</span><span class="w"> </span><span class="err">â”‚</span><span class="w">    </span><span class="n">Tag</span><span class="w">    </span><span class="err">â”‚</span><span class="w">         </span><span class="n">Data</span><span class="w"> </span><span class="o">(</span><span class="mi">64</span><span class="n">B</span><span class="o">)</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="mh">0x100</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">[</span><span class="n">block</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="mi">16</span><span class="o">...]</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="mh">0x101</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">[</span><span class="n">block</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="mi">17</span><span class="o">...]</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w">     </span><span class="err">â”‚</span><span class="w">           </span><span class="o">-</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="mh">0x102</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">[</span><span class="n">block</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="mi">11</span><span class="o">...]</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">4</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="mh">0x103</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">[...]</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">5</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w">     </span><span class="err">â”‚</span><span class="w">           </span><span class="o">-</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">6</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="mh">0x100</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">[...]</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">7</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="mh">0x101</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">[...]</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Advantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Simple</span><span class="w"> </span><span class="n">hardware</span>
<span class="o">-</span><span class="w"> </span><span class="n">Fast</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="o">(</span><span class="n">no</span><span class="w"> </span><span class="n">parallel</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">comparison</span><span class="w"> </span><span class="n">needed</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Deterministic</span><span class="w"> </span><span class="n">replacement</span><span class="w"> </span><span class="o">(</span><span class="n">no</span><span class="w"> </span><span class="n">replacement</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">needed</span><span class="o">)</span>

<span class="n">Disadvantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Many</span><span class="w"> </span><span class="n">conflict</span><span class="w"> </span><span class="n">misses</span>
<span class="o">-</span><span class="w"> </span><span class="n">Blocks</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">compete</span>
</code></pre></div>

<h3 id="22-fully-associative">2.2 Fully Associative<a class="header-link" href="#22-fully-associative" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nl">Characteristic</span><span class="p">:</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">location</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                   </span><span class="n">Fully</span><span class="w"> </span><span class="n">Associative</span><span class="w"> </span><span class="n">Cache</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Valid</span><span class="w"> </span><span class="err">â”‚</span><span class="w">    </span><span class="n">Tag</span><span class="w">       </span><span class="err">â”‚</span><span class="w">         </span><span class="n">Data</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="n">B</span><span class="p">)</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x0001000</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x0002008</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x0001008</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x0003010</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">4</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="err">â”‚</span><span class="w">      </span><span class="o">-</span><span class="w">       </span><span class="err">â”‚</span><span class="w">      </span><span class="o">-</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">5</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x0002000</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">6</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x0004020</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">7</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mh">0x0001020</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Search</span><span class="w"> </span><span class="n">Process</span><span class="o">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Compare</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">tags</span><span class="w"> </span><span class="n">simultaneously</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="n">parallel</span><span class="w"> </span><span class="n">comparison</span><span class="p">)</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Request</span><span class="w"> </span><span class="n">Tag</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0001000</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0002008</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Hit</span><span class="o">!</span><span class="w">  </span><span class="err">â†</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0003010</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">...</span><span class="w">                                                        </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nl">Advantages</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">conflict</span><span class="w"> </span><span class="n">misses</span>
<span class="o">-</span><span class="w"> </span><span class="n">Maximum</span><span class="w"> </span><span class="n">flexibility</span>

<span class="nl">Disadvantages</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Complex</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="p">(</span><span class="n">parallel</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">comparison</span><span class="w"> </span><span class="n">needed</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Slow</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="p">(</span><span class="n">requires</span><span class="w"> </span><span class="n">CAM</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Content</span><span class="w"> </span><span class="n">Addressable</span><span class="w"> </span><span class="n">Memory</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Expensive</span><span class="w"> </span><span class="n">implementation</span>
<span class="o">-</span><span class="w"> </span><span class="n">Practically</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">structures</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">TLB</span>
</code></pre></div>

<h3 id="23-set-associative">2.3 Set Associative<a class="header-link" href="#23-set-associative" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Characteristic</span><span class="o">:</span><span class="w"> </span><span class="n">Compromise</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">direct</span><span class="w"> </span><span class="n">mapped</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">fully</span><span class="w"> </span><span class="n">associative</span>
<span class="o">-</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">divided</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">sets</span>
<span class="o">-</span><span class="w"> </span><span class="n">Fully</span><span class="w"> </span><span class="n">associative</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="kd">set</span>

<span class="n">N</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">Associative</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="o">(</span><span class="n">ways</span><span class="o">)</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="kd">set</span>
<span class="o">-</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="kd">set</span>
<span class="o">-</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kd">set</span>

<span class="n">Example</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">Associative</span><span class="w"> </span><span class="o">(</span><span class="mi">32</span><span class="w"> </span><span class="n">lines</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">sets</span><span class="o">)</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">Associative</span><span class="w"> </span><span class="n">Cache</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">3</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Set</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">V</span><span class="err">â”‚</span><span class="n">Tag</span><span class="err">â”‚</span><span class="n">Data</span><span class="err">â”‚</span><span class="w"> </span><span class="n">V</span><span class="err">â”‚</span><span class="n">Tag</span><span class="err">â”‚</span><span class="n">Data</span><span class="err">â”‚</span><span class="w"> </span><span class="n">V</span><span class="err">â”‚</span><span class="n">Tag</span><span class="err">â”‚</span><span class="n">Data</span><span class="err">â”‚</span><span class="w"> </span><span class="n">V</span><span class="err">â”‚</span><span class="n">Tag</span><span class="err">â”‚</span><span class="n">Data</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">100</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">108</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">110</span><span class="err">â”‚</span><span class="o">...</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">101</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">109</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">111</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">102</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">10</span><span class="n">A</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">112</span><span class="err">â”‚</span><span class="o">...</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">103</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">10</span><span class="n">B</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">113</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">11</span><span class="n">B</span><span class="err">â”‚</span><span class="o">...</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">4</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">10</span><span class="n">C</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">114</span><span class="err">â”‚</span><span class="o">...</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">5</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">105</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">10</span><span class="n">D</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">115</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">6</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">106</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">10</span><span class="n">E</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">116</span><span class="err">â”‚</span><span class="o">...</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">7</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">107</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">10</span><span class="n">F</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">117</span><span class="err">â”‚</span><span class="o">...</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="mi">11</span><span class="n">F</span><span class="err">â”‚</span><span class="o">...</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Address</span><span class="w"> </span><span class="n">decomposition</span><span class="w"> </span><span class="o">(</span><span class="mi">32</span><span class="o">-</span><span class="n">bit</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">sets</span><span class="o">,</span><span class="w"> </span><span class="mi">64</span><span class="n">B</span><span class="w"> </span><span class="n">line</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="mi">31</span><span class="w">                   </span><span class="mi">9</span><span class="w">  </span><span class="mi">8</span><span class="w">         </span><span class="mi">6</span><span class="w">  </span><span class="mi">5</span><span class="w">                 </span><span class="mi">0</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Tag</span><span class="w"> </span><span class="o">(</span><span class="mi">23</span><span class="w"> </span><span class="n">bits</span><span class="o">)</span><span class="w">     </span><span class="err">â”‚</span><span class="n">Set</span><span class="w"> </span><span class="n">Index</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Block</span><span class="w"> </span><span class="n">Offset</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â”‚</span><span class="w">  </span><span class="o">(</span><span class="mi">3</span><span class="w"> </span><span class="n">bits</span><span class="o">)</span><span class="w"> </span><span class="err">â”‚</span><span class="w">    </span><span class="o">(</span><span class="mi">6</span><span class="w"> </span><span class="n">bits</span><span class="o">)</span><span class="w">      </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="24-mapping-scheme-comparison">2.4 Mapping Scheme Comparison<a class="header-link" href="#24-mapping-scheme-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Property     â”‚Direct Mappedâ”‚Set Associativeâ”‚Fully Assoc.  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Flexibility     â”‚    Low      â”‚    Medium    â”‚    High      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ HW Complexity   â”‚    Low      â”‚    Medium    â”‚    High      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Access Speed    â”‚    Fast     â”‚    Medium    â”‚    Slow      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Conflict Misses â”‚    Many     â”‚    Few       â”‚    None      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ # Comparators   â”‚     1       â”‚   N (N-way)  â”‚  All lines   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Practical Use   â”‚ Early cache â”‚ Most caches  â”‚    TLB       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Typical configurations (modern processors):
- L1 cache: 8-way set associative
- L2 cache: 4-8 way set associative
- L3 cache: 16-way set associative
- TLB: Fully associative or high associativity
</code></pre></div>

<hr />
<h2 id="3-cache-replacement-policies">3. Cache Replacement Policies<a class="header-link" href="#3-cache-replacement-policies" title="Permanent link">&para;</a></h2>
<h3 id="31-need-for-replacement-policy">3.1 Need for Replacement Policy<a class="header-link" href="#31-need-for-replacement-policy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">In</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">associative</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">fully</span><span class="w"> </span><span class="n">associative</span><span class="w"> </span><span class="n">caches</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">miss</span>
<span class="o">-</span><span class="w"> </span><span class="n">When</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="ow">or</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">cache</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">full</span>
<span class="o">-</span><span class="w"> </span><span class="n">Decision</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">replace</span>

<span class="n">Goal</span><span class="p">:</span><span class="w"> </span><span class="n">Replace</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">won</span><span class="s1">&#39;t be used in future â†’ Minimize miss rate</span>
<span class="n">Problem</span><span class="p">:</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">predict</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">heuristics</span>
</code></pre></div>

<h3 id="32-lru-least-recently-used">3.2 LRU (Least Recently Used)<a class="header-link" href="#32-lru-least-recently-used" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Principle</span><span class="o">:</span><span class="w"> </span><span class="n">Replace</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">longest</span><span class="w"> </span><span class="n">ago</span>
<span class="n">Rationale</span><span class="o">:</span><span class="w"> </span><span class="n">Recently</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">likely</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="n">soon</span><span class="w"> </span><span class="o">(</span><span class="n">temporal</span><span class="w"> </span><span class="n">locality</span><span class="o">)</span>

<span class="n">Example</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">cache</span><span class="o">,</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">F</span>

<span class="n">Initial</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">(</span><span class="n">empty</span><span class="w"> </span><span class="n">cache</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="o">-</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Access</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">A</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Access</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Access</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Access</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Access</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">oldest</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Access</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">B</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Access</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">C</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">LRU</span><span class="w"> </span><span class="n">Implementation</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Exact</span><span class="w"> </span><span class="n">LRU</span><span class="o">:</span><span class="w"> </span><span class="n">N</span><span class="o">!</span><span class="w"> </span><span class="n">states</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">High</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">cost</span>
<span class="o">-</span><span class="w"> </span><span class="n">Approximate</span><span class="w"> </span><span class="n">LRU</span><span class="o">:</span><span class="w"> </span><span class="n">Bit</span><span class="w"> </span><span class="n">matrix</span><span class="o">,</span><span class="w"> </span><span class="n">tree</span><span class="o">-</span><span class="n">based</span><span class="o">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span>
</code></pre></div>

<h3 id="33-pseudo-lru-tree-based">3.3 Pseudo-LRU (Tree-based)<a class="header-link" href="#33-pseudo-lru-tree-based" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Tree</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">approximate</span><span class="w"> </span><span class="n">LRU</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">example</span><span class="p">)</span><span class="err">:</span>

<span class="w">          </span><span class="err">â”Œâ”€â”€â”€â”</span>
<span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="nl">Root</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="nf">left</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">recent</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="nf">right</span>
<span class="w">          </span><span class="err">â””â”€â”¬â”€â”˜</span>
<span class="w">        </span><span class="err">â”Œâ”€â”€â”€â”´â”€â”€â”€â”</span>
<span class="w">      </span><span class="err">â”Œâ”€â”´â”€â”</span><span class="w">   </span><span class="err">â”Œâ”€â”´â”€â”</span>
<span class="w">      </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">Internal</span><span class="w"> </span><span class="n">nodes</span>
<span class="w">      </span><span class="err">â””â”€â”¬â”€â”˜</span><span class="w">   </span><span class="err">â””â”€â”¬â”€â”˜</span>
<span class="w">     </span><span class="err">â”Œâ”€â”€â”´â”€â”€â”</span><span class="w"> </span><span class="err">â”Œâ”€â”€â”´â”€â”€â”</span>
<span class="w">     </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="w">    </span><span class="n">Way0</span><span class="w">  </span><span class="n">Way1</span><span class="w"> </span><span class="n">Way2</span><span class="w"> </span><span class="n">Way3</span>

<span class="n">Finding</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nf">replace</span><span class="err">:</span>
<span class="mf">1.</span><span class="w"> </span><span class="k">Start</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">root</span>
<span class="mf">2.</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="nc">bit</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="nf">left</span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="nf">right</span>
<span class="mf">3.</span><span class="w"> </span><span class="k">At</span><span class="w"> </span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="nf">replace</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">way</span>

<span class="k">Update</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="nl">access</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="k">Set</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">accessed</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">opposite</span><span class="w"> </span><span class="n">direction</span>
<span class="o">-</span><span class="w"> </span><span class="n">Guides</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">replacement</span><span class="w"> </span><span class="n">away</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">way</span>

<span class="nl">Advantage</span><span class="p">:</span><span class="w"> </span><span class="k">Only</span><span class="w"> </span><span class="n">log2</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="nl">way</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="nl">LRU</span><span class="p">:</span><span class="w"> </span><span class="n">more</span><span class="p">)</span>
<span class="nl">Disadvantage</span><span class="p">:</span><span class="w"> </span><span class="n">Doesn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">guarantee</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">LRU</span><span class="w"> </span><span class="k">order</span>
</code></pre></div>

<h3 id="34-fifo-first-in-first-out">3.4 FIFO (First In, First Out)<a class="header-link" href="#34-fifo-first-in-first-out" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Principle</span><span class="o">:</span><span class="w"> </span><span class="n">Replace</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">entered</span><span class="w"> </span><span class="n">first</span>

<span class="n">Example</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">cache</span><span class="o">,</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span>

<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">0</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="o">(</span><span class="n">A</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">first</span><span class="o">)</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">E</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">A</span><span class="o">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="o">(</span><span class="n">B</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">next</span><span class="o">)</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">accessed</span><span class="o">!):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">2</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Advantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Very</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="o">(</span><span class="n">one</span><span class="w"> </span><span class="n">pointer</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Fair</span><span class="w"> </span><span class="n">replacement</span>

<span class="n">Disadvantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Ignores</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">patterns</span>
<span class="o">-</span><span class="w"> </span><span class="n">Belady</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">anomaly</span><span class="o">:</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">increase</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">cache</span>
</code></pre></div>

<h3 id="35-random-replacement">3.5 Random Replacement<a class="header-link" href="#35-random-replacement" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Principle</span><span class="o">:</span><span class="w"> </span><span class="n">Randomly</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">replace</span>

<span class="n">Implementation</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">generator</span>
<span class="o">-</span><span class="w"> </span><span class="n">Or</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">counter</span>

<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Insert</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Way</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="n">replaced</span>
<span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span>

<span class="n">Advantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Very</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">implementation</span>
<span class="o">-</span><span class="w"> </span><span class="n">Robust</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">pathological</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">patterns</span>
<span class="o">-</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Belady</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">anomaly</span>

<span class="n">Disadvantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Average</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">LRU</span>
<span class="o">-</span><span class="w"> </span><span class="n">Recently</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">replaced</span>

<span class="n">Practical</span><span class="w"> </span><span class="n">Use</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Some</span><span class="w"> </span><span class="n">ARM</span><span class="w"> </span><span class="n">processor</span><span class="w"> </span><span class="n">caches</span>
<span class="o">-</span><span class="w"> </span><span class="n">Random</span><span class="o">+</span><span class="n">LRU</span><span class="w"> </span><span class="n">hybrid</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">L2</span><span class="o">/</span><span class="n">L3</span><span class="w"> </span><span class="n">caches</span>
</code></pre></div>

<h3 id="36-replacement-policy-comparison">3.6 Replacement Policy Comparison<a class="header-link" href="#36-replacement-policy-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Miss</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">comparison</span><span class="w"> </span><span class="p">(</span><span class="n">typical</span><span class="w"> </span><span class="n">workloads</span><span class="p">):</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Policy</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Relative</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="err">â”‚</span><span class="w">          </span><span class="n">Features</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Rate</span><span class="w">      </span><span class="err">â”‚</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Optimal</span><span class="w"> </span><span class="p">(</span><span class="n">OPT</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="mf">1.00</span><span class="n">x</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Theoretical</span><span class="w"> </span><span class="n">optimal</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w"> </span><span class="p">(</span><span class="n">requires</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">knowledge</span><span class="p">)</span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">LRU</span><span class="w">            </span><span class="err">â”‚</span><span class="w">    </span><span class="mf">1.05</span><span class="n">x</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Very</span><span class="w"> </span><span class="n">good</span><span class="p">,</span><span class="w"> </span><span class="n">complex</span><span class="w"> </span><span class="n">impl</span><span class="o">.</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Pseudo</span><span class="o">-</span><span class="n">LRU</span><span class="w">     </span><span class="err">â”‚</span><span class="w">    </span><span class="mf">1.08</span><span class="n">x</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">LRU</span><span class="w"> </span><span class="n">approximation</span><span class="p">,</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w"> </span><span class="n">efficient</span><span class="w"> </span><span class="n">implementation</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Random</span><span class="w">         </span><span class="err">â”‚</span><span class="w">    </span><span class="mf">1.15</span><span class="n">x</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Simple</span><span class="p">,</span><span class="w"> </span><span class="n">reasonable</span><span class="w"> </span><span class="n">perf</span><span class="o">.</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">FIFO</span><span class="w">           </span><span class="err">â”‚</span><span class="w">    </span><span class="mf">1.20</span><span class="n">x</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Simplest</span><span class="p">,</span><span class="w"> </span><span class="n">lowest</span><span class="w"> </span><span class="n">perf</span><span class="o">.</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="4-cache-write-policies">4. Cache Write Policies<a class="header-link" href="#4-cache-write-policies" title="Permanent link">&para;</a></h2>
<h3 id="41-write-through">4.1 Write-Through<a class="header-link" href="#41-write-through" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Principle</span><span class="o">:</span><span class="w"> </span><span class="n">Update</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">write</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">Write</span><span class="o">-</span><span class="n">Through</span><span class="w"> </span><span class="n">Operation</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">         </span><span class="n">CPU</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="err">â–¼</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Cache</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                        </span><span class="err">â–¼</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Memory</span><span class="w">  </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Cache</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">consistent</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Advantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">consistent</span>
<span class="o">-</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">write</span><span class="o">-</span><span class="n">back</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">replacement</span>
<span class="o">-</span><span class="w"> </span><span class="n">Simple</span><span class="w"> </span><span class="n">implementation</span>
<span class="o">-</span><span class="w"> </span><span class="n">Easy</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">recovery</span><span class="w"> </span><span class="o">(</span><span class="n">power</span><span class="w"> </span><span class="n">failure</span><span class="o">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.)</span>

<span class="n">Disadvantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">slow</span>
<span class="o">-</span><span class="w"> </span><span class="n">Consumes</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">bandwidth</span>

<span class="n">Mitigation</span><span class="o">:</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">Buffer</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">CPU</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">Buffer</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Memory</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="err">â†‘</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">            </span><span class="n">CPU</span><span class="w"> </span><span class="n">continues</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">fills</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="42-write-back">4.2 Write-Back<a class="header-link" href="#42-write-back" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Principle</span><span class="o">:</span><span class="w"> </span><span class="n">Update</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">write</span><span class="o">,</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">replacement</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="n">Write</span><span class="o">-</span><span class="n">Back</span><span class="w"> </span><span class="n">Operation</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">occurs</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">         </span><span class="n">CPU</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="err">â–¼</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Cache</span><span class="w">  </span><span class="err">â”‚</span><span class="w">       </span><span class="n">No</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">access</span><span class="o">!</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">â”‚â—„â”€â”€</span><span class="w"> </span><span class="n">Dirty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">On</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">replacement</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Cache</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”€â”€â”€</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">Dirty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="err">â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                                      </span><span class="err">â–¼</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Memory</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”‚</span><span class="w">  </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                             </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Dirty</span><span class="w"> </span><span class="n">Bit</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Indicates</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">modified</span>
<span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">Modified</span><span class="w"> </span><span class="o">(</span><span class="n">inconsistent</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">memory</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="o">(</span><span class="n">consistent</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">memory</span><span class="o">)</span>

<span class="n">Advantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Improved</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="o">(</span><span class="n">reduced</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">access</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Efficient</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">repeated</span><span class="w"> </span><span class="n">writes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">address</span>
<span class="o">-</span><span class="w"> </span><span class="n">Saves</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">bandwidth</span>

<span class="n">Disadvantages</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Complex</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="o">(</span><span class="n">dirty</span><span class="w"> </span><span class="n">bit</span><span class="o">,</span><span class="w"> </span><span class="n">write</span><span class="o">-</span><span class="n">back</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">replacement</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Cache</span><span class="o">-</span><span class="n">memory</span><span class="w"> </span><span class="n">inconsistency</span><span class="w"> </span><span class="n">possible</span>
<span class="o">-</span><span class="w"> </span><span class="n">Delay</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">replacement</span>
</code></pre></div>

<h3 id="43-write-allocate-vs-no-write-allocate">4.3 Write Allocate vs No-Write Allocate<a class="header-link" href="#43-write-allocate-vs-no-write-allocate" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">How</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">misses</span><span class="p">:</span>

<span class="n">Write</span><span class="w"> </span><span class="n">Allocate</span><span class="w"> </span><span class="p">(</span><span class="n">Fetch</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">Write</span><span class="p">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Write</span><span class="w"> </span><span class="n">miss</span><span class="w"> </span><span class="n">occurs</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â†“</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Load</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">cache</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â†“</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Perform</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cache</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Typically</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Write</span><span class="o">-</span><span class="n">Back</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Exploits</span><span class="w"> </span><span class="n">spatial</span><span class="w"> </span><span class="n">locality</span><span class="p">:</span><span class="w"> </span><span class="n">adjacent</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">loaded</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">No</span><span class="o">-</span><span class="n">Write</span><span class="w"> </span><span class="n">Allocate</span><span class="w"> </span><span class="p">(</span><span class="n">Write</span><span class="w"> </span><span class="n">Around</span><span class="p">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Write</span><span class="w"> </span><span class="n">miss</span><span class="w"> </span><span class="n">occurs</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â†“</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Write</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="p">(</span><span class="n">no</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="nb">load</span><span class="p">)</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Typically</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Write</span><span class="o">-</span><span class="n">Through</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Efficient</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">read</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Common</span><span class="w"> </span><span class="n">combinations</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Write</span><span class="w"> </span><span class="n">Policy</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Allocate</span><span class="w"> </span><span class="n">Policy</span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Write</span><span class="o">-</span><span class="n">Back</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Write</span><span class="w"> </span><span class="n">Allocate</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Write</span><span class="o">-</span><span class="n">Through</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">No</span><span class="o">-</span><span class="n">Write</span><span class="w"> </span><span class="n">Alloc</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="44-write-policy-comparison">4.4 Write Policy Comparison<a class="header-link" href="#44-write-policy-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">    </span><span class="nv">Property</span><span class="w">     </span>â”‚<span class="w">   </span><span class="nv">Write</span><span class="o">-</span><span class="nv">Through</span><span class="w">    </span>â”‚<span class="w">    </span><span class="nv">Write</span><span class="o">-</span><span class="nv">Back</span><span class="w">      </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Write</span><span class="w"> </span><span class="nv">Latency</span><span class="w">   </span>â”‚<span class="w">   </span><span class="nv">High</span><span class="w"> </span><span class="ss">(</span><span class="nv">memory</span><span class="ss">)</span><span class="w">    </span>â”‚<span class="w">   </span><span class="nv">Low</span><span class="w"> </span><span class="ss">(</span><span class="nv">cache</span><span class="ss">)</span><span class="w">      </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Implementation</span><span class="w">  </span>â”‚<span class="w">       </span><span class="nv">Low</span><span class="w">          </span>â”‚<span class="w">      </span><span class="nv">High</span><span class="w">          </span>â”‚
â”‚<span class="w"> </span><span class="nv">Complexity</span><span class="w">      </span>â”‚<span class="w">                    </span>â”‚<span class="w">                    </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Memory</span><span class="w"> </span><span class="nv">Traffic</span><span class="w">  </span>â”‚<span class="w">       </span><span class="nv">High</span><span class="w">         </span>â”‚<span class="w">      </span><span class="nv">Low</span><span class="w">           </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Data</span><span class="w"> </span><span class="nv">Consistency</span>â”‚<span class="w">    </span><span class="nv">Guaranteed</span><span class="w">      </span>â”‚<span class="w">   </span><span class="nv">Needs</span><span class="w"> </span><span class="nv">management</span><span class="w"> </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Replacement</span><span class="w">     </span>â”‚<span class="w">       </span><span class="nv">None</span><span class="w">         </span>â”‚<span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="nv">dirty</span>,<span class="w"> </span><span class="nv">yes</span><span class="w">     </span>â”‚
â”‚<span class="w"> </span><span class="nv">Overhead</span><span class="w">        </span>â”‚<span class="w">                    </span>â”‚<span class="w">                    </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w"> </span><span class="nv">Practical</span><span class="w"> </span><span class="nv">Use</span><span class="w">   </span>â”‚<span class="w">  </span><span class="nv">L1</span><span class="w"> </span><span class="ss">(</span><span class="nv">some</span><span class="ss">)</span>,<span class="w">        </span>â”‚<span class="w">  </span><span class="nv">L1</span>,<span class="w"> </span><span class="nv">L2</span>,<span class="w"> </span><span class="nv">L3</span><span class="w">        </span>â”‚
â”‚<span class="w">                 </span>â”‚<span class="w">  </span><span class="nv">Embedded</span><span class="w">          </span>â”‚<span class="w">                    </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="5-types-of-cache-misses">5. Types of Cache Misses<a class="header-link" href="#5-types-of-cache-misses" title="Permanent link">&para;</a></h2>
<h3 id="51-3c-classification">5.1 3C Classification<a class="header-link" href="#51-3c-classification" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Three causes of cache misses (3C Model):

1. Cold Miss (Compulsory Miss)
2. Capacity Miss
3. Conflict Miss
</code></pre></div>

<h3 id="52-cold-miss-compulsory-miss">5.2 Cold Miss (Compulsory Miss)<a class="header-link" href="#52-cold-miss-compulsory-miss" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Definition</span><span class="o">:</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">block</span>
<span class="o">-</span><span class="w"> </span><span class="n">Occurs</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">empty</span>
<span class="o">-</span><span class="w"> </span><span class="n">Occurs</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">size</span>
<span class="o">-</span><span class="w"> </span><span class="n">Unavoidable</span><span class="w"> </span><span class="o">(</span><span class="n">can</span><span class="w"> </span><span class="n">mitigate</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">prefetching</span><span class="o">)</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">At</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">start</span><span class="o">:</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="o">(</span><span class="n">first</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">A</span><span class="o">)</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="o">(</span><span class="n">first</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">B</span><span class="o">)</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Hit</span><span class="w">  </span><span class="o">(</span><span class="n">already</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">cache</span><span class="o">)</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="o">(</span><span class="n">first</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">C</span><span class="o">)</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">First</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">misses</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">Cold</span><span class="w"> </span><span class="n">Misses</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Mitigation</span><span class="w"> </span><span class="n">methods</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Prefetching</span>
<span class="o">-</span><span class="w"> </span><span class="n">Larger</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">(</span><span class="n">exploit</span><span class="w"> </span><span class="n">spatial</span><span class="w"> </span><span class="n">locality</span><span class="o">)</span>
</code></pre></div>

<h3 id="53-capacity-miss">5.3 Capacity Miss<a class="header-link" href="#53-capacity-miss" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Definition</span><span class="o">:</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">insufficient</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">capacity</span>
<span class="o">-</span><span class="w"> </span><span class="n">Occurs</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">Working</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">size</span>
<span class="o">-</span><span class="w"> </span><span class="n">Previously</span><span class="w"> </span><span class="n">cached</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">capacity</span><span class="o">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">accessed</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="o">-</span><span class="n">block</span><span class="w"> </span><span class="n">cache</span><span class="o">,</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">cache</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="o">-,</span><span class="w"> </span><span class="o">-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">cache</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="o">-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">cache</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="o">-]</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">cache</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">]</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">full</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">cache</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">]</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">replaced</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="o">!</span><span class="w">                      </span><span class="err">â†</span><span class="w"> </span><span class="n">Capacity</span><span class="w"> </span><span class="n">Miss</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">            </span><span class="n">cache</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">]</span><span class="w">        </span><span class="o">(</span><span class="n">A</span><span class="w"> </span><span class="n">evicted</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                        </span><span class="n">capacity</span><span class="o">)</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Mitigation</span><span class="w"> </span><span class="n">methods</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Increase</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">size</span>
<span class="o">-</span><span class="w"> </span><span class="n">Optimize</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">structures</span><span class="w"> </span><span class="o">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">Working</span><span class="w"> </span><span class="n">Set</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Loop</span><span class="w"> </span><span class="n">tiling</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">optimizations</span>
</code></pre></div>

<h3 id="54-conflict-miss">5.4 Conflict Miss<a class="header-link" href="#54-conflict-miss" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Definition</span><span class="o">:</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">competing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">location</span>
<span class="o">-</span><span class="w"> </span><span class="n">Occurs</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">direct</span><span class="w"> </span><span class="n">mapped</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="kd">set</span><span class="w"> </span><span class="n">associative</span><span class="w"> </span><span class="n">caches</span>
<span class="o">-</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="n">despite</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">contention</span>
<span class="o">-</span><span class="w"> </span><span class="n">Does</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">occur</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">fully</span><span class="w"> </span><span class="n">associative</span><span class="w"> </span><span class="n">caches</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">cache</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">sets</span><span class="o">,</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">order</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">(</span><span class="n">all</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Initial</span><span class="o">:</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="o">-],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">full</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">I</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">replaced</span><span class="o">,</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">empty</span><span class="o">!</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Access</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Miss</span><span class="o">!</span><span class="w"> </span><span class="err">â†</span><span class="w"> </span><span class="n">Conflict</span><span class="w"> </span><span class="n">Miss</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">I</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">  </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">empty</span><span class="o">)</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">50</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">miss</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Conflict</span><span class="w"> </span><span class="n">Miss</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Mitigation</span><span class="w"> </span><span class="n">methods</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Increase</span><span class="w"> </span><span class="n">associativity</span><span class="w"> </span><span class="o">(</span><span class="n">increase</span><span class="w"> </span><span class="n">N</span><span class="o">-</span><span class="n">way</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Skewed</span><span class="w"> </span><span class="n">cache</span>
<span class="o">-</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">cache</span>
</code></pre></div>

<h3 id="55-3c-miss-proportions">5.5 3C Miss Proportions<a class="header-link" href="#55-3c-miss-proportions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Typical program miss proportions:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  â”‚ 100%â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â”‚
â”‚  â”‚     â”‚ â–ˆ      Compulsory (Cold)     â–ˆ                    â”‚
â”‚  â”‚     â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                     â”‚
â”‚  â”‚  50%â”‚ â–ˆ     Capacity              â–ˆ                     â”‚
â”‚  â”‚     â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚
â”‚  â”‚     â”‚ â–ˆ           Conflict         â–ˆ                    â”‚
â”‚  â”‚   0%â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚        Small cache  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  Large cache         â”‚
â”‚                                                             â”‚
â”‚  - Increasing cache size: Reduces Capacity Miss            â”‚
â”‚  - Increasing associativity: Reduces Conflict Miss         â”‚
â”‚  - Cold Miss: Almost independent of cache size             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="6-multi-level-cache">6. Multi-Level Cache<a class="header-link" href="#6-multi-level-cache" title="Permanent link">&para;</a></h2>
<h3 id="61-need-for-multi-level-cache">6.1 Need for Multi-Level Cache<a class="header-link" href="#61-need-for-multi-level-cache" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">L1</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">optimization</span><span class="w"> </span><span class="n">dilemma</span>
<span class="o">-</span><span class="w"> </span><span class="n">Optimizing</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Small</span><span class="w"> </span><span class="n">cache</span><span class="o">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="n">associativity</span>
<span class="o">-</span><span class="w"> </span><span class="n">Optimizing</span><span class="w"> </span><span class="n">miss</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Large</span><span class="w"> </span><span class="n">cache</span><span class="o">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">associativity</span>

<span class="n">Solution</span><span class="o">:</span><span class="w"> </span><span class="n">Multi</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">cache</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">        </span><span class="n">CPU</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">Fast</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">needed</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">         </span><span class="err">â”‚</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">L1</span><span class="w"> </span><span class="n">Cache</span><span class="err">â”‚</span><span class="w">  </span><span class="n">Small</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="o">(</span><span class="n">hit</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">optimized</span><span class="o">)</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">32</span><span class="n">KB</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">cycles</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">         </span><span class="err">â”‚</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">L2</span><span class="w"> </span><span class="n">Cache</span><span class="err">â”‚</span><span class="w">  </span><span class="n">Medium</span><span class="w"> </span><span class="o">(</span><span class="n">balanced</span><span class="o">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">256</span><span class="n">KB</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">12</span><span class="w"> </span><span class="n">cycles</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">         </span><span class="err">â”‚</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">L3</span><span class="w"> </span><span class="n">Cache</span><span class="err">â”‚</span><span class="w">  </span><span class="n">Large</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="o">(</span><span class="n">miss</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">optimized</span><span class="o">)</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">8</span><span class="o">-</span><span class="mi">32</span><span class="n">MB</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">40</span><span class="w"> </span><span class="n">cycles</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">         </span><span class="err">â”‚</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Memory</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">100</span><span class="o">+</span><span class="w"> </span><span class="n">cycles</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="62-inclusive-vs-exclusive-cache">6.2 Inclusive vs Exclusive Cache<a class="header-link" href="#62-inclusive-vs-exclusive-cache" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Inclusive</span><span class="w"> </span><span class="nx">Cache</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Lower</span><span class="w"> </span><span class="nx">level</span><span class="w"> </span><span class="nx">contains</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">upper</span><span class="w"> </span><span class="nx">levels</span>
<span class="o">-</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">L1</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">also</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">L2</span>
<span class="o">-</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">L2</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">also</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">L3</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">L1</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nx">A</span><span class="p">,</span><span class="w"> </span><span class="nx">B</span><span class="p">,</span><span class="w"> </span><span class="nx">C</span><span class="p">,</span><span class="w"> </span><span class="nx">D</span><span class="p">]</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">L2</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nx">A</span><span class="p">,</span><span class="w"> </span><span class="nx">B</span><span class="p">,</span><span class="w"> </span><span class="nx">C</span><span class="p">,</span><span class="w"> </span><span class="nx">D</span><span class="p">,</span><span class="w"> </span><span class="nx">E</span><span class="p">,</span><span class="w"> </span><span class="nx">F</span><span class="p">,</span><span class="w"> </span><span class="nx">G</span><span class="p">,</span><span class="w"> </span><span class="nx">H</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="p">]</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">L3</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nx">A</span><span class="p">,</span><span class="w"> </span><span class="nx">B</span><span class="p">,</span><span class="w"> </span><span class="nx">C</span><span class="p">,</span><span class="w"> </span><span class="nx">D</span><span class="p">,</span><span class="w"> </span><span class="nx">E</span><span class="p">,</span><span class="w"> </span><span class="nx">F</span><span class="p">,</span><span class="w"> </span><span class="nx">G</span><span class="p">,</span><span class="w"> </span><span class="nx">H</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="p">,</span><span class="w"> </span><span class="nx">X</span><span class="p">,</span><span class="w"> </span><span class="nx">Y</span><span class="p">,</span><span class="w"> </span><span class="nx">Z</span><span class="p">]</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Advantages</span><span class="p">:</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Easy</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">maintain</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="nx">coherence</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Only</span><span class="w"> </span><span class="nx">need</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">check</span><span class="w"> </span><span class="nx">L3</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">snooping</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Disadvantages</span><span class="p">:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Reduced</span><span class="w"> </span><span class="nx">effective</span><span class="w"> </span><span class="nx">capacity</span><span class="w"> </span><span class="p">(</span><span class="nx">duplicate</span><span class="w"> </span><span class="nx">storage</span><span class="p">)</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">L3</span><span class="w"> </span><span class="nx">replacement</span><span class="w"> </span><span class="nx">requires</span><span class="w"> </span><span class="nx">L1</span><span class="o">/</span><span class="nx">L2</span><span class="w"> </span><span class="nx">invalidation</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">Exclusive</span><span class="w"> </span><span class="nx">Cache</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Each</span><span class="w"> </span><span class="nx">level</span><span class="w"> </span><span class="nx">stores</span><span class="w"> </span><span class="nx">different</span><span class="w"> </span><span class="nx">data</span>
<span class="o">-</span><span class="w"> </span><span class="nx">A</span><span class="w"> </span><span class="nx">block</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="nx">level</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">L1</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nx">A</span><span class="p">,</span><span class="w"> </span><span class="nx">B</span><span class="p">,</span><span class="w"> </span><span class="nx">C</span><span class="p">,</span><span class="w"> </span><span class="nx">D</span><span class="p">]</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">L2</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nx">E</span><span class="p">,</span><span class="w"> </span><span class="nx">F</span><span class="p">,</span><span class="w"> </span><span class="nx">G</span><span class="p">,</span><span class="w"> </span><span class="nx">H</span><span class="p">]</span><span class="w">  </span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">L1</span><span class="p">)</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">L3</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nx">I</span><span class="p">,</span><span class="w"> </span><span class="nx">J</span><span class="p">,</span><span class="w"> </span><span class="nx">K</span><span class="p">,</span><span class="w"> </span><span class="nx">L</span><span class="p">]</span><span class="w">  </span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">L1</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">L2</span><span class="p">)</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Advantages</span><span class="p">:</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Total</span><span class="w"> </span><span class="nx">effective</span><span class="w"> </span><span class="nx">capacity</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">L1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">L2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">L3</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Disadvantages</span><span class="p">:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Complex</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">movement</span><span class="w"> </span><span class="nx">between</span><span class="w"> </span><span class="nx">caches</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">L1</span><span class="w"> </span><span class="nx">miss</span><span class="w"> </span><span class="nx">requires</span><span class="w"> </span><span class="nx">sequential</span><span class="w"> </span><span class="nx">L2</span><span class="p">,</span><span class="w"> </span><span class="nx">L3</span><span class="w"> </span><span class="nx">search</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">NINE</span><span class="w"> </span><span class="p">(</span><span class="nx">Non</span><span class="o">-</span><span class="nx">Inclusive</span><span class="p">,</span><span class="w"> </span><span class="nx">Non</span><span class="o">-</span><span class="nx">Exclusive</span><span class="p">):</span>
<span class="o">-</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">consistency</span><span class="w"> </span><span class="nx">guarantee</span><span class="p">,</span><span class="w"> </span><span class="nx">freely</span><span class="w"> </span><span class="nx">placed</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Complex</span><span class="w"> </span><span class="nx">implementation</span><span class="w"> </span><span class="nx">but</span><span class="w"> </span><span class="nx">flexible</span>
</code></pre></div>

<h3 id="63-private-vs-shared-cache">6.3 Private vs Shared Cache<a class="header-link" href="#63-private-vs-shared-cache" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Modern</span><span class="w"> </span><span class="nv">multicore</span><span class="w"> </span><span class="nv">processor</span><span class="w"> </span><span class="nv">structure</span>:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">     </span><span class="nv">Core</span><span class="w"> </span><span class="mi">0</span><span class="w">          </span><span class="nv">Core</span><span class="w"> </span><span class="mi">1</span><span class="w">          </span><span class="nv">Core</span><span class="w"> </span><span class="mi">2</span><span class="w">          </span><span class="nv">Core</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span>â”‚
â”‚<span class="w">    </span>â”Œâ”€â”€â”€â”€â”€â”€â”<span class="w">        </span>â”Œâ”€â”€â”€â”€â”€â”€â”<span class="w">        </span>â”Œâ”€â”€â”€â”€â”€â”€â”<span class="w">        </span>â”Œâ”€â”€â”€â”€â”€â”€â”â”‚
â”‚<span class="w">    </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">I</span><span class="w"> </span>â”‚<span class="w">        </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">I</span><span class="w"> </span>â”‚<span class="w">        </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">I</span><span class="w"> </span>â”‚<span class="w">        </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">I</span><span class="w"> </span>â”‚â”‚
â”‚<span class="w">    </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">D</span><span class="w"> </span>â”‚<span class="w">        </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">D</span><span class="w"> </span>â”‚<span class="w">        </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">D</span><span class="w"> </span>â”‚<span class="w">        </span>â”‚<span class="w"> </span><span class="nv">L1</span><span class="o">-</span><span class="nv">D</span><span class="w"> </span>â”‚â”‚
â”‚<span class="w">    </span>â””â”€â”€â”¬â”€â”€â”€â”˜<span class="w">        </span>â””â”€â”€â”¬â”€â”€â”€â”˜<span class="w">        </span>â””â”€â”€â”¬â”€â”€â”€â”˜<span class="w">        </span>â””â”€â”€â”¬â”€â”€â”€â”˜â”‚
â”‚<span class="w">       </span>â”‚<span class="w">               </span>â”‚<span class="w">               </span>â”‚<span class="w">               </span>â”‚<span class="w">    </span>â”‚
â”‚<span class="w">    </span>â”Œâ”€â”€â”´â”€â”€â”€â”<span class="w">        </span>â”Œâ”€â”€â”´â”€â”€â”€â”<span class="w">        </span>â”Œâ”€â”€â”´â”€â”€â”€â”<span class="w">        </span>â”Œâ”€â”€â”´â”€â”€â”€â”â”‚
â”‚<span class="w">    </span>â”‚<span class="w">  </span><span class="nv">L2</span><span class="w">  </span>â”‚<span class="w">        </span>â”‚<span class="w">  </span><span class="nv">L2</span><span class="w">  </span>â”‚<span class="w">        </span>â”‚<span class="w">  </span><span class="nv">L2</span><span class="w">  </span>â”‚<span class="w">        </span>â”‚<span class="w">  </span><span class="nv">L2</span><span class="w">  </span>â”‚â”‚
â”‚<span class="w">    </span>â”‚<span class="ss">(</span><span class="nv">priv</span><span class="ss">)</span>â”‚<span class="w">        </span>â”‚<span class="ss">(</span><span class="nv">priv</span><span class="ss">)</span>â”‚<span class="w">        </span>â”‚<span class="ss">(</span><span class="nv">priv</span><span class="ss">)</span>â”‚<span class="w">        </span>â”‚<span class="ss">(</span><span class="nv">priv</span><span class="ss">)</span>â”‚â”‚
â”‚<span class="w">    </span>â””â”€â”€â”¬â”€â”€â”€â”˜<span class="w">        </span>â””â”€â”€â”¬â”€â”€â”€â”˜<span class="w">        </span>â””â”€â”€â”¬â”€â”€â”€â”˜<span class="w">        </span>â””â”€â”€â”¬â”€â”€â”€â”˜â”‚
â”‚<span class="w">       </span>â”‚<span class="w">               </span>â”‚<span class="w">               </span>â”‚<span class="w">               </span>â”‚<span class="w">    </span>â”‚
â”‚<span class="w">       </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">    </span>â”‚
â”‚<span class="w">                               </span>â”‚<span class="w">                             </span>â”‚
â”‚<span class="w">                      </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                    </span>â”‚
â”‚<span class="w">                      </span>â”‚<span class="w">       </span><span class="nv">L3</span><span class="w">        </span>â”‚<span class="w">                    </span>â”‚
â”‚<span class="w">                      </span>â”‚<span class="w">    </span><span class="ss">(</span><span class="nv">shared</span><span class="ss">)</span><span class="w">     </span>â”‚<span class="w">                    </span>â”‚
â”‚<span class="w">                      </span>â”‚<span class="w">    </span><span class="mi">8</span><span class="o">-</span><span class="mi">32</span><span class="nv">MB</span><span class="w">       </span>â”‚<span class="w">                    </span>â”‚
â”‚<span class="w">                      </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                    </span>â”‚
â”‚<span class="w">                               </span>â”‚<span class="w">                             </span>â”‚
â”‚<span class="w">                      </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                    </span>â”‚
â”‚<span class="w">                      </span>â”‚<span class="w">    </span><span class="nv">Main</span><span class="w"> </span><span class="nv">Memory</span><span class="w">   </span>â”‚<span class="w">                    </span>â”‚
â”‚<span class="w">                      </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                    </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="nv">Private</span><span class="w"> </span><span class="nv">Cache</span><span class="w"> </span><span class="ss">(</span><span class="nv">L1</span>,<span class="w"> </span><span class="nv">L2</span><span class="ss">)</span>:
<span class="o">-</span><span class="w"> </span><span class="nv">Dedicated</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">each</span><span class="w"> </span><span class="nv">core</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Minimizes</span><span class="w"> </span><span class="nv">access</span><span class="w"> </span><span class="nv">latency</span>
<span class="o">-</span><span class="w"> </span><span class="nv">No</span><span class="w"> </span><span class="nv">inter</span><span class="o">-</span><span class="nv">core</span><span class="w"> </span><span class="nv">interference</span>

<span class="nv">Shared</span><span class="w"> </span><span class="nv">Cache</span><span class="w"> </span><span class="ss">(</span><span class="nv">L3</span><span class="ss">)</span>:
<span class="o">-</span><span class="w"> </span><span class="nv">Shared</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">cores</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Efficient</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">inter</span><span class="o">-</span><span class="nv">core</span><span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="nv">sharing</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Dynamic</span><span class="w"> </span><span class="nv">capacity</span><span class="w"> </span><span class="nv">allocation</span><span class="w"> </span><span class="ss">(</span><span class="nv">more</span><span class="w"> </span><span class="nv">space</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">busy</span><span class="w"> </span><span class="nv">cores</span><span class="ss">)</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Requires</span><span class="w"> </span><span class="nv">coherence</span><span class="w"> </span><span class="nv">maintenance</span>
</code></pre></div>

<h3 id="64-local-vs-global-miss-rate">6.4 Local vs Global Miss Rate<a class="header-link" href="#64-local-vs-global-miss-rate" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Local Miss Rate:
Miss rate at that level

Global Miss Rate:
Proportion of total accesses reaching that level

Example:
- L1 miss rate: 5%
- L2 miss rate (Local): 20%
- L3 miss rate (Local): 30%

Global miss rate calculation:
- L2 Global Miss Rate = L1 Miss Rate Ã— L2 Local Miss Rate
                      = 0.05 Ã— 0.20 = 1%
                      (1% of all accesses reach L3)

- L3 Global Miss Rate = L2 Global Ã— L3 Local
                      = 0.01 Ã— 0.30 = 0.3%
                      (0.3% of all accesses reach memory)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Local vs Global Miss Rate                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Level  â”‚  Local Miss Rate  â”‚  Global Miss Rate            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”¤
â”‚   L1    â”‚       5%          â”‚       5%                     â”‚
â”‚   L2    â”‚      20%          â”‚       1% (0.05 Ã— 0.20)      â”‚
â”‚   L3    â”‚      30%          â”‚      0.3% (0.01 Ã— 0.30)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="7-cache-optimization-techniques">7. Cache Optimization Techniques<a class="header-link" href="#7-cache-optimization-techniques" title="Permanent link">&para;</a></h2>
<h3 id="71-victim-cache">7.1 Victim Cache<a class="header-link" href="#71-victim-cache" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Purpose</span><span class="o">:</span><span class="w"> </span><span class="n">Reduce</span><span class="w"> </span><span class="n">Conflict</span><span class="w"> </span><span class="n">Misses</span>

<span class="n">Structure</span><span class="o">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">        </span><span class="n">Main</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="o">(</span><span class="n">Direct</span><span class="w"> </span><span class="n">Mapped</span><span class="o">)</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">Replaced</span><span class="w"> </span><span class="n">block</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â–¼</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">    </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="o">(</span><span class="n">Fully</span><span class="w"> </span><span class="n">Associative</span><span class="o">)</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">         </span><span class="mi">4</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">entries</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Operation</span><span class="o">:</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">miss</span><span class="w"> </span><span class="n">occurs</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">Search</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Swap</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">hit</span>
<span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">memory</span><span class="o">,</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">goes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span>

<span class="n">Effect</span><span class="o">:</span><span class="w"> </span><span class="n">Absorbs</span><span class="w"> </span><span class="n">conflict</span><span class="w"> </span><span class="n">misses</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">size</span>
</code></pre></div>

<h3 id="72-prefetching">7.2 Prefetching<a class="header-link" href="#72-prefetching" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Hardware</span><span class="w"> </span><span class="nl">Prefetch</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">detects</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">patterns</span>
<span class="o">-</span><span class="w"> </span><span class="n">Preloads</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">needed</span>

<span class="n">Software</span><span class="w"> </span><span class="nl">Prefetch</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Programmer</span><span class="o">/</span><span class="n">compiler</span><span class="w"> </span><span class="n">inserts</span><span class="w"> </span><span class="n">prefetch</span><span class="w"> </span><span class="n">instructions</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Software</span><span class="w"> </span><span class="n">prefetch</span><span class="w"> </span><span class="n">example</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">__builtin_prefetch</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="o">[</span><span class="n">i + 16</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Prefetch</span><span class="w"> </span><span class="mi">16</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="nf">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">                           </span><span class="o">//</span><span class="w"> </span><span class="n">ahead</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">}</span><span class="w">                                                          </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Prefetch</span><span class="w"> </span><span class="nl">effect</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">Without</span><span class="w"> </span><span class="nl">Prefetch</span><span class="p">:</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Request</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="n">Latency</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Process</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">With</span><span class="w"> </span><span class="nl">Prefetch</span><span class="p">:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Prefetch</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="n">Latency</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”¬</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">               </span><span class="err">â”‚</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Request</span><span class="w"> </span><span class="err">â”€â”€â”¼â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="k">Data</span><span class="w"> </span><span class="n">arrives</span><span class="err">!</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Process</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                          </span><span class="err">â”‚</span><span class="w">      </span><span class="p">(</span><span class="n">fast</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Prefetch</span><span class="w"> </span><span class="n">hides</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">latency</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="73-compiler-optimizations">7.3 Compiler Optimizations<a class="header-link" href="#73-compiler-optimizations" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Loop</span><span class="w"> </span><span class="nl">Interchange</span><span class="p">:</span>
<span class="o">//</span><span class="w"> </span><span class="k">Before</span><span class="err">:</span><span class="w"> </span><span class="k">Column</span><span class="o">-</span><span class="n">major</span><span class="w"> </span><span class="p">(</span><span class="n">poor</span><span class="w"> </span><span class="n">locality</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="err">:</span><span class="w"> </span><span class="k">Row</span><span class="o">-</span><span class="n">major</span><span class="w"> </span><span class="p">(</span><span class="n">good</span><span class="w"> </span><span class="n">locality</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>


<span class="n">Loop</span><span class="w"> </span><span class="k">Fusion</span><span class="err">:</span>
<span class="o">//</span><span class="w"> </span><span class="k">Before</span><span class="err">:</span><span class="w"> </span><span class="n">Two</span><span class="w"> </span><span class="n">loops</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="err">:</span><span class="w"> </span><span class="n">One</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="p">(</span><span class="k">use</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cache</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="err">}</span>


<span class="n">Loop</span><span class="w"> </span><span class="nl">Tiling</span><span class="p">:</span>
<span class="o">//</span><span class="w"> </span><span class="k">Before</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="w">            </span><span class="n">C</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="o">[</span><span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="w"> </span><span class="p">(</span><span class="n">block</span><span class="o">-</span><span class="n">wise</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">reuse</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ii</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ii</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jj</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">jj</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kk</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">kk</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="w">                        </span><span class="n">C</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="o">[</span><span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>
</code></pre></div>

<hr />
<h2 id="8-practice-problems">8. Practice Problems<a class="header-link" href="#8-practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="basic-problems">Basic Problems<a class="header-link" href="#basic-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>With a 32KB direct-mapped cache and 64-byte blocks, how many cache lines are there?</p>
</li>
<li>
<p>In a 4-way set associative cache, how many locations can a specific memory block be stored in?</p>
</li>
<li>
<p>Explain the difference between Write-Through and Write-Back.</p>
</li>
</ol>
<h3 id="intermediate-problems">Intermediate Problems<a class="header-link" href="#intermediate-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>Find the Tag, Index, and Offset for the following address:</li>
<li>Address: 0x12345678</li>
<li>
<p>Cache: 16KB, 2-way set associative, 64-byte lines</p>
</li>
<li>
<p>Classify the type of cache miss for the following access pattern:
   (4-line direct-mapped cache, blocks A~D all map to same index)
   <code>A, B, C, D, A, E, A</code></p>
</li>
<li>
<p>L1 cache: 2-cycle hit time, 10% miss rate
   L2 cache: 10-cycle hit time, 5% miss rate
   Memory: 100-cycle access time
   Calculate the AMAT.</p>
</li>
</ol>
<h3 id="advanced-problems">Advanced Problems<a class="header-link" href="#advanced-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Analyze the cache performance of the following code (64-byte cache line, 4-byte int):
   <code>c
   int a[1024], b[1024], c[1024];
   for (int i = 0; i &lt; 1024; i++)
       c[i] = a[i] + b[i];</code></p>
</li>
<li>
<p>How many bits per set are needed to implement exact LRU policy in an 8-way set associative cache?</p>
</li>
<li>
<p>Explain the principle by which Victim Cache reduces Conflict Misses.</p>
</li>
</ol>
<details>
<summary>Answers</summary>

1. Number of cache lines = 32KB / 64B = 512 lines

2. 4 locations (4-way = 4 locations per set)

3. Write-Through: Updates cache and memory simultaneously, guarantees consistency
   Write-Back: Updates only cache, updates memory on replacement, better performance

4. Address decomposition:
   - 16KB, 2-way â†’ 128 sets (16KB / 64B / 2 = 128)
   - Offset: 6 bits (64B = 2^6)
   - Index: 7 bits (128 = 2^7)
   - Tag: 32 - 6 - 7 = 19 bits

   0x12345678 = 0001 0010 0011 0100 0101 0110 0111 1000
   - Offset: 111000 (0x38)
   - Index: 1011001 (0x59)
   - Tag: 0001 0010 0011 0100 0101 (0x12345)

5. Miss classification:
   - A: Cold Miss (first access)
   - B: Cold Miss
   - C: Cold Miss
   - D: Cold Miss
   - A: Conflict Miss (replaced by D)
   - E: Conflict Miss + Cold Miss
   - A: Conflict Miss (replaced by E)

6. AMAT = 2 + 0.10 Ã— (10 + 0.05 Ã— 100)
        = 2 + 0.10 Ã— 15
        = 2 + 1.5
        = 3.5 cycles

7. Cache analysis:
   - 64-byte line = 16 ints
   - Each array 1024 ints = 64 cache lines
   - Sequential access â†’ 1 miss per 16 accesses
   - Cold Misses: 64 Ã— 3 = 192 (for a, b, c each)
   - Hits: (1024 - 64) Ã— 3 = 2880
   - Hit rate: 2880 / 3072 = 93.75%

8. Exact LRU implementation:
   - Representing order of 8 ways: 8! = 40320 states
   - Bits needed: log2(40320) â‰ˆ 16 bits
   (In practice, approximate LRU is used)

9. Victim Cache principle:
   - Stores blocks replaced from Main Cache in Victim Cache
   - When a block replaced due to conflict is needed again, quickly found in Victim Cache
   - Small fully associative cache absorbs conflict misses

</details>

<hr />
<h2 id="next-steps">Next Steps<a class="header-link" href="#next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./16_Virtual_Memory.md">16_Virtual_Memory.md</a> - Virtual address space, page tables, TLB</li>
</ul>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Computer Architecture: A Quantitative Approach (Hennessy &amp; Patterson)</li>
<li><a href="https://www.ecs.umass.edu/ece/koren/architecture/Cache/frame1.htm">Cache Memory Visualization</a></li>
<li><a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel Optimization Manual - Cache</a></li>
<li>What Every Programmer Should Know About Memory (Ulrich Drepper)</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Architecture/14_Memory_Hierarchy.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Memory Hierarchy</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Computer_Architecture/16_Virtual_Memory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Virtual Memory</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}