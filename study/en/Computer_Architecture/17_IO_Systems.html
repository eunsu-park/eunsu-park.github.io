{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I/O Systems - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Computer_Architecture/">Computer Architecture</a>
    <span class="separator">/</span>
    <span class="current">I/O Systems</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>I/O Systems</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Architecture/16_Virtual_Memory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Virtual Memory</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Computer_Architecture/18_Parallel_Processing_Multicore.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Parallel Processing and Multicore</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-io-system-overview">1. I/O System Overview</a><ul>
<li><a href="#11-diversity-of-io-devices">1.1 Diversity of I/O Devices</a></li>
<li><a href="#12-io-system-structure">1.2 I/O System Structure</a></li>
<li><a href="#13-io-control-method-comparison">1.3 I/O Control Method Comparison</a></li>
</ul>
</li>
<li><a href="#2-programmed-io-polling">2. Programmed I/O (Polling)</a><ul>
<li><a href="#21-polling-concept">2.1 Polling Concept</a></li>
<li><a href="#22-io-ports-and-registers">2.2 I/O Ports and Registers</a></li>
<li><a href="#23-polling-programming-example">2.3 Polling Programming Example</a></li>
<li><a href="#24-advantages-and-disadvantages-of-polling">2.4 Advantages and Disadvantages of Polling</a></li>
</ul>
</li>
<li><a href="#3-interrupt-driven-io">3. Interrupt-Driven I/O</a><ul>
<li><a href="#31-interrupt-concept">3.1 Interrupt Concept</a></li>
<li><a href="#32-interrupt-processing-steps">3.2 Interrupt Processing Steps</a></li>
<li><a href="#33-interrupt-vector-table">3.3 Interrupt Vector Table</a></li>
<li><a href="#34-interrupt-based-io-programming">3.4 Interrupt-Based I/O Programming</a></li>
<li><a href="#35-advantages-and-disadvantages-of-interrupts">3.5 Advantages and Disadvantages of Interrupts</a></li>
</ul>
</li>
<li><a href="#4-dma-direct-memory-access">4. DMA (Direct Memory Access)</a><ul>
<li><a href="#41-dma-concept">4.1 DMA Concept</a></li>
<li><a href="#42-dma-operation-process">4.2 DMA Operation Process</a></li>
<li><a href="#43-dma-controller-structure">4.3 DMA Controller Structure</a></li>
<li><a href="#44-dma-transfer-modes">4.4 DMA Transfer Modes</a></li>
<li><a href="#45-dma-programming-example">4.5 DMA Programming Example</a></li>
</ul>
</li>
<li><a href="#5-bus-architecture">5. Bus Architecture</a><ul>
<li><a href="#51-types-of-buses">5.1 Types of Buses</a></li>
<li><a href="#52-bus-characteristics">5.2 Bus Characteristics</a></li>
<li><a href="#53-bus-arbitration">5.3 Bus Arbitration</a></li>
</ul>
</li>
<li><a href="#6-io-interfaces">6. I/O Interfaces</a><ul>
<li><a href="#61-io-addressing">6.1 I/O Addressing</a></li>
<li><a href="#62-device-driver-structure">6.2 Device Driver Structure</a></li>
</ul>
</li>
<li><a href="#7-modern-io-systems">7. Modern I/O Systems</a><ul>
<li><a href="#71-nvme-non-volatile-memory-express">7.1 NVMe (Non-Volatile Memory Express)</a></li>
<li><a href="#72-usb-system">7.2 USB System</a></li>
<li><a href="#73-io-virtualization">7.3 I/O Virtualization</a></li>
</ul>
</li>
<li><a href="#8-practice-problems">8. Practice Problems</a><ul>
<li><a href="#basic-problems">Basic Problems</a></li>
<li><a href="#intermediate-problems">Intermediate Problems</a></li>
<li><a href="#advanced-problems">Advanced Problems</a></li>
</ul>
</li>
<li><a href="#next-steps">Next Steps</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="io-systems">I/O Systems<a class="header-link" href="#io-systems" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>Input/Output (I/O) systems handle data transfer between the CPU and external devices (keyboard, disk, network, etc.). The design of the I/O system significantly impacts overall system performance and is implemented using various methods such as polling, interrupts, and DMA. This lesson covers the structure and operating principles of I/O systems.</p>
<p><strong>Difficulty</strong>: â­â­â­</p>
<p><strong>Prerequisites</strong>: CPU architecture, memory systems</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-io-system-overview">I/O System Overview</a></li>
<li><a href="#2-programmed-io-polling">Programmed I/O (Polling)</a></li>
<li><a href="#3-interrupt-driven-io">Interrupt-Driven I/O</a></li>
<li><a href="#4-dma-direct-memory-access">DMA (Direct Memory Access)</a></li>
<li><a href="#5-bus-architecture">Bus Architecture</a></li>
<li><a href="#6-io-interfaces">I/O Interfaces</a></li>
<li><a href="#7-modern-io-systems">Modern I/O Systems</a></li>
<li><a href="#8-practice-problems">Practice Problems</a></li>
</ol>
<hr />
<h2 id="1-io-system-overview">1. I/O System Overview<a class="header-link" href="#1-io-system-overview" title="Permanent link">&para;</a></h2>
<h3 id="11-diversity-of-io-devices">1.1 Diversity of I/O Devices<a class="header-link" href="#11-diversity-of-io-devices" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  I/O Device Classification                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Input Devices        Output Devices         Storage Devicesâ”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Keyboard â”‚       â”‚ Monitor  â”‚          â”‚ HDD/SSD  â”‚     â”‚
â”‚  â”‚ Mouse    â”‚       â”‚ Printer  â”‚          â”‚ USB      â”‚     â”‚
â”‚  â”‚ Scanner  â”‚       â”‚ Speaker  â”‚          â”‚ SD Card  â”‚     â”‚
â”‚  â”‚ Microphoneâ”‚      â”‚ LED      â”‚          â”‚ Optical  â”‚     â”‚
â”‚  â”‚ Touch    â”‚       â”‚          â”‚          â”‚ Drive    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚  Communication Devices                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Network Card (NIC), WiFi, Bluetooth, USB Hub          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

I/O Device Characteristics:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Device      â”‚   Data Rate  â”‚      Characteristics      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Keyboard        â”‚  ~100 B/s    â”‚ Slow, async, character    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Mouse           â”‚  ~1 KB/s     â”‚ Slow, sync, event-based   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Gigabit Ethernetâ”‚  125 MB/s    â”‚ High-speed, packet-based  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SATA SSD        â”‚  ~600 MB/s   â”‚ High-speed, block-based   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ NVMe SSD        â”‚  ~7 GB/s     â”‚ Ultra-fast, parallel      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4K Display      â”‚  ~20 GB/s    â”‚ Ultra-fast, streaming     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12-io-system-structure">1.2 I/O System Structure<a class="header-link" href="#12-io-system-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="n">Layers</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">              </span><span class="n">Application</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">         </span><span class="n">read</span><span class="p">(),</span><span class="w"> </span><span class="n">write</span><span class="p">(),</span><span class="w"> </span><span class="n">printf</span><span class="p">()</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â–¼</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">         </span><span class="n">Operating</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Subsystem</span><span class="w">              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">      </span><span class="n">Buffering</span><span class="p">,</span><span class="w"> </span><span class="n">Caching</span><span class="p">,</span><span class="w"> </span><span class="n">Spooling</span><span class="p">,</span><span class="w"> </span><span class="n">Scheduling</span><span class="w">       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â–¼</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">              </span><span class="n">Device</span><span class="w"> </span><span class="n">Driver</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="n">Device</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â–¼</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">              </span><span class="n">Hardware</span><span class="w"> </span><span class="n">Controller</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">        </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">ports</span><span class="p">,</span><span class="w"> </span><span class="n">registers</span><span class="p">,</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="n">interface</span><span class="w">          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                           </span><span class="err">â–¼</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">               </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">          </span><span class="n">Physical</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="p">(</span><span class="n">disk</span><span class="p">,</span><span class="w"> </span><span class="n">keyboard</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="p">.)</span><span class="w">     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="13-io-control-method-comparison">1.3 I/O Control Method Comparison<a class="header-link" href="#13-io-control-method-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”‚  Programmed I/O    â”‚   Interrupt I/O    â”‚
â”‚    Characteristic â”‚    (Polling)       â”‚                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CPU Involvement   â”‚      High          â”‚       Medium       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CPU Efficiency    â”‚      Low           â”‚       High         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Implementation    â”‚      Low           â”‚       Medium       â”‚
â”‚   Complexity      â”‚                    â”‚                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Suitable Devices  â”‚ Fast, predictable  â”‚  Slow, async       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Data Transfer     â”‚  Via CPU           â”‚   Via CPU          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”‚       DMA          â”‚
â”‚    Characteristic â”‚                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CPU Involvement   â”‚       Low          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CPU Efficiency    â”‚     Very High      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Implementation    â”‚       High         â”‚
â”‚   Complexity      â”‚                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Suitable Devices  â”‚   Bulk transfer    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Data Transfer     â”‚   Direct memory    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-programmed-io-polling">2. Programmed I/O (Polling)<a class="header-link" href="#2-programmed-io-polling" title="Permanent link">&para;</a></h2>
<h3 id="21-polling-concept">2.1 Polling Concept<a class="header-link" href="#21-polling-concept" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Definition</span><span class="o">:</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">periodically</span><span class="w"> </span><span class="n">checks</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">transfer</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">Polling</span><span class="w"> </span><span class="n">Operation</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">CPU</span><span class="w">                           </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">(</span><span class="n">ready</span><span class="o">?)</span><span class="w">     </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;Not ready&quot;</span><span class="w">                </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">(</span><span class="n">again</span><span class="o">)</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;Not ready&quot;</span><span class="w">                </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">         </span><span class="o">...</span><span class="n">repeat</span><span class="o">...</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="n">N</span><span class="o">.</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">status</span><span class="w">               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;Ready&quot;</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">Read</span><span class="w"> </span><span class="n">data</span><span class="w">                </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">waits</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="o">(</span><span class="n">Busy</span><span class="w"> </span><span class="n">Waiting</span><span class="o">)</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="22-io-ports-and-registers">2.2 I/O Ports and Registers<a class="header-link" href="#22-io-ports-and-registers" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>I/O Device Controller Registers:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              I/O Controller Registers                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Status Register                                     â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚ â”‚Busy â”‚Readyâ”‚Errorâ”‚ IRQ â”‚ ... â”‚ ... â”‚ ... â”‚ ... â”‚  â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚ - Displays device status (read-only)                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Control Register                                    â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚ â”‚Startâ”‚ IE  â”‚Mode â”‚ Dir â”‚ ... â”‚ ... â”‚ ... â”‚ ... â”‚  â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚ - Device control commands (write)                   â”‚    â”‚
â”‚  â”‚ - IE: Interrupt Enable                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Data Register                                       â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚ â”‚                Data (8/16/32 bits)            â”‚   â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚ - Actual transfer data                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="23-polling-programming-example">2.3 Polling Programming Example<a class="header-link" href="#23-polling-programming-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Simple polling-based I/O code</span>

<span class="cp">#define STATUS_REG  0x3F8  </span><span class="c1">// Status register address</span>
<span class="cp">#define DATA_REG    0x3F9  </span><span class="c1">// Data register address</span>
<span class="cp">#define READY_BIT   0x01   </span><span class="c1">// Ready bit mask</span>

<span class="c1">// Character output (polling)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">putchar_polling</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Wait until device is ready (Busy Wait)</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">inb</span><span class="p">(</span><span class="n">STATUS_REG</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">READY_BIT</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// CPU keeps looping and checking</span>
<span class="w">        </span><span class="c1">// Unable to do anything else</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Transfer data</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DATA_REG</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// String output</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">print_string_polling</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">putchar_polling</span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="o">++</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Character input (polling)</span>
<span class="kt">char</span><span class="w"> </span><span class="nf">getchar_polling</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Wait until input data is available</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">inb</span><span class="p">(</span><span class="n">STATUS_REG</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">READY_BIT</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Busy Wait</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">inb</span><span class="p">(</span><span class="n">DATA_REG</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="24-advantages-and-disadvantages-of-polling">2.4 Advantages and Disadvantages of Polling<a class="header-link" href="#24-advantages-and-disadvantages-of-polling" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Advantages</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Simple</span><span class="w"> </span><span class="nx">implementation</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Minimal</span><span class="w"> </span><span class="nx">hardware</span><span class="w"> </span><span class="nx">requirements</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Predictable</span><span class="w"> </span><span class="nx">timing</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Efficient</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">fast</span><span class="w"> </span><span class="nx">devices</span><span class="w"> </span><span class="p">(</span><span class="nx">when</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">ready</span><span class="w"> </span><span class="nx">instantly</span><span class="p">)</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Minimizes</span><span class="w"> </span><span class="nx">jitter</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">real</span><span class="o">-</span><span class="nx">time</span><span class="w"> </span><span class="nx">systems</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">Disadvantages</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Wastes</span><span class="w"> </span><span class="nx">CPU</span><span class="w"> </span><span class="nx">time</span><span class="w"> </span><span class="p">(</span><span class="nx">Busy</span><span class="w"> </span><span class="nx">Waiting</span><span class="p">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Very</span><span class="w"> </span><span class="nx">inefficient</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">slow</span><span class="w"> </span><span class="nx">devices</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Difficult</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">handle</span><span class="w"> </span><span class="nx">multiple</span><span class="w"> </span><span class="nx">devices</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Increased</span><span class="w"> </span><span class="nx">power</span><span class="w"> </span><span class="nx">consumption</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">CPU</span><span class="w"> </span><span class="nx">Time</span><span class="w"> </span><span class="nx">Waste</span><span class="w"> </span><span class="nx">Calculation</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Serial</span><span class="w"> </span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="mi">115200</span><span class="w"> </span><span class="nx">bps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">11520</span><span class="w"> </span><span class="nx">characters</span><span class="o">/</span><span class="nx">sec</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Per</span><span class="w"> </span><span class="nx">character</span><span class="p">:</span><span class="w"> </span><span class="o">~</span><span class="mi">87</span><span class="nx">us</span>
<span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="nx">GHz</span><span class="w"> </span><span class="nx">CPU</span><span class="p">:</span><span class="w"> </span><span class="mi">87</span><span class="nx">us</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">261</span><span class="p">,</span><span class="mi">000</span><span class="w"> </span><span class="nx">cycles</span>
<span class="o">-</span><span class="w"> </span><span class="nx">CPU</span><span class="w"> </span><span class="nx">waits</span><span class="w"> </span><span class="mi">260</span><span class="p">,</span><span class="mi">000</span><span class="w"> </span><span class="nx">cycles</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">transfer</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="nx">character</span><span class="p">!</span>
</code></pre></div>

<hr />
<h2 id="3-interrupt-driven-io">3. Interrupt-Driven I/O<a class="header-link" href="#3-interrupt-driven-io" title="Permanent link">&para;</a></h2>
<h3 id="31-interrupt-concept">3.1 Interrupt Concept<a class="header-link" href="#31-interrupt-concept" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Definition</span><span class="o">:</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">asynchronously</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">processing</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="n">Interrupt</span><span class="w"> </span><span class="n">Operation</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">CPU</span><span class="w"> </span><span class="o">(</span><span class="n">performing</span><span class="w"> </span><span class="n">tasks</span><span class="o">)</span><span class="w">                </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                                      </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Issue</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">command</span><span class="w">                </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                                      </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">Perform</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tasks</span><span class="w">              </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="o">(</span><span class="n">Don</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">completion</span><span class="o">)</span><span class="w">     </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                                      </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">         </span><span class="o">...</span><span class="n">time</span><span class="w"> </span><span class="n">passes</span><span class="o">...</span><span class="w">            </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">Process</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                                      </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="n">Interrupt</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="o">(</span><span class="n">IRQ</span><span class="o">)</span><span class="w">           </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚â—€â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                                      </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">5</span><span class="o">.</span><span class="w"> </span><span class="n">Save</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">state</span><span class="w">               </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">6</span><span class="o">.</span><span class="w"> </span><span class="n">Execute</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">handler</span><span class="w">        </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">7</span><span class="o">.</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">data</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">8</span><span class="o">.</span><span class="w"> </span><span class="n">Resume</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">task</span><span class="w">             </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span><span class="w">                                      </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Advantage</span><span class="o">:</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tasks</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">waiting</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="32-interrupt-processing-steps">3.2 Interrupt Processing Steps<a class="header-link" href="#32-interrupt-processing-steps" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">               </span><span class="n">Detailed</span><span class="w"> </span><span class="n">Interrupt</span><span class="w"> </span><span class="n">Processing</span><span class="w"> </span><span class="n">Steps</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">Device</span><span class="w"> </span><span class="n">activates</span><span class="w"> </span><span class="n">IRQ</span><span class="w"> </span><span class="n">line</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Signal</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="p">(</span><span class="n">PIC</span><span class="o">/</span><span class="n">APIC</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">Interrupt</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="n">sends</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">CPU</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">priority</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Forward</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">masked</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">checks</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">completing</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">instruction</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="p">(</span><span class="n">IF</span><span class="p">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Start</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">interrupts</span><span class="w"> </span><span class="n">enabled</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">Save</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">state</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="n">register</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">stack</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">CS</span><span class="p">:</span><span class="n">IP</span><span class="w"> </span><span class="p">(</span><span class="ow">or</span><span class="w"> </span><span class="n">RIP</span><span class="p">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">stack</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Disable</span><span class="w"> </span><span class="n">interrupts</span><span class="w"> </span><span class="p">(</span><span class="n">prevent</span><span class="w"> </span><span class="n">nesting</span><span class="p">)</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">5.</span><span class="w"> </span><span class="n">Reference</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">table</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">handler</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">number</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">6.</span><span class="w"> </span><span class="n">Execute</span><span class="w"> </span><span class="n">Interrupt</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Routine</span><span class="w"> </span><span class="p">(</span><span class="n">ISR</span><span class="p">)</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Execute</span><span class="w"> </span><span class="n">device</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="n">code</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">acknowledge</span><span class="w"> </span><span class="k">signal</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">7.</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">EOI</span><span class="w"> </span><span class="p">(</span><span class="n">End</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Interrupt</span><span class="p">)</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Notify</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="n">complete</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">8.</span><span class="w"> </span><span class="n">Return</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">IRET</span><span class="w"> </span><span class="n">instruction</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Restore</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="n">state</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Return</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">code</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="33-interrupt-vector-table">3.3 Interrupt Vector Table<a class="header-link" href="#33-interrupt-vector-table" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>x86 Interrupt Vector Table (IDT):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Interrupt Descriptor Table (IDT)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Vec  â”‚ Description                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  0   â”‚ Divide Error (#DE)                                   â”‚
â”‚  1   â”‚ Debug Exception (#DB)                                â”‚
â”‚  2   â”‚ NMI (Non-Maskable Interrupt)                         â”‚
â”‚  3   â”‚ Breakpoint (#BP)                                     â”‚
â”‚  6   â”‚ Invalid Opcode (#UD)                                 â”‚
â”‚  8   â”‚ Double Fault (#DF)                                   â”‚
â”‚ 13   â”‚ General Protection Fault (#GP)                       â”‚
â”‚ 14   â”‚ Page Fault (#PF)                                     â”‚
â”‚ ...  â”‚ ...                                                  â”‚
â”‚ 32   â”‚ IRQ 0: Timer (PIT)                                   â”‚
â”‚ 33   â”‚ IRQ 1: Keyboard                                      â”‚
â”‚ 34   â”‚ IRQ 2: Cascade (PIC2 connection)                     â”‚
â”‚ 35   â”‚ IRQ 3: COM2/COM4                                     â”‚
â”‚ 36   â”‚ IRQ 4: COM1/COM3                                     â”‚
â”‚ ...  â”‚ ...                                                  â”‚
â”‚ 46   â”‚ IRQ 14: Primary IDE                                  â”‚
â”‚ 47   â”‚ IRQ 15: Secondary IDE                                â”‚
â”‚ ...  â”‚ ...                                                  â”‚
â”‚ 128  â”‚ System Call (Linux: int 0x80)                        â”‚
â”‚ ...  â”‚ ...                                                  â”‚
â”‚ 255  â”‚ Reserved                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

IDT Entry Structure (64-bit):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  63        48 47 46  44 43    40 39  35 34  32             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚  Offset   â”‚P â”‚ DPL  â”‚  Type  â”‚ IST â”‚  0  â”‚              â”‚
â”‚  â”‚   [63:48] â”‚  â”‚      â”‚        â”‚     â”‚     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜              â”‚
â”‚  31              16 15                0                     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
â”‚  â”‚  Segment Sel.   â”‚  Offset [15:0]  â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="34-interrupt-based-io-programming">3.4 Interrupt-Based I/O Programming<a class="header-link" href="#34-interrupt-based-io-programming" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Interrupt-based keyboard driver example</span>

<span class="cp">#define KEYBOARD_IRQ    1</span>
<span class="cp">#define KEYBOARD_PORT   0x60</span>

<span class="c1">// Keyboard buffer</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">keyboard_buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">buffer_head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Interrupt handler (ISR)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">keyboard_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Read scancode</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">scancode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inb</span><span class="p">(</span><span class="n">KEYBOARD_PORT</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. Store in buffer</span>
<span class="w">    </span><span class="n">keyboard_buffer</span><span class="p">[</span><span class="n">buffer_head</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scancode</span><span class="p">;</span>
<span class="w">    </span><span class="n">buffer_head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">buffer_head</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 3. Send EOI (notify interrupt complete)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="mh">0x20</span><span class="p">,</span><span class="w"> </span><span class="mh">0x20</span><span class="p">);</span><span class="w">  </span><span class="c1">// EOI to PIC</span>
<span class="p">}</span>

<span class="c1">// Read character (blocking)</span>
<span class="kt">char</span><span class="w"> </span><span class="nf">getchar_interrupt</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Wait until data is in buffer</span>
<span class="w">    </span><span class="c1">// (In practice, use sleep/wakeup)</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">buffer_head</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// CPU sleep or run other processes</span>
<span class="w">        </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;hlt&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Halt until interrupt</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyboard_buffer</span><span class="p">[</span><span class="n">buffer_tail</span><span class="p">];</span>
<span class="w">    </span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Register interrupt handler</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">init_keyboard</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Register handler in IDT</span>
<span class="w">    </span><span class="n">set_interrupt_handler</span><span class="p">(</span><span class="mi">32</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">KEYBOARD_IRQ</span><span class="p">,</span><span class="w"> </span><span class="n">keyboard_handler</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Enable interrupt</span>
<span class="w">    </span><span class="n">enable_irq</span><span class="p">(</span><span class="n">KEYBOARD_IRQ</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="35-advantages-and-disadvantages-of-interrupts">3.5 Advantages and Disadvantages of Interrupts<a class="header-link" href="#35-advantages-and-disadvantages-of-interrupts" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Advantages</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Improved</span><span class="w"> </span><span class="nx">CPU</span><span class="w"> </span><span class="nx">efficiency</span><span class="w"> </span><span class="p">(</span><span class="nx">perform</span><span class="w"> </span><span class="nx">other</span><span class="w"> </span><span class="nx">tasks</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nx">waiting</span><span class="p">)</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Suitable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">asynchronous</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="nx">processing</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Easy</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">handle</span><span class="w"> </span><span class="nx">multiple</span><span class="w"> </span><span class="nx">devices</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Power</span><span class="w"> </span><span class="nx">efficient</span><span class="w"> </span><span class="p">(</span><span class="nx">CPU</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">enter</span><span class="w"> </span><span class="nx">sleep</span><span class="w"> </span><span class="nx">state</span><span class="p">)</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">Disadvantages</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Increased</span><span class="w"> </span><span class="nx">implementation</span><span class="w"> </span><span class="nx">complexity</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Interrupt</span><span class="w"> </span><span class="nx">overhead</span><span class="w"> </span><span class="p">(</span><span class="nx">context</span><span class="w"> </span><span class="nx">save</span><span class="o">/</span><span class="nx">restore</span><span class="p">)</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Interrupt</span><span class="w"> </span><span class="nx">latency</span><span class="w"> </span><span class="nx">exists</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">High</span><span class="w"> </span><span class="nx">overhead</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">frequent</span><span class="w"> </span><span class="nx">interrupts</span><span class="w"> </span><span class="p">(</span><span class="nx">Interrupt</span><span class="w"> </span><span class="nx">Storm</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nx">Interrupt</span><span class="w"> </span><span class="nx">Overhead</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">State</span><span class="w"> </span><span class="nx">save</span><span class="p">:</span><span class="w"> </span><span class="o">~</span><span class="mi">100</span><span class="w"> </span><span class="nx">cycles</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Handler</span><span class="w"> </span><span class="nx">entry</span><span class="p">:</span><span class="w"> </span><span class="o">~</span><span class="mi">50</span><span class="w"> </span><span class="nx">cycles</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Cache</span><span class="o">/</span><span class="nx">TLB</span><span class="w"> </span><span class="nx">effects</span><span class="p">:</span><span class="w"> </span><span class="o">~</span><span class="mi">100</span><span class="o">+</span><span class="w"> </span><span class="nx">cycles</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Total</span><span class="p">:</span><span class="w"> </span><span class="o">~</span><span class="mi">500</span><span class="o">-</span><span class="mi">1000</span><span class="w"> </span><span class="nx">cycles</span><span class="o">/</span><span class="nx">interrupt</span>

<span class="mi">100</span><span class="p">,</span><span class="mi">000</span><span class="w"> </span><span class="nx">interrupts</span><span class="o">/</span><span class="nx">sec</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="mi">3</span><span class="nx">GHz</span><span class="p">:</span>
<span class="nx">Overhead</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="mi">000</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="mi">500</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="mi">000</span><span class="p">,</span><span class="mi">000</span><span class="p">,</span><span class="mi">000</span><span class="w"> </span><span class="err">â‰ˆ</span><span class="w"> </span><span class="m m-Double">1.7</span><span class="o">%</span><span class="w"> </span><span class="nx">CPU</span>
</code></pre></div>

<hr />
<h2 id="4-dma-direct-memory-access">4. DMA (Direct Memory Access)<a class="header-link" href="#4-dma-direct-memory-access" title="Permanent link">&para;</a></h2>
<h3 id="41-dma-concept">4.1 DMA Concept<a class="header-link" href="#41-dma-concept" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Definition</span><span class="o">:</span><span class="w"> </span><span class="n">Direct</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">transfer</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">CPU</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">              </span><span class="n">DMA</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="n">CPU</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Comparison</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">CPU</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="o">(</span><span class="n">Programmed</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="o">):</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Memory</span><span class="w"> </span><span class="err">â†â”€â”€â”€â”€</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â†’</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="n">read</span><span class="w">      </span><span class="n">write</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">involvement</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">byte</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">handles</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">movement</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">High</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">consumption</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">DMA</span><span class="w"> </span><span class="n">Transfer</span><span class="o">:</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">Memory</span><span class="w"> </span><span class="err">â—€â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¶</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">Controller</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">              </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="n">CPU</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w"> </span><span class="o">(</span><span class="n">setup</span><span class="w"> </span><span class="n">only</span><span class="o">)</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">handles</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">transfer</span><span class="w"> </span><span class="n">setup</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="n">performs</span><span class="w"> </span><span class="n">transfer</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Notify</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">transfer</span><span class="w"> </span><span class="n">completes</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tasks</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="42-dma-operation-process">4.2 DMA Operation Process<a class="header-link" href="#42-dma-operation-process" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">DMA</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Process</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">configures</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">controller</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Source</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p">(</span><span class="n">memory</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Destination</span><span class="w"> </span><span class="n">address</span><span class="w">                                </span><span class="err">â”‚â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">(</span><span class="n">bytes</span><span class="p">)</span><span class="w">                              </span><span class="err">â”‚â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="p">(</span><span class="n">block</span><span class="o">/</span><span class="n">cycle</span><span class="w"> </span><span class="n">stealing</span><span class="p">)</span><span class="w">               </span><span class="err">â”‚â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">issues</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">command</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="p">(</span><span class="n">Bus</span><span class="w"> </span><span class="n">Request</span><span class="p">)</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Sends</span><span class="w"> </span><span class="n">HOLD</span><span class="w"> </span><span class="k">signal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">CPU</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">grants</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="p">(</span><span class="n">Bus</span><span class="w"> </span><span class="n">Grant</span><span class="p">)</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Yields</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">HLDA</span><span class="w"> </span><span class="k">signal</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">performs</span><span class="w"> </span><span class="n">tasks</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">don</span><span class="s1">&#39;t use the bus             â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">5.</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="n">transfers</span><span class="w"> </span><span class="n">data</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">         </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="err">â”‚â—€â•â•â•â•â•â•â•â–¶â”‚</span><span class="w">  </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="n">DMA</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="n">Bus</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">6.</span><span class="w"> </span><span class="n">When</span><span class="w"> </span><span class="n">transfer</span><span class="w"> </span><span class="n">completes</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Return</span><span class="w"> </span><span class="n">bus</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">CPU</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">7.</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">handles</span><span class="w"> </span><span class="n">completion</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">status</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Setup</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">transfer</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">needed</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="43-dma-controller-structure">4.3 DMA Controller Structure<a class="header-link" href="#43-dma-controller-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DMA Controller                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Control Registers                       â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ Command Register                             â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ - DMA operation mode settings                â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ Mode Register                                â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ - Transfer direction, mode (single/block/demand)â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ Status Register                              â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ - Completion status, request status          â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Channel 0                              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Address Reg â”‚ â”‚ Count Reg   â”‚ â”‚ Page Reg    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  0x0000     â”‚ â”‚   1024      â”‚ â”‚   0x00      â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Channel 1                              â”‚    â”‚
â”‚  â”‚  ... (same structure)                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  ... Channel 2, 3, ...                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="44-dma-transfer-modes">4.4 DMA Transfer Modes<a class="header-link" href="#44-dma-transfer-modes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="p">(</span><span class="n">Block</span><span class="o">/</span><span class="n">Burst</span><span class="w"> </span><span class="n">Mode</span><span class="p">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">CPU</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="n">DMA</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">CPU</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">usage</span><span class="w"> </span><span class="err">â”‚</span><span class="w">     </span><span class="n">exclusive</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="n">usage</span><span class="w">        </span><span class="err">â”‚</span><span class="n">usage</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="kr">on</span><span class="n">ce</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Fastest</span><span class="w"> </span><span class="n">transfer</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kr">wait</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">time</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Suitable</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="kd">data</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">Cycle</span><span class="w"> </span><span class="n">Stealing</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="err">â”‚</span><span class="n">D</span><span class="w"> </span><span class="err">â”‚</span><span class="n">C</span><span class="w"> </span><span class="err">â”‚</span><span class="n">D</span><span class="w"> </span><span class="err">â”‚</span><span class="n">C</span><span class="w"> </span><span class="err">â”‚</span><span class="n">D</span><span class="w"> </span><span class="err">â”‚</span><span class="n">C</span><span class="w"> </span><span class="err">â”‚</span><span class="n">D</span><span class="w"> </span><span class="err">â”‚</span><span class="n">C</span><span class="w"> </span><span class="err">â”‚</span><span class="n">D</span><span class="w"> </span><span class="err">â”‚</span><span class="n">C</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">P</span><span class="w"> </span><span class="err">â”‚</span><span class="n">M</span><span class="w"> </span><span class="err">â”‚</span><span class="n">P</span><span class="w"> </span><span class="err">â”‚</span><span class="n">M</span><span class="w"> </span><span class="err">â”‚</span><span class="n">P</span><span class="w"> </span><span class="err">â”‚</span><span class="n">M</span><span class="w"> </span><span class="err">â”‚</span><span class="n">P</span><span class="w"> </span><span class="err">â”‚</span><span class="n">M</span><span class="w"> </span><span class="err">â”‚</span><span class="n">P</span><span class="w"> </span><span class="err">â”‚</span><span class="n">M</span><span class="w"> </span><span class="err">â”‚</span><span class="n">P</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">U</span><span class="w"> </span><span class="err">â”‚</span><span class="n">A</span><span class="w"> </span><span class="err">â”‚</span><span class="n">U</span><span class="w"> </span><span class="err">â”‚</span><span class="n">A</span><span class="w"> </span><span class="err">â”‚</span><span class="n">U</span><span class="w"> </span><span class="err">â”‚</span><span class="n">A</span><span class="w"> </span><span class="err">â”‚</span><span class="n">U</span><span class="w"> </span><span class="err">â”‚</span><span class="n">A</span><span class="w"> </span><span class="err">â”‚</span><span class="n">U</span><span class="w"> </span><span class="err">â”‚</span><span class="n">A</span><span class="w"> </span><span class="err">â”‚</span><span class="n">U</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="kr">on</span><span class="n">e</span><span class="w"> </span><span class="n">word</span><span class="o">/</span><span class="n">byte</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">time</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">alternate</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="n">usage</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Minimal</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">impact</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Slower</span><span class="w"> </span><span class="n">transfer</span><span class="w"> </span><span class="n">speed</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="mf">3.</span><span class="w"> </span><span class="n">Demand</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="p">(</span><span class="n">Demand</span><span class="w"> </span><span class="n">Mode</span><span class="p">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Transfer</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">read</span><span class="n">y</span><span class="w"> </span><span class="p">(</span><span class="n">DREQ</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">based</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Adapts</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">speed</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="45-dma-programming-example">4.5 DMA Programming Example<a class="header-link" href="#45-dma-programming-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// DMA disk read example (simplified)</span>

<span class="cp">#define DMA_CHANNEL     2</span>
<span class="cp">#define DMA_ADDR_REG    0x04  </span><span class="c1">// Channel 2 address</span>
<span class="cp">#define DMA_COUNT_REG   0x05  </span><span class="c1">// Channel 2 count</span>
<span class="cp">#define DMA_PAGE_REG    0x81  </span><span class="c1">// Channel 2 page</span>
<span class="cp">#define DMA_MODE_REG    0x0B</span>
<span class="cp">#define DMA_MASK_REG    0x0A</span>

<span class="c1">// DMA transfer setup</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">setup_dma_read</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">buffer</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 1. Mask DMA channel (disable)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_MASK_REG</span><span class="p">,</span><span class="w"> </span><span class="n">DMA_CHANNEL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mh">0x04</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. Reset flip-flop</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. Set mode (read, channel 2, single mode)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_MODE_REG</span><span class="p">,</span><span class="w"> </span><span class="mh">0x46</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. Set address (lower 16 bits)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_ADDR_REG</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_ADDR_REG</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 5. Set page (upper bits)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_PAGE_REG</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 6. Set count (count - 1)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_COUNT_REG</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_COUNT_REG</span><span class="p">,</span><span class="w"> </span><span class="p">((</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 7. Unmask DMA channel (enable)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_MASK_REG</span><span class="p">,</span><span class="w"> </span><span class="n">DMA_CHANNEL</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Disk read command + DMA</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">read_disk_dma</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">sector</span><span class="p">,</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Setup DMA</span>
<span class="w">    </span><span class="n">setup_dma_read</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Issue disk read command to disk controller</span>
<span class="w">    </span><span class="n">issue_disk_read_command</span><span class="p">(</span><span class="n">sector</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// CPU can perform other tasks</span>
<span class="w">    </span><span class="c1">// Interrupt occurs when transfer completes</span>
<span class="p">}</span>

<span class="c1">// DMA completion interrupt handler</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">dma_complete_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Handle transfer completion</span>
<span class="w">    </span><span class="c1">// Check status, buffer available</span>
<span class="w">    </span><span class="n">signal_dma_complete</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="5-bus-architecture">5. Bus Architecture<a class="header-link" href="#5-bus-architecture" title="Permanent link">&para;</a></h2>
<h3 id="51-types-of-buses">5.1 Types of Buses<a class="header-link" href="#51-types-of-buses" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    System Bus Structure                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      CPU                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                            â”‚                                â”‚
â”‚                       Front-Side Bus                        â”‚
â”‚                      (or QPI/UPI)                           â”‚
â”‚                            â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Memory Controller Hub                   â”‚    â”‚
â”‚  â”‚                   (Northbridge)                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚             â”‚             â”‚                  â”‚
â”‚          Memory         PCIe         DMI                   â”‚
â”‚           Bus           x16                                â”‚
â”‚              â”‚             â”‚             â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”       â”‚                  â”‚
â”‚  â”‚    DRAM       â”‚    â”‚   GPU   â”‚       â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                  â”‚
â”‚                                         â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚             I/O Controller Hub                      â”‚   â”‚
â”‚  â”‚                 (Southbridge)                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚          â”‚          â”‚          â”‚                â”‚
â”‚        SATA       USB        PCIe      Audio              â”‚
â”‚          â”‚          â”‚        x1         â”‚                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”  â”Œâ”€â”€â”´â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”             â”‚
â”‚    â”‚ HDD/SSD  â”‚ â”‚ USB â”‚  â”‚ NIC â”‚  â”‚Codec  â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚Devs â”‚  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="52-bus-characteristics">5.2 Bus Characteristics<a class="header-link" href="#52-bus-characteristics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Bus</span><span class="w"> </span><span class="n">Components</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="n">Data</span><span class="w"> </span><span class="n">Bus</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Data</span><span class="w"> </span><span class="n">transfer</span><span class="w"> </span><span class="n">lines</span><span class="w">                                 </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Width</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="n">bits</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Bidirectional</span><span class="w">                                       </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                   </span><span class="n">Address</span><span class="w"> </span><span class="n">Bus</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Memory</span><span class="o">/</span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">addressing</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Width</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="o">+</span><span class="w"> </span><span class="n">bits</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Unidirectional</span><span class="w"> </span><span class="p">(</span><span class="n">CPU</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">device</span><span class="p">)</span><span class="w">                       </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                   </span><span class="n">Control</span><span class="w"> </span><span class="n">Bus</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="k">signal</span><span class="w"> </span><span class="n">transfer</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Read</span><span class="p">,</span><span class="w"> </span><span class="n">Write</span><span class="p">,</span><span class="w"> </span><span class="n">IRQ</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Bidirectional</span><span class="w">                                       </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">Major</span><span class="w"> </span><span class="n">Bus</span><span class="w"> </span><span class="n">Standards</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Bus</span><span class="w">        </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Bandwidth</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="n">Purpose</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Features</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">PCIe</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="n">x16</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">~</span><span class="mi">64</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">GPU</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="o">-</span><span class="n">speed</span><span class="err">â”‚</span><span class="w"> </span><span class="n">Serial</span><span class="p">,</span><span class="w"> </span><span class="n">lanes</span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">PCIe</span><span class="w"> </span><span class="mf">5.0</span><span class="w"> </span><span class="n">x16</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">~</span><span class="mi">128</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Next</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="n">GPU</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Latest</span><span class="w"> </span><span class="n">std</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">SATA</span><span class="w"> </span><span class="n">III</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="o">~</span><span class="mi">600</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Storage</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Serial</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">NVMe</span><span class="w"> </span><span class="p">(</span><span class="n">PCIe</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">~</span><span class="mi">7</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">High</span><span class="o">-</span><span class="n">speed</span><span class="w"> </span><span class="n">SSD</span><span class="err">â”‚</span><span class="w"> </span><span class="n">Low</span><span class="w"> </span><span class="n">latency</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">USB</span><span class="w"> </span><span class="mf">3.2</span><span class="w"> </span><span class="n">Gen2</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">~</span><span class="mf">1.25</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Peripherals</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Universal</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Thunderbolt</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="o">~</span><span class="mi">5</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">High</span><span class="o">-</span><span class="n">speed</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Daisy</span><span class="o">-</span><span class="n">chain</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="53-bus-arbitration">5.3 Bus Arbitration<a class="header-link" href="#53-bus-arbitration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Preventing</span><span class="w"> </span><span class="n">collisions</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">share</span><span class="w"> </span><span class="n">bus</span><span class="p">:</span>

<span class="mf">1.</span><span class="w"> </span><span class="n">Centralized</span><span class="w"> </span><span class="n">Arbitration</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="n">Device</span><span class="w"> </span><span class="mi">0</span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="n">Device</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="n">Device</span><span class="w"> </span><span class="mi">2</span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="n">Device</span><span class="w"> </span><span class="mi">3</span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="n">REQ</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="n">REQ</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="n">REQ</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="n">REQ</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">            </span><span class="err">â–¼</span><span class="w">           </span><span class="err">â–¼</span><span class="w">           </span><span class="err">â–¼</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="n">Bus</span><span class="w"> </span><span class="n">Arbiter</span><span class="w">                      </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="p">(</span><span class="n">Central</span><span class="w"> </span><span class="n">arbiter</span><span class="p">)</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Receive</span><span class="w"> </span><span class="n">requests</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Issue</span><span class="w"> </span><span class="n">GRANT</span><span class="w"> </span><span class="k">signal</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">priority</span><span class="w">             </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">GRANT</span><span class="w"> </span><span class="err">â”‚</span><span class="w">     </span><span class="n">GRANT</span><span class="w"> </span><span class="err">â”‚</span><span class="w">     </span><span class="n">GRANT</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">            </span><span class="err">â–¼</span><span class="w">           </span><span class="err">â–¼</span><span class="w">           </span><span class="err">â–¼</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">Priority</span><span class="w"> </span><span class="n">Schemes</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Fixed</span><span class="w"> </span><span class="n">priority</span><span class="p">:</span><span class="w"> </span><span class="n">Fixed</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">device</span>
<span class="o">-</span><span class="w"> </span><span class="n">Round</span><span class="w"> </span><span class="n">robin</span><span class="p">:</span><span class="w"> </span><span class="n">Fair</span><span class="w"> </span><span class="n">allocation</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rotation</span>
<span class="o">-</span><span class="w"> </span><span class="n">Dynamic</span><span class="w"> </span><span class="n">priority</span><span class="p">:</span><span class="w"> </span><span class="n">Adjust</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">patterns</span>
</code></pre></div>

<hr />
<h2 id="6-io-interfaces">6. I/O Interfaces<a class="header-link" href="#6-io-interfaces" title="Permanent link">&para;</a></h2>
<h3 id="61-io-addressing">6.1 I/O Addressing<a class="header-link" href="#61-io-addressing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">Isolated</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="p">(</span><span class="n">Port</span><span class="o">-</span><span class="n">Mapped</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="p">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Memory</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">Space</span><span class="w">         </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">Space</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">        </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">x0000_0000</span><span class="w">        </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">x0000</span><span class="w">             </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="n">Memory</span><span class="w">        </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">    </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Ports</span><span class="w">       </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">xFFFF_FFFF</span><span class="w">        </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">xFFFF</span><span class="w">             </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">        </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Uses</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">space</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Uses</span><span class="w"> </span><span class="n">IN</span><span class="p">,</span><span class="w"> </span><span class="n">OUT</span><span class="w"> </span><span class="n">instructions</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Used</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">x86</span><span class="w"> </span><span class="n">architecture</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Example</span><span class="p">:</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">outb</span><span class="p">(</span><span class="mf">0</span><span class="n">x3F8</span><span class="p">,</span><span class="w"> </span><span class="kd">data</span><span class="p">);</span><span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mf">0</span><span class="n">x3F8</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="kd">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inb</span><span class="p">(</span><span class="mf">0</span><span class="n">x3F8</span><span class="p">);</span><span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="kr">Read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mf">0</span><span class="n">x3F8</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">Memory</span><span class="o">-</span><span class="n">Mapped</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="p">(</span><span class="n">MMIO</span><span class="p">):</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Unified</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">Space</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">x0000_0000</span><span class="w">                                </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="kr">Sys</span><span class="n">tem</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="p">(</span><span class="n">RAM</span><span class="p">)</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">x7FFF_FFFF</span><span class="w">                                </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">x8000_0000</span><span class="w">                                </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w"> </span><span class="n">Registers</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="p">(</span><span class="n">accessed</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">memory</span><span class="p">)</span><span class="w">                </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="mf">0</span><span class="n">xFFFF_FFFF</span><span class="w">                                </span><span class="err">â”‚</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">instructions</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Mainly</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">ARM</span><span class="p">,</span><span class="w"> </span><span class="n">RISC</span><span class="o">-</span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="mf">.</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Most</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">modern</span><span class="w"> </span><span class="n">PCs</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">MMIO</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Example</span><span class="p">:</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">volatile</span><span class="w"> </span><span class="n">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uint32_t</span><span class="o">*</span><span class="p">)</span><span class="mf">0</span><span class="n">xFE200000</span><span class="p">;</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">*</span><span class="n">reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">val</span><span class="n">ue</span><span class="p">;</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">register</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nb">val</span><span class="n">ue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">reg</span><span class="p">;</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="kr">Read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">register</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="62-device-driver-structure">6.2 Device Driver Structure<a class="header-link" href="#62-device-driver-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nt">Device</span><span class="w"> </span><span class="nt">Driver</span><span class="w"> </span><span class="nt">Structure</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="nt">Driver</span><span class="w"> </span><span class="nt">Entry</span><span class="w"> </span><span class="nt">Points</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">init</span><span class="o">()</span><span class="w">      </span><span class="nt">-</span><span class="w"> </span><span class="nt">Driver</span><span class="w"> </span><span class="nt">initialization</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">open</span><span class="o">()</span><span class="w">      </span><span class="nt">-</span><span class="w"> </span><span class="nt">Open</span><span class="w"> </span><span class="nt">device</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">close</span><span class="o">()</span><span class="w">     </span><span class="nt">-</span><span class="w"> </span><span class="nt">Close</span><span class="w"> </span><span class="nt">device</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">read</span><span class="o">()</span><span class="w">      </span><span class="nt">-</span><span class="w"> </span><span class="nt">Read</span><span class="w"> </span><span class="nt">data</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">write</span><span class="o">()</span><span class="w">     </span><span class="nt">-</span><span class="w"> </span><span class="nt">Write</span><span class="w"> </span><span class="nt">data</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">ioctl</span><span class="o">()</span><span class="w">     </span><span class="nt">-</span><span class="w"> </span><span class="nt">Control</span><span class="w"> </span><span class="nt">commands</span><span class="w">                      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">interrupt_handler</span><span class="o">()</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">Interrupt</span><span class="w"> </span><span class="nt">handling</span><span class="w">            </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="nt">Driver</span><span class="w"> </span><span class="nt">Internal</span><span class="w"> </span><span class="nt">Data</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Device</span><span class="w"> </span><span class="nt">state</span><span class="w">                                      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Buffers</span><span class="w">                                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Wait</span><span class="w"> </span><span class="nt">queues</span><span class="w">                                       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Configuration</span><span class="w"> </span><span class="nt">info</span><span class="w">                                </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="nt">Linux</span><span class="w"> </span><span class="nt">device</span><span class="w"> </span><span class="nt">driver</span><span class="w"> </span><span class="nt">example</span><span class="o">:</span>
<span class="nt">static</span><span class="w"> </span><span class="nt">struct</span><span class="w"> </span><span class="nt">file_operations</span><span class="w"> </span><span class="nt">my_fops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">.owner</span><span class="w">   </span><span class="err">=</span><span class="w"> </span><span class="err">THIS_MODULE,</span>
<span class="w">    </span><span class="err">.open</span><span class="w">    </span><span class="err">=</span><span class="w"> </span><span class="err">my_open,</span>
<span class="w">    </span><span class="err">.release</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">my_close,</span>
<span class="w">    </span><span class="err">.read</span><span class="w">    </span><span class="err">=</span><span class="w"> </span><span class="err">my_read,</span>
<span class="w">    </span><span class="err">.write</span><span class="w">   </span><span class="err">=</span><span class="w"> </span><span class="err">my_write,</span>
<span class="w">    </span><span class="err">.unlocked_ioctl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">my_ioctl,</span>
<span class="p">}</span><span class="o">;</span>
</code></pre></div>

<hr />
<h2 id="7-modern-io-systems">7. Modern I/O Systems<a class="header-link" href="#7-modern-io-systems" title="Permanent link">&para;</a></h2>
<h3 id="71-nvme-non-volatile-memory-express">7.1 NVMe (Non-Volatile Memory Express)<a class="header-link" href="#71-nvme-non-volatile-memory-express" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                    </span><span class="nv">NVMe</span><span class="w"> </span><span class="nv">Architecture</span><span class="w">                         </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Traditional</span><span class="w"> </span><span class="nv">SATA</span><span class="o">/</span><span class="nv">AHCI</span><span class="w"> </span><span class="nv">vs</span><span class="w"> </span><span class="nv">NVMe</span>:<span class="w">                             </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">SATA</span><span class="o">/</span><span class="nv">AHCI</span>:<span class="w">                                                 </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Single</span><span class="w"> </span><span class="nv">command</span><span class="w"> </span><span class="nv">queue</span><span class="w"> </span><span class="ss">(</span><span class="nv">depth</span><span class="w"> </span><span class="mi">32</span><span class="ss">)</span><span class="w">                          </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Designed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">HDD</span><span class="w"> </span><span class="nv">era</span><span class="w">                                     </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">High</span><span class="w"> </span><span class="nv">latency</span><span class="w">                                             </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">NVMe</span>:<span class="w">                                                      </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mi">64</span><span class="nv">K</span><span class="w"> </span><span class="nv">queues</span>,<span class="w"> </span><span class="mi">64</span><span class="nv">K</span><span class="w"> </span><span class="nv">commands</span><span class="w"> </span><span class="nv">per</span><span class="w"> </span><span class="nv">queue</span><span class="w">                       </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Optimized</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">SSD</span><span class="w">                                        </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="nv">latency</span><span class="w">                                              </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Direct</span><span class="w"> </span><span class="nv">PCIe</span><span class="w"> </span><span class="nv">connection</span><span class="w">                                   </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                   </span><span class="nv">CPU</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Driver</span><span class="w">                       </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">   </span>â”‚
â”‚<span class="w">                            </span>â”‚<span class="w">                                </span>â”‚
â”‚<span class="w">           </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">              </span>â”‚
â”‚<span class="w">           </span>â”‚<span class="w">                </span>â”‚<span class="w">                </span>â”‚<span class="w">              </span>â”‚
â”‚<span class="w">           </span>â–¼<span class="w">                </span>â–¼<span class="w">                </span>â–¼<span class="w">              </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">        </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Submit</span><span class="w"> </span><span class="nv">Q</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Submit</span><span class="w"> </span><span class="nv">Q</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Submit</span><span class="w"> </span><span class="nv">Q</span><span class="w"> </span><span class="nv">N</span><span class="w">  </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜<span class="w">        </span>â”‚
â”‚<span class="w">         </span>â”‚<span class="w">                </span>â”‚<span class="w">                </span>â”‚<span class="w">                </span>â”‚
â”‚<span class="w">         </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                </span>â”‚
â”‚<span class="w">                          </span>â”‚<span class="w">                                  </span>â”‚
â”‚<span class="w">                          </span>â–¼<span class="w">                                  </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">  </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                 </span><span class="nv">NVMe</span><span class="w"> </span><span class="nv">Controller</span><span class="w">                       </span>â”‚<span class="w">  </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">  </span>â”‚
â”‚<span class="w">                          </span>â”‚<span class="w">                                  </span>â”‚
â”‚<span class="w">         </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                </span>â”‚
â”‚<span class="w">         </span>â”‚<span class="w">                </span>â”‚<span class="w">                </span>â”‚<span class="w">                </span>â”‚
â”‚<span class="w">         </span>â–¼<span class="w">                </span>â–¼<span class="w">                </span>â–¼<span class="w">                </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">        </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="nv">Complete</span><span class="w"> </span><span class="nv">Q</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>â”‚<span class="w">  </span>â”‚<span class="nv">Complete</span><span class="w"> </span><span class="nv">Q</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>â”‚<span class="w">  </span>â”‚<span class="nv">Complete</span><span class="w"> </span><span class="nv">Q</span><span class="w"> </span><span class="nv">N</span><span class="w"> </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">        </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="72-usb-system">7.2 USB System<a class="header-link" href="#72-usb-system" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USB Architecture                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  USB Generation Speeds:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ USB 2.0     â”‚  480 Mbps (High Speed)               â”‚   â”‚
â”‚  â”‚ USB 3.0     â”‚  5 Gbps (SuperSpeed)                 â”‚   â”‚
â”‚  â”‚ USB 3.1     â”‚  10 Gbps (SuperSpeed+)               â”‚   â”‚
â”‚  â”‚ USB 3.2     â”‚  20 Gbps (SuperSpeed USB 20Gbps)     â”‚   â”‚
â”‚  â”‚ USB4        â”‚  40 Gbps                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  USB Transfer Types:                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Control     â”‚ Setup, control (small data)          â”‚   â”‚
â”‚  â”‚ Bulk        â”‚ Large data (storage devices)         â”‚   â”‚
â”‚  â”‚ Interrupt   â”‚ Small, periodic (keyboard, mouse)    â”‚   â”‚
â”‚  â”‚ Isochronous â”‚ Real-time, periodic (audio, video)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  USB Topology:                                              â”‚
â”‚                                                             â”‚
â”‚       Host Controller                                       â”‚
â”‚            â”‚                                                â”‚
â”‚            â–¼                                                â”‚
â”‚        Root Hub                                             â”‚
â”‚        /   |   \                                            â”‚
â”‚       /    |    \                                           â”‚
â”‚    Hub  Device  Device                                      â”‚
â”‚    / \                                                      â”‚
â”‚   /   \                                                     â”‚
â”‚ Dev   Dev                                                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="73-io-virtualization">7.3 I/O Virtualization<a class="header-link" href="#73-io-virtualization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   I/O Virtualization Techniques              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Emulation:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Guest OS  â†’  Hypervisor  â†’  Physical Device        â”‚   â”‚
â”‚  â”‚            (I/O trap and emulation)                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  - Slow, high compatibility                                 â”‚
â”‚                                                             â”‚
â”‚  2. Para-virtualization (virtio):                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Guest OS (virtio driver) â†’ Hypervisor â†’ Device     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  - Optimized virtual interface                              â”‚
â”‚  - Guest OS modification required                           â”‚
â”‚                                                             â”‚
â”‚  3. Direct Device Assignment (VFIO):                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Guest OS  â†’  Physical Device (direct access)       â”‚   â”‚
â”‚  â”‚            (Memory isolation via IOMMU)              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  - Native performance                                       â”‚
â”‚  - Device cannot be shared                                  â”‚
â”‚                                                             â”‚
â”‚  4. SR-IOV (Single Root I/O Virtualization):               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Split one physical device into multiple virtual    â”‚   â”‚
â”‚  â”‚  functions (VF), each VM accesses independent VF    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  - Native performance + sharing possible                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="8-practice-problems">8. Practice Problems<a class="header-link" href="#8-practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="basic-problems">Basic Problems<a class="header-link" href="#basic-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Explain the differences between polling, interrupt, and DMA methods.</p>
</li>
<li>
<p>What is the role of the interrupt vector table?</p>
</li>
<li>
<p>What are the 3 pieces of information that must be configured in a DMA controller?</p>
</li>
</ol>
<h3 id="intermediate-problems">Intermediate Problems<a class="header-link" href="#intermediate-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>Choose the appropriate I/O method for each scenario:</li>
<li>(a) Keyboard input processing</li>
<li>(b) Reading 10MB file from disk</li>
<li>
<p>(c) High-speed network packet processing (10Gbps)</p>
</li>
<li>
<p>What is an "Interrupt Storm" in interrupt-based I/O?</p>
</li>
<li>
<p>Compare the advantages and disadvantages of memory-mapped I/O vs port-mapped I/O.</p>
</li>
</ol>
<h3 id="advanced-problems">Advanced Problems<a class="header-link" href="#advanced-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>Calculate CPU efficiency under the following conditions:</li>
<li>CPU clock: 3GHz</li>
<li>Disk transfer rate: 500MB/s</li>
<li>DMA block size: 4KB</li>
<li>
<p>DMA completion interrupt processing time: 1000 cycles</p>
</li>
<li>
<p>Explain USB's 4 transfer types and give device examples suitable for each.</p>
</li>
<li>
<p>Explain how SR-IOV improves I/O performance in virtualized environments.</p>
</li>
</ol>
<details>
<summary>Answers</summary>

1. I/O Method Comparison:
   - Polling: CPU continuously checks status, simple but wastes CPU
   - Interrupt: Device notifies completion, CPU efficient but has overhead
   - DMA: Direct memory transfer, efficient for bulk data but complex

2. Interrupt Vector Table:
   - Maps interrupt numbers to handler addresses
   - Jumps to corresponding handler when interrupt occurs

3. DMA Configuration Info:
   - Source/destination address
   - Transfer size (bytes)
   - Transfer direction (read/write)

4. Appropriate I/O Methods:
   - (a) Interrupt (slow, asynchronous)
   - (b) DMA (bulk block transfer)
   - (c) DMA + polling or NAPI (high-speed, many packets)

5. Interrupt Storm:
   - Situation where too many interrupts cause CPU to only handle interrupts
   - Cannot perform normal tasks
   - Solution: Interrupt coalescing, switch to polling (NAPI)

6. I/O Addressing Comparison:
   - Port-mapped: Separate address space, requires separate instructions, saves address space
   - Memory-mapped: Unified address space, uses normal instructions, cache considerations needed

7. CPU Efficiency Calculation:
   - Transfer rate 500MB/s, block 4KB â†’ 125,000 transfers/sec
   - 1000 cycles interrupt handling per transfer
   - Total interrupt cycles: 125,000,000
   - CPU efficiency: 1 - (125M / 3G) = 1 - 0.042 = 95.8%

8. USB Transfer Types:
   - Control: Device setup, status checking (all USB devices)
   - Bulk: Large data (USB drives, printers)
   - Interrupt: Small periodic (keyboard, mouse)
   - Isochronous: Real-time (webcam, USB audio)

9. SR-IOV Principle:
   - Creates multiple virtual functions (VF) on one physical device
   - Each VM directly accesses dedicated VF
   - Native performance without hypervisor intervention
   - IOMMU ensures memory isolation

</details>

<hr />
<h2 id="next-steps">Next Steps<a class="header-link" href="#next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./18_Parallel_Processing_Multicore.md">18_Parallel_Processing_Multicore.md</a> - Multicore architecture and parallel programming</li>
</ul>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Computer Organization and Design (Patterson &amp; Hennessy)</li>
<li>Operating System Concepts (Silberschatz et al.)</li>
<li><a href="https://nvmexpress.org/specifications/">NVMe Specification</a></li>
<li><a href="https://www.usb.org/documents">USB Specification</a></li>
<li>Linux Device Drivers (Corbet, Rubini, Kroah-Hartman)</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Architecture/16_Virtual_Memory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Virtual Memory</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Computer_Architecture/18_Parallel_Processing_Multicore.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Parallel Processing and Multicore</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}