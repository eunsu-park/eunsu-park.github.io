{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parallel Processing and Multicore - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Computer_Architecture/">Computer Architecture</a>
    <span class="separator">/</span>
    <span class="current">Parallel Processing and Multicore</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Parallel Processing and Multicore</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Architecture/17_IO_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">I/O Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-the-need-for-parallel-processing">1. The Need for Parallel Processing</a><ul>
<li><a href="#11-single-core-limitations">1.1 Single Core Limitations</a></li>
<li><a href="#12-moores-law-and-dennard-scaling">1.2 Moore's Law and Dennard Scaling</a></li>
<li><a href="#13-benefits-of-parallel-processing">1.3 Benefits of Parallel Processing</a></li>
</ul>
</li>
<li><a href="#2-flynns-taxonomy">2. Flynn's Taxonomy</a><ul>
<li><a href="#21-classification-system">2.1 Classification System</a></li>
<li><a href="#22-sisd-single-instruction-single-data">2.2 SISD (Single Instruction, Single Data)</a></li>
<li><a href="#23-simd-single-instruction-multiple-data">2.3 SIMD (Single Instruction, Multiple Data)</a></li>
<li><a href="#24-misd-multiple-instruction-single-data">2.4 MISD (Multiple Instruction, Single Data)</a></li>
<li><a href="#25-mimd-multiple-instruction-multiple-data">2.5 MIMD (Multiple Instruction, Multiple Data)</a></li>
</ul>
</li>
<li><a href="#3-multiprocessor-and-multicore">3. Multiprocessor and Multicore</a><ul>
<li><a href="#31-smp-symmetric-multi-processing">3.1 SMP (Symmetric Multi-Processing)</a></li>
<li><a href="#32-numa-non-uniform-memory-access">3.2 NUMA (Non-Uniform Memory Access)</a></li>
<li><a href="#33-multicore-processor">3.3 Multicore Processor</a></li>
<li><a href="#34-hyper-threading-smt">3.4 Hyper-Threading (SMT)</a></li>
</ul>
</li>
<li><a href="#4-cache-coherence-problem">4. Cache Coherence Problem</a><ul>
<li><a href="#41-what-is-cache-coherence">4.1 What is Cache Coherence?</a></li>
<li><a href="#42-coherence-definition">4.2 Coherence Definition</a></li>
<li><a href="#43-coherence-protocol-overview">4.3 Coherence Protocol Overview</a></li>
</ul>
</li>
<li><a href="#5-snooping-protocol-mesi">5. Snooping Protocol (MESI)</a><ul>
<li><a href="#51-mesi-states">5.1 MESI States</a></li>
<li><a href="#52-mesi-state-transitions">5.2 MESI State Transitions</a></li>
<li><a href="#53-mesi-operation-example">5.3 MESI Operation Example</a></li>
<li><a href="#54-moesi-protocol">5.4 MOESI Protocol</a></li>
</ul>
</li>
<li><a href="#6-amdahls-law-and-gustafsons-law">6. Amdahl's Law and Gustafson's Law</a><ul>
<li><a href="#61-amdahls-law">6.1 Amdahl's Law</a></li>
<li><a href="#62-gustafsons-law">6.2 Gustafson's Law</a></li>
<li><a href="#63-actual-parallelization-efficiency">6.3 Actual Parallelization Efficiency</a></li>
</ul>
</li>
<li><a href="#7-synchronization-and-locks">7. Synchronization and Locks</a><ul>
<li><a href="#71-need-for-synchronization">7.1 Need for Synchronization</a></li>
<li><a href="#72-atomic-operations">7.2 Atomic Operations</a></li>
<li><a href="#73-spinlock">7.3 Spinlock</a></li>
<li><a href="#74-mutex-and-semaphore">7.4 Mutex and Semaphore</a></li>
<li><a href="#75-lock-free-algorithms">7.5 Lock-Free Algorithms</a></li>
</ul>
</li>
<li><a href="#8-gpu-and-parallel-computing">8. GPU and Parallel Computing</a><ul>
<li><a href="#81-gpu-architecture">8.1 GPU Architecture</a></li>
<li><a href="#82-cuda-programming-model">8.2 CUDA Programming Model</a></li>
<li><a href="#83-cuda-code-example">8.3 CUDA Code Example</a></li>
<li><a href="#84-gpu-vs-cpu-use-cases">8.4 GPU vs CPU Use Cases</a></li>
</ul>
</li>
<li><a href="#9-practice-problems">9. Practice Problems</a><ul>
<li><a href="#basic-problems">Basic Problems</a></li>
<li><a href="#intermediate-problems">Intermediate Problems</a></li>
<li><a href="#advanced-problems">Advanced Problems</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="parallel-processing-and-multicore">Parallel Processing and Multicore<a class="header-link" href="#parallel-processing-and-multicore" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>As single-processor performance improvements reach physical limits, modern computers are achieving higher performance through multicore and parallel processing. This lesson covers the fundamental concepts of parallel processing, multiprocessor/multicore architectures, cache coherence problems, synchronization mechanisms, and parallel computing using GPUs.</p>
<p><strong>Difficulty</strong>: â­â­â­â­</p>
<p><strong>Prerequisites</strong>: CPU architecture, cache memory, memory hierarchy</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-the-need-for-parallel-processing">The Need for Parallel Processing</a></li>
<li><a href="#2-flynns-taxonomy">Flynn's Taxonomy</a></li>
<li><a href="#3-multiprocessor-and-multicore">Multiprocessor and Multicore</a></li>
<li><a href="#4-cache-coherence-problem">Cache Coherence Problem</a></li>
<li><a href="#5-snooping-protocol-mesi">Snooping Protocol (MESI)</a></li>
<li><a href="#6-amdahls-law-and-gustafsons-law">Amdahl's Law and Gustafson's Law</a></li>
<li><a href="#7-synchronization-and-locks">Synchronization and Locks</a></li>
<li><a href="#8-gpu-and-parallel-computing">GPU and Parallel Computing</a></li>
<li><a href="#9-practice-problems">Practice Problems</a></li>
</ol>
<hr />
<h2 id="1-the-need-for-parallel-processing">1. The Need for Parallel Processing<a class="header-link" href="#1-the-need-for-parallel-processing" title="Permanent link">&para;</a></h2>
<h3 id="11-single-core-limitations">1.1 Single Core Limitations<a class="header-link" href="#11-single-core-limitations" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CPU Clock Speed Evolution                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Clock                                                      â”‚
â”‚  (GHz)                                                      â”‚
â”‚    â”‚                                    â—â”€â”€â”€â”€â”€â”€â— (Plateau)  â”‚
â”‚  5 â”‚                               â—â”€â”€â”€â”€â—                   â”‚
â”‚    â”‚                          â—â”€â”€â”€â”€                         â”‚
â”‚  4 â”‚                     â—â”€â”€â”€â”€                              â”‚
â”‚    â”‚                â—â”€â”€â”€â”€                                   â”‚
â”‚  3 â”‚           â—â”€â”€â”€â”€                                        â”‚
â”‚    â”‚      â—â”€â”€â”€â”€                                             â”‚
â”‚  2 â”‚  â—â”€â”€â”€â”€                                                 â”‚
â”‚    â”‚ â—                                                      â”‚
â”‚  1 â”‚â—                                                       â”‚
â”‚    â”‚                                                        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚     1995    2000    2005    2010    2015    2020            â”‚
â”‚                                                             â”‚
â”‚  Clock speed plateau after 2005:                           â”‚
â”‚  - Power Wall                                              â”‚
â”‚  - Heat dissipation issues                                 â”‚
â”‚  - Memory Wall                                             â”‚
â”‚  - ILP Wall                                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12-moores-law-and-dennard-scaling">1.2 Moore's Law and Dennard Scaling<a class="header-link" href="#12-moores-law-and-dennard-scaling" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Moore</span><span class="s1">&#39;s Law:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Transistor</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="n">doubles</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">years</span>
<span class="o">-</span><span class="w"> </span><span class="n">Still</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="p">(</span><span class="n">slowing</span><span class="w"> </span><span class="n">down</span><span class="p">)</span>

<span class="n">Dennard</span><span class="w"> </span><span class="n">Scaling</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Transistor</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">reduction</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">constant</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">density</span>
<span class="o">-</span><span class="w"> </span><span class="n">Broke</span><span class="w"> </span><span class="n">down</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="mi">2006</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">After</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Dennard</span><span class="w"> </span><span class="n">Scaling</span><span class="p">:</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Transistor</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="err">â†‘</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="n">Clock</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="n">plateau</span><span class="w">  </span><span class="err">â†’</span><span class="w">  </span><span class="n">How</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">use</span><span class="err">?â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Solution</span><span class="p">:</span><span class="w"> </span><span class="n">Multicore</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Before</span><span class="w"> </span><span class="mi">2005</span><span class="p">:</span><span class="w">        </span><span class="n">After</span><span class="w"> </span><span class="mi">2005</span><span class="p">:</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w"> </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w"> </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w">      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">             </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="n">Core1</span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="n">Core2</span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="n">Core3</span><span class="err">â”‚</span><span class="w"> </span><span class="o">...</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Single</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="n">High</span><span class="o">-</span><span class="n">Perf</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â””â”€â”€â”€â”€â”€â”˜</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”˜</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”˜</span><span class="w">      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="n">Core</span><span class="w">     </span><span class="err">â”‚</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="n">Multiple</span><span class="w"> </span><span class="n">efficient</span><span class="w"> </span><span class="n">cores</span><span class="w">      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="13-benefits-of-parallel-processing">1.3 Benefits of Parallel Processing<a class="header-link" href="#13-benefits-of-parallel-processing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Performance</span><span class="w"> </span><span class="nv">Improvement</span>:
<span class="o">-</span><span class="w"> </span><span class="nv">Process</span><span class="w"> </span><span class="nv">multiple</span><span class="w"> </span><span class="nv">tasks</span><span class="w"> </span><span class="nv">simultaneously</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Divide</span><span class="w"> </span><span class="nv">large</span><span class="w"> </span><span class="nv">problems</span><span class="w"> </span><span class="nv">into</span><span class="w"> </span><span class="nv">smaller</span><span class="w"> </span><span class="nv">parallel</span><span class="w"> </span><span class="nv">solutions</span>

<span class="nv">Energy</span><span class="w"> </span><span class="nv">Efficiency</span>:
<span class="o">-</span><span class="w"> </span><span class="nv">Multiple</span><span class="w"> </span><span class="nv">cores</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">lower</span><span class="w"> </span><span class="nv">clock</span><span class="w"> </span><span class="nv">more</span><span class="w"> </span><span class="nv">efficient</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="nv">single</span><span class="w"> </span><span class="nv">core</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">high</span><span class="w"> </span><span class="nv">clock</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Power</span><span class="w"> </span>âˆ<span class="w"> </span><span class="nv">Voltage</span>Â²<span class="w"> </span>Ã—<span class="w"> </span><span class="nv">Frequency</span>

<span class="nv">Reliability</span>:
<span class="o">-</span><span class="w"> </span><span class="k">Continue</span><span class="w"> </span><span class="nv">operation</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">other</span><span class="w"> </span><span class="nv">cores</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">core</span><span class="w"> </span><span class="nv">fails</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Fault</span><span class="w"> </span><span class="nv">Tolerance</span>

<span class="nv">Scalability</span>:
<span class="o">-</span><span class="w"> </span><span class="nv">Performance</span><span class="w"> </span><span class="nv">scaling</span><span class="w"> </span><span class="nv">through</span><span class="w"> </span><span class="nv">increased</span><span class="w"> </span><span class="nv">core</span><span class="w"> </span><span class="nv">count</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Vertical</span><span class="w"> </span><span class="nv">scaling</span><span class="w"> </span><span class="ss">(</span><span class="nv">add</span><span class="w"> </span><span class="nv">cores</span><span class="ss">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">Horizontal</span><span class="w"> </span><span class="nv">scaling</span><span class="w"> </span><span class="ss">(</span><span class="nv">add</span><span class="w"> </span><span class="nv">nodes</span><span class="ss">)</span>
</code></pre></div>

<hr />
<h2 id="2-flynns-taxonomy">2. Flynn's Taxonomy<a class="header-link" href="#2-flynns-taxonomy" title="Permanent link">&para;</a></h2>
<h3 id="21-classification-system">2.1 Classification System<a class="header-link" href="#21-classification-system" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Flynn&#39;s Taxonomy                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚              â”‚     Single Data     â”‚    Multiple Data       â”‚
â”‚              â”‚        (SD)         â”‚        (MD)            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚              â”‚                     â”‚                        â”‚
â”‚   Single     â”‚       SISD          â”‚       SIMD            â”‚
â”‚ Instruction  â”‚  (Single Instructionâ”‚  (Single Instruction  â”‚
â”‚     (SI)     â”‚   Single Data)      â”‚   Multiple Data)      â”‚
â”‚              â”‚                     â”‚                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚              â”‚                     â”‚                        â”‚
â”‚  Multiple    â”‚       MISD          â”‚       MIMD            â”‚
â”‚ Instruction  â”‚  (Multiple Instr.   â”‚  (Multiple Instr.     â”‚
â”‚     (MI)     â”‚   Single Data)      â”‚   Multiple Data)      â”‚
â”‚              â”‚                     â”‚                        â”‚
â”‚              â”‚   (Rarely used)     â”‚                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="22-sisd-single-instruction-single-data">2.2 SISD (Single Instruction, Single Data)<a class="header-link" href="#22-sisd-single-instruction-single-data" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Traditional von Neumann computer:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚     Instruction Stream          Data Stream                 â”‚
â”‚           â”‚                         â”‚                       â”‚
â”‚           â–¼                         â–¼                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚     â”‚    I1     â”‚             â”‚    D1     â”‚                â”‚
â”‚     â”‚    I2     â”‚             â”‚    D2     â”‚                â”‚
â”‚     â”‚    I3     â”‚             â”‚    D3     â”‚                â”‚
â”‚     â”‚    ...    â”‚             â”‚    ...    â”‚                â”‚
â”‚     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                â”‚
â”‚           â”‚                         â”‚                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                       â”‚                                     â”‚
â”‚                       â–¼                                     â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚               â”‚      CPU      â”‚                            â”‚
â”‚               â”‚ (Single Core) â”‚                            â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                             â”‚
â”‚  Examples: Early microprocessors, embedded systems          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="23-simd-single-instruction-multiple-data">2.3 SIMD (Single Instruction, Multiple Data)<a class="header-link" href="#23-simd-single-instruction-multiple-data" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Same</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">simultaneously</span><span class="p">:</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Single</span><span class="w"> </span><span class="n">Instruction</span><span class="w">              </span><span class="n">Multiple</span><span class="w"> </span><span class="n">Data</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">  </span><span class="n">D1</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">D2</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">D3</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â–¼</span><span class="w">                    </span><span class="err">â””â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”¬â”€â”€â”€â”˜</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">      </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">   </span><span class="n">ADD</span><span class="w">     </span><span class="err">â”‚</span><span class="w">                 </span><span class="err">â–¼</span><span class="w">      </span><span class="err">â–¼</span><span class="w">      </span><span class="err">â–¼</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜</span><span class="w">            </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Processing</span><span class="w"> </span><span class="n">Units</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">PU1</span><span class="err">â”‚â”‚</span><span class="w"> </span><span class="n">PU2</span><span class="err">â”‚â”‚</span><span class="w"> </span><span class="n">PU3</span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                              </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                         </span><span class="err">â”‚</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                              </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">  </span><span class="n">R1</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">R2</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">R3</span><span class="w">  </span><span class="err">â”‚</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                              </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Examples</span><span class="p">:</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">SSE</span><span class="p">,</span><span class="w"> </span><span class="n">AVX</span><span class="w"> </span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="mi">512</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">vectors</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">GPU</span><span class="w"> </span><span class="n">warps</span><span class="o">/</span><span class="n">waves</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Image</span><span class="w"> </span><span class="n">processing</span><span class="p">,</span><span class="w"> </span><span class="n">scientific</span><span class="w"> </span><span class="n">computing</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Code</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="p">(</span><span class="n">AVX</span><span class="p">):</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">__m256</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_mm256_load_ps</span><span class="p">(</span><span class="n">arr1</span><span class="p">);</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">__m256</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_mm256_load_ps</span><span class="p">(</span><span class="n">arr2</span><span class="p">);</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">__m256</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_mm256_add_ps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">floats</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">once</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="24-misd-multiple-instruction-single-data">2.4 MISD (Multiple Instruction, Single Data)<a class="header-link" href="#24-misd-multiple-instruction-single-data" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Multiple instructions processing same data stream:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚     Multiple Instructions           Single Data             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚                   â”‚
â”‚     â”‚ I1: Encrypt    â”‚                  â”‚                   â”‚
â”‚     â”‚ I2: Compress   â”‚                  â–¼                   â”‚
â”‚     â”‚ I3: Checksum   â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  Data   â”‚             â”‚
â”‚             â”‚                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜             â”‚
â”‚             â”‚                           â”‚                   â”‚
â”‚             â–¼                           â”‚                   â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚                   â”‚
â”‚      â”‚ Pipeline   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚      â”‚ of Units   â”‚                                         â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚                                                             â”‚
â”‚  Real-world usage:                                          â”‚
â”‚  - Systolic arrays (some)                                  â”‚
â”‚  - Fault-tolerant systems (same computation multiple times) â”‚
â”‚  - Very rarely used                                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="25-mimd-multiple-instruction-multiple-data">2.5 MIMD (Multiple Instruction, Multiple Data)<a class="header-link" href="#25-mimd-multiple-instruction-multiple-data" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Most common parallel computer form:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚     Multiple Instructions           Multiple Data           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚     â”‚ I1: func_A()   â”‚         â”‚ D1, D2, D3, D4     â”‚      â”‚
â”‚     â”‚ I2: func_B()   â”‚         â”‚ D5, D6, D7, D8     â”‚      â”‚
â”‚     â”‚ I3: func_C()   â”‚         â”‚ ...               â”‚      â”‚
â”‚     â”‚ I4: func_D()   â”‚         â”‚                   â”‚      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚             â”‚                            â”‚                  â”‚
â”‚             â–¼                            â–¼                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     â”‚               Multiple Processors                  â”‚  â”‚
â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚     â”‚  â”‚  CPU 1  â”‚ â”‚  CPU 2  â”‚ â”‚  CPU 3  â”‚ â”‚  CPU 4  â”‚ â”‚  â”‚
â”‚     â”‚  â”‚ func_A()â”‚ â”‚ func_B()â”‚ â”‚ func_C()â”‚ â”‚ func_D()â”‚ â”‚  â”‚
â”‚     â”‚  â”‚   D1    â”‚ â”‚   D5    â”‚ â”‚   D2    â”‚ â”‚   D8    â”‚ â”‚  â”‚
â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  Examples:                                                  â”‚
â”‚  - Multicore processors                                    â”‚
â”‚  - Multiprocessor servers                                  â”‚
â”‚  - Clusters, supercomputers                                â”‚
â”‚                                                             â”‚
â”‚  MIMD Classification:                                       â”‚
â”‚  - Shared Memory: SMP, NUMA                                â”‚
â”‚  - Distributed Memory: Clusters                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="3-multiprocessor-and-multicore">3. Multiprocessor and Multicore<a class="header-link" href="#3-multiprocessor-and-multicore" title="Permanent link">&para;</a></h2>
<h3 id="31-smp-symmetric-multi-processing">3.1 SMP (Symmetric Multi-Processing)<a class="header-link" href="#31-smp-symmetric-multi-processing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                  </span><span class="nv">SMP</span><span class="w"> </span><span class="ss">(</span><span class="nv">Symmetric</span><span class="w"> </span><span class="nv">Multi</span><span class="o">-</span><span class="nv">Processing</span><span class="ss">)</span><span class="w">            </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">     </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w"> </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w"> </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w"> </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">       </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span><span class="nv">CPU</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span>â”‚<span class="w"> </span>â”‚<span class="w">  </span><span class="nv">CPU</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span>â”‚<span class="w"> </span>â”‚<span class="w">  </span><span class="nv">CPU</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span>â”‚<span class="w"> </span>â”‚<span class="w">  </span><span class="nv">CPU</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span>â”‚<span class="w">       </span>â”‚
â”‚<span class="w">     </span>â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚<span class="w"> </span>â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚<span class="w"> </span>â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚<span class="w"> </span>â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚<span class="w">       </span>â”‚
â”‚<span class="w">     </span>â”‚â”‚<span class="w"> </span><span class="nv">Cache</span><span class="w"> </span>â”‚â”‚<span class="w"> </span>â”‚â”‚<span class="w"> </span><span class="nv">Cache</span><span class="w"> </span>â”‚â”‚<span class="w"> </span>â”‚â”‚<span class="w"> </span><span class="nv">Cache</span><span class="w"> </span>â”‚â”‚<span class="w"> </span>â”‚â”‚<span class="w"> </span><span class="nv">Cache</span><span class="w"> </span>â”‚â”‚<span class="w">       </span>â”‚
â”‚<span class="w">     </span>â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚<span class="w"> </span>â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚<span class="w"> </span>â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚<span class="w"> </span>â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚<span class="w">       </span>â”‚
â”‚<span class="w">     </span>â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜<span class="w"> </span>â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜<span class="w"> </span>â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜<span class="w"> </span>â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜<span class="w">       </span>â”‚
â”‚<span class="w">          </span>â”‚<span class="w">           </span>â”‚<span class="w">           </span>â”‚<span class="w">           </span>â”‚<span class="w">             </span>â”‚
â”‚<span class="w">          </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">             </span>â”‚
â”‚<span class="w">                            </span>â”‚<span class="w">                                </span>â”‚
â”‚<span class="w">                      </span><span class="nv">System</span><span class="w"> </span><span class="nv">Bus</span><span class="w">                            </span>â”‚
â”‚<span class="w">                            </span>â”‚<span class="w">                                </span>â”‚
â”‚<span class="w">     </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">        </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">                                             </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">              </span><span class="nv">Shared</span><span class="w"> </span><span class="nv">Memory</span><span class="w">                  </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">            </span><span class="ss">(</span><span class="nv">Equal</span><span class="w"> </span><span class="nv">access</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">CPUs</span><span class="ss">)</span><span class="w">      </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">                                             </span>â”‚<span class="w">        </span>â”‚
â”‚<span class="w">     </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">        </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Characteristics</span>:<span class="w">                                           </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">All</span><span class="w"> </span><span class="nv">processors</span><span class="w"> </span><span class="nv">have</span><span class="w"> </span><span class="nv">equal</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span><span class="nv">access</span><span class="w"> </span><span class="ss">(</span><span class="nv">UMA</span><span class="ss">)</span><span class="w">           </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Any</span><span class="w"> </span><span class="nv">CPU</span><span class="w"> </span><span class="nv">can</span><span class="w"> </span><span class="nv">run</span><span class="w"> </span><span class="nv">same</span><span class="w"> </span><span class="nv">code</span><span class="w">                               </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Limited</span><span class="w"> </span><span class="nv">scalability</span><span class="w"> </span><span class="ss">(</span><span class="nv">bus</span><span class="w"> </span><span class="nv">contention</span><span class="ss">)</span><span class="w">                    </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Typically</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="nv">CPUs</span><span class="w">                                      </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="32-numa-non-uniform-memory-access">3.2 NUMA (Non-Uniform Memory Access)<a class="header-link" href="#32-numa-non-uniform-memory-access" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                    </span><span class="nv">NUMA</span><span class="w"> </span><span class="nv">Architecture</span><span class="w">                         </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">          </span><span class="nv">Node</span><span class="w"> </span><span class="mi">0</span><span class="w">                        </span><span class="nv">Node</span><span class="w"> </span><span class="mi">1</span><span class="w">               </span>â”‚
â”‚<span class="w">     </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">          </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span><span class="nv">CPU0</span><span class="w">    </span><span class="nv">CPU1</span><span class="w">    </span>â”‚<span class="w">          </span>â”‚<span class="w">  </span><span class="nv">CPU2</span><span class="w">    </span><span class="nv">CPU3</span><span class="w">    </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”<span class="w">   </span>â”Œâ”€â”€â”€â”<span class="w">   </span>â”‚<span class="w">          </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”<span class="w">   </span>â”Œâ”€â”€â”€â”<span class="w">   </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span>â”‚<span class="w"> </span>$<span class="w"> </span>â”‚<span class="w">   </span>â”‚<span class="w"> </span>$<span class="w"> </span>â”‚<span class="w">   </span>â”‚<span class="w">          </span>â”‚<span class="w">  </span>â”‚<span class="w"> </span>$<span class="w"> </span>â”‚<span class="w">   </span>â”‚<span class="w"> </span>$<span class="w"> </span>â”‚<span class="w">   </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span>â””â”€â”¬â”€â”˜<span class="w">   </span>â””â”€â”¬â”€â”˜<span class="w">   </span>â”‚<span class="w">          </span>â”‚<span class="w">  </span>â””â”€â”¬â”€â”˜<span class="w">   </span>â””â”€â”¬â”€â”˜<span class="w">   </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">    </span>â””â”€â”€â”€â”¬â”€â”€â”€â”˜<span class="w">     </span>â”‚<span class="w">          </span>â”‚<span class="w">    </span>â””â”€â”€â”€â”¬â”€â”€â”€â”˜<span class="w">     </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">        </span>â”‚<span class="w">         </span>â”‚<span class="w">          </span>â”‚<span class="w">        </span>â”‚<span class="w">         </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”<span class="w">   </span>â”‚<span class="w">          </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”<span class="w">   </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Local</span><span class="w"> </span><span class="nv">Mem</span><span class="w"> </span>â”‚<span class="w">   </span>â”‚â—€â•â•â•â•â•â•â•â•â–¶â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Local</span><span class="w"> </span><span class="nv">Mem</span><span class="w"> </span>â”‚<span class="w">   </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="ss">(</span><span class="nv">Fast</span><span class="ss">)</span><span class="w">   </span>â”‚<span class="w">   </span>â”‚<span class="nv">Interconn</span>â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="ss">(</span><span class="nv">Fast</span><span class="ss">)</span><span class="w">   </span>â”‚<span class="w">   </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">   </span>â”‚<span class="w">          </span>â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">   </span>â”‚<span class="w">     </span>â”‚
â”‚<span class="w">     </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">          </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">     </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Memory</span><span class="w"> </span><span class="nv">access</span><span class="w"> </span><span class="nv">time</span>:<span class="w">                                        </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Local</span><span class="w"> </span><span class="nv">Memory</span><span class="w"> </span><span class="ss">(</span><span class="nv">same</span><span class="w"> </span><span class="nv">node</span><span class="ss">)</span>:<span class="w">     </span><span class="o">~</span><span class="mi">100</span><span class="w"> </span><span class="nv">cycles</span><span class="w">              </span>â”‚â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Remote</span><span class="w"> </span><span class="nv">Memory</span><span class="w"> </span><span class="ss">(</span><span class="nv">other</span><span class="w"> </span><span class="nv">node</span><span class="ss">)</span>:<span class="w">   </span><span class="o">~</span><span class="mi">300</span><span class="w"> </span><span class="nv">cycles</span><span class="w"> </span><span class="ss">(</span><span class="mi">3</span><span class="nv">x</span><span class="w"> </span><span class="nv">slower</span><span class="ss">)</span><span class="w">  </span>â”‚â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Characteristics</span>:<span class="w">                                           </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Local</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span><span class="nv">access</span><span class="w"> </span><span class="nv">faster</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="nv">remote</span><span class="w"> </span><span class="nv">memory</span><span class="w">           </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Excellent</span><span class="w"> </span><span class="nv">scalability</span><span class="w"> </span><span class="ss">(</span><span class="nv">hundreds</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">CPUs</span><span class="w"> </span><span class="nv">possible</span><span class="ss">)</span><span class="w">       </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Requires</span><span class="w"> </span><span class="nv">NUMA</span><span class="o">-</span><span class="nv">aware</span><span class="w"> </span><span class="nv">programming</span><span class="w">                         </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Standard</span><span class="w"> </span><span class="nv">architecture</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">modern</span><span class="w"> </span><span class="nv">servers</span><span class="w">                </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="33-multicore-processor">3.3 Multicore Processor<a class="header-link" href="#33-multicore-processor" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Modern Multicore CPU                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    CPU Die                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚    Core 0           Core 1          Core 2      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚L1-Iâ”‚L1-Dâ”‚      â”‚L1-Iâ”‚L1-Dâ”‚     â”‚L1-Iâ”‚L1-Dâ”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   L2    â”‚      â”‚   L2    â”‚     â”‚   L2    â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                          â”‚                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚                  Shared L3 Cache               â”‚    â”‚ â”‚
â”‚  â”‚  â”‚                   (8-64 MB)                    â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â”‚                          â”‚                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚            Memory Controller                   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚            + PCIe Controller                   â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  Advantages:                                                â”‚
â”‚  - Fast inter-core communication (on-chip)                 â”‚
â”‚  - Power efficient                                         â”‚
â”‚  - Efficient data sharing through shared cache             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="34-hyper-threading-smt">3.4 Hyper-Threading (SMT)<a class="header-link" href="#34-hyper-threading-smt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">           </span><span class="nv">Simultaneous</span><span class="w"> </span><span class="nv">Multi</span><span class="o">-</span><span class="nv">Threading</span><span class="w"> </span><span class="ss">(</span><span class="nv">SMT</span><span class="ss">)</span><span class="w">                 </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Execute</span><span class="w"> </span><span class="nv">multiple</span><span class="w"> </span><span class="nv">threads</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">single</span><span class="w"> </span><span class="nv">physical</span><span class="w"> </span><span class="nv">core</span>:<span class="w">          </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                   </span><span class="nv">Physical</span><span class="w"> </span><span class="nv">Core</span><span class="w">                      </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Thread</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">State</span><span class="w"> </span>â”‚<span class="w"> </span><span class="nv">Thread</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">State</span><span class="w">                 </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w"> </span>â”‚<span class="w"> </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                  </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="nv">Registers</span><span class="w">  </span>â”‚<span class="w"> </span>â”‚<span class="w"> </span>â”‚<span class="nv">Registers</span><span class="w">  </span>â”‚<span class="w">  </span>â†<span class="w"> </span><span class="nv">Duplicated</span><span class="w">   </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="nv">PC</span>,<span class="w"> </span><span class="nv">Stack</span><span class="w">  </span>â”‚<span class="w"> </span>â”‚<span class="w"> </span>â”‚<span class="nv">PC</span>,<span class="w"> </span><span class="nv">Stack</span><span class="w">  </span>â”‚<span class="w">                  </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w"> </span>â”‚<span class="w"> </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                  </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                      </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">              </span><span class="nv">Shared</span><span class="w"> </span><span class="nv">Resources</span><span class="w">                   </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w"> </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w"> </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">          </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">ALU</span><span class="w">    </span>â”‚<span class="w"> </span>â”‚<span class="w">  </span><span class="nv">Cache</span><span class="w">  </span>â”‚<span class="w"> </span>â”‚<span class="w"> </span><span class="nv">Branch</span><span class="w">  </span>â”‚<span class="w">  </span>â†<span class="w"> </span><span class="nv">Shared</span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">         </span>â”‚<span class="w"> </span>â”‚<span class="w">         </span>â”‚<span class="w"> </span>â”‚<span class="nv">Predictor</span>â”‚<span class="w">          </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w"> </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w"> </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">          </span>â”‚â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">   </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Operation</span>:<span class="w">                                                 </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">When</span><span class="w"> </span><span class="nv">Thread</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">waits</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">Thread</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">executes</span><span class="w">      </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Improves</span><span class="w"> </span><span class="nv">execution</span><span class="w"> </span><span class="nv">unit</span><span class="w"> </span><span class="nv">utilization</span><span class="w">                     </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Typically</span><span class="w"> </span><span class="mi">15</span><span class="o">-</span><span class="mi">30</span><span class="o">%</span><span class="w"> </span><span class="nv">performance</span><span class="w"> </span><span class="nv">improvement</span><span class="w">                </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">OS</span><span class="w"> </span><span class="nv">view</span>:<span class="w">                                                   </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="nv">core</span><span class="w"> </span><span class="mi">8</span><span class="o">-</span><span class="nv">thread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">recognized</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nv">logical</span><span class="w"> </span><span class="nv">CPUs</span><span class="w">          </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="4-cache-coherence-problem">4. Cache Coherence Problem<a class="header-link" href="#4-cache-coherence-problem" title="Permanent link">&para;</a></h2>
<h3 id="41-what-is-cache-coherence">4.1 What is Cache Coherence?<a class="header-link" href="#41-what-is-cache-coherence" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Problem</span><span class="w"> </span><span class="nv">scenario</span>:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">     </span><span class="nv">Core</span><span class="w"> </span><span class="mi">0</span><span class="w">                            </span><span class="nv">Core</span><span class="w"> </span><span class="mi">1</span><span class="w">                </span>â”‚
â”‚<span class="w">     </span><span class="nv">Cache</span><span class="w">                             </span><span class="nv">Cache</span><span class="w">                 </span>â”‚
â”‚<span class="w">   </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                       </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">            </span>â”‚
â”‚<span class="w">   </span>â”‚<span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span>â”‚<span class="w">                       </span>â”‚<span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span>â”‚<span class="w">            </span>â”‚
â”‚<span class="w">   </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                       </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">            </span>â”‚
â”‚<span class="w">        </span>â”‚<span class="w">                                 </span>â”‚<span class="w">                  </span>â”‚
â”‚<span class="w">        </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                  </span>â”‚
â”‚<span class="w">                      </span>â”‚<span class="w">                                      </span>â”‚
â”‚<span class="w">               </span>â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”<span class="w">                              </span>â”‚
â”‚<span class="w">               </span>â”‚<span class="w"> </span><span class="nv">Main</span><span class="w"> </span><span class="nv">Memory</span><span class="w"> </span>â”‚<span class="w">                              </span>â”‚
â”‚<span class="w">               </span>â”‚<span class="w">   </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w">    </span>â”‚<span class="w">                              </span>â”‚
â”‚<span class="w">               </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                              </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="mi">1</span>.<span class="w"> </span><span class="nv">Initial</span><span class="w"> </span><span class="nv">state</span>:<span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="ss">(</span><span class="nv">all</span><span class="w"> </span><span class="nv">same</span><span class="ss">)</span><span class="w">                       </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="mi">2</span>.<span class="w"> </span><span class="nv">Core</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">modifies</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span>:<span class="w">                                </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">     </span><span class="nv">Core</span><span class="w"> </span><span class="mi">0</span><span class="w">                            </span><span class="nv">Core</span><span class="w"> </span><span class="mi">1</span><span class="w">                </span>â”‚
â”‚<span class="w">     </span><span class="nv">Cache</span><span class="w">                             </span><span class="nv">Cache</span><span class="w">                 </span>â”‚
â”‚<span class="w">   </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">                       </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">            </span>â”‚
â”‚<span class="w">   </span>â”‚<span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="w">  </span>â”‚<span class="w"> </span>â†<span class="w"> </span><span class="nv">Modified</span><span class="w">            </span>â”‚<span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span>â”‚<span class="w"> </span>â†<span class="w"> </span><span class="nv">Stale</span><span class="o">!</span><span class="w">   </span>â”‚
â”‚<span class="w">   </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">                       </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">            </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="mi">3</span>.<span class="w"> </span><span class="nv">What</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">does</span><span class="w"> </span><span class="nv">Core</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">read</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">X</span>?<span class="w">                     </span>â”‚
â”‚<span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="ss">(</span><span class="nv">its</span><span class="w"> </span><span class="nv">own</span><span class="w"> </span><span class="nv">cache</span><span class="ss">)</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">Stale</span><span class="w"> </span><span class="nv">value</span><span class="o">!</span><span class="w"> </span><span class="ss">(</span><span class="nv">coherence</span><span class="w"> </span><span class="nv">violation</span><span class="ss">)</span>â”‚
â”‚<span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="ss">(</span><span class="nv">Core</span><span class="w"> </span><span class="mi">0</span><span class="err">&#39;s value) â†’ Coherence maintained           â”‚</span>
<span class="err">â”‚                                                             â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="42-coherence-definition">4.2 Coherence Definition<a class="header-link" href="#42-coherence-definition" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Cache</span><span class="w"> </span><span class="nx">Coherence</span><span class="w"> </span><span class="nx">conditions</span><span class="p">:</span>

<span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Program</span><span class="w"> </span><span class="nx">order</span><span class="w"> </span><span class="nx">preservation</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Write</span><span class="w"> </span><span class="nx">followed</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">read</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">processor</span><span class="w"> </span><span class="nx">returns</span><span class="w"> </span><span class="nx">written</span><span class="w"> </span><span class="nx">value</span>

<span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Consistent</span><span class="w"> </span><span class="nx">read</span><span class="w"> </span><span class="nx">values</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Writes</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">other</span><span class="w"> </span><span class="nx">processors</span><span class="w"> </span><span class="nx">eventually</span><span class="w"> </span><span class="nx">visible</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">processors</span>

<span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Write</span><span class="w"> </span><span class="nx">serialization</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Writes</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">appear</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">order</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">processors</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Example</span><span class="p">:</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Initial</span><span class="p">:</span><span class="w"> </span><span class="nx">X</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Core</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="nx">X</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Core</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="nx">X</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Order</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">X</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="nx">seen</span><span class="w"> </span><span class="nx">must</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">processors</span><span class="p">:</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">see</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nx">order</span><span class="p">,</span><span class="w"> </span><span class="nx">OR</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">see</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">order</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Some</span><span class="w"> </span><span class="nx">processors</span><span class="w"> </span><span class="nx">seeing</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nx">others</span><span class="w"> </span><span class="nx">see</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">invalid</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="43-coherence-protocol-overview">4.3 Coherence Protocol Overview<a class="header-link" href="#43-coherence-protocol-overview" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Coherence</span><span class="w"> </span><span class="nx">maintenance</span><span class="w"> </span><span class="nx">methods</span><span class="p">:</span>

<span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Snooping</span><span class="w"> </span><span class="nx">Protocol</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Suitable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">bus</span><span class="o">-</span><span class="nx">based</span><span class="w"> </span><span class="nx">systems</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Each</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="nx">monitors</span><span class="w"> </span><span class="nx">bus</span><span class="w"> </span><span class="nx">traffic</span><span class="w"> </span><span class="p">(</span><span class="nx">snooping</span><span class="p">)</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Takes</span><span class="w"> </span><span class="nx">appropriate</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">relevant</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">detected</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">MESI</span><span class="p">,</span><span class="w"> </span><span class="nx">MOESI</span><span class="p">,</span><span class="w"> </span><span class="nx">etc</span><span class="p">.</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="nx">Cache</span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="nx">Cache</span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="nx">Cache</span><span class="err">â”‚</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">monitor</span><span class="w"> </span><span class="nx">bus</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”¬â”€â”€â”˜</span><span class="w">     </span><span class="err">â””â”€â”€â”¬â”€â”€â”˜</span><span class="w">     </span><span class="err">â””â”€â”€â”¬â”€â”€â”˜</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•</span><span class="w">  </span><span class="p">(</span><span class="nx">Shared</span><span class="w"> </span><span class="nx">Bus</span><span class="p">)</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">             </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">             </span><span class="err">â”‚</span><span class="w">   </span><span class="nx">Memory</span><span class="w">    </span><span class="err">â”‚</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">             </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">Protocol</span><span class="p">:</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Good</span><span class="w"> </span><span class="nx">scalability</span><span class="w"> </span><span class="p">(</span><span class="nx">suitable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">NUMA</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Central</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="nx">tracks</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="nx">states</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Send</span><span class="w"> </span><span class="nx">messages</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">relevant</span><span class="w"> </span><span class="nx">caches</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w">           </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w">           </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="nx">Cache</span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="nx">Cache</span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="nx">Cache</span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€â”¬â”€â”€â”˜</span><span class="w">           </span><span class="err">â””â”€â”€â”¬â”€â”€â”˜</span><span class="w">           </span><span class="err">â””â”€â”€â”¬â”€â”€â”˜</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">        </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="nx">Memory</span><span class="w">    </span><span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="p">(</span><span class="nx">State</span><span class="w"> </span><span class="nx">Trac</span><span class="p">)</span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">             </span><span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="5-snooping-protocol-mesi">5. Snooping Protocol (MESI)<a class="header-link" href="#5-snooping-protocol-mesi" title="Permanent link">&para;</a></h2>
<h3 id="51-mesi-states">5.1 MESI States<a class="header-link" href="#51-mesi-states" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MESI Protocol States                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  M (Modified):                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ - This cache only has copy                          â”‚   â”‚
â”‚  â”‚ - Modified (inconsistent with memory)               â”‚   â”‚
â”‚  â”‚ - Write-back needed on other cache access           â”‚   â”‚
â”‚  â”‚ - Write allowed                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  E (Exclusive):                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ - This cache only has copy                          â”‚   â”‚
â”‚  â”‚ - Not modified (consistent with memory)             â”‚   â”‚
â”‚  â”‚ - Transition to M on write (no invalidation needed) â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  S (Shared):                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ - Multiple caches may have copy                     â”‚   â”‚
â”‚  â”‚ - Consistent with memory                            â”‚   â”‚
â”‚  â”‚ - On write, invalidate other caches â†’ M state       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  I (Invalid):                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ - No valid data                                     â”‚   â”‚
â”‚  â”‚ - Cache line empty                                  â”‚   â”‚
â”‚  â”‚ - Cache miss on access                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="52-mesi-state-transitions">5.2 MESI State Transitions<a class="header-link" href="#52-mesi-state-transitions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MESI State Transition Diagram              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚           Read miss  â”‚         â”‚  Read miss                 â”‚
â”‚           (exclusive)â”‚    I    â”‚  (shared)                  â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”‚ Invalid â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚             â”‚        â”‚         â”‚        â”‚                   â”‚
â”‚             â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚                   â”‚
â”‚             â”‚             â”‚             â”‚                   â”‚
â”‚             â”‚        Writeâ”‚             â”‚                   â”‚
â”‚             â”‚        miss â”‚             â”‚                   â”‚
â”‚             â”‚             â”‚             â”‚                   â”‚
â”‚             â–¼             â”‚             â–¼                   â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚       â”‚    E     â”‚        â”‚      â”‚    S     â”‚              â”‚
â”‚       â”‚Exclusive â”‚        â”‚      â”‚ Shared   â”‚              â”‚
â”‚       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â”‚
â”‚            â”‚              â”‚           â”‚                     â”‚
â”‚       Localâ”‚              â”‚      Localâ”‚                     â”‚
â”‚       Writeâ”‚              â”‚      Writeâ”‚                     â”‚
â”‚            â”‚              â”‚           â”‚                     â”‚
â”‚            â–¼              â–¼           â–¼                     â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚       â”‚            M                    â”‚                  â”‚
â”‚       â”‚         Modified                â”‚                  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â”‚  Key transitions:                                           â”‚
â”‚  - I â†’ E: Read miss, not in other caches                   â”‚
â”‚  - I â†’ S: Read miss, exists in other caches (Shared state) â”‚
â”‚  - E â†’ M: Local write (no invalidation broadcast needed)   â”‚
â”‚  - S â†’ M: Local write + invalidate other caches            â”‚
â”‚  - M/E/S â†’ I: Invalidated by other cache&#39;s write           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="53-mesi-operation-example">5.3 MESI Operation Example<a class="header-link" href="#53-mesi-operation-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MESI Protocol Operation Example                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Initial: Variable X not in any cache (only in memory X=0)  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 1: Core 0 reads X                              â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚   Core 0 Cache     Core 1 Cache     Memory          â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚   â”‚ X=0 (E) â”‚      â”‚ X (I)   â”‚      â”‚ X = 0   â”‚    â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚   Exclusive (not in other caches)                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 2: Core 1 reads X                              â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚   Core 0 Cache     Core 1 Cache     Memory          â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚   â”‚ X=0 (S) â”‚      â”‚ X=0 (S) â”‚      â”‚ X = 0   â”‚    â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚   Eâ†’S transition (read by other cache)              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 3: Core 0 writes X = 10                        â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚   Core 0: Broadcast invalidation message            â”‚   â”‚
â”‚  â”‚   Core 1: Change X to Invalid                       â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚   Core 0 Cache     Core 1 Cache     Memory          â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚   â”‚ X=10(M) â”‚      â”‚ X (I)   â”‚      â”‚ X = 0   â”‚    â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚   Modified (inconsistent with memory)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 4: Core 1 reads X                              â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚   Core 1: Read miss, Core 0 provides data           â”‚   â”‚
â”‚  â”‚   Core 0: Write-back to memory, transition to S     â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚   Core 0 Cache     Core 1 Cache     Memory          â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚   â”‚ X=10(S) â”‚      â”‚ X=10(S) â”‚      â”‚ X = 10  â”‚    â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚   Mâ†’S transition, memory updated                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="54-moesi-protocol">5.4 MOESI Protocol<a class="header-link" href="#54-moesi-protocol" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>MOESI = MESI + Owner state:

O (Owner):
- Sole owner of modified data
- Other caches may have Shared copies
- Inconsistent with memory (Owner has latest)
- Owner responds to other cache requests

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MOESI advantages:                                          â”‚
â”‚  - Increased cache-to-cache transfer efficiency            â”‚
â”‚  - Can delay write-back                                    â”‚
â”‚  - Mainly used in AMD processors                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="6-amdahls-law-and-gustafsons-law">6. Amdahl's Law and Gustafson's Law<a class="header-link" href="#6-amdahls-law-and-gustafsons-law" title="Permanent link">&para;</a></h2>
<h3 id="61-amdahls-law">6.1 Amdahl's Law<a class="header-link" href="#61-amdahls-law" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Law showing limits of parallelization:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Amdahl&#39;s Law                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                        1                                    â”‚
â”‚  Speedup = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚            (1 - P) + P/N                                    â”‚
â”‚                                                             â”‚
â”‚  P: Parallelizable fraction                                 â”‚
â”‚  N: Number of processors                                    â”‚
â”‚                                                             â”‚
â”‚  Example: P = 90% (90% parallelizable)                     â”‚
â”‚                                                             â”‚
â”‚  N=2:   Speedup = 1/(0.1 + 0.45) = 1.82x                   â”‚
â”‚  N=4:   Speedup = 1/(0.1 + 0.225) = 3.08x                  â”‚
â”‚  N=8:   Speedup = 1/(0.1 + 0.1125) = 4.71x                 â”‚
â”‚  N=âˆ:   Speedup = 1/0.1 = 10x  â† Maximum limit!            â”‚
â”‚                                                             â”‚
â”‚  Even with 90% parallelization, max 10x speedup possible    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Speedup                                              â”‚   â”‚
â”‚  â”‚    â”‚                              _______ P=99%     â”‚   â”‚
â”‚  â”‚ 100â”‚                        _____/                  â”‚   â”‚
â”‚  â”‚    â”‚                   ____/                        â”‚   â”‚
â”‚  â”‚ 80 â”‚              ____/                             â”‚   â”‚
â”‚  â”‚    â”‚         ____/              _______ P=95%       â”‚   â”‚
â”‚  â”‚ 60 â”‚    ____/              ____/                    â”‚   â”‚
â”‚  â”‚    â”‚___/              ____/                         â”‚   â”‚
â”‚  â”‚ 40 â”‚             ____/          _______ P=90%       â”‚   â”‚
â”‚  â”‚    â”‚        ____/          ____/                    â”‚   â”‚
â”‚  â”‚ 20 â”‚   ____/          ____/                         â”‚   â”‚
â”‚  â”‚    â”‚__/          ____/_______________________ P=75% â”‚   â”‚
â”‚  â”‚    â”‚        ____/___________________________        â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚    1    10   100  1000  10000  Number of processors â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="62-gustafsons-law">6.2 Gustafson's Law<a class="header-link" href="#62-gustafsons-law" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">More</span><span class="w"> </span><span class="n">parallelization</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">scaling</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="n">size</span><span class="p">:</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">Gustafson</span><span class="s1">&#39;s Law                           â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Scaled</span><span class="w"> </span><span class="n">Speedup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="n">S</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Or</span><span class="p">:</span><span class="w">                                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Speedup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">N</span><span class="p">:</span><span class="w"> </span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">processors</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">S</span><span class="p">:</span><span class="w"> </span><span class="n">Sequential</span><span class="w"> </span><span class="n">fraction</span><span class="w"> </span><span class="p">(</span><span class="n">fixed</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Key</span><span class="w"> </span><span class="n">idea</span><span class="p">:</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Amdahl</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Fixed problem size, add processors&quot;</span><span class="w">      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â†’</span><span class="w"> </span><span class="n">Sequential</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">becomes</span><span class="w"> </span><span class="n">bottleneck</span><span class="w">       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Gustafson</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Fixed time, scale problem size&quot;</span><span class="w">       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">             </span><span class="err">â†’</span><span class="w"> </span><span class="n">Solve</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">time</span><span class="w">     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">             </span><span class="err">â†’</span><span class="w"> </span><span class="n">Parallel</span><span class="w"> </span><span class="n">portion</span><span class="w"> </span><span class="n">fraction</span><span class="w"> </span><span class="n">increases</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Example</span><span class="p">:</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">simulation</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">hour</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Adding</span><span class="w"> </span><span class="n">processors</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">simulation</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Sequential</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="p">(</span><span class="n">initialization</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="p">)</span><span class="w"> </span><span class="n">stays</span><span class="w"> </span><span class="n">constant</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">parallel</span><span class="w"> </span><span class="n">computation</span><span class="w"> </span><span class="n">volume</span><span class="w"> </span><span class="n">increases</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="63-actual-parallelization-efficiency">6.3 Actual Parallelization Efficiency<a class="header-link" href="#63-actual-parallelization-efficiency" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">              </span><span class="nv">Parallelization</span><span class="w"> </span><span class="nv">Efficiency</span><span class="w"> </span><span class="nv">Calculation</span><span class="w">          </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Speedup</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">N</span><span class="w">                                  </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Ideal</span>:<span class="w"> </span><span class="nv">Efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">(</span><span class="mi">100</span><span class="o">%</span><span class="ss">)</span><span class="w">                              </span>â”‚
â”‚<span class="w">  </span><span class="nv">Realistic</span>:<span class="w"> </span><span class="nv">Less</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">due</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">overhead</span><span class="w">                    </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Overhead</span><span class="w"> </span><span class="nv">factors</span>:<span class="w">                                          </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Communication</span><span class="w"> </span><span class="nv">time</span><span class="w"> </span><span class="ss">(</span><span class="nv">inter</span><span class="o">-</span><span class="nv">processor</span><span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="nv">transfer</span><span class="ss">)</span><span class="w">       </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Synchronization</span><span class="w"> </span><span class="k">wait</span><span class="w"> </span><span class="nv">time</span><span class="w">                               </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Load</span><span class="w"> </span><span class="nv">imbalance</span><span class="w"> </span><span class="ss">(</span><span class="nv">unequal</span><span class="w"> </span><span class="nv">work</span><span class="w"> </span><span class="nv">distribution</span><span class="ss">)</span><span class="w">              </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Cache</span><span class="w"> </span><span class="nv">coherence</span><span class="w"> </span><span class="nv">traffic</span><span class="w">                                 </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Memory</span><span class="w"> </span><span class="nv">contention</span><span class="w">                                        </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Efficiency</span><span class="w"> </span><span class="nv">graph</span>:<span class="w">                                          </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="nv">Efficiency</span><span class="w">                                           </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="mi">100</span><span class="o">%</span>â”‚â”€â”€â”€â”€â”<span class="w">                                          </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">     </span>â”‚<span class="w">    </span>â””â”€â”€â”€â”€â”<span class="w">                                     </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="mi">80</span><span class="o">%</span><span class="w"> </span>â”‚<span class="w">         </span>â””â”€â”€â”€â”€â”<span class="w">                                </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">     </span>â”‚<span class="w">              </span>â””â”€â”€â”€â”€â”<span class="w">                           </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="mi">60</span><span class="o">%</span><span class="w"> </span>â”‚<span class="w">                   </span>â””â”€â”€â”€â”€â”<span class="w">                      </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">     </span>â”‚<span class="w">                        </span>â””â”€â”€â”€â”€â”<span class="w">                 </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="mi">40</span><span class="o">%</span><span class="w"> </span>â”‚<span class="w">                             </span>â””â”€â”€â”€â”€â”<span class="w">            </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">     </span>â”‚<span class="w">                                  </span>â””â”€â”€â”€â”€<span class="w">        </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="mi">20</span><span class="o">%</span><span class="w"> </span>â”‚<span class="w">                                              </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">     </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">     </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">     </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">8</span><span class="w">   </span><span class="mi">16</span><span class="w">  </span><span class="mi">32</span><span class="w">  </span><span class="mi">64</span><span class="w">  </span><span class="mi">128</span><span class="w"> </span><span class="nv">Number</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">processors</span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">   </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="nv">Generally</span><span class="w"> </span><span class="nv">efficiency</span><span class="w"> </span><span class="nv">decreases</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">processor</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="nv">increases</span>â”‚
â”‚<span class="w">  </span><span class="ss">(</span><span class="nv">Diminishing</span><span class="w"> </span><span class="nv">returns</span><span class="ss">)</span><span class="w">                                      </span>â”‚
â”‚<span class="w">                                                             </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="7-synchronization-and-locks">7. Synchronization and Locks<a class="header-link" href="#7-synchronization-and-locks" title="Permanent link">&para;</a></h2>
<h3 id="71-need-for-synchronization">7.1 Need for Synchronization<a class="header-link" href="#71-need-for-synchronization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Race</span><span class="w"> </span><span class="n">Condition</span><span class="w"> </span><span class="n">example</span><span class="p">:</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Shared</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Thread</span><span class="w"> </span><span class="mi">0</span><span class="w">              </span><span class="n">Thread</span><span class="w"> </span><span class="mi">1</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">     </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nb">load</span><span class="w">  </span><span class="n">counter</span><span class="w">         </span><span class="nb">load</span><span class="w">  </span><span class="n">counter</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">Both</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">add</span><span class="w">   </span><span class="mi">1</span><span class="w">               </span><span class="n">add</span><span class="w">   </span><span class="mi">1</span><span class="w">               </span><span class="o">//</span><span class="w"> </span><span class="n">Both</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">store</span><span class="w"> </span><span class="n">counter</span><span class="w">         </span><span class="n">store</span><span class="w"> </span><span class="n">counter</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">Both</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="mi">1</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Expected</span><span class="w"> </span><span class="n">result</span><span class="p">:</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Actual</span><span class="w"> </span><span class="n">result</span><span class="p">:</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">One</span><span class="w"> </span><span class="n">increment</span><span class="w"> </span><span class="n">lost</span><span class="o">!</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="72-atomic-operations">7.2 Atomic Operations<a class="header-link" href="#72-atomic-operations" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Hardware</span><span class="o">-</span><span class="nx">supported</span><span class="w"> </span><span class="nx">atomic</span><span class="w"> </span><span class="nx">operations</span><span class="p">:</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Test</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Set</span><span class="w"> </span><span class="p">(</span><span class="nx">TAS</span><span class="p">):</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">int</span><span class="w"> </span><span class="nx">TAS</span><span class="p">(</span><span class="nx">int</span><span class="w"> </span><span class="o">*</span><span class="nx">lock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="nx">int</span><span class="w"> </span><span class="nx">old</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">*</span><span class="nx">lock</span><span class="p">;</span><span class="w">   </span><span class="c1">// Read                   â”‚     â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="o">*</span><span class="nx">lock</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">         </span><span class="c1">// Write      Executed    â”‚     â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">old</span><span class="p">;</span><span class="w">        </span><span class="c1">// Return     atomically  â”‚     â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">}</span><span class="w">                                                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Compare</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Swap</span><span class="w"> </span><span class="p">(</span><span class="nx">CAS</span><span class="p">):</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="nx">CAS</span><span class="p">(</span><span class="nx">int</span><span class="w"> </span><span class="o">*</span><span class="kd">addr</span><span class="p">,</span><span class="w"> </span><span class="nx">int</span><span class="w"> </span><span class="nx">expected</span><span class="p">,</span><span class="w"> </span><span class="nx">int</span><span class="w"> </span><span class="nx">new</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">     </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="kd">addr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">expected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="o">*</span><span class="kd">addr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="p">;</span><span class="w">                </span><span class="nx">Executed</span><span class="w">     </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">                </span><span class="nx">atomically</span><span class="w">   </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="p">}</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">                                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">}</span><span class="w">                                                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Fetch</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Add</span><span class="p">:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">int</span><span class="w"> </span><span class="nx">FAA</span><span class="p">(</span><span class="nx">int</span><span class="w"> </span><span class="o">*</span><span class="kd">addr</span><span class="p">,</span><span class="w"> </span><span class="nx">int</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="nx">int</span><span class="w"> </span><span class="nx">old</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">*</span><span class="kd">addr</span><span class="p">;</span><span class="w">                 </span><span class="nx">Executed</span><span class="w">    </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="o">*</span><span class="kd">addr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">old</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">val</span><span class="p">;</span><span class="w">               </span><span class="nx">atomically</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">old</span><span class="p">;</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">}</span><span class="w">                                                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">x86</span><span class="w"> </span><span class="nx">instruction</span><span class="w"> </span><span class="nx">examples</span><span class="p">:</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">LOCK</span><span class="w"> </span><span class="nx">XCHG</span><span class="w"> </span><span class="p">(</span><span class="nx">Test</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Set</span><span class="p">)</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">LOCK</span><span class="w"> </span><span class="nx">CMPXCHG</span><span class="w"> </span><span class="p">(</span><span class="nx">Compare</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Swap</span><span class="p">)</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">LOCK</span><span class="w"> </span><span class="nx">XADD</span><span class="w"> </span><span class="p">(</span><span class="nx">Fetch</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Add</span><span class="p">)</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="73-spinlock">7.3 Spinlock<a class="header-link" href="#73-spinlock" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nx">Spinlock</span><span class="w"> </span><span class="nx">Implementation</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Simple</span><span class="w"> </span><span class="nx">spinlock</span><span class="w"> </span><span class="p">(</span><span class="nx">Test</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Set</span><span class="p">):</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">void</span><span class="w"> </span><span class="nx">lock</span><span class="p">(</span><span class="nx">int</span><span class="w"> </span><span class="o">*</span><span class="nx">lock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">TAS</span><span class="p">(</span><span class="nx">lock</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="c1">// Spin (busy wait)                      â”‚     â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="p">}</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">}</span><span class="w">                                                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                   </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">void</span><span class="w"> </span><span class="nx">unlock</span><span class="p">(</span><span class="nx">int</span><span class="w"> </span><span class="o">*</span><span class="nx">lock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="o">*</span><span class="nx">lock</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">                                   </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">}</span><span class="w">                                                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Problem</span><span class="p">:</span><span class="w"> </span><span class="nx">Bus</span><span class="w"> </span><span class="nx">traffic</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">every</span><span class="w"> </span><span class="nx">TAS</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Test</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Test</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="nx">Set</span><span class="w"> </span><span class="p">(</span><span class="nx">TTAS</span><span class="p">):</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">void</span><span class="w"> </span><span class="nx">lock</span><span class="p">(</span><span class="nx">int</span><span class="w"> </span><span class="o">*</span><span class="nx">lock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">lock</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="c1">// Spin in local cache (no bus traffic)â”‚   â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="p">}</span><span class="w">                                        </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">TAS</span><span class="p">(</span><span class="nx">lock</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="k">return</span><span class="p">;</span><span class="w">  </span><span class="c1">// Lock acquired            â”‚     â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="p">}</span><span class="w">                                        </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">      </span><span class="p">}</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">}</span><span class="w">                                                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Improvement</span><span class="p">:</span><span class="w"> </span><span class="nx">Wait</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">local</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="nx">until</span><span class="w"> </span><span class="nx">lock</span><span class="w"> </span><span class="nx">released</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="74-mutex-and-semaphore">7.4 Mutex and Semaphore<a class="header-link" href="#74-mutex-and-semaphore" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nt">Synchronization</span><span class="w"> </span><span class="nt">Primitives</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">Mutex</span><span class="o">:</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Mutual</span><span class="w"> </span><span class="nt">Exclusion</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Only</span><span class="w"> </span><span class="nt">one</span><span class="w"> </span><span class="nt">thread</span><span class="w"> </span><span class="nt">allowed</span><span class="w"> </span><span class="nt">at</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="nt">time</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Has</span><span class="w"> </span><span class="nt">ownership</span><span class="w"> </span><span class="o">(</span><span class="nt">only</span><span class="w"> </span><span class="nt">acquiring</span><span class="w"> </span><span class="nt">thread</span><span class="w"> </span><span class="nt">can</span><span class="w"> </span><span class="nt">release</span><span class="o">)</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">pthread_mutex_t</span><span class="w"> </span><span class="nt">mutex</span><span class="o">;</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">pthread_mutex_init</span><span class="o">(&amp;</span><span class="nt">mutex</span><span class="o">,</span><span class="w"> </span><span class="nt">NULL</span><span class="o">);</span><span class="w">                </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                   </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">pthread_mutex_lock</span><span class="o">(&amp;</span><span class="nt">mutex</span><span class="o">);</span><span class="w">                      </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nt">Critical</span><span class="w"> </span><span class="nt">Section</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">pthread_mutex_unlock</span><span class="o">(&amp;</span><span class="nt">mutex</span><span class="o">);</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">Semaphore</span><span class="o">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Counter-based</span><span class="w"> </span><span class="nt">synchronization</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">Can</span><span class="w"> </span><span class="nt">allow</span><span class="w"> </span><span class="nt">N</span><span class="w"> </span><span class="nt">threads</span><span class="w"> </span><span class="nt">simultaneous</span><span class="w"> </span><span class="nt">access</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">No</span><span class="w"> </span><span class="nt">ownership</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">sem_t</span><span class="w"> </span><span class="nt">sem</span><span class="o">;</span><span class="w">                                       </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">sem_init</span><span class="o">(&amp;</span><span class="nt">sem</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">3</span><span class="o">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nt">Max</span><span class="w"> </span><span class="nt">3</span><span class="w"> </span><span class="nt">concurrent</span><span class="w"> </span><span class="nt">access</span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                   </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">sem_wait</span><span class="o">(&amp;</span><span class="nt">sem</span><span class="o">);</span><span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nt">Decrement</span><span class="w"> </span><span class="nt">counter</span><span class="o">,</span><span class="w"> </span><span class="nt">wait</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nt">0</span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nt">Critical</span><span class="w"> </span><span class="nt">Section</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nt">sem_post</span><span class="o">(&amp;</span><span class="nt">sem</span><span class="o">);</span><span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nt">Increment</span><span class="w"> </span><span class="nt">counter</span><span class="o">,</span><span class="w"> </span><span class="nt">wake</span><span class="w"> </span><span class="nt">waiters</span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="75-lock-free-algorithms">7.5 Lock-Free Algorithms<a class="header-link" href="#75-lock-free-algorithms" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">               </span><span class="n">Lock</span><span class="o">-</span><span class="n">Free</span><span class="w"> </span><span class="n">Counter</span><span class="w"> </span><span class="n">Example</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">increment</span><span class="p">(</span><span class="n">atomic_int</span><span class="w"> </span><span class="o">*</span><span class="n">counter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">old</span><span class="p">,</span><span class="w"> </span><span class="n">new</span><span class="p">;</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">do</span><span class="w"> </span><span class="p">{</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="n">old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atomic_load</span><span class="p">(</span><span class="n">counter</span><span class="p">);</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">          </span><span class="n">new</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">atomic_compare_exchange</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">old</span><span class="p">,</span><span class="w"> </span><span class="n">new</span><span class="p">));</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">}</span><span class="w">                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Operation</span><span class="p">:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">Read</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">value</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">Calculate</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">value</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">Attempt</span><span class="w"> </span><span class="n">atomic</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">CAS</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">Retry</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="p">(</span><span class="n">another</span><span class="w"> </span><span class="n">thread</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="n">it</span><span class="p">)</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Advantages</span><span class="p">:</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="n">waiting</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Deadlock</span><span class="w"> </span><span class="n">impossible</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="n">inversion</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Disadvantages</span><span class="p">:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Complex</span><span class="w"> </span><span class="n">implementation</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">careful</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ABA</span><span class="w"> </span><span class="n">problem</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="8-gpu-and-parallel-computing">8. GPU and Parallel Computing<a class="header-link" href="#8-gpu-and-parallel-computing" title="Permanent link">&para;</a></h2>
<h3 id="81-gpu-architecture">8.1 GPU Architecture<a class="header-link" href="#81-gpu-architecture" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nx">GPU</span><span class="w"> </span><span class="nx">vs</span><span class="w"> </span><span class="nx">CPU</span><span class="w"> </span><span class="nx">Architecture</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">CPU</span><span class="w"> </span><span class="p">(</span><span class="nx">Latency</span><span class="w"> </span><span class="nx">Optimized</span><span class="p">):</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="nx">Large</span><span class="w"> </span><span class="nx">Cache</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w"> </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="nx">Complex</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="nx">Complex</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="nx">Core</span><span class="w"> </span><span class="mi">0</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="nx">Core</span><span class="w"> </span><span class="mi">1</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="mi">16</span><span class="w"> </span><span class="nx">cores</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="nx">OoO</span><span class="p">,</span><span class="w"> </span><span class="nx">BP</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="nx">OoO</span><span class="p">,</span><span class="w"> </span><span class="nx">BP</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Features</span><span class="p">:</span><span class="w"> </span><span class="nx">Complex</span><span class="w"> </span><span class="nx">cores</span><span class="p">,</span><span class="w"> </span><span class="nx">large</span><span class="w"> </span><span class="nx">cache</span><span class="p">,</span><span class="w"> </span><span class="nx">low</span><span class="w"> </span><span class="nx">latency</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">GPU</span><span class="w"> </span><span class="p">(</span><span class="nx">Throughput</span><span class="w"> </span><span class="nx">Optimized</span><span class="p">):</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">S</span><span class="w"> </span><span class="err">â”‚â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">M</span><span class="w"> </span><span class="err">â”‚â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="p">(</span><span class="nx">Thousands</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">cores</span><span class="o">/</span><span class="nx">CUDA</span><span class="w"> </span><span class="nx">Cores</span><span class="p">)</span><span class="w">          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="nx">Small</span><span class="w"> </span><span class="nx">Cache</span><span class="w"> </span><span class="nx">per</span><span class="w"> </span><span class="nx">SM</span><span class="w">                </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Features</span><span class="p">:</span><span class="w"> </span><span class="nx">Thousands</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">cores</span><span class="p">,</span><span class="w"> </span><span class="nx">small</span><span class="w"> </span><span class="nx">cache</span><span class="p">,</span><span class="w"> </span><span class="nx">high</span><span class="w"> </span><span class="nx">throughput</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">SM</span><span class="w"> </span><span class="p">(</span><span class="nx">Streaming</span><span class="w"> </span><span class="nx">Multiprocessor</span><span class="p">)</span><span class="w"> </span><span class="nx">structure</span><span class="p">:</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">32</span><span class="w"> </span><span class="nx">CUDA</span><span class="w"> </span><span class="nx">Cores</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nx">Warp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="nx">threads</span><span class="p">)</span><span class="w">        </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">Each</span><span class="w"> </span><span class="nx">core</span><span class="w"> </span><span class="nx">executes</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">instruction</span><span class="w"> </span><span class="p">(</span><span class="nx">SIMT</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">Shared</span><span class="w"> </span><span class="nx">Memory</span><span class="w"> </span><span class="p">(</span><span class="mi">48</span><span class="nx">KB</span><span class="p">)</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">Register</span><span class="w"> </span><span class="nx">File</span><span class="w"> </span><span class="p">(</span><span class="mi">65536</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="mi">32</span><span class="nx">bit</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="nx">Warp</span><span class="w"> </span><span class="nx">Scheduler</span><span class="w">                                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="82-cuda-programming-model">8.2 CUDA Programming Model<a class="header-link" href="#82-cuda-programming-model" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CUDA Execution Model                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Hierarchy:                                                 â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      Grid                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Block   â”‚ â”‚ Block   â”‚ â”‚ Block   â”‚ â”‚ Block   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ (0,0)   â”‚ â”‚ (1,0)   â”‚ â”‚ (2,0)   â”‚ â”‚ (3,0)   â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Block   â”‚ â”‚ Block   â”‚ â”‚ Block   â”‚ â”‚ Block   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ (0,1)   â”‚ â”‚ (1,1)   â”‚ â”‚ (2,1)   â”‚ â”‚ (3,1)   â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  Inside Block:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”â”‚   â”‚
â”‚  â”‚  â”‚ T0  â”‚ T1  â”‚ T2  â”‚ T3  â”‚ T4  â”‚ T5  â”‚ ... â”‚T255 â”‚â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  256 Threads sharing Shared Memory                  â”‚   â”‚
â”‚  â”‚  Synchronization: __syncthreads()                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  Memory hierarchy:                                          â”‚
â”‚  - Global Memory: All threads access, slow (~500 cycles)   â”‚
â”‚  - Shared Memory: Shared within block, fast (~5 cycles)    â”‚
â”‚  - Register: Thread-private, fastest                       â”‚
â”‚  - Constant Memory: Read-only, cached                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="83-cuda-code-example">8.3 CUDA Code Example<a class="header-link" href="#83-cuda-code-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Vector addition CUDA kernel</span>

<span class="kr">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">vectorAdd</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Calculate global thread index</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">blockDim</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">C</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000000</span><span class="p">;</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Allocate host memory</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">h_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">h_B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">h_C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Allocate device memory</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">d_A</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">d_B</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">d_C</span><span class="p">;</span>
<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_A</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_B</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_C</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Copy data (Host â†’ Device)</span>
<span class="w">    </span><span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">d_A</span><span class="p">,</span><span class="w"> </span><span class="n">h_A</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">cudaMemcpyHostToDevice</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">d_B</span><span class="p">,</span><span class="w"> </span><span class="n">h_B</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">cudaMemcpyHostToDevice</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Kernel execution configuration</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">threadsPerBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">blocksPerGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">threadsPerBlock</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">threadsPerBlock</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Execute kernel</span>
<span class="w">    </span><span class="n">vectorAdd</span><span class="o">&lt;&lt;&lt;</span><span class="n">blocksPerGrid</span><span class="p">,</span><span class="w"> </span><span class="n">threadsPerBlock</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">d_A</span><span class="p">,</span><span class="w"> </span><span class="n">d_B</span><span class="p">,</span><span class="w"> </span><span class="n">d_C</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Copy result (Device â†’ Host)</span>
<span class="w">    </span><span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">h_C</span><span class="p">,</span><span class="w"> </span><span class="n">d_C</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">cudaMemcpyDeviceToHost</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Free memory</span>
<span class="w">    </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_A</span><span class="p">);</span><span class="w"> </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_B</span><span class="p">);</span><span class="w"> </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_C</span><span class="p">);</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">h_A</span><span class="p">);</span><span class="w"> </span><span class="n">free</span><span class="p">(</span><span class="n">h_B</span><span class="p">);</span><span class="w"> </span><span class="n">free</span><span class="p">(</span><span class="n">h_C</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="84-gpu-vs-cpu-use-cases">8.4 GPU vs CPU Use Cases<a class="header-link" href="#84-gpu-vs-cpu-use-cases" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                GPU vs CPU Suitable Tasks                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  GPU suitable (Data parallel):                             â”‚
â”‚  - Matrix operations                                       â”‚
â”‚  - Image/video processing                                  â”‚
â”‚  - Deep learning training/inference                        â”‚
â”‚  - Physics simulation                                      â”‚
â”‚  - Cryptocurrency mining                                   â”‚
â”‚  - Scientific computing (CFD, molecular dynamics)          â”‚
â”‚                                                             â”‚
â”‚  CPU suitable (Task parallel, complex control flow):       â”‚
â”‚  - Operating systems                                       â”‚
â”‚  - Databases                                               â”‚
â”‚  - Web servers                                             â”‚
â”‚  - Compilers                                               â”‚
â”‚  - General applications                                    â”‚
â”‚                                                             â”‚
â”‚  Performance comparison (approximate):                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Task               â”‚  CPU     â”‚  GPU      â”‚ Ratio  â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ Matrix mult (4KÃ—4K)â”‚  10s     â”‚  0.1s    â”‚ 100x  â”‚    â”‚
â”‚  â”‚ Image filter       â”‚  2s      â”‚  0.05s   â”‚ 40x   â”‚    â”‚
â”‚  â”‚ Neural net trainingâ”‚  100s    â”‚  2s      â”‚ 50x   â”‚    â”‚
â”‚  â”‚ Sorting algorithm  â”‚  5s      â”‚  4s      â”‚ 1.25x â”‚    â”‚
â”‚  â”‚ Branch-heavy code  â”‚  1s      â”‚  10s     â”‚ 0.1x  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="9-practice-problems">9. Practice Problems<a class="header-link" href="#9-practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="basic-problems">Basic Problems<a class="header-link" href="#basic-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Explain the four classifications of Flynn's Taxonomy.</p>
</li>
<li>
<p>What is the difference between SMP and NUMA?</p>
</li>
<li>
<p>Explain the four states of the MESI protocol.</p>
</li>
</ol>
<h3 id="intermediate-problems">Intermediate Problems<a class="header-link" href="#intermediate-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>When 80% of a program is parallelizable, what is the maximum performance improvement on an 8-core system according to Amdahl's Law?</p>
</li>
<li>
<p>Explain the Race Condition that can occur in the following code and provide a solution:
   <code>c
   int counter = 0;
   void increment() {
       counter++;
   }</code></p>
</li>
<li>
<p>Explain the difference between Test-and-Set and Compare-and-Swap.</p>
</li>
</ol>
<h3 id="advanced-problems">Advanced Problems<a class="header-link" href="#advanced-problems" title="Permanent link">&para;</a></h3>
<ol>
<li>Track the state transitions in the MESI protocol for the following scenario:</li>
<li>Core 0 reads X (from memory)</li>
<li>Core 1 reads X</li>
<li>Core 0 writes X</li>
<li>
<p>Core 1 reads X</p>
</li>
<li>
<p>Explain why GPUs are faster than CPUs for matrix multiplication.</p>
</li>
<li>
<p>Explain the advantages and disadvantages of Lock-Free algorithms and the ABA problem.</p>
</li>
</ol>
<details>
<summary>Answers</summary>

1. Flynn's Taxonomy:
   - SISD: Single Instruction Single Data (traditional CPU)
   - SIMD: Single Instruction Multiple Data (vector operations, GPU)
   - MISD: Multiple Instruction Single Data (rarely used)
   - MIMD: Multiple Instruction Multiple Data (multicore)

2. SMP vs NUMA:
   - SMP: All CPUs have uniform memory access (UMA)
   - NUMA: Local memory access faster than remote, better scalability

3. MESI states:
   - Modified: Modified, sole copy
   - Exclusive: Not modified, sole copy
   - Shared: Not modified, multiple copies possible
   - Invalid: Invalid

4. Amdahl's Law calculation:
   Speedup = 1 / (0.2 + 0.8/8) = 1 / (0.2 + 0.1) = 1/0.3 = 3.33x

5. Race Condition solution:
   - Problem: counter++ is not atomic (read-modify-write)
   - Solution: Use mutex, or use atomic operation (atomic_fetch_add)

6. TAS vs CAS:
   - TAS: Always sets to 1, returns previous value
   - CAS: Sets to new value only if matches expected value

7. MESI state transitions:
   - Core 0 read: Core0=E, Core1=I
   - Core 1 read: Core0=S, Core1=S
   - Core 0 write: Core0=M, Core1=I (invalidated)
   - Core 1 read: Core0=S, Core1=S (Core0 provides data)

8. Why GPUs are faster for matrix multiplication:
   - High data parallelism (each element computed independently)
   - Thousands of cores executing simultaneously
   - High memory bandwidth
   - Matrix multiplication optimized for GPU architecture

9. Lock-Free algorithms:
   - Advantages: No lock waiting, deadlock impossible
   - Disadvantages: Complex implementation, difficult debugging
   - ABA problem: Value changes Aâ†’Bâ†’A, CAS still succeeds
   - Solution: Use tag/version counter, Hazard Pointers

</details>

<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Computer Architecture: A Quantitative Approach (Hennessy &amp; Patterson)</li>
<li>The Art of Multiprocessor Programming (Herlihy &amp; Shavit)</li>
<li><a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/">NVIDIA CUDA Programming Guide</a></li>
<li><a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel Optimization Manual</a></li>
<li><a href="https://research.swtch.com/hwmm">Memory Consistency Models</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Architecture/17_IO_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">I/O Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}