{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Filtering - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Computer_Vision/">Computer Vision</a>
    <span class="separator">/</span>
    <span class="current">Image Filtering</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Image Filtering</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Vision/04_Geometric_Transforms.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Geometric Transformations</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Vision/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Computer_Vision/06_Morphology.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Morphological Operations</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-kernels-and-convolution">1. Kernels and Convolution</a><ul>
<li><a href="#what-is-a-kernel">What is a Kernel?</a></li>
<li><a href="#convolution-operation">Convolution Operation</a></li>
<li><a href="#convolution-visualization">Convolution Visualization</a></li>
</ul>
</li>
<li><a href="#2-average-blur-blur">2. Average Blur - blur()</a><ul>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#average-blur-kernel">Average Blur Kernel</a></li>
<li><a href="#boxfilter">boxFilter()</a></li>
</ul>
</li>
<li><a href="#3-gaussian-blur-gaussianblur">3. Gaussian Blur - GaussianBlur()</a><ul>
<li><a href="#what-is-gaussian-filter">What is Gaussian Filter?</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#relationship-between-sigma-and-kernel-size">Relationship Between Sigma and Kernel Size</a></li>
<li><a href="#average-blur-vs-gaussian-blur">Average Blur vs Gaussian Blur</a></li>
</ul>
</li>
<li><a href="#4-median-blur-medianblur">4. Median Blur - medianBlur()</a><ul>
<li><a href="#what-is-median-filter">What is Median Filter?</a></li>
<li><a href="#usage_1">Usage</a></li>
</ul>
</li>
<li><a href="#5-bilateral-filter-bilateralfilter">5. Bilateral Filter - bilateralFilter()</a><ul>
<li><a href="#what-is-bilateral-filter">What is Bilateral Filter?</a></li>
<li><a href="#usage_2">Usage</a></li>
<li><a href="#skin-smoothing-example">Skin Smoothing Example</a></li>
<li><a href="#blur-filter-comparison">Blur Filter Comparison</a></li>
</ul>
</li>
<li><a href="#6-custom-filter-filter2d">6. Custom Filter - filter2D()</a><ul>
<li><a href="#filter2d-usage">filter2D() Usage</a></li>
<li><a href="#various-custom-kernels">Various Custom Kernels</a></li>
<li><a href="#kernel-visualization-tool">Kernel Visualization Tool</a></li>
</ul>
</li>
<li><a href="#7-sharpening-filter">7. Sharpening Filter</a><ul>
<li><a href="#sharpening-principle">Sharpening Principle</a></li>
<li><a href="#sharpening-implementation">Sharpening Implementation</a></li>
<li><a href="#adaptive-sharpening">Adaptive Sharpening</a></li>
</ul>
</li>
<li><a href="#8-practice-problems">8. Practice Problems</a><ul>
<li><a href="#exercise-1-noise-removal-comparison">Exercise 1: Noise Removal Comparison</a></li>
<li><a href="#exercise-2-real-time-blur-intensity-control">Exercise 2: Real-Time Blur Intensity Control</a></li>
<li><a href="#exercise-3-custom-emboss-directions">Exercise 3: Custom Emboss Directions</a></li>
<li><a href="#exercise-4-advanced-sharpening">Exercise 4: Advanced Sharpening</a></li>
<li><a href="#exercise-5-miniature-effect-tilt-shift">Exercise 5: Miniature Effect (Tilt Shift)</a></li>
</ul>
</li>
<li><a href="#9-next-steps">9. Next Steps</a></li>
<li><a href="#10-references">10. References</a><ul>
<li><a href="#official-documentation">Official Documentation</a></li>
<li><a href="#related-learning-materials">Related Learning Materials</a></li>
<li><a href="#additional-references">Additional References</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="image-filtering">Image Filtering<a class="header-link" href="#image-filtering" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>Image filtering is the process of transforming pixel values by considering neighboring pixels. Various effects such as noise removal, blur, and sharpening can be achieved. In this document, we'll learn from the concepts of kernels and convolution to various filter functions in OpenCV.</p>
<p><strong>Difficulty</strong>: â­â­ (Beginner-Intermediate)</p>
<p><strong>Learning Objectives</strong>:
- Understand kernel and convolution concepts
- Learn various blur filters (<code>blur</code>, <code>GaussianBlur</code>, <code>medianBlur</code>, <code>bilateralFilter</code>)
- Edge-preserving smoothing
- Implement custom filters and sharpening</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-kernels-and-convolution">Kernels and Convolution</a></li>
<li><a href="#2-average-blur---blur">Average Blur - blur()</a></li>
<li><a href="#3-gaussian-blur---gaussianblur">Gaussian Blur - GaussianBlur()</a></li>
<li><a href="#4-median-blur---medianblur">Median Blur - medianBlur()</a></li>
<li><a href="#5-bilateral-filter---bilateralfilter">Bilateral Filter - bilateralFilter()</a></li>
<li><a href="#6-custom-filter---filter2d">Custom Filter - filter2D()</a></li>
<li><a href="#7-sharpening-filter">Sharpening Filter</a></li>
<li><a href="#8-practice-problems">Practice Problems</a></li>
<li><a href="#9-next-steps">Next Steps</a></li>
<li><a href="#10-references">References</a></li>
</ol>
<hr />
<h2 id="1-kernels-and-convolution">1. Kernels and Convolution<a class="header-link" href="#1-kernels-and-convolution" title="Permanent link">&para;</a></h2>
<h3 id="what-is-a-kernel">What is a Kernel?<a class="header-link" href="#what-is-a-kernel" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Kernel                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   A kernel (or filter, mask) is a small matrix that defines    â”‚
â”‚   the operation to apply to an image. Typically 3x3, 5x5, 7x7. â”‚
â”‚                                                                 â”‚
â”‚   Example: 3x3 average filter kernel                            â”‚
â”‚                                                                 â”‚
â”‚        1/9   1/9   1/9         â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”                   â”‚
â”‚                                â”‚1/9â”‚1/9â”‚1/9â”‚                   â”‚
â”‚        1/9   1/9   1/9    =    â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤                   â”‚
â”‚                                â”‚1/9â”‚1/9â”‚1/9â”‚                   â”‚
â”‚        1/9   1/9   1/9         â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤                   â”‚
â”‚                                â”‚1/9â”‚1/9â”‚1/9â”‚                   â”‚
â”‚                                â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â”‚   Kernel size meaning:                                          â”‚
â”‚   - Larger size considers wider area                            â”‚
â”‚   - Large kernel = strong effect, slow processing              â”‚
â”‚   - Small kernel = weak effect, fast processing                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="convolution-operation">Convolution Operation<a class="header-link" href="#convolution-operation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                      </span><span class="n">Convolution</span><span class="w"> </span><span class="n">Operation</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Apply</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">pixel</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">calculate</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">value</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Input</span><span class="w"> </span><span class="n">image</span><span class="w">          </span><span class="mi">3</span><span class="n">x3</span><span class="w"> </span><span class="n">kernel</span><span class="w">           </span><span class="n">Output</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</span><span class="w">      </span><span class="n">Result</span><span class="w"> </span><span class="n">pixel</span><span class="p">:</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="w">   </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">6</span><span class="o">+</span><span class="mi">7</span><span class="o">+</span><span class="mi">9</span><span class="o">+</span><span class="mi">10</span><span class="o">+</span><span class="mi">11</span><span class="p">)</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">54</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="mi">10</span><span class="w"> </span><span class="err">â”‚</span><span class="mi">11</span><span class="w"> </span><span class="err">â”‚</span><span class="mi">12</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="err">â”‚</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="mi">13</span><span class="w"> </span><span class="err">â”‚</span><span class="mi">14</span><span class="w"> </span><span class="err">â”‚</span><span class="mi">15</span><span class="w"> </span><span class="err">â”‚</span><span class="mi">16</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Process</span><span class="p">:</span><span class="w">                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mf">1.</span><span class="w"> </span><span class="n">Place</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">image</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mf">2.</span><span class="w"> </span><span class="n">Multiply</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">pixels</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mf">3.</span><span class="w"> </span><span class="n">Sum</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">results</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mf">4.</span><span class="w"> </span><span class="n">Move</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">pixel</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">repeat</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Border</span><span class="w"> </span><span class="n">handling</span><span class="p">:</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">BORDER_CONSTANT</span><span class="p">:</span><span class="w"> </span><span class="n">Fill</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">constant</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">(</span><span class="n">default</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">BORDER_REPLICATE</span><span class="p">:</span><span class="w"> </span><span class="n">Replicate</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="n">pixels</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">BORDER_REFLECT</span><span class="p">:</span><span class="w"> </span><span class="n">Reflect</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">border</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="convolution-visualization">Convolution Visualization<a class="header-link" href="#convolution-visualization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">visualize_convolution</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kernel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize convolution process (for learning)&quot;&quot;&quot;</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">kh</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">kh</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="c1"># Add padding</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Result array</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># Convolution (slow version - for learning)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="n">padded</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="n">kw</span><span class="p">]</span>
            <span class="n">result</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">region</span> <span class="o">*</span> <span class="n">kernel</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>


<span class="c1"># Example</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="mi">9</span>  <span class="c1"># Average filter</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">visualize_convolution</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Result:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="2-average-blur-blur">2. Average Blur - blur()<a class="header-link" href="#2-average-blur-blur" title="Permanent link">&para;</a></h2>
<h3 id="basic-usage">Basic Usage<a class="header-link" href="#basic-usage" title="Permanent link">&para;</a></h3>
<p>Average blur is the simplest blur filter, using the average value of the kernel area.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># blur(src, ksize)</span>
<span class="c1"># ksize: kernel size in (width, height) format</span>

<span class="n">blur_3x3</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">blur_5x5</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">blur_7x7</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">blur_15x15</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;3x3 Blur&#39;</span><span class="p">,</span> <span class="n">blur_3x3</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;5x5 Blur&#39;</span><span class="p">,</span> <span class="n">blur_5x5</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;15x15 Blur&#39;</span><span class="p">,</span> <span class="n">blur_15x15</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
</code></pre></div>

<h3 id="average-blur-kernel">Average Blur Kernel<a class="header-link" href="#average-blur-kernel" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                      </span><span class="nx">Average</span><span class="w"> </span><span class="nx">Blur</span><span class="w"> </span><span class="nx">Kernel</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">3</span><span class="nx">x3</span><span class="w"> </span><span class="nx">average</span><span class="w"> </span><span class="nx">kernel</span><span class="p">:</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="p">=</span><span class="w">  </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤</span><span class="w">           </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="w"> </span><span class="err">â”‚</span><span class="w">           </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="mi">5</span><span class="nx">x5</span><span class="w"> </span><span class="nx">average</span><span class="w"> </span><span class="nx">kernel</span><span class="p">:</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="nx">All</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">25</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="nx">Features</span><span class="p">:</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Simple</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">fast</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Edges</span><span class="w"> </span><span class="nx">also</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">blurred</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Effective</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">uniform</span><span class="w"> </span><span class="nx">noise</span><span class="w"> </span><span class="nx">removal</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="boxfilter">boxFilter()<a class="header-link" href="#boxfilter" title="Permanent link">&para;</a></h3>
<p>A generalized version of <code>blur()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># normalize=True (default): Normalize kernel (average filter)</span>
<span class="c1"># normalize=False: Sum filter</span>
<span class="n">blur_normalized</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boxFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sum_filter</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boxFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Same as blur(img, (5, 5))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">blur_normalized</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0</span>
</code></pre></div>

<hr />
<h2 id="3-gaussian-blur-gaussianblur">3. Gaussian Blur - GaussianBlur()<a class="header-link" href="#3-gaussian-blur-gaussianblur" title="Permanent link">&para;</a></h2>
<h3 id="what-is-gaussian-filter">What is Gaussian Filter?<a class="header-link" href="#what-is-gaussian-filter" title="Permanent link">&para;</a></h3>
<p>Gaussian filter is a blur filter that gives more weight to the center. It produces a natural blur effect.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                      </span><span class="nv">Gaussian</span><span class="w"> </span><span class="nv">Kernel</span><span class="w">                            </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">   </span><span class="nv">Gaussian</span><span class="w"> </span><span class="nv">distribution</span><span class="w"> </span><span class="ss">(</span><span class="nv">normal</span><span class="w"> </span><span class="nv">distribution</span>,<span class="w"> </span><span class="nv">bell</span><span class="w"> </span><span class="nv">shape</span><span class="ss">)</span>:<span class="w">      </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">          </span>â–²<span class="w">                                                      </span>â”‚
â”‚<span class="w">          </span>â”‚<span class="w">     </span>â–ˆâ–ˆâ–ˆâ–ˆ<span class="w">                                             </span>â”‚
â”‚<span class="w">          </span>â”‚<span class="w">   </span>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ<span class="w">                                           </span>â”‚
â”‚<span class="w">          </span>â”‚<span class="w">  </span>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ<span class="w">                                          </span>â”‚
â”‚<span class="w">          </span>â”‚<span class="w"> </span>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ<span class="w">                                         </span>â”‚
â”‚<span class="w">          </span>â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ<span class="w">                                        </span>â”‚
â”‚<span class="w">          </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶<span class="w">                                   </span>â”‚
â”‚<span class="w">                   </span><span class="nv">Weight</span><span class="w"> </span><span class="nv">decreases</span><span class="w"> </span><span class="nv">away</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">center</span><span class="w">             </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">   </span><span class="mi">3</span><span class="nv">x3</span><span class="w"> </span><span class="nv">Gaussian</span><span class="w"> </span><span class="nv">kernel</span><span class="w"> </span><span class="ss">(</span><span class="nv">approximate</span><span class="ss">)</span>:<span class="w">                            </span>â”‚
â”‚<span class="w">   </span>â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”<span class="w">                                          </span>â”‚
â”‚<span class="w">   </span>â”‚<span class="w"> </span><span class="mi">1</span><span class="w">   </span>â”‚<span class="w"> </span><span class="mi">2</span><span class="w">   </span>â”‚<span class="w"> </span><span class="mi">1</span><span class="w">   </span>â”‚<span class="w">                                          </span>â”‚
â”‚<span class="w">   </span>â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤<span class="w">  </span>Ã—<span class="w">  </span><span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="w">                                 </span>â”‚
â”‚<span class="w">   </span>â”‚<span class="w"> </span><span class="mi">2</span><span class="w">   </span>â”‚<span class="w"> </span><span class="mi">4</span><span class="w">   </span>â”‚<span class="w"> </span><span class="mi">2</span><span class="w">   </span>â”‚<span class="w">                                          </span>â”‚
â”‚<span class="w">   </span>â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤<span class="w">                                          </span>â”‚
â”‚<span class="w">   </span>â”‚<span class="w"> </span><span class="mi">1</span><span class="w">   </span>â”‚<span class="w"> </span><span class="mi">2</span><span class="w">   </span>â”‚<span class="w"> </span><span class="mi">1</span><span class="w">   </span>â”‚<span class="w">                                          </span>â”‚
â”‚<span class="w">   </span>â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜<span class="w">                                          </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">   </span><span class="nv">Features</span>:<span class="w">                                                     </span>â”‚
â”‚<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nv">More</span><span class="w"> </span><span class="nv">natural</span><span class="w"> </span><span class="nb">result</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="nv">average</span><span class="w"> </span><span class="nv">blur</span><span class="w">                       </span>â”‚
â”‚<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nv">Often</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">edge</span><span class="w"> </span><span class="nv">detection</span><span class="w"> </span><span class="nv">preprocessing</span><span class="w">                </span>â”‚
â”‚<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nv">Control</span><span class="w"> </span><span class="nv">blur</span><span class="w"> </span><span class="nv">strength</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">sigma</span><span class="w"> </span><span class="ss">(</span>Ïƒ<span class="ss">)</span><span class="w"> </span><span class="nv">value</span><span class="w">                 </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="usage">Usage<a class="header-link" href="#usage" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># GaussianBlur(src, ksize, sigmaX, sigmaY=0)</span>
<span class="c1"># ksize: Kernel size (must be odd)</span>
<span class="c1"># sigmaX: Standard deviation in X direction (0 = auto-calculate from kernel size)</span>
<span class="c1"># sigmaY: Standard deviation in Y direction (0 = same as sigmaX)</span>

<span class="c1"># Specify kernel size (sigma auto-calculated)</span>
<span class="n">blur1</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Specify sigma (kernel size auto-adjusted appropriately)</span>
<span class="n">blur2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># sigma=3</span>

<span class="c1"># Specify both kernel size and sigma</span>
<span class="n">blur3</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">)</span>
</code></pre></div>

<h3 id="relationship-between-sigma-and-kernel-size">Relationship Between Sigma and Kernel Size<a class="header-link" href="#relationship-between-sigma-and-kernel-size" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Generate Gaussian kernel directly to check</span>
<span class="k">def</span><span class="w"> </span><span class="nf">show_gaussian_kernel</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getGaussianKernel</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">kernel_2d</span> <span class="o">=</span> <span class="n">kernel</span> <span class="o">@</span> <span class="n">kernel</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># 1D to 2D</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kernel (</span><span class="si">{</span><span class="n">ksize</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">ksize</span><span class="si">}</span><span class="s2">, sigma=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">kernel_2d</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">kernel_2d</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">show_gaussian_kernel</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># sigma auto-calculated</span>
<span class="n">show_gaussian_kernel</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">show_gaussian_kernel</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">show_gaussian_kernel</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># Recommended: sigma = 0.3 * ((ksize - 1) * 0.5 - 1) + 0.8</span>
</code></pre></div>

<h3 id="average-blur-vs-gaussian-blur">Average Blur vs Gaussian Blur<a class="header-link" href="#average-blur-vs-gaussian-blur" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>

<span class="c1"># Compare with same kernel size</span>
<span class="n">ksize</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">avg_blur</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">ksize</span><span class="p">))</span>
<span class="n">gauss_blur</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">ksize</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">avg_blur</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Average Blur&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">gauss_blur</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gaussian Blur&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4-median-blur-medianblur">4. Median Blur - medianBlur()<a class="header-link" href="#4-median-blur-medianblur" title="Permanent link">&para;</a></h2>
<h3 id="what-is-median-filter">What is Median Filter?<a class="header-link" href="#what-is-median-filter" title="Permanent link">&para;</a></h3>
<p>Median filter uses the median value of the kernel area. Very effective for salt-and-pepper noise removal.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="n">Median</span><span class="w"> </span><span class="n">Filter</span><span class="w"> </span><span class="n">Operation</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Input</span><span class="w"> </span><span class="nl">region:</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">10</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">20</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">30</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">40</span><span class="w"> </span><span class="err">â”‚</span><span class="mh">255</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">60</span><span class="w"> </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â†</span><span class="w"> </span><span class="n">Center</span><span class="w"> </span><span class="mh">255</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">noise</span><span class="w"> </span><span class="p">(</span><span class="n">salt</span><span class="p">)</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">70</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">80</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">90</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Sort</span><span class="w"> </span><span class="nl">values:</span><span class="w"> </span><span class="mh">10</span><span class="p">,</span><span class="w"> </span><span class="mh">20</span><span class="p">,</span><span class="w"> </span><span class="mh">30</span><span class="p">,</span><span class="w"> </span><span class="mh">40</span><span class="p">,</span><span class="w"> </span><span class="mh">60</span><span class="p">,</span><span class="w"> </span><span class="mh">70</span><span class="p">,</span><span class="w"> </span><span class="mh">80</span><span class="p">,</span><span class="w"> </span><span class="mh">90</span><span class="p">,</span><span class="w"> </span><span class="mh">255</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="nl">Median:</span><span class="w"> </span><span class="mh">60</span><span class="w"> </span><span class="p">(</span><span class="mh">5</span><span class="n">th</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="nl">Result:</span><span class="w">                                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mh">60</span><span class="w"> </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â†</span><span class="w"> </span><span class="n">Noise</span><span class="w"> </span><span class="n">removed</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="nl">Features:</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Very</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">salt</span><span class="o">-</span><span class="k">and</span><span class="o">-</span><span class="n">pepper</span><span class="w"> </span><span class="n">noise</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Preserves</span><span class="w"> </span><span class="n">edges</span><span class="w"> </span><span class="n">relatively</span><span class="w"> </span><span class="n">well</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Slower</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">average</span><span class="o">/</span><span class="n">Gaussian</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="usage_1">Usage<a class="header-link" href="#usage_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># Add salt-and-pepper noise (for testing)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_salt_pepper_noise</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="n">noisy</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">num_pixels</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amount</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span>

    <span class="c1"># Salt (white)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pixels</span><span class="p">):</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
        <span class="n">noisy</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>

    <span class="c1"># Pepper (black)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pixels</span><span class="p">):</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
        <span class="n">noisy</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">noisy</span>


<span class="n">noisy_img</span> <span class="o">=</span> <span class="n">add_salt_pepper_noise</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>

<span class="c1"># medianBlur(src, ksize)</span>
<span class="c1"># ksize: Only odd numbers allowed (3, 5, 7, ...)</span>
<span class="n">median_3</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">noisy_img</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">median_5</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">noisy_img</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Compare: average blur, Gaussian blur</span>
<span class="n">avg_blur</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">noisy_img</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">gauss_blur</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">noisy_img</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Noisy&#39;</span><span class="p">,</span> <span class="n">noisy_img</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Average Blur&#39;</span><span class="p">,</span> <span class="n">avg_blur</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Gaussian Blur&#39;</span><span class="p">,</span> <span class="n">gauss_blur</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Median Blur&#39;</span><span class="p">,</span> <span class="n">median_5</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="5-bilateral-filter-bilateralfilter">5. Bilateral Filter - bilateralFilter()<a class="header-link" href="#5-bilateral-filter-bilateralfilter" title="Permanent link">&para;</a></h2>
<h3 id="what-is-bilateral-filter">What is Bilateral Filter?<a class="header-link" href="#what-is-bilateral-filter" title="Permanent link">&para;</a></h3>
<p>Bilateral filter smooths while preserving edges. Used for skin retouching, artistic effects, etc.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Bilateral Filter Principle                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Regular Gaussian filter:                                      â”‚
â”‚   - Only considers distance â†’ edges also blurred                â”‚
â”‚                                                                 â”‚
â”‚   Bilateral filter:                                             â”‚
â”‚   - Considers both distance (spatial) + color difference        â”‚
â”‚   - Only includes similar-colored pixels in average             â”‚
â”‚   - Preserves edges (where color difference is large)           â”‚
â”‚                                                                 â”‚
â”‚   Example:                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ 100  100  100 â”‚ 200  200  200 â”‚          â”‚                   â”‚
â”‚   â”‚ 100  100  100 â”‚ 200  200  200 â”‚  â† Edge  â”‚                   â”‚
â”‚   â”‚ 100  100  100 â”‚ 200  200  200 â”‚          â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â”‚   Gaussian: 100 and 200 mix to around 150                       â”‚
â”‚   Bilateral: 100 area stays 100, 200 area stays 200             â”‚
â”‚                                                                 â”‚
â”‚   Weight = spatial Gaussian Ã— color Gaussian                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="usage_2">Usage<a class="header-link" href="#usage_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;portrait.jpg&#39;</span><span class="p">)</span>

<span class="c1"># bilateralFilter(src, d, sigmaColor, sigmaSpace)</span>
<span class="c1"># d: Filter size (-1 = auto-calculate from sigmaSpace)</span>
<span class="c1"># sigmaColor: Sigma in color space (higher = average wider color range)</span>
<span class="c1"># sigmaSpace: Sigma in coordinate space (higher = consider wider area)</span>

<span class="c1"># Weak effect</span>
<span class="n">bilateral_weak</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bilateralFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Medium effect</span>
<span class="n">bilateral_medium</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bilateralFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>

<span class="c1"># Strong effect (painting-like)</span>
<span class="n">bilateral_strong</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bilateralFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Very strong effect</span>
<span class="n">bilateral_extreme</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bilateralFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
</code></pre></div>

<h3 id="skin-smoothing-example">Skin Smoothing Example<a class="header-link" href="#skin-smoothing-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">skin_smoothing</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Skin smoothing effect&quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;weak&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span>
        <span class="s1">&#39;strong&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s1">&#39;extreme&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">d</span><span class="p">,</span> <span class="n">sigmaColor</span><span class="p">,</span> <span class="n">sigmaSpace</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strength</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;medium&#39;</span><span class="p">])</span>

    <span class="c1"># Apply bilateral filter</span>
    <span class="n">smooth</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bilateralFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">sigmaColor</span><span class="p">,</span> <span class="n">sigmaSpace</span><span class="p">)</span>

    <span class="c1"># Blend with original (natural effect)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># Blending ratio</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>


<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;portrait.jpg&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">skin_smoothing</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">)</span>

<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;Smoothed&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
</code></pre></div>

<h3 id="blur-filter-comparison">Blur Filter Comparison<a class="header-link" href="#blur-filter-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># Compare processing time</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">avg</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">gauss</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="n">gauss</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">median</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;Median&#39;</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">bilateral</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bilateralFilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;Bilateral&#39;</span><span class="p">,</span> <span class="n">bilateral</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>

<span class="c1"># Visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">elapsed</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">ms)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6-custom-filter-filter2d">6. Custom Filter - filter2D()<a class="header-link" href="#6-custom-filter-filter2d" title="Permanent link">&para;</a></h2>
<h3 id="filter2d-usage">filter2D() Usage<a class="header-link" href="#filter2d-usage" title="Permanent link">&para;</a></h3>
<p><code>filter2D()</code> allows performing convolution with custom-defined kernels.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># filter2D(src, ddepth, kernel)</span>
<span class="c1"># ddepth: Output image depth (-1 = same as input)</span>
<span class="c1"># kernel: User-defined kernel</span>

<span class="c1"># Create and apply average filter manually</span>
<span class="n">kernel_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">/</span> <span class="mi">25</span>
<span class="n">avg_custom</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_avg</span><span class="p">)</span>

<span class="c1"># Same result as blur()</span>
<span class="n">avg_builtin</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">avg_custom</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">avg_builtin</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0</span>
</code></pre></div>

<h3 id="various-custom-kernels">Various Custom Kernels<a class="header-link" href="#various-custom-kernels" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># 1. Emboss effect</span>
<span class="n">kernel_emboss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">emboss</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_emboss</span><span class="p">)</span> <span class="o">+</span> <span class="mi">128</span>

<span class="c1"># 2. Edge detection (Laplacian)</span>
<span class="n">kernel_laplacian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">laplacian</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_laplacian</span><span class="p">)</span>

<span class="c1"># 3. Sobel X (vertical edges)</span>
<span class="n">kernel_sobel_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">sobel_x</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_sobel_x</span><span class="p">)</span>

<span class="c1"># 4. Sobel Y (horizontal edges)</span>
<span class="n">kernel_sobel_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">sobel_y</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_sobel_y</span><span class="p">)</span>
</code></pre></div>

<h3 id="kernel-visualization-tool">Kernel Visualization Tool<a class="header-link" href="#kernel-visualization-tool" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">apply_and_show_kernel</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize kernel application result and kernel&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Original</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="c1"># Kernel visualization</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Kernel (</span><span class="si">{</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">kernel</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Result</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># Example: Emboss kernel</span>
<span class="n">kernel_emboss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">apply_and_show_kernel</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kernel_emboss</span><span class="p">,</span> <span class="s1">&#39;Emboss&#39;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7-sharpening-filter">7. Sharpening Filter<a class="header-link" href="#7-sharpening-filter" title="Permanent link">&para;</a></h2>
<h3 id="sharpening-principle">Sharpening Principle<a class="header-link" href="#sharpening-principle" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Sharpening Principle                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Sharpening = Original + (Original - Blur)                     â”‚
â”‚              = Original + High-frequency component              â”‚
â”‚              = Edge enhancement                                 â”‚
â”‚                                                                 â”‚
â”‚   Or directly with kernel:                                      â”‚
â”‚                                                                 â”‚
â”‚   Basic sharpening kernel:                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                                             â”‚
â”‚   â”‚  0 â”‚ -1 â”‚  0 â”‚                                             â”‚
â”‚   â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                             â”‚
â”‚   â”‚ -1 â”‚  5 â”‚ -1 â”‚   Center = 5 (original weight)              â”‚
â”‚   â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤   Surrounding = -1 (subtract blur)          â”‚
â”‚   â”‚  0 â”‚ -1 â”‚  0 â”‚   Sum = 1 (preserve brightness)             â”‚
â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                 â”‚
â”‚   Strong sharpening kernel:                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                                             â”‚
â”‚   â”‚ -1 â”‚ -1 â”‚ -1 â”‚                                             â”‚
â”‚   â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                             â”‚
â”‚   â”‚ -1 â”‚  9 â”‚ -1 â”‚   Center = 9                                â”‚
â”‚   â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤   Surrounding = -1 Ã— 8 = -8                â”‚
â”‚   â”‚ -1 â”‚ -1 â”‚ -1 â”‚   Sum = 1                                   â”‚
â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="sharpening-implementation">Sharpening Implementation<a class="header-link" href="#sharpening-implementation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>

<span class="c1"># Method 1: Using kernel</span>
<span class="n">kernel_sharpen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">sharpened1</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_sharpen</span><span class="p">)</span>

<span class="c1"># Method 2: Strong sharpening kernel</span>
<span class="n">kernel_sharpen_strong</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">sharpened2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_sharpen_strong</span><span class="p">)</span>

<span class="c1"># Method 3: Unsharp Masking</span>
<span class="k">def</span><span class="w"> </span><span class="nf">unsharp_mask</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sharpening with unsharp masking</span>

<span class="sd">    amount: Sharpening strength (1.0 = standard)</span>
<span class="sd">    threshold: Edge detection threshold (noise prevention)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Blurred image</span>
    <span class="n">blurred</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

    <span class="c1"># Original - Blur = Edges/Details</span>
    <span class="c1"># sharpened = Original + amount Ã— (Original - Blur)</span>
    <span class="n">sharpened</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">amount</span><span class="p">,</span> <span class="n">blurred</span><span class="p">,</span> <span class="o">-</span><span class="n">amount</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">threshold</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Keep original for pixels with change below threshold</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">absdiff</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">blurred</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">diff</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
        <span class="n">sharpened</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="o">==</span> <span class="mi">255</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">sharpened</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sharpened</span>


<span class="n">sharpened3</span> <span class="o">=</span> <span class="n">unsharp_mask</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</code></pre></div>

<h3 id="adaptive-sharpening">Adaptive Sharpening<a class="header-link" href="#adaptive-sharpening" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">adaptive_sharpening</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adaptive sharpening - apply sharpening only to edge regions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Edge detection</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">Canny</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Blur</span>
    <span class="n">blurred</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Sharpening</span>
    <span class="n">sharpened</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">amount</span><span class="p">,</span> <span class="n">blurred</span><span class="p">,</span> <span class="o">-</span><span class="n">amount</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Apply sharpening only to edge regions</span>
    <span class="n">edges_3ch</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_GRAY2BGR</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">sharpened</span> <span class="o">*</span> <span class="n">edges_3ch</span> <span class="o">+</span> <span class="n">img</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">edges_3ch</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>


<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">adaptive_sharpening</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8-practice-problems">8. Practice Problems<a class="header-link" href="#8-practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-noise-removal-comparison">Exercise 1: Noise Removal Comparison<a class="header-link" href="#exercise-1-noise-removal-comparison" title="Permanent link">&para;</a></h3>
<p>Generate Gaussian noise and salt-and-pepper noise separately, and compare the removal effects with three blur filters (average, Gaussian, median). Perform quantitative comparison using PSNR values.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Hint: Add Gaussian noise</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_gaussian_noise</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">noisy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">img</span> <span class="o">+</span> <span class="n">noise</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">noisy</span>
</code></pre></div>

<h3 id="exercise-2-real-time-blur-intensity-control">Exercise 2: Real-Time Blur Intensity Control<a class="header-link" href="#exercise-2-real-time-blur-intensity-control" title="Permanent link">&para;</a></h3>
<p>Write a program that can adjust blur intensity (kernel size) with a trackbar on webcam video. Allow selection between Gaussian blur and bilateral filter.</p>
<h3 id="exercise-3-custom-emboss-directions">Exercise 3: Custom Emboss Directions<a class="header-link" href="#exercise-3-custom-emboss-directions" title="Permanent link">&para;</a></h3>
<p>Design and test kernels that produce different emboss effects in 8 directions (up, down, left, right, and 4 diagonals).</p>
<h3 id="exercise-4-advanced-sharpening">Exercise 4: Advanced Sharpening<a class="header-link" href="#exercise-4-advanced-sharpening" title="Permanent link">&para;</a></h3>
<p>Implement an advanced sharpening function with the following features:
1. Sharpening strength control (amount)
2. Blur radius control (radius)
3. Threshold application - ignore small changes
4. Separate handling for highlights/shadows</p>
<h3 id="exercise-5-miniature-effect-tilt-shift">Exercise 5: Miniature Effect (Tilt Shift)<a class="header-link" href="#exercise-5-miniature-effect-tilt-shift" title="Permanent link">&para;</a></h3>
<p>Implement tilt-shift miniature effect using Gaussian blur and masks. Keep the center of the image sharp, with progressively more blur at top and bottom.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Hint</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tilt_shift</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">focus_y</span><span class="p">,</span> <span class="n">focus_height</span><span class="p">,</span> <span class="n">blur_amount</span><span class="p">):</span>
    <span class="c1"># Create gradient mask</span>
    <span class="c1"># Blend blurred and original images using mask</span>
    <span class="k">pass</span>
</code></pre></div>

<hr />
<h2 id="9-next-steps">9. Next Steps<a class="header-link" href="#9-next-steps" title="Permanent link">&para;</a></h2>
<p>In <a href="./06_Morphology.md">06_Morphology.md</a>, you'll learn morphological operations such as erosion, dilation, opening/closing!</p>
<p><strong>Next topics</strong>:
- Structuring Element
- Erosion and Dilation
- Opening and Closing
- Noise removal and object separation</p>
<hr />
<h2 id="10-references">10. References<a class="header-link" href="#10-references" title="Permanent link">&para;</a></h2>
<h3 id="official-documentation">Official Documentation<a class="header-link" href="#official-documentation" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://docs.opencv.org/4.x/d4/d86/group__imgproc__filter.html#ga8c45db9afe636703801b0b2e440fce37">blur() documentation</a></li>
<li><a href="https://docs.opencv.org/4.x/d4/d86/group__imgproc__filter.html#gaabe8c836e97159a9193fb0b11ac52cf1">GaussianBlur() documentation</a></li>
<li><a href="https://docs.opencv.org/4.x/d4/d86/group__imgproc__filter.html#ga564869aa33e58769b4469101aac458f9">medianBlur() documentation</a></li>
<li><a href="https://docs.opencv.org/4.x/d4/d86/group__imgproc__filter.html#ga9d7064d478c95d60003cf839430737ed">bilateralFilter() documentation</a></li>
</ul>
<h3 id="related-learning-materials">Related Learning Materials<a class="header-link" href="#related-learning-materials" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Folder</th>
<th>Related Content</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./04_Geometric_Transforms.md">04_Geometric_Transforms.md</a></td>
<td>Image preprocessing</td>
</tr>
<tr>
<td><a href="./08_Edge_Detection.md">08_Edge_Detection.md</a></td>
<td>Edge detection after filtering</td>
</tr>
</tbody>
</table>
<h3 id="additional-references">Additional References<a class="header-link" href="#additional-references" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://docs.opencv.org/4.x/d4/d13/tutorial_py_filtering.html">Image Filtering Theory</a></li>
<li><a href="https://setosa.io/ev/image-kernels/">Convolution Visualization</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Computer_Vision/04_Geometric_Transforms.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Geometric Transformations</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Computer_Vision/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Computer_Vision/06_Morphology.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Morphological Operations</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}