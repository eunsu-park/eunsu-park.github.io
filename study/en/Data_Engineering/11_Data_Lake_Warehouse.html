{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Lake and Data Warehouse - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Data_Engineering/">Data Engineering</a>
    <span class="separator">/</span>
    <span class="current">Data Lake and Data Warehouse</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Data Lake and Data Warehouse</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Data_Engineering/10_Kafka_Streaming.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Kafka Streaming</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Data_Engineering/12_dbt_Transformation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">dbt Transformation Tool</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#1-data-warehouse">1. Data Warehouse</a><ul>
<li><a href="#11-concept">1.1 Concept</a></li>
<li><a href="#12-major-solutions">1.2 Major Solutions</a></li>
<li><a href="#13-data-warehouse-sql-examples">1.3 Data Warehouse SQL Examples</a></li>
</ul>
</li>
<li><a href="#2-data-lake">2. Data Lake</a><ul>
<li><a href="#21-concept">2.1 Concept</a></li>
<li><a href="#22-major-storage">2.2 Major Storage</a></li>
<li><a href="#23-data-lake-file-structure">2.3 Data Lake File Structure</a></li>
</ul>
</li>
<li><a href="#3-data-warehouse-vs-data-lake">3. Data Warehouse vs Data Lake</a><ul>
<li><a href="#31-comparison">3.1 Comparison</a></li>
<li><a href="#32-selection-criteria">3.2 Selection Criteria</a></li>
</ul>
</li>
<li><a href="#4-lakehouse">4. Lakehouse</a><ul>
<li><a href="#41-concept">4.1 Concept</a></li>
<li><a href="#42-key-features">4.2 Key Features</a></li>
</ul>
</li>
<li><a href="#5-delta-lake">5. Delta Lake</a><ul>
<li><a href="#51-delta-lake-basics">5.1 Delta Lake Basics</a></li>
<li><a href="#52-delta-lake-advanced-features">5.2 Delta Lake Advanced Features</a></li>
</ul>
</li>
<li><a href="#6-apache-iceberg">6. Apache Iceberg</a><ul>
<li><a href="#61-iceberg-basics">6.1 Iceberg Basics</a></li>
<li><a href="#62-delta-lake-vs-iceberg-comparison">6.2 Delta Lake vs Iceberg Comparison</a></li>
</ul>
</li>
<li><a href="#7-modern-data-stack">7. Modern Data Stack</a><ul>
<li><a href="#71-architecture-pattern">7.1 Architecture Pattern</a></li>
</ul>
</li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-architecture-selection">Problem 1: Architecture Selection</a></li>
<li><a href="#problem-2-delta-lake-implementation">Problem 2: Delta Lake Implementation</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="data-lake-and-data-warehouse">Data Lake and Data Warehouse<a class="header-link" href="#data-lake-and-data-warehouse" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>Data storage architecture is central to an organization's data strategy. Understanding the characteristics and use cases of Data Lakes, Data Warehouses, and the Lakehouse architecture that combines both.</p>
<hr />
<h2 id="1-data-warehouse">1. Data Warehouse<a class="header-link" href="#1-data-warehouse" title="Permanent link">&para;</a></h2>
<h3 id="11-concept">1.1 Concept<a class="header-link" href="#11-concept" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Data Warehouse                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   Characteristics:                                             â”‚
â”‚   - Structured data (schema definition required)               â”‚
â”‚   - Schema-on-Write (apply schema on write)                    â”‚
â”‚   - Optimized for analytics (OLAP)                             â”‚
â”‚   - SQL-based queries                                          â”‚
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    Data Warehouse                     â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
â”‚   â”‚   â”‚  Dim Tables    â”‚    Fact Tables                 â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”‚dim_date  â”‚  â”‚  â”‚fact_salesâ”‚                 â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”‚dim_productâ”‚  â”‚  â”‚fact_ordersâ”‚                â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”‚dim_customerâ”‚ â”‚                               â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12-major-solutions">1.2 Major Solutions<a class="header-link" href="#12-major-solutions" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Solution</th>
<th>Type</th>
<th>Features</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Snowflake</strong></td>
<td>Cloud</td>
<td>Separated storage/compute, auto-scaling</td>
</tr>
<tr>
<td><strong>BigQuery</strong></td>
<td>Cloud (GCP)</td>
<td>Serverless, petabyte scale</td>
</tr>
<tr>
<td><strong>Redshift</strong></td>
<td>Cloud (AWS)</td>
<td>Columnar, MPP architecture</td>
</tr>
<tr>
<td><strong>Synapse</strong></td>
<td>Cloud (Azure)</td>
<td>Unified analytics platform</td>
</tr>
<tr>
<td><strong>PostgreSQL</strong></td>
<td>On-premise</td>
<td>Small-scale, open source</td>
</tr>
</tbody>
</table>
<h3 id="13-data-warehouse-sql-examples">1.3 Data Warehouse SQL Examples<a class="header-link" href="#13-data-warehouse-sql-examples" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Snowflake/BigQuery style analytical queries</span>

<span class="c1">-- Monthly sales trend</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">,</span>
<span class="w">    </span><span class="n">d</span><span class="p">.</span><span class="n">month_name</span><span class="p">,</span>
<span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_sales</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">customer_sk</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">unique_customers</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">    </span><span class="c1">-- Month-over-month growth rate</span>
<span class="w">    </span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LAG</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">))</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">))</span>
<span class="w">        </span><span class="o">/</span><span class="w"> </span><span class="k">NULLIF</span><span class="p">(</span><span class="n">LAG</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">))</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span>
<span class="w">        </span><span class="k">AS</span><span class="w"> </span><span class="n">mom_growth_pct</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">fact_sales</span><span class="w"> </span><span class="n">f</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">dim_date</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">date_sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">date_sk</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2023</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">month_name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">;</span>


<span class="c1">-- Customer LTV by segment</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">customer_metrics</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span>
<span class="w">        </span><span class="k">c</span><span class="p">.</span><span class="n">customer_sk</span><span class="p">,</span>
<span class="w">        </span><span class="k">c</span><span class="p">.</span><span class="n">customer_segment</span><span class="p">,</span>
<span class="w">        </span><span class="k">MIN</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">full_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">first_purchase_date</span><span class="p">,</span>
<span class="w">        </span><span class="k">MAX</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">full_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">last_purchase_date</span><span class="p">,</span>
<span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_revenue</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">fact_sales</span><span class="w"> </span><span class="n">f</span>
<span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">dim_customer</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">customer_sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_sk</span>
<span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">dim_date</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">date_sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">date_sk</span>
<span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_sk</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_segment</span>
<span class="p">)</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">customer_segment</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">customer_count</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">total_orders</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_orders</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">total_revenue</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_ltv</span><span class="p">,</span>
<span class="w">    </span><span class="n">PERCENTILE_CONT</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">WITHIN</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="p">(</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">total_revenue</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">median_ltv</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">customer_metrics</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">customer_segment</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">avg_ltv</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>

<hr />
<h2 id="2-data-lake">2. Data Lake<a class="header-link" href="#2-data-lake" title="Permanent link">&para;</a></h2>
<h3 id="21-concept">2.1 Concept<a class="header-link" href="#21-concept" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                      </span><span class="nx">Data</span><span class="w"> </span><span class="nx">Lake</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="nx">Characteristics</span><span class="p">:</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">types</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">(</span><span class="nx">structured</span><span class="p">,</span><span class="w"> </span><span class="nx">semi</span><span class="o">-</span><span class="nx">structured</span><span class="p">,</span><span class="w"> </span><span class="nx">unstructured</span><span class="p">)</span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Schema</span><span class="o">-</span><span class="nx">on</span><span class="o">-</span><span class="nx">Read</span><span class="w"> </span><span class="p">(</span><span class="nx">apply</span><span class="w"> </span><span class="nx">schema</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">read</span><span class="p">)</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Raw</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">preservation</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Low</span><span class="o">-</span><span class="nx">cost</span><span class="w"> </span><span class="nx">storage</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                     </span><span class="nx">Data</span><span class="w"> </span><span class="nx">Lake</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">Raw</span><span class="w"> </span><span class="nx">Zone</span><span class="w"> </span><span class="p">(</span><span class="nx">Bronze</span><span class="p">)</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Raw</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">(</span><span class="nx">JSON</span><span class="p">,</span><span class="w"> </span><span class="nx">CSV</span><span class="p">,</span><span class="w"> </span><span class="nx">Logs</span><span class="p">,</span><span class="w"> </span><span class="nx">Images</span><span class="p">)</span><span class="w">           </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                         </span><span class="err">â†“</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">Processed</span><span class="w"> </span><span class="nx">Zone</span><span class="w"> </span><span class="p">(</span><span class="nx">Silver</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Cleaned</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">(</span><span class="nx">Parquet</span><span class="p">,</span><span class="w"> </span><span class="nx">Delta</span><span class="p">)</span><span class="w">                </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                         </span><span class="err">â†“</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">Curated</span><span class="w"> </span><span class="nx">Zone</span><span class="w"> </span><span class="p">(</span><span class="nx">Gold</span><span class="p">)</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Analytics</span><span class="o">/</span><span class="nx">ML</span><span class="w"> </span><span class="nx">ready</span><span class="w"> </span><span class="nx">data</span><span class="w">                      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="22-major-storage">2.2 Major Storage<a class="header-link" href="#22-major-storage" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Storage</th>
<th>Cloud</th>
<th>Features</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>S3</strong></td>
<td>AWS</td>
<td>Object storage, high durability</td>
</tr>
<tr>
<td><strong>GCS</strong></td>
<td>GCP</td>
<td>Google Cloud Storage</td>
</tr>
<tr>
<td><strong>ADLS</strong></td>
<td>Azure</td>
<td>Azure Data Lake Storage</td>
</tr>
<tr>
<td><strong>HDFS</strong></td>
<td>On-premise</td>
<td>Hadoop Distributed File System</td>
</tr>
</tbody>
</table>
<h3 id="23-data-lake-file-structure">2.3 Data Lake File Structure<a class="header-link" href="#23-data-lake-file-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>s3://my-data-lake/
â”œâ”€â”€ raw/                          # Bronze layer
â”‚   â”œâ”€â”€ orders/
â”‚   â”‚   â”œâ”€â”€ year=2024/
â”‚   â”‚   â”‚   â”œâ”€â”€ month=01/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ day=15/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ orders_20240115_001.json
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ orders_20240115_002.json
â”‚   â”œâ”€â”€ customers/
â”‚   â”‚   â””â”€â”€ snapshot_20240115.csv
â”‚   â””â”€â”€ logs/
â”‚       â””â”€â”€ app_logs_20240115.log
â”‚
â”œâ”€â”€ processed/                    # Silver layer
â”‚   â”œâ”€â”€ orders/
â”‚   â”‚   â””â”€â”€ year=2024/
â”‚   â”‚       â””â”€â”€ month=01/
â”‚   â”‚           â””â”€â”€ part-00000.parquet
â”‚   â””â”€â”€ customers/
â”‚       â””â”€â”€ part-00000.parquet
â”‚
â””â”€â”€ curated/                      # Gold layer
    â”œâ”€â”€ fact_sales/
    â”‚   â””â”€â”€ year=2024/
    â”‚       â””â”€â”€ month=01/
    â””â”€â”€ dim_customers/
        â””â”€â”€ current/
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Processing Data Lake layers with PySpark</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.functions</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;DataLakeProcessing&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Raw â†’ Processed (Bronze â†’ Silver)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_raw_orders</span><span class="p">():</span>
    <span class="c1"># Read raw JSON</span>
    <span class="n">raw_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/raw/orders/&quot;</span><span class="p">)</span>

    <span class="c1"># Cleaning</span>
    <span class="n">processed_df</span> <span class="o">=</span> <span class="n">raw_df</span> \
        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;order_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">())</span> \
        <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;processed_at&quot;</span><span class="p">,</span> <span class="n">current_timestamp</span><span class="p">())</span> \
        <span class="o">.</span><span class="n">dropDuplicates</span><span class="p">([</span><span class="s2">&quot;order_id&quot;</span><span class="p">])</span>

    <span class="c1"># Save as Parquet</span>
    <span class="n">processed_df</span><span class="o">.</span><span class="n">write</span> \
        <span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/processed/orders/&quot;</span><span class="p">)</span>


<span class="c1"># Processed â†’ Curated (Silver â†’ Gold)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_fact_sales</span><span class="p">():</span>
    <span class="n">orders</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/processed/orders/&quot;</span><span class="p">)</span>
    <span class="n">customers</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/processed/customers/&quot;</span><span class="p">)</span>

    <span class="n">fact_sales</span> <span class="o">=</span> <span class="n">orders</span> \
        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">customers</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;order_id&quot;</span><span class="p">),</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;customer_sk&quot;</span><span class="p">),</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;order_date&quot;</span><span class="p">),</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">fact_sales</span><span class="o">.</span><span class="n">write</span> \
        <span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/curated/fact_sales/&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3-data-warehouse-vs-data-lake">3. Data Warehouse vs Data Lake<a class="header-link" href="#3-data-warehouse-vs-data-lake" title="Permanent link">&para;</a></h2>
<h3 id="31-comparison">3.1 Comparison<a class="header-link" href="#31-comparison" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Characteristic</th>
<th>Data Warehouse</th>
<th>Data Lake</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data Type</strong></td>
<td>Structured</td>
<td>All types</td>
</tr>
<tr>
<td><strong>Schema</strong></td>
<td>Schema-on-Write</td>
<td>Schema-on-Read</td>
</tr>
<tr>
<td><strong>Users</strong></td>
<td>Business analysts</td>
<td>Data scientists, engineers</td>
</tr>
<tr>
<td><strong>Processing</strong></td>
<td>OLAP</td>
<td>Batch, streaming, ML</td>
</tr>
<tr>
<td><strong>Cost</strong></td>
<td>High</td>
<td>Low</td>
</tr>
<tr>
<td><strong>Query Performance</strong></td>
<td>Optimized</td>
<td>Variable</td>
</tr>
<tr>
<td><strong>Data Quality</strong></td>
<td>High (cleaned)</td>
<td>Variable</td>
</tr>
</tbody>
</table>
<h3 id="32-selection-criteria">3.2 Selection Criteria<a class="header-link" href="#32-selection-criteria" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">choose_architecture</span><span class="p">(</span><span class="n">requirements</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Architecture selection guide&quot;&quot;&quot;</span>

    <span class="n">warehouse_factors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;structured_data_only&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sql_analytics_primary&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_governance&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fast_query_response&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">lake_factors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unstructured_data&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ml_workloads&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;raw_data_preservation&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cost_sensitive&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;schema_flexibility&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">warehouse_factors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lake_factors</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Data Warehouse recommended&quot;</span>
    <span class="k">elif</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lake_factors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">warehouse_factors</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Data Lake recommended&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Consider Lakehouse&quot;</span>
</code></pre></div>

<hr />
<h2 id="4-lakehouse">4. Lakehouse<a class="header-link" href="#4-lakehouse" title="Permanent link">&para;</a></h2>
<h3 id="41-concept">4.1 Concept<a class="header-link" href="#41-concept" title="Permanent link">&para;</a></h3>
<p>Lakehouse is an architecture that combines the flexibility of Data Lakes with the performance and management capabilities of Data Warehouses.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Lakehouse Architecture                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                   Applications                          â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  â”‚    BI    â”‚ â”‚    ML    â”‚ â”‚  SQL     â”‚ â”‚ Streamingâ”‚  â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                  Query Engine                           â”‚  â”‚
â”‚   â”‚        (Spark, Presto, Trino, Dremio)                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Lakehouse Format Layer                     â”‚  â”‚
â”‚   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚     â”‚  ACID Transactions â”‚ Schema Enforcement      â”‚   â”‚  â”‚
â”‚   â”‚     â”‚  Time Travel       â”‚ Unified Batch/Streaming â”‚   â”‚  â”‚
â”‚   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â”‚           Delta Lake / Apache Iceberg / Apache Hudi    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Object Storage (Data Lake)                 â”‚  â”‚
â”‚   â”‚                  S3 / GCS / ADLS / HDFS                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="42-key-features">4.2 Key Features<a class="header-link" href="#42-key-features" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ACID Transactions</strong></td>
<td>Data integrity guarantee</td>
</tr>
<tr>
<td><strong>Schema Evolution</strong></td>
<td>Schema change support</td>
</tr>
<tr>
<td><strong>Time Travel</strong></td>
<td>Query historical data versions</td>
</tr>
<tr>
<td><strong>Upsert/Merge</strong></td>
<td>Efficient data updates</td>
</tr>
<tr>
<td><strong>Unified Processing</strong></td>
<td>Batch + streaming in single table</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5-delta-lake">5. Delta Lake<a class="header-link" href="#5-delta-lake" title="Permanent link">&para;</a></h2>
<h3 id="51-delta-lake-basics">5.1 Delta Lake Basics<a class="header-link" href="#51-delta-lake-basics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">delta</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Delta Lake configuration</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;DeltaLake&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.extensions&quot;</span><span class="p">,</span> <span class="s2">&quot;io.delta.sql.DeltaSparkSessionExtension&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.spark_catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.spark.sql.delta.catalog.DeltaCatalog&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Create Delta table</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
<span class="p">],</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="c1"># Read</span>
<span class="n">delta_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="c1"># Access via SQL</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE users USING DELTA LOCATION &#39;/data/delta/users&#39;&quot;</span><span class="p">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-delta-lake-advanced-features">5.2 Delta Lake Advanced Features<a class="header-link" href="#52-delta-lake-advanced-features" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">delta.tables</span><span class="w"> </span><span class="kn">import</span> <span class="n">DeltaTable</span>

<span class="c1"># MERGE (Upsert)</span>
<span class="n">delta_table</span> <span class="o">=</span> <span class="n">DeltaTable</span><span class="o">.</span><span class="n">forPath</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="n">new_data</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Alice Updated&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span>  <span class="c1"># Update</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>        <span class="c1"># Insert</span>
<span class="p">],</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">])</span>

<span class="n">delta_table</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">new_data</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
    <span class="s2">&quot;target.id = source.id&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">whenMatchedUpdate</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;source.name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;source.amount&quot;</span>
<span class="p">})</span><span class="o">.</span><span class="n">whenNotMatchedInsert</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;source.id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;source.name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;source.amount&quot;</span>
<span class="p">})</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>


<span class="c1"># Time Travel (query historical versions)</span>
<span class="c1"># By version number</span>
<span class="n">df_v0</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;versionAsOf&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="c1"># By timestamp</span>
<span class="n">df_yesterday</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;timestampAsOf&quot;</span><span class="p">,</span> <span class="s2">&quot;2024-01-14&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>


<span class="c1"># Check history</span>
<span class="n">delta_table</span><span class="o">.</span><span class="n">history</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Vacuum (cleanup old files)</span>
<span class="n">delta_table</span><span class="o">.</span><span class="n">vacuum</span><span class="p">(</span><span class="n">retentionHours</span><span class="o">=</span><span class="mi">168</span><span class="p">)</span>  <span class="c1"># 7 days retention</span>


<span class="c1"># Schema evolution</span>
<span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;mergeSchema&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>


<span class="c1"># Z-Order optimization (query performance)</span>
<span class="n">delta_table</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span><span class="o">.</span><span class="n">executeZOrderBy</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-apache-iceberg">6. Apache Iceberg<a class="header-link" href="#6-apache-iceberg" title="Permanent link">&para;</a></h2>
<h3 id="61-iceberg-basics">6.1 Iceberg Basics<a class="header-link" href="#61-iceberg-basics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Iceberg&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.extensions&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.iceberg&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.iceberg.spark.SparkCatalog&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.iceberg.type&quot;</span><span class="p">,</span> <span class="s2">&quot;hive&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.iceberg.uri&quot;</span><span class="p">,</span> <span class="s2">&quot;thrift://localhost:9083&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Create Iceberg table</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    CREATE TABLE iceberg.db.users (</span>
<span class="s2">        id INT,</span>
<span class="s2">        name STRING,</span>
<span class="s2">        amount DECIMAL(10, 2)</span>
<span class="s2">    ) USING ICEBERG</span>
<span class="s2">    PARTITIONED BY (bucket(16, id))</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Insert data</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    INSERT INTO iceberg.db.users VALUES</span>
<span class="s2">    (1, &#39;Alice&#39;, 100.00),</span>
<span class="s2">    (2, &#39;Bob&#39;, 200.00)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Time Travel</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iceberg.db.users VERSION AS OF 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iceberg.db.users TIMESTAMP AS OF &#39;2024-01-15&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Check snapshots</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iceberg.db.users.snapshots&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="62-delta-lake-vs-iceberg-comparison">6.2 Delta Lake vs Iceberg Comparison<a class="header-link" href="#62-delta-lake-vs-iceberg-comparison" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Delta Lake</th>
<th>Iceberg</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Developer</strong></td>
<td>Databricks</td>
<td>Netflix â†’ Apache</td>
</tr>
<tr>
<td><strong>Compatibility</strong></td>
<td>Spark-centric</td>
<td>Engine-independent</td>
</tr>
<tr>
<td><strong>Metadata</strong></td>
<td>Transaction log</td>
<td>Snapshot-based</td>
</tr>
<tr>
<td><strong>Partition Evolution</strong></td>
<td>Limited</td>
<td>Strong support</td>
</tr>
<tr>
<td><strong>Hidden Partitioning</strong></td>
<td>Not supported</td>
<td>Supported</td>
</tr>
<tr>
<td><strong>Community</strong></td>
<td>Databricks ecosystem</td>
<td>Multiple vendors</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7-modern-data-stack">7. Modern Data Stack<a class="header-link" href="#7-modern-data-stack" title="Permanent link">&para;</a></h2>
<h3 id="71-architecture-pattern">7.1 Architecture Pattern<a class="header-link" href="#71-architecture-pattern" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Modern Data Stack                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Data Sources                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚ SaaS   â”‚ â”‚Databaseâ”‚ â”‚  API   â”‚ â”‚  IoT   â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Ingestion (EL)                              â”‚  â”‚
â”‚   â”‚        Fivetran / Airbyte / Stitch                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚           Cloud Data Warehouse / Lakehouse              â”‚  â”‚
â”‚   â”‚        Snowflake / BigQuery / Databricks                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Transformation (T)                          â”‚  â”‚
â”‚   â”‚                      dbt                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                 BI / Analytics                           â”‚  â”‚
â”‚   â”‚        Looker / Tableau / Metabase / Mode               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-architecture-selection">Problem 1: Architecture Selection<a class="header-link" href="#problem-1-architecture-selection" title="Permanent link">&para;</a></h3>
<p>Choose and justify an architecture for the following requirements:
- 10TB daily log data
- Used for ML model training
- Raw data retention for 5 years</p>
<h3 id="problem-2-delta-lake-implementation">Problem 2: Delta Lake Implementation<a class="header-link" href="#problem-2-delta-lake-implementation" title="Permanent link">&para;</a></h3>
<p>Implement SCD Type 2 for customer data using Delta Lake MERGE.</p>
<hr />
<h2 id="summary">Summary<a class="header-link" href="#summary" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Architecture</th>
<th>Features</th>
<th>Use Cases</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data Warehouse</strong></td>
<td>Structured, SQL optimized</td>
<td>BI, reporting</td>
</tr>
<tr>
<td><strong>Data Lake</strong></td>
<td>All data types, low cost</td>
<td>ML, raw preservation</td>
</tr>
<tr>
<td><strong>Lakehouse</strong></td>
<td>Lake + Warehouse benefits</td>
<td>Unified analytics</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.delta.io/">Delta Lake Documentation</a></li>
<li><a href="https://iceberg.apache.org/">Apache Iceberg Documentation</a></li>
<li><a href="https://www.databricks.com/product/data-lakehouse">Databricks Lakehouse</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Data_Engineering/10_Kafka_Streaming.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Kafka Streaming</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Data_Engineering/12_dbt_Transformation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">dbt Transformation Tool</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}