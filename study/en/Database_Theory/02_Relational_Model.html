{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Relational Model - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Database_Theory/">Database Theory</a>
    <span class="separator">/</span>
    <span class="current">The Relational Model</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>The Relational Model</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Database_Theory/01_Introduction_to_Database_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Introduction to Database Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Database_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Database_Theory/03_Relational_Algebra.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Relational Algebra</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-historical-context-codds-vision">1. Historical Context: Codd's Vision</a><ul>
<li><a href="#the-problem-codd-addressed">The Problem Codd Addressed</a></li>
<li><a href="#codds-key-insight">Codd's Key Insight</a></li>
</ul>
</li>
<li><a href="#2-codds-12-rules">2. Codd's 12 Rules</a><ul>
<li><a href="#rule-0-the-foundation-rule">Rule 0: The Foundation Rule</a></li>
<li><a href="#the-12-rules">The 12 Rules</a></li>
<li><a href="#practical-assessment">Practical Assessment</a></li>
</ul>
</li>
<li><a href="#3-formal-definitions">3. Formal Definitions</a><ul>
<li><a href="#domain">Domain</a></li>
<li><a href="#relation-schema">Relation Schema</a></li>
<li><a href="#relation-instance">Relation (Instance)</a></li>
<li><a href="#formal-example">Formal Example</a></li>
<li><a href="#properties-of-relations">Properties of Relations</a></li>
<li><a href="#relation-vs-table">Relation vs. Table</a></li>
<li><a href="#attribute-types-and-domains-in-sql">Attribute Types and Domains in SQL</a></li>
</ul>
</li>
<li><a href="#4-keys">4. Keys</a><ul>
<li><a href="#superkey">Superkey</a></li>
<li><a href="#candidate-key">Candidate Key</a></li>
<li><a href="#primary-key">Primary Key</a></li>
<li><a href="#foreign-key">Foreign Key</a></li>
<li><a href="#composite-key">Composite Key</a></li>
<li><a href="#surrogate-key-vs-natural-key">Surrogate Key vs. Natural Key</a></li>
<li><a href="#summary-of-key-types">Summary of Key Types</a></li>
</ul>
</li>
<li><a href="#5-integrity-constraints">5. Integrity Constraints</a><ul>
<li><a href="#domain-constraints">Domain Constraints</a></li>
<li><a href="#entity-integrity-constraint">Entity Integrity Constraint</a></li>
<li><a href="#referential-integrity-constraint">Referential Integrity Constraint</a></li>
<li><a href="#referential-integrity-actions">Referential Integrity Actions</a></li>
<li><a href="#referential-integrity-action-examples">Referential Integrity Action Examples</a></li>
<li><a href="#key-constraints">Key Constraints</a></li>
<li><a href="#general-constraints-semantic-constraints">General Constraints (Semantic Constraints)</a></li>
<li><a href="#constraint-summary">Constraint Summary</a></li>
</ul>
</li>
<li><a href="#6-relational-schema-notation">6. Relational Schema Notation</a><ul>
<li><a href="#textual-notation">Textual Notation</a></li>
<li><a href="#underline-convention">Underline Convention</a></li>
<li><a href="#diagrammatic-notation">Diagrammatic Notation</a></li>
<li><a href="#sql-ddl-as-schema-definition">SQL DDL as Schema Definition</a></li>
</ul>
</li>
<li><a href="#7-null-semantics-and-three-valued-logic">7. NULL Semantics and Three-Valued Logic</a><ul>
<li><a href="#what-null-represents">What NULL Represents</a></li>
<li><a href="#three-valued-logic-3vl">Three-Valued Logic (3VL)</a></li>
<li><a href="#truth-tables-for-3vl">Truth Tables for 3VL</a></li>
<li><a href="#implications-for-sql-queries">Implications for SQL Queries</a></li>
<li><a href="#null-in-aggregates">NULL in Aggregates</a></li>
<li><a href="#null-in-boolean-expressions">NULL in Boolean Expressions</a></li>
<li><a href="#null-in-distinct-and-group-by">NULL in DISTINCT and GROUP BY</a></li>
<li><a href="#null-in-joins">NULL in Joins</a></li>
<li><a href="#coalesce-and-nullif">COALESCE and NULLIF</a></li>
<li><a href="#best-practices-for-nulls">Best Practices for NULLs</a></li>
</ul>
</li>
<li><a href="#8-relational-model-in-practice">8. Relational Model in Practice</a><ul>
<li><a href="#python-implementation-of-relational-concepts">Python Implementation of Relational Concepts</a></li>
<li><a href="#common-relational-model-misconceptions">Common Relational Model Misconceptions</a></li>
</ul>
</li>
<li><a href="#9-exercises">9. Exercises</a><ul>
<li><a href="#conceptual-questions">Conceptual Questions</a></li>
<li><a href="#schema-design-questions">Schema Design Questions</a></li>
<li><a href="#sql-and-null-questions">SQL and NULL Questions</a></li>
<li><a href="#design-exercise">Design Exercise</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="the-relational-model">The Relational Model<a class="header-link" href="#the-relational-model" title="Permanent link">&para;</a></h1>
<p><strong>Previous</strong>: <a href="./01_Introduction_to_Database_Systems.md">Introduction to Database Systems</a> | <strong>Next</strong>: <a href="./03_Relational_Algebra.md">Relational Algebra</a></p>
<hr />
<p>The relational model, introduced by Edgar F. Codd in 1970, is the most widely used data model and the theoretical foundation of SQL databases. It represents data as mathematical relations (tables) and provides a rigorous framework for defining structure, enforcing integrity, and manipulating data. This lesson covers the formal definitions, key concepts, integrity constraints, and the subtle semantics of NULLs that every database practitioner must understand.</p>
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-historical-context-codds-vision">Historical Context: Codd's Vision</a></li>
<li><a href="#2-codds-12-rules">Codd's 12 Rules</a></li>
<li><a href="#3-formal-definitions">Formal Definitions</a></li>
<li><a href="#4-keys">Keys</a></li>
<li><a href="#5-integrity-constraints">Integrity Constraints</a></li>
<li><a href="#6-relational-schema-notation">Relational Schema Notation</a></li>
<li><a href="#7-null-semantics-and-three-valued-logic">NULL Semantics and Three-Valued Logic</a></li>
<li><a href="#8-relational-model-in-practice">Relational Model in Practice</a></li>
<li><a href="#9-exercises">Exercises</a></li>
</ol>
<hr />
<h2 id="1-historical-context-codds-vision">1. Historical Context: Codd's Vision<a class="header-link" href="#1-historical-context-codds-vision" title="Permanent link">&para;</a></h2>
<p>In 1970, Edgar F. Codd, a researcher at IBM's San Jose Research Laboratory, published "A Relational Model of Data for Large Shared Data Banks" in Communications of the ACM. This paper fundamentally changed how we think about data management.</p>
<h3 id="the-problem-codd-addressed">The Problem Codd Addressed<a class="header-link" href="#the-problem-codd-addressed" title="Permanent link">&para;</a></h3>
<p>Before the relational model, the two dominant approaches were:</p>
<div class="highlight"><pre><span></span><code>Hierarchical Model (IMS):        Network Model (CODASYL):

     ROOT                          STUDENT â”€â”€â”€â”€ COURSE
    /    \                            â”‚    \  /     â”‚
  CHILD1  CHILD2                      â”‚     \/      â”‚
    |                                 â”‚     /\      â”‚
  CHILD3                              â”‚    /  \     â”‚
                                      â–¼   /    \    â–¼
                                   ADVISOR    ENROLLMENT

Both required:
  - Programs to navigate through pointer chains
  - Knowledge of physical data layout
  - Code rewriting when structure changed
</code></pre></div>

<h3 id="codds-key-insight">Codd's Key Insight<a class="header-link" href="#codds-key-insight" title="Permanent link">&para;</a></h3>
<p>Codd proposed representing data as <strong>relations</strong> (mathematical concept), which correspond to tables:</p>
<div class="highlight"><pre><span></span><code>Instead of:                         Use:
  &quot;Follow pointer from              &quot;SELECT student_name
   STUDENT record through            FROM students
   enrollment chain to               JOIN courses
   find course name&quot;                 ON students.id = enrollments.student_id
                                     WHERE course_name = &#39;Database Theory&#39;&quot;

  Navigate HOW                      Declare WHAT
  (procedural)                      (declarative)
</code></pre></div>

<p>This shift from <strong>procedural navigation</strong> to <strong>declarative specification</strong> was revolutionary.</p>
<hr />
<h2 id="2-codds-12-rules">2. Codd's 12 Rules<a class="header-link" href="#2-codds-12-rules" title="Permanent link">&para;</a></h2>
<p>In 1985, Codd published 12 rules (actually 13, numbered 0-12) that define what it means for a database management system to be truly "relational." These rules serve as a benchmark for evaluating RDBMS implementations.</p>
<h3 id="rule-0-the-foundation-rule">Rule 0: The Foundation Rule<a class="header-link" href="#rule-0-the-foundation-rule" title="Permanent link">&para;</a></h3>
<blockquote>
<p>A relational DBMS must manage its stored data using only its relational capabilities.</p>
</blockquote>
<h3 id="the-12-rules">The 12 Rules<a class="header-link" href="#the-12-rules" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>Rule Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>Information Rule</strong></td>
<td>All data is represented as values in tables (relations). This includes metadata (the system catalog).</td>
</tr>
<tr>
<td>2</td>
<td><strong>Guaranteed Access Rule</strong></td>
<td>Every datum is accessible by specifying the table name, column name, and primary key value. No pointers needed.</td>
</tr>
<tr>
<td>3</td>
<td><strong>Systematic Treatment of NULL</strong></td>
<td>NULL represents missing or inapplicable data, distinct from empty string or zero. Supported for all data types.</td>
</tr>
<tr>
<td>4</td>
<td><strong>Dynamic Online Catalog</strong></td>
<td>The database description (metadata) is stored in tables and queryable using the same relational language as user data.</td>
</tr>
<tr>
<td>5</td>
<td><strong>Comprehensive Data Sublanguage</strong></td>
<td>At least one language must support data definition, manipulation, integrity constraints, authorization, and transactions. (SQL fulfills this.)</td>
</tr>
<tr>
<td>6</td>
<td><strong>View Updating Rule</strong></td>
<td>All views that are theoretically updatable must be updatable by the system.</td>
</tr>
<tr>
<td>7</td>
<td><strong>High-Level Insert, Update, Delete</strong></td>
<td>Set-at-a-time operations (not just row-at-a-time). You can insert, update, or delete multiple rows in a single statement.</td>
</tr>
<tr>
<td>8</td>
<td><strong>Physical Data Independence</strong></td>
<td>Applications are not affected by changes to physical storage or access methods.</td>
</tr>
<tr>
<td>9</td>
<td><strong>Logical Data Independence</strong></td>
<td>Applications are not affected by information-preserving changes to the conceptual schema.</td>
</tr>
<tr>
<td>10</td>
<td><strong>Integrity Independence</strong></td>
<td>Integrity constraints are defined in the catalog (not in application programs) and can be changed without affecting applications.</td>
</tr>
<tr>
<td>11</td>
<td><strong>Distribution Independence</strong></td>
<td>Applications work the same whether data is centralized or distributed.</td>
</tr>
<tr>
<td>12</td>
<td><strong>Nonsubversion Rule</strong></td>
<td>If the system provides a low-level (record-at-a-time) interface, it cannot be used to bypass relational integrity constraints.</td>
</tr>
</tbody>
</table>
<h3 id="practical-assessment">Practical Assessment<a class="header-link" href="#practical-assessment" title="Permanent link">&para;</a></h3>
<p>No commercial RDBMS fully satisfies all 12 rules. Here is a rough assessment:</p>
<div class="highlight"><pre><span></span><code>Rule compliance (approximate):

                    PostgreSQL  MySQL   Oracle  SQLite
Rule 1 (Info)          âœ“         âœ“       âœ“       âœ“
Rule 2 (Access)        âœ“         âœ“       âœ“       âœ“
Rule 3 (NULL)          âœ“         âœ“       âœ“       ~
Rule 4 (Catalog)       âœ“         âœ“       âœ“       ~
Rule 5 (Language)      âœ“         âœ“       âœ“       âœ“
Rule 6 (View Update)   ~         ~       ~       ~
Rule 7 (Set Ops)       âœ“         âœ“       âœ“       âœ“
Rule 8 (Physical DI)   âœ“         âœ“       âœ“       ~
Rule 9 (Logical DI)    ~         ~       ~       ~
Rule 10 (Integrity)    âœ“         ~       âœ“       ~
Rule 11 (Distribution) ~         ~       ~       âœ—
Rule 12 (Nonsub.)      âœ“         ~       âœ“       ~

âœ“ = Mostly compliant  ~ = Partially  âœ— = Not supported
</code></pre></div>

<hr />
<h2 id="3-formal-definitions">3. Formal Definitions<a class="header-link" href="#3-formal-definitions" title="Permanent link">&para;</a></h2>
<p>The relational model is grounded in set theory and first-order predicate logic. Understanding the formal definitions is essential for database design and query formulation.</p>
<h3 id="domain">Domain<a class="header-link" href="#domain" title="Permanent link">&para;</a></h3>
<p>A <strong>domain</strong> D is a set of atomic (indivisible) values. Each domain has a logical definition (what values mean) and a data type.</p>
<div class="highlight"><pre><span></span><code>Examples of domains:

D_StudentID  = {S001, S002, S003, ..., S999}
D_Name       = set of all character strings of length &lt;= 50
D_GPA        = {x in R | 0.0 &lt;= x &lt;= 4.0}
D_Grade      = {A+, A, A-, B+, B, B-, C+, C, C-, D+, D, F}
D_Credits    = {1, 2, 3, 4, 5}
D_Boolean    = {TRUE, FALSE}
D_Date       = set of all valid calendar dates
</code></pre></div>

<h3 id="relation-schema">Relation Schema<a class="header-link" href="#relation-schema" title="Permanent link">&para;</a></h3>
<p>A <strong>relation schema</strong> R(A1, A2, ..., An) consists of:
- A relation name R
- A list of attributes A1, A2, ..., An
- Each attribute Ai has a domain dom(Ai)</p>
<div class="highlight"><pre><span></span><code>Formal notation:

  R(A1: D1, A2: D2, ..., An: Dn)

Example:

  STUDENT(student_id: D_StudentID,
          name: D_Name,
          gpa: D_GPA)
</code></pre></div>

<p>The <strong>degree</strong> (or arity) of a relation is the number of attributes n.</p>
<h3 id="relation-instance">Relation (Instance)<a class="header-link" href="#relation-instance" title="Permanent link">&para;</a></h3>
<p>A <strong>relation</strong> r of the relation schema R(A1, A2, ..., An) is a set of n-tuples:</p>
<div class="highlight"><pre><span></span><code>r(R) âŠ† dom(A1) Ã— dom(A2) Ã— ... Ã— dom(An)
</code></pre></div>

<p>Each n-tuple t is an ordered list of values:</p>
<div class="highlight"><pre><span></span><code>t = &lt;v1, v2, ..., vn&gt;   where vi âˆˆ dom(Ai) âˆª {NULL}
</code></pre></div>

<h3 id="formal-example">Formal Example<a class="header-link" href="#formal-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Schema</span><span class="o">:</span>
<span class="w">  </span><span class="n">STUDENT</span><span class="o">(</span><span class="n">student_id</span><span class="o">:</span><span class="w"> </span><span class="n">D_StudentID</span><span class="o">,</span><span class="w"> </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">D_Name</span><span class="o">,</span><span class="w"> </span><span class="n">year</span><span class="o">:</span><span class="w"> </span><span class="n">D_Year</span><span class="o">,</span><span class="w"> </span><span class="n">gpa</span><span class="o">:</span><span class="w"> </span><span class="n">D_GPA</span><span class="o">)</span>

<span class="w">  </span><span class="n">where</span><span class="w"> </span><span class="n">D_StudentID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">S001</span><span class="o">..</span><span class="n">S999</span><span class="o">}</span>
<span class="w">        </span><span class="n">D_Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">50</span>
<span class="w">        </span><span class="n">D_Year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">}</span>
<span class="w">        </span><span class="n">D_GPA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">x</span><span class="w"> </span><span class="err">âˆˆ</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="mf">4.0</span><span class="o">}</span>

<span class="n">Instance</span><span class="w"> </span><span class="o">(</span><span class="n">at</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">t</span><span class="o">):</span>
<span class="w">  </span><span class="n">r</span><span class="o">(</span><span class="n">STUDENT</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S001</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Alice Kim&quot;</span><span class="o">,</span><span class="w">  </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mf">3.85</span><span class="o">&gt;,</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S002</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Bob Park&quot;</span><span class="o">,</span><span class="w">   </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mf">3.42</span><span class="o">&gt;,</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S003</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Carol Lee&quot;</span><span class="o">,</span><span class="w">  </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mf">3.91</span><span class="o">&gt;,</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S004</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Dave Choi&quot;</span><span class="o">,</span><span class="w">  </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">NULL</span><span class="o">&gt;</span>
<span class="w">  </span><span class="o">}</span>

<span class="w">  </span><span class="n">Degree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="n">Cardinality</span><span class="w"> </span><span class="o">(</span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tuples</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
</code></pre></div>

<h3 id="properties-of-relations">Properties of Relations<a class="header-link" href="#properties-of-relations" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>No duplicate tuples</strong></td>
<td>A relation is a set, so no two tuples can be identical</td>
</tr>
<tr>
<td><strong>Tuples are unordered</strong></td>
<td>There is no inherent ordering of rows</td>
</tr>
<tr>
<td><strong>Attributes are unordered</strong></td>
<td>The order of columns does not matter (though SQL implementations typically preserve declaration order)</td>
</tr>
<tr>
<td><strong>Attribute values are atomic</strong></td>
<td>Each cell contains a single, indivisible value (first normal form)</td>
</tr>
<tr>
<td><strong>Each attribute has a distinct name</strong></td>
<td>No two attributes in the same relation share a name</td>
</tr>
</tbody>
</table>
<h3 id="relation-vs-table">Relation vs. Table<a class="header-link" href="#relation-vs-table" title="Permanent link">&para;</a></h3>
<p>While often used interchangeably, there are subtle differences:</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">     </span><span class="n">Relation</span><span class="w"> </span><span class="p">(</span><span class="n">Theory</span><span class="p">)</span><span class="w">       </span><span class="err">â”‚</span><span class="w">        </span><span class="n">Table</span><span class="w"> </span><span class="p">(</span><span class="n">SQL</span><span class="p">)</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tuples</span><span class="w"> </span><span class="p">(</span><span class="n">no</span><span class="w"> </span><span class="n">dups</span><span class="p">)</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Multiset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">rows</span><span class="w"> </span><span class="p">(</span><span class="n">dups</span><span class="w"> </span><span class="n">OK</span><span class="p">)</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Tuples</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unordered</span><span class="w">        </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Rows</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">order</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Attributes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unordered</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Columns</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">declared</span><span class="w"> </span><span class="n">order</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">All</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">atomic</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Arrays</span><span class="p">,</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">some</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Named</span><span class="w"> </span><span class="n">perspective</span><span class="w"> </span><span class="n">only</span><span class="w">      </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Positional</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">possible</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Domain</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">typing</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">types</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">SQL</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">NOT</span><span class="w"> </span><span class="n">strictly</span><span class="w"> </span><span class="n">relations</span><span class="w"> </span><span class="n">because</span><span class="p">:</span>
<span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">duplicate</span><span class="w"> </span><span class="n">rows</span><span class="w"> </span><span class="p">(</span><span class="n">unless</span><span class="w"> </span><span class="n">constrained</span><span class="p">)</span>
<span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">preserves</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">order</span>
<span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="p">(</span><span class="n">auto</span><span class="o">-</span><span class="n">increment</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="p">)</span>
</code></pre></div>

<h3 id="attribute-types-and-domains-in-sql">Attribute Types and Domains in SQL<a class="header-link" href="#attribute-types-and-domains-in-sql" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Mapping mathematical domains to SQL types</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">grade_domain</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">VALUE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A+&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;A-&#39;</span><span class="p">,</span><span class="s1">&#39;B+&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;B-&#39;</span><span class="p">,</span><span class="s1">&#39;C+&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;C-&#39;</span><span class="p">,</span><span class="s1">&#39;D+&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">));</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">gpa_domain</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">VALUE</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">VALUE</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">        </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- D_StudentID</span>
<span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">    </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- D_Name</span>
<span class="w">    </span><span class="k">year</span><span class="w">        </span><span class="nb">SMALLINT</span><span class="w">       </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- D_Year</span>
<span class="w">    </span><span class="n">gpa</span><span class="w">         </span><span class="n">gpa_domain</span><span class="p">,</span><span class="w">               </span><span class="c1">-- D_GPA (with domain)</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">pk_student</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">ck_year</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<p>Note: The <code>CREATE DOMAIN</code> syntax is supported by PostgreSQL but not all RDBMS.</p>
<hr />
<h2 id="4-keys">4. Keys<a class="header-link" href="#4-keys" title="Permanent link">&para;</a></h2>
<p>Keys are fundamental to the relational model. They provide the mechanism for uniquely identifying tuples and establishing relationships between relations.</p>
<h3 id="superkey">Superkey<a class="header-link" href="#superkey" title="Permanent link">&para;</a></h3>
<p>A <strong>superkey</strong> of a relation schema R is a set of attributes SK âŠ† R such that no two tuples in any valid relation instance r(R) have the same values for SK.</p>
<p>Formally: For any two distinct tuples t1, t2 in r(R):</p>
<div class="highlight"><pre><span></span><code><span class="n">t1</span><span class="o">[</span><span class="n">SK</span><span class="o">]</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="n">t2</span><span class="o">[</span><span class="n">SK</span><span class="o">]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>STUDENT(student_id, name, year, gpa)

Superkeys of STUDENT:
  {student_id}                          â† minimal
  {student_id, name}                    â† not minimal (student_id alone suffices)
  {student_id, name, year}              â† not minimal
  {student_id, name, year, gpa}         â† trivial superkey (all attributes)
  {name, year}                          â† might be superkey IF unique

Note: The set of ALL attributes is always a superkey (trivial superkey).
</code></pre></div>

<h3 id="candidate-key">Candidate Key<a class="header-link" href="#candidate-key" title="Permanent link">&para;</a></h3>
<p>A <strong>candidate key</strong> is a <strong>minimal superkey</strong> -- a superkey from which no attribute can be removed without losing the uniqueness property.</p>
<div class="highlight"><pre><span></span><code>Formal definition:
  A superkey K of R is a candidate key if for every proper subset K&#39; âŠ‚ K,
  K&#39; is NOT a superkey of R.

Example:
  ENROLLMENT(student_id, course_id, semester, grade)

  Superkeys:
    {student_id, course_id, semester}             â† minimal â†’ CANDIDATE KEY
    {student_id, course_id, semester, grade}      â† not minimal

  If we assume (name, year) is unique for STUDENT:
    {name, year} is another candidate key

  A relation can have MULTIPLE candidate keys.
</code></pre></div>

<h3 id="primary-key">Primary Key<a class="header-link" href="#primary-key" title="Permanent link">&para;</a></h3>
<p>The <strong>primary key</strong> is the candidate key chosen by the database designer to be the main identifier for tuples. It is marked with underline in schema notation.</p>
<div class="highlight"><pre><span></span><code>Conventions:
  <span class="k">-</span> Underline the primary key attributes
  <span class="k">-</span> Primary key values cannot be NULL
  <span class="k">-</span> Each relation has exactly ONE primary key
  <span class="k">-</span> Other candidate keys become ALTERNATE KEYS

  STUDENT(student_id, name, year, gpa)
         ^^^^^^^^^^
         Primary Key

  If both {student_id} and {name, year} are candidate keys:
    Primary key: {student_id}       (chosen by designer)
    Alternate key: {name, year}     (the other candidate key)
</code></pre></div>

<h3 id="foreign-key">Foreign Key<a class="header-link" href="#foreign-key" title="Permanent link">&para;</a></h3>
<p>A <strong>foreign key</strong> is a set of attributes in one relation that refers to the primary key of another (or the same) relation.</p>
<div class="highlight"><pre><span></span><code>Formal definition:
  A set of attributes FK in relation R1 is a foreign key referencing
  relation R2 if:
    1. The attributes in FK have the same domain(s) as the primary key
       PK of R2
    2. A value of FK in a tuple t1 of r(R1) either:
       (a) occurs as a value of PK for some tuple t2 in r(R2), or
       (b) is NULL (if allowed)

Example:
  STUDENT(student_id, name, year, gpa)
  COURSE(course_id, title, credits)
  ENROLLMENT(student_id, course_id, semester, grade)
             ^^^^^^^^^^  ^^^^^^^^^
             FK â†’ STUDENT  FK â†’ COURSE

Diagrammatically:

  STUDENT                    ENROLLMENT                    COURSE
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚student_id â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚student_id (FK)â”‚             â”‚course_id  â”‚
  â”‚name       â”‚             â”‚course_id  (FK)â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚title      â”‚
  â”‚year       â”‚             â”‚semester       â”‚             â”‚credits    â”‚
  â”‚gpa        â”‚             â”‚grade          â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="composite-key">Composite Key<a class="header-link" href="#composite-key" title="Permanent link">&para;</a></h3>
<p>A key consisting of multiple attributes:</p>
<div class="highlight"><pre><span></span><code>ENROLLMENT(student_id, course_id, semester, grade)

Primary key: {student_id, course_id, semester}
  <span class="k">-</span> A composite key of THREE attributes
  <span class="k">-</span> student_id alone is NOT sufficient (student takes many courses)
  <span class="k">-</span> (student_id, course_id) alone is NOT sufficient
    (student may retake a course in a different semester)
</code></pre></div>

<h3 id="surrogate-key-vs-natural-key">Surrogate Key vs. Natural Key<a class="header-link" href="#surrogate-key-vs-natural-key" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Natural</span><span class="w"> </span><span class="nx">Key</span><span class="p">:</span><span class="w">                        </span><span class="nx">Surrogate</span><span class="w"> </span><span class="nx">Key</span><span class="p">:</span>
<span class="w">  </span><span class="nx">Uses</span><span class="w"> </span><span class="nx">real</span><span class="o">-</span><span class="nx">world</span><span class="w"> </span><span class="nx">data</span><span class="w">                </span><span class="nx">Uses</span><span class="w"> </span><span class="nx">system</span><span class="o">-</span><span class="nx">generated</span><span class="w"> </span><span class="nx">value</span>

<span class="w">  </span><span class="nx">STUDENT</span><span class="p">(</span><span class="nx">ssn</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="p">)</span><span class="w">            </span><span class="nx">STUDENT</span><span class="p">(</span><span class="nx">student_id</span><span class="p">,</span><span class="w"> </span><span class="nx">ssn</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="p">)</span>
<span class="w">          </span><span class="o">^^^</span><span class="w">                                 </span><span class="o">^^^^^^^^^^</span>
<span class="w">          </span><span class="nx">Natural</span><span class="w"> </span><span class="nx">PK</span><span class="w">                          </span><span class="nx">Surrogate</span><span class="w"> </span><span class="nx">PK</span><span class="w"> </span><span class="p">(</span><span class="kt">auto</span><span class="o">-</span><span class="nx">increment</span><span class="p">)</span>

<span class="nx">Advantages</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">Natural</span><span class="w"> </span><span class="nx">Key</span><span class="p">:</span><span class="w">           </span><span class="nx">Advantages</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">Surrogate</span><span class="w"> </span><span class="nx">Key</span><span class="p">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Meaningful</span><span class="w">                         </span><span class="o">-</span><span class="w"> </span><span class="nx">Compact</span><span class="w"> </span><span class="p">(</span><span class="nx">integer</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">extra</span><span class="w"> </span><span class="nx">column</span><span class="w">                    </span><span class="o">-</span><span class="w"> </span><span class="nx">Immutable</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Already</span><span class="w"> </span><span class="nx">unique</span><span class="w">                     </span><span class="o">-</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">business</span><span class="w"> </span><span class="nx">meaning</span><span class="w"> </span><span class="nx">changes</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">Self</span><span class="o">-</span><span class="nx">documenting</span><span class="w">                   </span><span class="o">-</span><span class="w"> </span><span class="nx">Simple</span><span class="w"> </span><span class="nx">joins</span>

<span class="nx">Disadvantages</span><span class="p">:</span><span class="w">                       </span><span class="nx">Disadvantages</span><span class="p">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">May</span><span class="w"> </span><span class="nx">change</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="nx">change</span><span class="p">)</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="nx">Extra</span><span class="w"> </span><span class="nx">column</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">May</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">large</span><span class="w"> </span><span class="p">(</span><span class="nx">SSN</span><span class="p">,</span><span class="w"> </span><span class="nx">ISBN</span><span class="p">)</span><span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">semantic</span><span class="w"> </span><span class="nx">meaning</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Privacy</span><span class="w"> </span><span class="nx">concerns</span><span class="w"> </span><span class="p">(</span><span class="nx">SSN</span><span class="p">)</span><span class="w">             </span><span class="o">-</span><span class="w"> </span><span class="nx">Requires</span><span class="w"> </span><span class="nx">lookup</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">meaning</span>
</code></pre></div>

<h3 id="summary-of-key-types">Summary of Key Types<a class="header-link" href="#summary-of-key-types" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Key Hierarchy                          â”‚
â”‚                                                             â”‚
â”‚  Superkey                                                   â”‚
â”‚    â”‚                                                        â”‚
â”‚    â”œâ”€â”€ Candidate Key (minimal superkey)                     â”‚
â”‚    â”‚     â”‚                                                  â”‚
â”‚    â”‚     â”œâ”€â”€ Primary Key (chosen candidate key)             â”‚
â”‚    â”‚     â”‚                                                  â”‚
â”‚    â”‚     â””â”€â”€ Alternate Key (non-chosen candidate key)       â”‚
â”‚    â”‚                                                        â”‚
â”‚    â””â”€â”€ Non-minimal superkey                                 â”‚
â”‚                                                             â”‚
â”‚  Foreign Key (references another relation&#39;s primary key)    â”‚
â”‚                                                             â”‚
â”‚  Composite Key (key with multiple attributes)               â”‚
â”‚                                                             â”‚
â”‚  Surrogate Key (system-generated, no business meaning)      â”‚
â”‚  Natural Key (derived from real-world data)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="5-integrity-constraints">5. Integrity Constraints<a class="header-link" href="#5-integrity-constraints" title="Permanent link">&para;</a></h2>
<p>Integrity constraints are rules that restrict the values in a database to ensure data correctness and consistency. The relational model defines several types of constraints.</p>
<h3 id="domain-constraints">Domain Constraints<a class="header-link" href="#domain-constraints" title="Permanent link">&para;</a></h3>
<p>A <strong>domain constraint</strong> specifies that each attribute value must be from the attribute's domain (or NULL if allowed).</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Domain constraints in SQL</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">   </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">       </span><span class="c1">-- domain + NOT NULL</span>
<span class="w">    </span><span class="k">year</span><span class="w">        </span><span class="nb">SMALLINT</span><span class="w">      </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">gpa</span><span class="w">         </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">email</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">  </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%@%.%&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- Domain constraint violation examples:</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">85</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alice@univ.edu&#39;</span><span class="p">);</span>
<span class="c1">-- ERROR: year=5 violates CHECK constraint (year BETWEEN 1 AND 4)</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alice@univ.edu&#39;</span><span class="p">);</span>
<span class="c1">-- ERROR: gpa=4.50 violates CHECK constraint (gpa &lt;= 4.0)</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">85</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alice@univ.edu&#39;</span><span class="p">);</span>
<span class="c1">-- ERROR: name is NOT NULL</span>
</code></pre></div>

<h3 id="entity-integrity-constraint">Entity Integrity Constraint<a class="header-link" href="#entity-integrity-constraint" title="Permanent link">&para;</a></h3>
<p>The <strong>entity integrity constraint</strong> states that no primary key attribute can be NULL.</p>
<div class="highlight"><pre><span></span><code><span class="k">Rule</span><span class="err">:</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="n">A2</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">Ak</span><span class="err">}</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">R</span><span class="p">,</span>
<span class="w">      </span><span class="k">then</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">t</span><span class="o">[</span><span class="n">Ai</span><span class="o">]</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="k">NULL</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">k</span>

<span class="nl">Rationale</span><span class="p">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">uniquely</span><span class="w"> </span><span class="n">identifies</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">tuple</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">distinguish</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">others</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="w"> </span><span class="n">compared</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">anything</span><span class="w"> </span><span class="n">yields</span><span class="w"> </span><span class="k">UNKNOWN</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Therefore</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">identification</span><span class="w"> </span><span class="n">impossible</span>

<span class="nl">Example</span><span class="p">:</span>
<span class="w">  </span><span class="n">ENROLLMENT</span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">,</span><span class="w"> </span><span class="n">grade</span><span class="p">)</span>
<span class="w">             </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
<span class="w">             </span><span class="n">Composite</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">NONE</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">NULL</span>

<span class="w">  </span><span class="nl">Valid</span><span class="p">:</span><span class="w">   </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS301&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fall2025&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="nl">Invalid</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fall2025&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w">     </span><span class="c1">-- course_id is part of PK</span>
<span class="w">  </span><span class="nl">Valid</span><span class="p">:</span><span class="w">   </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS301&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fall2025&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="w">  </span><span class="c1">-- grade is NOT part of PK</span>
</code></pre></div>

<h3 id="referential-integrity-constraint">Referential Integrity Constraint<a class="header-link" href="#referential-integrity-constraint" title="Permanent link">&para;</a></h3>
<p>The <strong>referential integrity constraint</strong> ensures that foreign key values match existing primary key values in the referenced relation (or are NULL).</p>
<div class="highlight"><pre><span></span><code><span class="k">Rule</span><span class="err">:</span><span class="w"> </span><span class="k">For</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">R1</span><span class="p">)</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">foreign</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">FK</span><span class="w"> </span><span class="k">referencing</span><span class="w"> </span><span class="nl">R2</span><span class="p">:</span>
<span class="w">      </span><span class="n">Either</span><span class="w"> </span><span class="n">t1</span><span class="o">[</span><span class="n">FK</span><span class="o">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">NULL</span>
<span class="w">      </span><span class="ow">Or</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="ow">exists</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">R2</span><span class="p">)</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">t1</span><span class="o">[</span><span class="n">FK</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="o">[</span><span class="n">PK</span><span class="o">]</span>

<span class="nl">Example</span><span class="p">:</span>

<span class="w">  </span><span class="nl">STUDENT</span><span class="p">:</span><span class="w">                           </span><span class="nl">COURSE</span><span class="p">:</span>
<span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”</span><span class="w">                    </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">S001</span><span class="w"> </span><span class="err">â”‚</span><span class="n">Alice</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="n">CS101</span><span class="w"> </span><span class="err">â”‚</span><span class="n">Intro</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">â”‚</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">S002</span><span class="w"> </span><span class="err">â”‚</span><span class="n">Bob</span><span class="w">   </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="n">CS301</span><span class="w"> </span><span class="err">â”‚</span><span class="n">DB</span><span class="w"> </span><span class="n">Theory</span><span class="w">  </span><span class="err">â”‚</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">S003</span><span class="w"> </span><span class="err">â”‚</span><span class="n">Carol</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="n">MA201</span><span class="w"> </span><span class="err">â”‚</span><span class="n">Lin</span><span class="w"> </span><span class="n">Alg</span><span class="w">    </span><span class="err">â”‚</span>
<span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                    </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="w">  </span><span class="nl">ENROLLMENT</span><span class="p">:</span>
<span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="w">  </span><span class="err">â”‚</span><span class="n">stu_id</span><span class="w">  </span><span class="err">â”‚</span><span class="n">course_id</span><span class="err">â”‚</span><span class="w"> </span><span class="n">grade</span><span class="w"> </span><span class="err">â”‚</span>
<span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">S001</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">CS101</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="n">A</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="n">S001</span><span class="w"> </span><span class="ow">exists</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">STUDENT</span><span class="p">,</span><span class="w"> </span><span class="n">CS101</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">COURSE</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">S002</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">CS301</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="n">B</span><span class="o">+</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="n">S002</span><span class="w"> </span><span class="ow">exists</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">STUDENT</span><span class="p">,</span><span class="w"> </span><span class="n">CS301</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">COURSE</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">S004</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">CS101</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="n">A</span><span class="o">-</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="n">S004</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">STUDENT</span><span class="err">!</span>
<span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">S003</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">CS999</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="n">B</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="n">CS999</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">COURSE</span><span class="err">!</span>
<span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="referential-integrity-actions">Referential Integrity Actions<a class="header-link" href="#referential-integrity-actions" title="Permanent link">&para;</a></h3>
<p>When a referenced tuple is deleted or updated, the DBMS must handle the orphaned foreign keys:</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">enrollment</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">semester</span><span class="w">    </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="n">grade</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>

<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">),</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">student</span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">           </span><span class="c1">-- Delete enrollment if student deleted</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">          </span><span class="c1">-- Update FK if student PK changes</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">course</span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w">          </span><span class="c1">-- Prevent course deletion if enrolled</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">           </span><span class="c1">-- Update FK if course PK changes</span>
<span class="p">);</span>
</code></pre></div>

<table>
<thead>
<tr>
<th>Action</th>
<th>Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CASCADE</strong></td>
<td>Propagate the delete/update to referencing tuples</td>
</tr>
<tr>
<td><strong>RESTRICT</strong> (or NO ACTION)</td>
<td>Reject the delete/update if referencing tuples exist</td>
</tr>
<tr>
<td><strong>SET NULL</strong></td>
<td>Set foreign key to NULL in referencing tuples</td>
</tr>
<tr>
<td><strong>SET DEFAULT</strong></td>
<td>Set foreign key to its default value</td>
</tr>
</tbody>
</table>
<h3 id="referential-integrity-action-examples">Referential Integrity Action Examples<a class="header-link" href="#referential-integrity-action-examples" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Scenario</span><span class="o">:</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="n">WHERE</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;S001&#39;</span><span class="o">;</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">CASCADE</span><span class="o">:</span>
<span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="n">All</span><span class="w"> </span><span class="n">enrollments</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">S001</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">deleted</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">RESTRICT</span><span class="o">:</span>
<span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">rejected</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">S001</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">enrollments</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">SET</span><span class="w"> </span><span class="n">NULL</span><span class="o">:</span>
<span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="n">enrollment</span><span class="o">.</span><span class="na">student_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kd">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">S001</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">rows</span>
<span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="o">(</span><span class="n">Only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enrollment</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="err">â€”</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">part</span>
<span class="w">     </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">PK</span><span class="o">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">SET</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">violate</span><span class="w"> </span><span class="n">entity</span><span class="w"> </span><span class="n">integrity</span><span class="o">!)</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">SET</span><span class="w"> </span><span class="n">DEFAULT</span><span class="o">:</span>
<span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="n">enrollment</span><span class="o">.</span><span class="na">student_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kd">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span>
</code></pre></div>

<h3 id="key-constraints">Key Constraints<a class="header-link" href="#key-constraints" title="Permanent link">&para;</a></h3>
<p>Additional constraints enforced through key declarations:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- UNIQUE constraint: alternate key</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">     </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">email</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- alternate key</span>
<span class="w">    </span><span class="n">ssn</span><span class="w">         </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w">     </span><span class="k">UNIQUE</span><span class="w">            </span><span class="c1">-- another alternate key (nullable)</span>
<span class="p">);</span>

<span class="c1">-- Composite UNIQUE constraint</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">course_offering</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">offering_id</span><span class="w">   </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">          </span><span class="c1">-- surrogate key</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">     </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">semester</span><span class="w">      </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">instructor_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">)</span><span class="w">                </span><span class="c1">-- natural key constraint</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="general-constraints-semantic-constraints">General Constraints (Semantic Constraints)<a class="header-link" href="#general-constraints-semantic-constraints" title="Permanent link">&para;</a></h3>
<p>Constraints that cannot be expressed by domain, key, or referential constraints alone:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- CHECK constraint (tuple-level)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="w">      </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">credits</span><span class="w">    </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">credits</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">max_seats</span><span class="w">  </span><span class="nb">INT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">max_seats</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">min_seats</span><span class="w">  </span><span class="nb">INT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">min_seats</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">seats_check</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">max_seats</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">min_seats</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- ASSERTION (cross-table constraint, SQL standard but rarely implemented)</span>
<span class="c1">-- &quot;No student can be enrolled in more than 7 courses per semester&quot;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">ASSERTION</span><span class="w"> </span><span class="n">max_courses_per_semester</span>
<span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span>
<span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">enrollment</span>
<span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span>
<span class="w">        </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">7</span>
<span class="w">    </span><span class="p">));</span>

<span class="c1">-- In practice, use TRIGGERS for cross-table constraints:</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">check_max_courses</span><span class="p">()</span>
<span class="k">RETURNS</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">enrollment</span>
<span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NEW</span><span class="p">.</span><span class="n">student_id</span>
<span class="w">        </span><span class="k">AND</span><span class="w"> </span><span class="n">semester</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NEW</span><span class="p">.</span><span class="n">semester</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="n">RAISE</span><span class="w"> </span><span class="k">EXCEPTION</span><span class="w"> </span><span class="s1">&#39;Student cannot enroll in more than 7 courses per semester&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="k">NEW</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">trg_max_courses</span>
<span class="w">    </span><span class="k">BEFORE</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">enrollment</span>
<span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">check_max_courses</span><span class="p">();</span>
</code></pre></div>

<h3 id="constraint-summary">Constraint Summary<a class="header-link" href="#constraint-summary" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nx">Integrity</span><span class="w"> </span><span class="nx">Constraints</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Inherent</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="nx">Constraints</span><span class="w"> </span><span class="p">(</span><span class="nx">built</span><span class="w"> </span><span class="nx">into</span><span class="w"> </span><span class="nx">relational</span><span class="w"> </span><span class="nx">model</span><span class="p">):</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">duplicate</span><span class="w"> </span><span class="nx">tuples</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Atomic</span><span class="w"> </span><span class="nx">attribute</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="nx">NF</span><span class="p">)</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Schema</span><span class="o">-</span><span class="nx">Based</span><span class="w"> </span><span class="nx">Constraints</span><span class="w"> </span><span class="p">(</span><span class="nx">DDL</span><span class="p">):</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Domain</span><span class="w"> </span><span class="nx">constraints</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="nx">CHECK</span><span class="p">)</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Key</span><span class="w"> </span><span class="nx">constraints</span><span class="w"> </span><span class="p">(</span><span class="nx">PRIMARY</span><span class="w"> </span><span class="nx">KEY</span><span class="p">,</span><span class="w"> </span><span class="nx">UNIQUE</span><span class="p">)</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Entity</span><span class="w"> </span><span class="nx">integrity</span><span class="w"> </span><span class="p">(</span><span class="nx">PK</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="nx">NULL</span><span class="p">)</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Referential</span><span class="w"> </span><span class="nx">integrity</span><span class="w"> </span><span class="p">(</span><span class="nx">FOREIGN</span><span class="w"> </span><span class="nx">KEY</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="nx">NULL</span><span class="w"> </span><span class="nx">constraints</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Application</span><span class="o">-</span><span class="nx">Based</span><span class="w"> </span><span class="nx">Constraints</span><span class="w"> </span><span class="p">(</span><span class="nx">business</span><span class="w"> </span><span class="nx">rules</span><span class="p">):</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Triggers</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Application</span><span class="w"> </span><span class="nx">logic</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">Assertions</span><span class="w"> </span><span class="p">(</span><span class="nx">rarely</span><span class="w"> </span><span class="nx">supported</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">SQL</span><span class="p">)</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="6-relational-schema-notation">6. Relational Schema Notation<a class="header-link" href="#6-relational-schema-notation" title="Permanent link">&para;</a></h2>
<p>There are several standard ways to represent relational schemas in documentation and textbooks.</p>
<h3 id="textual-notation">Textual Notation<a class="header-link" href="#textual-notation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>STUDENT(student_id, name, year, gpa)
  PK: student_id
  FK: (none)

COURSE(course_id, title, credits, dept_id)
  PK: course_id
  FK: dept_id â†’ DEPARTMENT(dept_id)

ENROLLMENT(student_id, course_id, semester, grade)
  PK: (student_id, course_id, semester)
  FK: student_id â†’ STUDENT(student_id)
      course_id â†’ COURSE(course_id)

DEPARTMENT(dept_id, dept_name, building, budget)
  PK: dept_id

INSTRUCTOR(instructor_id, name, dept_id, salary)
  PK: instructor_id
  FK: dept_id â†’ DEPARTMENT(dept_id)
</code></pre></div>

<h3 id="underline-convention">Underline Convention<a class="header-link" href="#underline-convention" title="Permanent link">&para;</a></h3>
<p>Primary key attributes are underlined (shown with underscores here):</p>
<div class="highlight"><pre><span></span><code>STUDENT(_student_id_, name, year, gpa)
COURSE(_course_id_, title, credits, dept_id*)
ENROLLMENT(_student_id*_, _course_id*_, <span class="ge">_semester_</span>, grade)
DEPARTMENT(_dept_id_, dept_name, building, budget)
INSTRUCTOR(_instructor_id_, name, dept_id*, salary)

Convention:
  <span class="ge">_underline_</span> = primary key attribute
  <span class="k">*</span> = foreign key attribute
</code></pre></div>

<h3 id="diagrammatic-notation">Diagrammatic Notation<a class="header-link" href="#diagrammatic-notation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DEPARTMENT     â”‚     â”‚    INSTRUCTOR     â”‚     â”‚      COURSE      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK dept_id       â”‚â—„â”€â”€â”€â”€â”‚ PK instructor_id â”‚     â”‚ PK course_id     â”‚
â”‚    dept_name     â”‚     â”‚    name          â”‚     â”‚    title         â”‚
â”‚    building      â”‚     â”‚ FK dept_id    â”€â”€â”€â”˜     â”‚    credits       â”‚
â”‚    budget        â”‚     â”‚    salary       â”‚     â”‚ FK dept_id    â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                           â”‚
                                                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     STUDENT      â”‚     â”‚     ENROLLMENT       â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚ PK student_id    â”‚â—„â”€â”€â”€â”€â”‚ PK,FK student_id  â”€â”€â”€â”˜         â”‚
â”‚    name          â”‚     â”‚ PK,FK course_id   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    year          â”‚     â”‚ PK    semester     â”‚
â”‚    gpa           â”‚     â”‚       grade        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="sql-ddl-as-schema-definition">SQL DDL as Schema Definition<a class="header-link" href="#sql-ddl-as-schema-definition" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Complete schema definition in SQL</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">     </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_name</span><span class="w">   </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">building</span><span class="w">    </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
<span class="w">    </span><span class="n">budget</span><span class="w">      </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">budget</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">instructor</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">instructor_id</span><span class="w">  </span><span class="nb">SERIAL</span><span class="w">       </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w">           </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">        </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">salary</span><span class="w">         </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">department</span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">year</span><span class="w">        </span><span class="nb">SMALLINT</span><span class="w">     </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">gpa</span><span class="w">         </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">      </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">credits</span><span class="w">     </span><span class="nb">SMALLINT</span><span class="w">     </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">credits</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">     </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">department</span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">enrollment</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">semester</span><span class="w">    </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">grade</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">student</span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">course</span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="p">);</span>
</code></pre></div>

<hr />
<h2 id="7-null-semantics-and-three-valued-logic">7. NULL Semantics and Three-Valued Logic<a class="header-link" href="#7-null-semantics-and-three-valued-logic" title="Permanent link">&para;</a></h2>
<p>NULL is one of the most subtle and frequently misunderstood concepts in the relational model. Understanding NULL semantics is critical for writing correct queries.</p>
<h3 id="what-null-represents">What NULL Represents<a class="header-link" href="#what-null-represents" title="Permanent link">&para;</a></h3>
<p>NULL is <strong>not a value</strong>. It is a <strong>marker</strong> indicating:</p>
<table>
<thead>
<tr>
<th>Meaning</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Missing</strong> (value exists but is unknown)</td>
<td>A student's phone number not yet recorded</td>
</tr>
<tr>
<td><strong>Inapplicable</strong> (no value makes sense)</td>
<td>Apartment number for a student living in a house</td>
</tr>
<tr>
<td><strong>Withheld</strong> (value exists but is not disclosed)</td>
<td>Salary of a colleague</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code>IMPORTANT DISTINCTION:
  NULL â‰  0       (zero is a known value)
  NULL â‰  &#39;&#39;      (empty string is a known value)
  NULL â‰  FALSE   (false is a known boolean value)
  NULL â‰  NULL    (NULL compared to NULL is UNKNOWN, not TRUE!)
</code></pre></div>

<h3 id="three-valued-logic-3vl">Three-Valued Logic (3VL)<a class="header-link" href="#three-valued-logic-3vl" title="Permanent link">&para;</a></h3>
<p>Standard Boolean logic has two values: TRUE and FALSE. SQL uses <strong>three-valued logic</strong> with TRUE, FALSE, and <strong>UNKNOWN</strong>.</p>
<p>Any comparison involving NULL produces UNKNOWN:</p>
<div class="highlight"><pre><span></span><code><span class="mf">5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">3</span><span class="w">        </span><span class="err">â†’</span><span class="w"> </span><span class="n">TRUE</span>
<span class="mf">5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">7</span><span class="w">        </span><span class="err">â†’</span><span class="w"> </span><span class="n">FALSE</span>
<span class="mf">5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">NULL</span><span class="w">     </span><span class="err">â†’</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">NULL</span><span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="w">     </span><span class="err">â†’</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mf">5</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">UNKNOWN</span>
</code></pre></div>

<h3 id="truth-tables-for-3vl">Truth Tables for 3VL<a class="header-link" href="#truth-tables-for-3vl" title="Permanent link">&para;</a></h3>
<p><strong>AND:</strong></p>
<div class="highlight"><pre><span></span><code><span class="w">         </span><span class="n">â”‚</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="n">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="no">TRUE</span><span class="w">     </span><span class="n">â”‚</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="no">FALSE</span><span class="w">    </span><span class="n">â”‚</span><span class="w">  </span><span class="no">FALSE</span><span class="w">    </span><span class="no">FALSE</span><span class="w">    </span><span class="no">FALSE</span>
<span class="no">UNKNOWN</span><span class="w">  </span><span class="n">â”‚</span><span class="w">  </span><span class="no">UNKNOWN</span><span class="w">  </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
</code></pre></div>

<p><strong>OR:</strong></p>
<div class="highlight"><pre><span></span><code><span class="w">         </span><span class="n">â”‚</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="n">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="no">TRUE</span><span class="w">     </span><span class="n">â”‚</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">TRUE</span><span class="w">     </span><span class="no">TRUE</span>
<span class="no">FALSE</span><span class="w">    </span><span class="n">â”‚</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="no">UNKNOWN</span><span class="w">  </span><span class="n">â”‚</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">UNKNOWN</span><span class="w">  </span><span class="no">UNKNOWN</span>
</code></pre></div>

<p><strong>NOT:</strong></p>
<div class="highlight"><pre><span></span><code>NOT TRUE    â†’ FALSE
NOT FALSE   â†’ TRUE
NOT UNKNOWN â†’ UNKNOWN
</code></pre></div>

<h3 id="implications-for-sql-queries">Implications for SQL Queries<a class="header-link" href="#implications-for-sql-queries" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Setup</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>

<span class="c1">-- Query 1: WHERE value = 10</span>
<span class="c1">-- Returns: {(1, 10)}</span>
<span class="c1">-- Row (3, NULL): NULL = 10 â†’ UNKNOWN â†’ row excluded</span>

<span class="c1">-- Query 2: WHERE value &lt;&gt; 10</span>
<span class="c1">-- Returns: {(2, 20)}</span>
<span class="c1">-- Row (3, NULL): NULL &lt;&gt; 10 â†’ UNKNOWN â†’ row EXCLUDED!</span>
<span class="c1">-- SURPRISE: Neither &quot;value = 10&quot; nor &quot;value &lt;&gt; 10&quot; returns the NULL row!</span>

<span class="c1">-- Query 3: WHERE value = NULL</span>
<span class="c1">-- Returns: EMPTY SET!</span>
<span class="c1">-- NULL = NULL â†’ UNKNOWN â†’ all rows with NULL excluded</span>
<span class="c1">-- THIS IS A COMMON BUG. Use IS NULL instead.</span>

<span class="c1">-- Query 4: WHERE value IS NULL</span>
<span class="c1">-- Returns: {(3, NULL)}</span>
<span class="c1">-- IS NULL is a special operator that checks for NULL correctly</span>

<span class="c1">-- Query 5: WHERE value IS NOT NULL</span>
<span class="c1">-- Returns: {(1, 10), (2, 20)}</span>
</code></pre></div>

<h3 id="null-in-aggregates">NULL in Aggregates<a class="header-link" href="#null-in-aggregates" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- NULL behavior in aggregate functions</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">scores</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">scores</span><span class="w"> </span><span class="k">VALUES</span>
<span class="w">    </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S002&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S003&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S004&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">70</span><span class="p">);</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 4 (counts all rows)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 3 (NULLs excluded)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 240 (NULLs excluded)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 80 (240/3, NULLs excluded)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 70 (NULLs excluded)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 90 (NULLs excluded)</span>

<span class="c1">-- IMPORTANT: AVG(score) = 80, NOT 60!</span>
<span class="c1">-- AVG ignores NULLs, so it computes 240/3 = 80, not 240/4 = 60</span>
<span class="c1">-- If you want NULLs treated as 0:</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="k">COALESCE</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 60 (240/4)</span>
</code></pre></div>

<h3 id="null-in-boolean-expressions">NULL in Boolean Expressions<a class="header-link" href="#null-in-boolean-expressions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- The WHERE clause only keeps rows where the condition is TRUE</span>
<span class="c1">-- Rows where the condition is FALSE or UNKNOWN are filtered out</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
<span class="c1">-- If gpa IS NULL: NULL &gt; 3.5 â†’ UNKNOWN â†’ row excluded</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
<span class="c1">-- If gpa IS NULL:</span>
<span class="c1">--   NULL &gt; 3.5 â†’ UNKNOWN</span>
<span class="c1">--   NULL &lt;= 3.5 â†’ UNKNOWN</span>
<span class="c1">--   UNKNOWN OR UNKNOWN â†’ UNKNOWN</span>
<span class="c1">--   Row EXCLUDED even though logically gpa &gt; 3.5 OR gpa &lt;= 3.5</span>
<span class="c1">--   should cover all cases!</span>

<span class="c1">-- To include NULLs:</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
</code></pre></div>

<h3 id="null-in-distinct-and-group-by">NULL in DISTINCT and GROUP BY<a class="header-link" href="#null-in-distinct-and-group-by" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- In DISTINCT and GROUP BY, NULLs are considered equal</span>
<span class="c1">-- (This is an exception to &quot;NULL â‰  NULL&quot;)</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">instructor</span><span class="p">;</span>
<span class="c1">-- If multiple instructors have dept = NULL,</span>
<span class="c1">-- only ONE NULL appears in the result</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">dept</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">instructor</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">dept</span><span class="p">;</span>
<span class="c1">-- All rows with dept = NULL are grouped together</span>
</code></pre></div>

<h3 id="null-in-joins">NULL in Joins<a class="header-link" href="#null-in-joins" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- NULL values NEVER match in joins</span>

<span class="c1">-- STUDENT: (S001, &#39;Alice&#39;, &#39;CS&#39;), (S002, &#39;Bob&#39;, NULL)</span>
<span class="c1">-- DEPARTMENT: (&#39;CS&#39;, &#39;Computer Science&#39;), (&#39;EE&#39;, &#39;Electrical Engineering&#39;)</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">dept_name</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="n">s</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">dept_id</span><span class="p">;</span>

<span class="c1">-- Result: Only (&#39;Alice&#39;, &#39;Computer Science&#39;)</span>
<span class="c1">-- Bob is excluded because NULL = &#39;CS&#39; â†’ UNKNOWN, NULL = &#39;EE&#39; â†’ UNKNOWN</span>
</code></pre></div>

<h3 id="coalesce-and-nullif">COALESCE and NULLIF<a class="header-link" href="#coalesce-and-nullif" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- COALESCE: Return first non-NULL argument</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">phone</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No contact info&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">contact</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="p">;</span>
<span class="c1">-- If phone is NULL and email is &#39;alice@univ.edu&#39;:</span>
<span class="c1">--   returns &#39;alice@univ.edu&#39;</span>
<span class="c1">-- If both are NULL:</span>
<span class="c1">--   returns &#39;No contact info&#39;</span>

<span class="c1">-- NULLIF: Return NULL if two values are equal</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">NULLIF</span><span class="p">(</span><span class="n">actual_score</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">adjusted_score</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">test_results</span><span class="p">;</span>
<span class="c1">-- If actual_score = 0: returns NULL (treat 0 as unknown)</span>
<span class="c1">-- If actual_score = 85: returns 85</span>
</code></pre></div>

<h3 id="best-practices-for-nulls">Best Practices for NULLs<a class="header-link" href="#best-practices-for-nulls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nl">DO:</span>
<span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">IS</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">IS</span><span class="w"> </span><span class="n">NOT</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">checks</span>
<span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">COALESCE</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">values</span>
<span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="n">Consider</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">writing</span><span class="w"> </span><span class="n">WHERE</span><span class="w"> </span><span class="n">clauses</span>
<span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="n">Be</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">aggregate</span><span class="w"> </span><span class="n">queries</span>
<span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="n">Document</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">NULLs</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">why</span>

<span class="n">DON</span><span class="p">&#39;</span><span class="nl">T:</span>
<span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="p">(</span><span class="k">always</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">UNKNOWN</span><span class="p">)</span>
<span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="n">Assume</span><span class="w"> </span><span class="n">AVG</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">NULLs</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">zeros</span>
<span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="n">Forget</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">UNKNOWN</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">exclude</span><span class="w"> </span><span class="n">rows</span>
<span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="n">Allow</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">primary</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">columns</span>
<span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">meaningful</span><span class="w"> </span><span class="n">business</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">(</span><span class="n">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">instead</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8-relational-model-in-practice">8. Relational Model in Practice<a class="header-link" href="#8-relational-model-in-practice" title="Permanent link">&para;</a></h2>
<h3 id="python-implementation-of-relational-concepts">Python Implementation of Relational Concepts<a class="header-link" href="#python-implementation-of-relational-concepts" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Simplified implementation of relational model concepts in Python.</span>
<span class="sd">For educational purposes only.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Domain</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a domain (set of allowed values).&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">check_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_fn</span> <span class="o">=</span> <span class="n">check_fn</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># NULL is allowed unless explicitly constrained</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Relation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simplified relation (table) with constraint checking.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attributes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">primary_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">domains</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span> <span class="o">=</span> <span class="n">attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span> <span class="o">=</span> <span class="n">primary_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domains</span> <span class="o">=</span> <span class="n">domains</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert a tuple with constraint checking.&quot;&quot;&quot;</span>
        <span class="c1"># Check: all attributes present</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Entity integrity: PK cannot be NULL</span>
        <span class="k">for</span> <span class="n">pk_attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">pk_attr</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Entity integrity violation: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;PK attribute &#39;</span><span class="si">{</span><span class="n">pk_attr</span><span class="si">}</span><span class="s2">&#39; cannot be NULL&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Domain constraints</span>
        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">domain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">domain</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Domain violation: </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;not in domain </span><span class="si">{</span><span class="n">domain</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Key constraint: no duplicate PK</span>
        <span class="n">pk_values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">existing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span>
            <span class="n">existing_pk</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">existing</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pk_values</span> <span class="o">==</span> <span class="n">existing_pk</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Key violation: duplicate PK </span><span class="si">{</span><span class="n">pk_values</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select tuples matching a predicate (sigma operation).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span> <span class="k">if</span> <span class="n">predicate</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Project onto given attributes (pi operation).&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span>
            <span class="n">projected</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">projected</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">attrs</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">)</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NULL&#39;</span><span class="p">))</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span>
            <span class="p">)</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="c1"># --- Demonstration ---</span>

<span class="c1"># Define domains</span>
<span class="n">gpa_domain</span> <span class="o">=</span> <span class="n">Domain</span><span class="p">(</span><span class="s2">&quot;GPA&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="n">year_domain</span> <span class="o">=</span> <span class="n">Domain</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">})</span>

<span class="c1"># Create relation</span>
<span class="n">student</span> <span class="o">=</span> <span class="n">Relation</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;STUDENT&quot;</span><span class="p">,</span>
    <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;student_id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">],</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;student_id&quot;</span><span class="p">],</span>
    <span class="n">domains</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="n">gpa_domain</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">year_domain</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Insert valid tuples</span>
<span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S001&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.85</span><span class="p">})</span>
<span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S002&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.42</span><span class="p">})</span>
<span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S003&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Carol&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">student</span><span class="p">)</span>

<span class="c1"># Entity integrity violation</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dave&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">})</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caught: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Domain constraint violation</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S004&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Eve&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">})</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caught: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Key constraint violation</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S001&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Frank&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">})</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caught: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Selection</span>
<span class="n">honors</span> <span class="o">=</span> <span class="n">student</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;gpa&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;gpa&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Honors students:&quot;</span><span class="p">,</span> <span class="n">honors</span><span class="p">)</span>

<span class="c1"># Projection</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">student</span><span class="o">.</span><span class="n">project</span><span class="p">([</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Names and years:&quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</code></pre></div>

<h3 id="common-relational-model-misconceptions">Common Relational Model Misconceptions<a class="header-link" href="#common-relational-model-misconceptions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Misconception                          Reality
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&quot;Tables are relations&quot;                 SQL tables are multisets, not sets
                                       (they allow duplicates)

&quot;Column order matters&quot;                 In the formal model, it does not
                                       (SQL preserves declaration order)

&quot;NULL means empty or zero&quot;             NULL means unknown, inapplicable,
                                       or missing â€” NOT empty/zero

&quot;Every table must have an              The model requires a primary key,
 auto-increment ID&quot;                    but it can be any candidate key

&quot;Foreign keys must reference           FKs reference PRIMARY keys
 any column&quot;                           (or UNIQUE keys in practice)

&quot;Relational = SQL&quot;                     SQL deviates from the relational
                                       model in several ways (duplicates,
                                       NULL handling, bag semantics)
</code></pre></div>

<hr />
<h2 id="9-exercises">9. Exercises<a class="header-link" href="#9-exercises" title="Permanent link">&para;</a></h2>
<h3 id="conceptual-questions">Conceptual Questions<a class="header-link" href="#conceptual-questions" title="Permanent link">&para;</a></h3>
<p><strong>Exercise 2.1</strong>: State Codd's 12 rules in your own words. For each rule, give an example of a DBMS feature that satisfies it.</p>
<p><strong>Exercise 2.2</strong>: Explain the difference between:
- (a) Superkey and candidate key
- (b) Primary key and alternate key
- (c) Natural key and surrogate key
- (d) Entity integrity and referential integrity</p>
<p><strong>Exercise 2.3</strong>: Why does the relational model prohibit NULL values in primary keys? What problems would arise if this restriction were relaxed?</p>
<p><strong>Exercise 2.4</strong>: Explain why NULL = NULL evaluates to UNKNOWN in SQL, not TRUE. Describe a scenario where treating NULL = NULL as TRUE would produce incorrect query results.</p>
<h3 id="schema-design-questions">Schema Design Questions<a class="header-link" href="#schema-design-questions" title="Permanent link">&para;</a></h3>
<p><strong>Exercise 2.5</strong>: Given the following requirements for a library system, identify all relations, their attributes, primary keys, foreign keys, and domain constraints:</p>
<ul>
<li>The library has books, each with an ISBN, title, author(s), publisher, year, and number of copies</li>
<li>Members have a member ID, name, address, and phone number</li>
<li>Members can borrow books. Each loan records the member, the book, the loan date, due date, and return date</li>
<li>Each book belongs to one or more categories (e.g., Fiction, Science, History)</li>
</ul>
<p><strong>Exercise 2.6</strong>: For the following relation schema, identify all candidate keys:</p>
<div class="highlight"><pre><span></span><code>FLIGHT(flight_number, airline, departure_city, arrival_city,
       departure_time, arrival_time, gate, aircraft_id)

Constraints:
  <span class="k">-</span> A flight number uniquely identifies a flight
  <span class="k">-</span> An aircraft can only be at one gate at a time
  <span class="k">-</span> A gate can only have one aircraft at a time
</code></pre></div>

<p><strong>Exercise 2.7</strong>: Given this schema, identify and fix all integrity constraint violations:</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">emp_id</span><span class="w">    </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w">      </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">department</span><span class="p">(</span><span class="n">dept_id</span><span class="p">),</span>
<span class="w">    </span><span class="n">salary</span><span class="w">    </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="n">mgr_id</span><span class="w">    </span><span class="nb">INT</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">employee</span><span class="p">(</span><span class="n">emp_id</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- Attempted inserts:</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">75000</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Computer Science&#39;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">60000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Carol&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;EE01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">65000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Dave&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">55000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</code></pre></div>

<h3 id="sql-and-null-questions">SQL and NULL Questions<a class="header-link" href="#sql-and-null-questions" title="Permanent link">&para;</a></h3>
<p><strong>Exercise 2.8</strong>: Predict the output of each query. Explain your reasoning.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">);</span>

<span class="c1">-- (a)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>

<span class="c1">-- (b)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>

<span class="c1">-- (c)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>

<span class="c1">-- (d)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="c1">-- (e)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>

<span class="c1">-- (f)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
</code></pre></div>

<p><strong>Exercise 2.9</strong>: Write SQL queries that correctly handle NULLs for the following:</p>
<p>Given <code>EMPLOYEE(emp_id, name, dept, salary, bonus)</code> where <code>bonus</code> can be NULL:</p>
<ul>
<li>(a) Find employees whose total compensation (salary + bonus) exceeds 100,000</li>
<li>(b) Find the average bonus, treating NULL bonuses as 0</li>
<li>(c) Find departments where ALL employees have a non-NULL bonus</li>
<li>(d) Find employees who have a different bonus from employee 'E001' (including NULLs)</li>
</ul>
<h3 id="design-exercise">Design Exercise<a class="header-link" href="#design-exercise" title="Permanent link">&para;</a></h3>
<p><strong>Exercise 2.10</strong>: Design a relational schema for an online bookstore with the following requirements:</p>
<ul>
<li>Books have ISBN, title, price, publication date, and page count</li>
<li>Authors have an ID, name, and biography. A book can have multiple authors, and an author can write multiple books</li>
<li>Customers have an ID, name, email, and shipping address</li>
<li>Customers can place orders. Each order has an order ID, order date, and status</li>
<li>Each order contains one or more books with quantities</li>
<li>Customers can write reviews for books (rating 1-5, text, date)</li>
</ul>
<p>For your schema, provide:
1. All relation schemas with primary and foreign keys
2. Domain constraints for each attribute
3. Any additional integrity constraints (as CHECK or written in English)
4. Example valid and invalid tuples for at least two relations</p>
<hr />
<p><strong>Previous</strong>: <a href="./01_Introduction_to_Database_Systems.md">Introduction to Database Systems</a> | <strong>Next</strong>: <a href="./03_Relational_Algebra.md">Relational Algebra</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Database_Theory/01_Introduction_to_Database_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Introduction to Database Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Database_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Database_Theory/03_Relational_Algebra.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Relational Algebra</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}