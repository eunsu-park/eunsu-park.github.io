{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>29. Generative Adversarial Networks (GAN) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Deep_Learning/">Deep Learning</a>
    <span class="separator">/</span>
    <span class="current">29. Generative Adversarial Networks (GAN)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>29. Generative Adversarial Networks (GAN)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Deep_Learning/28_Generative_Models_GAN.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">28. Generative Models - GAN (Generative Adversarial Networks)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Deep_Learning/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Deep_Learning/30_Generative_Models_VAE.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">30. Generative Models - VAE (Variational Autoencoder)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#mathematical-background">Mathematical Background</a><ul>
<li><a href="#1-minimax-game">1. Minimax Game</a></li>
<li><a href="#2-training-dynamics">2. Training Dynamics</a></li>
<li><a href="#3-loss-functions">3. Loss Functions</a></li>
</ul>
</li>
<li><a href="#dcgan-architecture">DCGAN Architecture</a><ul>
<li><a href="#generator-6464-rgb-images">Generator (64Ã—64 RGB images)</a></li>
<li><a href="#discriminator-6464-rgb-images">Discriminator (64Ã—64 RGB images)</a></li>
<li><a href="#dcgan-guidelines">DCGAN Guidelines</a></li>
</ul>
</li>
<li><a href="#training-techniques">Training Techniques</a><ul>
<li><a href="#1-label-smoothing">1. Label Smoothing</a></li>
<li><a href="#2-feature-matching">2. Feature Matching</a></li>
<li><a href="#3-minibatch-discrimination">3. Minibatch Discrimination</a></li>
<li><a href="#4-spectral-normalization">4. Spectral Normalization</a></li>
<li><a href="#5-progressive-growing">5. Progressive Growing</a></li>
</ul>
</li>
<li><a href="#mode-collapse">Mode Collapse</a><ul>
<li><a href="#1-what-is-mode-collapse">1. What is Mode Collapse?</a></li>
<li><a href="#2-detecting-mode-collapse">2. Detecting Mode Collapse</a></li>
<li><a href="#3-mitigation-strategies">3. Mitigation Strategies</a></li>
</ul>
</li>
<li><a href="#file-structure">File Structure</a></li>
<li><a href="#core-concepts">Core Concepts</a><ul>
<li><a href="#1-gan-variants">1. GAN Variants</a></li>
<li><a href="#2-evaluation-metrics">2. Evaluation Metrics</a></li>
<li><a href="#3-training-tips">3. Training Tips</a></li>
</ul>
</li>
<li><a href="#implementation-levels">Implementation Levels</a><ul>
<li><a href="#level-2-pytorch-low-level-pytorch_lowlevel">Level 2: PyTorch Low-Level (pytorch_lowlevel/)</a></li>
<li><a href="#level-3-paper-implementation-paper">Level 3: Paper Implementation (paper/)</a></li>
</ul>
</li>
<li><a href="#training-loop">Training Loop</a></li>
<li><a href="#sampling">Sampling</a></li>
<li><a href="#learning-checklist">Learning Checklist</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <p><a href="./28_Generative_Models_GAN.md">Previous: Generative Models - GAN</a> | <a href="./30_Generative_Models_VAE.md">Next: Generative Models - VAE</a></p>
<hr />
<h1 id="29-generative-adversarial-networks-gan">29. Generative Adversarial Networks (GAN)<a class="header-link" href="#29-generative-adversarial-networks-gan" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>Generative Adversarial Networks (GAN) learn to generate realistic data through an adversarial game between a Generator and a Discriminator. "Generative Adversarial Networks" (Goodfellow et al., 2014)</p>
<hr />
<h2 id="mathematical-background">Mathematical Background<a class="header-link" href="#mathematical-background" title="Permanent link">&para;</a></h2>
<h3 id="1-minimax-game">1. Minimax Game<a class="header-link" href="#1-minimax-game" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Goal</span><span class="o">:</span><span class="w"> </span><span class="n">Generator</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">fools</span><span class="w"> </span><span class="n">Discriminator</span><span class="w"> </span><span class="n">D</span>

<span class="n">Minimax</span><span class="w"> </span><span class="n">objective</span><span class="o">:</span>
<span class="n">min_G</span><span class="w"> </span><span class="n">max_D</span><span class="w"> </span><span class="n">V</span><span class="o">(</span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">G</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eâ‚“</span><span class="o">~</span><span class="n">pdata</span><span class="o">[</span><span class="n">log</span><span class="w"> </span><span class="n">D</span><span class="o">(</span><span class="n">x</span><span class="o">)]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Ez</span><span class="o">~</span><span class="n">pz</span><span class="o">[</span><span class="n">log</span><span class="o">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="o">(</span><span class="n">G</span><span class="o">(</span><span class="n">z</span><span class="o">)))]</span>
<span class="w">                      </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w">   </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="w">                      </span><span class="n">Real</span><span class="w"> </span><span class="n">data</span><span class="w">            </span><span class="n">Fake</span><span class="w"> </span><span class="n">data</span>
<span class="w">                      </span><span class="o">(</span><span class="n">maximize</span><span class="w"> </span><span class="n">D</span><span class="o">(</span><span class="n">x</span><span class="o">)</span><span class="err">â†’</span><span class="mi">1</span><span class="o">)</span><span class="w">    </span><span class="o">(</span><span class="n">maximize</span><span class="w"> </span><span class="n">D</span><span class="o">(</span><span class="n">G</span><span class="o">(</span><span class="n">z</span><span class="o">))</span><span class="err">â†’</span><span class="mi">0</span><span class="o">)</span>

<span class="n">D</span><span class="s1">&#39;s goal: Maximize V (distinguish real from fake)</span>
<span class="s1">G&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">goal</span><span class="o">:</span><span class="w"> </span><span class="n">Minimize</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="o">(</span><span class="n">fool</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">thinking</span><span class="w"> </span><span class="n">fake</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">real</span><span class="o">)</span>

<span class="n">Optimal</span><span class="w"> </span><span class="n">discriminator</span><span class="o">:</span>
<span class="n">D</span><span class="o">*(</span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdata</span><span class="o">(</span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">(</span><span class="n">pdata</span><span class="o">(</span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pg</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>

<span class="n">At</span><span class="w"> </span><span class="n">Nash</span><span class="w"> </span><span class="n">equilibrium</span><span class="o">:</span><span class="w"> </span><span class="n">pg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdata</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">*(</span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</code></pre></div>

<h3 id="2-training-dynamics">2. Training Dynamics<a class="header-link" href="#2-training-dynamics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Alternating</span><span class="w"> </span><span class="n">optimization</span><span class="p">:</span>

<span class="n">Step</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">Update</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="p">(</span><span class="n">fix</span><span class="w"> </span><span class="n">G</span><span class="p">)</span>
<span class="w">  </span><span class="n">Maximize</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
<span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">learns</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">classify</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="n">fake</span>

<span class="n">Step</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">Update</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="p">(</span><span class="n">fix</span><span class="w"> </span><span class="n">D</span><span class="p">)</span>
<span class="w">  </span><span class="n">Minimize</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
<span class="w">  </span><span class="ow">or</span><span class="w"> </span><span class="n">Maximize</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">saturating</span><span class="w"> </span><span class="n">variant</span><span class="w"> </span><span class="p">(</span><span class="n">better</span><span class="w"> </span><span class="n">gradient</span><span class="p">)</span>

<span class="n">Why</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="err">?</span>
<span class="o">-</span><span class="w"> </span><span class="n">Early</span><span class="w"> </span><span class="n">training</span><span class="p">:</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">bad</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="err">â‰ˆ</span><span class="w"> </span><span class="mi">0</span>
<span class="o">-</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="err">â‰ˆ</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">vanishing</span><span class="w"> </span><span class="n">gradient</span>
<span class="o">-</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">stronger</span><span class="w"> </span><span class="n">gradient</span>

<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">GAN</span><span class="w"> </span><span class="n">Training</span><span class="w"> </span><span class="n">Loop</span><span class="p">:</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">epoch</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">epochs</span><span class="p">:</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">real_batch</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dataloader</span><span class="p">:</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="c1"># 1. Update Discriminator          â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">fake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">loss_D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">log</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">real</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">D</span><span class="p">(</span><span class="n">fake</span><span class="p">))</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">D</span><span class="o">.</span><span class="n">step</span><span class="p">()</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="c1"># 2. Update Generator              â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">fake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">loss_G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">log</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">fake</span><span class="p">)</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">G</span><span class="o">.</span><span class="n">step</span><span class="p">()</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="3-loss-functions">3. Loss Functions<a class="header-link" href="#3-loss-functions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Original GAN (Minimax):
L_D = -[log D(x) + log(1 - D(G(z)))]
L_G = -log D(G(z))  (non-saturating)

WGAN (Wasserstein GAN):
L_D = -[D(x) - D(G(z))]  (no sigmoid, critic instead)
L_G = -D(G(z))
+ Weight clipping or Gradient Penalty

LSGAN (Least Squares GAN):
L_D = (D(x) - 1)Â² + D(G(z))Â²
L_G = (D(G(z)) - 1)Â²

Hinge Loss (Spectral Norm GAN):
L_D = -min(0, -1 + D(x)) - min(0, -1 - D(G(z)))
L_G = -D(G(z))
</code></pre></div>

<hr />
<h2 id="dcgan-architecture">DCGAN Architecture<a class="header-link" href="#dcgan-architecture" title="Permanent link">&para;</a></h2>
<p>Deep Convolutional GAN (Radford et al., 2015) - Stable training guidelines</p>
<h3 id="generator-6464-rgb-images">Generator (64Ã—64 RGB images)<a class="header-link" href="#generator-6464-rgb-images" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Latent</span><span class="w"> </span><span class="nx">Code</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="nx">dim</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span>
<span class="nx">Linear</span><span class="p">(</span><span class="mi">100</span><span class="err">â†’</span><span class="mi">4</span><span class="err">Ã—</span><span class="mi">4</span><span class="err">Ã—</span><span class="mi">1024</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ReLU</span>
<span class="w">    </span><span class="err">â†“</span>
<span class="nx">Reshape</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="err">Ã—</span><span class="mi">4</span><span class="err">Ã—</span><span class="mi">1024</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span>
<span class="nx">ConvTranspose2d</span><span class="p">(</span><span class="mi">1024</span><span class="err">â†’</span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="err">Ã—</span><span class="mi">8</span><span class="err">Ã—</span><span class="mi">512</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ReLU</span>
<span class="nx">ConvTranspose2d</span><span class="p">(</span><span class="mi">512</span><span class="err">â†’</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">16</span><span class="err">Ã—</span><span class="mi">16</span><span class="err">Ã—</span><span class="mi">256</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ReLU</span>
<span class="nx">ConvTranspose2d</span><span class="p">(</span><span class="mi">256</span><span class="err">â†’</span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">32</span><span class="err">Ã—</span><span class="mi">32</span><span class="err">Ã—</span><span class="mi">128</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ReLU</span>
<span class="nx">ConvTranspose2d</span><span class="p">(</span><span class="mi">128</span><span class="err">â†’</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="err">Ã—</span><span class="mi">64</span><span class="err">Ã—</span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">Tanh</span>
<span class="nx">Output</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="err">Ã—</span><span class="mi">64</span><span class="err">Ã—</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="nx">range</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>

<span class="nx">Key</span><span class="w"> </span><span class="nx">design</span><span class="w"> </span><span class="nx">choices</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">fully</span><span class="w"> </span><span class="nx">connected</span><span class="w"> </span><span class="nx">layers</span><span class="w"> </span><span class="p">(</span><span class="nx">except</span><span class="w"> </span><span class="nx">first</span><span class="w"> </span><span class="nx">projection</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Use</span><span class="w"> </span><span class="nx">transposed</span><span class="w"> </span><span class="nx">convolutions</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">upsampling</span>
<span class="o">-</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">layers</span><span class="w"> </span><span class="nx">except</span><span class="w"> </span><span class="nx">output</span>
<span class="o">-</span><span class="w"> </span><span class="nx">ReLU</span><span class="w"> </span><span class="nx">activation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">G</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Tanh</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="p">(</span><span class="nx">images</span><span class="w"> </span><span class="nx">normalized</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>

<h3 id="discriminator-6464-rgb-images">Discriminator (64Ã—64 RGB images)<a class="header-link" href="#discriminator-6464-rgb-images" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">Input</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="err">Ã—</span><span class="mi">64</span><span class="err">Ã—</span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span>
<span class="nx">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="err">â†’</span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w">  </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">32</span><span class="err">Ã—</span><span class="mi">32</span><span class="err">Ã—</span><span class="mi">128</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">LeakyReLU</span><span class="p">(</span><span class="m m-Double">0.2</span><span class="p">)</span>
<span class="nx">Conv2d</span><span class="p">(</span><span class="mi">128</span><span class="err">â†’</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">16</span><span class="err">Ã—</span><span class="mi">16</span><span class="err">Ã—</span><span class="mi">256</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">LeakyReLU</span><span class="p">(</span><span class="m m-Double">0.2</span><span class="p">)</span>
<span class="nx">Conv2d</span><span class="p">(</span><span class="mi">256</span><span class="err">â†’</span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="err">Ã—</span><span class="mi">8</span><span class="err">Ã—</span><span class="mi">512</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">LeakyReLU</span><span class="p">(</span><span class="m m-Double">0.2</span><span class="p">)</span>
<span class="nx">Conv2d</span><span class="p">(</span><span class="mi">512</span><span class="err">â†’</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="err">Ã—</span><span class="mi">4</span><span class="err">Ã—</span><span class="mi">1024</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">LeakyReLU</span><span class="p">(</span><span class="m m-Double">0.2</span><span class="p">)</span>
<span class="nx">Conv2d</span><span class="p">(</span><span class="mi">1024</span><span class="err">â†’</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="err">Ã—</span><span class="mi">1</span><span class="err">Ã—</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="err">â†“</span><span class="w"> </span><span class="nx">Sigmoid</span><span class="w"> </span><span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="nx">remove</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">WGAN</span><span class="p">)</span>
<span class="nx">Output</span><span class="w"> </span><span class="p">(</span><span class="nx">scalar</span><span class="w"> </span><span class="nx">probability</span><span class="p">)</span>

<span class="nx">Key</span><span class="w"> </span><span class="nx">design</span><span class="w"> </span><span class="nx">choices</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">fully</span><span class="w"> </span><span class="nx">connected</span><span class="w"> </span><span class="nx">layers</span><span class="w"> </span><span class="p">(</span><span class="nx">except</span><span class="w"> </span><span class="nx">implicit</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="nx">conv</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Strided</span><span class="w"> </span><span class="nx">convolutions</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">downsampling</span><span class="w"> </span><span class="p">(</span><span class="nx">no</span><span class="w"> </span><span class="nx">pooling</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="nx">BatchNorm</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">layers</span><span class="w"> </span><span class="nx">except</span><span class="w"> </span><span class="nx">input</span><span class="o">/</span><span class="nx">output</span>
<span class="o">-</span><span class="w"> </span><span class="nx">LeakyReLU</span><span class="w"> </span><span class="nx">activation</span><span class="w"> </span><span class="p">(</span><span class="nx">Î±</span><span class="p">=</span><span class="m m-Double">0.2</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Sigmoid</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">binary</span><span class="w"> </span><span class="nx">classification</span>
</code></pre></div>

<h3 id="dcgan-guidelines">DCGAN Guidelines<a class="header-link" href="#dcgan-guidelines" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">Replace</span><span class="w"> </span><span class="n">pooling</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">strided</span><span class="w"> </span><span class="n">convolutions</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">transposed</span><span class="w"> </span><span class="n">convs</span><span class="w"> </span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">BatchNorm</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">D</span>
<span class="mf">3.</span><span class="w"> </span><span class="c1">Remove fully connected hidden layers</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">ReLU</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="p">(</span><span class="n">except</span><span class="w"> </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="nb">Tan</span><span class="n">h</span><span class="p">)</span>
<span class="mf">5.</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">LeakyReLU</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="p">(</span><span class="n">Î±</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="training-techniques">Training Techniques<a class="header-link" href="#training-techniques" title="Permanent link">&para;</a></h2>
<h3 id="1-label-smoothing">1. Label Smoothing<a class="header-link" href="#1-label-smoothing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">becomes</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">confident</span><span class="w"> </span><span class="o">(</span><span class="n">D</span><span class="o">(</span><span class="n">real</span><span class="o">)</span><span class="err">â†’</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">(</span><span class="n">fake</span><span class="o">)</span><span class="err">â†’</span><span class="mi">0</span><span class="o">)</span>
<span class="err">â†’</span><span class="w"> </span><span class="n">Vanishing</span><span class="w"> </span><span class="n">gradients</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">G</span>

<span class="n">Solution</span><span class="o">:</span><span class="w"> </span><span class="n">Smooth</span><span class="w"> </span><span class="n">labels</span>
<span class="n">Real</span><span class="w"> </span><span class="n">labels</span><span class="o">:</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mf">0.9</span><span class="w"> </span><span class="o">(</span><span class="n">one</span><span class="o">-</span><span class="n">sided</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="n">smoothing</span><span class="o">)</span>
<span class="n">Fake</span><span class="w"> </span><span class="n">labels</span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">(</span><span class="n">keep</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">is</span><span class="o">)</span>

<span class="n">loss_D_real</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCE</span><span class="o">(</span><span class="n">D</span><span class="o">(</span><span class="n">real</span><span class="o">),</span><span class="w"> </span><span class="mf">0.9</span><span class="o">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">loss_D_fake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCE</span><span class="o">(</span><span class="n">D</span><span class="o">(</span><span class="n">fake</span><span class="o">),</span><span class="w"> </span><span class="mf">0.0</span><span class="o">)</span>
</code></pre></div>

<h3 id="2-feature-matching">2. Feature Matching<a class="header-link" href="#2-feature-matching" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">optimizes</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">fooling</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">generating</span><span class="w"> </span><span class="n">realistic</span><span class="w"> </span><span class="n">samples</span>

<span class="n">Solution</span><span class="o">:</span><span class="w"> </span><span class="n">Match</span><span class="w"> </span><span class="n">intermediate</span><span class="w"> </span><span class="n">features</span>
<span class="n">loss_G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span><span class="n">E</span><span class="o">[</span><span class="n">f</span><span class="o">(</span><span class="n">x</span><span class="o">)]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E</span><span class="o">[</span><span class="n">f</span><span class="o">(</span><span class="n">G</span><span class="o">(</span><span class="n">z</span><span class="o">))]||</span><span class="err">Â²</span>

<span class="n">Where</span><span class="w"> </span><span class="n">f</span><span class="o">(</span><span class="err">Â·</span><span class="o">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">intermediate</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">D</span>

<span class="n">Stabilizes</span><span class="w"> </span><span class="n">training</span><span class="o">,</span><span class="w"> </span><span class="n">reduces</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">collapse</span>
</code></pre></div>

<h3 id="3-minibatch-discrimination">3. Minibatch Discrimination<a class="header-link" href="#3-minibatch-discrimination" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">produces</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">variety</span><span class="w"> </span><span class="o">(</span><span class="n">mode</span><span class="w"> </span><span class="n">collapse</span><span class="o">)</span>

<span class="n">Solution</span><span class="o">:</span><span class="w"> </span><span class="n">Let</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">batch</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Extract</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">sample</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">Compute</span><span class="w"> </span><span class="n">similarity</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">batch</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">Append</span><span class="w"> </span><span class="n">batch</span><span class="w"> </span><span class="n">statistics</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">sample</span>

<span class="n">D</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">detect</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">produces</span><span class="w"> </span><span class="n">identical</span><span class="w"> </span><span class="n">samples</span>
</code></pre></div>

<h3 id="4-spectral-normalization">4. Spectral Normalization<a class="header-link" href="#4-spectral-normalization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">Discriminator</span><span class="w"> </span><span class="n">gradients</span><span class="w"> </span><span class="n">explode</span>

<span class="n">Solution</span><span class="o">:</span><span class="w"> </span><span class="n">Normalize</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="n">matrices</span>
<span class="n">W_SN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="err">Ïƒ</span><span class="o">(</span><span class="n">W</span><span class="o">)</span>

<span class="n">Where</span><span class="w"> </span><span class="err">Ïƒ</span><span class="o">(</span><span class="n">W</span><span class="o">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">largest</span><span class="w"> </span><span class="n">singular</span><span class="w"> </span><span class="n">value</span>

<span class="n">Stabilizes</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="o">(</span><span class="n">Miyato</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">al</span><span class="o">.,</span><span class="w"> </span><span class="mi">2018</span><span class="o">)</span>
<span class="n">Used</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">BigGAN</span><span class="o">,</span><span class="w"> </span><span class="n">StyleGAN</span>
</code></pre></div>

<h3 id="5-progressive-growing">5. Progressive Growing<a class="header-link" href="#5-progressive-growing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Start training at low resolution (4Ã—4)
Gradually add layers to reach high resolution (1024Ã—1024)

4Ã—4 â†’ 8Ã—8 â†’ 16Ã—16 â†’ ... â†’ 1024Ã—1024

Smooth transition between resolutions
Used in ProGAN, StyleGAN
</code></pre></div>

<hr />
<h2 id="mode-collapse">Mode Collapse<a class="header-link" href="#mode-collapse" title="Permanent link">&para;</a></h2>
<h3 id="1-what-is-mode-collapse">1. What is Mode Collapse?<a class="header-link" href="#1-what-is-mode-collapse" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">produces</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">variety</span>

<span class="n">Modes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">distribution</span><span class="o">:</span>
<span class="w">                 </span><span class="n">Mode</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="n">Mode</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="n">Mode</span><span class="w"> </span><span class="mi">3</span>
<span class="n">Real</span><span class="w"> </span><span class="n">data</span><span class="o">:</span><span class="w">         </span><span class="err">â—â—â—</span><span class="w">     </span><span class="err">â—â—â—</span><span class="w">     </span><span class="err">â—â—â—</span>
<span class="n">Healthy</span><span class="w"> </span><span class="n">GAN</span><span class="o">:</span><span class="w">       </span><span class="err">â—‹â—‹â—‹</span><span class="w">     </span><span class="err">â—‹â—‹â—‹</span><span class="w">     </span><span class="err">â—‹â—‹â—‹</span>
<span class="n">Mode</span><span class="w"> </span><span class="n">collapse</span><span class="o">:</span><span class="w">     </span><span class="err">â—‹â—‹â—‹</span>
<span class="n">Full</span><span class="w"> </span><span class="n">collapse</span><span class="o">:</span><span class="w">              </span><span class="err">â—‹â—‹â—‹â—‹â—‹â—‹â—‹</span>

<span class="n">Generator</span><span class="w"> </span><span class="n">ignores</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">distribution</span>
</code></pre></div>

<h3 id="2-detecting-mode-collapse">2. Detecting Mode Collapse<a class="header-link" href="#2-detecting-mode-collapse" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Symptoms</span><span class="o">:</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Generated</span><span class="w"> </span><span class="n">samples</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">similar</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">Low</span><span class="w"> </span><span class="n">diversity</span><span class="w"> </span><span class="n">despite</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">z</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">Training</span><span class="w"> </span><span class="n">loss</span><span class="w"> </span><span class="n">oscillates</span>
<span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="n">NLL</span><span class="w"> </span><span class="o">(</span><span class="n">Negative</span><span class="w"> </span><span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="o">)</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">despite</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="n">FID</span>

<span class="n">Metrics</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Inception</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="o">(</span><span class="n">IS</span><span class="o">):</span><span class="w"> </span><span class="n">measures</span><span class="w"> </span><span class="n">diversity</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">quality</span>
<span class="o">-</span><span class="w"> </span><span class="n">FrÃ©chet</span><span class="w"> </span><span class="n">Inception</span><span class="w"> </span><span class="n">Distance</span><span class="w"> </span><span class="o">(</span><span class="n">FID</span><span class="o">):</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="n">distance</span>
<span class="o">-</span><span class="w"> </span><span class="n">Precision</span><span class="o">/</span><span class="n">Recall</span><span class="o">:</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">coverage</span>
</code></pre></div>

<h3 id="3-mitigation-strategies">3. Mitigation Strategies<a class="header-link" href="#3-mitigation-strategies" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">Unrolled</span><span class="w"> </span><span class="n">GAN</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">optimizes</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="kr">step</span><span class="n">s</span><span class="w"> </span><span class="n">ahead</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Prevents</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nb">exp</span><span class="n">loiting</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">D</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">Minibatch</span><span class="w"> </span><span class="n">Discrimination</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">detects</span><span class="w"> </span><span class="n">lack</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">diversity</span>

<span class="mf">3.</span><span class="w"> </span><span class="n">WGAN</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">WGAN</span><span class="o">-</span><span class="n">GP</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Smoother</span><span class="w"> </span><span class="n">gradient</span><span class="w"> </span><span class="n">flow</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Better</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="n">stability</span>

<span class="mf">4.</span><span class="w"> </span><span class="n">Multiple</span><span class="w"> </span><span class="n">Discriminators</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Each</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">captures</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">modes</span>

<span class="mf">5.</span><span class="w"> </span><span class="n">Regularization</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">noise</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="kr">input</span><span class="n">s</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Dropout</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">D</span>
</code></pre></div>

<hr />
<h2 id="file-structure">File Structure<a class="header-link" href="#file-structure" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="mf">14</span><span class="n">_GAN</span><span class="o">/</span>
<span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="kr">READ</span><span class="n">ME</span><span class="mf">.</span><span class="n">md</span>
<span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">pytorch_lowlevel</span><span class="o">/</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">dcgan_mnist</span><span class="mf">.</span><span class="n">py</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">DCGAN</span><span class="w"> </span><span class="kr">on</span><span class="w"> </span><span class="n">MNIST</span><span class="w"> </span><span class="p">(</span><span class="mf">28</span><span class="err">Ã—</span><span class="mf">28</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">dcgan_cifar</span><span class="mf">.</span><span class="n">py</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">DCGAN</span><span class="w"> </span><span class="kr">on</span><span class="w"> </span><span class="n">CIFAR</span><span class="o">-</span><span class="mf">10</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="err">Ã—</span><span class="mf">32</span><span class="p">)</span>
<span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">paper</span><span class="o">/</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">dcgan_paper</span><span class="mf">.</span><span class="n">py</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Full</span><span class="w"> </span><span class="n">DCGAN</span><span class="w"> </span><span class="p">(</span><span class="mf">64</span><span class="err">Ã—</span><span class="mf">64</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">wgan_gp</span><span class="mf">.</span><span class="n">py</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">WGAN</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Gradient</span><span class="w"> </span><span class="n">Penalty</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">stylegan_simple</span><span class="mf">.</span><span class="n">py</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Simplified</span><span class="w"> </span><span class="n">StyleGAN</span>
<span class="err">â”‚</span><span class="w">   </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">conditional_gan</span><span class="mf">.</span><span class="n">py</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Conditional</span><span class="w"> </span><span class="n">GAN</span><span class="w"> </span><span class="p">(</span><span class="n">cGAN</span><span class="p">)</span>
<span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">exercises</span><span class="o">/</span>
<span class="w">    </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="mf">01</span><span class="n">_mode_collapse</span><span class="mf">.</span><span class="n">md</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">Diagnose</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">collapse</span>
<span class="w">    </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="mf">02</span><span class="n">_spectral_norm</span><span class="mf">.</span><span class="n">md</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">Implement</span><span class="w"> </span><span class="n">spectral</span><span class="w"> </span><span class="n">normalization</span>
</code></pre></div>

<hr />
<h2 id="core-concepts">Core Concepts<a class="header-link" href="#core-concepts" title="Permanent link">&para;</a></h2>
<h3 id="1-gan-variants">1. GAN Variants<a class="header-link" href="#1-gan-variants" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Conditional GAN (cGAN):
- Add class label c: G(z, c), D(x, c)
- Controlled generation (e.g., generate digit 7)

WGAN (Wasserstein GAN):
- Replace JS divergence with Wasserstein distance
- No sigmoid in D (becomes critic)
- Weight clipping or gradient penalty
- More stable training

StyleGAN:
- Progressive architecture
- Style modulation (AdaIN)
- Disentangled latent space W
- State-of-the-art image quality

CycleGAN:
- Unpaired image-to-image translation
- Cycle consistency loss: G(F(x)) â‰ˆ x
- Use cases: horseâ†”zebra, summerâ†”winter
</code></pre></div>

<h3 id="2-evaluation-metrics">2. Evaluation Metrics<a class="header-link" href="#2-evaluation-metrics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Inception Score (IS):
IS = exp(E[KL(p(y|x) || p(y))])

Higher is better (quality + diversity)
Range: 1 to C (num classes)

FrÃ©chet Inception Distance (FID):
FID = ||Î¼_real - Î¼_fake||Â² + Tr(Î£_real + Î£_fake - 2âˆš(Î£_realÂ·Î£_fake))

Lower is better (closer to real distribution)
Gold standard for GANs

Precision/Recall:
Precision = quality (fake samples are realistic)
Recall = coverage (all modes captured)
</code></pre></div>

<h3 id="3-training-tips">3. Training Tips<a class="header-link" href="#3-training-tips" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">Learning</span><span class="w"> </span><span class="n">rates</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="p">:</span><span class="w"> </span><span class="mf">2</span><span class="n">e</span><span class="o">-</span><span class="mf">4</span><span class="w"> </span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span><span class="w"> </span><span class="n">Î²â‚</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">Î²â‚‚</span><span class="o">=</span><span class="mf">0.999</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">G</span><span class="p">:</span><span class="w"> </span><span class="mf">2</span><span class="n">e</span><span class="o">-</span><span class="mf">4</span><span class="w"> </span><span class="p">(</span><span class="n">same</span><span class="w"> </span><span class="n">optimizer</span><span class="w"> </span><span class="n">settings</span><span class="p">)</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">Update</span><span class="w"> </span><span class="nb">fre</span><span class="n">quency</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="mf">1</span><span class="o">-</span><span class="mf">5</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">updates</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">slightly</span><span class="w"> </span><span class="n">ahead</span>

<span class="mf">3.</span><span class="w"> </span><span class="n">Initialization</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Xavier</span><span class="o">/</span><span class="n">He</span><span class="w"> </span><span class="n">initialization</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">BatchNorm</span><span class="w"> </span><span class="n">parameters</span><span class="p">:</span><span class="w"> </span><span class="n">Î³</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="n">Î²</span><span class="o">=</span><span class="mf">0</span>

<span class="mf">4.</span><span class="w"> </span><span class="kd">Data</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Normalize</span><span class="w"> </span><span class="n">images</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="err">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="err">]</span><span class="w"> </span><span class="p">(</span><span class="nb">Tan</span><span class="n">h</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Random</span><span class="w"> </span><span class="n">flip</span><span class="w"> </span><span class="n">augmentation</span>

<span class="mf">5.</span><span class="w"> </span><span class="n">Latent</span><span class="w"> </span><span class="n">code</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="err">~</span><span class="w"> </span><span class="n">N</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">),</span><span class="w"> </span><span class="kd">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="o">-</span><span class="mf">512</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">uniform</span><span class="w"> </span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>

<span class="mf">6.</span><span class="w"> </span><span class="n">Monitoring</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nb">Log</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">real</span><span class="p">),</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">fake</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">should</span><span class="w"> </span><span class="n">hover</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">samples</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">epoch</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Watch</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="p">(</span><span class="n">repetitive</span><span class="w"> </span><span class="n">samples</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="implementation-levels">Implementation Levels<a class="header-link" href="#implementation-levels" title="Permanent link">&para;</a></h2>
<h3 id="level-2-pytorch-low-level-pytorch_lowlevel">Level 2: PyTorch Low-Level (pytorch_lowlevel/)<a class="header-link" href="#level-2-pytorch-low-level-pytorch_lowlevel" title="Permanent link">&para;</a></h3>
<ul>
<li>Build DCGAN architecture from scratch</li>
<li>Implement alternating training loop</li>
<li>Train on MNIST and CIFAR-10</li>
<li>Visualize generated samples</li>
</ul>
<h3 id="level-3-paper-implementation-paper">Level 3: Paper Implementation (paper/)<a class="header-link" href="#level-3-paper-implementation-paper" title="Permanent link">&para;</a></h3>
<ul>
<li>Full DCGAN with training tricks</li>
<li>WGAN with Gradient Penalty</li>
<li>Conditional GAN (class-conditional)</li>
<li>Simplified StyleGAN with style modulation</li>
<li>FID/IS evaluation</li>
</ul>
<hr />
<h2 id="training-loop">Training Loop<a class="header-link" href="#training-loop" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Pseudocode</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">epochs</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">real_images</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">real_images</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># ========== Train Discriminator ==========</span>
        <span class="c1"># Real images</span>
        <span class="n">real_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.9</span>  <span class="c1"># Label smoothing</span>
        <span class="n">output_real</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">real_images</span><span class="p">)</span>
        <span class="n">loss_D_real</span> <span class="o">=</span> <span class="n">BCE</span><span class="p">(</span><span class="n">output_real</span><span class="p">,</span> <span class="n">real_labels</span><span class="p">)</span>

        <span class="c1"># Fake images</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>
        <span class="n">fake_images</span> <span class="o">=</span> <span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">fake_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">output_fake</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">fake_images</span><span class="o">.</span><span class="n">detach</span><span class="p">())</span>  <span class="c1"># Detach to avoid G gradients</span>
        <span class="n">loss_D_fake</span> <span class="o">=</span> <span class="n">BCE</span><span class="p">(</span><span class="n">output_fake</span><span class="p">,</span> <span class="n">fake_labels</span><span class="p">)</span>

        <span class="c1"># Total D loss</span>
        <span class="n">loss_D</span> <span class="o">=</span> <span class="n">loss_D_real</span> <span class="o">+</span> <span class="n">loss_D_fake</span>
        <span class="n">optimizer_D</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss_D</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer_D</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># ========== Train Generator ==========</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>
        <span class="n">fake_images</span> <span class="o">=</span> <span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">fake_images</span><span class="p">)</span>
        <span class="n">real_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">loss_G</span> <span class="o">=</span> <span class="n">BCE</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">real_labels</span><span class="p">)</span>  <span class="c1"># G wants D(fake)â†’1</span>

        <span class="n">optimizer_G</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss_G</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer_G</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="sampling">Sampling<a class="header-link" href="#sampling" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Generate new images</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>  <span class="c1"># Batch of 64</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">fake_images</span> <span class="o">=</span> <span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<span class="c1"># Denormalize from [-1, 1] to [0, 1]</span>
<span class="n">fake_images</span> <span class="o">=</span> <span class="p">(</span><span class="n">fake_images</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># For conditional GAN</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">64</span><span class="p">,))</span>  <span class="c1"># Generate 64 samples from 10 classes</span>
<span class="n">fake_images</span> <span class="o">=</span> <span class="n">G</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="learning-checklist">Learning Checklist<a class="header-link" href="#learning-checklist" title="Permanent link">&para;</a></h2>
<ul>
<li>[ ] Understand minimax game formulation</li>
<li>[ ] Implement DCGAN architecture guidelines</li>
<li>[ ] Master alternating training loop</li>
<li>[ ] Recognize mode collapse symptoms</li>
<li>[ ] Implement label smoothing and spectral normalization</li>
<li>[ ] Understand WGAN and gradient penalty</li>
<li>[ ] Compute FID and Inception Score</li>
<li>[ ] Implement conditional GAN</li>
</ul>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Goodfellow et al. (2014). "Generative Adversarial Networks"</li>
<li>Radford et al. (2015). "Unsupervised Representation Learning with Deep Convolutional GANs"</li>
<li>Arjovsky et al. (2017). "Wasserstein GAN"</li>
<li>Gulrajani et al. (2017). "Improved Training of Wasserstein GANs"</li>
<li>Miyato et al. (2018). "Spectral Normalization for GANs"</li>
<li>Karras et al. (2019). "A Style-Based Generator Architecture for GANs"</li>
<li><a href="../Deep_Learning/15_GAN.md">../Deep_Learning/15_GAN.md</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Deep_Learning/28_Generative_Models_GAN.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">28. Generative Models - GAN (Generative Adversarial Networks)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Deep_Learning/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Deep_Learning/30_Generative_Models_VAE.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">30. Generative Models - VAE (Variational Autoencoder)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}