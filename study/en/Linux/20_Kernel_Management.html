{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kernel Management - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Linux/">Linux</a>
    <span class="separator">/</span>
    <span class="current">Kernel Management</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Kernel Management</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Linux/19_Backup_Recovery.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Backup and Recovery</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Linux/21_Virtualization_KVM.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Virtualization (KVM)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-kernel-overview">1. Kernel Overview</a><ul>
<li><a href="#role-of-the-kernel">Role of the Kernel</a></li>
<li><a href="#kernel-components">Kernel Components</a></li>
</ul>
</li>
<li><a href="#2-kernel-version-management">2. Kernel Version Management</a><ul>
<li><a href="#current-kernel-information">Current Kernel Information</a></li>
<li><a href="#kernel-version-scheme">Kernel Version Scheme</a></li>
<li><a href="#installed-kernel-list">Installed Kernel List</a></li>
<li><a href="#kernel-update">Kernel Update</a></li>
<li><a href="#removing-old-kernels">Removing Old Kernels</a></li>
</ul>
</li>
<li><a href="#3-kernel-modules">3. Kernel Modules</a><ul>
<li><a href="#module-information">Module Information</a></li>
<li><a href="#loadingunloading-modules">Loading/Unloading Modules</a></li>
<li><a href="#module-parameters">Module Parameters</a></li>
<li><a href="#auto-loading-module-configuration">Auto-loading Module Configuration</a></li>
<li><a href="#module-aliases">Module Aliases</a></li>
</ul>
</li>
<li><a href="#4-dkms">4. DKMS</a><ul>
<li><a href="#dkms-overview">DKMS Overview</a></li>
<li><a href="#dkms-status-check">DKMS Status Check</a></li>
<li><a href="#dkms-module-management">DKMS Module Management</a></li>
<li><a href="#dkms-module-creation-example">DKMS Module Creation Example</a></li>
</ul>
</li>
<li><a href="#5-kernel-compilation">5. Kernel Compilation</a><ul>
<li><a href="#source-download">Source Download</a></li>
<li><a href="#install-build-dependencies">Install Build Dependencies</a></li>
<li><a href="#kernel-configuration">Kernel Configuration</a></li>
<li><a href="#key-configuration-options">Key Configuration Options</a></li>
<li><a href="#compilation-and-installation">Compilation and Installation</a></li>
<li><a href="#quick-test-build">Quick Test Build</a></li>
</ul>
</li>
<li><a href="#6-grub-bootloader">6. GRUB Bootloader</a><ul>
<li><a href="#grub-configuration-files">GRUB Configuration Files</a></li>
<li><a href="#etcdefaultgrub-configuration">/etc/default/grub Configuration</a></li>
<li><a href="#grub-update">GRUB Update</a></li>
<li><a href="#grub-reinstallation">GRUB Reinstallation</a></li>
<li><a href="#manually-adding-boot-entries">Manually Adding Boot Entries</a></li>
<li><a href="#changing-default-boot-kernel">Changing Default Boot Kernel</a></li>
</ul>
</li>
<li><a href="#7-kernel-parameters">7. Kernel Parameters</a><ul>
<li><a href="#boot-time-parameters">Boot-time Parameters</a></li>
<li><a href="#common-kernel-parameters">Common Kernel Parameters</a></li>
<li><a href="#runtime-parameters-sysctl">Runtime Parameters (sysctl)</a></li>
<li><a href="#key-sysctl-parameters">Key sysctl Parameters</a></li>
<li><a href="#initramfs-management">initramfs Management</a></li>
</ul>
</li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-module-management">Problem 1: Module Management</a></li>
<li><a href="#problem-2-grub-configuration">Problem 2: GRUB Configuration</a></li>
<li><a href="#problem-3-sysctl-configuration">Problem 3: sysctl Configuration</a></li>
</ul>
</li>
<li><a href="#answers">Answers</a><ul>
<li><a href="#problem-1-answer">Problem 1 Answer</a></li>
<li><a href="#problem-2-answer">Problem 2 Answer</a></li>
<li><a href="#problem-3-answer">Problem 3 Answer</a></li>
</ul>
</li>
<li><a href="#next-steps">Next Steps</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="kernel-management">Kernel Management<a class="header-link" href="#kernel-management" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>Through this document, you will learn:</p>
<ul>
<li>Linux kernel structure and version management</li>
<li>Kernel module management (load, unload, configure)</li>
<li>Kernel compilation and installation</li>
<li>GRUB bootloader configuration</li>
</ul>
<p><strong>Difficulty</strong>: Advanced</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-kernel-overview">Kernel Overview</a></li>
<li><a href="#2-kernel-version-management">Kernel Version Management</a></li>
<li><a href="#3-kernel-modules">Kernel Modules</a></li>
<li><a href="#4-dkms">DKMS</a></li>
<li><a href="#5-kernel-compilation">Kernel Compilation</a></li>
<li><a href="#6-grub-bootloader">GRUB Bootloader</a></li>
<li><a href="#7-kernel-parameters">Kernel Parameters</a></li>
</ol>
<hr />
<h2 id="1-kernel-overview">1. Kernel Overview<a class="header-link" href="#1-kernel-overview" title="Permanent link">&para;</a></h2>
<h3 id="role-of-the-kernel">Role of the Kernel<a class="header-link" href="#role-of-the-kernel" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      User Space                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚Applicationâ”‚ â”‚  Shell  â”‚  â”‚ Servicesâ”‚  â”‚   GUI   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚            â”‚            â”‚            â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   System Call Interface                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Kernel Space                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Process Mgmt  â”‚  Memory Mgmt  â”‚  Filesystem  â”‚ Network â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Device Drivers (Modules)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        Hardware                              â”‚
â”‚  CPU  â”‚  Memory  â”‚  Disk  â”‚  Network Card  â”‚  Other Devices â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="kernel-components">Kernel Components<a class="header-link" href="#kernel-components" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Process Management</strong></td>
<td>Process creation, scheduling, termination</td>
</tr>
<tr>
<td><strong>Memory Management</strong></td>
<td>Virtual memory, paging, caching</td>
</tr>
<tr>
<td><strong>Filesystem</strong></td>
<td>VFS, ext4, XFS, NFS, etc.</td>
</tr>
<tr>
<td><strong>Networking</strong></td>
<td>TCP/IP stack, sockets, routing</td>
</tr>
<tr>
<td><strong>Device Drivers</strong></td>
<td>Hardware abstraction, modules</td>
</tr>
<tr>
<td><strong>System Calls</strong></td>
<td>Interface between user space and kernel</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-kernel-version-management">2. Kernel Version Management<a class="header-link" href="#2-kernel-version-management" title="Permanent link">&para;</a></h2>
<h3 id="current-kernel-information">Current Kernel Information<a class="header-link" href="#current-kernel-information" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check kernel version</span>
uname<span class="w"> </span>-r
<span class="c1"># Example: 5.15.0-91-generic</span>

<span class="c1"># Detailed information</span>
uname<span class="w"> </span>-a
<span class="c1"># Linux hostname 5.15.0-91-generic #101-Ubuntu SMP x86_64 GNU/Linux</span>

<span class="c1"># Kernel configuration info</span>
cat<span class="w"> </span>/proc/version

<span class="c1"># Kernel build configuration (if compiled with config)</span>
cat<span class="w"> </span>/boot/config-<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-20
</code></pre></div>

<h3 id="kernel-version-scheme">Kernel Version Scheme<a class="header-link" href="#kernel-version-scheme" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">5.15.0</span><span class="o">-</span><span class="mf">91</span><span class="o">-</span><span class="n">generic</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Distribution</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">name</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">ABI</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="p">(</span><span class="n">distribution</span><span class="w"> </span><span class="n">patches</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Patch</span><span class="w"> </span><span class="n">level</span>
<span class="err">â”‚</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Minor</span><span class="w"> </span><span class="n">version</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="n">Major</span><span class="w"> </span><span class="n">version</span>
</code></pre></div>

<h3 id="installed-kernel-list">Installed Kernel List<a class="header-link" href="#installed-kernel-list" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Ubuntu/Debian</span>
dpkg<span class="w"> </span>--list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>linux-image

<span class="c1"># RHEL/CentOS</span>
rpm<span class="w"> </span>-qa<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>kernel

<span class="c1"># Or check /boot</span>
ls<span class="w"> </span>-la<span class="w"> </span>/boot/vmlinuz-*
</code></pre></div>

<h3 id="kernel-update">Kernel Update<a class="header-link" href="#kernel-update" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Ubuntu/Debian</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>linux-image-generic

<span class="c1"># Install specific version</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>linux-image-5.15.0-92-generic

<span class="c1"># RHEL/CentOS</span>
sudo<span class="w"> </span>yum<span class="w"> </span>update<span class="w"> </span>kernel

<span class="c1"># Install specific version</span>
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>kernel-5.14.0-362.el9
</code></pre></div>

<h3 id="removing-old-kernels">Removing Old Kernels<a class="header-link" href="#removing-old-kernels" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Ubuntu - automatic removal</span>
sudo<span class="w"> </span>apt<span class="w"> </span>autoremove

<span class="c1"># Ubuntu - remove specific version</span>
sudo<span class="w"> </span>apt<span class="w"> </span>remove<span class="w"> </span>linux-image-5.15.0-88-generic

<span class="c1"># Remove old kernels except current</span>
sudo<span class="w"> </span>apt<span class="w"> </span>purge<span class="w"> </span><span class="k">$(</span>dpkg<span class="w"> </span>--list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;linux-(image|headers|modules)&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span>uname<span class="w"> </span>-r<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/-generic//&#39;</span><span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>

<span class="c1"># RHEL/CentOS - remove old kernels (keep 2)</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>remove<span class="w"> </span><span class="k">$(</span>dnf<span class="w"> </span>repoquery<span class="w"> </span>--installonly<span class="w"> </span>--latest-limit<span class="o">=</span>-2<span class="w"> </span>-q<span class="k">)</span>
</code></pre></div>

<hr />
<h2 id="3-kernel-modules">3. Kernel Modules<a class="header-link" href="#3-kernel-modules" title="Permanent link">&para;</a></h2>
<h3 id="module-information">Module Information<a class="header-link" href="#module-information" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># List loaded modules</span>
lsmod

<span class="c1"># Specific module info</span>
modinfo<span class="w"> </span>ext4
modinfo<span class="w"> </span>nvidia

<span class="c1"># Check module dependencies</span>
modprobe<span class="w"> </span>--show-depends<span class="w"> </span>ext4

<span class="c1"># Module file location</span>
ls<span class="w"> </span>/lib/modules/<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>/kernel/
</code></pre></div>

<h3 id="loadingunloading-modules">Loading/Unloading Modules<a class="header-link" href="#loadingunloading-modules" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Load module</span>
sudo<span class="w"> </span>modprobe<span class="w"> </span>nouveau
sudo<span class="w"> </span>modprobe<span class="w"> </span>snd-hda-intel

<span class="c1"># Unload module</span>
sudo<span class="w"> </span>modprobe<span class="w"> </span>-r<span class="w"> </span>nouveau
sudo<span class="w"> </span>rmmod<span class="w"> </span>nouveau

<span class="c1"># Force unload (dangerous)</span>
sudo<span class="w"> </span>rmmod<span class="w"> </span>-f<span class="w"> </span>nouveau

<span class="c1"># Load with dependencies</span>
sudo<span class="w"> </span>modprobe<span class="w"> </span>-v<span class="w"> </span>nvidia
</code></pre></div>

<h3 id="module-parameters">Module Parameters<a class="header-link" href="#module-parameters" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check module parameters</span>
modinfo<span class="w"> </span>-p<span class="w"> </span>e1000e

<span class="c1"># Check currently applied parameters</span>
cat<span class="w"> </span>/sys/module/e1000e/parameters/IntMode

<span class="c1"># Load with parameters</span>
sudo<span class="w"> </span>modprobe<span class="w"> </span>e1000e<span class="w"> </span><span class="nv">IntMode</span><span class="o">=</span><span class="m">2</span>

<span class="c1"># /etc/modprobe.d/ configuration file</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options e1000e IntMode=2&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/modprobe.d/e1000e.conf
</code></pre></div>

<h3 id="auto-loading-module-configuration">Auto-loading Module Configuration<a class="header-link" href="#auto-loading-module-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Auto-load at boot</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;vhost_net&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/modules-load.d/vhost_net.conf

<span class="c1"># Module blacklist (prevent loading)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;blacklist nouveau&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/modprobe.d/blacklist-nouveau.conf
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options nouveau modeset=0&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/modprobe.d/blacklist-nouveau.conf

<span class="c1"># Requires initramfs regeneration</span>
sudo<span class="w"> </span>update-initramfs<span class="w"> </span>-u<span class="w">  </span><span class="c1"># Ubuntu/Debian</span>
sudo<span class="w"> </span>dracut<span class="w"> </span>-f<span class="w">            </span><span class="c1"># RHEL/CentOS</span>
</code></pre></div>

<h3 id="module-aliases">Module Aliases<a class="header-link" href="#module-aliases" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check alias</span>
modprobe<span class="w"> </span>--show-depends<span class="w"> </span>-a<span class="w"> </span>pci:v00008086d00001502sv*sd*bc*sc*i*

<span class="c1"># Find module by hardware ID</span>
lspci<span class="w"> </span>-nn<span class="w">  </span><span class="c1"># Check PCI devices and IDs</span>
lspci<span class="w"> </span>-k<span class="w">   </span><span class="c1"># Check modules in use</span>

<span class="c1"># USB devices</span>
lsusb
lsusb<span class="w"> </span>-t<span class="w">  </span><span class="c1"># Tree format</span>
</code></pre></div>

<hr />
<h2 id="4-dkms">4. DKMS<a class="header-link" href="#4-dkms" title="Permanent link">&para;</a></h2>
<h3 id="dkms-overview">DKMS Overview<a class="header-link" href="#dkms-overview" title="Permanent link">&para;</a></h3>
<p>DKMS (Dynamic Kernel Module Support) automatically rebuilds external modules on kernel updates.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Install DKMS</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>dkms<span class="w">  </span><span class="c1"># Ubuntu/Debian</span>
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>dkms<span class="w">  </span><span class="c1"># RHEL/CentOS</span>
</code></pre></div>

<h3 id="dkms-status-check">DKMS Status Check<a class="header-link" href="#dkms-status-check" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># List registered modules</span>
dkms<span class="w"> </span>status

<span class="c1"># Example output:</span>
<span class="c1"># nvidia/535.154.05, 5.15.0-91-generic, x86_64: installed</span>
<span class="c1"># nvidia/535.154.05, 5.15.0-92-generic, x86_64: installed</span>
<span class="c1"># virtualbox/7.0.12_Ubuntu, 5.15.0-91-generic, x86_64: installed</span>
</code></pre></div>

<h3 id="dkms-module-management">DKMS Module Management<a class="header-link" href="#dkms-module-management" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Add module</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>add<span class="w"> </span>-m<span class="w"> </span>module-name<span class="w"> </span>-v<span class="w"> </span>version

<span class="c1"># Build module</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>build<span class="w"> </span>-m<span class="w"> </span>module-name<span class="w"> </span>-v<span class="w"> </span>version

<span class="c1"># Install module</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>install<span class="w"> </span>-m<span class="w"> </span>module-name<span class="w"> </span>-v<span class="w"> </span>version

<span class="c1"># Remove module</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>remove<span class="w"> </span>-m<span class="w"> </span>module-name<span class="w"> </span>-v<span class="w"> </span>version<span class="w"> </span>--all

<span class="c1"># Rebuild for all kernels</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>autoinstall
</code></pre></div>

<h3 id="dkms-module-creation-example">DKMS Module Creation Example<a class="header-link" href="#dkms-module-creation-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Module directory structure</span>
/usr/src/mymodule-1.0/
â”œâ”€â”€<span class="w"> </span>dkms.conf
â”œâ”€â”€<span class="w"> </span>Makefile
â””â”€â”€<span class="w"> </span>mymodule.c
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># dkms.conf example</span>
<span class="nv">PACKAGE_NAME</span><span class="o">=</span><span class="s2">&quot;mymodule&quot;</span>
<span class="nv">PACKAGE_VERSION</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span>
BUILT_MODULE_NAME<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="s2">&quot;mymodule&quot;</span>
DEST_MODULE_LOCATION<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="s2">&quot;/kernel/drivers/misc&quot;</span>
<span class="nv">AUTOINSTALL</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Makefile example</span>
obj-m<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>mymodule.o

KVERSION<span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="k">$(</span>shell<span class="w"> </span>uname<span class="w"> </span>-r<span class="k">)</span>
KDIR<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>/lib/modules/<span class="k">$(</span>KVERSION<span class="k">)</span>/build

all:
<span class="w">    </span><span class="k">$(</span>MAKE<span class="k">)</span><span class="w"> </span>-C<span class="w"> </span><span class="k">$(</span>KDIR<span class="k">)</span><span class="w"> </span><span class="nv">M</span><span class="o">=</span><span class="k">$(</span>PWD<span class="k">)</span><span class="w"> </span>modules

clean:
<span class="w">    </span><span class="k">$(</span>MAKE<span class="k">)</span><span class="w"> </span>-C<span class="w"> </span><span class="k">$(</span>KDIR<span class="k">)</span><span class="w"> </span><span class="nv">M</span><span class="o">=</span><span class="k">$(</span>PWD<span class="k">)</span><span class="w"> </span>clean
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Register with DKMS</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>add<span class="w"> </span>-m<span class="w"> </span>mymodule<span class="w"> </span>-v<span class="w"> </span><span class="m">1</span>.0
sudo<span class="w"> </span>dkms<span class="w"> </span>build<span class="w"> </span>-m<span class="w"> </span>mymodule<span class="w"> </span>-v<span class="w"> </span><span class="m">1</span>.0
sudo<span class="w"> </span>dkms<span class="w"> </span>install<span class="w"> </span>-m<span class="w"> </span>mymodule<span class="w"> </span>-v<span class="w"> </span><span class="m">1</span>.0
</code></pre></div>

<hr />
<h2 id="5-kernel-compilation">5. Kernel Compilation<a class="header-link" href="#5-kernel-compilation" title="Permanent link">&para;</a></h2>
<h3 id="source-download">Source Download<a class="header-link" href="#source-download" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Download from kernel.org</span>
<span class="nb">cd</span><span class="w"> </span>/usr/src
wget<span class="w"> </span>https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.7.tar.xz
tar<span class="w"> </span>-xvf<span class="w"> </span>linux-6.7.tar.xz
<span class="nb">cd</span><span class="w"> </span>linux-6.7

<span class="c1"># Or via git</span>
git<span class="w"> </span>clone<span class="w"> </span>https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git
<span class="nb">cd</span><span class="w"> </span>linux
git<span class="w"> </span>checkout<span class="w"> </span>v6.7
</code></pre></div>

<h3 id="install-build-dependencies">Install Build Dependencies<a class="header-link" href="#install-build-dependencies" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Ubuntu/Debian</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>build-essential<span class="w"> </span>libncurses-dev<span class="w"> </span>bison<span class="w"> </span>flex<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>libssl-dev<span class="w"> </span>libelf-dev<span class="w"> </span>bc<span class="w"> </span>dwarves

<span class="c1"># RHEL/CentOS</span>
sudo<span class="w"> </span>yum<span class="w"> </span>groupinstall<span class="w"> </span><span class="s2">&quot;Development Tools&quot;</span>
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>ncurses-devel<span class="w"> </span>bison<span class="w"> </span>flex<span class="w"> </span>elfutils-libelf-devel<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>openssl-devel<span class="w"> </span>bc<span class="w"> </span>dwarves
</code></pre></div>

<h3 id="kernel-configuration">Kernel Configuration<a class="header-link" href="#kernel-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Copy current kernel configuration</span>
cp<span class="w"> </span>/boot/config-<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span><span class="w"> </span>.config

<span class="c1"># Menu-based configuration</span>
make<span class="w"> </span>menuconfig

<span class="c1"># Or graphical configuration (requires X11)</span>
make<span class="w"> </span>xconfig

<span class="c1"># Or text query mode</span>
make<span class="w"> </span>config

<span class="c1"># Query only new options based on existing config</span>
make<span class="w"> </span>oldconfig

<span class="c1"># Set new options to defaults</span>
make<span class="w"> </span>olddefconfig
</code></pre></div>

<h3 id="key-configuration-options">Key Configuration Options<a class="header-link" href="#key-configuration-options" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">General</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="c1">---&gt;</span>
<span class="w">    </span><span class="k">Local</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">append</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="k">release</span><span class="err">:</span><span class="w"> </span><span class="o">-</span><span class="n">custom</span>
<span class="w">    </span><span class="o">[</span><span class="n">*</span><span class="o">]</span><span class="w"> </span><span class="n">Automatically</span><span class="w"> </span><span class="n">append</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span>

<span class="n">Processor</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="c1">---&gt;</span>
<span class="w">    </span><span class="n">Processor</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="p">(</span><span class="n">Core</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="n">newer</span><span class="w"> </span><span class="n">Xeon</span><span class="p">)</span><span class="w"> </span><span class="c1">---&gt;</span>
<span class="w">    </span><span class="o">[</span><span class="n">*</span><span class="o">]</span><span class="w"> </span><span class="k">Symmetric</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">processing</span><span class="w"> </span><span class="n">support</span>

<span class="n">Device</span><span class="w"> </span><span class="n">Drivers</span><span class="w"> </span><span class="c1">---&gt;</span>
<span class="w">    </span><span class="o">[</span><span class="n">M</span><span class="o">]</span><span class="w"> </span><span class="n">Network</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="c1">---&gt;</span>
<span class="w">    </span><span class="o">[</span><span class="n">M</span><span class="o">]</span><span class="w"> </span><span class="n">SCSI</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="c1">---&gt;</span>

<span class="k">File</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="c1">---&gt;</span>
<span class="w">    </span><span class="o">&lt;*&gt;</span><span class="w"> </span><span class="n">Ext4</span><span class="w"> </span><span class="n">POSIX</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Lists</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">M</span><span class="o">&gt;</span><span class="w"> </span><span class="n">XFS</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">support</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">M</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Btrfs</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">support</span>
</code></pre></div>

<h3 id="compilation-and-installation">Compilation and Installation<a class="header-link" href="#compilation-and-installation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Compile (parallel build)</span>
make<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>

<span class="c1"># Compile modules</span>
make<span class="w"> </span>modules

<span class="c1"># Install modules</span>
sudo<span class="w"> </span>make<span class="w"> </span>modules_install

<span class="c1"># Install kernel</span>
sudo<span class="w"> </span>make<span class="w"> </span>install

<span class="c1"># Generate initramfs (if not done automatically)</span>
sudo<span class="w"> </span>update-initramfs<span class="w"> </span>-c<span class="w"> </span>-k<span class="w"> </span><span class="m">6</span>.7.0-custom

<span class="c1"># Update GRUB</span>
sudo<span class="w"> </span>update-grub
</code></pre></div>

<h3 id="quick-test-build">Quick Test Build<a class="header-link" href="#quick-test-build" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Start with minimal configuration</span>
make<span class="w"> </span>tinyconfig

<span class="c1"># Or minimal config for current hardware</span>
make<span class="w"> </span>localmodconfig

<span class="c1"># Build</span>
make<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>
</code></pre></div>

<hr />
<h2 id="6-grub-bootloader">6. GRUB Bootloader<a class="header-link" href="#6-grub-bootloader" title="Permanent link">&para;</a></h2>
<h3 id="grub-configuration-files">GRUB Configuration Files<a class="header-link" href="#grub-configuration-files" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Main configuration (do not modify)</span>
/boot/grub/grub.cfg

<span class="c1"># User configuration (modify this)</span>
/etc/default/grub

<span class="c1"># Custom scripts</span>
/etc/grub.d/
</code></pre></div>

<h3 id="etcdefaultgrub-configuration">/etc/default/grub Configuration<a class="header-link" href="#etcdefaultgrub-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/default/grub</span>

<span class="c1"># Default boot entry (starts from 0, or &quot;saved&quot;)</span>
<span class="nv">GRUB_DEFAULT</span><span class="o">=</span><span class="m">0</span>

<span class="c1"># Menu display time (seconds)</span>
<span class="nv">GRUB_TIMEOUT</span><span class="o">=</span><span class="m">5</span>

<span class="c1"># Menu hidden (faster boot)</span>
<span class="nv">GRUB_TIMEOUT_STYLE</span><span class="o">=</span>menu<span class="w">  </span><span class="c1"># menu, countdown, hidden</span>

<span class="c1"># Kernel parameters</span>
<span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;quiet splash&quot;</span>
<span class="nv">GRUB_CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

<span class="c1"># Resolution</span>
<span class="nv">GRUB_GFXMODE</span><span class="o">=</span>1920x1080

<span class="c1"># Disable recovery mode entry</span>
<span class="nv">GRUB_DISABLE_RECOVERY</span><span class="o">=</span><span class="s2">&quot;false&quot;</span>

<span class="c1"># OS prober (detect other OS)</span>
<span class="nv">GRUB_DISABLE_OS_PROBER</span><span class="o">=</span><span class="nb">false</span>
</code></pre></div>

<h3 id="grub-update">GRUB Update<a class="header-link" href="#grub-update" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Apply after configuration changes</span>
sudo<span class="w"> </span>update-grub<span class="w">  </span><span class="c1"># Ubuntu/Debian</span>
sudo<span class="w"> </span>grub2-mkconfig<span class="w"> </span>-o<span class="w"> </span>/boot/grub2/grub.cfg<span class="w">  </span><span class="c1"># RHEL/CentOS</span>

<span class="c1"># BIOS system</span>
sudo<span class="w"> </span>grub2-mkconfig<span class="w"> </span>-o<span class="w"> </span>/boot/grub2/grub.cfg

<span class="c1"># UEFI system</span>
sudo<span class="w"> </span>grub2-mkconfig<span class="w"> </span>-o<span class="w"> </span>/boot/efi/EFI/centos/grub.cfg
</code></pre></div>

<h3 id="grub-reinstallation">GRUB Reinstallation<a class="header-link" href="#grub-reinstallation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># BIOS system</span>
sudo<span class="w"> </span>grub-install<span class="w"> </span>/dev/sda
sudo<span class="w"> </span>update-grub

<span class="c1"># UEFI system</span>
sudo<span class="w"> </span>grub-install<span class="w"> </span>--target<span class="o">=</span>x86_64-efi<span class="w"> </span>--efi-directory<span class="o">=</span>/boot/efi
sudo<span class="w"> </span>update-grub
</code></pre></div>

<h3 id="manually-adding-boot-entries">Manually Adding Boot Entries<a class="header-link" href="#manually-adding-boot-entries" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/grub.d/40_custom</span>
<span class="c1">#!/bin/sh</span>
<span class="nb">exec</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>+3<span class="w"> </span><span class="nv">$0</span>

menuentry<span class="w"> </span><span class="s2">&quot;Custom Kernel&quot;</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">set</span><span class="w"> </span><span class="nv">root</span><span class="o">=</span><span class="s1">&#39;hd0,msdos1&#39;</span>
<span class="w">    </span>linux<span class="w"> </span>/boot/vmlinuz-6.7.0-custom<span class="w"> </span><span class="nv">root</span><span class="o">=</span>/dev/sda2<span class="w"> </span>ro<span class="w"> </span>quiet
<span class="w">    </span>initrd<span class="w"> </span>/boot/initrd.img-6.7.0-custom
<span class="o">}</span>

menuentry<span class="w"> </span><span class="s2">&quot;Recovery Mode&quot;</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">set</span><span class="w"> </span><span class="nv">root</span><span class="o">=</span><span class="s1">&#39;hd0,msdos1&#39;</span>
<span class="w">    </span>linux<span class="w"> </span>/boot/vmlinuz-6.7.0-custom<span class="w"> </span><span class="nv">root</span><span class="o">=</span>/dev/sda2<span class="w"> </span>ro<span class="w"> </span>single
<span class="w">    </span>initrd<span class="w"> </span>/boot/initrd.img-6.7.0-custom
<span class="o">}</span>
</code></pre></div>

<h3 id="changing-default-boot-kernel">Changing Default Boot Kernel<a class="header-link" href="#changing-default-boot-kernel" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check available menu entries</span>
grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;^menuentry|^submenu&quot;</span><span class="w"> </span>/boot/grub/grub.cfg

<span class="c1"># Set default (by index)</span>
sudo<span class="w"> </span>grub-set-default<span class="w"> </span><span class="m">2</span>

<span class="c1"># Set default (by name)</span>
sudo<span class="w"> </span>grub-set-default<span class="w"> </span><span class="s2">&quot;Ubuntu, with Linux 5.15.0-92-generic&quot;</span>

<span class="c1"># One-time boot selection</span>
sudo<span class="w"> </span>grub-reboot<span class="w"> </span><span class="s2">&quot;Ubuntu, with Linux 5.15.0-91-generic&quot;</span>

<span class="c1"># Set GRUB_DEFAULT in /etc/default/grub</span>
<span class="nv">GRUB_DEFAULT</span><span class="o">=</span><span class="s2">&quot;1&gt;2&quot;</span><span class="w">  </span><span class="c1"># 3rd item of submenu 1</span>
</code></pre></div>

<hr />
<h2 id="7-kernel-parameters">7. Kernel Parameters<a class="header-link" href="#7-kernel-parameters" title="Permanent link">&para;</a></h2>
<h3 id="boot-time-parameters">Boot-time Parameters<a class="header-link" href="#boot-time-parameters" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Set in /etc/default/grub</span>
<span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;quiet splash&quot;</span>
<span class="nv">GRUB_CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&quot;crashkernel=auto rd.lvm.lv=centos/root&quot;</span>

<span class="c1"># Or press &#39;e&#39; in GRUB menu to edit temporarily</span>
linux<span class="w"> </span>/boot/vmlinuz-...<span class="w"> </span><span class="nv">root</span><span class="o">=</span>...<span class="w"> </span>quiet<span class="w"> </span>splash<span class="w"> </span>nouveau.modeset<span class="o">=</span><span class="m">0</span>
</code></pre></div>

<h3 id="common-kernel-parameters">Common Kernel Parameters<a class="header-link" href="#common-kernel-parameters" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>quiet</code></td>
<td>Minimize boot messages</td>
</tr>
<tr>
<td><code>splash</code></td>
<td>Graphical splash screen</td>
</tr>
<tr>
<td><code>single</code></td>
<td>Single user mode</td>
</tr>
<tr>
<td><code>init=/bin/bash</code></td>
<td>Boot directly to shell</td>
</tr>
<tr>
<td><code>nomodeset</code></td>
<td>Disable video mode setting</td>
</tr>
<tr>
<td><code>acpi=off</code></td>
<td>Disable ACPI</td>
</tr>
<tr>
<td><code>noapic</code></td>
<td>Disable APIC</td>
</tr>
<tr>
<td><code>mem=4G</code></td>
<td>Limit usable memory</td>
</tr>
<tr>
<td><code>maxcpus=2</code></td>
<td>Limit CPU count</td>
</tr>
</tbody>
</table>
<h3 id="runtime-parameters-sysctl">Runtime Parameters (sysctl)<a class="header-link" href="#runtime-parameters-sysctl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check current value</span>
sysctl<span class="w"> </span>-a
sysctl<span class="w"> </span>net.ipv4.ip_forward

<span class="c1"># Temporary change</span>
sudo<span class="w"> </span>sysctl<span class="w"> </span>-w<span class="w"> </span>net.ipv4.ip_forward<span class="o">=</span><span class="m">1</span>

<span class="c1"># Permanent setting</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;net.ipv4.ip_forward = 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/sysctl.d/99-custom.conf
sudo<span class="w"> </span>sysctl<span class="w"> </span>-p<span class="w"> </span>/etc/sysctl.d/99-custom.conf

<span class="c1"># Or edit /etc/sysctl.conf then</span>
sudo<span class="w"> </span>sysctl<span class="w"> </span>-p
</code></pre></div>

<h3 id="key-sysctl-parameters">Key sysctl Parameters<a class="header-link" href="#key-sysctl-parameters" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/sysctl.d/99-custom.conf</span>

<span class="c1"># Network</span>
net.ipv4.ip_forward<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
net.ipv4.tcp_syncookies<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
net.core.somaxconn<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>
net.ipv4.tcp_max_syn_backlog<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>

<span class="c1"># Memory</span>
vm.swappiness<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>
vm.dirty_ratio<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40</span>
vm.dirty_background_ratio<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>

<span class="c1"># Filesystem</span>
fs.file-max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2097152</span>
fs.inotify.max_user_watches<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">524288</span>

<span class="c1"># Security</span>
kernel.dmesg_restrict<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
kernel.kptr_restrict<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
</code></pre></div>

<h3 id="initramfs-management">initramfs Management<a class="header-link" href="#initramfs-management" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Regenerate initramfs for current kernel</span>
sudo<span class="w"> </span>update-initramfs<span class="w"> </span>-u

<span class="c1"># Specific kernel version</span>
sudo<span class="w"> </span>update-initramfs<span class="w"> </span>-u<span class="w"> </span>-k<span class="w"> </span><span class="m">5</span>.15.0-92-generic

<span class="c1"># Create new</span>
sudo<span class="w"> </span>update-initramfs<span class="w"> </span>-c<span class="w"> </span>-k<span class="w"> </span><span class="m">5</span>.15.0-92-generic

<span class="c1"># RHEL/CentOS (dracut)</span>
sudo<span class="w"> </span>dracut<span class="w"> </span>-f
sudo<span class="w"> </span>dracut<span class="w"> </span>-f<span class="w"> </span>/boot/initramfs-<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>.img<span class="w"> </span><span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>

<span class="c1"># Check contents</span>
lsinitramfs<span class="w"> </span>/boot/initrd.img-<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-50
</code></pre></div>

<hr />
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-module-management">Problem 1: Module Management<a class="header-link" href="#problem-1-module-management" title="Permanent link">&para;</a></h3>
<ol>
<li>Add the <code>nouveau</code> driver to the blacklist and verify.</li>
<li>Assume a scenario using NVIDIA proprietary drivers.</li>
</ol>
<h3 id="problem-2-grub-configuration">Problem 2: GRUB Configuration<a class="header-link" href="#problem-2-grub-configuration" title="Permanent link">&para;</a></h3>
<p>Write a GRUB configuration that meets the following requirements:
- Boot timeout 10 seconds
- Default kernel: second entry
- Memory limit 4GB
- Quiet boot</p>
<h3 id="problem-3-sysctl-configuration">Problem 3: sysctl Configuration<a class="header-link" href="#problem-3-sysctl-configuration" title="Permanent link">&para;</a></h3>
<p>Write sysctl settings optimized for a web server:
- Increase connection backlog
- Increase file descriptor limit
- TCP tuning</p>
<hr />
<h2 id="answers">Answers<a class="header-link" href="#answers" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-answer">Problem 1 Answer<a class="header-link" href="#problem-1-answer" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Blacklist nouveau</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;blacklist nouveau&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/modprobe.d/blacklist-nouveau.conf
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options nouveau modeset=0&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/modprobe.d/blacklist-nouveau.conf

<span class="c1"># Update initramfs</span>
sudo<span class="w"> </span>update-initramfs<span class="w"> </span>-u<span class="w">  </span><span class="c1"># Ubuntu</span>
sudo<span class="w"> </span>dracut<span class="w"> </span>-f<span class="w">            </span><span class="c1"># RHEL</span>

<span class="c1"># Verify</span>
cat<span class="w"> </span>/etc/modprobe.d/blacklist-nouveau.conf

<span class="c1"># Check after reboot</span>
lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>nouveau<span class="w">  </span><span class="c1"># Should show no output</span>
</code></pre></div>

<h3 id="problem-2-answer">Problem 2 Answer<a class="header-link" href="#problem-2-answer" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/default/grub</span>
<span class="nv">GRUB_DEFAULT</span><span class="o">=</span><span class="m">1</span>
<span class="nv">GRUB_TIMEOUT</span><span class="o">=</span><span class="m">10</span>
<span class="nv">GRUB_TIMEOUT_STYLE</span><span class="o">=</span>menu
<span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;quiet splash mem=4G&quot;</span>
<span class="nv">GRUB_CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Apply</span>
sudo<span class="w"> </span>update-grub
</code></pre></div>

<h3 id="problem-3-answer">Problem 3 Answer<a class="header-link" href="#problem-3-answer" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/sysctl.d/99-webserver.conf</span>

<span class="c1"># Connection backlog</span>
net.core.somaxconn<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>
net.ipv4.tcp_max_syn_backlog<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>

<span class="c1"># File descriptors</span>
fs.file-max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2097152</span>

<span class="c1"># TCP tuning</span>
net.ipv4.tcp_fin_timeout<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span>
net.ipv4.tcp_tw_reuse<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
net.ipv4.tcp_keepalive_time<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span>
net.ipv4.tcp_keepalive_probes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
net.ipv4.tcp_keepalive_intvl<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span>

<span class="c1"># Memory buffer</span>
net.core.rmem_max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16777216</span>
net.core.wmem_max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16777216</span>
net.ipv4.tcp_rmem<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span><span class="m">12582912</span><span class="w"> </span><span class="m">16777216</span>
net.ipv4.tcp_wmem<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span><span class="m">12582912</span><span class="w"> </span><span class="m">16777216</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Apply</span>
sudo<span class="w"> </span>sysctl<span class="w"> </span>-p<span class="w"> </span>/etc/sysctl.d/99-webserver.conf
</code></pre></div>

<hr />
<h2 id="next-steps">Next Steps<a class="header-link" href="#next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./21_Virtualization_KVM.md">21_Virtualization_KVM.md</a> - libvirt, virsh, VM management</li>
</ul>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.kernel.org/">The Linux Kernel Archives</a></li>
<li><a href="https://www.kernel.org/doc/html/latest/">Kernel Documentation</a></li>
<li><a href="https://www.gnu.org/software/grub/manual/">GRUB Manual</a></li>
<li><code>man modprobe</code>, <code>man dkms</code>, <code>man sysctl</code></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Linux/19_Backup_Recovery.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Backup and Recovery</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Linux/21_Virtualization_KVM.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Virtualization (KVM)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}