{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5. Magnetic Reconnection Theory - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">5. Magnetic Reconnection Theory</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>5. Magnetic Reconnection Theory</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/04_Current_Driven_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">4. Current-Driven Instabilities</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/06_Reconnection_Applications.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">6. Reconnection Applications</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-introduction-to-magnetic-reconnection">1. Introduction to Magnetic Reconnection</a><ul>
<li><a href="#11-what-is-magnetic-reconnection">1.1 What is Magnetic Reconnection?</a></li>
<li><a href="#12-why-reconnection-matters">1.2 Why Reconnection Matters</a></li>
<li><a href="#13-the-frozen-in-field-theorem-and-its-breakdown">1.3 The Frozen-In Field Theorem and Its Breakdown</a></li>
</ul>
</li>
<li><a href="#2-sweet-parker-reconnection">2. Sweet-Parker Reconnection</a><ul>
<li><a href="#21-model-setup">2.1 Model Setup</a></li>
<li><a href="#22-derivation-of-the-reconnection-rate">2.2 Derivation of the Reconnection Rate</a></li>
<li><a href="#23-the-sweet-parker-problem">2.3 The Sweet-Parker Problem</a></li>
<li><a href="#24-limitations-of-sweet-parker">2.4 Limitations of Sweet-Parker</a></li>
</ul>
</li>
<li><a href="#3-petschek-reconnection">3. Petschek Reconnection</a><ul>
<li><a href="#31-the-petschek-model">3.1 The Petschek Model</a></li>
<li><a href="#32-slow-mode-mhd-shocks">3.2 Slow-Mode MHD Shocks</a></li>
<li><a href="#33-petschek-reconnection-rate">3.3 Petschek Reconnection Rate</a></li>
<li><a href="#34-stability-of-petschek-reconnection">3.4 Stability of Petschek Reconnection</a></li>
</ul>
</li>
<li><a href="#4-hall-mhd-and-collisionless-reconnection">4. Hall MHD and Collisionless Reconnection</a><ul>
<li><a href="#41-the-hall-term">4.1 The Hall Term</a></li>
<li><a href="#42-hall-mhd-equations">4.2 Hall MHD Equations</a></li>
<li><a href="#43-structure-of-hall-reconnection">4.3 Structure of Hall Reconnection</a></li>
<li><a href="#44-hall-reconnection-rate">4.4 Hall Reconnection Rate</a></li>
<li><a href="#45-gem-reconnection-challenge">4.5 GEM Reconnection Challenge</a></li>
</ul>
</li>
<li><a href="#5-x-point-geometry-and-magnetic-topology">5. X-Point Geometry and Magnetic Topology</a><ul>
<li><a href="#51-x-point-configuration">5.1 X-Point Configuration</a></li>
<li><a href="#52-magnetic-topology-and-topology-change">5.2 Magnetic Topology and Topology Change</a></li>
<li><a href="#53-separatrices-and-magnetic-islands">5.3 Separatrices and Magnetic Islands</a></li>
<li><a href="#54-the-vector-potential-and-flux-function">5.4 The Vector Potential and Flux Function</a></li>
</ul>
</li>
<li><a href="#6-measuring-reconnection-rates">6. Measuring Reconnection Rates</a><ul>
<li><a href="#61-dimensionless-reconnection-rate">6.1 Dimensionless Reconnection Rate</a></li>
<li><a href="#62-reconnection-electric-field">6.2 Reconnection Electric Field</a></li>
<li><a href="#63-flux-transfer-rate">6.3 Flux Transfer Rate</a></li>
<li><a href="#64-observational-measures">6.4 Observational Measures</a></li>
</ul>
</li>
<li><a href="#7-python-examples">7. Python Examples</a><ul>
<li><a href="#71-sweet-parker-vs-petschek-scaling">7.1 Sweet-Parker vs Petschek Scaling</a></li>
<li><a href="#72-x-point-magnetic-field-structure">7.2 X-Point Magnetic Field Structure</a></li>
<li><a href="#73-sweet-parker-diffusion-region-aspect-ratio">7.3 Sweet-Parker Diffusion Region Aspect Ratio</a></li>
<li><a href="#74-hall-reconnection-quadrupolar-field">7.4 Hall Reconnection Quadrupolar Field</a></li>
<li><a href="#75-reconnection-rate-evolution">7.5 Reconnection Rate Evolution</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
<li><a href="#navigation">Navigation</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="5-magnetic-reconnection-theory">5. Magnetic Reconnection Theory<a class="header-link" href="#5-magnetic-reconnection-theory" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lesson, you should be able to:</p>
<ol>
<li>Explain why magnetic reconnection is fundamental to plasma physics and astrophysics</li>
<li>Derive the Sweet-Parker reconnection rate and understand its limitations</li>
<li>Analyze the Petschek model and explain how it achieves faster reconnection</li>
<li>Understand the role of Hall physics in collisionless reconnection</li>
<li>Describe X-point geometry and the structure of reconnection regions</li>
<li>Calculate and interpret dimensionless reconnection rates</li>
<li>Implement numerical models of reconnection rate scaling</li>
</ol>
<h2 id="1-introduction-to-magnetic-reconnection">1. Introduction to Magnetic Reconnection<a class="header-link" href="#1-introduction-to-magnetic-reconnection" title="Permanent link">&para;</a></h2>
<h3 id="11-what-is-magnetic-reconnection">1.1 What is Magnetic Reconnection?<a class="header-link" href="#11-what-is-magnetic-reconnection" title="Permanent link">&para;</a></h3>
<p>Magnetic reconnection is a fundamental plasma process in which magnetic field topology changes and magnetic energy is rapidly converted to plasma kinetic and thermal energy. This process is responsible for some of the most explosive phenomena in the universe.</p>
<div class="highlight"><pre><span></span><code><span class="n">Key</span><span class="w"> </span><span class="n">concept</span><span class="p">:</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">ideal</span><span class="w"> </span><span class="n">MHD</span><span class="p">,</span><span class="w"> </span><span class="n">magnetic</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="s2">&quot;frozen in&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plasma</span>
<span class="p">(</span><span class="n">flux</span><span class="w"> </span><span class="n">freezing</span><span class="p">)</span><span class="o">.</span><span class="w"> </span><span class="n">Reconnection</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">constraint</span><span class="p">,</span><span class="w"> </span><span class="n">allowing</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">to</span>
<span class="k">break</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reconnect</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">configuration</span><span class="o">.</span>
</code></pre></div>

<p>The process occurs in thin current sheets where the frozen-in condition breaks down due to non-ideal effects (resistivity, Hall physics, or kinetic effects). The changing topology allows magnetic energy to be released, often explosively.</p>
<h3 id="12-why-reconnection-matters">1.2 Why Reconnection Matters<a class="header-link" href="#12-why-reconnection-matters" title="Permanent link">&para;</a></h3>
<p>Magnetic reconnection is crucial for understanding:</p>
<p><strong>Solar Physics:</strong>
- Solar flares: Energy release of ~10¬≥¬≤‚Äì10¬≥¬≥ erg in minutes
- Coronal mass ejections (CMEs): Billion-ton plasma eruptions
- Coronal heating: Maintaining million-degree corona</p>
<p><strong>Space Physics:</strong>
- Magnetospheric substorms: Auroral brightening events
- Solar wind-magnetosphere coupling: Energy transfer at magnetopause
- Particle acceleration: Non-thermal particle populations</p>
<p><strong>Laboratory Plasmas:</strong>
- Tokamak sawtooth crashes: Rapid core temperature drops
- Disruptions: Catastrophic loss of confinement
- Spheromak and RFP relaxation: Magnetic self-organization</p>
<p><strong>Astrophysics:</strong>
- Pulsar magnetospheres: High-energy radiation
- Accretion disk coronae: X-ray emission
- Gamma-ray burst jets: Relativistic outflows</p>
<p>The key puzzle that drove reconnection theory: How can reconnection be fast enough to explain observations when naive estimates predict extremely slow rates?</p>
<h3 id="13-the-frozen-in-field-theorem-and-its-breakdown">1.3 The Frozen-In Field Theorem and Its Breakdown<a class="header-link" href="#13-the-frozen-in-field-theorem-and-its-breakdown" title="Permanent link">&para;</a></h3>
<p>In ideal MHD, the electric field is:</p>
<p>$$\mathbf{E} = -\mathbf{v} \times \mathbf{B}$$</p>
<p>This leads to the frozen-in flux theorem: the magnetic flux through any closed loop moving with the plasma is conserved. Field lines can be thought of as moving with the plasma.</p>
<p>When resistivity is included, Ohm's law becomes:</p>
<p>$$\mathbf{E} = -\mathbf{v} \times \mathbf{B} + \eta \mathbf{J}$$</p>
<p>where $\eta$ is the resistivity and $\mathbf{J}$ is the current density. The resistive term allows field lines to "slip" through the plasma. However, as we'll see, classical resistivity alone is too small to explain observed reconnection rates.</p>
<p>The induction equation becomes:</p>
<p>$$\frac{\partial \mathbf{B}}{\partial t} = \nabla \times (\mathbf{v} \times \mathbf{B}) + \eta \nabla^2 \mathbf{B}$$</p>
<p>The relative importance of the ideal and resistive terms is measured by the magnetic Reynolds number:</p>
<p>$$R_m = \frac{Lv_A}{\eta}$$</p>
<p>where $L$ is a characteristic length scale and $v_A = B/\sqrt{\mu_0 \rho}$ is the Alfv√©n velocity. For most astrophysical and space plasmas, $R_m \gg 1$, making reconnection a challenging problem.</p>
<h2 id="2-sweet-parker-reconnection">2. Sweet-Parker Reconnection<a class="header-link" href="#2-sweet-parker-reconnection" title="Permanent link">&para;</a></h2>
<h3 id="21-model-setup">2.1 Model Setup<a class="header-link" href="#21-model-setup" title="Permanent link">&para;</a></h3>
<p>The Sweet-Parker model, independently developed by Sweet (1958) and Parker (1957), was the first quantitative theory of magnetic reconnection. It assumes:</p>
<ol>
<li><strong>Steady state</strong>: Time-independent configuration</li>
<li><strong>Two-dimensional geometry</strong>: Invariance along the current direction</li>
<li><strong>Thin current sheet</strong>: Length $L \gg$ width $\delta$</li>
<li><strong>Symmetric inflow</strong>: Plasma flows in from both sides</li>
<li><strong>Classical resistivity</strong>: $\eta$ is constant</li>
</ol>
<div class="highlight"><pre><span></span><code>                    Inflow v_in
                        ‚Üì
                        ‚Üì
        B_in ‚Üê  ‚Üê  ‚Üê  ‚Üê‚îº‚Üí  ‚Üí  ‚Üí  ‚Üí B_in
                        ‚Üì
        ================‚ïã================ Current sheet
                        ‚Üì                 (length L, width Œ¥)
        B_in ‚Üê  ‚Üê  ‚Üê  ‚Üê‚îº‚Üí  ‚Üí  ‚Üí  ‚Üí B_in
                        ‚Üì
                        ‚Üì Outflow v_out
</code></pre></div>

<p>The reconnecting field is antiparallel: $\mathbf{B} = B_{in} \hat{x}$ above the sheet and $\mathbf{B} = -B_{in} \hat{x}$ below. The reconnection electric field $E_z$ is uniform and points out of the page.</p>
<h3 id="22-derivation-of-the-reconnection-rate">2.2 Derivation of the Reconnection Rate<a class="header-link" href="#22-derivation-of-the-reconnection-rate" title="Permanent link">&para;</a></h3>
<p>We derive the reconnection rate by applying conservation laws to the diffusion region.</p>
<p><strong>Mass Conservation:</strong></p>
<p>The mass inflow rate must equal the mass outflow rate:</p>
<p>$$\rho v_{in} L \approx \rho v_{out} \delta$$</p>
<p>Therefore:</p>
<p>$$v_{out} \approx v_{in} \frac{L}{\delta}$$</p>
<p><strong>Momentum Conservation:</strong></p>
<p>The magnetic pressure drives the outflow. Balancing magnetic pressure with dynamic pressure:</p>
<p>$$\frac{B_{in}^2}{2\mu_0} \approx \rho v_{out}^2$$</p>
<p>This gives the outflow velocity as approximately the Alfv√©n speed:</p>
<p>$$v_{out} \approx v_A = \frac{B_{in}}{\sqrt{\mu_0 \rho}}$$</p>
<p><strong>Ohm's Law at the X-point:</strong></p>
<p>At the center of the diffusion region, the reconnection electric field is:</p>
<p>$$E_z = \eta J_z$$</p>
<p>where $J_z \approx B_{in}/(\mu_0 \delta)$ from Amp√®re's law. Outside the diffusion region (in the ideal region), Ohm's law gives:</p>
<p>$$E_z = v_{in} B_{in}$$</p>
<p>Equating these:</p>
<p>$$v_{in} B_{in} = \eta \frac{B_{in}}{\mu_0 \delta}$$</p>
<p>Solving for the width:</p>
<p>$$\delta = \frac{\eta}{\mu_0 v_{in}}$$</p>
<p><strong>Solving for $v_{in}$:</strong></p>
<p>Combining $v_{out} = v_{in} L/\delta$ with $v_{out} = v_A$ and the expression for $\delta$:</p>
<p>$$v_A = v_{in} \frac{L}{\eta/(\mu_0 v_{in})} = v_{in} \frac{L \mu_0 v_{in}}{\eta}$$</p>
<p>$$v_A = \frac{L \mu_0 v_{in}^2}{\eta}$$</p>
<p>$$v_{in} = \sqrt{\frac{\eta v_A}{L \mu_0}} = v_A \sqrt{\frac{\eta}{L v_A \mu_0}}$$</p>
<p><strong>Dimensionless Reconnection Rate:</strong></p>
<p>Define the Lundquist number:</p>
<p>$$S = \frac{L v_A \mu_0}{\eta} = \frac{L v_A}{\eta/\mu_0}$$</p>
<p>This is the magnetic Reynolds number based on the sheet length. The dimensionless reconnection rate is:</p>
<p>$$M_A = \frac{v_{in}}{v_A} = S^{-1/2}$$</p>
<p>Also, the aspect ratio is:</p>
<p>$$\frac{\delta}{L} = S^{-1}$$</p>
<h3 id="23-the-sweet-parker-problem">2.3 The Sweet-Parker Problem<a class="header-link" href="#23-the-sweet-parker-problem" title="Permanent link">&para;</a></h3>
<p>For a solar flare, typical parameters are:</p>
<ul>
<li>$L \sim 10^9$ m (10,000 km)</li>
<li>$B \sim 0.01$ T (100 G)</li>
<li>$n \sim 10^{16}$ m‚Åª¬≥</li>
<li>$T \sim 10^7$ K</li>
<li>Spitzer resistivity: $\eta \sim 10^{-4}$ Œ©¬∑m</li>
</ul>
<p>This gives:</p>
<p>$$v_A \sim 10^6 \text{ m/s}$$</p>
<p>$$S \sim \frac{10^9 \times 10^6}{10^{-4}/\mu_0} \sim 10^{14}$$</p>
<p>$$M_A \sim 10^{-7}$$</p>
<p>$$v_{in} \sim 10^{-1} \text{ m/s}$$</p>
<p><strong>The problem:</strong> At this rate, reconnecting the field would take:</p>
<p>$$t \sim \frac{L}{v_{in}} \sim 10^{10} \text{ s} \sim 300 \text{ years}$$</p>
<p>But solar flares release energy in <strong>minutes to hours</strong>! Observed reconnection rates are $M_A \sim 0.01$‚Äì$0.1$, about 100,000 times faster than Sweet-Parker predicts.</p>
<p>This is the <strong>reconnection rate problem</strong>: Sweet-Parker reconnection is far too slow to explain observations.</p>
<h3 id="24-limitations-of-sweet-parker">2.4 Limitations of Sweet-Parker<a class="header-link" href="#24-limitations-of-sweet-parker" title="Permanent link">&para;</a></h3>
<p>The Sweet-Parker model has several limitations:</p>
<ol>
<li>
<p><strong>Too slow</strong>: As shown above, $M_A \sim S^{-1/2}$ gives unrealistically slow rates for large $S$.</p>
</li>
<li>
<p><strong>Assumes uniform resistivity</strong>: In reality, resistivity can be enhanced by anomalous processes (turbulence, waves).</p>
</li>
<li>
<p><strong>Steady state</strong>: Real reconnection is often time-dependent and bursty.</p>
</li>
<li>
<p><strong>2D</strong>: Three-dimensional effects can be important.</p>
</li>
<li>
<p><strong>Classical resistivity</strong>: Collisionless plasmas require kinetic physics.</p>
</li>
</ol>
<p>Despite these limitations, Sweet-Parker remains a useful benchmark and describes some aspects of reconnection in certain regimes.</p>
<h2 id="3-petschek-reconnection">3. Petschek Reconnection<a class="header-link" href="#3-petschek-reconnection" title="Permanent link">&para;</a></h2>
<h3 id="31-the-petschek-model">3.1 The Petschek Model<a class="header-link" href="#31-the-petschek-model" title="Permanent link">&para;</a></h3>
<p>Petschek (1964) proposed a radical modification: instead of a long diffusion region, reconnection occurs in a small resistive region near the X-point, with most of the energy conversion happening in extended slow-mode MHD shocks.</p>
<div class="highlight"><pre><span></span><code><span class="w">                    </span><span class="n">Inflow</span>
<span class="w">                      </span><span class="err">‚Üì</span>
<span class="w">         </span><span class="err">‚ï≤</span><span class="w">            </span><span class="err">‚Üì</span><span class="w">            </span><span class="err">‚ï±</span>
<span class="w">          </span><span class="err">‚ï≤</span><span class="w">           </span><span class="err">‚Üì</span><span class="w">           </span><span class="err">‚ï±</span><span class="w">   </span><span class="n">Slow</span><span class="w"> </span><span class="n">shock</span>
<span class="w">           </span><span class="err">‚ï≤</span><span class="w">          </span><span class="err">‚Üì</span><span class="w">          </span><span class="err">‚ï±</span>
<span class="w">            </span><span class="err">‚ï≤</span><span class="w">         </span><span class="err">‚Üì</span><span class="w">         </span><span class="err">‚ï±</span>
<span class="w">             </span><span class="err">‚ï≤</span><span class="w">        </span><span class="err">‚Üì</span><span class="w">        </span><span class="err">‚ï±</span>
<span class="w">              </span><span class="err">‚ï≤</span><span class="w">      </span><span class="err">‚îè‚îÅ‚îì</span><span class="w">      </span><span class="err">‚ï±</span>
<span class="w">               </span><span class="err">‚ï≤</span><span class="w">     </span><span class="err">‚îÉ</span><span class="w"> </span><span class="err">‚îÉ</span><span class="w">     </span><span class="err">‚ï±</span><span class="w">        </span><span class="n">Small</span><span class="w"> </span><span class="n">diffusion</span>
<span class="w">        </span><span class="err">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï≤‚ïê‚ïê‚ïê‚ïê‚îÉ</span><span class="n">X</span><span class="err">‚îÉ‚ïê‚ïê‚ïê‚ïê‚ï±‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</span><span class="w">  </span><span class="n">region</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="err">Œ¥</span><span class="p">)</span>
<span class="w">                 </span><span class="err">‚ï≤</span><span class="w">   </span><span class="err">‚îÉ</span><span class="w"> </span><span class="err">‚îÉ</span><span class="w">   </span><span class="err">‚ï±</span>
<span class="w">                  </span><span class="err">‚ï≤</span><span class="w">  </span><span class="err">‚îó‚îÅ‚îõ</span><span class="w">  </span><span class="err">‚ï±</span>
<span class="w">                   </span><span class="err">‚ï≤</span><span class="w">  </span><span class="err">‚Üì</span><span class="w">  </span><span class="err">‚ï±</span>
<span class="w">                    </span><span class="err">‚ï≤</span><span class="w"> </span><span class="err">‚Üì</span><span class="w"> </span><span class="err">‚ï±</span>
<span class="w">                     </span><span class="err">‚ï≤‚Üì‚ï±</span>
<span class="w">                      </span><span class="err">‚Üì</span><span class="w"> </span><span class="n">Outflow</span>
</code></pre></div>

<p><strong>Key features:</strong></p>
<ol>
<li><strong>Small diffusion region</strong>: Size ~$\delta \sim \eta/(v_A \mu_0)$, independent of $L$</li>
<li><strong>Slow MHD shocks</strong>: Extend from diffusion region to distance ~$L$</li>
<li><strong>Fast reconnection</strong>: Rate depends only logarithmically on $S$</li>
</ol>
<h3 id="32-slow-mode-mhd-shocks">3.2 Slow-Mode MHD Shocks<a class="header-link" href="#32-slow-mode-mhd-shocks" title="Permanent link">&para;</a></h3>
<p>Slow-mode shocks are one of three types of MHD shocks (fast, slow, intermediate). Their properties:</p>
<ul>
<li><strong>Velocity jump</strong>: Flow accelerates across shock</li>
<li><strong>Magnetic field</strong>: $B_{\perp}$ decreases, $B_{\parallel}$ can increase or decrease</li>
<li><strong>Density</strong>: Increases across shock (compression)</li>
<li><strong>Temperature</strong>: Increases (entropy generation)</li>
</ul>
<p>The slow shocks convert magnetic energy to thermal and kinetic energy. The shocks make an angle $\psi$ with the current sheet:</p>
<p>$$\psi \sim \frac{\delta}{L} \sim \frac{\eta}{L v_A \mu_0}$$</p>
<h3 id="33-petschek-reconnection-rate">3.3 Petschek Reconnection Rate<a class="header-link" href="#33-petschek-reconnection-rate" title="Permanent link">&para;</a></h3>
<p>Petschek's analysis gives a reconnection rate:</p>
<p>$$M_A \sim \frac{\pi}{8 \ln S}$$</p>
<p>For $S = 10^{14}$:</p>
<p>$$M_A \sim \frac{\pi}{8 \ln(10^{14})} \sim \frac{3.14}{8 \times 32} \sim 0.012$$</p>
<p>This is remarkably close to observed rates! The logarithmic dependence on $S$ makes the rate nearly independent of resistivity for large $S$.</p>
<p><strong>Derivation sketch:</strong></p>
<p>The reconnection electric field is $E_z = v_{in} B_{in}$. In the diffusion region:</p>
<p>$$E_z = \eta J_z \sim \eta \frac{B_{in}}{\mu_0 \delta}$$</p>
<p>Equating:</p>
<p>$$v_{in} B_{in} \sim \eta \frac{B_{in}}{\mu_0 \delta}$$</p>
<p>$$v_{in} \sim \frac{\eta}{\mu_0 \delta}$$</p>
<p>The diffusion region size is set by local physics:</p>
<p>$$\delta \sim \frac{\eta}{\mu_0 v_A}$$</p>
<p>So:</p>
<p>$$v_{in} \sim \frac{\eta}{\mu_0 \eta/(\mu_0 v_A)} = v_A$$</p>
<p>But this would give $M_A = 1$, which is too fast (causality violation). The constraint comes from matching the slow shock angle to the diffusion region size:</p>
<p>$$\psi \sim \frac{1}{\ln S}$$</p>
<p>The reconnection rate becomes:</p>
<p>$$M_A \sim \frac{1}{\ln S}$$</p>
<p>with a numerical prefactor $\pi/8$ from detailed shock analysis.</p>
<h3 id="34-stability-of-petschek-reconnection">3.4 Stability of Petschek Reconnection<a class="header-link" href="#34-stability-of-petschek-reconnection" title="Permanent link">&para;</a></h3>
<p>A major problem was discovered by Biskamp (1986): <strong>Petschek reconnection is unstable for uniform resistivity</strong>.</p>
<p>Numerical simulations showed that with uniform $\eta$, the system evolves to a Sweet-Parker configuration, not a Petschek one. The slow shocks do not form.</p>
<p><strong>When does Petschek work?</strong></p>
<p>Petschek reconnection can occur when:</p>
<ol>
<li><strong>Localized resistivity</strong>: $\eta$ enhanced near the X-point (e.g., by anomalous resistivity)</li>
<li><strong>Time-dependent</strong>: Transient fast reconnection before evolving to Sweet-Parker</li>
<li><strong>Kinetic effects</strong>: Collisionless reconnection (Hall MHD, two-fluid, kinetic)</li>
</ol>
<p>In resistive MHD with uniform $\eta$, Sweet-Parker is the stable steady state. However, nature rarely provides uniform resistivity, and collisionless effects dominate in many plasmas.</p>
<h2 id="4-hall-mhd-and-collisionless-reconnection">4. Hall MHD and Collisionless Reconnection<a class="header-link" href="#4-hall-mhd-and-collisionless-reconnection" title="Permanent link">&para;</a></h2>
<h3 id="41-the-hall-term">4.1 The Hall Term<a class="header-link" href="#41-the-hall-term" title="Permanent link">&para;</a></h3>
<p>In a collisionless plasma, ions and electrons can move independently on scales smaller than the ion inertial length (ion skin depth):</p>
<p>$$d_i = \frac{c}{\omega_{pi}} = \frac{1}{\sqrt{\mu_0 n e^2 / m_i}} \approx 2.28 \times 10^7 \sqrt{\frac{10^6 \text{ cm}^{-3}}{n}} \text{ cm}$$</p>
<p>For typical solar corona parameters ($n \sim 10^{10}$ cm‚Åª¬≥), $d_i \sim 70$ km, much smaller than the global scale $L \sim 10^4$ km.</p>
<p>On scales smaller than $d_i$, the Hall term in the generalized Ohm's law becomes important:</p>
<p>$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \eta \mathbf{J} + \frac{1}{ne} \mathbf{J} \times \mathbf{B} + \text{other terms}$$</p>
<p>The Hall term is $\mathbf{J} \times \mathbf{B}/(ne)$.</p>
<p><strong>Physical interpretation:</strong></p>
<ul>
<li>On scales $\gg d_i$: Electrons and ions move together (single-fluid MHD)</li>
<li>On scales $\sim d_i$: Ions decouple from the magnetic field</li>
<li>On scales $< d_i$: Electrons carry current and control dynamics</li>
</ul>
<h3 id="42-hall-mhd-equations">4.2 Hall MHD Equations<a class="header-link" href="#42-hall-mhd-equations" title="Permanent link">&para;</a></h3>
<p>Hall MHD consists of:</p>
<p><strong>Continuity:</strong></p>
<p>$$\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0$$</p>
<p><strong>Momentum:</strong></p>
<p>$$\rho \frac{d\mathbf{v}}{dt} = -\nabla p + \mathbf{J} \times \mathbf{B}$$</p>
<p><strong>Induction (with Hall term):</strong></p>
<p>$$\frac{\partial \mathbf{B}}{\partial t} = \nabla \times (\mathbf{v} \times \mathbf{B}) - \nabla \times \left( \frac{1}{ne} \mathbf{J} \times \mathbf{B} \right) + \eta \nabla^2 \mathbf{B}$$</p>
<p><strong>Amp√®re's law:</strong></p>
<p>$$\mathbf{J} = \frac{1}{\mu_0} \nabla \times \mathbf{B}$$</p>
<p>The Hall term can be rewritten as:</p>
<p>$$\nabla \times \left( \frac{1}{ne} \mathbf{J} \times \mathbf{B} \right) = \nabla \times \left( \frac{1}{\mu_0 ne} (\nabla \times \mathbf{B}) \times \mathbf{B} \right)$$</p>
<p>Defining the ion skin depth $d_i = c/\omega_{pi}$, this term scales as $v_A B/d_i$.</p>
<h3 id="43-structure-of-hall-reconnection">4.3 Structure of Hall Reconnection<a class="header-link" href="#43-structure-of-hall-reconnection" title="Permanent link">&para;</a></h3>
<p>Hall reconnection has a <strong>two-scale structure</strong>:</p>
<ol>
<li><strong>Outer region</strong> ($r > d_i$): Ion-controlled, obeys standard MHD</li>
<li>Ions and electrons frozen to field</li>
<li>
<p>Scale: $L \sim 100 d_i$ or larger</p>
</li>
<li>
<p><strong>Inner diffusion region</strong> ($r \sim d_i$): Electron-controlled</p>
</li>
<li>Ions decoupled, electrons frozen to field</li>
<li>Out-of-plane (Hall) magnetic field generated</li>
<li>Current carried by electrons</li>
</ol>
<p><strong>Quadrupolar Hall field:</strong></p>
<p>The Hall term generates an out-of-plane (guide field direction) magnetic field with quadrupolar symmetry:</p>
<div class="highlight"><pre><span></span><code>        B_z &gt; 0  |  B_z &lt; 0
                 |
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅX‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
                 |
        B_z &lt; 0  |  B_z &gt; 0
</code></pre></div>

<p>This quadrupolar $B_z$ structure is a <strong>smoking gun signature</strong> of Hall reconnection, observed in:
- Magnetotail reconnection (Cluster, MMS satellites)
- Laboratory reconnection experiments (MRX, VTF)
- Simulations (GEM Challenge)</p>
<h3 id="44-hall-reconnection-rate">4.4 Hall Reconnection Rate<a class="header-link" href="#44-hall-reconnection-rate" title="Permanent link">&para;</a></h3>
<p>The key result: <strong>Hall reconnection gives a fast rate independent of resistivity</strong> for large $S$.</p>
<p><strong>Scaling arguments:</strong></p>
<p>In the ion diffusion region, the reconnection electric field is:</p>
<p>$$E_z \sim v_{in} B_{in}$$</p>
<p>In the electron diffusion region (size $\delta_e \sim d_e$, electron skin depth), electron physics dominates. The reconnection rate is set by electron dynamics, giving:</p>
<p>$$v_{in} \sim 0.1 v_A$$</p>
<p>The rate $M_A \sim 0.1$ is observed in many Hall MHD simulations and is independent of $S$ (as long as $S$ is large enough that $d_i < L$).</p>
<p><strong>Why is it fast?</strong></p>
<p>The ion decoupling allows a much shorter diffusion region ($\delta \sim d_i$ instead of $\delta \sim L/S^{1/2}$). The aspect ratio is:</p>
<p>$$\frac{\delta}{L} \sim \frac{d_i}{L}$$</p>
<p>not $1/S$, so the reconnection rate becomes independent of resistivity.</p>
<h3 id="45-gem-reconnection-challenge">4.5 GEM Reconnection Challenge<a class="header-link" href="#45-gem-reconnection-challenge" title="Permanent link">&para;</a></h3>
<p>The Geospace Environmental Modeling (GEM) Magnetic Reconnection Challenge (Birn et al. 2001) was a community effort to benchmark reconnection simulations.</p>
<p><strong>Setup:</strong></p>
<ul>
<li>Harris current sheet equilibrium</li>
<li>2D periodic domain</li>
<li>Various codes: Hall MHD, two-fluid, hybrid, full PIC</li>
<li>Compare reconnection rate, structure, time evolution</li>
</ul>
<p><strong>Key results:</strong></p>
<ol>
<li><strong>Fast reconnection</strong>: All codes found $M_A \sim 0.1$, independent of $\eta$ for large $S$</li>
<li><strong>Quadrupolar Hall field</strong>: Confirmed in all Hall/kinetic models</li>
<li><strong>Two-scale structure</strong>: Ion and electron diffusion regions clearly separated</li>
<li><strong>Electron heating</strong>: Temperature anisotropy develops near X-point</li>
<li><strong>Plasmoid formation</strong>: At very large $S$, secondary islands form (see Lesson 7)</li>
</ol>
<p>The GEM Challenge established that collisionless reconnection is generically fast, resolving the reconnection rate problem for space plasmas.</p>
<h2 id="5-x-point-geometry-and-magnetic-topology">5. X-Point Geometry and Magnetic Topology<a class="header-link" href="#5-x-point-geometry-and-magnetic-topology" title="Permanent link">&para;</a></h2>
<h3 id="51-x-point-configuration">5.1 X-Point Configuration<a class="header-link" href="#51-x-point-configuration" title="Permanent link">&para;</a></h3>
<p>An X-point is a <strong>magnetic null</strong> where $\mathbf{B} = 0$. Near an X-point in 2D, the field can be Taylor-expanded:</p>
<p>$$B_x \approx B_0 \frac{x}{L}$$</p>
<p>$$B_y \approx -B_0 \frac{y}{L}$$</p>
<p>where $B_0$ and $L$ are characteristic field strength and length scale.</p>
<p><strong>Field lines</strong> near the X-point are hyperbolas:</p>
<p>$$xy = \text{const}$$</p>
<p><strong>Separatrices</strong> are the field lines passing through the X-point (where const = 0):
- $x = 0$: vertical separatrix
- $y = 0$: horizontal separatrix</p>
<p>These separate regions of different magnetic topology.</p>
<h3 id="52-magnetic-topology-and-topology-change">5.2 Magnetic Topology and Topology Change<a class="header-link" href="#52-magnetic-topology-and-topology-change" title="Permanent link">&para;</a></h3>
<p><strong>Magnetic topology</strong> refers to the connectivity of field lines. In 2D, topology is characterized by:
- Which field lines connect to which boundaries
- Location of X-points (nulls) and O-points (extrema)</p>
<p><strong>Ideal MHD preserves topology:</strong></p>
<p>In ideal MHD, the frozen-in theorem guarantees that field line connectivity is conserved. If two plasma elements are on the same field line initially, they remain on the same field line.</p>
<p><strong>Reconnection changes topology:</strong></p>
<p>Reconnection allows field lines to break and reconnect, changing connectivity. This is the essence of reconnection.</p>
<div class="highlight"><pre><span></span><code>Before reconnection:        After reconnection:

    A ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê B            A ‚ïê‚ïê‚ïê‚ïê‚ïó
                                      ‚ïë
         X (no flow)                  X (reconnection)
                                      ‚ïë
    C ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê D            C ‚ïê‚ïê‚ïê‚ïê‚ïù

    A connects to B             A connects to D
    C connects to D             C connects to B
</code></pre></div>

<p>The rate of topology change is measured by the reconnection electric field $E_z$.</p>
<h3 id="53-separatrices-and-magnetic-islands">5.3 Separatrices and Magnetic Islands<a class="header-link" href="#53-separatrices-and-magnetic-islands" title="Permanent link">&para;</a></h3>
<p><strong>Separatrices</strong> divide regions of different topology. Plasma crossing a separatrix changes field line connection.</p>
<p><strong>Magnetic islands (O-points):</strong></p>
<p>When reconnection is not complete, closed field lines can form, creating magnetic islands (plasmoids). An O-point is a local maximum/minimum of the flux function $\psi$.</p>
<p>In a current sheet, multiple X-points and O-points can form:</p>
<div class="highlight"><pre><span></span><code>    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄO‚îÄ‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄO‚îÄ‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄO‚îÄ‚îÄ‚îÄ‚îÄ
</code></pre></div>

<p>This chain structure is important in turbulent or high-$S$ reconnection (plasmoid instability, Lesson 7).</p>
<h3 id="54-the-vector-potential-and-flux-function">5.4 The Vector Potential and Flux Function<a class="header-link" href="#54-the-vector-potential-and-flux-function" title="Permanent link">&para;</a></h3>
<p>In 2D, the magnetic field can be written in terms of a flux function $\psi$:</p>
<p>$$\mathbf{B} = \nabla \psi \times \hat{z}$$</p>
<p>or in components:</p>
<p>$$B_x = \frac{\partial \psi}{\partial y}, \quad B_y = -\frac{\partial \psi}{\partial x}$$</p>
<p>Field lines are contours of $\psi$. The X-point is a saddle point of $\psi$, and O-points are local extrema.</p>
<p>The induction equation becomes an evolution equation for $\psi$:</p>
<p>$$\frac{\partial \psi}{\partial t} = -E_z + \eta J_z$$</p>
<p>where $J_z = -\nabla^2 \psi / \mu_0$.</p>
<p>At an X-point, $\nabla \psi = 0$ (since $\mathbf{B} = 0$), so:</p>
<p>$$\left( \frac{\partial \psi}{\partial t} \right)_{X} = -E_z$$</p>
<p>The reconnection electric field directly measures the rate of change of flux at the X-point.</p>
<h2 id="6-measuring-reconnection-rates">6. Measuring Reconnection Rates<a class="header-link" href="#6-measuring-reconnection-rates" title="Permanent link">&para;</a></h2>
<h3 id="61-dimensionless-reconnection-rate">6.1 Dimensionless Reconnection Rate<a class="header-link" href="#61-dimensionless-reconnection-rate" title="Permanent link">&para;</a></h3>
<p>The standard measure is the <strong>Alfv√©nic Mach number</strong>:</p>
<p>$$M_A = \frac{v_{in}}{v_A}$$</p>
<p>where $v_{in}$ is the inflow velocity into the diffusion region and $v_A = B_{in}/\sqrt{\mu_0 \rho}$ is the Alfv√©n speed based on the upstream field.</p>
<p><strong>Typical values:</strong></p>
<ul>
<li>Sweet-Parker: $M_A \sim S^{-1/2} \sim 10^{-7}$ for solar corona</li>
<li>Petschek: $M_A \sim (\ln S)^{-1} \sim 0.01$</li>
<li>Hall/collisionless: $M_A \sim 0.1$</li>
</ul>
<h3 id="62-reconnection-electric-field">6.2 Reconnection Electric Field<a class="header-link" href="#62-reconnection-electric-field" title="Permanent link">&para;</a></h3>
<p>An equivalent measure is the reconnection electric field $E_{rec}$:</p>
<p>$$E_{rec} = v_{in} B_{in}$$</p>
<p>Normalized by the characteristic electric field $v_A B_{in}$:</p>
<p>$$\tilde{E} = \frac{E_{rec}}{v_A B_{in}} = M_A$$</p>
<p>In steady state, $E_{rec}$ is uniform throughout the reconnection region.</p>
<h3 id="63-flux-transfer-rate">6.3 Flux Transfer Rate<a class="header-link" href="#63-flux-transfer-rate" title="Permanent link">&para;</a></h3>
<p>The rate of magnetic flux reconnected per unit time (per unit length in the third dimension):</p>
<p>$$\frac{d\Phi}{dt} = E_{rec} \cdot (\text{length in } z)$$</p>
<p>In 2D simulations, this is often plotted as a function of time to diagnose the reconnection phase.</p>
<h3 id="64-observational-measures">6.4 Observational Measures<a class="header-link" href="#64-observational-measures" title="Permanent link">&para;</a></h3>
<p>In observations (e.g., spacecraft data), reconnection rates are inferred from:</p>
<ol>
<li><strong>Inflow velocity</strong>: Measured by Doppler shifts or particle instruments</li>
<li><strong>Outflow velocity</strong>: Often near $v_A$, confirming Alfv√©nic reconnection</li>
<li><strong>Hall magnetic field</strong>: Quadrupolar $B_z$ signature (MMS observations)</li>
<li><strong>Energetic particles</strong>: Accelerated particles indicate reconnection</li>
</ol>
<p>For solar flares, the reconnection rate is estimated from:</p>
<p>$$M_A \sim \frac{v_{up}}{v_A}$$</p>
<p>where $v_{up}$ is the velocity of upward-moving flare ribbons (tracing reconnection footpoints), typically $\sim 10$‚Äì100 km/s, giving $M_A \sim 0.01$‚Äì$0.1$.</p>
<h2 id="7-python-examples">7. Python Examples<a class="header-link" href="#7-python-examples" title="Permanent link">&para;</a></h2>
<h3 id="71-sweet-parker-vs-petschek-scaling">7.1 Sweet-Parker vs Petschek Scaling<a class="header-link" href="#71-sweet-parker-vs-petschek-scaling" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Lundquist number range</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Sweet-Parker reconnection rate</span>
<span class="n">M_SP</span> <span class="o">=</span> <span class="n">S</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Petschek reconnection rate</span>
<span class="n">M_P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>

<span class="c1"># Hall reconnection rate (approximately constant)</span>
<span class="n">M_Hall</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">M_SP</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sweet-Parker ($S^{-1/2}$)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">M_P</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Petschek ($\pi/(8\ln S)$)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">M_Hall</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hall (collisionless)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Mark typical regimes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Laboratory&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1e14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e14</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Solar corona&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lundquist number $S$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A = v_</span><span class="si">{in}</span><span class="s1">/v_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reconnection Rate Scaling&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1e16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reconnection_rate_scaling.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print example values</span>
<span class="n">S_examples</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="mf">1e14</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reconnection rates for different regimes:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;S&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Sweet-Parker&#39;</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Petschek&#39;</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Hall&#39;</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">S_examples</span><span class="p">:</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="n">s</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">&gt;10.1e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sp</span><span class="si">:</span><span class="s2">&gt;15.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">&gt;15.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">&gt;15.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="72-x-point-magnetic-field-structure">7.2 X-Point Magnetic Field Structure<a class="header-link" href="#72-x-point-magnetic-field-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Create grid</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Magnetic field components for X-point (normalized)</span>
<span class="n">Bx</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">By</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span>

<span class="c1"># Field magnitude</span>
<span class="n">B_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create figure with field lines and strength</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Left panel: Field lines</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Plot field lines using streamplot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">B_mag</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
              <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X-point&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Separatrices&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;X-Point Magnetic Field Lines&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Right panel: Field strength</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">B_mag</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">B_mag</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;wx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$|</span><span class="se">\\</span><span class="s1">mathbf</span><span class="si">{B}</span><span class="s1">|/B_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnetic Field Strength&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;xpoint_structure.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot hyperbolic field lines explicitly</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Field lines are xy = const</span>
<span class="n">constants</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constants</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x_pos</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">y_pos</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">x_pos</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">y_pos</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">x_pos</span><span class="p">,</span> <span class="o">-</span><span class="n">y_pos</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x_neg</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">y_neg</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">x_neg</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_neg</span><span class="p">,</span> <span class="n">y_neg</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">x_neg</span><span class="p">,</span> <span class="o">-</span><span class="n">y_neg</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Separatrices</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Separatrices&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X-point (null)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hyperbolic Field Lines Near X-Point&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;xpoint_hyperbolic.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="73-sweet-parker-diffusion-region-aspect-ratio">7.3 Sweet-Parker Diffusion Region Aspect Ratio<a class="header-link" href="#73-sweet-parker-diffusion-region-aspect-ratio" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Lundquist number</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Sweet-Parker aspect ratio</span>
<span class="n">delta_over_L</span> <span class="o">=</span> <span class="n">S</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Sheet length to width ratio</span>
<span class="n">L_over_delta</span> <span class="o">=</span> <span class="n">S</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Left: aspect ratio</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">delta_over_L</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">delta/L = 0.1$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">delta/L = 0.01$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Lundquist number $S$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Aspect ratio $</span><span class="se">\\</span><span class="s1">delta/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sweet-Parker Diffusion Region Aspect Ratio&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Right: reconnection rate vs aspect ratio</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">M_A</span> <span class="o">=</span> <span class="n">S</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">delta_over_L</span><span class="p">,</span> <span class="n">M_A</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Aspect ratio $</span><span class="se">\\</span><span class="s1">delta/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$M_A$ vs $</span><span class="se">\\</span><span class="s1">delta/L$ (Sweet-Parker)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="c1"># Add scaling annotation</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s1">&#39;$M_A = </span><span class="se">\\</span><span class="s1">delta/L = S^{-1/2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sweet_parker_aspect_ratio.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print examples</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sweet-Parker diffusion region properties:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;S&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Œ¥/L&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;L/Œ¥&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;M_A&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">S_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="mf">1e12</span><span class="p">,</span> <span class="mf">1e14</span><span class="p">]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">S_vals</span><span class="p">:</span>
    <span class="n">d_L</span> <span class="o">=</span> <span class="n">s</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">L_d</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">s</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">&gt;12.0e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">d_L</span><span class="si">:</span><span class="s2">&gt;12.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">L_d</span><span class="si">:</span><span class="s2">&gt;12.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">M</span><span class="si">:</span><span class="s2">&gt;12.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="74-hall-reconnection-quadrupolar-field">7.4 Hall Reconnection Quadrupolar Field<a class="header-link" href="#74-hall-reconnection-quadrupolar-field" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Grid</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># In-plane reconnecting field (X-point)</span>
<span class="n">Bx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="n">By</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Out-of-plane Hall field (quadrupolar)</span>
<span class="c1"># Model: Bz proportional to xy near origin, decaying with distance</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Bz</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Current sheet profile</span>
<span class="n">J_z</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Panel 1: In-plane field</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;In-Plane Magnetic Field ($B_x$, $B_y$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Panel 2: Out-of-plane Hall field</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bz</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bz</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$B_z/B_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Out-of-Plane Hall Field ($B_z$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Panel 3: Current density</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">J_z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">J_z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$J_z/J_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Current Density ($J_z$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Panel 4: Line plot of Bz along x-axis</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_cuts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">y_cut</span> <span class="ow">in</span> <span class="n">y_cuts</span><span class="p">:</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_cut</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Bz</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$y/d_i = </span><span class="si">{</span><span class="n">y_cut</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$B_z/B_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hall Field Profile Along $x$ (Quadrupolar Structure)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hall_reconnection_field.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Schematic of two-scale structure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Outer ion diffusion region</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_ion</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y_ion</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x_ion</span><span class="p">,</span> <span class="n">y_ion</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ion diffusion region ($</span><span class="se">\\</span><span class="s1">sim d_i$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_ion</span><span class="p">,</span> <span class="n">y_ion</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Inner electron diffusion region</span>
<span class="n">x_elec</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y_elec</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x_elec</span><span class="p">,</span> <span class="n">y_elec</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Electron diffusion region ($</span><span class="se">\\</span><span class="s1">sim d_e$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_elec</span><span class="p">,</span> <span class="n">y_elec</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># X-point</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Separatrices</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Inflow/outflow arrows</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Inflow&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;Outflow&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Two-Scale Structure of Hall Reconnection&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hall_two_scale_structure.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="75-reconnection-rate-evolution">7.5 Reconnection Rate Evolution<a class="header-link" href="#75-reconnection-rate-evolution" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Time array</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># Sweet-Parker approach to steady state (slow)</span>
<span class="n">M_SP</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mi">30</span><span class="p">))</span>

<span class="c1"># Petschek burst (faster)</span>
<span class="n">M_P</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Hall reconnection (fast, sustained)</span>
<span class="n">M_Hall</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Combined example: onset, burst, quasi-steady</span>
<span class="n">M_combined</span> <span class="o">=</span> <span class="n">M_SP</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">M_combined</span> <span class="o">+=</span> <span class="n">M_P</span>
<span class="n">M_combined</span> <span class="o">+=</span> <span class="n">M_Hall</span> <span class="o">*</span> <span class="mf">0.5</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Panel 1: Individual models</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_SP</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sweet-Parker (slow)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_P</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Petschek burst&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_Hall</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hall (fast)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time ($t v_A / L$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Idealized Reconnection Rate Profiles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>

<span class="c1"># Panel 2: Combined realistic scenario</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_combined</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Typical Hall rate (~0.1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Typical Petschek rate (~0.01)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">M_combined</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>

<span class="c1"># Annotate phases</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Onset&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Burst&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Quasi-steady&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time ($t v_A / L$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Realistic Time-Dependent Reconnection&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reconnection_rate_evolution.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="summary">Summary<a class="header-link" href="#summary" title="Permanent link">&para;</a></h2>
<p>Magnetic reconnection is a fundamental process that changes magnetic topology and converts magnetic energy to plasma energy. We covered:</p>
<ol>
<li>
<p><strong>Sweet-Parker model</strong>: Steady-state reconnection in a long, thin current sheet. The rate $M_A \sim S^{-1/2}$ is far too slow for astrophysical applications when $S \sim 10^{14}$.</p>
</li>
<li>
<p><strong>Petschek model</strong>: Reconnection with slow MHD shocks, giving a rate $M_A \sim (\ln S)^{-1} \sim 0.01$. However, this requires localized resistivity and is unstable with uniform $\eta$.</p>
</li>
<li>
<p><strong>Hall MHD reconnection</strong>: In collisionless plasmas, ions decouple on scales $\sim d_i$ (ion skin depth), leading to a two-scale structure. The reconnection rate is fast ($M_A \sim 0.1$) and independent of resistivity. The quadrupolar Hall magnetic field is a key observational signature.</p>
</li>
<li>
<p><strong>X-point geometry</strong>: Magnetic nulls where $\mathbf{B} = 0$, with hyperbolic field line structure. Separatrices divide regions of different topology. Reconnection changes field line connectivity.</p>
</li>
<li>
<p><strong>Reconnection rate measures</strong>: The dimensionless rate $M_A = v_{in}/v_A$ is the standard measure. Observed rates in solar flares and magnetospheric substorms are $\sim 0.01$‚Äì$0.1$, consistent with Petschek and Hall reconnection.</p>
</li>
</ol>
<p>The resolution of the reconnection rate problem came from recognizing that collisionless effects (Hall physics, kinetic effects) dominate in most natural plasmas, enabling fast reconnection independent of classical resistivity. The GEM Challenge confirmed that kinetic reconnection generically gives $M_A \sim 0.1$.</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Sweet-Parker scaling</strong>:
   a) Derive the Sweet-Parker reconnection rate starting from mass conservation, momentum balance, and Ohm's law.
   b) For Earth's magnetotail ($L = 10^7$ m, $B = 20$ nT, $n = 10^6$ m‚Åª¬≥, $\eta = 10^{-2}$ Œ©¬∑m), calculate $S$ and $M_A$.
   c) Estimate the reconnection time scale. Is this consistent with observed substorm onset times (~1 hour)?</p>
</li>
<li>
<p><strong>Petschek vs Sweet-Parker</strong>:
   a) At what Lundquist number does the Petschek rate exceed the Sweet-Parker rate?
   b) Plot the ratio $M_P / M_{SP}$ as a function of $S$ for $S = 10^2$ to $10^{16}$.
   c) Explain physically why Petschek is faster.</p>
</li>
<li>
<p><strong>Hall reconnection</strong>:
   a) For solar corona parameters ($n = 10^{16}$ m‚Åª¬≥), calculate the ion skin depth $d_i$.
   b) If the global scale is $L = 10^9$ m, what is the scale separation $L/d_i$?
   c) Sketch the two-scale structure (ion and electron diffusion regions).</p>
</li>
<li>
<p><strong>X-point field</strong>:
   a) For the field $\mathbf{B} = B_0 (x \hat{x} - y \hat{y})/L$, find the field lines (contours of $\psi$).
   b) Calculate the magnetic field strength $|\mathbf{B}|$ as a function of position.
   c) Where is $|\mathbf{B}|$ maximum? Minimum?</p>
</li>
<li>
<p><strong>Reconnection electric field</strong>:
   a) If $v_{in} = 0.1 v_A$ and $B_{in} = 0.01$ T, what is the reconnection electric field $E_{rec}$?
   b) If the Alfv√©n speed is $v_A = 10^6$ m/s, calculate $E_{rec}$ in V/m.
   c) How much magnetic flux reconnects per second across a length of 1000 km in the $z$-direction?</p>
</li>
<li>
<p><strong>Quadrupolar Hall field</strong>:
   a) Explain physically why the Hall term $\mathbf{J} \times \mathbf{B}/(ne)$ generates an out-of-plane field.
   b) Sketch the quadrupolar $B_z$ structure for an X-point in the $xy$-plane.
   c) How would spacecraft traversing the diffusion region observe this field?</p>
</li>
<li>
<p><strong>Simulation analysis</strong>:
   a) In a 2D MHD simulation, you measure $v_{in} = 0.05 v_A$ during the reconnection phase. What is $M_A$?
   b) If the simulation has $\eta = 10^{-4}$ (code units), $L = 10$, $v_A = 1$, calculate $S$.
   c) Is this reconnection rate consistent with Sweet-Parker, Petschek, or Hall reconnection?</p>
</li>
<li>
<p><strong>Energy conversion</strong>:
   a) The magnetic energy inflow rate per unit volume is $\sim v_{in} B^2/(2\mu_0)$. If $M_A = 0.1$, express this in terms of $v_A$ and $B$.
   b) Compare the magnetic energy inflow rate to the kinetic energy outflow rate $\sim \rho v_{out}^3 / 2$.
   c) Where does the "missing" energy go?</p>
</li>
<li>
<p><strong>GEM Challenge</strong>:
   a) Research the GEM Reconnection Challenge setup (Harris sheet, perturbation, boundary conditions).
   b) What were the key findings regarding reconnection rate from different codes?
   c) How did resistive MHD results differ from Hall MHD and kinetic results?</p>
</li>
<li>
<p><strong>Observational signatures</strong>:
    a) List three observational signatures of magnetic reconnection in the magnetotail.
    b) How does the MMS (Magnetospheric Multiscale) mission measure the Hall fields?
    c) What would you expect to observe if a spacecraft crossed the ion diffusion region but not the electron diffusion region?</p>
</li>
</ol>
<h2 id="navigation">Navigation<a class="header-link" href="#navigation" title="Permanent link">&para;</a></h2>
<p>Previous: <a href="./04_Current_Driven_Instabilities.md">Current-Driven Instabilities</a> | Next: <a href="./06_Reconnection_Applications.md">Reconnection Applications</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/04_Current_Driven_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">4. Current-Driven Instabilities</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/06_Reconnection_Applications.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">6. Reconnection Applications</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}