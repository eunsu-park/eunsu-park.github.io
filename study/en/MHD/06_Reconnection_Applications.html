{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6. Reconnection Applications - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">6. Reconnection Applications</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>6. Reconnection Applications</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/05_Reconnection_Theory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">5. Magnetic Reconnection Theory</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/07_Advanced_Reconnection.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">7. Advanced Reconnection</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-solar-flares">1. Solar Flares</a><ul>
<li><a href="#11-observational-overview">1.1 Observational Overview</a></li>
<li><a href="#12-the-cshkp-standard-model">1.2 The CSHKP Standard Model</a></li>
<li><a href="#13-reconnection-rate-in-flares">1.3 Reconnection Rate in Flares</a></li>
<li><a href="#14-observations-from-sdo-and-other-missions">1.4 Observations from SDO and Other Missions</a></li>
<li><a href="#15-python-example-cshkp-model-diagram">1.5 Python Example: CSHKP Model Diagram</a></li>
</ul>
</li>
<li><a href="#2-coronal-mass-ejections-cmes">2. Coronal Mass Ejections (CMEs)</a><ul>
<li><a href="#21-what-is-a-cme">2.1 What is a CME?</a></li>
<li><a href="#22-cme-initiation-and-reconnection">2.2 CME Initiation and Reconnection</a></li>
<li><a href="#23-space-weather-impact">2.3 Space Weather Impact</a></li>
<li><a href="#24-observations-of-cme-reconnection">2.4 Observations of CME Reconnection</a></li>
</ul>
</li>
<li><a href="#3-magnetospheric-substorms">3. Magnetospheric Substorms</a><ul>
<li><a href="#31-the-dungey-cycle">3.1 The Dungey Cycle</a></li>
<li><a href="#32-substorm-phases">3.2 Substorm Phases</a></li>
<li><a href="#33-near-earth-neutral-line-model">3.3 Near-Earth Neutral Line Model</a></li>
<li><a href="#34-python-example-dungey-cycle-cartoon">3.4 Python Example: Dungey Cycle Cartoon</a></li>
</ul>
</li>
<li><a href="#4-tokamak-sawtooth-crashes">4. Tokamak Sawtooth Crashes</a><ul>
<li><a href="#41-sawtooth-oscillations">4.1 Sawtooth Oscillations</a></li>
<li><a href="#42-kadomtsev-reconnection-model">4.2 Kadomtsev Reconnection Model</a></li>
<li><a href="#43-observations-and-simulations">4.3 Observations and Simulations</a></li>
<li><a href="#44-python-example-sawtooth-crash-simulation-1d-model">4.4 Python Example: Sawtooth Crash Simulation (1D Model)</a></li>
</ul>
</li>
<li><a href="#5-magnetic-island-coalescence">5. Magnetic Island Coalescence</a><ul>
<li><a href="#51-physics-of-island-coalescence">5.1 Physics of Island Coalescence</a></li>
<li><a href="#52-dynamics-and-reconnection-rate">5.2 Dynamics and Reconnection Rate</a></li>
<li><a href="#53-python-example-2d-island-coalescence">5.3 Python Example: 2D Island Coalescence</a></li>
</ul>
</li>
<li><a href="#6-astrophysical-jets-and-reconnection">6. Astrophysical Jets and Reconnection</a><ul>
<li><a href="#61-jets-in-astrophysics">6.1 Jets in Astrophysics</a></li>
<li><a href="#62-reconnection-driven-acceleration">6.2 Reconnection-Driven Acceleration</a></li>
<li><a href="#63-pulsar-magnetospheres">6.3 Pulsar Magnetospheres</a></li>
<li><a href="#64-gamma-ray-bursts">6.4 Gamma-Ray Bursts</a></li>
</ul>
</li>
<li><a href="#7-summary">7. Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
<li><a href="#navigation">Navigation</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="6-reconnection-applications">6. Reconnection Applications<a class="header-link" href="#6-reconnection-applications" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lesson, you should be able to:</p>
<ol>
<li>Describe the CSHKP model of solar flares and identify the key reconnection signatures</li>
<li>Explain the role of reconnection in coronal mass ejections (CMEs) and flux rope eruption</li>
<li>Understand the Dungey cycle and magnetospheric substorms</li>
<li>Analyze tokamak sawtooth crashes and the Kadomtsev reconnection model</li>
<li>Explain magnetic island coalescence and its dynamics</li>
<li>Describe reconnection in astrophysical jets and other high-energy phenomena</li>
<li>Implement simple models of these reconnection applications in Python</li>
</ol>
<h2 id="1-solar-flares">1. Solar Flares<a class="header-link" href="#1-solar-flares" title="Permanent link">&para;</a></h2>
<h3 id="11-observational-overview">1.1 Observational Overview<a class="header-link" href="#11-observational-overview" title="Permanent link">&para;</a></h3>
<p>Solar flares are the most powerful explosions in the solar system, releasing up to $10^{32}$ erg ($10^{25}$ J) of energy in minutes to hours. This is equivalent to billions of megatons of TNT, or 10 million volcanic eruptions occurring simultaneously.</p>
<p><strong>Key observational features:</strong></p>
<ul>
<li><strong>Electromagnetic emission</strong>: From radio waves to gamma rays</li>
<li>Soft X-ray emission: Thermal plasma at 10‚Äì30 MK</li>
<li>Hard X-ray emission: Non-thermal electrons (bremsstrahlung)</li>
<li>H-alpha ribbons: Chromospheric brightening at footpoints</li>
<li>
<p>White light emission: Rare, seen only in most energetic flares</p>
</li>
<li>
<p><strong>Particle acceleration</strong>: Electrons to tens of MeV, ions to GeV</p>
</li>
<li>Relativistic electrons: Radio bursts (gyrosynchrotron, plasma emission)</li>
<li>
<p>Energetic protons: Nuclear gamma-ray lines (de-excitation)</p>
</li>
<li>
<p><strong>Mass ejection</strong>: Often associated with CMEs (but not always)</p>
</li>
<li>
<p><strong>Time scales</strong>:</p>
</li>
<li>Preflare phase: Minutes to hours (energy storage)</li>
<li>Impulsive phase: Seconds to minutes (energy release)</li>
<li>Gradual phase: Minutes to hours (cooling, gradual particle acceleration)</li>
</ul>
<p><strong>Energy budget:</strong></p>
<p>The total energy released comes from magnetic energy stored in stressed coronal fields:</p>
<p>$$E_{mag} = \frac{B^2}{2\mu_0} \cdot V$$</p>
<p>For a flaring active region with $B \sim 0.01$ T, volume $V \sim (10^8 \text{ m})^3$:</p>
<p>$$E_{mag} \sim \frac{(0.01)^2}{2 \times 4\pi \times 10^{-7}} \times 10^{24} \sim 10^{26} \text{ J}$$</p>
<p>A significant fraction (10‚Äì50%) of this magnetic energy is released during the flare.</p>
<h3 id="12-the-cshkp-standard-model">1.2 The CSHKP Standard Model<a class="header-link" href="#12-the-cshkp-standard-model" title="Permanent link">&para;</a></h3>
<p>The standard model of eruptive solar flares is named after Carmichael, Sturrock, Hirayama, Kopp, and Pneuman (CSHKP model, developed 1964‚Äì1976). It invokes magnetic reconnection as the primary energy release mechanism.</p>
<p><strong>Cartoon structure:</strong></p>
<div class="highlight"><pre><span></span><code>                        CME
                         ‚ïë
                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïó
                    ‚ïë         ‚ïë  Erupting flux rope
                    ‚ïë    ‚òÄ    ‚ïë
                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïù
                         ‚ïë
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  Corona
                    X    ‚ïë  Reconnection point
                    ‚Üï    ‚ïë  Current sheet
    ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ
                         ‚ïë  Post-flare loops
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ï®‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ         ‚îÇ  Flare arcade
                    ‚îÇ ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë ‚îÇ  Hot plasma
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  Chromosphere
                    ‚Üì         ‚Üì  Downflows
               Ribbon 1    Ribbon 2  H-alpha brightening
</code></pre></div>

<p><strong>Key components:</strong></p>
<ol>
<li>
<p><strong>Pre-eruption</strong>: Magnetic flux rope (filament/prominence) is stored in the corona, held down by overlying arcade field.</p>
</li>
<li>
<p><strong>Loss of equilibrium</strong>: Flux rope becomes unstable (e.g., torus instability, loss of equilibrium) and begins to rise.</p>
</li>
<li>
<p><strong>Current sheet formation</strong>: As the flux rope rises, it stretches the underlying field, forming a vertical current sheet.</p>
</li>
<li>
<p><strong>Reconnection onset</strong>: Reconnection begins in the current sheet, releasing magnetic energy.</p>
</li>
<li>
<p><strong>Post-flare loops</strong>: Reconnected field lines form hot post-flare loops that rise sequentially.</p>
</li>
<li>
<p><strong>Footpoint heating</strong>: Energetic particles and thermal conduction fronts travel down field lines, heating the chromosphere.</p>
</li>
<li>
<p><strong>Flare ribbons</strong>: Heated chromospheric footpoints appear as bright H-alpha ribbons that separate as reconnection proceeds.</p>
</li>
<li>
<p><strong>Upward jet</strong>: Reconnection outflow launches the CME upward.</p>
</li>
</ol>
<p><strong>Energy release:</strong></p>
<p>Magnetic energy is converted to:
- <strong>Kinetic energy</strong>: Bulk plasma flows (outflows ~500‚Äì1000 km/s), CME kinetic energy
- <strong>Thermal energy</strong>: Heating of flare loops to 10‚Äì30 MK
- <strong>Non-thermal particles</strong>: Accelerated electrons and ions
- <strong>Radiation</strong>: X-rays, UV, optical, radio</p>
<p>The reconnection electric field accelerates particles, and turbulence in the reconnection region contributes to stochastic acceleration.</p>
<h3 id="13-reconnection-rate-in-flares">1.3 Reconnection Rate in Flares<a class="header-link" href="#13-reconnection-rate-in-flares" title="Permanent link">&para;</a></h3>
<p>The reconnection rate can be estimated from the <strong>ribbon separation velocity</strong>. As reconnection proceeds, the footpoints of the newly reconnected loops move apart. The ribbon separation speed $v_{sep}$ is related to the reconnection inflow speed $v_{in}$:</p>
<p>$$v_{sep} \approx v_{in} \frac{L_{corona}}{L_{ribbon}}$$</p>
<p>where $L_{corona}$ is the coronal height and $L_{ribbon}$ is the chromospheric footpoint separation.</p>
<p>Observed ribbon speeds are typically:</p>
<p>$$v_{sep} \sim 10\text{‚Äì}100 \text{ km/s}$$</p>
<p>With $L_{corona}/L_{ribbon} \sim 0.1$‚Äì1, this gives:</p>
<p>$$v_{in} \sim 10\text{‚Äì}100 \text{ km/s}$$</p>
<p>The Alfv√©n speed in the corona is $v_A \sim 1000$ km/s, so:</p>
<p>$$M_A = \frac{v_{in}}{v_A} \sim 0.01\text{‚Äì}0.1$$</p>
<p>This is consistent with fast reconnection (Petschek or Hall regime), not Sweet-Parker!</p>
<h3 id="14-observations-from-sdo-and-other-missions">1.4 Observations from SDO and Other Missions<a class="header-link" href="#14-observations-from-sdo-and-other-missions" title="Permanent link">&para;</a></h3>
<p>The Solar Dynamics Observatory (SDO), launched in 2010, has revolutionized flare observations with high-cadence (12 s), high-resolution (0.6 arcsec) images in extreme UV.</p>
<p><strong>Key findings:</strong></p>
<ul>
<li>
<p><strong>Supra-arcade downflows (SADs)</strong>: Dark, tadpole-shaped structures falling into the flare arcade at ~100 km/s. Interpreted as density voids (plasmoids) ejected downward from the reconnection site.</p>
</li>
<li>
<p><strong>Above-the-loop-top (ALT) hard X-ray sources</strong>: Non-thermal X-ray emission above the flare loops, indicating particle acceleration at the reconnection site.</p>
</li>
<li>
<p><strong>Reconnection inflow/outflow</strong>: Doppler measurements (Hinode/EIS) show inflows of ~10 km/s and outflows of ~500 km/s, consistent with reconnection models.</p>
</li>
<li>
<p><strong>Quasi-periodic pulsations (QPPs)</strong>: Oscillations in flare emission with periods from sub-seconds to minutes. Possibly related to plasmoid ejections (see Lesson 7).</p>
</li>
<li>
<p><strong>Magnetic flux rope structure</strong>: Observations of sigmoids (S-shaped structures) and flux ropes before eruption, supporting the CSHKP model.</p>
</li>
</ul>
<h3 id="15-python-example-cshkp-model-diagram">1.5 Python Example: CSHKP Model Diagram<a class="header-link" href="#15-python-example-cshkp-model-diagram" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">FancyBboxPatch</span><span class="p">,</span> <span class="n">FancyArrowPatch</span><span class="p">,</span> <span class="n">Wedge</span><span class="p">,</span> <span class="n">Ellipse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">patches</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="c1"># Coordinate system: x horizontal, y vertical</span>
<span class="c1"># Chromosphere at y=0, corona y&gt;0</span>

<span class="c1"># Chromosphere</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chromosphere&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Flare ribbons</span>
<span class="n">ribbon1</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Flare ribbons&#39;</span><span class="p">)</span>
<span class="n">ribbon2</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ribbon1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ribbon2</span><span class="p">)</span>

<span class="c1"># Post-flare loops</span>
<span class="n">n_loops</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
    <span class="n">y_top</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">x_width</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">0.3</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">x_loop</span> <span class="o">=</span> <span class="n">x_width</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">y_loop</span> <span class="o">=</span> <span class="n">y_top</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_loop</span><span class="p">,</span> <span class="n">y_loop</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Label one loop</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="s1">&#39;Post-flare loops&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">))</span>

<span class="c1"># Current sheet</span>
<span class="n">sheet_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">sheet_y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sheet_x</span><span class="p">,</span> <span class="n">sheet_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Current sheet&#39;</span><span class="p">)</span>

<span class="c1"># X-point</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconnection X-point&#39;</span><span class="p">)</span>

<span class="c1"># Inflow arrows</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="s1">&#39;Inflow&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Downward outflow</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="s1">&#39;Outflow</span><span class="se">\n</span><span class="s1">(downward)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Upward outflow</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="s1">&#39;Outflow</span><span class="se">\n</span><span class="s1">(upward)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Erupting flux rope (CME)</span>
<span class="n">flux_rope</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Erupting flux rope (CME)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">flux_rope</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># CME upward arrow</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">9.8</span><span class="p">,</span> <span class="s1">&#39;CME&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Particle beams to chromosphere</span>
<span class="k">for</span> <span class="n">x_foot</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_foot</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Energetic</span><span class="se">\n</span><span class="s1">particles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Solar Flare: CSHKP Standard Model&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;Corona&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;Chromosphere&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>

<span class="c1"># Annotations</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;Energy release: ~$10^</span><span class="si">{32}</span><span class="s1">$ erg&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">8.2</span><span class="p">,</span> <span class="s1">&#39;Duration: minutes to hours&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="s1">&#39;Reconnection rate: $M_A </span><span class="se">\\</span><span class="s1">sim 0.01$‚Äì$0.1$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightyellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;solar_flare_cshkp_model.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="2-coronal-mass-ejections-cmes">2. Coronal Mass Ejections (CMEs)<a class="header-link" href="#2-coronal-mass-ejections-cmes" title="Permanent link">&para;</a></h2>
<h3 id="21-what-is-a-cme">2.1 What is a CME?<a class="header-link" href="#21-what-is-a-cme" title="Permanent link">&para;</a></h3>
<p>A <strong>coronal mass ejection</strong> is a massive burst of solar plasma and magnetic field ejected into interplanetary space. CMEs are often (but not always) associated with solar flares.</p>
<p><strong>Typical properties:</strong></p>
<ul>
<li><strong>Mass</strong>: $10^{15}$‚Äì$10^{16}$ g (billion to 10 billion tons)</li>
<li><strong>Kinetic energy</strong>: $10^{30}$‚Äì$10^{32}$ erg</li>
<li><strong>Speed</strong>: 200‚Äì3000 km/s (average ~500 km/s, fast events &gt;1000 km/s)</li>
<li><strong>Occurrence rate</strong>: ~1 per day at solar maximum, ~1 per 5 days at solar minimum</li>
</ul>
<p><strong>Structure:</strong></p>
<p>CMEs often have a three-part structure:
1. <strong>Bright frontal loop</strong>: Compressed sheath
2. <strong>Dark cavity</strong>: Low-density flux rope core
3. <strong>Bright core</strong>: Prominence material</p>
<h3 id="22-cme-initiation-and-reconnection">2.2 CME Initiation and Reconnection<a class="header-link" href="#22-cme-initiation-and-reconnection" title="Permanent link">&para;</a></h3>
<p>CMEs are believed to result from the eruption of coronal magnetic flux ropes. The initiation mechanisms include:</p>
<p><strong>1. Torus Instability:</strong></p>
<p>A flux rope becomes unstable when the overlying field decreases sufficiently fast with height. The critical condition is:</p>
<p>$$\frac{d \ln B_{external}}{d \ln h} < -\frac{3}{2}$$</p>
<p>where $h$ is height. This is called the <strong>torus instability</strong> criterion. When met, the hoop force (self-inductance) overcomes the restraining force, and the flux rope erupts.</p>
<p><strong>2. Flux Cancellation:</strong></p>
<p>Opposite-polarity magnetic flux at the photosphere cancels (reconnects), removing the "anchor" of the overlying field and allowing the flux rope to erupt.</p>
<p><strong>3. Breakout Model:</strong></p>
<p>A quadrupolar configuration undergoes reconnection at a null point above the flux rope, removing the restraining field and triggering eruption.</p>
<p><strong>4. Kink Instability:</strong></p>
<p>If the flux rope is twisted beyond a critical threshold (typically twist $\sim 2\pi$ radians per length), it becomes kink-unstable and erupts.</p>
<p><strong>Reconnection's role:</strong></p>
<p>During the eruption, reconnection in the current sheet below the CME (as in the CSHKP model) performs two functions:
1. <strong>Releases magnetic energy</strong>: Powers the eruption and flare
2. <strong>Allows field topology change</strong>: Permits the flux rope to disconnect from the Sun</p>
<h3 id="23-space-weather-impact">2.3 Space Weather Impact<a class="header-link" href="#23-space-weather-impact" title="Permanent link">&para;</a></h3>
<p>When a fast CME impacts Earth, it can cause significant space weather effects:</p>
<ul>
<li><strong>Geomagnetic storms</strong>: Compressed magnetosphere, enhanced ring current, auroral activity</li>
<li>
<p>Strongest storms: Carrington Event (1859), Halloween storms (2003), St. Patrick's Day storm (2015)</p>
</li>
<li>
<p><strong>Radiation hazards</strong>: Energetic particles endanger astronauts and satellites</p>
</li>
<li>
<p><strong>Technology disruption</strong>:</p>
</li>
<li>Power grid failures (Quebec blackout, 1989)</li>
<li>Satellite damage and loss</li>
<li>GPS and communication disruptions</li>
<li>Aviation radiation exposure (polar routes)</li>
</ul>
<p>The <strong>transit time</strong> from Sun to Earth is 1‚Äì3 days for typical CMEs, providing some warning time for protective measures.</p>
<h3 id="24-observations-of-cme-reconnection">2.4 Observations of CME Reconnection<a class="header-link" href="#24-observations-of-cme-reconnection" title="Permanent link">&para;</a></h3>
<p>White-light coronagraphs (SOHO/LASCO, STEREO/COR) observe CMEs propagating through the corona. Key reconnection signatures include:</p>
<ul>
<li><strong>Streamer blowout</strong>: Eruption of the helmet streamer structure</li>
<li><strong>Post-CME current sheet</strong>: Faint ray-like structure trailing the CME</li>
<li><strong>Inflow/outflow</strong>: Doppler shifts in UV/EUV spectral lines</li>
</ul>
<p>The Heliospheric Imagers on STEREO tracked CMEs all the way to Earth, revealing complex interactions and deflections.</p>
<h2 id="3-magnetospheric-substorms">3. Magnetospheric Substorms<a class="header-link" href="#3-magnetospheric-substorms" title="Permanent link">&para;</a></h2>
<h3 id="31-the-dungey-cycle">3.1 The Dungey Cycle<a class="header-link" href="#31-the-dungey-cycle" title="Permanent link">&para;</a></h3>
<p>The Dungey cycle (1961) is the fundamental model of solar wind-magnetosphere coupling, driven by <strong>dayside and nightside reconnection</strong>.</p>
<p><strong>Dayside reconnection:</strong></p>
<p>When the interplanetary magnetic field (IMF) has a southward component ($B_z < 0$), it can reconnect with the Earth's northward-pointing field at the <strong>dayside magnetopause</strong>:</p>
<div class="highlight"><pre><span></span><code>    Solar Wind                  Magnetosphere

    IMF (southward)             Geomagnetic field
         ‚Üì                            ‚Üë
    ‚îÄ ‚îÄ ‚îÄX‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ  Magnetopause
         ‚Üì                            ‚Üì
       Reconnected field line
</code></pre></div>

<p>The newly reconnected field line is pulled tailward by the solar wind, transferring energy and flux to the magnetosphere.</p>
<p><strong>Nightside reconnection:</strong></p>
<p>In the magnetotail, the stretched field reconnects at the <strong>near-Earth neutral line</strong>:</p>
<div class="highlight"><pre><span></span><code>         Tail lobe (north)
              ‚Üë   ‚Üë
    ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄX‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ  Neutral line
              ‚Üì   ‚Üì
         Tail lobe (south)
</code></pre></div>

<p>Reconnection produces:
- <strong>Earthward flow</strong>: Plasma accelerated toward Earth (substorm injection)
- <strong>Tailward flow</strong>: Plasmoid ejected downtail</p>
<p>The cycle closes as the Earthward-moving flux returns to the dayside, completing the circulation.</p>
<p><strong>Energy budget:</strong></p>
<p>The solar wind delivers energy at a rate:</p>
<p>$$P \sim v B^2 / \mu_0 \times A_{cross}$$</p>
<p>where $A_{cross} \sim \pi R_M^2$ is the magnetospheric cross-section and $R_M \sim 10 R_E$ (Earth radii). For typical solar wind ($v = 400$ km/s, $B = 5$ nT):</p>
<p>$$P \sim 10^{11}\text{‚Äì}10^{12} \text{ W}$$</p>
<p>During substorms, stored energy (~$10^{15}$ J) is released in ~1 hour, giving power ~$10^{11}$ W.</p>
<h3 id="32-substorm-phases">3.2 Substorm Phases<a class="header-link" href="#32-substorm-phases" title="Permanent link">&para;</a></h3>
<p>A magnetospheric substorm is a global reconfiguration of the magnetosphere, typically lasting 2‚Äì3 hours.</p>
<p><strong>Growth phase</strong> (30‚Äì60 min):</p>
<ul>
<li>Dayside reconnection transfers flux to the tail</li>
<li>Magnetotail stretches and thins</li>
<li>Energy stored in the tail lobes</li>
<li>Auroral oval expands equatorward</li>
<li>Cross-tail current intensifies</li>
</ul>
<p><strong>Expansion phase</strong> (30‚Äì60 min):</p>
<ul>
<li>Onset of nightside reconnection</li>
<li>Sudden brightening of auroras (substorm onset)</li>
<li>Westward traveling surge</li>
<li>Dipolarization: Tail field becomes more dipolar</li>
<li>Energetic particle injection into inner magnetosphere</li>
<li>Bursty bulk flows (BBFs) in the plasma sheet</li>
</ul>
<p><strong>Recovery phase</strong> (~1 hour):</p>
<ul>
<li>Tail field relaxes to quiet-time configuration</li>
<li>Auroral activity subsides</li>
<li>Plasma sheet thickens</li>
</ul>
<p><strong>Observational signatures:</strong></p>
<ul>
<li><strong>Ground magnetometers</strong>: Negative bay in H-component (northward field decrease)</li>
<li><strong>Auroral images</strong>: Brightening and poleward expansion</li>
<li><strong>In situ spacecraft</strong>: Flow bursts, dipolarization fronts, particle injections</li>
<li><strong>Auroral kilometric radiation (AKR)</strong>: Intense radio emission</li>
</ul>
<h3 id="33-near-earth-neutral-line-model">3.3 Near-Earth Neutral Line Model<a class="header-link" href="#33-near-earth-neutral-line-model" title="Permanent link">&para;</a></h3>
<p>The <strong>Near-Earth Neutral Line (NENL) model</strong> attributes substorm onset to reconnection forming at $X \sim -20$ to $-30 R_E$ in the magnetotail.</p>
<p><strong>Sequence:</strong></p>
<ol>
<li>Growth phase: Current sheet thinning, pressure buildup</li>
<li>Onset: Reconnection initiates at the NENL</li>
<li>Expansion: Reconnection region extends in $X$ and $Y$ (dawn-dusk)</li>
<li>Earthward and tailward jets launched from X-line</li>
<li>Plasmoid (flux rope) ejected downtail</li>
<li>Dipolarization front propagates Earthward, delivering energetic particles</li>
</ol>
<p><strong>Evidence:</strong></p>
<ul>
<li>Spacecraft observations of tailward-moving plasmoids</li>
<li>Earthward bursty bulk flows with $v_x \sim 400$ km/s</li>
<li>Traveling compression regions (TCRs)</li>
<li>Hall magnetic field quadrupole (Cluster observations)</li>
</ul>
<p>The reconnection rate during substorms is $M_A \sim 0.1$, indicating fast (collisionless) reconnection.</p>
<h3 id="34-python-example-dungey-cycle-cartoon">3.4 Python Example: Dungey Cycle Cartoon<a class="header-link" href="#34-python-example-dungey-cycle-cartoon" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circle</span><span class="p">,</span> <span class="n">FancyArrowPatch</span><span class="p">,</span> <span class="n">Wedge</span><span class="p">,</span> <span class="n">Arc</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Earth</span>
<span class="n">earth</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Earth&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">earth</span><span class="p">)</span>

<span class="c1"># Magnetopause (dayside and nightside)</span>
<span class="n">theta_day</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">x_day</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_day</span><span class="p">)</span>
<span class="n">y_day</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_day</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_day</span><span class="p">,</span> <span class="n">y_day</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetopause&#39;</span><span class="p">)</span>

<span class="c1"># Tail magnetopause</span>
<span class="n">tail_y_top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">tail_x_top</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">tail_y_bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">tail_x_bot</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tail_x_top</span><span class="p">,</span> <span class="n">tail_y_top</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tail_x_bot</span><span class="p">,</span> <span class="n">tail_y_bot</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Dayside X-line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconnection X-line&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Dayside</span><span class="se">\n</span><span class="s1">reconnection&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Nightside X-line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Nightside</span><span class="se">\n</span><span class="s1">reconnection&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Solar wind</span>
<span class="k">for</span> <span class="n">y_sw</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_sw</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">y_sw</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;Solar Wind&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Open field lines (dayside to tail)</span>
<span class="c1"># Freshly reconnected line</span>
<span class="n">x_open1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)])</span>
<span class="n">y_open1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">30</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_open1</span><span class="p">,</span> <span class="n">y_open1</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_open1</span><span class="p">,</span> <span class="o">-</span><span class="n">y_open1</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Add arrows to show tailward motion</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="s1">&#39;Tailward</span><span class="se">\n</span><span class="s1">convection&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Closed field lines (dipolar)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]:</span>
    <span class="n">theta_closed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    <span class="n">x_closed</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_closed</span><span class="p">)</span>
    <span class="n">y_closed</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_closed</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_closed</span><span class="p">,</span> <span class="n">y_closed</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_closed</span><span class="p">,</span> <span class="o">-</span><span class="n">y_closed</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Sunward return flow</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Sunward</span><span class="se">\n</span><span class="s1">return&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Plasmoid ejection</span>
<span class="n">plasmoid</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">((</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plasmoid</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;Plasmoid&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Title and labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="s1">&#39;Dungey Cycle: Solar Wind-Magnetosphere Coupling&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="s1">&#39;IMF $B_z &lt; 0$ (southward)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">))</span>

<span class="c1"># Axes and formatting</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dungey_cycle.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="4-tokamak-sawtooth-crashes">4. Tokamak Sawtooth Crashes<a class="header-link" href="#4-tokamak-sawtooth-crashes" title="Permanent link">&para;</a></h2>
<h3 id="41-sawtooth-oscillations">4.1 Sawtooth Oscillations<a class="header-link" href="#41-sawtooth-oscillations" title="Permanent link">&para;</a></h3>
<p>In tokamak plasmas, the core electron temperature often exhibits <strong>sawtooth oscillations</strong>: a slow rise followed by a sudden crash.</p>
<div class="highlight"><pre><span></span><code>T_e
 |     /|     /|     /|
 |    / |    / |    / |
 |   /  |   /  |   /  |
 |  /   |  /   |  /   |
 | /    | /    | /    |
 |/_____|/_____|/_____|_____  Time
   Rise  Crash  Rise  Crash
</code></pre></div>

<p><strong>Characteristics:</strong></p>
<ul>
<li><strong>Rise phase</strong>: Temperature increases steadily over 10‚Äì100 ms</li>
<li><strong>Crash phase</strong>: Temperature drops by ~50% in &lt;100 Œºs</li>
<li><strong>Inversion radius</strong>: Radius inside which $T_e$ drops, outside which $T_e$ rises (redistribution)</li>
<li><strong>q-profile</strong>: Safety factor $q(r) = r B_\phi / (R B_\theta)$ drops below 1 at the core</li>
</ul>
<p><strong>Physical picture:</strong></p>
<ol>
<li>Rise phase: Central heating, peaked current profile, $q_0$ drops below 1</li>
<li>Trigger: Internal kink instability ($m/n = 1/1$ mode) develops</li>
<li>Reconnection: Helical magnetic surfaces reconnect</li>
<li>Crash: Rapid redistribution of heat and current</li>
<li>Reset: $q_0$ rises back above 1, cycle repeats</li>
</ol>
<h3 id="42-kadomtsev-reconnection-model">4.2 Kadomtsev Reconnection Model<a class="header-link" href="#42-kadomtsev-reconnection-model" title="Permanent link">&para;</a></h3>
<p>The <strong>Kadomtsev model</strong> (1975) explains the crash as full reconnection of the $q = 1$ surface.</p>
<p><strong>Before reconnection:</strong></p>
<p>The $q = 1$ surface is a nested flux surface at radius $r_1$. Inside, field lines wind once toroidally for each poloidal turn. The core is magnetically isolated.</p>
<p><strong>After reconnection:</strong></p>
<p>The helical perturbation causes the $q = 1$ surface to become a <strong>helical island</strong>. Full reconnection merges the island O-point with the original core, creating a new flat $q \approx 1$ profile.</p>
<p><strong>Topology change:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">Before</span><span class="o">:</span><span class="w">                  </span><span class="n">After</span><span class="o">:</span>

<span class="w">    </span><span class="n">Nested</span><span class="w">                  </span><span class="n">Flattened</span>
<span class="w">    </span><span class="n">surfaces</span><span class="w">                </span><span class="n">profile</span>
<span class="w">      </span><span class="err">‚óã</span><span class="w">                      </span><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
<span class="w">     </span><span class="err">‚ï±</span><span class="w"> </span><span class="err">‚ï≤</span><span class="w">                    </span><span class="err">‚ï±</span><span class="w">     </span><span class="err">‚ï≤</span>
<span class="w">    </span><span class="err">‚óã</span><span class="w"> </span><span class="err">‚óã</span><span class="w"> </span><span class="err">‚óã</span><span class="w">        </span><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ</span><span class="o">&gt;</span><span class="w">     </span><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
<span class="w">     </span><span class="err">‚ï≤</span><span class="w"> </span><span class="err">‚ï±</span><span class="w">                    </span><span class="err">‚ï≤</span><span class="w">     </span><span class="err">‚ï±</span>
<span class="w">      </span><span class="err">‚óã</span><span class="w">                      </span><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
<span class="w">     </span><span class="n">q</span><span class="o">=</span><span class="mi">1</span><span class="w">                     </span><span class="n">q</span><span class="err">‚âà</span><span class="mi">1</span>
</code></pre></div>

<p><strong>Heat redistribution:</strong></p>
<p>The reconnection rapidly mixes the hot core plasma outward and cooler edge plasma inward, causing:
- Core temperature drop
- Edge temperature rise (within the inversion radius)
- Flatten temperature profile</p>
<p><strong>Reconnection rate:</strong></p>
<p>The crash time is ~10‚Äì100 Œºs, much faster than resistive diffusion (which would take seconds). This suggests:</p>
<p>$$M_A \sim 0.01\text{‚Äì}0.1$$</p>
<p>consistent with collisionless reconnection on electron kinetic scales.</p>
<h3 id="43-observations-and-simulations">4.3 Observations and Simulations<a class="header-link" href="#43-observations-and-simulations" title="Permanent link">&para;</a></h3>
<p><strong>Experimental evidence:</strong></p>
<ul>
<li><strong>Soft X-ray tomography</strong>: Shows $m=1$ precursor oscillation, then rapid crash</li>
<li><strong>ECE (Electron Cyclotron Emission)</strong>: High-resolution $T_e$ profile measurements</li>
<li><strong>Magnetic diagnostics</strong>: Mirnov coils detect $m/n = 1/1$ mode growth</li>
<li><strong>Partial vs full reconnection</strong>: Not all crashes are complete; some show incomplete reconnection</li>
</ul>
<p><strong>Numerical simulations:</strong></p>
<ul>
<li>Resistive MHD: Reproduces sawtooth cycle but crash is too slow</li>
<li>Two-fluid/kinetic: Faster crash, closer to observations</li>
<li>Extended MHD: Includes Hall, electron pressure, captures fast crash</li>
</ul>
<p>Modern simulations (e.g., M3D, NIMROD) show that two-fluid effects significantly accelerate the crash compared to resistive MHD.</p>
<h3 id="44-python-example-sawtooth-crash-simulation-1d-model">4.4 Python Example: Sawtooth Crash Simulation (1D Model)<a class="header-link" href="#44-python-example-sawtooth-crash-simulation-1d-model" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Simple 1D model of sawtooth temperature evolution</span>
<span class="c1"># (Not a real reconnection simulation, just illustrative)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Normalized radius</span>
<span class="n">t_rise</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Number of time steps in rise phase</span>
<span class="n">t_crash</span> <span class="o">=</span> <span class="mi">5</span>   <span class="c1"># Number of time steps in crash</span>
<span class="n">n_cycles</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Inversion radius</span>
<span class="n">r_inv</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="c1"># Initial profile</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Storage</span>
<span class="n">T_history</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">time_history</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">T0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">time</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cycles</span><span class="p">):</span>
    <span class="c1"># Rise phase: gradual central heating</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_rise</span><span class="p">):</span>
        <span class="c1"># Heat deposition in core</span>
        <span class="n">heat_source</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">0.2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Diffusive cooling</span>
        <span class="n">dTdr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">d2Tdr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dTdr</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">cooling</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">d2Tdr2</span>

        <span class="n">T</span> <span class="o">+=</span> <span class="n">heat_source</span> <span class="o">+</span> <span class="n">cooling</span>
        <span class="n">T_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">time_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">time</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Crash phase: rapid flattening inside inversion radius</span>
    <span class="n">T_before_crash</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_crash</span><span class="p">):</span>
        <span class="c1"># Average inside inversion radius</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">r_inv</span>
        <span class="n">T_avg_inside</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">inside</span><span class="p">])</span>
        <span class="n">T</span><span class="p">[</span><span class="n">inside</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_avg_inside</span>

        <span class="c1"># Slight increase outside (conservation)</span>
        <span class="n">outside</span> <span class="o">=</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="n">r_inv</span>
        <span class="n">T</span><span class="p">[</span><span class="n">outside</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_before_crash</span><span class="p">[</span><span class="n">inside</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">T_avg_inside</span><span class="p">)</span>

        <span class="n">T_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">time_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">time</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Convert to array</span>
<span class="n">T_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_history</span><span class="p">)</span>
<span class="n">time_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time_history</span><span class="p">)</span>

<span class="c1"># Plot core temperature vs time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Panel 1: Core temperature (sawtooth pattern)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">T_core</span> <span class="o">=</span> <span class="n">T_history</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_history</span><span class="p">,</span> <span class="n">T_core</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (arbitrary units)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Core Temperature $T_e(r=0)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sawtooth Oscillations: Core Temperature&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Mark crashes</span>
<span class="n">crash_indices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">T_core</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">T_core</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">T_core</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">crash_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">crash_indices</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">time_history</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Panel 2: Radial profiles at different times</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Plot profiles at selected times</span>
<span class="n">times_to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">202</span><span class="p">]</span>  <span class="c1"># Before/after crashes</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">times_to_plot</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">times_to_plot</span><span class="p">):</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">time_history</span><span class="p">[</span><span class="n">t_idx</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">t_idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">199</span><span class="p">]:</span>
        <span class="n">label</span> <span class="o">+=</span> <span class="s1">&#39; (before crash)&#39;</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.5</span>
    <span class="k">elif</span> <span class="n">t_idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">102</span><span class="p">,</span> <span class="mi">202</span><span class="p">]:</span>
        <span class="n">label</span> <span class="o">+=</span> <span class="s1">&#39; (after crash)&#39;</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.5</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">T_history</span><span class="p">[</span><span class="n">t_idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">r_inv</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Inversion radius ($r=</span><span class="si">{</span><span class="n">r_inv</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized radius $r/a$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $T_e$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Radial Temperature Profiles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sawtooth_crash_simulation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="5-magnetic-island-coalescence">5. Magnetic Island Coalescence<a class="header-link" href="#5-magnetic-island-coalescence" title="Permanent link">&para;</a></h2>
<h3 id="51-physics-of-island-coalescence">5.1 Physics of Island Coalescence<a class="header-link" href="#51-physics-of-island-coalescence" title="Permanent link">&para;</a></h3>
<p>When two magnetic islands (O-points) with the same helicity are brought together, they can merge through reconnection at the X-point between them. This process is called <strong>magnetic island coalescence</strong>.</p>
<p><strong>Initial configuration:</strong></p>
<div class="highlight"><pre><span></span><code>    O‚îÄ‚îÄ‚îÄ‚îÄ‚îÄX‚îÄ‚îÄ‚îÄ‚îÄ‚îÄO

  Island 1  X  Island 2
</code></pre></div>

<p><strong>During coalescence:</strong></p>
<p>Reconnection at the central X-point allows the islands to merge:</p>
<div class="highlight"><pre><span></span><code>    O‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄO   (moving together)
          X

    Reconnection accelerates
</code></pre></div>

<p><strong>Final state:</strong></p>
<div class="highlight"><pre><span></span><code>       ‚óã‚óã‚óã
      ‚óã   ‚óã
      ‚óã O ‚óã  Single large island
      ‚óã   ‚óã
       ‚óã‚óã‚óã
</code></pre></div>

<h3 id="52-dynamics-and-reconnection-rate">5.2 Dynamics and Reconnection Rate<a class="header-link" href="#52-dynamics-and-reconnection-rate" title="Permanent link">&para;</a></h3>
<p>The islands are driven together by the magnetic tension force. As they approach, the X-point current sheet intensifies, and reconnection accelerates.</p>
<p><strong>Energy conversion:</strong></p>
<ul>
<li><strong>Initial state</strong>: Magnetic energy stored in the two islands</li>
<li><strong>Coalescence</strong>: Reconnection releases magnetic energy</li>
<li><strong>Final state</strong>: One larger island + kinetic/thermal energy</li>
</ul>
<p><strong>Reconnection rate:</strong></p>
<p>Simulations show that coalescence reconnection is fast, with $M_A \sim 0.1$, even in resistive MHD at high Lundquist number. This is because the Rutherford regime of island growth becomes explosive during coalescence.</p>
<p><strong>Applications:</strong></p>
<ul>
<li><strong>Tokamak disruptions</strong>: Multiple tearing modes can coalesce, triggering disruption</li>
<li><strong>Solar corona</strong>: Interacting flux tubes/loops</li>
<li><strong>Magnetotail</strong>: Merging plasmoids</li>
</ul>
<h3 id="53-python-example-2d-island-coalescence">5.3 Python Example: 2D Island Coalescence<a class="header-link" href="#53-python-example-2d-island-coalescence" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Simple model: two magnetic islands approaching and merging</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Function to create an O-point (island) flux function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">island_flux</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">size</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Time snapshots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">separations</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Island separation decreases</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sep</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">separations</span><span class="p">):</span>
    <span class="c1"># Two islands approaching</span>
    <span class="n">psi1</span> <span class="o">=</span> <span class="n">island_flux</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">-</span><span class="n">sep</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="n">island_flux</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sep</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sep</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Before full merger</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">psi1</span> <span class="o">+</span> <span class="n">psi2</span>
        <span class="c1"># Add a current sheet between them (X-point)</span>
        <span class="n">sheet_contrib</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">psi</span> <span class="o">+=</span> <span class="n">sheet_contrib</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># After merger: single large island</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">island_flux</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Add background field (hyperbolic)</span>
    <span class="n">psi</span> <span class="o">+=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span>

    <span class="c1"># Compute magnetic field</span>
    <span class="n">By</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Bx</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">contour_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="c1"># Streamplot for field lines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="c1"># Mark O-points</span>
    <span class="k">if</span> <span class="n">sep</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">sep</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O-point (island)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sep</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X-point&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Merged island&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time $t = </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">$ (separation = </span><span class="si">{</span><span class="n">sep</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Magnetic Island Coalescence&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;island_coalescence.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="6-astrophysical-jets-and-reconnection">6. Astrophysical Jets and Reconnection<a class="header-link" href="#6-astrophysical-jets-and-reconnection" title="Permanent link">&para;</a></h2>
<h3 id="61-jets-in-astrophysics">6.1 Jets in Astrophysics<a class="header-link" href="#61-jets-in-astrophysics" title="Permanent link">&para;</a></h3>
<p><strong>Astrophysical jets</strong> are highly collimated outflows observed in many systems:</p>
<ul>
<li><strong>Active Galactic Nuclei (AGN)</strong>: Jets from supermassive black holes, extending Mpc (millions of parsecs)</li>
<li><strong>Microquasars</strong>: Stellar-mass black hole jets in X-ray binaries</li>
<li><strong>Young Stellar Objects (YSOs)</strong>: Protostellar jets (HH objects)</li>
<li><strong>Pulsar wind nebulae</strong>: Relativistic jets from pulsars (Crab Nebula)</li>
<li><strong>Gamma-Ray Bursts (GRBs)</strong>: Ultra-relativistic jets, Lorentz factors $\Gamma \sim 100$‚Äì1000</li>
</ul>
<p><strong>Common features:</strong></p>
<ul>
<li>High collimation: Opening angles ~1¬∞‚Äì10¬∞</li>
<li>Relativistic speeds: $v \sim 0.1c$ to $>0.99c$</li>
<li>High power: Up to $10^{47}$ erg/s for AGN</li>
<li>Magnetic fields: Strong ($B \sim 0.1$‚Äì10 G in AGN jets)</li>
</ul>
<h3 id="62-reconnection-driven-acceleration">6.2 Reconnection-Driven Acceleration<a class="header-link" href="#62-reconnection-driven-acceleration" title="Permanent link">&para;</a></h3>
<p>Magnetic reconnection is a leading candidate for:</p>
<ol>
<li><strong>Launching jets</strong>: Converting magnetic energy to kinetic energy</li>
<li><strong>Accelerating jets</strong>: Additional acceleration along the jet</li>
<li><strong>Particle acceleration</strong>: Producing non-thermal particles (synchrotron emission)</li>
</ol>
<p><strong>Launching mechanism:</strong></p>
<p>In the magnetosphere of a black hole or neutron star, a rotating, magnetized accretion disk can generate a large-scale poloidal field. Reconnection in the current sheet:
- Releases magnetic tension
- Drives outflows at Alfv√©n speed or higher
- Collimates the flow</p>
<p><strong>Reconnection in the jet:</strong></p>
<p>Instabilities (e.g., kink) in the jet can trigger reconnection:
- Magnetic energy dissipation
- Flares and blobs in jet emission (observed in blazar variability)
- Particle acceleration to non-thermal energies (power-law distributions)</p>
<h3 id="63-pulsar-magnetospheres">6.3 Pulsar Magnetospheres<a class="header-link" href="#63-pulsar-magnetospheres" title="Permanent link">&para;</a></h3>
<p><strong>Pulsars</strong> are rotating neutron stars with ultra-strong magnetic fields ($B \sim 10^{12}$ G). The magnetospheric structure includes:</p>
<ul>
<li><strong>Closed zone</strong>: Dipolar field lines that close within the light cylinder</li>
<li><strong>Open zone</strong>: Field lines that extend to infinity</li>
<li><strong>Current sheet</strong>: Forms in the equatorial plane beyond the light cylinder</li>
</ul>
<p><strong>Reconnection in the striped wind:</strong></p>
<p>The pulsar wind has alternating magnetic polarity (striped wind). Reconnection in the current sheet:
- Converts magnetic energy (Poynting flux) to particle energy
- Produces the observed non-thermal emission (radio, optical, X-ray, gamma-ray)
- Explains the Crab Nebula's high-energy flares</p>
<p><strong>Sigma problem:</strong></p>
<p>Near the pulsar, the magnetization parameter $\sigma = B^2/(\mu_0 \rho c^2) \gg 1$ (magnetically dominated). But observations require $\sigma \sim 0.01$‚Äì0.1 at the termination shock. Reconnection in the striped wind is a leading solution to this <strong>sigma problem</strong>.</p>
<h3 id="64-gamma-ray-bursts">6.4 Gamma-Ray Bursts<a class="header-link" href="#64-gamma-ray-bursts" title="Permanent link">&para;</a></h3>
<p><strong>GRBs</strong> are the brightest explosions in the universe, releasing $\sim 10^{51}$‚Äì$10^{54}$ erg in gamma-rays over seconds to minutes.</p>
<p><strong>Fireball model:</strong></p>
<ul>
<li><strong>Central engine</strong>: Collapsar (massive star collapse) or merger (neutron star-neutron star/black hole)</li>
<li><strong>Relativistic outflow</strong>: Lorentz factor $\Gamma \sim 100$‚Äì1000</li>
<li><strong>Internal shocks</strong>: Reconnection and shocks in the jet produce prompt gamma-ray emission</li>
<li><strong>External shock</strong>: Jet interacts with ISM, producing afterglow</li>
</ul>
<p><strong>Reconnection's role:</strong></p>
<ul>
<li><strong>Energy dissipation</strong>: Reconnection in the jet converts magnetic energy to radiation</li>
<li><strong>Particle acceleration</strong>: Non-thermal electrons radiate gamma-rays (synchrotron, inverse Compton)</li>
<li><strong>Time variability</strong>: Reconnection plasmoids produce rapid variability (ms time scales)</li>
</ul>
<p>Recent simulations (Uzdensky, Werner, Sironi et al.) show that relativistic reconnection can efficiently accelerate particles to the required non-thermal distributions.</p>
<h2 id="7-summary">7. Summary<a class="header-link" href="#7-summary" title="Permanent link">&para;</a></h2>
<p>Magnetic reconnection plays a central role in a wide range of phenomena:</p>
<ol>
<li>
<p><strong>Solar flares</strong>: The CSHKP model explains energy release (~$10^{32}$ erg) through reconnection in a current sheet. Observed reconnection rates are $M_A \sim 0.01$‚Äì$0.1$, consistent with fast reconnection. Observations from SDO and other missions reveal supra-arcade downflows, above-the-loop-top sources, and ribbon dynamics.</p>
</li>
<li>
<p><strong>Coronal mass ejections</strong>: CME initiation involves flux rope eruption, often triggered by the torus instability. Reconnection below the erupting flux rope releases energy and allows topology change. CMEs pose significant space weather hazards.</p>
</li>
<li>
<p><strong>Magnetospheric substorms</strong>: The Dungey cycle describes solar wind-magnetosphere coupling via dayside and nightside reconnection. Substorms involve energy storage in the tail lobes during the growth phase, followed by explosive release during the expansion phase. The Near-Earth Neutral Line model attributes onset to reconnection at $X \sim -20$ to $-30 R_E$.</p>
</li>
<li>
<p><strong>Tokamak sawtooth crashes</strong>: Sawtooth oscillations result from the internal kink instability and reconnection at the $q = 1$ surface. The Kadomtsev model explains the crash as full reconnection, causing rapid heat redistribution. The fast crash time indicates collisionless reconnection.</p>
</li>
<li>
<p><strong>Magnetic island coalescence</strong>: When two islands merge, reconnection at the intervening X-point is fast ($M_A \sim 0.1$), even in resistive MHD. This process is relevant to tokamak disruptions and solar/magnetospheric dynamics.</p>
</li>
<li>
<p><strong>Astrophysical jets</strong>: Reconnection is implicated in jet launching, acceleration, and particle acceleration in AGN, pulsars, GRBs, and YSOs. Relativistic reconnection efficiently converts magnetic energy to particle energy in pulsar winds and GRB jets.</p>
</li>
</ol>
<p>In all these applications, the reconnection rate is observed or inferred to be fast ($M_A \sim 0.01$‚Äì$0.1$), supporting the importance of collisionless (Hall, kinetic) reconnection physics.</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Solar flare energetics</strong>:
   a) Estimate the magnetic energy in a flaring active region with $B = 0.02$ T, volume $V = (10^8 \text{ m})^3$.
   b) If 20% of this energy is released in a flare lasting 1000 s, what is the average power?
   c) Compare this to the total solar luminosity ($L_\odot = 3.8 \times 10^{26}$ W).</p>
</li>
<li>
<p><strong>Flare ribbon motion</strong>:
   a) Observed flare ribbons separate at $v_{sep} = 50$ km/s. If the coronal height is $h = 10^7$ m and the footpoint separation is $d = 10^8$ m, estimate the reconnection inflow speed $v_{in}$.
   b) With an Alfv√©n speed $v_A = 1000$ km/s, calculate $M_A$.
   c) Is this consistent with Sweet-Parker, Petschek, or Hall reconnection?</p>
</li>
<li>
<p><strong>CME kinetic energy</strong>:
   a) A CME has mass $M = 10^{15}$ g and speed $v = 1000$ km/s. Calculate its kinetic energy in ergs.
   b) If the CME is decelerated to $v = 500$ km/s by solar wind drag, how much energy is dissipated?
   c) Where does this energy go?</p>
</li>
<li>
<p><strong>Torus instability</strong>:
   a) Explain the torus instability criterion: $d \ln B_{ext} / d \ln h < -3/2$.
   b) For a dipole field $B \propto r^{-3}$, calculate $d \ln B / d \ln r$ (treating $h \sim r$).
   c) Is a dipole field stable or unstable against the torus instability?</p>
</li>
<li>
<p><strong>Dungey cycle timescale</strong>:
   a) If dayside reconnection transfers magnetic flux at rate $d\Phi/dt = E_{rec} \cdot L_y$, where $E_{rec} = v_{in} B_{sw}$ and $L_y \sim 20 R_E$, estimate $d\Phi/dt$ for $v_{in} = 100$ km/s, $B_{sw} = 5$ nT, $R_E = 6.4 \times 10^6$ m.
   b) The total flux in the tail lobes is $\Phi_{tail} \sim B_{lobe} \cdot A_{lobe} \sim 1$ GWb. How long does it take to load this flux?
   c) Compare to observed substorm growth phase duration (~30‚Äì60 min).</p>
</li>
<li>
<p><strong>Substorm energy release</strong>:
   a) The magnetotail stores energy $\sim B^2 V / (2\mu_0)$. Estimate this for $B = 20$ nT, $V \sim (10 R_E)^3$.
   b) If this energy is released over 1 hour during a substorm, what is the average power?
   c) Compare to the solar wind input power (~$10^{11}$‚Äì$10^{12}$ W).</p>
</li>
<li>
<p><strong>Sawtooth crash time</strong>:
   a) In a tokamak, the sawtooth crash time is $\tau_{crash} \sim 50$ Œºs. The minor radius is $a = 0.5$ m, $B = 3$ T, $n = 10^{20}$ m‚Åª¬≥.
   b) Calculate the Alfv√©n time $\tau_A = a/v_A$.
   c) Estimate the reconnection rate $M_A \sim \tau_A / \tau_{crash}$.</p>
</li>
<li>
<p><strong>Island coalescence</strong>:
   a) Two magnetic islands of width $w = 5$ cm are separated by distance $d = 10$ cm in a tokamak. The local Alfv√©n speed is $v_A = 10^6$ m/s.
   b) If they approach at speed $v \sim 0.1 v_A$, how long until they merge?
   c) During coalescence, what fraction of the magnetic energy is released (assume islands have energy $\propto w^2 B^2$, and the final island has $w_{final} = \sqrt{2} w$)?</p>
</li>
<li>
<p><strong>AGN jet power</strong>:
   a) An AGN jet has radius $R = 10^{16}$ m, outflow speed $v = 0.5c$, and carries Poynting flux $S = B^2 v / \mu_0$ with $B = 1$ G.
   b) Calculate the jet power $P = S \cdot \pi R^2$.
   c) Compare to the Eddington luminosity for a $10^9 M_\odot$ black hole ($L_{Edd} \sim 10^{47}$ erg/s).</p>
</li>
<li>
<p><strong>Relativistic reconnection</strong>:
    a) In a pulsar wind, the magnetization parameter is $\sigma = B^2/(\mu_0 \rho c^2) = 10^3$ near the light cylinder.
    b) If reconnection converts 50% of the magnetic energy to particle kinetic energy, what is the final $\sigma$?
    c) Is this sufficient to explain observations ($\sigma_{obs} \sim 0.01$‚Äì0.1)? If not, what else is needed?</p>
</li>
</ol>
<h2 id="navigation">Navigation<a class="header-link" href="#navigation" title="Permanent link">&para;</a></h2>
<p>Previous: <a href="./05_Reconnection_Theory.md">Reconnection Theory</a> | Next: <a href="./07_Advanced_Reconnection.md">Advanced Reconnection</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/05_Reconnection_Theory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">5. Magnetic Reconnection Theory</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/07_Advanced_Reconnection.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">7. Advanced Reconnection</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}