{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9. Dynamo Theory - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">9. Dynamo Theory</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>9. Dynamo Theory</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/08_MHD_Turbulence.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">8. MHD Turbulence</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/10_Turbulent_Dynamo.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">10. Turbulent Dynamo</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-the-dynamo-problem">1. The Dynamo Problem</a><ul>
<li><a href="#11-why-do-we-need-dynamos">1.1 Why Do We Need Dynamos?</a></li>
<li><a href="#12-the-magnetic-induction-equation">1.2 The Magnetic Induction Equation</a></li>
<li><a href="#13-energy-considerations">1.3 Energy Considerations</a></li>
</ul>
</li>
<li><a href="#2-anti-dynamo-theorems">2. Anti-Dynamo Theorems</a><ul>
<li><a href="#21-cowlings-theorem-1934">2.1 Cowling's Theorem (1934)</a></li>
<li><a href="#22-zeldovichs-theorem-1956">2.2 Zeldovich's Theorem (1956)</a></li>
<li><a href="#23-summary-of-constraints">2.3 Summary of Constraints</a></li>
</ul>
</li>
<li><a href="#3-kinematic-dynamo-theory">3. Kinematic Dynamo Theory</a><ul>
<li><a href="#31-the-kinematic-approximation">3.1 The Kinematic Approximation</a></li>
<li><a href="#32-stretch-twist-fold-mechanism">3.2 Stretch-Twist-Fold Mechanism</a></li>
<li><a href="#33-ponomarenko-dynamo-1973">3.3 Ponomarenko Dynamo (1973)</a></li>
<li><a href="#34-roberts-flow-dynamo">3.4 Roberts Flow Dynamo</a></li>
</ul>
</li>
<li><a href="#4-mean-field-dynamo-theory">4. Mean-Field Dynamo Theory</a><ul>
<li><a href="#41-reynolds-decomposition">4.1 Reynolds Decomposition</a></li>
<li><a href="#42-mean-field-induction-equation">4.2 Mean-Field Induction Equation</a></li>
<li><a href="#43-the-effect">4.3 The Î±-Effect</a></li>
<li><a href="#44-dynamos">4.4 Î±-Î© Dynamos</a></li>
<li><a href="#45-2-dynamos">4.5 Î±Â² Dynamos</a></li>
<li><a href="#46-solar-dynamo">4.6 Solar Î±-Î© Dynamo</a></li>
</ul>
</li>
<li><a href="#5-dynamical-dynamo-theory">5. Dynamical Dynamo Theory</a><ul>
<li><a href="#51-the-lorentz-force-back-reaction">5.1 The Lorentz Force Back-Reaction</a></li>
<li><a href="#52-quenching">5.2 Î±-Quenching</a></li>
<li><a href="#53-geodynamo">5.3 Geodynamo</a></li>
<li><a href="#54-solar-dynamo-revisited">5.4 Solar Dynamo Revisited</a></li>
</ul>
</li>
<li><a href="#6-numerical-methods-for-dynamo-simulations">6. Numerical Methods for Dynamo Simulations</a><ul>
<li><a href="#61-spectral-methods">6.1 Spectral Methods</a></li>
<li><a href="#62-time-stepping">6.2 Time Stepping</a></li>
<li><a href="#63-incompressibility-constraint">6.3 Incompressibility Constraint</a></li>
</ul>
</li>
<li><a href="#7-python-implementations">7. Python Implementations</a><ul>
<li><a href="#71-mean-field-dynamo-1d">7.1 Î±-Î© Mean-Field Dynamo (1D)</a></li>
<li><a href="#72-ponomarenko-dynamo-dispersion-relation">7.2 Ponomarenko Dynamo Dispersion Relation</a></li>
<li><a href="#73-solar-butterfly-diagram-simulation">7.3 Solar Butterfly Diagram Simulation</a></li>
<li><a href="#74-kinematic-dynamo-growth-rate-calculation">7.4 Kinematic Dynamo Growth Rate Calculation</a></li>
</ul>
</li>
<li><a href="#8-summary">8. Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="9-dynamo-theory">9. Dynamo Theory<a class="header-link" href="#9-dynamo-theory" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li>Explain the fundamental dynamo problem and why planets and stars need a dynamo mechanism to maintain magnetic fields</li>
<li>Derive and interpret the magnetic induction equation in the MHD approximation</li>
<li>Understand anti-dynamo theorems (Cowling, Zeldovich) and their implications for dynamo requirements</li>
<li>Analyze kinematic dynamo models including the stretch-twist-fold mechanism</li>
<li>Apply mean-field theory to understand large-scale dynamo action (Î±-effect, Î²-effect, Î±-Î© dynamos)</li>
<li>Distinguish between kinematic and dynamical dynamo regimes and understand saturation mechanisms</li>
<li>Implement numerical models of simple dynamos and analyze their growth rates</li>
</ul>
<h2 id="1-the-dynamo-problem">1. The Dynamo Problem<a class="header-link" href="#1-the-dynamo-problem" title="Permanent link">&para;</a></h2>
<h3 id="11-why-do-we-need-dynamos">1.1 Why Do We Need Dynamos?<a class="header-link" href="#11-why-do-we-need-dynamos" title="Permanent link">&para;</a></h3>
<p>The Earth, Sun, and many other astrophysical objects possess large-scale magnetic fields that have persisted for billions of years. This presents a fundamental problem:</p>
<p><strong>The Free Decay Problem:</strong></p>
<p>In the absence of any generation mechanism, magnetic fields in conducting fluids decay on a resistive timescale:</p>
<div class="highlight"><pre><span></span><code>Ï„_Î· = LÂ²/Î·
</code></pre></div>

<p>where:
- <code>L</code> is the characteristic length scale
- <code>Î· = 1/(Î¼â‚€Ïƒ)</code> is the magnetic diffusivity
- <code>Ïƒ</code> is the electrical conductivity</p>
<p>For the Earth's core:
- <code>L ~ 10â¶ m</code>
- <code>Î· ~ 1-2 mÂ²/s</code>
- <code>Ï„_Î· ~ 10â´ - 10âµ years</code></p>
<p>This is much shorter than the Earth's age (~4.5 billion years), yet the geomagnetic field has existed for at least 3.5 billion years (from paleomagnetic evidence). Therefore, <strong>there must be an active generation mechanism</strong>.</p>
<p><strong>Definition:</strong> A <strong>dynamo</strong> is a mechanism that converts kinetic energy of a conducting fluid into magnetic energy, maintaining a magnetic field against resistive dissipation.</p>
<h3 id="12-the-magnetic-induction-equation">1.2 The Magnetic Induction Equation<a class="header-link" href="#12-the-magnetic-induction-equation" title="Permanent link">&para;</a></h3>
<p>The evolution of the magnetic field in a moving conducting fluid is governed by the <strong>magnetic induction equation</strong>, derived from Maxwell's equations and Ohm's law in the MHD approximation:</p>
<div class="highlight"><pre><span></span><code>âˆ‚B/âˆ‚t = âˆ‡ Ã— (v Ã— B) + Î·âˆ‡Â²B
</code></pre></div>

<p>In component form:</p>
<div class="highlight"><pre><span></span><code>âˆ‚B_i/âˆ‚t + v_j âˆ‚B_i/âˆ‚x_j = B_j âˆ‚v_i/âˆ‚x_j + Î· âˆ‚Â²B_i/âˆ‚x_jâˆ‚x_j
</code></pre></div>

<p><strong>Physical interpretation:</strong></p>
<ol>
<li><strong>Advection term</strong> <code>vÂ·âˆ‡B</code>: magnetic field is frozen into and carried by the fluid</li>
<li><strong>Stretching term</strong> <code>BÂ·âˆ‡v</code>: magnetic field lines are stretched by velocity gradients (shear, strain)</li>
<li><strong>Diffusion term</strong> <code>Î·âˆ‡Â²B</code>: resistive dissipation</li>
</ol>
<p>The relative importance of advection/stretching vs. diffusion is measured by the <strong>magnetic Reynolds number</strong>:</p>
<div class="highlight"><pre><span></span><code>Rm = UL/Î·
</code></pre></div>

<p>where:
- <code>U</code> is characteristic velocity
- <code>L</code> is characteristic length scale</p>
<p><strong>Dynamo regimes:</strong>
- <code>Rm â‰ª 1</code>: diffusion-dominated, magnetic field decays
- <code>Rm â‰« 1</code>: advection-dominated, dynamo action possible
- Typically, <code>Rm_critical ~ O(10)</code> for dynamo onset</p>
<h3 id="13-energy-considerations">1.3 Energy Considerations<a class="header-link" href="#13-energy-considerations" title="Permanent link">&para;</a></h3>
<p>The magnetic energy evolution is:</p>
<div class="highlight"><pre><span></span><code>dE_B/dt = âˆ« BÂ·(âˆ‡Ã—(vÃ—B)) dV - âˆ« Î· JÂ² dV
</code></pre></div>

<p>where:
- First term: work done by fluid motion (can be positive â†’ amplification)
- Second term: Ohmic dissipation (always negative)</p>
<p>For a sustained dynamo:</p>
<div class="highlight"><pre><span></span><code>âˆ« BÂ·(âˆ‡Ã—(vÃ—B)) dV â‰¥ âˆ« Î· JÂ² dV
</code></pre></div>

<p>The dynamo converts kinetic energy to magnetic energy at a rate sufficient to overcome resistive losses.</p>
<h2 id="2-anti-dynamo-theorems">2. Anti-Dynamo Theorems<a class="header-link" href="#2-anti-dynamo-theorems" title="Permanent link">&para;</a></h2>
<p>Before understanding how dynamos work, it's crucial to know what <strong>cannot</strong> work. Anti-dynamo theorems place fundamental constraints on dynamo mechanisms.</p>
<h3 id="21-cowlings-theorem-1934">2.1 Cowling's Theorem (1934)<a class="header-link" href="#21-cowlings-theorem-1934" title="Permanent link">&para;</a></h3>
<p><strong>Statement:</strong> An axisymmetric magnetic field (independent of azimuthal angle Ï† in cylindrical or spherical coordinates) cannot be maintained by dynamo action.</p>
<p><strong>Proof sketch (cylindrical coordinates):</strong></p>
<p>For an axisymmetric field:</p>
<div class="highlight"><pre><span></span><code>B = B_r(r,z,t) e_r + B_Ï†(r,z,t) e_Ï† + B_z(r,z,t) e_z
</code></pre></div>

<p>The toroidal component B_Ï† satisfies:</p>
<div class="highlight"><pre><span></span><code>âˆ‚B_Ï†/âˆ‚t = r(BÂ·âˆ‡)(v_Ï†/r) + (1/r)âˆ‚(rB_r)/âˆ‚r v_Ï† + âˆ‚B_z/âˆ‚z v_Ï† + Î·(âˆ‡Â²B_Ï† - B_Ï†/rÂ²)
</code></pre></div>

<p>For a neutral line where <code>B_Ï† = 0</code> at some surface, the right-hand side must also vanish there. Along this neutral line, <code>âˆ‚B_Ï†/âˆ‚t = 0</code>, so the field cannot grow through it. By continuity, if <code>B_Ï† = 0</code> initially on a surface, it remains zero â†’ no dynamo.</p>
<p><strong>Implication:</strong> The magnetic field <strong>must</strong> have non-axisymmetric components, even if the mean field is axisymmetric (e.g., Earth's dipole-dominated field arises from time-averaged non-axisymmetric fluctuations).</p>
<h3 id="22-zeldovichs-theorem-1956">2.2 Zeldovich's Theorem (1956)<a class="header-link" href="#22-zeldovichs-theorem-1956" title="Permanent link">&para;</a></h3>
<p><strong>Statement:</strong> A purely two-dimensional flow (velocity and fields independent of one coordinate, say z) cannot sustain a dynamo.</p>
<p><strong>Proof sketch:</strong></p>
<p>In 2D, all field lines and streamlines lie in parallel planes. Consider magnetic field lines in the x-y plane. The induction equation becomes:</p>
<div class="highlight"><pre><span></span><code>âˆ‚B/âˆ‚t = âˆ‡ Ã— (v Ã— B) + Î·âˆ‡Â²B
</code></pre></div>

<p>with <code>v = v(x,y,t)</code> and <code>B = B(x,y,t)</code>. The field can be written as:</p>
<div class="highlight"><pre><span></span><code>B = âˆ‡ Ã— (Ïˆ(x,y,t) e_z)  (for B_z = 0)
</code></pre></div>

<p>or with a z-component:</p>
<div class="highlight"><pre><span></span><code>B = B_z(x,y,t) e_z + âˆ‡ Ã— (Ïˆ(x,y,t) e_z)
</code></pre></div>

<p>For the poloidal part (Ïˆ), the induction equation gives:</p>
<div class="highlight"><pre><span></span><code>âˆ‚Ïˆ/âˆ‚t = vÂ·âˆ‡Ïˆ + Î·âˆ‡Â²Ïˆ
</code></pre></div>

<p>This is a pure advection-diffusion equation with no source term â†’ Ïˆ decays. The z-component can be stretched but not regenerated.</p>
<p><strong>Implication:</strong> Three-dimensional flows are <strong>necessary</strong> for dynamo action.</p>
<h3 id="23-summary-of-constraints">2.3 Summary of Constraints<a class="header-link" href="#23-summary-of-constraints" title="Permanent link">&para;</a></h3>
<p>From anti-dynamo theorems:</p>
<ol>
<li><strong>Need 3D flow</strong>: at least one component must vary in all three directions</li>
<li><strong>Need non-axisymmetric components</strong>: even if mean field is axisymmetric</li>
<li><strong>Need sufficient complexity</strong>: simple flows (e.g., uniform rotation) cannot dynamo</li>
</ol>
<p>These theorems guide the search for dynamo mechanisms: we need flows with helicity, differential rotation, or convective turbulence.</p>
<h2 id="3-kinematic-dynamo-theory">3. Kinematic Dynamo Theory<a class="header-link" href="#3-kinematic-dynamo-theory" title="Permanent link">&para;</a></h2>
<h3 id="31-the-kinematic-approximation">3.1 The Kinematic Approximation<a class="header-link" href="#31-the-kinematic-approximation" title="Permanent link">&para;</a></h3>
<p>In <strong>kinematic dynamo theory</strong>, the velocity field <code>v(x,t)</code> is prescribed (given), and we solve the induction equation for the magnetic field evolution, <strong>ignoring the Lorentz force back-reaction</strong> on the flow.</p>
<div class="highlight"><pre><span></span><code>âˆ‚B/âˆ‚t = âˆ‡ Ã— (v Ã— B) + Î·âˆ‡Â²B    (v prescribed)
</code></pre></div>

<p>This is valid when:</p>
<div class="highlight"><pre><span></span><code>BÂ² / (Î¼â‚€ÏvÂ²) â‰ª 1
</code></pre></div>

<p>i.e., magnetic energy â‰ª kinetic energy.</p>
<p><strong>Eigenvalue problem:</strong></p>
<p>Assume solutions of the form:</p>
<div class="highlight"><pre><span></span><code>B(x,t) = b(x) exp(Î³t)
</code></pre></div>

<p>where <code>Î³</code> is the growth rate (complex in general). Substituting:</p>
<div class="highlight"><pre><span></span><code>Î³ b = âˆ‡ Ã— (v Ã— b) + Î·âˆ‡Â²b
</code></pre></div>

<p>This is an eigenvalue problem:
- If <code>Re(Î³) &gt; 0</code> for any eigenmode: <strong>dynamo action</strong> (field grows)
- If <code>Re(Î³) &lt; 0</code> for all modes: field decays</p>
<h3 id="32-stretch-twist-fold-mechanism">3.2 Stretch-Twist-Fold Mechanism<a class="header-link" href="#32-stretch-twist-fold-mechanism" title="Permanent link">&para;</a></h3>
<p>The generic mechanism for kinematic dynamo action:</p>
<p><strong>1. Stretching:</strong> Velocity shear stretches magnetic field lines, increasing field strength (frozen-in theorem: <code>B/Ï</code> increases with stretching).</p>
<p><strong>2. Twisting:</strong> Helical or rotational flows twist field lines, converting poloidal â†” toroidal components.</p>
<p><strong>3. Folding:</strong> Reconnnection or topological rearrangement prevents indefinite stretching, creating new field topology.</p>
<p><strong>Cycle:</strong></p>
<div class="highlight"><pre><span></span><code>Poloidal field B_p
    â†“ (differential rotation â†’ stretching)
Toroidal field B_t
    â†“ (helical motion â†’ twisting)
New poloidal field B_p&#39;
    â†“ (reconnection/folding)
Enhanced poloidal field
</code></pre></div>

<p>If the net amplification per cycle exceeds diffusive losses, the field grows exponentially â†’ dynamo.</p>
<h3 id="33-ponomarenko-dynamo-1973">3.3 Ponomarenko Dynamo (1973)<a class="header-link" href="#33-ponomarenko-dynamo-1973" title="Permanent link">&para;</a></h3>
<p>An analytically tractable example: helical flow in a cylindrical conductor.</p>
<p><strong>Setup:</strong>
- Infinite cylinder of radius <code>a</code>, conductor inside
- Velocity: <code>v = (0, rÎ©, U)</code> in cylindrical coordinates (r, Ï†, z)
  - Rotation: <code>v_Ï† = rÎ©</code>
  - Translation: <code>v_z = U</code>
- Boundary: <code>B</code> continuous at r=a, decays outside</p>
<p><strong>Induction equation:</strong></p>
<div class="highlight"><pre><span></span><code>âˆ‚B/âˆ‚t = âˆ‡ Ã— (v Ã— B) + Î·âˆ‡Â²B
</code></pre></div>

<p>Seek normal modes:</p>
<div class="highlight"><pre><span></span><code>B ~ exp(Î³t + imÏ† + ikz)
</code></pre></div>

<p>where:
- <code>m</code> is azimuthal wavenumber
- <code>k</code> is axial wavenumber</p>
<p><strong>Dispersion relation (simplified for |m|=1, small k):</strong></p>
<div class="highlight"><pre><span></span><code>Î³<span class="w"> </span>â‰ˆ<span class="w"> </span><span class="nv">kU</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ss">(</span><span class="nv">k</span>Â²<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="nv">a</span>Â²<span class="ss">)</span>Î·<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="nv">small</span><span class="w"> </span><span class="nv">Rm</span>
</code></pre></div>

<p>At sufficiently large <code>Rm = Ua/Î·</code>, the first term (advection) overcomes diffusion:</p>
<div class="highlight"><pre><span></span><code>Rm_critical ~ O(10)  (depends on k,m)
</code></pre></div>

<p><strong>Physical picture:</strong>
- Helical flow twists field lines into helices
- Axial advection (U) reinforces the twisting faster than diffusion can smooth it out
- Growth occurs for modes with wavelength ~ a</p>
<h3 id="34-roberts-flow-dynamo">3.4 Roberts Flow Dynamo<a class="header-link" href="#34-roberts-flow-dynamo" title="Permanent link">&para;</a></h3>
<p>A 2D periodic cellular flow (in x-y plane) with a vertical (z) component can also dynamo.</p>
<p><strong>Roberts flow (Roberts, 1972):</strong></p>
<div class="highlight"><pre><span></span><code>v_x = Vâ‚€ sin(ky) cos(kx)
v_y = -Vâ‚€ cos(ky) sin(kx)
v_z = âˆš2 Vâ‚€ sin(kx) sin(ky)
</code></pre></div>

<p>This flow has:
- Cellular structure with vortices
- Helicity: <code>âŸ¨vÂ·(âˆ‡Ã—v)âŸ© â‰  0</code>
- Kinetic helicity drives Î±-effect (see mean-field theory)</p>
<p><strong>Dynamo properties:</strong>
- Critical <code>Rm_c ~ 5</code> (very efficient)
- Fast growth rates
- Used as a test case for numerical codes</p>
<h2 id="4-mean-field-dynamo-theory">4. Mean-Field Dynamo Theory<a class="header-link" href="#4-mean-field-dynamo-theory" title="Permanent link">&para;</a></h2>
<h3 id="41-reynolds-decomposition">4.1 Reynolds Decomposition<a class="header-link" href="#41-reynolds-decomposition" title="Permanent link">&para;</a></h3>
<p>For turbulent flows (e.g., stellar convection zones), the flow and fields have both mean and fluctuating components:</p>
<div class="highlight"><pre><span></span><code>v = âŸ¨vâŸ© + u    (âŸ¨uâŸ© = 0)
B = âŸ¨BâŸ© + b    (âŸ¨bâŸ© = 0)
</code></pre></div>

<p>where <code>âŸ¨Â·âŸ©</code> denotes an ensemble or spatial average.</p>
<p><strong>Goal:</strong> Derive an equation for the <strong>mean field</strong> <code>âŸ¨BâŸ©</code> alone, parameterizing the effect of small-scale turbulence.</p>
<h3 id="42-mean-field-induction-equation">4.2 Mean-Field Induction Equation<a class="header-link" href="#42-mean-field-induction-equation" title="Permanent link">&para;</a></h3>
<p>Averaging the induction equation:</p>
<div class="highlight"><pre><span></span><code>âˆ‚âŸ¨BâŸ©/âˆ‚t = âˆ‡ Ã— (âŸ¨vâŸ© Ã— âŸ¨BâŸ©) + âˆ‡ Ã— â„° + Î·âˆ‡Â²âŸ¨BâŸ©
</code></pre></div>

<p>where the <strong>mean electromotive force (EMF)</strong> is:</p>
<div class="highlight"><pre><span></span><code>â„° = âŸ¨u Ã— bâŸ©
</code></pre></div>

<p>This is the mean electric field induced by small-scale turbulent motions. The challenge is to relate <code>â„°</code> to <code>âŸ¨BâŸ©</code>.</p>
<h3 id="43-the-effect">4.3 The Î±-Effect<a class="header-link" href="#43-the-effect" title="Permanent link">&para;</a></h3>
<p><strong>Assumption:</strong> For homogeneous, isotropic turbulence with small Rm (fluctuations), linear closure:</p>
<div class="highlight"><pre><span></span><code>â„° â‰ˆ Î±âŸ¨BâŸ© - Î²âˆ‡Ã—âŸ¨BâŸ©
</code></pre></div>

<p>where:
- <code>Î±</code>: alpha coefficient (pseudo-scalar, changes sign under parity)
- <code>Î²</code>: turbulent diffusivity (scalar)</p>
<p><strong>Î±-effect derivation (Steenbeck, Krause, RÃ¤dler, 1966):</strong></p>
<p>For helical turbulence with correlation time <code>Ï„_c</code> and velocity <code>u_rms</code>:</p>
<div class="highlight"><pre><span></span><code>Î± â‰ˆ -(1/3) Ï„_c âŸ¨uÂ·(âˆ‡Ã—u)âŸ©
   = -(1/3) Ï„_c âŸ¨hâŸ©
</code></pre></div>

<p>where <code>âŸ¨hâŸ© = âŸ¨uÂ·(âˆ‡Ã—u)âŸ©</code> is the <strong>kinetic helicity</strong>.</p>
<p><strong>Physical interpretation:</strong>
- Helical turbulence has a preferred handedness (cyclonic convection in rotating systems)
- Twisting of field lines by helical eddies converts toroidal â†’ poloidal (or vice versa)
- Î± &gt; 0: right-handed helicity
- Î± &lt; 0: left-handed helicity</p>
<p><strong>Î²-effect:</strong></p>
<div class="highlight"><pre><span></span><code>Î² â‰ˆ (1/3) Ï„_c u_rmsÂ²
</code></pre></div>

<p>This is an <strong>enhanced diffusivity</strong> due to turbulent mixing. The effective diffusivity is:</p>
<div class="highlight"><pre><span></span><code>Î·_eff = Î· + Î²
</code></pre></div>

<p>In stellar convection zones, <code>Î² â‰« Î·</code>, so turbulent diffusion dominates.</p>
<h3 id="44-dynamos">4.4 Î±-Î© Dynamos<a class="header-link" href="#44-dynamos" title="Permanent link">&para;</a></h3>
<p>In rotating, differentially rotating systems (e.g., Sun, planets), the mean flow has:
- Differential rotation: <code>âŸ¨vâŸ© = rÎ©(r,Î¸) e_Ï†</code> (toroidal)
- Î±-effect from helical turbulence</p>
<p><strong>Î±-Î© dynamo cycle (in spherical coordinates):</strong></p>
<ol>
<li><strong>Î©-effect:</strong> Differential rotation shears poloidal field <code>âŸ¨B_pâŸ©</code> into toroidal field <code>âŸ¨B_tâŸ©</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code>âˆ‚âŸ¨B_Ï†âŸ©/âˆ‚t â‰ˆ r sin(Î¸) (âŸ¨B_râŸ© âˆ‚Î©/âˆ‚r + âŸ¨B_Î¸âŸ©/r âˆ‚Î©/âˆ‚Î¸)
</code></pre></div>

<ol>
<li><strong>Î±-effect:</strong> Helical turbulence regenerates poloidal from toroidal:</li>
</ol>
<div class="highlight"><pre><span></span><code>âˆ‚âŸ¨B_pâŸ©/âˆ‚t â‰ˆ âˆ‡ Ã— (Î±âŸ¨B_tâŸ© e_Ï†)
</code></pre></div>

<p><strong>Feedback loop:</strong></p>
<div class="highlight"><pre><span></span><code>âŸ¨B_pâŸ© â†’ (Î©-effect) â†’ âŸ¨B_tâŸ© â†’ (Î±-effect) â†’ âŸ¨B_pâŸ©&#39;
</code></pre></div>

<p>If the net amplification per cycle exceeds diffusion, the field grows â†’ dynamo.</p>
<h3 id="45-2-dynamos">4.5 Î±Â² Dynamos<a class="header-link" href="#45-2-dynamos" title="Permanent link">&para;</a></h3>
<p>If differential rotation is weak or absent, but helicity is strong, an <strong>Î±Â² dynamo</strong> can operate:</p>
<div class="highlight"><pre><span></span><code>âˆ‚âŸ¨BâŸ©/âˆ‚t = âˆ‡ Ã— (Î±âŸ¨BâŸ©) + Î·_eff âˆ‡Â²âŸ¨BâŸ©
</code></pre></div>

<p>Both poloidal â†’ toroidal and toroidal â†’ poloidal conversions are driven by Î±.</p>
<p><strong>Dynamo number:</strong></p>
<p>For Î±Â² dynamos in a sphere of radius R:</p>
<div class="highlight"><pre><span></span><code>D_Î± = Î± R / Î·_eff
</code></pre></div>

<p>Dynamo onset typically at <code>|D_Î±| ~ 10</code>.</p>
<p>For Î±-Î© dynamos:</p>
<div class="highlight"><pre><span></span><code>D_Î±Î© = (Î± Î”Î© RÂ³) / Î·_effÂ²
</code></pre></div>

<p>where <code>Î”Î©</code> is the differential rotation rate. Onset at <code>|D_Î±Î©| ~ O(1)</code>.</p>
<h3 id="46-solar-dynamo">4.6 Solar Î±-Î© Dynamo<a class="header-link" href="#46-solar-dynamo" title="Permanent link">&para;</a></h3>
<p><strong>Application to the Sun:</strong></p>
<ul>
<li><strong>Differential rotation (Î©):</strong> Measured by helioseismology:</li>
<li>Equator rotates faster than poles: <code>Î©(Î¸)</code></li>
<li>
<p>Radial shear near tachocline (base of convection zone): <code>âˆ‚Î©/âˆ‚r</code></p>
</li>
<li>
<p><strong>Î±-effect:</strong> Cyclonic convection in rotating frame â†’ helicity</p>
</li>
<li>Northern hemisphere: Î± &lt; 0 (predominant)</li>
<li>Southern hemisphere: Î± &gt; 0</li>
</ul>
<p><strong>Solar cycle:</strong>
- Period: ~11 years (sunspot cycle), ~22 years (magnetic polarity cycle)
- Toroidal field generated at tachocline by Î©-effect
- Poloidal field regenerated by Î±-effect (or Babcock-Leighton mechanism: tilted sunspot pairs)
- Equatorward propagation of toroidal field (butterfly diagram)
- Poleward migration of poloidal field</p>
<p><strong>Challenges:</strong>
- Î±-quenching at high Rm (see dynamical effects)
- Magnetic buoyancy: strong toroidal fields become unstable and rise â†’ sunspots
- Flux transport: meridional circulation modulates cycle</p>
<h2 id="5-dynamical-dynamo-theory">5. Dynamical Dynamo Theory<a class="header-link" href="#5-dynamical-dynamo-theory" title="Permanent link">&para;</a></h2>
<h3 id="51-the-lorentz-force-back-reaction">5.1 The Lorentz Force Back-Reaction<a class="header-link" href="#51-the-lorentz-force-back-reaction" title="Permanent link">&para;</a></h3>
<p>In the kinematic regime, the magnetic field grows exponentially. But as <code>BÂ² / (Î¼â‚€ÏvÂ²) â†’ O(1)</code>, the <strong>Lorentz force</strong> becomes important:</p>
<div class="highlight"><pre><span></span><code>Ï(âˆ‚v/âˆ‚t + vÂ·âˆ‡v) = -âˆ‡p + JÃ—B + ÏÎ½âˆ‡Â²v
</code></pre></div>

<p>The term <code>JÃ—B</code> modifies the flow, which in turn affects <code>âˆ‚B/âˆ‚t</code>. This is the <strong>dynamical regime</strong>.</p>
<p><strong>Saturation:</strong> The field growth slows and eventually saturates at a level where:</p>
<div class="highlight"><pre><span></span><code>Input power (from flow) = Ohmic dissipation
</code></pre></div>

<p>Typically:</p>
<div class="highlight"><pre><span></span><code>B_satÂ² / (2Î¼â‚€) ~ Îµ_B Ã— ÏvÂ²/2
</code></pre></div>

<p>where <code>Îµ_B</code> is the efficiency of energy conversion (often <code>Îµ_B ~ 0.01 - 0.1</code>).</p>
<h3 id="52-quenching">5.2 Î±-Quenching<a class="header-link" href="#52-quenching" title="Permanent link">&para;</a></h3>
<p>In mean-field theory, the Î±-effect is reduced as the magnetic field grows:</p>
<p><strong>Simple quenching formula:</strong></p>
<div class="highlight"><pre><span></span><code>Î±(B) = Î±â‚€ / (1 + (B_eq/B_*)Â²)
</code></pre></div>

<p>where:
- <code>Î±â‚€</code>: kinematic alpha
- <code>B_eq = âˆš(Î¼â‚€Ï) u_rms</code>: equipartition field
- <code>B_*</code>: quenching field strength</p>
<p><strong>Catastrophic quenching:</strong></p>
<p>At very high magnetic Reynolds number <code>Rm â†’ âˆ</code>, Î±-quenching becomes severe:</p>
<div class="highlight"><pre><span></span><code>Î±(B) ~ Î±â‚€ / Rm
</code></pre></div>

<p>This implies the dynamo would shut off in the <code>Rm â†’ âˆ</code> limit, which is unphysical for astrophysical objects. This led to intense debate and exploration of solutions:
- Magnetic helicity fluxes (boundary effects)
- Shear-driven dynamos (less reliant on Î±)
- Large-scale dynamo from inverse cascade</p>
<p><strong>Current understanding:</strong>
- For closed boundaries: catastrophic quenching is a real issue
- For open boundaries (stellar surfaces, disk coronae): helicity fluxes alleviate quenching
- In highly turbulent systems: dynamo may be predominantly small-scale</p>
<h3 id="53-geodynamo">5.3 Geodynamo<a class="header-link" href="#53-geodynamo" title="Permanent link">&para;</a></h3>
<p><strong>Earth's dynamo:</strong></p>
<ul>
<li>Location: Liquid outer core (r = 3480 - 6371 km from center)</li>
<li>Composition: Iron-nickel alloy, Ïƒ ~ 10â¶ S/m</li>
<li>Convection driven by: cooling and solidification of inner core (compositional + thermal buoyancy)</li>
<li>Rotation: Î© = 7.3 Ã— 10â»âµ rad/s (Coriolis-dominated)</li>
</ul>
<p><strong>Regime:</strong>
- <code>Rm ~ 10Â² - 10Â³</code> (turbulent)
- Ekman number <code>E = Î½/(Î©LÂ²) ~ 10â»Â¹âµ</code> (rapid rotation)
- Magnetic Prandtl number <code>Pm = Î½/Î· ~ 10â»âµ</code> (small viscosity)</p>
<p><strong>Dynamo mechanism:</strong>
- Convection in rapidly rotating sphere â†’ helical flow
- Î±-effect from cyclonic vortices
- Differential rotation from thermal wind balance
- Î±-Î© or Î±Â² dynamo, depending on strength of differential rotation</p>
<p><strong>Numerical simulations:</strong>
- Glatzmaier-Roberts (1995): first 3D dynamo simulation reproducing geomagnetic reversals
- Modern codes: MagIC, Rayleigh, Parody
- Challenges: cannot reach true geophysical parameters (E too small)</p>
<h3 id="54-solar-dynamo-revisited">5.4 Solar Dynamo Revisited<a class="header-link" href="#54-solar-dynamo-revisited" title="Permanent link">&para;</a></h3>
<p>With back-reaction included:</p>
<ul>
<li><strong>Tachocline Î©-effect:</strong> Generates strong toroidal field <code>B_Ï† ~ 10â´ G</code></li>
<li><strong>Magnetic buoyancy:</strong> Toroidal flux tubes rise due to magnetic buoyancy:</li>
</ul>
<div class="highlight"><pre><span></span><code>Ïg = (BÂ²/2Î¼â‚€) / H_p
</code></pre></div>

<p>where <code>H_p</code> is pressure scale height. Instability when <code>BÂ² / (2Î¼â‚€) ~ Ïc_sÂ²</code>.</p>
<ul>
<li><strong>Flux emergence:</strong> Rising flux tubes form sunspots at surface</li>
<li><strong>Babcock-Leighton mechanism:</strong> Tilted bipolar sunspots (Joy's law) â†’  poloidal field via surface diffusion and flux transport</li>
<li><strong>Meridional circulation:</strong> Equatorward at surface, poleward at base â†’ flux transport dynamo</li>
</ul>
<p><strong>Interface dynamo vs. distributed dynamo:</strong>
- <strong>Interface:</strong> Î©-effect at tachocline, Î±-effect in convection zone (separate layers)
- <strong>Distributed:</strong> Dynamo throughout convection zone
- Current consensus: likely interface or flux-transport dynamo</p>
<h2 id="6-numerical-methods-for-dynamo-simulations">6. Numerical Methods for Dynamo Simulations<a class="header-link" href="#6-numerical-methods-for-dynamo-simulations" title="Permanent link">&para;</a></h2>
<h3 id="61-spectral-methods">6.1 Spectral Methods<a class="header-link" href="#61-spectral-methods" title="Permanent link">&para;</a></h3>
<p>For periodic domains or spherical geometries, <strong>spectral methods</strong> are highly efficient.</p>
<p><strong>Fourier representation:</strong></p>
<div class="highlight"><pre><span></span><code>B(x,t) = Î£_k BÌ‚_k(t) exp(ikÂ·x)
</code></pre></div>

<p>The induction equation in Fourier space:</p>
<div class="highlight"><pre><span></span><code>âˆ‚BÌ‚_k/âˆ‚t = ik Ã— (vÌ‚Ã—BÌ‚)_k - Î·kÂ² BÌ‚_k
</code></pre></div>

<p>The convolution <code>(vÌ‚Ã—BÌ‚)_k</code> can be computed via FFT:
1. Transform <code>vÌ‚_k, BÌ‚_k â†’ v(x), B(x)</code> (inverse FFT)
2. Compute <code>vÃ—B</code> in real space
3. Transform back: <code>vÃ—B â†’ (vÌ‚Ã—BÌ‚)_k</code> (forward FFT)</p>
<p><strong>Spherical harmonics:</strong></p>
<p>For spherical geometry (e.g., stars, planets):</p>
<div class="highlight"><pre><span></span><code>B(r,Î¸,Ï†,t) = Î£_lm BÌ‚_lm(r,t) Y_lm(Î¸,Ï†)
</code></pre></div>

<p>where <code>Y_lm</code> are spherical harmonics. Coupled with radial discretization (finite differences or Chebyshev polynomials).</p>
<h3 id="62-time-stepping">6.2 Time Stepping<a class="header-link" href="#62-time-stepping" title="Permanent link">&para;</a></h3>
<p><strong>Explicit schemes (e.g., Runge-Kutta):</strong></p>
<div class="highlight"><pre><span></span><code>B^(n+1) = B^n + Î”t Ã— RHS(B^n, v^n)
</code></pre></div>

<p>Stability constraint (CFL):</p>
<div class="highlight"><pre><span></span><code>Î”t â‰¤ min(Î”x / |v|, Î”xÂ² / Î·)
</code></pre></div>

<p><strong>Implicit schemes (e.g., Crank-Nicolson):</strong></p>
<p>Treat diffusion implicitly to avoid restrictive <code>Î”t ~ Î”xÂ²</code> constraint:</p>
<div class="highlight"><pre><span></span><code>(B^(n+1) - B^n)/Î”t = (1/2)[RHS(B^(n+1)) + RHS(B^n)]
</code></pre></div>

<p>Requires solving a linear system each timestep, but allows larger Î”t.</p>
<h3 id="63-incompressibility-constraint">6.3 Incompressibility Constraint<a class="header-link" href="#63-incompressibility-constraint" title="Permanent link">&para;</a></h3>
<p>The condition <code>âˆ‡Â·B = 0</code> must be maintained numerically. Methods:</p>
<p><strong>1. Vector potential:</strong></p>
<div class="highlight"><pre><span></span><code>B = âˆ‡ Ã— A
</code></pre></div>

<p>Divergence-free by construction. Evolve <code>A</code> via:</p>
<div class="highlight"><pre><span></span><code>âˆ‚A/âˆ‚t = v Ã— B - âˆ‡Ïˆ + Î·âˆ‡Â²A
</code></pre></div>

<p>where <code>Ïˆ</code> is a gauge.</p>
<p><strong>2. Projection method:</strong></p>
<p>After each timestep, project <code>B</code> onto divergence-free space:</p>
<div class="highlight"><pre><span></span><code>B â† B - âˆ‡(âˆ‡â»Â²(âˆ‡Â·B))
</code></pre></div>

<p>In Fourier space: <code>BÌ‚_k â† BÌ‚_k - k(kÂ·BÌ‚_k)/kÂ²</code>.</p>
<p><strong>3. Constrained transport (CT):</strong></p>
<p>Discretize B on cell faces, ensuring âˆ‡Â·B = 0 to machine precision.</p>
<h2 id="7-python-implementations">7. Python Implementations<a class="header-link" href="#7-python-implementations" title="Permanent link">&para;</a></h2>
<h3 id="71-mean-field-dynamo-1d">7.1 Î±-Î© Mean-Field Dynamo (1D)<a class="header-link" href="#71-mean-field-dynamo-1d" title="Permanent link">&para;</a></h3>
<p>Simplified 1D model in radius <code>r</code>, assuming axisymmetry and mean fields:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">alpha_omega_dynamo_1d</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D Î±-Î© mean-field dynamo model.</span>

<span class="sd">    Equations (in cylindrical r-z, suppress z for 1D):</span>
<span class="sd">      âˆ‚B_Ï†/âˆ‚t = r âˆ‚Î©/âˆ‚r B_r + Î· âˆ‚Â²B_Ï†/âˆ‚rÂ²</span>
<span class="sd">      âˆ‚B_r/âˆ‚t = âˆ‚/âˆ‚r(Î± B_Ï†) + Î· âˆ‚Â²B_r/âˆ‚rÂ²</span>

<span class="sd">    Simplified to 1D in radius with periodic or no-flux boundaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="n">Nr</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">r_max</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r_max</span><span class="p">,</span> <span class="n">Nr</span><span class="p">)</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Differential rotation profile: Î©(r) = Î©0(1 - rÂ²)</span>
    <span class="n">Omega0</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">Omega</span> <span class="o">=</span> <span class="n">Omega0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">dOmega_dr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Omega0</span> <span class="o">*</span> <span class="n">r</span>

    <span class="c1"># Alpha profile: Î±(r) = Î±0 sin(Ï€r)</span>
    <span class="n">alpha0</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

    <span class="c1"># Magnetic diffusivity</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.01</span>

    <span class="c1"># Time stepping</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="mi">5000</span>

    <span class="c1"># Initialize fields</span>
    <span class="n">B_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>
    <span class="n">B_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>

    <span class="c1"># Initial perturbation</span>
    <span class="n">B_r</span><span class="p">[</span><span class="n">Nr</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span>

    <span class="c1"># Storage for plotting</span>
    <span class="n">B_phi_hist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">B_r_hist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Time evolution</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="p">):</span>
        <span class="c1"># Compute second derivatives (finite differences)</span>
        <span class="n">d2B_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>
        <span class="n">d2B_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>

        <span class="n">d2B_phi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">B_phi</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">B_phi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">B_phi</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dr</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">d2B_r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">B_r</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">B_r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">B_r</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dr</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Boundary conditions: no-flux (âˆ‚B/âˆ‚r = 0)</span>
        <span class="n">d2B_phi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">d2B_phi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">d2B_phi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d2B_phi</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">d2B_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">d2B_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">d2B_r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d2B_r</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># Î©-effect: generates B_Ï† from B_r</span>
        <span class="n">omega_term</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">dOmega_dr</span> <span class="o">*</span> <span class="n">B_r</span>

        <span class="c1"># Î±-effect: generates B_r from B_Ï†</span>
        <span class="n">alpha_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>
        <span class="n">alpha_term</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">*</span> <span class="n">B_phi</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">B_phi</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dr</span><span class="p">)</span>

        <span class="c1"># Update equations</span>
        <span class="n">dB_phi_dt</span> <span class="o">=</span> <span class="n">omega_term</span> <span class="o">+</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">d2B_phi</span>
        <span class="n">dB_r_dt</span> <span class="o">=</span> <span class="n">alpha_term</span> <span class="o">+</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">d2B_r</span>

        <span class="n">B_phi</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dB_phi_dt</span>
        <span class="n">B_r</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dB_r_dt</span>

        <span class="c1"># Store snapshots</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">B_phi_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B_phi</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="n">B_r_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B_r</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>

    <span class="c1"># Plot evolution</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span><span class="o">//</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">B_phi_hist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">B_r_hist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius r&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Toroidal field $B_</span><span class="se">\\</span><span class="s1">phi$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Î±-Î© Dynamo: Toroidal Field Evolution&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius r&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Radial field $B_r$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Î±-Î© Dynamo: Radial Field Evolution&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;alpha_omega_dynamo_1d.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Growth rate analysis</span>
    <span class="n">B_total</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Bp</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Br</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">Bp</span><span class="p">,</span> <span class="n">Br</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">B_phi_hist</span><span class="p">,</span> <span class="n">B_r_hist</span><span class="p">)]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">B_total</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Total field energy (RMS)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Î±-Î© Dynamo: Exponential Growth&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;alpha_omega_growth.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Estimate growth rate</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">log_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B_total</span><span class="p">[</span><span class="mi">5</span><span class="p">:]))</span>  <span class="c1"># Exclude initial transient</span>
        <span class="n">t_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">t_fit</span><span class="p">,</span> <span class="n">log_B</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">growth_rate</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated growth rate Î³: </span><span class="si">{</span><span class="n">growth_rate</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">B_phi_hist</span><span class="p">,</span> <span class="n">B_r_hist</span><span class="p">,</span> <span class="n">times</span>

<span class="c1"># Run simulation</span>
<span class="n">alpha_omega_dynamo_1d</span><span class="p">()</span>
</code></pre></div>

<h3 id="72-ponomarenko-dynamo-dispersion-relation">7.2 Ponomarenko Dynamo Dispersion Relation<a class="header-link" href="#72-ponomarenko-dynamo-dispersion-relation" title="Permanent link">&para;</a></h3>
<p>Calculate the growth rate vs. wavenumber for the Ponomarenko dynamo:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">fsolve</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ponomarenko_dispersion</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve the Ponomarenko dynamo dispersion relation.</span>

<span class="sd">    For helical flow in cylinder:</span>
<span class="sd">      v_Ï† = rÎ©, v_z = U</span>

<span class="sd">    Simplified dispersion (for small k, |m|=1):</span>
<span class="sd">      Î³ â‰ˆ kU - (kÂ² + Ï€Â²/aÂ²)Î·</span>

<span class="sd">    More accurate: solve eigenvalue problem numerically.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Cylinder radius</span>
    <span class="n">Omega</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Rotation rate</span>
    <span class="n">U</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Axial velocity</span>
    <span class="n">eta_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>  <span class="c1"># Magnetic diffusivities</span>

    <span class="n">k_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Axial wavenumber</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">eta</span> <span class="ow">in</span> <span class="n">eta_vals</span><span class="p">:</span>
        <span class="n">Rm</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">a</span> <span class="o">/</span> <span class="n">eta</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">k_vals</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">k_vals</span><span class="p">):</span>
            <span class="c1"># Simplified growth rate</span>
            <span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">U</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">eta</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_vals</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Rm = </span><span class="si">{</span><span class="n">Rm</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> (Î·=</span><span class="si">{</span><span class="n">eta</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Axial wavenumber k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Growth rate Î³&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ponomarenko Dynamo Dispersion Relation&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ponomarenko_dispersion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Find critical Rm</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Critical Magnetic Reynolds Numbers:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]:</span>
        <span class="c1"># At marginal stability: Î³ = 0</span>
        <span class="c1"># 0 = kU - (kÂ² + Ï€Â²/aÂ²)Î·</span>
        <span class="c1"># Î·_c = kU / (kÂ² + Ï€Â²/aÂ²)</span>
        <span class="n">eta_c</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">U</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">Rm_c</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">a</span> <span class="o">/</span> <span class="n">eta_c</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  k = </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">: Rm_c = </span><span class="si">{</span><span class="n">Rm_c</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ponomarenko_dispersion</span><span class="p">()</span>
</code></pre></div>

<h3 id="73-solar-butterfly-diagram-simulation">7.3 Solar Butterfly Diagram Simulation<a class="header-link" href="#73-solar-butterfly-diagram-simulation" title="Permanent link">&para;</a></h3>
<p>Simulate the latitudinal migration of toroidal field in an Î±-Î© dynamo:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solar_butterfly_diagram</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplified solar butterfly diagram from Î±-Î© dynamo.</span>

<span class="sd">    2D model in (Î¸, t) where Î¸ is latitude.</span>

<span class="sd">    Equations:</span>
<span class="sd">      âˆ‚B_Ï†/âˆ‚t = C_Î© âˆ‚Â²Î©/âˆ‚Î¸Â² B_Î¸ + Î· âˆ‚Â²B_Ï†/âˆ‚Î¸Â²</span>
<span class="sd">      âˆ‚B_Î¸/âˆ‚t = C_Î± Î±(Î¸) B_Ï† + Î· âˆ‚Â²B_Î¸/âˆ‚Î¸Â²</span>

<span class="sd">    Use profiles:</span>
<span class="sd">      Î©(Î¸) ~ 1 + Î´Î© cosÂ²(Î¸)  (equator faster)</span>
<span class="sd">      Î±(Î¸) ~ cos(Î¸)  (sign changes across equator)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="n">Ntheta</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ntheta</span><span class="p">)</span>  <span class="c1"># Latitude</span>
    <span class="n">dtheta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Differential rotation: Î©(Î¸) = Î©0(1 + Î´Î© cosÂ²Î¸)</span>
    <span class="n">Omega0</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">delta_Omega</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Omega</span> <span class="o">=</span> <span class="n">Omega0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">delta_Omega</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">d2Omega_dtheta2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">delta_Omega</span> <span class="o">*</span> <span class="n">Omega0</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Alpha effect: Î±(Î¸) = Î±0 cos(Î¸)</span>
    <span class="n">alpha0</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="c1"># Coefficients</span>
    <span class="n">C_Omega</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># Î©-effect strength</span>
    <span class="n">C_alpha</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># Î±-effect strength</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.1</span>       <span class="c1"># Diffusivity</span>

    <span class="c1"># Time stepping</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="mi">2000</span>

    <span class="c1"># Initialize fields</span>
    <span class="n">B_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Ntheta</span><span class="p">)</span>
    <span class="n">B_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Ntheta</span><span class="p">)</span>

    <span class="c1"># Initial perturbation at mid-latitudes</span>
    <span class="n">B_theta</span> <span class="o">+=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">theta</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="c1"># Storage</span>
    <span class="n">B_phi_hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="o">//</span><span class="mi">10</span><span class="p">,</span> <span class="n">Ntheta</span><span class="p">))</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="o">//</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Time evolution</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="p">):</span>
        <span class="c1"># Second derivatives</span>
        <span class="n">d2B_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Ntheta</span><span class="p">)</span>
        <span class="n">d2B_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Ntheta</span><span class="p">)</span>

        <span class="n">d2B_phi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">B_phi</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">B_phi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">B_phi</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dtheta</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">d2B_theta</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">B_theta</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">B_theta</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">B_theta</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dtheta</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Boundary: zero at poles</span>
        <span class="n">d2B_phi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">d2B_phi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">d2B_theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">d2B_theta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Î©-effect</span>
        <span class="n">omega_term</span> <span class="o">=</span> <span class="n">C_Omega</span> <span class="o">*</span> <span class="n">d2Omega_dtheta2</span> <span class="o">*</span> <span class="n">B_theta</span>

        <span class="c1"># Î±-effect</span>
        <span class="n">alpha_term</span> <span class="o">=</span> <span class="n">C_alpha</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">B_phi</span>

        <span class="c1"># Update</span>
        <span class="n">dB_phi_dt</span> <span class="o">=</span> <span class="n">omega_term</span> <span class="o">+</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">d2B_phi</span>
        <span class="n">dB_theta_dt</span> <span class="o">=</span> <span class="n">alpha_term</span> <span class="o">+</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">d2B_theta</span>

        <span class="n">B_phi</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dB_phi_dt</span>
        <span class="n">B_theta</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dB_theta_dt</span>

        <span class="c1"># Store</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">B_phi_hist</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">10</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">B_phi</span>
            <span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># Plot butterfly diagram</span>
    <span class="n">theta_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">theta_deg</span><span class="p">,</span> <span class="n">B_phi_hist</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Toroidal field $B_</span><span class="se">\\</span><span class="s1">phi$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (arbitrary units)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude (degrees)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Solar Butterfly Diagram (Î±-Î© Dynamo Simulation)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;butterfly_diagram.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">solar_butterfly_diagram</span><span class="p">()</span>
</code></pre></div>

<h3 id="74-kinematic-dynamo-growth-rate-calculation">7.4 Kinematic Dynamo Growth Rate Calculation<a class="header-link" href="#74-kinematic-dynamo-growth-rate-calculation" title="Permanent link">&para;</a></h3>
<p>General framework for computing growth rates in kinematic dynamos:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">eig</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kinematic_dynamo_eigenvalue</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute eigenvalues of the kinematic dynamo operator.</span>

<span class="sd">    Discretize the induction equation:</span>
<span class="sd">      âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B) + Î·âˆ‡Â²B</span>

<span class="sd">    in Fourier space for periodic domain.</span>

<span class="sd">    Eigenvalue problem: Î³ b = L b</span>
<span class="sd">    where L is the linear operator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simplified 1D model for illustration</span>
    <span class="c1"># Consider B(x,t) in periodic domain [0, 2Ï€]</span>

    <span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>  <span class="c1"># Number of Fourier modes</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># Wavenumbers</span>

    <span class="c1"># Prescribed velocity: v(x) = V0 sin(x)</span>
    <span class="n">V0</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.01</span>

    <span class="c1"># In Fourier space, multiplication by v becomes convolution</span>
    <span class="c1"># For simplicity, use a simple shear flow: v = V0 xÌ‚</span>
    <span class="c1"># Then (vÃ—B) has components involving derivatives</span>

    <span class="c1"># Construct operator matrix (simplified for 1D scalar case)</span>
    <span class="c1"># This is a toy model; real dynamos need full 3D vector treatment</span>

    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="c1"># Diagonal: diffusion term</span>
        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">eta</span> <span class="o">*</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Off-diagonal: advection/stretching (coupling between modes)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">V0</span> <span class="o">*</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Simplified coupling</span>

    <span class="c1"># Compute eigenvalues</span>
    <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

    <span class="c1"># Growth rates are real parts</span>
    <span class="n">growth_rates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">growth_rates</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Growth rate Re(Î³)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Re(Î³)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Im(Î³)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eigenvalue Spectrum&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">growth_rates</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mode number&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Growth rate Re(Î³)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Growth Rates by Mode&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dynamo_eigenvalues.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">max_growth_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">growth_rates</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum growth rate: </span><span class="si">{</span><span class="n">growth_rates</span><span class="p">[</span><span class="n">max_growth_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Corresponding frequency: </span><span class="si">{</span><span class="n">frequencies</span><span class="p">[</span><span class="n">max_growth_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">growth_rates</span><span class="p">[</span><span class="n">max_growth_idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dynamo action detected!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No dynamo action (all modes decay).&quot;</span><span class="p">)</span>

<span class="n">kinematic_dynamo_eigenvalue</span><span class="p">()</span>
</code></pre></div>

<h2 id="8-summary">8. Summary<a class="header-link" href="#8-summary" title="Permanent link">&para;</a></h2>
<p><strong>Dynamo theory</strong> provides the framework for understanding how astrophysical magnetic fields are generated and maintained:</p>
<ol>
<li>
<p><strong>The dynamo problem:</strong> Magnetic fields decay on resistive timescales much shorter than astrophysical ages â†’ active generation needed.</p>
</li>
<li>
<p><strong>Induction equation:</strong> <code>âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B) + Î·âˆ‡Â²B</code> governs field evolution, with competition between advection/stretching and diffusion.</p>
</li>
<li>
<p><strong>Anti-dynamo theorems:</strong></p>
</li>
<li><strong>Cowling:</strong> No axisymmetric dynamo</li>
<li><strong>Zeldovich:</strong> No 2D dynamo</li>
<li>
<p>Implication: need 3D, non-axisymmetric flows</p>
</li>
<li>
<p><strong>Kinematic dynamos:</strong> Prescribed velocity, solve for B growth.</p>
</li>
<li><strong>Stretch-twist-fold</strong> mechanism</li>
<li><strong>Ponomarenko dynamo:</strong> helical flow in cylinder</li>
<li>
<p><strong>Roberts flow:</strong> cellular flow with helicity</p>
</li>
<li>
<p><strong>Mean-field theory:</strong></p>
</li>
<li><strong>Î±-effect:</strong> helical turbulence regenerates poloidal from toroidal (and vice versa)</li>
<li><strong>Î²-effect:</strong> turbulent diffusion</li>
<li><strong>Î±-Î© dynamos:</strong> differential rotation + Î±-effect (Sun, planets)</li>
<li>
<p><strong>Î±Â² dynamos:</strong> Î±-effect alone</p>
</li>
<li>
<p><strong>Dynamical dynamos:</strong></p>
</li>
<li>Lorentz force back-reaction saturates field growth</li>
<li><strong>Î±-quenching:</strong> reduces Î± as B increases</li>
<li>
<p><strong>Catastrophic quenching:</strong> severe reduction at high Rm (resolved by helicity fluxes)</p>
</li>
<li>
<p><strong>Applications:</strong></p>
</li>
<li><strong>Geodynamo:</strong> convection in Earth's outer core, Î±-Î© or Î±Â² mechanism</li>
<li><strong>Solar dynamo:</strong> Î±-Î© at tachocline, 11/22-year cycle, butterfly diagram</li>
<li>
<p>Stellar and galactic dynamos</p>
</li>
<li>
<p><strong>Numerical methods:</strong> spectral, finite-difference, vector potential, constrained transport.</p>
</li>
</ol>
<p>Understanding dynamos is crucial for explaining planetary magnetism, stellar activity cycles, and the magnetization of galaxies and the early universe.</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Free Decay Timescale:</strong> Calculate the magnetic diffusion timescale for:</li>
<li>Earth's core: <code>L = 10â¶ m</code>, <code>Î· = 2 mÂ²/s</code></li>
<li>Sun's convection zone: <code>L = 2Ã—10â¸ m</code>, <code>Î· = 10â´ mÂ²/s</code> (turbulent)</li>
<li>
<p>Compare to their ages.</p>
</li>
<li>
<p><strong>Magnetic Reynolds Number:</strong> For the solar convection zone with <code>v ~ 100 m/s</code>, <code>L ~ 10â¸ m</code>, <code>Î· ~ 10â´ mÂ²/s</code>, compute <code>Rm</code>. Is dynamo action possible?</p>
</li>
<li>
<p><strong>Cowling's Theorem:</strong> Consider a purely toroidal field <code>B = B_Ï†(r,z,t) e_Ï†</code>. Show that the induction equation requires sources from poloidal field to sustain <code>B_Ï†</code>.</p>
</li>
<li>
<p><strong>Ponomarenko Growth Rate:</strong> For a cylinder with <code>a = 1 m</code>, <code>U = 1 m/s</code>, <code>Î© = 1 rad/s</code>, <code>Î· = 0.05 mÂ²/s</code>, estimate the growth rate for <code>k = 1 mâ»Â¹</code> using the simplified formula.</p>
</li>
<li>
<p><strong>Î±-Effect Estimate:</strong> For convective turbulence with <code>u_rms = 10 m/s</code>, correlation time <code>Ï„_c = 10â´ s</code>, and helicity <code>âŸ¨hâŸ© = 10â»Â³ m/sÂ²</code>, estimate Î±.</p>
</li>
<li>
<p><strong>Î±-Î© Dynamo Number:</strong> In a spherical shell of radius <code>R = 10â¸ m</code>, with <code>Î± = 1 m/s</code>, <code>Î”Î© = 10â»â¶ rad/s</code>, <code>Î·_eff = 10â´ mÂ²/s</code>, compute the dynamo number <code>D_Î±Î©</code>. Is dynamo expected?</p>
</li>
<li>
<p><strong>Equipartition Field:</strong> For a flow with <code>Ï = 10Â³ kg/mÂ³</code>, <code>v = 100 m/s</code>, estimate the equipartition magnetic field strength.</p>
</li>
<li>
<p><strong>Python Exercise:</strong> Modify the Î±-Î© 1D code to include Î±-quenching: <code>Î±(B) = Î±â‚€/(1 + BÂ²/B_eqÂ²)</code>. Observe the transition from exponential growth to saturation.</p>
</li>
<li>
<p><strong>Butterfly Diagram Analysis:</strong> From the simulation, measure the period of oscillations and the equatorward propagation speed. How do they depend on <code>C_Î©</code> and <code>C_Î±</code>?</p>
</li>
<li>
<p><strong>Advanced:</strong> Implement a simple 2D kinematic dynamo using Fourier spectral methods. Prescribe a Roberts flow and solve for magnetic field evolution. Compute the growth rate and compare to literature values.</p>
</li>
</ol>
<hr />
<p><strong>Previous:</strong> <a href="./08_MHD_Turbulence.md">MHD Turbulence</a> | <strong>Next:</strong> <a href="./10_Turbulent_Dynamo.md">Turbulent Dynamo</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/08_MHD_Turbulence.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">8. MHD Turbulence</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/10_Turbulent_Dynamo.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">10. Turbulent Dynamo</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}