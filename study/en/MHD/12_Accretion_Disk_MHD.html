{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12. Accretion Disk MHD - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">12. Accretion Disk MHD</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>12. Accretion Disk MHD</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/11_Solar_MHD.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">11. Solar MHD</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/13_Fusion_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">13. Fusion MHD</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-accretion-disk-basics">1. Accretion Disk Basics</a><ul>
<li><a href="#11-the-angular-momentum-problem">1.1 The Angular Momentum Problem</a></li>
<li><a href="#12-the-disk-model-shakura-sunyaev-1973">1.2 The Î±-Disk Model (Shakura &amp; Sunyaev 1973)</a></li>
<li><a href="#13-disk-structure-equations">1.3 Disk Structure Equations</a></li>
</ul>
</li>
<li><a href="#2-magnetorotational-instability-mri">2. Magnetorotational Instability (MRI)</a><ul>
<li><a href="#21-discovery-and-importance">2.1 Discovery and Importance</a></li>
<li><a href="#22-physical-mechanism-spring-analogy">2.2 Physical Mechanism: Spring Analogy</a></li>
<li><a href="#23-local-linear-analysis-shearing-box">2.3 Local Linear Analysis: Shearing Box</a></li>
<li><a href="#24-mri-dispersion-relation">2.4 MRI Dispersion Relation</a></li>
<li><a href="#25-non-axisymmetric-modes">2.5 Non-Axisymmetric Modes</a></li>
<li><a href="#26-why-keplerian-disks-are-rayleigh-stable-but-mri-unstable">2.6 Why Keplerian Disks Are Rayleigh Stable but MRI Unstable</a></li>
</ul>
</li>
<li><a href="#3-angular-momentum-transport-in-mri-turbulence">3. Angular Momentum Transport in MRI Turbulence</a><ul>
<li><a href="#31-maxwell-stress">3.1 Maxwell Stress</a></li>
<li><a href="#32-mri-turbulence-simulations">3.2 MRI Turbulence Simulations</a></li>
<li><a href="#33-effective-viscosity">3.3 Effective Viscosity</a></li>
</ul>
</li>
<li><a href="#4-nonlinear-mri-and-turbulent-saturation">4. Nonlinear MRI and Turbulent Saturation</a><ul>
<li><a href="#41-channel-solution">4.1 Channel Solution</a></li>
<li><a href="#42-saturation-mechanism">4.2 Saturation Mechanism</a></li>
<li><a href="#43-mri-in-stratified-disks">4.3 MRI in Stratified Disks</a></li>
</ul>
</li>
<li><a href="#5-dead-zones-and-non-ideal-mhd-effects">5. Dead Zones and Non-Ideal MHD Effects</a><ul>
<li><a href="#51-mri-in-protoplanetary-disks">5.1 MRI in Protoplanetary Disks</a></li>
<li><a href="#52-non-ideal-mhd-effects">5.2 Non-Ideal MHD Effects</a></li>
</ul>
</li>
<li><a href="#6-disk-winds-and-jets">6. Disk Winds and Jets</a><ul>
<li><a href="#61-blandford-payne-mechanism-1982">6.1 Blandford-Payne Mechanism (1982)</a></li>
<li><a href="#62-magnetic-tower">6.2 Magnetic Tower</a></li>
<li><a href="#63-application-to-agn-jets">6.3 Application to AGN Jets</a></li>
</ul>
</li>
<li><a href="#7-python-implementations">7. Python Implementations</a><ul>
<li><a href="#71-mri-dispersion-relation">7.1 MRI Dispersion Relation</a></li>
<li><a href="#72-mri-growth-rate-vs-field-strength">7.2 MRI Growth Rate vs. Field Strength</a></li>
<li><a href="#73-shearing-box-local-analysis">7.3 Shearing Box Local Analysis</a></li>
<li><a href="#74-blandford-payne-wind-solution-simplified">7.4 Blandford-Payne Wind Solution (Simplified)</a></li>
<li><a href="#75-mri-turbulence-energy-evolution-toy-model">7.5 MRI Turbulence Energy Evolution (Toy Model)</a></li>
</ul>
</li>
<li><a href="#8-summary">8. Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="12-accretion-disk-mhd">12. Accretion Disk MHD<a class="header-link" href="#12-accretion-disk-mhd" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li>Understand the fundamental problem of angular momentum transport in accretion disks</li>
<li>Derive and analyze the magnetorotational instability (MRI) dispersion relation</li>
<li>Explain why MRI is essential for astrophysical disk accretion</li>
<li>Calculate MRI growth rates and characteristic wavelengths</li>
<li>Understand angular momentum transport via Maxwell and Reynolds stresses</li>
<li>Relate MRI turbulence to the Î±-disk model</li>
<li>Describe disk winds and jet formation mechanisms (Blandford-Payne, magnetic tower)</li>
<li>Implement numerical models of MRI and disk physics</li>
</ul>
<h2 id="1-accretion-disk-basics">1. Accretion Disk Basics<a class="header-link" href="#1-accretion-disk-basics" title="Permanent link">&para;</a></h2>
<h3 id="11-the-angular-momentum-problem">1.1 The Angular Momentum Problem<a class="header-link" href="#11-the-angular-momentum-problem" title="Permanent link">&para;</a></h3>
<p><strong>Accretion disks</strong> form around compact objects (black holes, neutron stars, white dwarfs) and protostars when infalling material has significant angular momentum. The material settles into a rotating disk configuration.</p>
<p><strong>Keplerian rotation:</strong></p>
<p>For a test particle in circular orbit at radius <code>r</code> around a central mass <code>M</code>:</p>
<div class="highlight"><pre><span></span><code>Centrifugal force = Gravitational force
vÂ²/r = GM/rÂ²
v = âˆš(GM/r)
</code></pre></div>

<p>Angular velocity:</p>
<div class="highlight"><pre><span></span><code>Î©(r) = v/r = âˆš(GM/rÂ³) âˆ r^{-3/2}
</code></pre></div>

<p>This is <strong>Keplerian rotation</strong>: angular velocity decreases with radius.</p>
<p><strong>The problem:</strong></p>
<p>For material to accrete (move inward), it must <strong>lose angular momentum</strong>. But how?</p>
<p><strong>Specific angular momentum:</strong></p>
<div class="highlight"><pre><span></span><code>â„“ = rÂ² Î© = âˆš(GM r)
</code></pre></div>

<p>At the innermost stable circular orbit (ISCO) for a Schwarzschild black hole:</p>
<div class="highlight"><pre><span></span><code>r_ISCO = 6 GM/cÂ²
â„“_ISCO = âˆš(6 GMÂ² / cÂ²)
</code></pre></div>

<p>Material at large <code>r</code> has much larger <code>â„“</code>. To reach the ISCO, it must shed angular momentum.</p>
<p><strong>Possible mechanisms:</strong></p>
<ol>
<li><strong>Molecular viscosity:</strong> Far too small (Re ~ 10Â¹â´ in astrophysical disks)</li>
<li><strong>Gravitational torques:</strong> In stellar binaries or self-gravitating disks (marginal)</li>
<li><strong>Magnetic fields + turbulence:</strong> This is the key!</li>
</ol>
<h3 id="12-the-disk-model-shakura-sunyaev-1973">1.2 The Î±-Disk Model (Shakura &amp; Sunyaev 1973)<a class="header-link" href="#12-the-disk-model-shakura-sunyaev-1973" title="Permanent link">&para;</a></h3>
<p>In the absence of a detailed understanding of angular momentum transport, Shakura &amp; Sunyaev parameterized it:</p>
<p><strong>Viscous stress:</strong></p>
<div class="highlight"><pre><span></span><code>Ï„_rÏ† = -Ï Î½_eff r dÎ©/dr
</code></pre></div>

<p>where <code>Î½_eff</code> is an <strong>effective viscosity</strong> (not molecular!).</p>
<p><strong>Parameterization:</strong></p>
<div class="highlight"><pre><span></span><code>Î½_eff = Î± c_s H
</code></pre></div>

<p>where:
- <code>Î±</code> is a dimensionless parameter (0 &lt; Î± &lt; 1)
- <code>c_s</code> is the sound speed
- <code>H</code> is the disk scale height</p>
<p><strong>Physical interpretation:</strong></p>
<ul>
<li>Turbulent eddies of size <code>~ H</code> move with velocity <code>~ c_s</code></li>
<li>Mixing length theory: <code>Î½_eff ~ v_turb Ã— â„“_mix ~ c_s H</code></li>
<li><code>Î±</code> measures efficiency of angular momentum transport</li>
</ul>
<p><strong>Typical values:</strong></p>
<p>From observations (fits to X-ray binaries, AGN):</p>
<div class="highlight"><pre><span></span><code>Î± ~ 0.01 - 0.1
</code></pre></div>

<p><strong>Key question:</strong> What physical process sets <code>Î±</code>? For decades, this was unknown. The answer: <strong>MRI-driven turbulence</strong>.</p>
<h3 id="13-disk-structure-equations">1.3 Disk Structure Equations<a class="header-link" href="#13-disk-structure-equations" title="Permanent link">&para;</a></h3>
<p><strong>Mass conservation:</strong></p>
<div class="highlight"><pre><span></span><code>âˆ‚Î£/âˆ‚t + (1/r) âˆ‚(r Î£ v_r)/âˆ‚r = 0
</code></pre></div>

<p>where <code>Î£</code> is surface density, <code>v_r</code> is radial velocity.</p>
<p><strong>Angular momentum conservation:</strong></p>
<div class="highlight"><pre><span></span><code>âˆ‚(Î£ rÂ² Î©)/âˆ‚t + (1/r) âˆ‚(rÂ² Î£ v_r rÂ² Î©)/âˆ‚r = (1/r) âˆ‚(rÂ² Ï„_rÏ†)/âˆ‚r
</code></pre></div>

<p><strong>Energy equation:</strong></p>
<p>Viscous dissipation heats the disk:</p>
<div class="highlight"><pre><span></span><code>Q_vis = Ï„_rÏ† r dÎ©/dr
</code></pre></div>

<p>This energy is radiated away:</p>
<div class="highlight"><pre><span></span><code>Q_rad = Ïƒ T_effâ´
</code></pre></div>

<p>where <code>T_eff</code> is the effective surface temperature.</p>
<p><strong>Steady-state accretion:</strong></p>
<p>In steady state, <code>âˆ‚/âˆ‚t = 0</code>, and there's a constant accretion rate <code>á¹€</code>:</p>
<div class="highlight"><pre><span></span><code>Î£ v_r Ã— 2Ï€r = -á¹€
</code></pre></div>

<p>(Negative because inflow.)</p>
<p><strong>Temperature profile:</strong></p>
<p>For a geometrically thin disk (<code>H â‰ª r</code>):</p>
<div class="highlight"><pre><span></span><code>T_eff âˆ (á¹€ / rÂ³)^{1/4}
</code></pre></div>

<p>For a black hole accretion disk:</p>
<div class="highlight"><pre><span></span><code>T_eff ~ 10â¶ (á¹€ / á¹€_Edd)^{1/4} (M / 10 M_â˜‰)^{-1/4} (r / 10 R_s)^{-3/4} K
</code></pre></div>

<p>This is hot enough to emit X-rays in the inner regions!</p>
<h2 id="2-magnetorotational-instability-mri">2. Magnetorotational Instability (MRI)<a class="header-link" href="#2-magnetorotational-instability-mri" title="Permanent link">&para;</a></h2>
<h3 id="21-discovery-and-importance">2.1 Discovery and Importance<a class="header-link" href="#21-discovery-and-importance" title="Permanent link">&para;</a></h3>
<p><strong>Balbus &amp; Hawley (1991)</strong> rediscovered (after Velikhov 1959, Chandrasekhar 1960) that a weak magnetic field in a differentially rotating disk is <strong>linearly unstable</strong> to the <strong>magnetorotational instability (MRI)</strong>.</p>
<p><strong>Significance:</strong></p>
<ul>
<li>MRI is the <strong>most important instability</strong> in accretion disk theory</li>
<li>Generates turbulence â†’ effective viscosity â†’ accretion</li>
<li>Sets <code>Î± ~ 0.01</code> in MRI-turbulent disks</li>
<li>Operates in protoplanetary disks, X-ray binaries, AGN, tidal disruption events</li>
</ul>
<h3 id="22-physical-mechanism-spring-analogy">2.2 Physical Mechanism: Spring Analogy<a class="header-link" href="#22-physical-mechanism-spring-analogy" title="Permanent link">&para;</a></h3>
<p><strong>Setup:</strong></p>
<ul>
<li>Two fluid elements at radii <code>r</code> and <code>r + Î´r</code></li>
<li>Connected by a magnetic field line (acts like a spring)</li>
<li>Disk has Keplerian rotation: <code>Î©(r) âˆ r^{-3/2}</code></li>
</ul>
<p><strong>Unperturbed state:</strong></p>
<p>Both elements rotate at their local <code>Î©(r)</code>.</p>
<p><strong>Perturbation:</strong></p>
<p>Displace the inner element outward and the outer element inward (slight radial perturbation).</p>
<p><strong>Evolution:</strong></p>
<ol>
<li><strong>Without magnetic field:</strong></li>
<li>Inner element moves outward â†’ conserves angular momentum â†’ rotates slower than local Keplerian â†’ lags behind</li>
<li>Outer element moves inward â†’ rotates faster â†’ moves ahead</li>
<li>
<p>They drift apart azimuthally â†’ <strong>stable</strong> (Rayleigh criterion)</p>
</li>
<li>
<p><strong>With magnetic field:</strong></p>
</li>
<li>Magnetic tension acts like a spring connecting the two elements</li>
<li>Inner element (now outward, slower) is <strong>pulled forward</strong> by the field â†’ gains angular momentum â†’ moves further outward</li>
<li>Outer element (now inward, faster) is <strong>pulled backward</strong> â†’ loses angular momentum â†’ moves further inward</li>
<li><strong>Positive feedback</strong> â†’ instability!</li>
</ol>
<p><strong>Key insight:</strong></p>
<p>The magnetic field <strong>transports angular momentum outward</strong> (from inner to outer element), allowing the inner element to move outward and the outer to move inward â†’ <strong>instability</strong> despite Rayleigh stability.</p>
<h3 id="23-local-linear-analysis-shearing-box">2.3 Local Linear Analysis: Shearing Box<a class="header-link" href="#23-local-linear-analysis-shearing-box" title="Permanent link">&para;</a></h3>
<p>To analyze MRI, we use the <strong>shearing box</strong> approximation (Goldreich &amp; Lynden-Bell 1965):</p>
<p><strong>Coordinates:</strong></p>
<ul>
<li>Local Cartesian frame at radius <code>r_0</code></li>
<li><code>x = r - r_0</code> (radial, outward)</li>
<li><code>y = r_0 (Ï† - Î©_0 t)</code> (azimuthal, in rotating frame)</li>
<li><code>z</code> (vertical)</li>
</ul>
<p><strong>Shear flow:</strong></p>
<p>In the rotating frame, the background velocity is:</p>
<div class="highlight"><pre><span></span><code>v_y = -q Î©_0 x
</code></pre></div>

<p>where <code>q = -d ln Î© / d ln r</code>. For Keplerian: <code>q = 3/2</code>.</p>
<p><strong>Linearized MHD equations:</strong></p>
<p>Perturb around a uniform vertical field <code>B_0 = B_z áº‘</code>:</p>
<div class="highlight"><pre><span></span><code>âˆ‚v&#39;/âˆ‚t + (vÂ·âˆ‡)v&#39; = -(1/Ï)âˆ‡p&#39; + (1/ÏÎ¼_0)(âˆ‡Ã—B&#39;)Ã—B_0 + 2q Î©_0Â² x xÌ‚
âˆ‚B&#39;/âˆ‚t = âˆ‡Ã—(v&#39;Ã—B_0)
âˆ‡Â·v&#39; = 0, âˆ‡Â·B&#39; = 0
</code></pre></div>

<p>The term <code>2q Î©_0Â² x xÌ‚</code> is the <strong>tidal force</strong> (from local expansion of gravity).</p>
<p><strong>Seek plane wave solutions:</strong></p>
<div class="highlight"><pre><span></span><code>v&#39; ~ exp(i kÂ·x + Î³ t)
B&#39; ~ exp(i kÂ·x + Î³ t)
</code></pre></div>

<h3 id="24-mri-dispersion-relation">2.4 MRI Dispersion Relation<a class="header-link" href="#24-mri-dispersion-relation" title="Permanent link">&para;</a></h3>
<p>For simplicity, consider <strong>axisymmetric modes</strong> (<code>k_y = 0</code> initially) with vertical field <code>B_0 = B_z áº‘</code> and wavenumber <code>k = k_z</code>.</p>
<p><strong>Incompressibility:</strong></p>
<p>Assume <code>âˆ‡Â·v' = 0</code> (valid for subsonic perturbations).</p>
<p><strong>Dispersion relation:</strong></p>
<p>After some algebra (see Balbus &amp; Hawley 1991, 1998 for derivation), the growth rate <code>Î³</code> satisfies:</p>
<div class="highlight"><pre><span></span><code>Î³â´ + Î³Â² [2ÎºÂ² - (2 - q) Î©_0Â²] + ÎºÂ² [ÎºÂ² - (k v_A)Â²] = 0
</code></pre></div>

<p>where:
- <code>ÎºÂ² = 2 Î©_0 (Î©_0 + r dÎ©/dr) = (2 - q) Î©_0Â²</code> is the <strong>epicyclic frequency</strong> squared
- <code>v_A = B_0 / âˆš(Î¼_0 Ï)</code> is the AlfvÃ©n speed</p>
<p>For Keplerian rotation (<code>q = 3/2</code>):</p>
<div class="highlight"><pre><span></span><code>ÎºÂ² = Î©_0Â²
</code></pre></div>

<p>The dispersion relation becomes:</p>
<div class="highlight"><pre><span></span><code>Î³â´ + Î³Â² (2 Î©_0Â² - Î©_0Â²/2) + Î©_0Â² [Î©_0Â² - (k v_A)Â²] = 0
Î³â´ + (3/2) Î©_0Â² Î³Â² + Î©_0Â² [Î©_0Â² - (k v_A)Â²] = 0
</code></pre></div>

<p><strong>Instability condition:</strong></p>
<p>For <code>Î³Â²</code> to be positive (exponential growth):</p>
<p>The discriminant of the quadratic (in <code>Î³Â²</code>) must be positive, and at least one root <code>Î³Â² &gt; 0</code>.</p>
<p>Solving:</p>
<div class="highlight"><pre><span></span><code>Î³Â² = -(3/4) Î©_0Â² Â± âˆš[(9/16) Î©_0â´ - Î©_0Â² (Î©_0Â² - (k v_A)Â²)]
    = -(3/4) Î©_0Â² Â± Î©_0Â² âˆš[(9/16) - 1 + (k v_A / Î©_0)Â²]
    = -(3/4) Î©_0Â² Â± Î©_0Â² âˆš[(k v_A / Î©_0)Â² - 7/16]
</code></pre></div>

<p>For instability, we need:</p>
<div class="highlight"><pre><span></span><code>(k v_A / Î©_0)Â² &lt; 7/16  (long wavelengths)
</code></pre></div>

<p>Then the <code>+</code> root gives <code>Î³Â² &gt; 0</code> for some range of <code>k v_A / Î©_0</code>.</p>
<p><strong>Maximum growth rate (Balbus &amp; Hawley 1998):</strong></p>
<p>For Keplerian disk with weak vertical field:</p>
<div class="highlight"><pre><span></span><code>Î³Â² = (1/2) [(k v_A)Â² - Î©_0Â²] + (1/2) âˆš[(k v_A)Â² + Î©_0Â²)Â² - 16 q Î©_0Â² (k v_A)Â²]
</code></pre></div>

<p>For <code>q = 3/2</code> (Keplerian):</p>
<p>Maximum growth rate:</p>
<div class="highlight"><pre><span></span><code>Î³_max = (âˆš(3)/4) Î©_0 â‰ˆ 0.433 Î©_0
</code></pre></div>

<p>This occurs at <code>k v_A â†’ 0</code> (long wavelengths).</p>
<p><strong>Key results:</strong></p>
<ol>
<li><strong>Instability criterion:</strong></li>
<li>For Keplerian rotation: <strong>ANY</strong> magnetic field (no matter how weak!) is unstable</li>
<li>
<p>Condition: <code>dÎ©Â²/d ln r &lt; 0</code> (angular velocity decreasing outward)</p>
</li>
<li>
<p><strong>Growth rate:</strong></p>
</li>
<li>Comparable to orbital frequency: <code>Î³ ~ Î©_0</code> (very fast!)</li>
<li>
<p>E-folding time: <code>Ï„ = 1/Î³ ~ 1/(Î©_0) ~ orbital period</code></p>
</li>
<li>
<p><strong>Fastest growing mode:</strong></p>
</li>
<li>Wavelength: <code>Î»_MRI ~ 2Ï€ v_A / Î©_0</code></li>
<li>For weak field, <code>Î»_MRI</code> can be much smaller than disk height</li>
</ol>
<h3 id="25-non-axisymmetric-modes">2.5 Non-Axisymmetric Modes<a class="header-link" href="#25-non-axisymmetric-modes" title="Permanent link">&para;</a></h3>
<p>For modes with <code>k_y â‰  0</code> (azimuthal structure), the instability persists. Including radial and azimuthal wavenumbers:</p>
<p><strong>Full dispersion relation (general):</strong></p>
<div class="highlight"><pre><span></span><code>Î³â´ + Î³Â² [ÎºÂ² + (kÂ·v_A)Â² - 2 Î©_0 k_y v_{Ay}]
    + ÎºÂ² [(kÂ·v_A)Â² - 4 Î©_0 k_y v_{Ay}] = 0
</code></pre></div>

<p>where <code>v_A = B_0 / âˆš(Î¼_0 Ï)</code> is the AlfvÃ©n velocity vector.</p>
<p><strong>Key points:</strong></p>
<ul>
<li>Instability exists for all orientations of weak field (vertical, toroidal, etc.)</li>
<li>Growth rate is always <code>~ Î©_0</code> for Keplerian disks</li>
<li>MRI is <strong>ubiquitous</strong> in magnetized disks</li>
</ul>
<h3 id="26-why-keplerian-disks-are-rayleigh-stable-but-mri-unstable">2.6 Why Keplerian Disks Are Rayleigh Stable but MRI Unstable<a class="header-link" href="#26-why-keplerian-disks-are-rayleigh-stable-but-mri-unstable" title="Permanent link">&para;</a></h3>
<p><strong>Rayleigh criterion:</strong></p>
<p>A rotating fluid is stable to hydrodynamic (non-magnetic) perturbations if:</p>
<div class="highlight"><pre><span></span><code>d(rÂ² Î©)Â² / dr &gt; 0
</code></pre></div>

<p>For Keplerian: <code>Î© âˆ r^{-3/2}</code> â†’ <code>rÂ² Î© âˆ r^{1/2}</code> â†’ derivative &gt; 0 â†’ <strong>stable</strong>.</p>
<p>This is why Keplerian disks cannot have <strong>hydrodynamic turbulence</strong> from shear alone.</p>
<p><strong>MRI changes the game:</strong></p>
<p>Magnetic field provides a <strong>channel for angular momentum transport</strong> that bypasses the Rayleigh criterion. The magnetic tension creates a <strong>negative effective viscosity</strong> or <strong>destabilizing torque</strong> that overcomes the stabilizing centrifugal effect.</p>
<h2 id="3-angular-momentum-transport-in-mri-turbulence">3. Angular Momentum Transport in MRI Turbulence<a class="header-link" href="#3-angular-momentum-transport-in-mri-turbulence" title="Permanent link">&para;</a></h2>
<h3 id="31-maxwell-stress">3.1 Maxwell Stress<a class="header-link" href="#31-maxwell-stress" title="Permanent link">&para;</a></h3>
<p>In MHD, the <strong>stress tensor</strong> has contributions from both fluid motions (Reynolds stress) and magnetic fields (Maxwell stress).</p>
<p><strong>Total stress tensor:</strong></p>
<div class="highlight"><pre><span></span><code>T_{ij} = Ï v_i v_j + p Î´_{ij} + (B_i B_j / Î¼_0 - BÂ² Î´_{ij} / (2Î¼_0))
</code></pre></div>

<p><strong>Angular momentum transport:</strong></p>
<p>The radial transport of angular momentum (per unit area) is:</p>
<div class="highlight"><pre><span></span><code>Ï„_rÏ† = Ï v_r v_Ï† - B_r B_Ï† / Î¼_0
</code></pre></div>

<p>where:
- <code>Ï v_r v_Ï†</code> is the <strong>Reynolds stress</strong> (hydrodynamic)
- <code>-B_r B_Ï† / Î¼_0</code> is the <strong>Maxwell stress</strong> (magnetic)</p>
<p><strong>Sign convention:</strong></p>
<p>Positive <code>Ï„_rÏ†</code> â†’ outward transport of angular momentum.</p>
<h3 id="32-mri-turbulence-simulations">3.2 MRI Turbulence Simulations<a class="header-link" href="#32-mri-turbulence-simulations" title="Permanent link">&para;</a></h3>
<p>Numerical simulations (Hawley, Balbus, Stone, et al.) using shearing-box MHD codes find:</p>
<p><strong>Maxwell stress dominates:</strong></p>
<div class="highlight"><pre><span></span><code>âŸ¨B_r B_Ï†âŸ© / Î¼_0  â‰«  âŸ¨Ï v_r v_Ï†âŸ©
</code></pre></div>

<p>Typically, Maxwell stress is ~10 times larger than Reynolds stress.</p>
<p><strong>Î± parameter:</strong></p>
<p>Define:</p>
<div class="highlight"><pre><span></span><code>Î± = âŸ¨Ï„_rÏ†âŸ© / âŸ¨pâŸ©
</code></pre></div>

<p>where <code>âŸ¨Â·âŸ©</code> denotes time and volume average.</p>
<p>From simulations (e.g., Hawley, Gammie, Balbus 1995):</p>
<ul>
<li><strong>Zero net vertical flux:</strong> <code>Î± ~ 0.01-0.02</code></li>
<li><strong>With net vertical flux:</strong> <code>Î± ~ 0.05-0.5</code> (stronger transport)</li>
</ul>
<p><strong>Field configuration matters:</strong></p>
<ul>
<li><strong>Net flux (ordered field):</strong> Sustained channel modes, higher Î±</li>
<li><strong>Zero net flux (turbulent field):</strong> Sustained turbulence, but lower Î±</li>
</ul>
<h3 id="33-effective-viscosity">3.3 Effective Viscosity<a class="header-link" href="#33-effective-viscosity" title="Permanent link">&para;</a></h3>
<p>From the Î± parameter:</p>
<div class="highlight"><pre><span></span><code>Î½_eff = Î± c_s H
</code></pre></div>

<p>For a typical disk with <code>c_s ~ 10 km/s</code>, <code>H ~ 0.1 R ~ 10â¹ cm</code>, <code>Î± ~ 0.01</code>:</p>
<div class="highlight"><pre><span></span><code>Î½_eff ~ 10Â¹âµ cmÂ²/s
</code></pre></div>

<p>This is <strong>enormous</strong> compared to molecular viscosity (<code>Î½_mol ~ 1 cmÂ²/s</code>), but arises naturally from MRI turbulence.</p>
<p><strong>Accretion timescale:</strong></p>
<div class="highlight"><pre><span></span><code>Ï„_acc ~ RÂ² / Î½_eff ~ (10Â¹â° cm)Â² / (10Â¹âµ cmÂ²/s) ~ 10âµ s ~ 1 day
</code></pre></div>

<p>This allows rapid accretion onto compact objects, explaining observed X-ray variability.</p>
<h2 id="4-nonlinear-mri-and-turbulent-saturation">4. Nonlinear MRI and Turbulent Saturation<a class="header-link" href="#4-nonlinear-mri-and-turbulent-saturation" title="Permanent link">&para;</a></h2>
<h3 id="41-channel-solution">4.1 Channel Solution<a class="header-link" href="#41-channel-solution" title="Permanent link">&para;</a></h3>
<p><strong>Channel modes</strong> are exact nonlinear solutions of the incompressible MHD equations in a shearing box (Goodman &amp; Xu 1994).</p>
<p><strong>Structure:</strong></p>
<ul>
<li>Traveling waves in the azimuthal direction</li>
<li>Exponentially growing in the linear regime</li>
<li>Sustained in the nonlinear regime (for disks with net vertical flux)</li>
</ul>
<p><strong>Energy:</strong></p>
<p>Channel modes carry most of the magnetic energy and stress in saturated state (for net flux cases).</p>
<p><strong>Parasitic instabilities:</strong></p>
<p>Channel modes themselves are unstable to <strong>parasitic modes</strong> (secondary instabilities) that break them up, leading to turbulence.</p>
<h3 id="42-saturation-mechanism">4.2 Saturation Mechanism<a class="header-link" href="#42-saturation-mechanism" title="Permanent link">&para;</a></h3>
<p><strong>Lorentz force back-reaction:</strong></p>
<p>As MRI grows, magnetic field strength increases. The Lorentz force modifies the flow:</p>
<div class="highlight"><pre><span></span><code>J Ã— B ~ BÂ² / L
</code></pre></div>

<p>When magnetic pressure becomes comparable to thermal pressure:</p>
<div class="highlight"><pre><span></span><code>BÂ² / (2Î¼_0) ~ p
</code></pre></div>

<p>or</p>
<div class="highlight"><pre><span></span><code>Î² = 2Î¼_0 p / BÂ² ~ 1
</code></pre></div>

<p>the growth saturates.</p>
<p><strong>Typical saturation:</strong></p>
<p>Simulations find:</p>
<div class="highlight"><pre><span></span><code>âŸ¨BÂ²âŸ© / (2Î¼_0 âŸ¨pâŸ©) ~ 1-10  (order unity)
</code></pre></div>

<p>Magnetic energy is <strong>sub-thermal</strong> to <strong>super-thermal</strong>, depending on field configuration.</p>
<h3 id="43-mri-in-stratified-disks">4.3 MRI in Stratified Disks<a class="header-link" href="#43-mri-in-stratified-disks" title="Permanent link">&para;</a></h3>
<p>In <strong>stratified shearing-box</strong> simulations (with gravity in <code>z</code>-direction):</p>
<p><strong>Butterfly effect:</strong></p>
<p>Magnetic field develops a <strong>butterfly pattern</strong>: alternating toroidal field polarity above and below midplane, propagating in <code>z</code>.</p>
<p><strong>Zonal flows:</strong></p>
<p>Large-scale <strong>azimuthal flows</strong> (independent of <code>Ï†</code>) develop due to Reynolds stress.</p>
<p><strong>Accretion stress:</strong></p>
<p>Averaged over the vertical extent, the effective <code>Î±</code> is similar to unstratified case (~0.01-0.1), but with significant vertical variation.</p>
<h2 id="5-dead-zones-and-non-ideal-mhd-effects">5. Dead Zones and Non-Ideal MHD Effects<a class="header-link" href="#5-dead-zones-and-non-ideal-mhd-effects" title="Permanent link">&para;</a></h2>
<h3 id="51-mri-in-protoplanetary-disks">5.1 MRI in Protoplanetary Disks<a class="header-link" href="#51-mri-in-protoplanetary-disks" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong></p>
<p>MRI requires ionization (for coupling between gas and magnetic field). In protoplanetary disks:</p>
<ul>
<li><strong>Inner regions (&lt; 0.1 AU):</strong> Hot, thermally ionized â†’ MRI active</li>
<li><strong>Outer regions (&gt; 1 AU) at midplane:</strong> Cold, dense â†’ <strong>poorly ionized</strong> â†’ MRI suppressed</li>
</ul>
<p><strong>Dead zone:</strong></p>
<p>Region where ionization is too low for MRI. Criteria:</p>
<div class="highlight"><pre><span></span><code>Magnetic Reynolds number: Rm = v L / Î·_Ohm &gt; 10â´ (for MRI)
</code></pre></div>

<p>where <code>Î·_Ohm = cÂ² / (4Ï€ Ïƒ)</code> is Ohmic resistivity.</p>
<p>At the midplane of a disk at 1 AU around a young star:
- Temperature: <code>T ~ 100-300 K</code>
- Ionization fraction: <code>x_e ~ 10^{-13}</code> (from cosmic rays, radioactive decay)
- <code>Rm ~ 10-100</code> â†’ <strong>MRI suppressed</strong></p>
<p><strong>Layered accretion:</strong></p>
<ul>
<li><strong>Active zone:</strong> Near surface (ionized by UV, X-rays, cosmic rays)</li>
<li><strong>Dead zone:</strong> Midplane (neutral, no MRI)</li>
<li>Accretion proceeds primarily in the active layers</li>
</ul>
<h3 id="52-non-ideal-mhd-effects">5.2 Non-Ideal MHD Effects<a class="header-link" href="#52-non-ideal-mhd-effects" title="Permanent link">&para;</a></h3>
<p>In weakly ionized plasmas, three non-ideal effects become important:</p>
<p><strong>1. Ohmic diffusion:</strong></p>
<div class="highlight"><pre><span></span><code>âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B) + Î·_Ohm âˆ‡Â²B
</code></pre></div>

<p>Resistivity <code>Î·_Ohm</code> damps small-scale field fluctuations.</p>
<p><strong>2. Ambipolar diffusion:</strong></p>
<p>Ions and neutrals are not perfectly coupled. Magnetic field slips through neutrals:</p>
<div class="highlight"><pre><span></span><code>âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B) + âˆ‡Ã—(Î·_AD (âˆ‡Ã—B)Ã—B / BÂ²)
</code></pre></div>

<p>where <code>Î·_AD ~ B / (Ï_n Î³_in)</code>, <code>Î³_in</code> is ion-neutral collision rate.</p>
<p><strong>3. Hall effect:</strong></p>
<p>Electrons drift relative to ions in the presence of current:</p>
<div class="highlight"><pre><span></span><code>âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B) - âˆ‡Ã—(Î·_H (âˆ‡Ã—B)Ã—B / |B|)
</code></pre></div>

<p>where <code>Î·_H ~ B / (e n_e)</code>.</p>
<p><strong>Impact on MRI:</strong></p>
<ul>
<li><strong>Ohmic diffusion:</strong> Suppresses MRI at small scales â†’ raises critical wavelength</li>
<li><strong>Ambipolar diffusion:</strong> Suppresses MRI in dense, weakly ionized regions</li>
<li><strong>Hall effect:</strong> Can modify MRI (enhance or suppress depending on field direction and sign of Hall term)</li>
</ul>
<p><strong>Consequence:</strong></p>
<p>In protoplanetary disks, MRI may be active only in:
- Surface layers
- Inner hot regions
- Regions with enhanced ionization (near star, wind-swept zones)</p>
<p>Alternative mechanisms (e.g., vertical shear instability, gravitational instability) may operate in dead zones.</p>
<h2 id="6-disk-winds-and-jets">6. Disk Winds and Jets<a class="header-link" href="#6-disk-winds-and-jets" title="Permanent link">&para;</a></h2>
<h3 id="61-blandford-payne-mechanism-1982">6.1 Blandford-Payne Mechanism (1982)<a class="header-link" href="#61-blandford-payne-mechanism-1982" title="Permanent link">&para;</a></h3>
<p>Magnetic fields threading the disk can launch <strong>centrifugally driven winds</strong>.</p>
<p><strong>Setup:</strong></p>
<ul>
<li>Poloidal magnetic field <code>B_p</code> threading disk</li>
<li>Field lines anchored in disk, bend outward</li>
<li>Gas flows along field lines</li>
</ul>
<p><strong>Condition for centrifugal launch:</strong></p>
<p>The field line must be inclined at angle <code>Î¸</code> from the disk normal (vertical):</p>
<div class="highlight"><pre><span></span><code>Î¸ &gt; 30Â°  (critical angle)
</code></pre></div>

<p><strong>Physical picture:</strong></p>
<ol>
<li>Gas at radius <code>r</code> has angular velocity <code>Î©(r)</code></li>
<li>If it moves along a field line inclined outward, it conserves angular momentum: <code>L = r v_Ï† = const</code></li>
<li>At larger cylindrical radius <code>R &gt; r</code>, centrifugal force <code>LÂ²/(RÂ³)</code> can exceed gravity + magnetic tension</li>
<li>Gas is <strong>flung outward</strong> (centrifugal acceleration)</li>
</ol>
<p><strong>Acceleration:</strong></p>
<p>The wind accelerates to:</p>
<div class="highlight"><pre><span></span><code>v_âˆÂ² ~ 2 G M / r_0
</code></pre></div>

<p>where <code>r_0</code> is the launch radius. This is comparable to the <strong>escape speed</strong>.</p>
<p><strong>Mass loss rate:</strong></p>
<p>Fraction of accretion flow ejected as wind:</p>
<div class="highlight"><pre><span></span><code>á¹€_wind / á¹€_acc ~ (B_p / âˆš(4Ï€ Ï v_KÂ²)) ~ Î²_p^{-1/2}
</code></pre></div>

<p>where <code>Î²_p = 8Ï€ p / B_pÂ²</code> is the plasma beta.</p>
<h3 id="62-magnetic-tower">6.2 Magnetic Tower<a class="header-link" href="#62-magnetic-tower" title="Permanent link">&para;</a></h3>
<p>In the case of strong toroidal field (<code>B_Ï†</code>), the <strong>magnetic pressure gradient</strong> can drive collimated outflows.</p>
<p><strong>Mechanism:</strong></p>
<ol>
<li>Differential rotation winds up poloidal field â†’ strong toroidal field <code>B_Ï†</code></li>
<li>Toroidal field has pressure <code>B_Ï†Â² / (2Î¼_0)</code></li>
<li>Pressure gradient in <code>z</code> (vertical) â†’ upward force</li>
<li>Gas is pushed upward along the axis</li>
</ol>
<p><strong>Hoop stress:</strong></p>
<p>The toroidal field also exerts a <strong>pinch force</strong> (hoop stress):</p>
<div class="highlight"><pre><span></span><code>F_pinch ~ -âˆ‚(B_Ï†Â² / (2Î¼_0)) / âˆ‚R
</code></pre></div>

<p>This <strong>collimates</strong> the flow toward the axis â†’ jet formation.</p>
<p><strong>Simulations:</strong></p>
<p>MHD simulations (e.g., Lynden-Bell, Kato, Kudoh) show that a combination of:
- Toroidal field buildup
- Magnetic tower formation
- Collimation by hoop stress</p>
<p>can produce <strong>bipolar jets</strong> similar to those observed in young stellar objects and AGN.</p>
<h3 id="63-application-to-agn-jets">6.3 Application to AGN Jets<a class="header-link" href="#63-application-to-agn-jets" title="Permanent link">&para;</a></h3>
<p><strong>Active Galactic Nuclei (AGN):</strong></p>
<p>Supermassive black holes (10â¶-10â¹ Mâ˜‰) at galaxy centers accrete gas and launch powerful <strong>relativistic jets</strong>:
- Length: up to Mpc scales
- Speed: <code>v ~ 0.1-0.99 c</code>
- Power: <code>L_jet ~ 10â´Â²-10â´â· erg/s</code></p>
<p><strong>Magnetic launching:</strong></p>
<p>Leading model: <strong>Blandford-Znajek mechanism</strong> (1977)
- Magnetic field threading the <strong>black hole horizon</strong> (not just disk)
- Black hole rotation twists field lines â†’ electromagnetic energy extraction
- Power: <code>P ~ BÂ² aÂ² c</code> where <code>a</code> is black hole spin</p>
<p>Alternatively, <strong>Blandford-Payne from disk</strong> can contribute.</p>
<p><strong>Collimation:</strong></p>
<p>Toroidal field (from rotation) + external pressure (disk wind, cocoon) â†’ collimated jet.</p>
<p><strong>Observational evidence:</strong></p>
<ul>
<li>VLBI imaging: jets resolved down to ~10 Schwarzschild radii</li>
<li>Event Horizon Telescope (EHT): M87* jet base at horizon scale</li>
<li>Polarization: consistent with ordered poloidal+toroidal field</li>
</ul>
<h2 id="7-python-implementations">7. Python Implementations<a class="header-link" href="#7-python-implementations" title="Permanent link">&para;</a></h2>
<h3 id="71-mri-dispersion-relation">7.1 MRI Dispersion Relation<a class="header-link" href="#71-mri-dispersion-relation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mri_dispersion</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve MRI dispersion relation for Keplerian disk.</span>

<span class="sd">    Dispersion relation (vertical field, incompressible):</span>
<span class="sd">      Î³â´ + Î³Â² [ÎºÂ² + (k v_A)Â²] - 3 Î©Â² (k v_A)Â² = 0</span>

<span class="sd">    For Keplerian: ÎºÂ² = Î©Â²</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Omega</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Orbital frequency (normalized)</span>

    <span class="c1"># Range of k v_A / Omega</span>
    <span class="n">k_vA_over_Omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="c1"># Dispersion relation: Î³â´ + Î³Â² [Î©Â² + (k v_A)Â²] - 3 Î©Â² (k v_A)Â² = 0</span>
    <span class="c1"># Let X = Î³Â² / Î©Â², Y = (k v_A / Î©)Â²</span>
    <span class="c1"># XÂ² + X [1 + Y] - 3 Y = 0</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">k_vA_over_Omega</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Solve quadratic for X = Î³Â² / Î©Â²</span>
    <span class="c1"># X = -(1+Y)/2 Â± âˆš[(1+Y)Â²/4 + 3Y]</span>

    <span class="n">discriminant</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Y</span>
    <span class="n">X_plus</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">)</span>
    <span class="n">X_minus</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">)</span>

    <span class="c1"># Growth rate Î³ / Î© (take positive root)</span>
    <span class="n">gamma_over_Omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_plus</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X_plus</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Maximum growth rate (at k v_A â†’ 0)</span>
    <span class="n">gamma_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X_plus</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">Omega</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum growth rate: Î³_max / Î© = </span><span class="si">{</span><span class="n">gamma_max</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;                     Î³_max = </span><span class="si">{</span><span class="n">gamma_max</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Î©&quot;</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_vA_over_Omega</span><span class="p">,</span> <span class="n">gamma_over_Omega</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">gamma_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Max: Î³/Î© = </span><span class="si">{</span><span class="n">gamma_max</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$k v_A / </span><span class="se">\\</span><span class="s1">Omega$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">gamma / </span><span class="se">\\</span><span class="s1">Omega$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MRI Dispersion Relation (Keplerian Disk, Vertical Field)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mri_dispersion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Most unstable wavelength</span>
    <span class="n">idx_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">gamma_over_Omega</span><span class="p">)</span>
    <span class="n">k_vA_max</span> <span class="o">=</span> <span class="n">k_vA_over_Omega</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]</span> <span class="o">*</span> <span class="n">Omega</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Most unstable mode: k v_A = </span><span class="si">{</span><span class="n">k_vA_max</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Î©&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wavelength: Î» = 2Ï€ / k = </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">k_vA_max</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (v_A / Î©)&quot;</span><span class="p">)</span>

<span class="n">mri_dispersion</span><span class="p">()</span>
</code></pre></div>

<h3 id="72-mri-growth-rate-vs-field-strength">7.2 MRI Growth Rate vs. Field Strength<a class="header-link" href="#72-mri-growth-rate-vs-field-strength" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mri_growth_vs_field</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot MRI growth rate as a function of magnetic field strength.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Omega</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Orbital frequency</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="mf">1.0</span>    <span class="c1"># Density (normalized)</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># Permeability (normalized)</span>

    <span class="c1"># Range of magnetic field strengths</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># AlfvÃ©n speed</span>
    <span class="n">v_A</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu_0</span> <span class="o">*</span> <span class="n">rho</span><span class="p">)</span>

    <span class="c1"># For maximum growth (k v_A â†’ 0), Î³_max â‰ˆ 0.75 Î© (Keplerian)</span>
    <span class="c1"># But growth rate depends on k v_A / Î©</span>

    <span class="c1"># Choose a fixed wavelength: k = Î© / (H) where H ~ c_s / Î©</span>
    <span class="c1"># Then k v_A / Î© = v_A / c_s</span>
    <span class="n">c_s</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Sound speed (normalized)</span>

    <span class="n">k_vA_over_Omega</span> <span class="o">=</span> <span class="n">v_A</span> <span class="o">/</span> <span class="n">c_s</span>

    <span class="c1"># Compute growth rate from dispersion relation</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">k_vA_over_Omega</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">discriminant</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Y</span>
    <span class="n">X_plus</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">)</span>
    <span class="n">gamma_over_Omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_plus</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X_plus</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Growth rate vs. B</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">gamma_over_Omega</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Max (kâ†’0): Î³/Î© â‰ˆ 0.75&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Magnetic field $B$ (normalized)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Growth rate $</span><span class="se">\\</span><span class="s1">gamma / </span><span class="se">\\</span><span class="s1">Omega$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MRI Growth Rate vs. Magnetic Field Strength&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Wavelength of fastest growing mode</span>
    <span class="n">lambda_MRI</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">v_A</span> <span class="o">/</span> <span class="p">(</span><span class="n">Omega</span> <span class="o">*</span> <span class="n">gamma_over_Omega</span><span class="p">)</span>
    <span class="n">lambda_MRI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gamma_over_Omega</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lambda_MRI</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">lambda_MRI</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Magnetic field $B$ (normalized)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;MRI wavelength $</span><span class="se">\\</span><span class="s1">lambda_</span><span class="si">{MRI}</span><span class="s1"> / H$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Fastest Growing MRI Wavelength&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mri_growth_vs_field.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">mri_growth_vs_field</span><span class="p">()</span>
</code></pre></div>

<h3 id="73-shearing-box-local-analysis">7.3 Shearing Box Local Analysis<a class="header-link" href="#73-shearing-box-local-analysis" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">shearing_box_trajectories</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize fluid element trajectories in a shearing box.</span>

<span class="sd">    Shear flow: v_y = -q Î© x  (Keplerian: q = 3/2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Omega</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Keplerian</span>

    <span class="c1"># Initial positions</span>
    <span class="n">N_particles</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N_particles</span><span class="p">)</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N_particles</span><span class="p">)</span>

    <span class="c1"># Time evolution</span>
    <span class="n">t_max</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

    <span class="c1"># Trajectories</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_particles</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>

        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Shear flow</span>
            <span class="n">v_y</span> <span class="o">=</span> <span class="o">-</span><span class="n">q</span> <span class="o">*</span> <span class="n">Omega</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

            <span class="c1"># Update (Euler)</span>
            <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">v_y</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radial $x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Azimuthal $y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Fluid Element Trajectories in Shearing Box (Keplerian)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Start&#39;</span><span class="p">,</span> <span class="s1">&#39;End&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;shearing_box_trajectories.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">shearing_box_trajectories</span><span class="p">()</span>
</code></pre></div>

<h3 id="74-blandford-payne-wind-solution-simplified">7.4 Blandford-Payne Wind Solution (Simplified)<a class="header-link" href="#74-blandford-payne-wind-solution-simplified" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">blandford_payne_wind</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplified model of Blandford-Payne centrifugal wind.</span>

<span class="sd">    Assume:</span>
<span class="sd">      - Field line shape: z = r tan(Î¸)</span>
<span class="sd">      - Angular momentum conservation: r v_Ï† = râ‚€Â² Î©â‚€</span>
<span class="sd">      - Centrifugal vs. gravitational balance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="n">GM</span> <span class="o">=</span> <span class="mf">1.0</span>       <span class="c1"># Gravitational parameter (normalized)</span>
    <span class="n">r_0</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># Launch radius</span>
    <span class="n">Omega_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">GM</span> <span class="o">/</span> <span class="n">r_0</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Keplerian angular velocity at r_0</span>

    <span class="c1"># Field line inclination</span>
    <span class="n">theta_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>  <span class="c1"># degrees</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">)</span>

    <span class="c1"># Cylindrical radius along field line</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">r_0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">r_0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">th</span><span class="p">,</span> <span class="n">th_d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta_deg</span><span class="p">):</span>
        <span class="c1"># Height z = (R - r_0) tan(Î¸)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span> <span class="o">-</span> <span class="n">r_0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>

        <span class="c1"># Spherical radius</span>
        <span class="n">r_sph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Angular momentum (conserved)</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">r_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Omega_0</span>

        <span class="c1"># Azimuthal velocity</span>
        <span class="n">v_phi</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">R</span>

        <span class="c1"># Centrifugal force (per unit mass)</span>
        <span class="n">F_cent</span> <span class="o">=</span> <span class="n">v_phi</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">R</span>

        <span class="c1"># Gravitational force (radial component)</span>
        <span class="n">F_grav</span> <span class="o">=</span> <span class="n">GM</span> <span class="o">/</span> <span class="n">r_sph</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Effective potential</span>
        <span class="n">Phi_eff</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM</span> <span class="o">/</span> <span class="n">r_sph</span> <span class="o">+</span> <span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Plot field lines</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Î¸ = </span><span class="si">{</span><span class="n">th_d</span><span class="si">}</span><span class="s1">Â°&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Plot effective potential</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_sph</span><span class="p">,</span> <span class="n">Phi_eff</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Î¸ = </span><span class="si">{</span><span class="n">th_d</span><span class="si">}</span><span class="s1">Â°&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Cylindrical radius $R$ (in $r_0$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Height $z$ (in $r_0$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Blandford-Payne Field Line Geometry&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Spherical radius $r$ (in $r_0$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Effective potential $</span><span class="se">\\</span><span class="s1">Phi_</span><span class="si">{eff}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Effective Potential for Wind Acceleration&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;blandford_payne_wind.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Critical angle for centrifugal launch: Î¸ &gt; 30Â°&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For Î¸ &lt; 30Â°: effective potential has no barrier â†’ wind cannot be centrifugally driven&quot;</span><span class="p">)</span>

<span class="n">blandford_payne_wind</span><span class="p">()</span>
</code></pre></div>

<h3 id="75-mri-turbulence-energy-evolution-toy-model">7.5 MRI Turbulence Energy Evolution (Toy Model)<a class="header-link" href="#75-mri-turbulence-energy-evolution-toy-model" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mri_turbulence_energy</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Toy model for MRI turbulence energy evolution.</span>

<span class="sd">    Equations:</span>
<span class="sd">      dE_K/dt = -Î± Î© E_K + Î² E_M - Îµ_K</span>
<span class="sd">      dE_M/dt = Î³_MRI E_M - Î² E_M - Îµ_M</span>

<span class="sd">    where:</span>
<span class="sd">      E_K: kinetic energy</span>
<span class="sd">      E_M: magnetic energy</span>
<span class="sd">      Î³_MRI: MRI growth rate</span>
<span class="sd">      Î²: energy exchange (Lorentz force)</span>
<span class="sd">      Îµ: dissipation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="n">Omega</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">gamma_MRI</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">Omega</span>  <span class="c1"># MRI growth rate</span>
    <span class="n">alpha_visc</span> <span class="o">=</span> <span class="mf">0.01</span>         <span class="c1"># Effective viscosity parameter</span>
    <span class="n">beta_exchange</span> <span class="o">=</span> <span class="mf">0.1</span>       <span class="c1"># Energy exchange rate</span>
    <span class="n">epsilon_K</span> <span class="o">=</span> <span class="mf">0.05</span>          <span class="c1"># Kinetic dissipation</span>
    <span class="n">epsilon_M</span> <span class="o">=</span> <span class="mf">0.05</span>          <span class="c1"># Magnetic dissipation</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dE_dt</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">E_K</span><span class="p">,</span> <span class="n">E_M</span> <span class="o">=</span> <span class="n">E</span>

        <span class="n">dE_K_dt</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha_visc</span> <span class="o">*</span> <span class="n">Omega</span> <span class="o">*</span> <span class="n">E_K</span> <span class="o">+</span> <span class="n">beta_exchange</span> <span class="o">*</span> <span class="n">E_M</span> <span class="o">-</span> <span class="n">epsilon_K</span> <span class="o">*</span> <span class="n">E_K</span>
        <span class="n">dE_M_dt</span> <span class="o">=</span> <span class="n">gamma_MRI</span> <span class="o">*</span> <span class="n">E_M</span> <span class="o">-</span> <span class="n">beta_exchange</span> <span class="o">*</span> <span class="n">E_M</span> <span class="o">-</span> <span class="n">epsilon_M</span> <span class="o">*</span> <span class="n">E_M</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">dE_K_dt</span><span class="p">,</span> <span class="n">dE_M_dt</span><span class="p">]</span>

    <span class="c1"># Initial conditions</span>
    <span class="n">E0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>  <span class="c1"># Initial kinetic energy, small magnetic seed</span>

    <span class="c1"># Time</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># Solve</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dE_dt</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">E_K</span> <span class="o">=</span> <span class="n">E</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">E_M</span> <span class="o">=</span> <span class="n">E</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_K</span> <span class="o">+</span> <span class="n">E_M</span>

    <span class="c1"># Plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_K</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic $E_K$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_M</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetic $E_M$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_total</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total $E_K + E_M$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (in $</span><span class="se">\\</span><span class="s1">Omega^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MRI Turbulence: Energy Evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Semi-log</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_K</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic $E_K$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_M</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetic $E_M$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (in $</span><span class="se">\\</span><span class="s1">Omega^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (log scale)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MRI Turbulence: Energy Evolution (Log Scale)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mri_turbulence_energy.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Saturation values</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saturation:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Kinetic energy: </span><span class="si">{</span><span class="n">E_K</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Magnetic energy: </span><span class="si">{</span><span class="n">E_M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ratio E_M / E_K: </span><span class="si">{</span><span class="n">E_M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">E_K</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">mri_turbulence_energy</span><span class="p">()</span>
</code></pre></div>

<h2 id="8-summary">8. Summary<a class="header-link" href="#8-summary" title="Permanent link">&para;</a></h2>
<p><strong>Accretion disk MHD</strong> is governed by the interplay of rotation, gravity, and magnetic fields:</p>
<ol>
<li><strong>Angular momentum problem:</strong></li>
<li>Keplerian disks are Rayleigh-stable â†’ no hydrodynamic turbulence</li>
<li>
<p>Material must shed angular momentum to accrete â†’ need magnetic fields</p>
</li>
<li>
<p><strong>Magnetorotational instability (MRI):</strong></p>
</li>
<li><strong>Balbus &amp; Hawley (1991):</strong> weak magnetic field in differentially rotating disk is unstable</li>
<li><strong>Growth rate:</strong> <code>Î³ ~ Î©</code> (very fast!)</li>
<li><strong>Fastest growing wavelength:</strong> <code>Î»_MRI ~ v_A / Î©</code></li>
<li><strong>Instability criterion:</strong> <code>dÎ©Â²/d ln r &lt; 0</code> (Keplerian satisfied)</li>
<li>
<p><strong>Mechanism:</strong> Magnetic tension acts like a spring, enabling angular momentum transport outward</p>
</li>
<li>
<p><strong>Angular momentum transport:</strong></p>
</li>
<li><strong>Maxwell stress:</strong> <code>-B_r B_Ï† / Î¼_0</code> (dominant)</li>
<li><strong>Reynolds stress:</strong> <code>Ï v_r v_Ï†</code> (subdominant)</li>
<li><strong>Î±-parameter:</strong> <code>Î± ~ 0.01-0.1</code> from MRI turbulence</li>
<li>
<p>Explains observed accretion rates in X-ray binaries, AGN</p>
</li>
<li>
<p><strong>Nonlinear saturation:</strong></p>
</li>
<li>MRI grows until <code>BÂ² / (2Î¼_0) ~ p</code></li>
<li>Lorentz force modifies flow â†’ turbulent saturation</li>
<li>
<p>Channel modes, parasitic instabilities, sustained turbulence</p>
</li>
<li>
<p><strong>Dead zones:</strong></p>
</li>
<li>In weakly ionized regions (protoplanetary disks), Ohmic, ambipolar, Hall effects suppress MRI</li>
<li><strong>Layered accretion:</strong> Active near surface, dead at midplane</li>
<li>
<p>Alternative instabilities may operate</p>
</li>
<li>
<p><strong>Disk winds and jets:</strong></p>
</li>
<li><strong>Blandford-Payne:</strong> Centrifugal wind launched along inclined magnetic field lines (Î¸ &gt; 30Â°)</li>
<li><strong>Magnetic tower:</strong> Toroidal field pressure drives and collimates outflow</li>
<li><strong>Applications:</strong> YSO jets, AGN jets, pulsar winds</li>
</ol>
<p>MRI is one of the most important discoveries in astrophysics, providing the long-sought mechanism for accretion disk turbulence and making possible rapid accretion onto compact objects.</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>MRI Growth Rate:</strong> For a disk at radius <code>r = 10Â¹â° cm</code> around a <code>M = 10 Mâ˜‰</code> black hole, compute the orbital frequency <code>Î©</code> and the maximum MRI growth rate <code>Î³_max</code>.</p>
</li>
<li>
<p><strong>MRI Wavelength:</strong> For <code>v_A = 10 km/s</code> and <code>Î© = 10â»Â³ sâ»Â¹</code>, estimate the wavelength of the fastest growing MRI mode.</p>
</li>
<li>
<p><strong>Maxwell Stress:</strong> If <code>âŸ¨B_r B_Ï†âŸ© = 10â»Â² Ã— âŸ¨pâŸ©</code>, what is the effective Î± parameter?</p>
</li>
<li>
<p><strong>Accretion Timescale:</strong> For <code>Î± = 0.01</code>, <code>c_s = 10 km/s</code>, <code>H = 10â¹ cm</code>, <code>R = 10Â¹Â¹ cm</code>, estimate the accretion timescale <code>Ï„_acc ~ RÂ² / Î½_eff</code>.</p>
</li>
<li>
<p><strong>Equipartition Field:</strong> In a disk with <code>Ï = 10â»â¹ g/cmÂ³</code>, <code>c_s = 10â· cm/s</code>, compute the magnetic field strength at <code>Î² = BÂ² / (8Ï€ p) = 1</code>.</p>
</li>
<li>
<p><strong>Dead Zone Criterion:</strong> For a protoplanetary disk at 1 AU with ionization fraction <code>x_e = 10â»Â¹Â³</code>, temperature <code>T = 200 K</code>, density <code>Ï = 10â»â¹ g/cmÂ³</code>, estimate the Ohmic resistivity and magnetic Reynolds number. Is MRI active?</p>
</li>
<li>
<p><strong>Blandford-Payne Angle:</strong> Why is Î¸ = 30Â° the critical angle for centrifugal wind launch? (Hint: consider balance of centrifugal and gravitational forces along the field line.)</p>
</li>
<li>
<p><strong>Jet Power:</strong> For a black hole of mass <code>M = 10â¹ Mâ˜‰</code>, accretion rate <code>á¹€ = 0.1 á¹€_Edd</code>, and jet efficiency <code>Î·_jet = 0.1</code>, estimate the jet power in erg/s.</p>
</li>
<li>
<p><strong>Python Exercise:</strong> Modify the MRI dispersion relation code to include toroidal field <code>B_Ï†</code> in addition to vertical field. How does the growth rate change?</p>
</li>
<li>
<p><strong>Advanced:</strong> Implement a 1D vertically-integrated disk evolution model with MRI-driven Î±-viscosity. Start with a ring of material and watch it spread and accrete over time.</p>
</li>
</ol>
<hr />
<p><strong>Previous:</strong> <a href="./11_Solar_MHD.md">Solar MHD</a> | <strong>Next:</strong> <a href="./13_Fusion_MHD.md">Fusion MHD</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/11_Solar_MHD.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">11. Solar MHD</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/13_Fusion_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">13. Fusion MHD</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}