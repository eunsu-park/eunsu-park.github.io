{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14. Space Weather MHD - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">14. Space Weather MHD</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>14. Space Weather MHD</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/13_Fusion_MHD.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. Fusion MHD</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/15_2D_MHD_Solver.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. 2D MHD Solver</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-introduction-to-space-weather">1. Introduction to Space Weather</a><ul>
<li><a href="#11-solar-terrestrial-physics">1.1 Solar-Terrestrial Physics</a></li>
<li><a href="#12-solar-wind-parameters">1.2 Solar Wind Parameters</a></li>
<li><a href="#13-space-weather-hazards">1.3 Space Weather Hazards</a></li>
</ul>
</li>
<li><a href="#2-earths-magnetosphere">2. Earth's Magnetosphere</a><ul>
<li><a href="#21-dipole-magnetic-field">2.1 Dipole Magnetic Field</a></li>
<li><a href="#22-magnetopause">2.2 Magnetopause</a></li>
<li><a href="#23-magnetopause-standoff-distance">2.3 Magnetopause Standoff Distance</a></li>
<li><a href="#24-chapman-ferraro-current-system">2.4 Chapman-Ferraro Current System</a></li>
<li><a href="#25-bow-shock">2.5 Bow Shock</a></li>
<li><a href="#26-magnetotail">2.6 Magnetotail</a></li>
</ul>
</li>
<li><a href="#3-dungey-cycle-and-magnetic-reconnection">3. Dungey Cycle and Magnetic Reconnection</a><ul>
<li><a href="#31-open-magnetosphere-concept">3.1 Open Magnetosphere Concept</a></li>
<li><a href="#32-magnetic-reconnection-at-magnetopause">3.2 Magnetic Reconnection at Magnetopause</a></li>
<li><a href="#33-magnetospheric-convection">3.3 Magnetospheric Convection</a></li>
<li><a href="#34-substorms">3.4 Substorms</a></li>
</ul>
</li>
<li><a href="#4-magnetic-storms">4. Magnetic Storms</a><ul>
<li><a href="#41-ring-current">4.1 Ring Current</a></li>
<li><a href="#42-dst-index">4.2 Dst Index</a></li>
<li><a href="#43-dst-solar-wind-coupling">4.3 Dst-Solar Wind Coupling</a></li>
<li><a href="#44-storm-impacts">4.4 Storm Impacts</a></li>
</ul>
</li>
<li><a href="#5-coronal-mass-ejections-cmes">5. Coronal Mass Ejections (CMEs)</a><ul>
<li><a href="#51-cme-characteristics">5.1 CME Characteristics</a></li>
<li><a href="#52-interplanetary-cme-icme">5.2 Interplanetary CME (ICME)</a></li>
<li><a href="#53-cme-propagation-models">5.3 CME Propagation Models</a></li>
<li><a href="#54-mhd-simulation-models">5.4 MHD Simulation Models</a></li>
<li><a href="#55-cme-orientation-and-geoeffectiveness">5.5 CME Orientation and Geoeffectiveness</a></li>
</ul>
</li>
<li><a href="#6-geomagnetically-induced-currents-gic">6. Geomagnetically Induced Currents (GIC)</a><ul>
<li><a href="#61-physical-mechanism">6.1 Physical Mechanism</a></li>
<li><a href="#62-ground-conductivity">6.2 Ground Conductivity</a></li>
<li><a href="#63-gic-in-power-grids">6.3 GIC in Power Grids</a></li>
<li><a href="#64-gic-magnitude-estimation">6.4 GIC Magnitude Estimation</a></li>
<li><a href="#65-gic-mitigation">6.5 GIC Mitigation</a></li>
</ul>
</li>
<li><a href="#7-space-weather-forecasting">7. Space Weather Forecasting</a><ul>
<li><a href="#71-observational-assets">7.1 Observational Assets</a></li>
<li><a href="#72-forecasting-workflow">7.2 Forecasting Workflow</a></li>
<li><a href="#73-forecast-skill">7.3 Forecast Skill</a></li>
<li><a href="#74-operational-centers">7.4 Operational Centers</a></li>
</ul>
</li>
<li><a href="#8-python-implementations">8. Python Implementations</a><ul>
<li><a href="#81-magnetopause-standoff-distance">8.1 Magnetopause Standoff Distance</a></li>
<li><a href="#82-bow-shock-properties">8.2 Bow Shock Properties</a></li>
<li><a href="#83-dst-index-model-burton">8.3 Dst Index Model (Burton)</a></li>
<li><a href="#84-cme-transit-time">8.4 CME Transit Time</a></li>
<li><a href="#85-gic-estimation">8.5 GIC Estimation</a></li>
<li><a href="#86-reconnection-electric-field">8.6 Reconnection Electric Field</a></li>
</ul>
</li>
<li><a href="#9-summary">9. Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="14-space-weather-mhd">14. Space Weather MHD<a class="header-link" href="#14-space-weather-mhd" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Understand Earth's magnetosphere structure and solar wind interaction</li>
<li>Analyze magnetopause standoff distance and bow shock formation</li>
<li>Describe the Dungey cycle and magnetic reconnection processes</li>
<li>Model magnetic storms and the Dst index</li>
<li>Study CME propagation, interplanetary shocks, and arrival prediction</li>
<li>Assess geomagnetically induced currents (GIC) and space weather impacts</li>
<li>Implement Python models for magnetospheric physics and space weather forecasting</li>
</ul>
<h2 id="1-introduction-to-space-weather">1. Introduction to Space Weather<a class="header-link" href="#1-introduction-to-space-weather" title="Permanent link">&para;</a></h2>
<p>Space weather refers to the variable conditions on the Sun and in space that can influence the performance and reliability of space-borne and ground-based technological systems, and can endanger human life or health.</p>
<h3 id="11-solar-terrestrial-physics">1.1 Solar-Terrestrial Physics<a class="header-link" href="#11-solar-terrestrial-physics" title="Permanent link">&para;</a></h3>
<p>The Sun-Earth system is a coupled MHD system spanning from the solar corona ($T \sim 10^6$ K, $B \sim 1-100$ G) to Earth's magnetosphere ($B \sim 0.01-1$ G) and ionosphere ($n_e \sim 10^{11}$ m$^{-3}$).</p>
<p><strong>Key components:</strong>
- <strong>Solar wind</strong>: Supersonic, super-Alfv√©nic plasma flow from the Sun
- <strong>Interplanetary magnetic field (IMF)</strong>: Frozen-in magnetic field carried by solar wind
- <strong>Earth's magnetosphere</strong>: Region dominated by Earth's magnetic field
- <strong>Magnetopause</strong>: Boundary between solar wind and magnetosphere
- <strong>Bow shock</strong>: Shock wave where solar wind encounters magnetosphere</p>
<h3 id="12-solar-wind-parameters">1.2 Solar Wind Parameters<a class="header-link" href="#12-solar-wind-parameters" title="Permanent link">&para;</a></h3>
<p>Typical solar wind conditions at 1 AU (Earth's orbit):</p>
<div class="highlight"><pre><span></span><code><span class="n">Speed</span><span class="o">:</span><span class="w">          </span><span class="n">v_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">300</span><span class="o">-</span><span class="mi">800</span><span class="w"> </span><span class="n">km</span><span class="sr">/s (slow/</span><span class="n">fast</span><span class="w"> </span><span class="n">wind</span><span class="o">)</span>
<span class="n">Density</span><span class="o">:</span><span class="w">        </span><span class="n">n_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">5</span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="n">cm</span><span class="o">^-</span><span class="mi">3</span>
<span class="n">Temperature</span><span class="o">:</span><span class="w">    </span><span class="n">T_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="w"> </span><span class="n">K</span>
<span class="n">Magnetic</span><span class="w"> </span><span class="n">field</span><span class="o">:</span><span class="w"> </span><span class="n">B_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">nT</span>
<span class="n">Dynamic</span><span class="w"> </span><span class="n">pressure</span><span class="o">:</span><span class="w"> </span><span class="n">P_dyn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">œÅ</span><span class="w"> </span><span class="n">v¬≤</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="w"> </span><span class="n">nPa</span>
</code></pre></div>

<p>The solar wind is highly variable, especially during solar storms.</p>
<h3 id="13-space-weather-hazards">1.3 Space Weather Hazards<a class="header-link" href="#13-space-weather-hazards" title="Permanent link">&para;</a></h3>
<p><strong>Impacts:</strong>
1. <strong>Satellite operations</strong>: Radiation damage, surface charging, drag from thermospheric heating
2. <strong>Communications</strong>: HF radio blackouts, GPS errors
3. <strong>Power grids</strong>: Geomagnetically induced currents (GIC) can damage transformers
4. <strong>Aviation</strong>: Radiation exposure at high altitudes, communication disruptions
5. <strong>Human health</strong>: Astronaut radiation exposure</p>
<p>Major events:
- <strong>Carrington Event (1859)</strong>: Largest recorded geomagnetic storm
- <strong>Quebec blackout (1989)</strong>: GIC-induced power outage affecting millions
- <strong>Halloween storms (2003)</strong>: Satellite anomalies, power grid disturbances
- <strong>Bastille Day storm (2000)</strong>: Communications disruptions</p>
<h2 id="2-earths-magnetosphere">2. Earth's Magnetosphere<a class="header-link" href="#2-earths-magnetosphere" title="Permanent link">&para;</a></h2>
<h3 id="21-dipole-magnetic-field">2.1 Dipole Magnetic Field<a class="header-link" href="#21-dipole-magnetic-field" title="Permanent link">&para;</a></h3>
<p>Earth's intrinsic magnetic field is approximately a magnetic dipole:</p>
<div class="highlight"><pre><span></span><code>B_r = -2 B_0 (R_E/r)¬≥ cos Œ∏
B_Œ∏ = -B_0 (R_E/r)¬≥ sin Œ∏
</code></pre></div>

<p>where:
- $B_0 \approx 3.12 \times 10^{-5}$ T (equatorial surface field)
- $R_E = 6371$ km (Earth radius)
- $r$ is radial distance, $\theta$ is magnetic colatitude</p>
<p>The dipole moment:</p>
<div class="highlight"><pre><span></span><code>M_E ‚âà 8 √ó 10^{22} A m¬≤
</code></pre></div>

<p>In the absence of solar wind, the dipole field would extend to infinity. However, solar wind pressure compresses the field on the dayside and stretches it on the nightside.</p>
<h3 id="22-magnetopause">2.2 Magnetopause<a class="header-link" href="#22-magnetopause" title="Permanent link">&para;</a></h3>
<p>The <strong>magnetopause</strong> is the boundary where the solar wind dynamic pressure balances the magnetic pressure of Earth's field.</p>
<p><strong>Pressure balance:</strong></p>
<div class="highlight"><pre><span></span><code>P_dyn = B¬≤/(2 Œº‚ÇÄ)
</code></pre></div>

<p>where $B$ is the magnetospheric field at the magnetopause.</p>
<p>For the subsolar point (nose of magnetosphere):</p>
<div class="highlight"><pre><span></span><code>œÅ_sw v_sw¬≤ = B_mp¬≤/(2 Œº‚ÇÄ)
</code></pre></div>

<h3 id="23-magnetopause-standoff-distance">2.3 Magnetopause Standoff Distance<a class="header-link" href="#23-magnetopause-standoff-distance" title="Permanent link">&para;</a></h3>
<p>The standoff distance $r_{mp}$ (distance from Earth center to subsolar magnetopause) is found by balancing pressures.</p>
<p>Using a simple dipole model:</p>
<div class="highlight"><pre><span></span><code>B_mp ‚âà B_0 (R_E/r_mp)¬≥
</code></pre></div>

<p>Pressure balance:</p>
<div class="highlight"><pre><span></span><code>œÅ_sw v_sw¬≤ = B_0¬≤ (R_E/r_mp)‚Å∂ / (2 Œº‚ÇÄ)
</code></pre></div>

<p>Solving for $r_{mp}$:</p>
<div class="highlight"><pre><span></span><code>r_mp = R_E (B_0¬≤ / (2 Œº‚ÇÄ œÅ_sw v_sw¬≤))^(1/6)
</code></pre></div>

<p>For typical solar wind conditions ($\rho_{sw} v_{sw}^2 \sim 2$ nPa):</p>
<div class="highlight"><pre><span></span><code>r_mp ~ 10-12 R_E
</code></pre></div>

<p>During strong solar wind pressure (CME arrival), $r_{mp}$ can compress to $< 8 R_E$.</p>
<h3 id="24-chapman-ferraro-current-system">2.4 Chapman-Ferraro Current System<a class="header-link" href="#24-chapman-ferraro-current-system" title="Permanent link">&para;</a></h3>
<p>The magnetopause is not a discontinuity in $B$ but a thin current sheet (the <strong>Chapman-Ferraro current</strong>) that shields the magnetospheric field from the solar wind.</p>
<p>From $\nabla \times B = \mu_0 j$, the surface current density:</p>
<div class="highlight"><pre><span></span><code>K = (1/Œº‚ÇÄ) ‚à´ j dl ‚âà (B_in - B_out) / Œº‚ÇÄ
</code></pre></div>

<p>where $B_{in}$ is the magnetospheric field and $B_{out}$ is the magnetosheath field (just inside the bow shock).</p>
<p>The current flows around the magnetopause, creating a closed loop that confines Earth's field.</p>
<h3 id="25-bow-shock">2.5 Bow Shock<a class="header-link" href="#25-bow-shock" title="Permanent link">&para;</a></h3>
<p>The solar wind is supersonic ($M_s > 1$) and super-Alfv√©nic ($M_A > 1$), so a <strong>bow shock</strong> forms upstream of the magnetopause, similar to a shock wave ahead of a supersonic aircraft.</p>
<p><strong>Jump conditions</strong> (Rankine-Hugoniot relations) across the shock:</p>
<div class="highlight"><pre><span></span><code>[œÅ v_n] = 0  (mass conservation)
[œÅ v_n¬≤ + p + B_t¬≤/(2Œº‚ÇÄ)] = 0  (momentum)
[v_n (E + p/œÅ) + (v√óB)_n ¬∑ B_t/Œº‚ÇÄ] = 0  (energy)
[v_n B_t - v_t B_n] = 0  (magnetic field)
</code></pre></div>

<p>where $v_n, v_t$ are normal and tangential velocities, $B_n, B_t$ are normal and tangential fields.</p>
<p>For a perpendicular shock ($B \perp v$), the compression ratio:</p>
<div class="highlight"><pre><span></span><code>œÅ‚ÇÇ/œÅ‚ÇÅ = (Œ≥+1) M_s¬≤ / ((Œ≥-1) M_s¬≤ + 2)
</code></pre></div>

<p>For $\gamma = 5/3$ and strong shock ($M_s \gg 1$):</p>
<div class="highlight"><pre><span></span><code>œÅ‚ÇÇ/œÅ‚ÇÅ ‚Üí 4
</code></pre></div>

<p>The <strong>magnetosheath</strong> is the region between the bow shock and magnetopause, containing shocked, compressed, and heated solar wind plasma.</p>
<h3 id="26-magnetotail">2.6 Magnetotail<a class="header-link" href="#26-magnetotail" title="Permanent link">&para;</a></h3>
<p>On the nightside, the solar wind stretches Earth's field into a long <strong>magnetotail</strong> extending hundreds of $R_E$ downstream.</p>
<p>The magnetotail consists of:
- <strong>Tail lobes</strong>: Nearly parallel field lines pointing away from Earth (north lobe) and toward Earth (south lobe)
- <strong>Plasma sheet</strong>: Thin current sheet separating the lobes, containing hot plasma
- <strong>Neutral sheet</strong>: Surface where $B_z = 0$ in the center of the plasma sheet</p>
<p>The tail current (flowing in the $\pm y$ direction) maintains the lobe fields.</p>
<h2 id="3-dungey-cycle-and-magnetic-reconnection">3. Dungey Cycle and Magnetic Reconnection<a class="header-link" href="#3-dungey-cycle-and-magnetic-reconnection" title="Permanent link">&para;</a></h2>
<h3 id="31-open-magnetosphere-concept">3.1 Open Magnetosphere Concept<a class="header-link" href="#31-open-magnetosphere-concept" title="Permanent link">&para;</a></h3>
<p>In the <strong>closed magnetosphere</strong> model, solar wind flows around Earth without penetrating the magnetopause. However, when the IMF has a southward component ($B_z < 0$), <strong>magnetic reconnection</strong> occurs at the dayside magnetopause, allowing solar wind plasma to enter the magnetosphere.</p>
<p><strong>Dungey cycle</strong> (for southward IMF):</p>
<ol>
<li><strong>Dayside reconnection</strong>: IMF and magnetospheric field lines reconnect at the subsolar magnetopause</li>
<li><strong>Convection</strong>: Reconnected field lines are swept over the polar caps by solar wind</li>
<li><strong>Tail storage</strong>: Field lines accumulate in the magnetotail, storing energy</li>
<li><strong>Nightside reconnection</strong>: Tail field lines reconnect in the plasma sheet</li>
<li><strong>Return flow</strong>: Closed field lines convect back toward dayside, returning plasma</li>
</ol>
<h3 id="32-magnetic-reconnection-at-magnetopause">3.2 Magnetic Reconnection at Magnetopause<a class="header-link" href="#32-magnetic-reconnection-at-magnetopause" title="Permanent link">&para;</a></h3>
<p>For reconnection to occur, the magnetic field on opposite sides of the magnetopause must have anti-parallel components.</p>
<p><strong>Reconnection rate:</strong></p>
<p>The reconnection electric field $E_{rec}$ determines the rate at which flux is transferred:</p>
<div class="highlight"><pre><span></span><code>E_rec ~ 0.1 v_sw B_sw sin¬≤(Œ∏/2)
</code></pre></div>

<p>where $\theta$ is the IMF clock angle (angle between IMF and northward direction in $yz$ plane).</p>
<p>Maximum reconnection occurs for southward IMF ($B_z < 0$, $\theta = 180¬∞$).</p>
<p><strong>Flux transfer events (FTEs):</strong></p>
<p>Bursty reconnection creates flux tubes of interconnected field lines that move along the magnetopause. These are observed as sudden pulses in magnetic field magnitude and direction.</p>
<h3 id="33-magnetospheric-convection">3.3 Magnetospheric Convection<a class="header-link" href="#33-magnetospheric-convection" title="Permanent link">&para;</a></h3>
<p>Reconnection drives large-scale plasma circulation in the magnetosphere:</p>
<ul>
<li><strong>Dayside</strong>: Plasma and field lines move poleward</li>
<li><strong>Polar cap</strong>: Antisunward flow over the poles</li>
<li><strong>Nightside</strong>: Sunward return flow in the plasma sheet</li>
<li><strong>Ring current</strong>: Azimuthal drift of energetic particles around Earth</li>
</ul>
<p>The electric field associated with convection:</p>
<div class="highlight"><pre><span></span><code>E_conv = -v √ó B
</code></pre></div>

<p>Typical convection speeds: 100-1000 m/s, giving $E_{conv} \sim 0.01-0.1$ mV/m.</p>
<h3 id="34-substorms">3.4 Substorms<a class="header-link" href="#34-substorms" title="Permanent link">&para;</a></h3>
<p>A <strong>magnetospheric substorm</strong> is a transient energy release in the magnetotail, occurring when the tail becomes over-loaded with magnetic flux.</p>
<p><strong>Substorm phases:</strong></p>
<ol>
<li><strong>Growth phase</strong> (30-60 min): Dayside reconnection stores energy in tail, tail lobes stretch, plasma sheet thins</li>
<li><strong>Expansion phase</strong> (10-30 min): Explosive release, nightside reconnection (near 10-15 $R_E$), auroral brightening, dipolarization (tail field becomes more dipole-like)</li>
<li><strong>Recovery phase</strong> (30-60 min): System relaxes to pre-substorm state</li>
</ol>
<p><strong>Auroral signature:</strong></p>
<p>Substorm onset is marked by sudden brightening and expansion of the aurora, caused by energetic electrons precipitating along field lines into the ionosphere.</p>
<h2 id="4-magnetic-storms">4. Magnetic Storms<a class="header-link" href="#4-magnetic-storms" title="Permanent link">&para;</a></h2>
<p>A <strong>geomagnetic storm</strong> is a major disturbance of Earth's magnetosphere driven by prolonged periods of southward IMF, often associated with CME arrival.</p>
<h3 id="41-ring-current">4.1 Ring Current<a class="header-link" href="#41-ring-current" title="Permanent link">&para;</a></h3>
<p>During a storm, enhanced magnetospheric convection injects large numbers of energetic ions (10-200 keV) into the inner magnetosphere. These particles drift azimuthally around Earth due to gradient and curvature drifts:</p>
<div class="highlight"><pre><span></span><code>v_drift = (m v_‚ä•¬≤ + v_‚à•¬≤) / (q B¬≤) (B √ó ‚àáB) + (m v_‚à•¬≤) / (q B¬≥) B √ó (b ¬∑ ‚àá)b
</code></pre></div>

<p>For ions: drift westward; for electrons: drift eastward.</p>
<p>The net result is a westward <strong>ring current</strong> at 2-7 $R_E$ altitude, which opposes Earth's dipole field.</p>
<h3 id="42-dst-index">4.2 Dst Index<a class="header-link" href="#42-dst-index" title="Permanent link">&para;</a></h3>
<p>The <strong>Dst (Disturbance storm time)</strong> index measures the depression of the horizontal component of the magnetic field at equatorial ground stations, providing a global measure of ring current intensity.</p>
<div class="highlight"><pre><span></span><code>Dst = (sum of H component deviations at 4 equatorial stations) / 4
</code></pre></div>

<p><strong>Typical values:</strong>
- Quiet conditions: $Dst \sim 0$ nT
- Moderate storm: $Dst < -50$ nT
- Intense storm: $Dst < -100$ nT
- Super-storm: $Dst < -250$ nT</p>
<p>The Carrington event (1859) is estimated to have reached $Dst \sim -1600$ nT.</p>
<p><strong>Storm phases:</strong></p>
<ol>
<li><strong>Initial phase</strong> (few hours): Magnetopause compression, slight increase in field ($Dst > 0$)</li>
<li><strong>Main phase</strong> (few hours): Ring current injection, rapid decrease in $Dst$</li>
<li><strong>Recovery phase</strong> (days): Ring current decay via charge exchange and precipitation</li>
</ol>
<h3 id="43-dst-solar-wind-coupling">4.3 Dst-Solar Wind Coupling<a class="header-link" href="#43-dst-solar-wind-coupling" title="Permanent link">&para;</a></h3>
<p>Empirical formula (Burton et al. 1975):</p>
<div class="highlight"><pre><span></span><code>dDst/dt = Q(E_sw) - Dst/œÑ
</code></pre></div>

<p>where:
- $Q(E_{sw})$ is the injection function, depending on solar wind electric field $E_{sw} = v_{sw} B_s$
- $B_s$ is the southward component of IMF ($B_s = -B_z$ if $B_z < 0$, else 0)
- $\tau \sim 8$ hours is the decay timescale</p>
<p><strong>Burton formula:</strong></p>
<div class="highlight"><pre><span></span><code>Q = a (v_sw B_s - b)  if v_sw B_s &gt; b, else 0
</code></pre></div>

<p>where $a \sim 10^{-3}$ nT/(mV/m) and $b \sim 0.5$ mV/m are empirical constants.</p>
<p>This simple model captures the main features: stronger storms for higher $v_{sw}$ and southward $B_z$.</p>
<h3 id="44-storm-impacts">4.4 Storm Impacts<a class="header-link" href="#44-storm-impacts" title="Permanent link">&para;</a></h3>
<p><strong>Radiation belt enhancement:</strong></p>
<p>Storms energize electrons in the outer radiation belt (L=4-7), creating hazards for satellites.</p>
<p><strong>Ionospheric disturbances:</strong></p>
<p>Enhanced currents and particle precipitation disturb the ionosphere, affecting radio communications and GPS accuracy.</p>
<p><strong>Auroral expansion:</strong></p>
<p>The aurora can extend to mid-latitudes (40-50¬∞ latitude) during major storms.</p>
<h2 id="5-coronal-mass-ejections-cmes">5. Coronal Mass Ejections (CMEs)<a class="header-link" href="#5-coronal-mass-ejections-cmes" title="Permanent link">&para;</a></h2>
<h3 id="51-cme-characteristics">5.1 CME Characteristics<a class="header-link" href="#51-cme-characteristics" title="Permanent link">&para;</a></h3>
<p>A <strong>coronal mass ejection (CME)</strong> is an eruption of plasma and magnetic field from the solar corona, releasing $10^{12}-10^{13}$ kg of material at speeds of 200-3000 km/s.</p>
<p><strong>Triggering mechanisms:</strong>
- Magnetic flux rope eruption
- Shearing and twisting of coronal magnetic field
- Loss of equilibrium (e.g., torus instability)</p>
<p><strong>CME structure:</strong>
- <strong>Leading edge</strong>: Bright rim in coronagraph images
- <strong>Cavity</strong>: Dark region (low density)
- <strong>Core</strong>: Bright core (prominence material)</p>
<h3 id="52-interplanetary-cme-icme">5.2 Interplanetary CME (ICME)<a class="header-link" href="#52-interplanetary-cme-icme" title="Permanent link">&para;</a></h3>
<p>Once a CME propagates into interplanetary space, it is called an <strong>ICME</strong>. At Earth (1 AU), ICMEs have characteristic signatures:</p>
<p><strong>Magnetic cloud:</strong></p>
<p>A subset of ICMEs with smooth rotation of the magnetic field vector over ~1 day, low plasma beta ($\beta < 1$), and low temperature. This indicates a flux rope structure.</p>
<p><strong>Sheath:</strong></p>
<p>If the CME is fast ($v > v_{sw}$), it drives a shock ahead of it. The region between the shock and the flux rope is the <strong>sheath</strong>, containing compressed and turbulent solar wind.</p>
<h3 id="53-cme-propagation-models">5.3 CME Propagation Models<a class="header-link" href="#53-cme-propagation-models" title="Permanent link">&para;</a></h3>
<p><strong>Drag-based model:</strong></p>
<p>The CME experiences aerodynamic drag in the solar wind:</p>
<div class="highlight"><pre><span></span><code>dv/dt = -Œ≥ (v - v_sw)
</code></pre></div>

<p>where $\gamma$ is the drag coefficient:</p>
<div class="highlight"><pre><span></span><code>Œ≥ ‚âà C_d A / (2 M)
</code></pre></div>

<ul>
<li>$C_d \sim 1$ is the drag coefficient</li>
<li>$A$ is the CME cross-sectional area</li>
<li>$M$ is the CME mass</li>
</ul>
<p><strong>Analytical solution:</strong></p>
<div class="highlight"><pre><span></span><code>v(t) = v_sw + (v_0 - v_sw) exp(-Œ≥ t)
</code></pre></div>

<p>where $v_0$ is the initial CME speed.</p>
<p>The distance traveled:</p>
<div class="highlight"><pre><span></span><code>r(t) = r_0 + v_sw t + (v_0 - v_sw)/Œ≥ (1 - exp(-Œ≥ t))
</code></pre></div>

<p><strong>Transit time to Earth:</strong></p>
<p>Setting $r(t_{arr}) = 1$ AU and solving for $t_{arr}$.</p>
<p>For typical parameters ($v_0 = 1000$ km/s, $v_{sw} = 400$ km/s, $\gamma^{-1} = 1$ day):</p>
<div class="highlight"><pre><span></span><code>t_arr ~ 2-3 days
</code></pre></div>

<p>Faster CMEs arrive in 1-2 days; slower CMEs in 3-5 days.</p>
<h3 id="54-mhd-simulation-models">5.4 MHD Simulation Models<a class="header-link" href="#54-mhd-simulation-models" title="Permanent link">&para;</a></h3>
<p>Advanced space weather forecasting uses 3D MHD codes to simulate CME propagation:</p>
<p><strong>ENLIL</strong> (NOAA):
- 3D MHD model from Sun to 2 AU
- Uses solar wind data from SOHO, ACE
- Provides arrival time, speed, density forecasts</p>
<p><strong>SUSANOO</strong> (Japan):
- Global MHD simulation with adaptive mesh refinement
- Models CME-solar wind interaction</p>
<p><strong>Other models:</strong>
- WSA-ENLIL (coupled coronal-heliospheric model)
- EUHFORIA (European heliospheric model)</p>
<p>These models typically predict arrival times with ~6-12 hour accuracy.</p>
<h3 id="55-cme-orientation-and-geoeffectiveness">5.5 CME Orientation and Geoeffectiveness<a class="header-link" href="#55-cme-orientation-and-geoeffectiveness" title="Permanent link">&para;</a></h3>
<p>The <strong>geoeffectiveness</strong> of a CME depends critically on the orientation of its magnetic field.</p>
<p><strong>Southward field ($B_z < 0$):</strong>
- Strong dayside reconnection
- Efficient energy transfer to magnetosphere
- Strong storms (large negative $Dst$)</p>
<p><strong>Northward field ($B_z > 0$):</strong>
- Weak or no dayside reconnection
- Minimal geomagnetic activity</p>
<p>Since the CME field orientation can only be measured when it arrives at L1 (1.5 million km from Earth, ~1 hour warning), forecasting storm intensity is challenging.</p>
<h2 id="6-geomagnetically-induced-currents-gic">6. Geomagnetically Induced Currents (GIC)<a class="header-link" href="#6-geomagnetically-induced-currents-gic" title="Permanent link">&para;</a></h2>
<h3 id="61-physical-mechanism">6.1 Physical Mechanism<a class="header-link" href="#61-physical-mechanism" title="Permanent link">&para;</a></h3>
<p>Rapid variations in the magnetospheric magnetic field (during storms or substorms) induce electric fields in the conductive Earth via Faraday's law:</p>
<div class="highlight"><pre><span></span><code>‚àá √ó E = -‚àÇB/‚àÇt
</code></pre></div>

<p>For a spatially uniform time-varying field $B(t)$ at ground level:</p>
<div class="highlight"><pre><span></span><code>E ~ -L ‚àÇB/‚àÇt
</code></pre></div>

<p>where $L$ is a characteristic length scale.</p>
<p>These electric fields drive currents in conductors: power lines, pipelines, railway tracks, etc.</p>
<h3 id="62-ground-conductivity">6.2 Ground Conductivity<a class="header-link" href="#62-ground-conductivity" title="Permanent link">&para;</a></h3>
<p>The induced electric field depends on ground conductivity structure:</p>
<div class="highlight"><pre><span></span><code>E(œâ) = Z(œâ) ¬∑ H(œâ)
</code></pre></div>

<p>where $Z(\omega)$ is the <strong>surface impedance</strong> (depends on ground conductivity profile) and $H$ is the horizontal magnetic field perturbation.</p>
<p>Regions with high resistivity (e.g., Precambrian shield rocks in Canada, Scandinavia) are more susceptible to large GIC.</p>
<h3 id="63-gic-in-power-grids">6.3 GIC in Power Grids<a class="header-link" href="#63-gic-in-power-grids" title="Permanent link">&para;</a></h3>
<p>GIC flows into transformers as quasi-DC current, causing:</p>
<ol>
<li><strong>Half-cycle saturation</strong>: DC current biases the transformer core, leading to asymmetric magnetization</li>
<li><strong>Increased reactive power demand</strong></li>
<li><strong>Heating</strong>: Excessive heating can damage transformers</li>
<li><strong>Harmonics</strong>: Distortion of AC waveform</li>
<li><strong>Voltage instability</strong>: Can trigger cascading failures</li>
</ol>
<p><strong>Quebec blackout (March 13, 1989):</strong></p>
<p>A major geomagnetic storm induced GIC in Hydro-Qu√©bec's grid. Within 90 seconds, the entire grid collapsed, leaving 6 million people without power for up to 9 hours.</p>
<h3 id="64-gic-magnitude-estimation">6.4 GIC Magnitude Estimation<a class="header-link" href="#64-gic-magnitude-estimation" title="Permanent link">&para;</a></h3>
<p>Empirical scaling:</p>
<div class="highlight"><pre><span></span><code>GIC ~ (dB/dt) / R_earth
</code></pre></div>

<p>where $R_{earth}$ is the Earth's effective resistance (depends on ground conductivity).</p>
<p>For a storm with $dB/dt \sim 1000$ nT/min and resistivity $\rho \sim 1000$ Œ©¬∑m:</p>
<div class="highlight"><pre><span></span><code>E ~ 1-10 V/km
</code></pre></div>

<p>Over a 100 km transmission line:</p>
<div class="highlight"><pre><span></span><code>V ~ 100-1000 V
</code></pre></div>

<p>With line resistance $R \sim 0.1$ Œ©:</p>
<div class="highlight"><pre><span></span><code>GIC ~ 100-1000 A
</code></pre></div>

<p>This is quasi-DC superimposed on the AC grid.</p>
<h3 id="65-gic-mitigation">6.5 GIC Mitigation<a class="header-link" href="#65-gic-mitigation" title="Permanent link">&para;</a></h3>
<p><strong>Strategies:</strong>
1. <strong>Operational procedures</strong>: Reduce loading during storms
2. <strong>Neutral blocking devices</strong>: Insert capacitors to block DC while passing AC
3. <strong>Network reconfiguration</strong>: Open vulnerable connections
4. <strong>Improved forecasting</strong>: Advance warning allows operators to prepare</p>
<p>Recent focus: Understanding 100-year and 500-year GIC events for grid resilience planning.</p>
<h2 id="7-space-weather-forecasting">7. Space Weather Forecasting<a class="header-link" href="#7-space-weather-forecasting" title="Permanent link">&para;</a></h2>
<h3 id="71-observational-assets">7.1 Observational Assets<a class="header-link" href="#71-observational-assets" title="Permanent link">&para;</a></h3>
<p><strong>Solar observations:</strong>
- <strong>SOHO, SDO</strong>: Solar imaging (EUV, coronagraph)
- <strong>STEREO</strong>: 3D CME structure</p>
<p><strong>Solar wind monitors:</strong>
- <strong>ACE, DSCOVR</strong>: At L1 (1.5 million km sunward), provides ~30-60 min warning
- Measures $v, n, B$ of solar wind before it reaches Earth</p>
<p><strong>Magnetospheric monitoring:</strong>
- <strong>Ground magnetometers</strong>: Global network (SuperMAG)
- <strong>Satellites</strong>: GOES, THEMIS, MMS</p>
<h3 id="72-forecasting-workflow">7.2 Forecasting Workflow<a class="header-link" href="#72-forecasting-workflow" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Solar monitoring</strong>: Detect flares, CMEs</li>
<li><strong>CME propagation model</strong>: Estimate arrival time using MHD or empirical models</li>
<li><strong>L1 data assimilation</strong>: Refine prediction when ICME reaches L1</li>
<li><strong>Geomagnetic indices</strong>: Predict Kp, Dst based on solar wind coupling functions</li>
<li><strong>Impact assessment</strong>: Estimate GIC, radiation belt, ionospheric effects</li>
</ol>
<h3 id="73-forecast-skill">7.3 Forecast Skill<a class="header-link" href="#73-forecast-skill" title="Permanent link">&para;</a></h3>
<p><strong>Arrival time</strong>: Typically ¬±6-12 hours for CMEs
<strong>Intensity (Dst)</strong>: Correlation ~0.7-0.8 (limited by unknown CME $B_z$ orientation)
<strong>Probabilistic forecasts</strong>: Ensemble methods improve reliability</p>
<h3 id="74-operational-centers">7.4 Operational Centers<a class="header-link" href="#74-operational-centers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>NOAA Space Weather Prediction Center (SWPC)</strong>: U.S. operational forecasts</li>
<li><strong>ESA Space Situational Awareness (SSA)</strong>: European forecasts</li>
<li><strong>UKMO Space Weather Operations Centre (MOSWOC)</strong>: UK forecasts</li>
<li><strong>ISES (International Space Environment Service)</strong>: Global coordination</li>
</ul>
<h2 id="8-python-implementations">8. Python Implementations<a class="header-link" href="#8-python-implementations" title="Permanent link">&para;</a></h2>
<h3 id="81-magnetopause-standoff-distance">8.1 Magnetopause Standoff Distance<a class="header-link" href="#81-magnetopause-standoff-distance" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">magnetopause_standoff</span><span class="p">(</span><span class="n">v_sw</span><span class="p">,</span> <span class="n">n_sw</span><span class="p">,</span> <span class="n">B_0</span><span class="o">=</span><span class="mf">3.12e-5</span><span class="p">,</span> <span class="n">R_E</span><span class="o">=</span><span class="mf">6371e3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate magnetopause standoff distance.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    n_sw : solar wind density (m^-3)</span>
<span class="sd">    B_0 : Earth&#39;s equatorial surface field (T)</span>
<span class="sd">    R_E : Earth radius (m)</span>

<span class="sd">    Returns:</span>
<span class="sd">    r_mp : magnetopause standoff distance (R_E)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-7</span>
    <span class="n">m_p</span> <span class="o">=</span> <span class="mf">1.673e-27</span>  <span class="c1"># proton mass (kg)</span>

    <span class="c1"># Dynamic pressure</span>
    <span class="n">rho_sw</span> <span class="o">=</span> <span class="n">n_sw</span> <span class="o">*</span> <span class="n">m_p</span>
    <span class="n">P_dyn</span> <span class="o">=</span> <span class="n">rho_sw</span> <span class="o">*</span> <span class="n">v_sw</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Standoff distance</span>
    <span class="n">r_mp</span> <span class="o">=</span> <span class="n">R_E</span> <span class="o">*</span> <span class="p">(</span><span class="n">B_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu_0</span> <span class="o">*</span> <span class="n">P_dyn</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r_mp</span> <span class="o">/</span> <span class="n">R_E</span>  <span class="c1"># Return in Earth radii</span>

<span class="c1"># Typical solar wind conditions</span>
<span class="n">v_typical</span> <span class="o">=</span> <span class="mf">400e3</span>  <span class="c1"># m/s</span>
<span class="n">n_typical</span> <span class="o">=</span> <span class="mf">5e6</span>    <span class="c1"># m^-3</span>

<span class="n">r_mp_typical</span> <span class="o">=</span> <span class="n">magnetopause_standoff</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="n">n_typical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Typical solar wind: v = </span><span class="si">{</span><span class="n">v_typical</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s, n = </span><span class="si">{</span><span class="n">n_typical</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> cm^-3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Magnetopause standoff: r_mp = </span><span class="si">{</span><span class="n">r_mp_typical</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> R_E&quot;</span><span class="p">)</span>

<span class="c1"># CME impact (enhanced pressure)</span>
<span class="n">v_cme</span> <span class="o">=</span> <span class="mf">800e3</span>  <span class="c1"># m/s</span>
<span class="n">n_cme</span> <span class="o">=</span> <span class="mf">20e6</span>   <span class="c1"># m^-3</span>

<span class="n">r_mp_cme</span> <span class="o">=</span> <span class="n">magnetopause_standoff</span><span class="p">(</span><span class="n">v_cme</span><span class="p">,</span> <span class="n">n_cme</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CME arrival: v = </span><span class="si">{</span><span class="n">v_cme</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s, n = </span><span class="si">{</span><span class="n">n_cme</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> cm^-3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Magnetopause standoff: r_mp = </span><span class="si">{</span><span class="n">r_mp_cme</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> R_E (compressed!)&quot;</span><span class="p">)</span>

<span class="c1"># Parametric study: vary solar wind speed</span>
<span class="n">v_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">300e3</span><span class="p">,</span> <span class="mf">1000e3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">r_mp_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">magnetopause_standoff</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n_typical</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_scan</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">r_mp_scan</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">r_mp_typical</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Typical conditions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Geosynchronous orbit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Solar Wind Speed (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnetopause Standoff Distance (R$_E$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnetopause Position vs Solar Wind Speed&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;magnetopause_standoff.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="82-bow-shock-properties">8.2 Bow Shock Properties<a class="header-link" href="#82-bow-shock-properties" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bow_shock_jump</span><span class="p">(</span><span class="n">M_s</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate density compression ratio across bow shock.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    M_s : sonic Mach number</span>
<span class="sd">    gamma : adiabatic index</span>

<span class="sd">    Returns:</span>
<span class="sd">    r : compression ratio (œÅ‚ÇÇ/œÅ‚ÇÅ)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M_s</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M_s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sonic_mach_number</span><span class="p">(</span><span class="n">v_sw</span><span class="p">,</span> <span class="n">T_sw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate sonic Mach number of solar wind.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    T_sw : solar wind temperature (K)</span>

<span class="sd">    Returns:</span>
<span class="sd">    M_s : sonic Mach number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.381e-23</span>  <span class="c1"># J/K</span>
    <span class="n">m_p</span> <span class="o">=</span> <span class="mf">1.673e-27</span>  <span class="c1"># kg</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>

    <span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_sw</span> <span class="o">/</span> <span class="n">m_p</span><span class="p">)</span>
    <span class="n">M_s</span> <span class="o">=</span> <span class="n">v_sw</span> <span class="o">/</span> <span class="n">c_s</span>

    <span class="k">return</span> <span class="n">M_s</span>

<span class="c1"># Typical solar wind</span>
<span class="n">T_sw</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># K</span>
<span class="n">M_s_typical</span> <span class="o">=</span> <span class="n">sonic_mach_number</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="n">T_sw</span><span class="p">)</span>
<span class="n">r_typical</span> <span class="o">=</span> <span class="n">bow_shock_jump</span><span class="p">(</span><span class="n">M_s_typical</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bow shock (typical solar wind):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sonic Mach number: M_s = </span><span class="si">{</span><span class="n">M_s_typical</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Density compression: œÅ‚ÇÇ/œÅ‚ÇÅ = </span><span class="si">{</span><span class="n">r_typical</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Fast solar wind (CME)</span>
<span class="n">M_s_cme</span> <span class="o">=</span> <span class="n">sonic_mach_number</span><span class="p">(</span><span class="n">v_cme</span><span class="p">,</span> <span class="n">T_sw</span><span class="p">)</span>
<span class="n">r_cme</span> <span class="o">=</span> <span class="n">bow_shock_jump</span><span class="p">(</span><span class="n">M_s_cme</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bow shock (CME):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sonic Mach number: M_s = </span><span class="si">{</span><span class="n">M_s_cme</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Density compression: œÅ‚ÇÇ/œÅ‚ÇÅ = </span><span class="si">{</span><span class="n">r_cme</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Mach number scan</span>
<span class="n">M_s_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">r_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">bow_shock_jump</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">M_s_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M_s_scan</span><span class="p">,</span> <span class="n">r_scan</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Strong shock limit (r=4)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sonic Mach Number $M_s$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density Compression Ratio&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bow Shock Density Jump vs Mach Number&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bow_shock_jump.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="83-dst-index-model-burton">8.3 Dst Index Model (Burton)<a class="header-link" href="#83-dst-index-model-burton" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dst_evolution</span><span class="p">(</span><span class="n">Dst_0</span><span class="p">,</span> <span class="n">v_sw_series</span><span class="p">,</span> <span class="n">B_z_series</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="mi">3600</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evolve Dst index using Burton model.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    Dst_0 : initial Dst (nT)</span>
<span class="sd">    v_sw_series : solar wind speed time series (m/s)</span>
<span class="sd">    B_z_series : IMF Bz time series (T)</span>
<span class="sd">    dt : timestep (s)</span>
<span class="sd">    a : injection parameter (nT/(mV/m))</span>
<span class="sd">    b : threshold (mV/m)</span>
<span class="sd">    tau : decay timescale (s)</span>

<span class="sd">    Returns:</span>
<span class="sd">    Dst_series : Dst evolution (nT)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v_sw_series</span><span class="p">)</span>
    <span class="n">Dst_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">Dst</span> <span class="o">=</span> <span class="n">Dst_0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">Dst_series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dst</span>

        <span class="c1"># Solar wind electric field (in mV/m)</span>
        <span class="n">B_s</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">B_z_series</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e9</span>  <span class="c1"># Convert to nT, take southward component</span>
        <span class="n">E_sw</span> <span class="o">=</span> <span class="n">v_sw_series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">B_s</span> <span class="o">/</span> <span class="mf">1e6</span>  <span class="c1"># mV/m</span>

        <span class="c1"># Injection function</span>
        <span class="k">if</span> <span class="n">E_sw</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">E_sw</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Burton equation</span>
        <span class="n">dDst_dt</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">-</span> <span class="n">Dst</span> <span class="o">/</span> <span class="n">tau</span>

        <span class="n">Dst</span> <span class="o">+=</span> <span class="n">dDst_dt</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="k">return</span> <span class="n">Dst_series</span>

<span class="c1"># Simulate a magnetic storm</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>  <span class="c1"># 5 days</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># 10 min</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">t_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="mi">3600</span>  <span class="c1"># hours</span>

<span class="c1"># Solar wind scenario: CME arrival at t=12 hours</span>
<span class="n">v_sw_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">400e3</span>  <span class="c1"># m/s</span>
<span class="n">B_z_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2e-9</span>  <span class="c1"># T (northward)</span>

<span class="c1"># CME arrival: 12-36 hours, enhanced speed and southward field</span>
<span class="n">t_cme_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">t_cme_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">36</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">v_sw_series</span><span class="p">[</span><span class="n">t_cme_start</span><span class="p">:</span><span class="n">t_cme_end</span><span class="p">]</span> <span class="o">=</span> <span class="mf">600e3</span>  <span class="c1"># m/s</span>
<span class="n">B_z_series</span><span class="p">[</span><span class="n">t_cme_start</span><span class="p">:</span><span class="n">t_cme_end</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">15e-9</span>  <span class="c1"># T (strongly southward)</span>

<span class="c1"># Evolve Dst</span>
<span class="n">Dst_0</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># nT (quiet conditions)</span>
<span class="n">Dst_series</span> <span class="o">=</span> <span class="n">dst_evolution</span><span class="p">(</span><span class="n">Dst_0</span><span class="p">,</span> <span class="n">v_sw_series</span><span class="p">,</span> <span class="n">B_z_series</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dst storm simulation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum Dst: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Dst_series</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> nT at t = </span><span class="si">{</span><span class="n">t_series</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">Dst_series</span><span class="p">)]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> hours&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">v_sw_series</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Solar Wind Speed (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnetic Storm Simulation (Burton Dst Model)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">B_z_series</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;IMF $B_z$ (nT)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">Dst_series</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Moderate storm&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Intense storm&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hours)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Dst (nT)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dst_storm_simulation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="84-cme-transit-time">8.4 CME Transit Time<a class="header-link" href="#84-cme-transit-time" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cme_transit_time</span><span class="p">(</span><span class="n">v_0</span><span class="p">,</span> <span class="n">v_sw</span><span class="o">=</span><span class="mf">400e3</span><span class="p">,</span> <span class="n">gamma_inv</span><span class="o">=</span><span class="mi">86400</span><span class="p">,</span> <span class="n">r_target</span><span class="o">=</span><span class="mf">1.496e11</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate CME arrival time using drag model.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_0 : initial CME speed (m/s)</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    gamma_inv : inverse drag coefficient (s)</span>
<span class="sd">    r_target : target distance (m, default 1 AU)</span>

<span class="sd">    Returns:</span>
<span class="sd">    t_arr : arrival time (hours)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Solve r(t) = r_target for t</span>
    <span class="c1"># r(t) = v_sw * t + (v_0 - v_sw) * gamma_inv * (1 - exp(-t/gamma_inv))</span>
    <span class="c1"># Iterative solution</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># 10 min</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">r_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">r_target</span>  <span class="c1"># Start at 0.1 AU (close to Sun)</span>

    <span class="k">while</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">r_target</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v_sw</span> <span class="o">+</span> <span class="p">(</span><span class="n">v_0</span> <span class="o">-</span> <span class="n">v_sw</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="n">gamma_inv</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>

    <span class="k">return</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">3600</span>  <span class="c1"># Convert to hours</span>

<span class="c1"># CME scenarios</span>
<span class="n">v_0_slow</span> <span class="o">=</span> <span class="mf">500e3</span>  <span class="c1"># m/s</span>
<span class="n">v_0_fast</span> <span class="o">=</span> <span class="mf">1200e3</span>  <span class="c1"># m/s</span>

<span class="n">t_arr_slow</span> <span class="o">=</span> <span class="n">cme_transit_time</span><span class="p">(</span><span class="n">v_0_slow</span><span class="p">)</span>
<span class="n">t_arr_fast</span> <span class="o">=</span> <span class="n">cme_transit_time</span><span class="p">(</span><span class="n">v_0_fast</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CME transit time to Earth (1 AU):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slow CME (v‚ÇÄ = </span><span class="si">{</span><span class="n">v_0_slow</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s): </span><span class="si">{</span><span class="n">t_arr_slow</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> hours (</span><span class="si">{</span><span class="n">t_arr_slow</span><span class="o">/</span><span class="mi">24</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> days)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast CME (v‚ÇÄ = </span><span class="si">{</span><span class="n">v_0_fast</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s): </span><span class="si">{</span><span class="n">t_arr_fast</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> hours (</span><span class="si">{</span><span class="n">t_arr_fast</span><span class="o">/</span><span class="mi">24</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> days)&quot;</span><span class="p">)</span>

<span class="c1"># Parametric study</span>
<span class="n">v_0_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">400e3</span><span class="p">,</span> <span class="mf">2000e3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">t_arr_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">cme_transit_time</span><span class="p">(</span><span class="n">v_0</span><span class="p">)</span> <span class="k">for</span> <span class="n">v_0</span> <span class="ow">in</span> <span class="n">v_0_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_0_scan</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_arr_scan</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Initial CME Speed (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Transit Time to 1 AU (days)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CME Arrival Time vs Initial Speed (Drag Model)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cme_transit_time.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="85-gic-estimation">8.5 GIC Estimation<a class="header-link" href="#85-gic-estimation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gic_estimate</span><span class="p">(</span><span class="n">dB_dt</span><span class="p">,</span> <span class="n">rho_earth</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mf">100e3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate geomagnetically induced current.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    dB_dt : magnetic field time derivative (nT/min)</span>
<span class="sd">    rho_earth : Earth resistivity (Œ©¬∑m)</span>
<span class="sd">    L : transmission line length (m)</span>

<span class="sd">    Returns:</span>
<span class="sd">    E : induced electric field (V/km)</span>
<span class="sd">    GIC : induced current (A, assuming 0.1 Œ© line resistance)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-7</span>

    <span class="c1"># Induced electric field (rough estimate)</span>
    <span class="c1"># E ~ (dB/dt) * sqrt(œÅ/(2œÄŒº‚ÇÄf))</span>
    <span class="c1"># For quasi-DC, use simplified scaling</span>
    <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="n">dB_dt</span> <span class="o">*</span> <span class="mf">1e-9</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rho_earth</span> <span class="o">/</span> <span class="n">mu_0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># V/km</span>

    <span class="c1"># Voltage over line</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="mf">1e3</span>  <span class="c1"># V</span>

    <span class="c1"># Current (assuming line resistance R ~ 0.1 Œ©)</span>
    <span class="n">R_line</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Œ©</span>
    <span class="n">GIC</span> <span class="o">=</span> <span class="n">V</span> <span class="o">/</span> <span class="n">R_line</span>  <span class="c1"># A</span>

    <span class="k">return</span> <span class="n">E</span><span class="p">,</span> <span class="n">GIC</span>

<span class="c1"># Quebec blackout scenario</span>
<span class="n">dB_dt_quebec</span> <span class="o">=</span> <span class="mi">480</span>  <span class="c1"># nT/min (observed)</span>

<span class="n">E_quebec</span><span class="p">,</span> <span class="n">GIC_quebec</span> <span class="o">=</span> <span class="n">gic_estimate</span><span class="p">(</span><span class="n">dB_dt_quebec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Quebec blackout (1989-03-13):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dB/dt = </span><span class="si">{</span><span class="n">dB_dt_quebec</span><span class="si">}</span><span class="s2"> nT/min&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Induced electric field: E ~ </span><span class="si">{</span><span class="n">E_quebec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> V/km&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GIC (100 km line): ~ </span><span class="si">{</span><span class="n">GIC_quebec</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> A&quot;</span><span class="p">)</span>

<span class="c1"># Carrington event estimate</span>
<span class="n">dB_dt_carrington</span> <span class="o">=</span> <span class="mi">5000</span>  <span class="c1"># nT/min (estimated)</span>

<span class="n">E_carrington</span><span class="p">,</span> <span class="n">GIC_carrington</span> <span class="o">=</span> <span class="n">gic_estimate</span><span class="p">(</span><span class="n">dB_dt_carrington</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Carrington event (1859, estimated):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dB/dt = </span><span class="si">{</span><span class="n">dB_dt_carrington</span><span class="si">}</span><span class="s2"> nT/min&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Induced electric field: E ~ </span><span class="si">{</span><span class="n">E_carrington</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> V/km&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GIC (100 km line): ~ </span><span class="si">{</span><span class="n">GIC_carrington</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> A&quot;</span><span class="p">)</span>

<span class="c1"># Parametric study</span>
<span class="n">dB_dt_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">GIC_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">gic_estimate</span><span class="p">(</span><span class="n">dB_dt</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">dB_dt</span> <span class="ow">in</span> <span class="n">dB_dt_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dB_dt_scan</span><span class="p">,</span> <span class="n">GIC_scan</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Concern level (~100 A)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dB_dt_quebec</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Quebec 1989&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dB/dt (nT/min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;GIC (A)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Geomagnetically Induced Current vs dB/dt&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gic_estimate.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="86-reconnection-electric-field">8.6 Reconnection Electric Field<a class="header-link" href="#86-reconnection-electric-field" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reconnection_electric_field</span><span class="p">(</span><span class="n">v_sw</span><span class="p">,</span> <span class="n">B_sw</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate reconnection electric field at magnetopause.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    B_sw : IMF magnitude (T)</span>
<span class="sd">    theta : IMF clock angle (degrees, 0=northward, 180=southward)</span>

<span class="sd">    Returns:</span>
<span class="sd">    E_rec : reconnection electric field (mV/m)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">E_rec</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">v_sw</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">B_sw</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_rad</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># mV/m</span>
    <span class="k">return</span> <span class="n">E_rec</span>

<span class="c1"># Northward IMF</span>
<span class="n">E_rec_north</span> <span class="o">=</span> <span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reconnection electric field:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Northward IMF (Œ∏=0¬∞): E_rec = </span><span class="si">{</span><span class="n">E_rec_north</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> mV/m (minimal reconnection)&quot;</span><span class="p">)</span>

<span class="c1"># Southward IMF</span>
<span class="n">E_rec_south</span> <span class="o">=</span> <span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Southward IMF (Œ∏=180¬∞): E_rec = </span><span class="si">{</span><span class="n">E_rec_south</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> mV/m (strong reconnection)&quot;</span><span class="p">)</span>

<span class="c1"># Strong southward IMF (CME)</span>
<span class="n">E_rec_cme</span> <span class="o">=</span> <span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_cme</span><span class="p">,</span> <span class="mf">20e-9</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CME with southward field: E_rec = </span><span class="si">{</span><span class="n">E_rec_cme</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> mV/m (very strong!)&quot;</span><span class="p">)</span>

<span class="c1"># Clock angle scan</span>
<span class="n">theta_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">E_rec_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_scan</span><span class="p">,</span> <span class="n">E_rec_scan</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;IMF Clock Angle (degrees)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection E-field (mV/m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnetopause Reconnection vs IMF Orientation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reconnection_efield.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="9-summary">9. Summary<a class="header-link" href="#9-summary" title="Permanent link">&para;</a></h2>
<p>This lesson covered the MHD physics of space weather:</p>
<ol>
<li><strong>Earth's magnetosphere</strong>: Dipole field compressed by solar wind, forming magnetopause, bow shock, and magnetotail</li>
<li><strong>Magnetopause</strong>: Pressure balance determines standoff distance ($r_{mp} \sim 10 R_E$)</li>
<li><strong>Bow shock</strong>: Shocks solar wind from supersonic to subsonic, compressing density by factor ~4</li>
<li><strong>Dungey cycle</strong>: Magnetic reconnection drives magnetospheric convection and substorms</li>
<li><strong>Magnetic storms</strong>: Ring current formation depresses Dst index, driven by southward IMF</li>
<li><strong>CMEs</strong>: Eruptive release of solar plasma/field, propagate to Earth in 1-5 days</li>
<li><strong>GIC</strong>: Induced currents in power grids from rapid B variations, can cause blackouts</li>
<li><strong>Forecasting</strong>: Combination of solar observations, MHD models, and L1 monitors</li>
</ol>
<p>Space weather MHD bridges scales from the Sun to Earth, requiring global modeling and real-time forecasting to protect critical infrastructure.</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Magnetopause compression</strong>: During a CME, the solar wind speed increases to $v_{sw} = 900$ km/s and density to $n_{sw} = 30$ cm$^{-3}$. Calculate the magnetopause standoff distance. Does it compress inside geosynchronous orbit (6.6 $R_E$)?</p>
</li>
<li>
<p><strong>Bow shock</strong>: For solar wind at $v_{sw} = 600$ km/s, $T_{sw} = 10^5$ K, calculate the sonic Mach number and the density compression ratio across the bow shock.</p>
</li>
<li>
<p><strong>Dst prediction</strong>: Using the Burton model, estimate the minimum Dst for a storm with solar wind electric field $E_{sw} = v_{sw} B_s = 5$ mV/m sustained for 6 hours. Assume initial $Dst_0 = 0$, $a = 10^{-3}$ nT/(mV/m), $b = 0.5$ mV/m, $\tau = 8$ hours. Classify the storm (moderate: $< -50$ nT; intense: $< -100$ nT).</p>
</li>
<li>
<p><strong>CME transit</strong>: A CME is launched at $v_0 = 1500$ km/s. Using the drag model with $v_{sw} = 400$ km/s and $\gamma^{-1} = 1$ day, estimate the arrival time at Earth (1 AU = 1.5 √ó 10$^{11}$ m). Express in hours and days.</p>
</li>
<li>
<p><strong>Reconnection rate</strong>: Calculate the reconnection electric field for (a) northward IMF: $v_{sw} = 400$ km/s, $B_{sw} = 5$ nT, $\theta = 0¬∞$; (b) southward IMF: same parameters, $\theta = 180¬∞$. Compare the reconnection efficiency.</p>
</li>
<li>
<p><strong>GIC hazard</strong>: During a storm, $dB/dt = 1000$ nT/min. Estimate the induced electric field and GIC in a 200 km transmission line (assume $\rho_{earth} = 1000$ Œ©¬∑m, $R_{line} = 0.2$ Œ©). Is this a concern for the power grid?</p>
</li>
<li>
<p><strong>Substorm energy</strong>: A substorm releases $10^{15}$ J of energy over 30 minutes. If this energy is deposited into the ionosphere at 100 km altitude over an area of $10^{12}$ m$^2$, estimate the energy flux (W/m$^2$). Compare to the solar constant (1360 W/m$^2$).</p>
</li>
<li>
<p><strong>Ring current</strong>: The Dst index depression is proportional to the ring current energy: $Dst \sim -E_{ring} / (4 \times 10^{14} \text{ J/nT})$. For $Dst = -150$ nT, estimate the ring current energy. Express in joules.</p>
</li>
<li>
<p><strong>CME magnetic cloud</strong>: A magnetic cloud has $B \sim 30$ nT, $n \sim 10$ cm$^{-3}$, $T \sim 10^4$ K. Calculate the plasma beta $\beta = 2 \mu_0 p / B^2$. Is this consistent with a flux rope structure ($\beta < 1$)?</p>
</li>
<li>
<p><strong>Space weather forecasting</strong>: Explain why the CME arrival time can be predicted ~12 hours in advance, but the storm intensity (Dst minimum) is uncertain until the CME reaches L1. What is the critical missing information?</p>
</li>
</ol>
<hr />
<p><strong>Previous</strong>: <a href="./13_Fusion_MHD.md">Fusion MHD</a> | <strong>Next</strong>: <a href="./15_2D_MHD_Solver.md">2D MHD Solver</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MHD/13_Fusion_MHD.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. Fusion MHD</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MHD/15_2D_MHD_Solver.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. 2D MHD Solver</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}