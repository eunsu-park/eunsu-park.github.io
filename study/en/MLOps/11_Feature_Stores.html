{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11. Feature Stores - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/MLOps/">MLOps</a>
    <span class="separator">/</span>
    <span class="current">11. Feature Stores</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>11. Feature Stores</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MLOps/10_Drift_Detection_Monitoring.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. Drift Detection & Monitoring</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MLOps/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MLOps/12_Practical_MLOps_Project.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. Practical MLOps Project</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#1-feature-store-concept">1. Feature Store Concept</a><ul>
<li><a href="#11-feature-store-role">1.1 Feature Store Role</a></li>
<li><a href="#12-feature-store-benefits">1.2 Feature Store Benefits</a></li>
</ul>
</li>
<li><a href="#2-feast-overview">2. Feast Overview</a><ul>
<li><a href="#21-installation">2.1 Installation</a></li>
<li><a href="#22-project-structure">2.2 Project Structure</a></li>
<li><a href="#23-basic-configuration">2.3 Basic Configuration</a></li>
</ul>
</li>
<li><a href="#3-feature-definition">3. Feature Definition</a><ul>
<li><a href="#31-entity-and-feature-view">3.1 Entity and Feature View</a></li>
<li><a href="#32-complex-feature-definitions">3.2 Complex Feature Definitions</a></li>
</ul>
</li>
<li><a href="#4-onlineoffline-stores">4. Online/Offline Stores</a><ul>
<li><a href="#41-apply-feast-registry">4.1 Apply Feast Registry</a></li>
<li><a href="#42-offline-store-training">4.2 Offline Store (Training)</a></li>
<li><a href="#43-online-store-inference">4.3 Online Store (Inference)</a></li>
<li><a href="#44-feature-server">4.4 Feature Server</a></li>
</ul>
</li>
<li><a href="#5-feature-serving-integration">5. Feature Serving Integration</a><ul>
<li><a href="#51-inference-pipeline-integration">5.1 Inference Pipeline Integration</a></li>
<li><a href="#52-fastapi-integration">5.2 FastAPI Integration</a></li>
</ul>
</li>
<li><a href="#6-feature-engineering-pipeline">6. Feature Engineering Pipeline</a><ul>
<li><a href="#61-batch-feature-pipeline">6.1 Batch Feature Pipeline</a></li>
<li><a href="#62-streaming-feature-update">6.2 Streaming Feature Update</a></li>
</ul>
</li>
<li><a href="#practice-exercises">Practice Exercises</a><ul>
<li><a href="#exercise-1-feature-store-setup">Exercise 1: Feature Store Setup</a></li>
<li><a href="#exercise-2-training-data-generation">Exercise 2: Training Data Generation</a></li>
<li><a href="#exercise-3-online-serving">Exercise 3: Online Serving</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="11-feature-stores">11. Feature Stores<a class="header-link" href="#11-feature-stores" title="Permanent link">&para;</a></h1>
<h2 id="1-feature-store-concept">1. Feature Store Concept<a class="header-link" href="#1-feature-store-concept" title="Permanent link">&para;</a></h2>
<p>A Feature Store is a platform that centrally manages, stores, and serves ML features.</p>
<h3 id="11-feature-store-role">1.1 Feature Store Role<a class="header-link" href="#11-feature-store-role" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Feature Store Architecture                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚                Feature Engineering                       â”‚      â”‚
â”‚   â”‚                                                          â”‚      â”‚
â”‚   â”‚   Raw Data â†’ Transform â†’ Features â†’ Feature Store        â”‚      â”‚
â”‚   â”‚                                                          â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                          â”‚                                          â”‚
â”‚                          â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚                  Feature Store                           â”‚      â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚      â”‚
â”‚   â”‚  â”‚  Offline Store   â”‚  â”‚   Online Store   â”‚             â”‚      â”‚
â”‚   â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚      â”‚
â”‚   â”‚  â”‚ - Training       â”‚  â”‚ - Inference      â”‚             â”‚      â”‚
â”‚   â”‚  â”‚ - Batch          â”‚  â”‚ - Low latency    â”‚             â”‚      â”‚
â”‚   â”‚  â”‚ - Large scale    â”‚  â”‚ - Key-value      â”‚             â”‚      â”‚
â”‚   â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚      â”‚
â”‚   â”‚  â”‚ (S3, BigQuery,   â”‚  â”‚ (Redis, DynamoDB)â”‚             â”‚      â”‚
â”‚   â”‚  â”‚  Parquet)        â”‚  â”‚                  â”‚             â”‚      â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚      â”‚
â”‚   â”‚                                                          â”‚      â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚      â”‚
â”‚   â”‚  â”‚           Feature Registry               â”‚           â”‚      â”‚
â”‚   â”‚  â”‚  - Feature metadata                      â”‚           â”‚      â”‚
â”‚   â”‚  â”‚  - Version management                    â”‚           â”‚      â”‚
â”‚   â”‚  â”‚  - Schema definition                     â”‚           â”‚      â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                          â”‚                                          â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚            â–¼                           â–¼                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚    Training     â”‚        â”‚    Inference    â”‚                   â”‚
â”‚   â”‚  (Offline)      â”‚        â”‚   (Online)      â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12-feature-store-benefits">1.2 Feature Store Benefits<a class="header-link" href="#12-feature-store-benefits" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Feature Store adoption benefits</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">benefits</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reusability&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Reuse features defined once across multiple models&quot;</span><span class="p">,</span>
        <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;Use user_total_purchases in churn, recommendation, and fraud models&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;consistency&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensure identical feature computation in training and inference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevent training/serving skew&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;point_in_time_accuracy&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Retrieve exact feature values at specific points in time&quot;</span><span class="p">,</span>
        <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;Use only information available at prediction time (prevent data leakage)&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;feature_discovery&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Search existing features in central registry&quot;</span><span class="p">,</span>
        <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;Share and discover features across teams&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;governance&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature versioning, access control, lineage tracking&quot;</span><span class="p">,</span>
        <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;Regulatory compliance, audit response&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="2-feast-overview">2. Feast Overview<a class="header-link" href="#2-feast-overview" title="Permanent link">&para;</a></h2>
<p>Feast (Feature Store) is the most widely used open-source Feature Store.</p>
<h3 id="21-installation">2.1 Installation<a class="header-link" href="#21-installation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Install Feast</span>
pip<span class="w"> </span>install<span class="w"> </span>feast

<span class="c1"># Add support for specific stores</span>
pip<span class="w"> </span>install<span class="w"> </span>feast<span class="o">[</span>redis<span class="o">]</span><span class="w">    </span><span class="c1"># Redis online store</span>
pip<span class="w"> </span>install<span class="w"> </span>feast<span class="o">[</span>gcp<span class="o">]</span><span class="w">      </span><span class="c1"># GCP support</span>
pip<span class="w"> </span>install<span class="w"> </span>feast<span class="o">[</span>aws<span class="o">]</span><span class="w">      </span><span class="c1"># AWS support</span>
</code></pre></div>

<h3 id="22-project-structure">2.2 Project Structure<a class="header-link" href="#22-project-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>feature_repo/
â”œâ”€â”€ feature_store.yaml      # Project configuration
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ user_features.py    # User feature definitions
â”‚   â””â”€â”€ product_features.py # Product feature definitions
â”œâ”€â”€ data/
â”‚   â””â”€â”€ user_data.parquet   # Offline data
â””â”€â”€ tests/
    â””â”€â”€ test_features.py
</code></pre></div>

<h3 id="23-basic-configuration">2.3 Basic Configuration<a class="header-link" href="#23-basic-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># feature_store.yaml</span>
<span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">churn_prediction</span>
<span class="nt">registry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/registry.db</span>
<span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>

<span class="nt">online_store</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">  </span><span class="nt">connection_string</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;localhost:6379&quot;</span>

<span class="nt">offline_store</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file</span>

<span class="nt">entity_key_serialization_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</code></pre></div>

<hr />
<h2 id="3-feature-definition">3. Feature Definition<a class="header-link" href="#3-feature-definition" title="Permanent link">&para;</a></h2>
<h3 id="31-entity-and-feature-view">3.1 Entity and Feature View<a class="header-link" href="#31-entity-and-feature-view" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">features/user_features.py - User feature definitions</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Entity</span><span class="p">,</span> <span class="n">Feature</span><span class="p">,</span> <span class="n">FeatureView</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">FileSource</span><span class="p">,</span> <span class="n">ValueType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feast.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Float32</span><span class="p">,</span> <span class="n">Int64</span><span class="p">,</span> <span class="n">String</span>

<span class="c1"># Define Entity (feature key)</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">Entity</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Customer ID&quot;</span><span class="p">,</span>
    <span class="n">value_type</span><span class="o">=</span><span class="n">ValueType</span><span class="o">.</span><span class="n">INT64</span>
<span class="p">)</span>

<span class="c1"># Define data source</span>
<span class="n">user_source</span> <span class="o">=</span> <span class="n">FileSource</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;data/user_features.parquet&quot;</span><span class="p">,</span>
    <span class="n">timestamp_field</span><span class="o">=</span><span class="s2">&quot;event_timestamp&quot;</span><span class="p">,</span>
    <span class="n">created_timestamp_column</span><span class="o">=</span><span class="s2">&quot;created_timestamp&quot;</span>
<span class="p">)</span>

<span class="c1"># Define Feature View</span>
<span class="n">user_features</span> <span class="o">=</span> <span class="n">FeatureView</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;user_features&quot;</span><span class="p">,</span>
    <span class="n">entities</span><span class="o">=</span><span class="p">[</span><span class="n">user</span><span class="p">],</span>
    <span class="n">ttl</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># Time to Live</span>
    <span class="n">schema</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;total_purchases&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Int64</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;avg_purchase_amount&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float32</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;days_since_last_purchase&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Int64</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;customer_segment&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">String</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tenure_months&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Int64</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">online</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>   <span class="c1"># Enable online store</span>
    <span class="n">source</span><span class="o">=</span><span class="n">user_source</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;team&quot;</span><span class="p">:</span> <span class="s2">&quot;ml-platform&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;data-science&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Derived features (On-Demand Feature)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">on_demand_feature_view</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="nd">@on_demand_feature_view</span><span class="p">(</span>
    <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="n">user_features</span><span class="p">],</span>
    <span class="n">schema</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;purchase_frequency&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float32</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;is_high_value&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Int64</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">user_derived_features</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Real-time computed features&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;purchase_frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;total_purchases&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;tenure_months&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;is_high_value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;avg_purchase_amount&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>

<h3 id="32-complex-feature-definitions">3.2 Complex Feature Definitions<a class="header-link" href="#32-complex-feature-definitions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">features/transaction_features.py - Transaction features</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Entity</span><span class="p">,</span> <span class="n">FeatureView</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">FileSource</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feast.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Float32</span><span class="p">,</span> <span class="n">Int64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feast.aggregation</span><span class="w"> </span><span class="kn">import</span> <span class="n">Aggregation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>

<span class="c1"># Transaction source</span>
<span class="n">transaction_source</span> <span class="o">=</span> <span class="n">FileSource</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;data/transactions.parquet&quot;</span><span class="p">,</span>
    <span class="n">timestamp_field</span><span class="o">=</span><span class="s2">&quot;transaction_timestamp&quot;</span>
<span class="p">)</span>

<span class="c1"># Transaction feature view</span>
<span class="n">transaction_features</span> <span class="o">=</span> <span class="n">FeatureView</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;transaction_features&quot;</span><span class="p">,</span>
    <span class="n">entities</span><span class="o">=</span><span class="p">[</span><span class="n">user</span><span class="p">],</span>
    <span class="n">ttl</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span>
    <span class="n">schema</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;transaction_amount&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float32</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;transaction_count_7d&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Int64</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;avg_transaction_7d&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float32</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">source</span><span class="o">=</span><span class="n">transaction_source</span><span class="p">,</span>
    <span class="n">online</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Time window aggregation (StreamFeatureView - Feast 0.26+)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">StreamFeatureView</span><span class="p">,</span> <span class="n">PushSource</span>

<span class="n">push_source</span> <span class="o">=</span> <span class="n">PushSource</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;transaction_push_source&quot;</span><span class="p">,</span>
    <span class="n">batch_source</span><span class="o">=</span><span class="n">transaction_source</span>
<span class="p">)</span>

<span class="n">streaming_features</span> <span class="o">=</span> <span class="n">StreamFeatureView</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;transaction_streaming_features&quot;</span><span class="p">,</span>
    <span class="n">entities</span><span class="o">=</span><span class="p">[</span><span class="n">user</span><span class="p">],</span>
    <span class="n">ttl</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">schema</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;transaction_count_1h&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Int64</span><span class="p">),</span>
        <span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;total_amount_1h&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float32</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">source</span><span class="o">=</span><span class="n">push_source</span><span class="p">,</span>
    <span class="n">aggregations</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Aggregation</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="s2">&quot;transaction_amount&quot;</span><span class="p">,</span>
            <span class="n">function</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span>
            <span class="n">time_window</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">Aggregation</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="s2">&quot;transaction_amount&quot;</span><span class="p">,</span>
            <span class="n">function</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span>
            <span class="n">time_window</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="4-onlineoffline-stores">4. Online/Offline Stores<a class="header-link" href="#4-onlineoffline-stores" title="Permanent link">&para;</a></h2>
<h3 id="41-apply-feast-registry">4.1 Apply Feast Registry<a class="header-link" href="#41-apply-feast-registry" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Apply feature definitions to registry</span>
feast<span class="w"> </span>apply

<span class="c1"># List registered features</span>
feast<span class="w"> </span>feature-views<span class="w"> </span>list
feast<span class="w"> </span>entities<span class="w"> </span>list
</code></pre></div>

<h3 id="42-offline-store-training">4.2 Offline Store (Training)<a class="header-link" href="#42-offline-store-training" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Offline feature retrieval - Generate training data</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureStore</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Initialize Feature Store</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">FeatureStore</span><span class="p">(</span><span class="n">repo_path</span><span class="o">=</span><span class="s2">&quot;./feature_repo&quot;</span><span class="p">)</span>

<span class="c1"># Entity data (samples to train on)</span>
<span class="n">entity_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1001</span><span class="p">,</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">1003</span><span class="p">,</span> <span class="mi">1004</span><span class="p">,</span> <span class="mi">1005</span><span class="p">],</span>
    <span class="s2">&quot;event_timestamp&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span>
        <span class="s2">&quot;2024-01-15 10:00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2024-01-15 11:00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2024-01-15 12:00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2024-01-15 13:00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2024-01-15 14:00:00&quot;</span>
    <span class="p">])</span>
<span class="p">})</span>

<span class="c1"># Retrieve historical features (Point-in-time accurate)</span>
<span class="n">training_df</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_historical_features</span><span class="p">(</span>
    <span class="n">entity_df</span><span class="o">=</span><span class="n">entity_df</span><span class="p">,</span>
    <span class="n">features</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;user_features:total_purchases&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_features:avg_purchase_amount&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_features:days_since_last_purchase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_features:tenure_months&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_derived_features:purchase_frequency&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transaction_features:transaction_count_7d&quot;</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">training_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training data shape: </span><span class="si">{</span><span class="n">training_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Use result for training</span>
<span class="c1"># X = training_df.drop([&quot;user_id&quot;, &quot;event_timestamp&quot;], axis=1)</span>
<span class="c1"># y = training_df[&quot;label&quot;]  # Join label separately</span>
</code></pre></div>

<h3 id="43-online-store-inference">4.3 Online Store (Inference)<a class="header-link" href="#43-online-store-inference" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Online feature retrieval - Real-time inference</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureStore</span>

<span class="n">store</span> <span class="o">=</span> <span class="n">FeatureStore</span><span class="p">(</span><span class="n">repo_path</span><span class="o">=</span><span class="s2">&quot;./feature_repo&quot;</span><span class="p">)</span>

<span class="c1"># Load features to online store (materialization)</span>
<span class="c1"># Sync offline â†’ online</span>
<span class="n">store</span><span class="o">.</span><span class="n">materialize_incremental</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>

<span class="c1"># Or full re-sync for entire period</span>
<span class="c1"># store.materialize(</span>
<span class="c1">#     start_date=datetime(2024, 1, 1),</span>
<span class="c1">#     end_date=datetime.now()</span>
<span class="c1"># )</span>

<span class="c1"># Online feature retrieval (low latency)</span>
<span class="n">feature_vector</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_online_features</span><span class="p">(</span>
    <span class="n">features</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;user_features:total_purchases&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_features:avg_purchase_amount&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_features:days_since_last_purchase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_derived_features:purchase_frequency&quot;</span>
    <span class="p">],</span>
    <span class="n">entity_rows</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1001</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1002</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">feature_vector</span><span class="p">)</span>
<span class="c1"># {</span>
<span class="c1">#     &quot;user_id&quot;: [1001, 1002],</span>
<span class="c1">#     &quot;total_purchases&quot;: [45, 23],</span>
<span class="c1">#     &quot;avg_purchase_amount&quot;: [67.5, 89.2],</span>
<span class="c1">#     ...</span>
<span class="c1"># }</span>
</code></pre></div>

<h3 id="44-feature-server">4.4 Feature Server<a class="header-link" href="#44-feature-server" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Start Feature Server (REST API)</span>
feast<span class="w"> </span>serve<span class="w"> </span>-p<span class="w"> </span><span class="m">6566</span>

<span class="c1"># API call</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;http://localhost:6566/get-online-features&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">    &quot;features&quot;: [</span>
<span class="s1">      &quot;user_features:total_purchases&quot;,</span>
<span class="s1">      &quot;user_features:avg_purchase_amount&quot;</span>
<span class="s1">    ],</span>
<span class="s1">    &quot;entities&quot;: {</span>
<span class="s1">      &quot;user_id&quot;: [1001, 1002]</span>
<span class="s1">    }</span>
<span class="s1">  }&#39;</span>
</code></pre></div>

<hr />
<h2 id="5-feature-serving-integration">5. Feature Serving Integration<a class="header-link" href="#5-feature-serving-integration" title="Permanent link">&para;</a></h2>
<h3 id="51-inference-pipeline-integration">5.1 Inference Pipeline Integration<a class="header-link" href="#51-inference-pipeline-integration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Integrate Feature Store with model inference</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureStore</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ModelWithFeatureStore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model server with Feature Store integration&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">feature_repo_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="n">FeatureStore</span><span class="p">(</span><span class="n">repo_path</span><span class="o">=</span><span class="n">feature_repo_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;user_features:total_purchases&quot;</span><span class="p">,</span>
            <span class="s2">&quot;user_features:avg_purchase_amount&quot;</span><span class="p">,</span>
            <span class="s2">&quot;user_features:days_since_last_purchase&quot;</span><span class="p">,</span>
            <span class="s2">&quot;user_features:tenure_months&quot;</span><span class="p">,</span>
            <span class="s2">&quot;user_derived_features:purchase_frequency&quot;</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve features and predict&quot;&quot;&quot;</span>
        <span class="c1"># 1. Get features from Feature Store</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">get_online_features</span><span class="p">(</span>
            <span class="n">features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_list</span><span class="p">,</span>
            <span class="n">entity_rows</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">}]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="c1"># 2. Create feature vector</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_list</span><span class="p">]</span>
        <span class="n">feature_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="n">features</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">]</span>
        <span class="p">])</span>

        <span class="c1"># 3. Predict</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">feature_vector</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">feature_vector</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">prediction</span><span class="p">),</span>
            <span class="s2">&quot;probability&quot;</span><span class="p">:</span> <span class="n">probability</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;features_used&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">feature_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
        <span class="p">}</span>

<span class="c1"># Usage</span>
<span class="n">model_server</span> <span class="o">=</span> <span class="n">ModelWithFeatureStore</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;models/churn_model.pkl&quot;</span><span class="p">,</span>
    <span class="n">feature_repo_path</span><span class="o">=</span><span class="s2">&quot;./feature_repo&quot;</span>
<span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">model_server</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>

<h3 id="52-fastapi-integration">5.2 FastAPI Integration<a class="header-link" href="#52-fastapi-integration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">FastAPI + Feature Store</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">fastapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureStore</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">FeatureStore</span><span class="p">(</span><span class="n">repo_path</span><span class="o">=</span><span class="s2">&quot;./feature_repo&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;models/churn_model.pkl&quot;</span><span class="p">)</span>

<span class="n">FEATURES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;user_features:total_purchases&quot;</span><span class="p">,</span>
    <span class="s2">&quot;user_features:avg_purchase_amount&quot;</span><span class="p">,</span>
    <span class="s2">&quot;user_features:tenure_months&quot;</span>
<span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionRequest</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">prediction</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">probability</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">features</span><span class="p">:</span> <span class="nb">dict</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/predict&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">PredictionResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">PredictionRequest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve features and predict&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Retrieve from Feature Store</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_online_features</span><span class="p">(</span>
            <span class="n">features</span><span class="o">=</span><span class="n">FEATURES</span><span class="p">,</span>
            <span class="n">entity_rows</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user_id</span><span class="p">}]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="c1"># Create feature vector</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">FEATURES</span><span class="p">]</span>
        <span class="n">feature_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="n">features</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">]</span>
        <span class="p">])</span>

        <span class="c1"># Predict</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">feature_vector</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">feature_vector</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">PredictionResponse</span><span class="p">(</span>
            <span class="n">user_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">prediction</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">pred</span><span class="p">),</span>
            <span class="n">probability</span><span class="o">=</span><span class="n">prob</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">features</span><span class="o">=</span><span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">features</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/health&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">health</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span><span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="6-feature-engineering-pipeline">6. Feature Engineering Pipeline<a class="header-link" href="#6-feature-engineering-pipeline" title="Permanent link">&para;</a></h2>
<h3 id="61-batch-feature-pipeline">6.1 Batch Feature Pipeline<a class="header-link" href="#61-batch-feature-pipeline" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Batch feature computation pipeline</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FeatureEngineeringPipeline</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Feature engineering pipeline&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data_path</span> <span class="o">=</span> <span class="n">raw_data_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">output_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_raw_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load raw data&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data_path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_user_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute user features&quot;&quot;&quot;</span>
        <span class="n">user_features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
            <span class="s2">&quot;transaction_amount&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">],</span>
            <span class="s2">&quot;transaction_date&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">]</span>
        <span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="n">user_features</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;total_purchases&quot;</span><span class="p">,</span> <span class="s2">&quot;total_amount&quot;</span><span class="p">,</span>
            <span class="s2">&quot;avg_purchase_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;first_purchase_date&quot;</span><span class="p">,</span> <span class="s2">&quot;last_purchase_date&quot;</span>
        <span class="p">]</span>

        <span class="c1"># Compute additional features</span>
        <span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">user_features</span><span class="p">[</span><span class="s2">&quot;days_since_last_purchase&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">today</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">user_features</span><span class="p">[</span><span class="s2">&quot;last_purchase_date&quot;</span><span class="p">])</span>
        <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span>

        <span class="n">user_features</span><span class="p">[</span><span class="s2">&quot;tenure_months&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">user_features</span><span class="p">[</span><span class="s2">&quot;last_purchase_date&quot;</span><span class="p">])</span> <span class="o">-</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">user_features</span><span class="p">[</span><span class="s2">&quot;first_purchase_date&quot;</span><span class="p">])</span>
        <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span> <span class="o">//</span> <span class="mi">30</span>

        <span class="c1"># Add timestamps</span>
        <span class="n">user_features</span><span class="p">[</span><span class="s2">&quot;event_timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">today</span>
        <span class="n">user_features</span><span class="p">[</span><span class="s2">&quot;created_timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">today</span>

        <span class="k">return</span> <span class="n">user_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate features&quot;&quot;&quot;</span>
        <span class="c1"># Null check</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Null values detected&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Range check</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;avg_purchase_amount&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Negative values in avg_purchase_amount&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save features&quot;&quot;&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;pyarrow&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Features saved to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run pipeline&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading raw data...&quot;</span><span class="p">)</span>
        <span class="n">raw_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_raw_data</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing features...&quot;</span><span class="p">)</span>
        <span class="n">features_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_user_features</span><span class="p">(</span><span class="n">raw_df</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Validating features...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_features</span><span class="p">(</span><span class="n">features_df</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Feature validation failed&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving features...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_features</span><span class="p">(</span><span class="n">features_df</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">features_df</span>

<span class="c1"># Execute</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">FeatureEngineeringPipeline</span><span class="p">(</span>
    <span class="n">raw_data_path</span><span class="o">=</span><span class="s2">&quot;data/raw_transactions.parquet&quot;</span><span class="p">,</span>
    <span class="n">output_path</span><span class="o">=</span><span class="s2">&quot;feature_repo/data/user_features.parquet&quot;</span>
<span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Sync Feast features</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">FeatureStore</span><span class="p">(</span><span class="n">repo_path</span><span class="o">=</span><span class="s2">&quot;./feature_repo&quot;</span><span class="p">)</span>
<span class="n">store</span><span class="o">.</span><span class="n">materialize_incremental</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</code></pre></div>

<h3 id="62-streaming-feature-update">6.2 Streaming Feature Update<a class="header-link" href="#62-streaming-feature-update" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Streaming feature update (Feast Push)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">feast</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureStore</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">store</span> <span class="o">=</span> <span class="n">FeatureStore</span><span class="p">(</span><span class="n">repo_path</span><span class="o">=</span><span class="s2">&quot;./feature_repo&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_streaming_event</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process real-time events and update features&quot;&quot;&quot;</span>
    <span class="c1"># Extract features from event</span>
    <span class="n">feature_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span>
        <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">],</span>
        <span class="s2">&quot;transaction_amount&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">],</span>
        <span class="s2">&quot;transaction_timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="p">}])</span>

    <span class="c1"># Push to Feature Store</span>
    <span class="n">store</span><span class="o">.</span><span class="n">push</span><span class="p">(</span>
        <span class="n">push_source_name</span><span class="o">=</span><span class="s2">&quot;transaction_push_source&quot;</span><span class="p">,</span>
        <span class="n">df</span><span class="o">=</span><span class="n">feature_df</span>
    <span class="p">)</span>

<span class="c1"># Kafka Consumer example</span>
<span class="c1"># for message in kafka_consumer:</span>
<span class="c1">#     event = json.loads(message.value)</span>
<span class="c1">#     process_streaming_event(event)</span>
</code></pre></div>

<hr />
<h2 id="practice-exercises">Practice Exercises<a class="header-link" href="#practice-exercises" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-feature-store-setup">Exercise 1: Feature Store Setup<a class="header-link" href="#exercise-1-feature-store-setup" title="Permanent link">&para;</a></h3>
<p>Set up Feast Feature Store and define basic features.</p>
<h3 id="exercise-2-training-data-generation">Exercise 2: Training Data Generation<a class="header-link" href="#exercise-2-training-data-generation" title="Permanent link">&para;</a></h3>
<p>Use get_historical_features to generate point-in-time accurate training data.</p>
<h3 id="exercise-3-online-serving">Exercise 3: Online Serving<a class="header-link" href="#exercise-3-online-serving" title="Permanent link">&para;</a></h3>
<p>Configure online store and integrate with real-time inference.</p>
<hr />
<h2 id="summary">Summary<a class="header-link" href="#summary" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>Offline Store</td>
<td>Large-scale historical data</td>
<td>Training data generation</td>
</tr>
<tr>
<td>Online Store</td>
<td>Low-latency key-value retrieval</td>
<td>Real-time inference</td>
</tr>
<tr>
<td>Feature Registry</td>
<td>Feature metadata management</td>
<td>Feature discovery, governance</td>
</tr>
<tr>
<td>Materialization</td>
<td>Offline â†’ Online sync</td>
<td>Prepare features for serving</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.feast.dev/">Feast Documentation</a></li>
<li><a href="https://www.featurestore.org/">Feature Store for ML</a></li>
<li><a href="https://www.tecton.ai/">Tecton Feature Platform</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/MLOps/10_Drift_Detection_Monitoring.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. Drift Detection & Monitoring</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/MLOps/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/MLOps/12_Practical_MLOps_Project.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. Practical MLOps Project</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}