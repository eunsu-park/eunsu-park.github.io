{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>01. Infinite Series and Convergence - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Mathematical_Methods/">Mathematical Methods</a>
    <span class="separator">/</span>
    <span class="current">01. Infinite Series and Convergence</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>01. Infinite Series and Convergence</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Mathematical Methods in the Physical Sciences - Overview</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/02_Complex_Numbers.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">02. Complex Numbers</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-basic-concepts-of-series">1. Basic Concepts of Series</a><ul>
<li><a href="#11-sequences-and-series">1.1 Sequences and Series</a></li>
<li><a href="#12-partial-sums-and-convergence">1.2 Partial Sums and Convergence</a></li>
</ul>
</li>
<li><a href="#2-convergence-tests">2. Convergence Tests</a><ul>
<li><a href="#21-comparison-test">2.1 Comparison Test</a></li>
<li><a href="#22-ratio-test">2.2 Ratio Test</a></li>
<li><a href="#23-root-test">2.3 Root Test</a></li>
<li><a href="#24-integral-test">2.4 Integral Test</a></li>
<li><a href="#25-alternating-series-test">2.5 Alternating Series Test</a></li>
</ul>
</li>
<li><a href="#3-power-series">3. Power Series</a><ul>
<li><a href="#31-radius-of-convergence">3.1 Radius of Convergence</a></li>
<li><a href="#32-term-by-term-differentiation-and-integration">3.2 Term-by-Term Differentiation and Integration</a></li>
</ul>
</li>
<li><a href="#4-taylor-series-and-maclaurin-series">4. Taylor Series and Maclaurin Series</a><ul>
<li><a href="#41-taylor-expansion">4.1 Taylor Expansion</a></li>
<li><a href="#42-series-representations-of-common-functions">4.2 Series Representations of Common Functions</a></li>
<li><a href="#43-approximation-using-series">4.3 Approximation Using Series</a></li>
</ul>
</li>
<li><a href="#5-asymptotic-series">5. Asymptotic Series</a><ul>
<li><a href="#51-divergent-but-useful-series">5.1 Divergent but Useful Series</a></li>
<li><a href="#52-stirlings-approximation">5.2 Stirling's Approximation</a></li>
</ul>
</li>
<li><a href="#6-applications-in-physics">6. Applications in Physics</a><ul>
<li><a href="#61-period-of-a-pendulum-series-expansion">6.1 Period of a Pendulum (Series Expansion)</a></li>
<li><a href="#62-non-relativistic-approximation-of-relativistic-energy">6.2 Non-relativistic Approximation of Relativistic Energy</a></li>
<li><a href="#63-electric-multipole-expansion">6.3 Electric Multipole Expansion</a></li>
</ul>
</li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-convergence-test-basic">Problem 1. Convergence Test (Basic)</a></li>
<li><a href="#problem-2-radius-of-convergence-basic">Problem 2. Radius of Convergence (Basic)</a></li>
<li><a href="#problem-3-taylor-series-approximation-intermediate">Problem 3. Taylor Series Approximation (Intermediate)</a></li>
<li><a href="#problem-4-physics-application-intermediate">Problem 4. Physics Application (Intermediate)</a></li>
<li><a href="#problem-5-stirlings-approximation-intermediate">Problem 5. Stirling's Approximation (Intermediate)</a></li>
<li><a href="#problem-6-comprehensive-application-advanced">Problem 6. Comprehensive Application (Advanced)</a></li>
</ul>
</li>
<li><a href="#references">References</a><ul>
<li><a href="#textbooks">Textbooks</a></li>
<li><a href="#online-resources">Online Resources</a></li>
<li><a href="#python-tools">Python Tools</a></li>
</ul>
</li>
<li><a href="#next-lesson">Next Lesson</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="01-infinite-series-and-convergence">01. Infinite Series and Convergence<a class="header-link" href="#01-infinite-series-and-convergence" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Define <strong>convergence and divergence of series</strong> and determine convergence using partial sums</li>
<li>Apply major convergence tests: <strong>comparison test, ratio test, root test, integral test, alternating series test</strong></li>
<li>Find the radius of convergence for <strong>power series</strong> and perform term-by-term differentiation/integration</li>
<li>Approximate functions using <strong>Taylor series and Maclaurin series</strong> and apply them to physics problems</li>
<li>Understand the concepts of <strong>asymptotic series</strong> and <strong>Stirling's approximation</strong> and utilize them in physical applications</li>
</ul>
<hr />
<h2 id="1-basic-concepts-of-series">1. Basic Concepts of Series<a class="header-link" href="#1-basic-concepts-of-series" title="Permanent link">&para;</a></h2>
<h3 id="11-sequences-and-series">1.1 Sequences and Series<a class="header-link" href="#11-sequences-and-series" title="Permanent link">&para;</a></h3>
<p>A <strong>sequence</strong> is a function from natural numbers to real (or complex) numbers:</p>
<p>$$a_1, a_2, a_3, \ldots, a_n, \ldots$$</p>
<p>A sequence $\{a_n\}$ converges to a specific value $L$ if:</p>
<p>$$\lim_{n \to \infty} a_n = L$$</p>
<p>This means that for sufficiently large $n$, $a_n$ becomes arbitrarily close to $L$.</p>
<p>A <strong>series</strong> is the sum of the terms of a sequence:</p>
<p>$$S = \sum_{n=1}^{\infty} a_n = a_1 + a_2 + a_3 + \cdots$$</p>
<p><strong>Necessary condition</strong> for series convergence: $\lim_{n \to \infty} a_n = 0$</p>
<blockquote>
<p><strong>Note</strong>: This is only a necessary condition, not sufficient. The harmonic series $\sum \frac{1}{n}$ has $a_n \to 0$ but diverges.</p>
</blockquote>
<h3 id="12-partial-sums-and-convergence">1.2 Partial Sums and Convergence<a class="header-link" href="#12-partial-sums-and-convergence" title="Permanent link">&para;</a></h3>
<p>A <strong>partial sum</strong> $S_N$ is the sum of the first $N$ terms of the series:</p>
<p>$$S_N = \sum_{n=1}^{N} a_n = a_1 + a_2 + \cdots + a_N$$</p>
<p><strong>Convergence</strong> of a series: If the sequence of partial sums $\{S_N\}$ converges to a finite value $S$, we say the series $\sum a_n$ converges to $S$.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ì˜ˆì œ: ê¸°í•˜ê¸‰ìˆ˜ (geometric series)ì˜ ë¶€ë¶„í•©</span>
<span class="c1"># sum_{n=0}^{inf} r^n = 1/(1-r)  (|r| &lt; 1)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">geometric_partial_sums</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">N_max</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê¸°í•˜ê¸‰ìˆ˜ì˜ ë¶€ë¶„í•©ì„ ê³„ì‚°í•©ë‹ˆë‹¤.&quot;&quot;&quot;</span>
    <span class="n">n_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="n">r</span> <span class="o">**</span> <span class="n">n_values</span>
    <span class="n">partial_sums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n_values</span><span class="p">,</span> <span class="n">partial_sums</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ìˆ˜ë ´í•˜ëŠ” ê²½ìš°: |r| &lt; 1</span>
<span class="n">r_conv</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">n_vals</span><span class="p">,</span> <span class="n">S_n</span> <span class="o">=</span> <span class="n">geometric_partial_sums</span><span class="p">(</span><span class="n">r_conv</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">exact</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r_conv</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">S_n</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;S_N (r=</span><span class="si">{</span><span class="n">r_conv</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">exact</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;S = </span><span class="si">{</span><span class="n">exact</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;S_N&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ìˆ˜ë ´í•˜ëŠ” ê¸°í•˜ê¸‰ìˆ˜ (r = </span><span class="si">{</span><span class="n">r_conv</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ì¡°í™”ê¸‰ìˆ˜ vs p-ê¸‰ìˆ˜ ë¹„êµ</span>
<span class="n">N_max</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">harmonic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>           <span class="c1"># p = 1 (ë°œì‚°)</span>
<span class="n">p2_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1"># p = 2 (ìˆ˜ë ´)</span>
<span class="n">p3_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>       <span class="c1"># p = 3 (ìˆ˜ë ´)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">harmonic</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;p=1 (ì¡°í™”ê¸‰ìˆ˜, ë°œì‚°)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p2_series</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;p=2 (ìˆ˜ë ´, pi^2/6 = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p3_series</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;p=3 (ìˆ˜ë ´)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;S_N&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;p-ê¸‰ìˆ˜ ë¹„êµ: sum(1/n^p)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;series_convergence.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><strong>Key series results</strong>:</p>
<table>
<thead>
<tr>
<th>Series</th>
<th>Convergence condition</th>
<th>Sum (when convergent)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Geometric series $\sum r^n$</td>
<td>$|r| < 1$</td>
<td>$\frac{1}{1-r}$</td>
</tr>
<tr>
<td>p-series $\sum \frac{1}{n^p}$</td>
<td>$p > 1$</td>
<td>$\zeta(p)$</td>
</tr>
<tr>
<td>Harmonic series $\sum \frac{1}{n}$</td>
<td>Diverges</td>
<td>-</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-convergence-tests">2. Convergence Tests<a class="header-link" href="#2-convergence-tests" title="Permanent link">&para;</a></h2>
<h3 id="21-comparison-test">2.1 Comparison Test<a class="header-link" href="#21-comparison-test" title="Permanent link">&para;</a></h3>
<p>If $0 \leq a_n \leq b_n$ (for sufficiently large $n$), then:</p>
<ul>
<li>$\sum b_n$ converges $\Rightarrow$ $\sum a_n$ converges</li>
<li>$\sum a_n$ diverges $\Rightarrow$ $\sum b_n$ diverges</li>
</ul>
<p><strong>Limit Comparison Test</strong>: If $a_n > 0$, $b_n > 0$ and</p>
<p>$$\lim_{n \to \infty} \frac{a_n}{b_n} = L \quad (0 < L < \infty)$$</p>
<p>then $\sum a_n$ and $\sum b_n$ either both converge or both diverge.</p>
<h3 id="22-ratio-test">2.2 Ratio Test<a class="header-link" href="#22-ratio-test" title="Permanent link">&para;</a></h3>
<p>$$\rho = \lim_{n \to \infty} \left|\frac{a_{n+1}}{a_n}\right|$$</p>
<ul>
<li>$\rho < 1$ implies <strong>absolutely convergent</strong></li>
<li>$\rho > 1$ implies <strong>divergent</strong></li>
<li>$\rho = 1$ implies <strong>inconclusive</strong> (use another test)</li>
</ul>
<blockquote>
<p><strong>Physics Tip</strong>: The ratio test is particularly useful for series containing factorials or exponential functions.</p>
</blockquote>
<h3 id="23-root-test">2.3 Root Test<a class="header-link" href="#23-root-test" title="Permanent link">&para;</a></h3>
<p>$$\rho = \lim_{n \to \infty} |a_n|^{1/n}$$</p>
<ul>
<li>$\rho < 1$ implies absolutely convergent</li>
<li>$\rho > 1$ implies divergent</li>
<li>$\rho = 1$ implies inconclusive</li>
</ul>
<h3 id="24-integral-test">2.4 Integral Test<a class="header-link" href="#24-integral-test" title="Permanent link">&para;</a></h3>
<p>If $f(x)$ is positive, continuous, and decreasing on $[1, \infty)$ with $f(n) = a_n$, then:</p>
<p>$$\sum_{n=1}^{\infty} a_n \quad \text{and} \quad \int_1^{\infty} f(x) \, dx \quad \text{both converge or both diverge}$$</p>
<p><strong>Example</strong>: Deriving the convergence condition for p-series</p>
<p>$$\int_1^{\infty} \frac{1}{x^p} \, dx = \left[\frac{x^{1-p}}{1-p}\right]_1^{\infty}$$</p>
<p>If $p > 1$, the integral converges, so $\sum \frac{1}{n^p}$ also converges.</p>
<h3 id="25-alternating-series-test">2.5 Alternating Series Test<a class="header-link" href="#25-alternating-series-test" title="Permanent link">&para;</a></h3>
<p>An alternating series $\sum (-1)^n b_n$ ($b_n > 0$) converges if:</p>
<ol>
<li>$b_{n+1} \leq b_n$ (monotone decreasing)</li>
<li>$\lim_{n \to \infty} b_n = 0$</li>
</ol>
<p>Error bound for alternating series: $|S - S_N| \leq b_{N+1}$ (less than or equal to the absolute value of the next term)</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># ìˆ˜ë ´ íŒì •ë²• ìë™ ì ìš© ë„êµ¬</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_convergence</span><span class="p">(</span><span class="n">a_n_func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ê¸‰ìˆ˜&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì£¼ì–´ì§„ ê¸‰ìˆ˜ì— ëŒ€í•´ ë¹„ìœ¨ íŒì •ë²•ê³¼ ê·¼ íŒì •ë²•ì„ ì ìš©í•©ë‹ˆë‹¤.&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">a_n</span> <span class="o">=</span> <span class="n">a_n_func</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: sum a_n, a_n = </span><span class="si">{</span><span class="n">a_n</span><span class="si">}</span><span class="s2"> ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ë¹„ìœ¨ íŒì •ë²•</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">a_n_func</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">a_n</span><span class="p">)</span>
    <span class="n">rho_ratio</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Abs</span><span class="p">(</span><span class="n">ratio</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">oo</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¹„ìœ¨ íŒì •ë²•: |a_(n+1)/a_n| -&gt; </span><span class="si">{</span><span class="n">rho_ratio</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rho_ratio</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; ì ˆëŒ€ ìˆ˜ë ´</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rho_ratio</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; ë°œì‚°</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; íŒì • ë¶ˆëŠ¥</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ê·¼ íŒì •ë²•</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Abs</span><span class="p">(</span><span class="n">a_n</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">rho_root</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">oo</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê·¼ íŒì •ë²•: |a_n|^(1/n) -&gt; </span><span class="si">{</span><span class="n">rho_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rho_root</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; ì ˆëŒ€ ìˆ˜ë ´</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rho_root</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; ë°œì‚°</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  =&gt; íŒì • ë¶ˆëŠ¥</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># í…ŒìŠ¤íŠ¸ ì˜ˆì œë“¤</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 1) sum n! / n^n  (ìˆ˜ë ´)</span>
<span class="n">test_convergence</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="s2">&quot;n!/n^n&quot;</span><span class="p">)</span>

<span class="c1"># 2) sum 1/n^2  (ìˆ˜ë ´)</span>
<span class="n">test_convergence</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;1/n^2&quot;</span><span class="p">)</span>

<span class="c1"># 3) sum n^2 / 2^n  (ìˆ˜ë ´)</span>
<span class="n">test_convergence</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="s2">&quot;n^2/2^n&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># êµëŒ€ê¸‰ìˆ˜ ì‹œê°í™”: ln(2) = sum_{n=1}^{inf} (-1)^{n+1} / n</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">partial_sums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">partial_sums</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë¶€ë¶„í•© S_N&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ln(2) = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># ì˜¤ì°¨ ë²”ìœ„ í‘œì‹œ</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
    <span class="n">error_bound</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
             <span class="p">[</span><span class="n">partial_sums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">error_bound</span><span class="p">,</span> <span class="n">partial_sums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">error_bound</span><span class="p">],</span>
             <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;S_N&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;êµëŒ€ê¸‰ìˆ˜: ln(2) = 1 - 1/2 + 1/3 - 1/4 + ...&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;alternating_series.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="3-power-series">3. Power Series<a class="header-link" href="#3-power-series" title="Permanent link">&para;</a></h2>
<h3 id="31-radius-of-convergence">3.1 Radius of Convergence<a class="header-link" href="#31-radius-of-convergence" title="Permanent link">&para;</a></h3>
<p>A <strong>power series</strong> has the form:</p>
<p>$$f(x) = \sum_{n=0}^{\infty} c_n (x - a)^n = c_0 + c_1(x-a) + c_2(x-a)^2 + \cdots$$</p>
<p>where $a$ is the <strong>center</strong> and $c_n$ are <strong>coefficients</strong>.</p>
<p><strong>Radius of convergence</strong> $R$:</p>
<p>$$R = \lim_{n \to \infty} \left|\frac{c_n}{c_{n+1}}\right| \quad \text{or} \quad R = \frac{1}{\lim_{n \to \infty} |c_n|^{1/n}}$$</p>
<ul>
<li>$|x - a| < R$ implies absolute convergence</li>
<li>$|x - a| > R$ implies divergence</li>
<li>$|x - a| = R$ requires separate investigation</li>
</ul>
<p><strong>Interval of convergence</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="w">      </span><span class="n">Diverges</span><span class="w">    </span><span class="n">Converges</span><span class="w">    </span><span class="n">Diverges</span>
<span class="w">  </span><span class="o">-------|========|========|---------&gt;</span><span class="w">  </span><span class="n">x</span>
<span class="w">        </span><span class="n">a</span><span class="o">-</span><span class="n">R</span><span class="w">       </span><span class="n">a</span><span class="w">       </span><span class="n">a</span><span class="o">+</span><span class="n">R</span>
<span class="w">         </span><span class="o">&lt;----</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">----&gt;</span>
</code></pre></div>

<h3 id="32-term-by-term-differentiation-and-integration">3.2 Term-by-Term Differentiation and Integration<a class="header-link" href="#32-term-by-term-differentiation-and-integration" title="Permanent link">&para;</a></h3>
<p>Within the interval of convergence, power series can be differentiated and integrated <strong>term-by-term</strong>:</p>
<p>$$f'(x) = \sum_{n=1}^{\infty} n c_n (x-a)^{n-1}$$</p>
<p>$$\int f(x) \, dx = C + \sum_{n=0}^{\infty} \frac{c_n (x-a)^{n+1}}{n+1}$$</p>
<p>The <strong>radius of convergence remains the same</strong> after differentiation or integration (though convergence at endpoints may change).</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># ë©±ê¸‰ìˆ˜ì˜ ìˆ˜ë ´ ë°˜ê²½ ê³„ì‚° ì˜ˆì œ</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ë©±ê¸‰ìˆ˜ì˜ ìˆ˜ë ´ ë°˜ê²½ ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 1) sum x^n / n!  (ì§€ìˆ˜í•¨ìˆ˜)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">c_n</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">c_n1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">R1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Abs</span><span class="p">(</span><span class="n">c_n</span> <span class="o">/</span> <span class="n">c_n1</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">oo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sum x^n/n!: R = </span><span class="si">{</span><span class="n">R1</span><span class="si">}</span><span class="s2">  (ëª¨ë“  xì—ì„œ ìˆ˜ë ´)&quot;</span><span class="p">)</span>

<span class="c1"># 2) sum n * x^n  (R = 1)</span>
<span class="n">c_n</span> <span class="o">=</span> <span class="n">n</span>
<span class="n">c_n1</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Abs</span><span class="p">(</span><span class="n">c_n</span> <span class="o">/</span> <span class="n">c_n1</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">oo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sum n*x^n: R = </span><span class="si">{</span><span class="n">R2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3) sum n! * x^n  (R = 0, x=0ì—ì„œë§Œ ìˆ˜ë ´)</span>
<span class="n">c_n</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">c_n1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">R3</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Abs</span><span class="p">(</span><span class="n">c_n</span> <span class="o">/</span> <span class="n">c_n1</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">oo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sum n!*x^n: R = </span><span class="si">{</span><span class="n">R3</span><span class="si">}</span><span class="s2">  (x=0ì—ì„œë§Œ ìˆ˜ë ´)&quot;</span><span class="p">)</span>

<span class="c1"># í•­ë³„ ë¯¸ë¶„ ì‹œê°í™”</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== í•­ë³„ ë¯¸ë¶„: d/dx [1/(1-x)] = 1/(1-x)^2 ===&quot;</span><span class="p">)</span>
<span class="c1"># 1/(1-x) = sum x^n  =&gt;  ë¯¸ë¶„í•˜ë©´  1/(1-x)^2 = sum n*x^{n-1}</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ì›ë˜ í•¨ìˆ˜ì™€ ê¸‰ìˆ˜</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]:</span>
    <span class="n">series_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x_vals</span><span class="o">**</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">series_sum</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x_vals</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1/(1-x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1/(1-x) = sum x^n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ë¯¸ë¶„í•œ í•¨ìˆ˜ì™€ ê¸‰ìˆ˜</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]:</span>
    <span class="n">deriv_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">x_vals</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">deriv_sum</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x_vals</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1/(1-x)^2&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1/(1-x)^2 = sum n*x^{n-1}&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;power_series_differentiation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4-taylor-series-and-maclaurin-series">4. Taylor Series and Maclaurin Series<a class="header-link" href="#4-taylor-series-and-maclaurin-series" title="Permanent link">&para;</a></h2>
<h3 id="41-taylor-expansion">4.1 Taylor Expansion<a class="header-link" href="#41-taylor-expansion" title="Permanent link">&para;</a></h3>
<p>If a function $f(x)$ is infinitely differentiable near $x = a$, it can be expanded as a <strong>Taylor series</strong>:</p>
<p>$$f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!} (x - a)^n$$</p>
<p>$$= f(a) + f'(a)(x-a) + \frac{f''(a)}{2!} (x-a)^2 + \frac{f'''(a)}{3!} (x-a)^3 + \cdots$$</p>
<p>When $a = 0$, this is called a <strong>Maclaurin series</strong>.</p>
<p><strong>Taylor remainder</strong> $R_N$: the error after expanding to $N$ terms</p>
<p>$$R_N(x) = \frac{f^{(N+1)}(c)}{(N+1)!} (x-a)^{N+1} \quad \text{(Lagrange remainder, } a < c < x\text{)}$$</p>
<h3 id="42-series-representations-of-common-functions">4.2 Series Representations of Common Functions<a class="header-link" href="#42-series-representations-of-common-functions" title="Permanent link">&para;</a></h3>
<p>Most frequently used series expansions in physics:</p>
<p>$$e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots \quad \text{(all } x\text{)}$$</p>
<p>$$\sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots \quad \text{(all } x\text{)}$$</p>
<p>$$\cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots \quad \text{(all } x\text{)}$$</p>
<p>$$\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4} + \cdots \quad (-1 < x \leq 1)$$</p>
<p>$$(1+x)^p = 1 + px + \frac{p(p-1)}{2!} x^2 + \cdots \quad (|x| < 1, \text{ binomial series})$$</p>
<p>$$\frac{1}{1-x} = 1 + x + x^2 + x^3 + \cdots \quad (|x| < 1)$$</p>
<p>$$\arctan(x) = x - \frac{x^3}{3} + \frac{x^5}{5} - \frac{x^7}{7} + \cdots \quad (|x| \leq 1)$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># SymPyë¥¼ ì´ìš©í•œ í…Œì¼ëŸ¬ ì „ê°œ</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="n">functions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;e^x&#39;</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
    <span class="s1">&#39;sin(x)&#39;</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
    <span class="s1">&#39;cos(x)&#39;</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
    <span class="s1">&#39;ln(1+x)&#39;</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">),</span>
<span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ì£¼ìš” í•¨ìˆ˜ì˜ í…Œì¼ëŸ¬ ê¸‰ìˆ˜ (a=0, 6ì°¨ê¹Œì§€) ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">functions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">taylor</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">taylor</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># í…Œì¼ëŸ¬ ê¸‰ìˆ˜ì˜ ìˆ˜ë ´ ì‹œê°í™”</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># sin(x)ì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_vals</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">x_vals</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">ì°¨&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;sin(x)ì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># cos(x)ì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x_vals</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">x_vals</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="si">}</span><span class="s1">ì°¨&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;cos(x)ì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># e^xì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬</span>
<span class="n">x_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_exp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x_exp</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;e^x&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x_exp</span><span class="o">**</span><span class="n">k</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_exp</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">ì°¨&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;e^xì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ln(1+x)ì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬</span>
<span class="n">x_ln</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_ln</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x_ln</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ln(1+x)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]:</span>
    <span class="n">x_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>  <span class="c1"># ìˆ˜ë ´ êµ¬ê°„ ë‚´</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_series</span><span class="o">**</span><span class="n">k</span> <span class="o">/</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_series</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">ì°¨&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x=1 (ê²½ê³„)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x=-1 (ê²½ê³„)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ln(1+x)ì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;taylor_series_visualization.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="43-approximation-using-series">4.3 Approximation Using Series<a class="header-link" href="#43-approximation-using-series" title="Permanent link">&para;</a></h3>
<p>The most important application of series expansion in physics is <strong>small-quantity approximation</strong>.</p>
<p>When $\varepsilon \ll 1$:</p>
<p>$$(1 + \varepsilon)^p \approx 1 + p\varepsilon + \frac{p(p-1)}{2} \varepsilon^2 + \cdots$$</p>
<p>$$e^\varepsilon \approx 1 + \varepsilon + \frac{\varepsilon^2}{2} + \cdots$$</p>
<p>$$\sin(\varepsilon) \approx \varepsilon - \frac{\varepsilon^3}{6} + \cdots$$</p>
<p>$$\cos(\varepsilon) \approx 1 - \frac{\varepsilon^2}{2} + \cdots$$</p>
<p>$$\tan(\varepsilon) \approx \varepsilon + \frac{\varepsilon^3}{3} + \cdots$$</p>
<p>$$\frac{1}{1+\varepsilon} \approx 1 - \varepsilon + \varepsilon^2 - \cdots$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ì†ŒëŸ‰ ê·¼ì‚¬ì˜ ì •í™•ë„ ë¹„êµ</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># sqrt(1 + epsilon) = (1+epsilon)^{1/2} ì˜ ê·¼ì‚¬</span>
<span class="n">exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
<span class="n">order1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="mi">2</span>                       <span class="c1"># 1ì°¨ ê·¼ì‚¬</span>
<span class="n">order2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">epsilon</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">8</span>      <span class="c1"># 2ì°¨ ê·¼ì‚¬</span>
<span class="n">order3</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">epsilon</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">8</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">16</span>  <span class="c1"># 3ì°¨</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">exact</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì •í™•ê°’&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">order1</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1ì°¨: 1 + e/2&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">order2</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2ì°¨: 1 + e/2 - e^2/8&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">order3</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;epsilon&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;sqrt(1 + epsilon)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì´í•­ê¸‰ìˆ˜ ê·¼ì‚¬: (1+e)^{1/2}&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ìƒëŒ€ ì˜¤ì°¨</span>
<span class="n">rel_err1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">order1</span> <span class="o">-</span> <span class="n">exact</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">rel_err2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">order2</span> <span class="o">-</span> <span class="n">exact</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">rel_err3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">order3</span> <span class="o">-</span> <span class="n">exact</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">rel_err1</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1ì°¨ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">rel_err2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2ì°¨ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">rel_err3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3ì°¨ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;epsilon&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ìƒëŒ€ ì˜¤ì°¨ (%)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê·¼ì‚¬ ì°¨ìˆ˜ì— ë”°ë¥¸ ìƒëŒ€ ì˜¤ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;approximation_error.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="5-asymptotic-series">5. Asymptotic Series<a class="header-link" href="#5-asymptotic-series" title="Permanent link">&para;</a></h2>
<h3 id="51-divergent-but-useful-series">5.1 Divergent but Useful Series<a class="header-link" href="#51-divergent-but-useful-series" title="Permanent link">&para;</a></h3>
<p>An <strong>asymptotic series</strong> diverges when summed to infinity, but finite partial sums provide excellent approximations to a function.</p>
<p>Asymptotic expansion of a function $f(x)$:</p>
<p>$$f(x) \sim \sum_{n=0}^{\infty} \frac{a_n}{x^n} \quad (x \to \infty)$$</p>
<p>This means that for the partial sum of $N$ terms, the following holds:</p>
<p>$$\lim_{x \to \infty} x^N \left[f(x) - \sum_{n=0}^{N} \frac{a_n}{x^n}\right] = 0 \quad \text{(for each } N\text{)}$$</p>
<blockquote>
<p><strong>Key Point</strong>: The entire series diverges, but truncating at the <strong>optimal number of terms</strong> yields an excellent approximation.
Generally, the optimal truncation point is where the terms stop decreasing and start increasing again.</p>
</blockquote>
<h3 id="52-stirlings-approximation">5.2 Stirling's Approximation<a class="header-link" href="#52-stirlings-approximation" title="Permanent link">&para;</a></h3>
<p><strong>Stirling's approximation</strong> is an asymptotic approximation for factorials:</p>
<p>$$n! \sim \sqrt{2\pi n} \left(\frac{n}{e}\right)^n \quad (n \to \infty)$$</p>
<p>$$\ln(n!) \sim n\ln(n) - n + \frac{1}{2}\ln(2\pi n)$$</p>
<p>This approximation is crucial in statistical mechanics for calculating Boltzmann entropy, combinatorial problems, etc.</p>
<p>More precise Stirling series:</p>
<p>$$n! \sim \sqrt{2\pi n} \left(\frac{n}{e}\right)^n \left(1 + \frac{1}{12n} + \frac{1}{288n^2} - \frac{139}{51840n^3} + \cdots\right)$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">factorial</span>

<span class="c1"># ìŠ¤í„¸ë§ ê·¼ì‚¬ì˜ ì •í™•ë„</span>
<span class="n">n_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>

<span class="c1"># ì •í™•í•œ ln(n!)</span>
<span class="n">exact_lnfact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_vals</span><span class="p">])</span>

<span class="c1"># ìŠ¤í„¸ë§ ê·¼ì‚¬ (ì—¬ëŸ¬ ì°¨ìˆ˜)</span>
<span class="n">stirling_0</span> <span class="o">=</span> <span class="n">n_vals</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n_vals</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_vals</span>  <span class="c1"># ê°€ì¥ ê°„ë‹¨í•œ í˜•íƒœ</span>
<span class="n">stirling_1</span> <span class="o">=</span> <span class="n">stirling_0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">n_vals</span><span class="p">)</span>  <span class="c1"># 1ì°¨ ë³´ì •</span>
<span class="n">stirling_2</span> <span class="o">=</span> <span class="n">stirling_1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">n_vals</span><span class="p">)</span>  <span class="c1"># 2ì°¨ ë³´ì •</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ì ˆëŒ€ê°’ ë¹„êµ</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">exact_lnfact</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ln(n!) ì •í™•ê°’&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">stirling_0</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;n*ln(n) - n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">stirling_1</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+ (1/2)ln(2*pi*n)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ln(n!)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìŠ¤í„¸ë§ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ìƒëŒ€ ì˜¤ì°¨</span>
<span class="n">rel_err0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stirling_0</span> <span class="o">-</span> <span class="n">exact_lnfact</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_lnfact</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">rel_err1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stirling_1</span> <span class="o">-</span> <span class="n">exact_lnfact</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_lnfact</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">rel_err2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stirling_2</span> <span class="o">-</span> <span class="n">exact_lnfact</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_lnfact</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">rel_err0</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;0ì°¨: n*ln(n)-n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">rel_err1</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1ì°¨: + ln(sqrt(2*pi*n))&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">rel_err2</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2ì°¨: + 1/(12n)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ìƒëŒ€ ì˜¤ì°¨ (%)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìŠ¤í„¸ë§ ê·¼ì‚¬ì˜ ìƒëŒ€ ì˜¤ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;stirling_approximation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># í†µê³„ì—­í•™ ì‘ìš©: ë³¼ì¸ ë§Œ ì—”íŠ¸ë¡œí”¼</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== í†µê³„ì—­í•™ ì‘ìš©: ì´ìƒê¸°ì²´ ì—”íŠ¸ë¡œí”¼ ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nê°œ ì…ìê°€ Wê°œ ë¯¸ì‹œìƒíƒœë¥¼ ê°€ì§ˆ ë•Œ:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;S = k_B * ln(W)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ìŠ¤í„¸ë§ ê·¼ì‚¬ë¥¼ ì‚¬ìš©í•˜ë©´:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ln(N!) ~ N*ln(N) - N&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì˜ˆ: N = 10^23 (ì•„ë³´ê°€ë“œë¡œ ìˆ˜ ê·œëª¨)&quot;</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mf">1e23</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ln(N!) ~ N*ln(N) - N = </span><span class="si">{</span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì§ì ‘ ê³„ì‚°ì€ ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ, ìŠ¤í„¸ë§ ê·¼ì‚¬ë¡œ ì‰½ê²Œ ê³„ì‚° ê°€ëŠ¥!&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-applications-in-physics">6. Applications in Physics<a class="header-link" href="#6-applications-in-physics" title="Permanent link">&para;</a></h2>
<h3 id="61-period-of-a-pendulum-series-expansion">6.1 Period of a Pendulum (Series Expansion)<a class="header-link" href="#61-period-of-a-pendulum-series-expansion" title="Permanent link">&para;</a></h3>
<p>The exact period of a simple pendulum is given by a complete elliptic integral:</p>
<p>$$T = 4\sqrt{\frac{L}{g}} K\left(\sin\frac{\theta_0}{2}\right)$$</p>
<p>where $K(k)$ is the complete elliptic integral of the first kind. Expanding as a series:</p>
<p>$$T = 2\pi\sqrt{\frac{L}{g}} \left[1 + \frac{1}{4}\sin^2\frac{\theta_0}{2} + \frac{9}{64}\sin^4\frac{\theta_0}{2} + \cdots\right]$$</p>
<p>$$\approx T_0 \left[1 + \frac{\theta_0^2}{16} + \frac{11\theta_0^4}{3072} + \cdots\right]$$</p>
<p>where $T_0 = 2\pi\sqrt{L/g}$ is the period in the small-angle approximation.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">ellipk</span>

<span class="c1"># ë‹¨ì§„ìì˜ ì£¼ê¸°: ì •í™•ê°’ vs ê¸‰ìˆ˜ ê·¼ì‚¬</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># m/s^2</span>
<span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># m</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span>  <span class="c1"># ì†Œê° ê·¼ì‚¬ ì£¼ê¸°</span>

<span class="n">theta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>  <span class="c1"># ì´ˆê¸° ê°ë„ (rad)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># ì •í™•í•œ ì£¼ê¸° (ì™„ì „ íƒ€ì› ì ë¶„)</span>
<span class="n">T_exact</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">ellipk</span><span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># ê¸‰ìˆ˜ ê·¼ì‚¬ (ì†Œê° ê·¼ì‚¬ë¶€í„° ê³ ì°¨í•­ê¹Œì§€)</span>
<span class="n">T_approx0</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">theta0</span><span class="p">)</span>                          <span class="c1"># 0ì°¨ (ì†Œê°)</span>
<span class="n">T_approx2</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                           <span class="c1"># 2ì°¨</span>
<span class="n">T_approx4</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">9</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>               <span class="c1"># 4ì°¨</span>
<span class="n">T_approx6</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">9</span><span class="o">/</span><span class="mi">64</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="mi">25</span><span class="o">/</span><span class="mi">256</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ì£¼ê¸° ë¹„êµ</span>
<span class="n">theta_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">T_exact</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì •í™•ê°’&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">T_approx0</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;0ì°¨ (ì†Œê°ê·¼ì‚¬)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">T_approx2</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2ì°¨ ë³´ì •&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">T_approx4</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;4ì°¨ ë³´ì •&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">T_approx6</span> <span class="o">/</span> <span class="n">T0</span><span class="p">,</span> <span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;6ì°¨ ë³´ì •&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ì´ˆê¸° ê°ë„ (ë„)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;T / T_0&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë‹¨ì§„ì ì£¼ê¸°: ê¸‰ìˆ˜ ì „ê°œ ê·¼ì‚¬&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ìƒëŒ€ ì˜¤ì°¨</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_approx0</span> <span class="o">-</span> <span class="n">T_exact</span><span class="p">)</span><span class="o">/</span><span class="n">T_exact</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;0ì°¨ (ì†Œê°)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_approx2</span> <span class="o">-</span> <span class="n">T_exact</span><span class="p">)</span><span class="o">/</span><span class="n">T_exact</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_approx4</span> <span class="o">-</span> <span class="n">T_exact</span><span class="p">)</span><span class="o">/</span><span class="n">T_exact</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;4ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_approx6</span> <span class="o">-</span> <span class="n">T_exact</span><span class="p">)</span><span class="o">/</span><span class="n">T_exact</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;6ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ì´ˆê¸° ê°ë„ (ë„)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ìƒëŒ€ ì˜¤ì°¨ (%)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê¸‰ìˆ˜ ê·¼ì‚¬ì˜ ìƒëŒ€ ì˜¤ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pendulum_period.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ìˆ˜ì¹˜ ê²°ê³¼</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ë‹¨ì§„ì ì£¼ê¸° ë¹„êµ (L=1m) ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;ê°ë„&#39;</span><span class="si">:</span><span class="s2">&gt;6s</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;ì •í™•ê°’(s)&#39;</span><span class="si">:</span><span class="s2">&gt;10s</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;ì†Œê°ê·¼ì‚¬(s)&#39;</span><span class="si">:</span><span class="s2">&gt;12s</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;ì˜¤ì°¨(%)&#39;</span><span class="si">:</span><span class="s2">&gt;8s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="k">for</span> <span class="n">angle_deg</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">]:</span>
    <span class="n">angle_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span>
    <span class="n">k_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_rad</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">T_ex</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">ellipk</span><span class="p">(</span><span class="n">k_val</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">=</span> <span class="p">(</span><span class="n">T0</span> <span class="o">-</span> <span class="n">T_ex</span><span class="p">)</span> <span class="o">/</span> <span class="n">T_ex</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">angle_deg</span><span class="si">:</span><span class="s2">&gt;5d</span><span class="si">}</span><span class="s2">   </span><span class="si">{</span><span class="n">T_ex</span><span class="si">:</span><span class="s2">&gt;10.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">T0</span><span class="si">:</span><span class="s2">&gt;12.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">err</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="62-non-relativistic-approximation-of-relativistic-energy">6.2 Non-relativistic Approximation of Relativistic Energy<a class="header-link" href="#62-non-relativistic-approximation-of-relativistic-energy" title="Permanent link">&para;</a></h3>
<p>Einstein's relativistic energy-momentum relation:</p>
<p>$$E = \gamma mc^2 = \frac{mc^2}{\sqrt{1 - v^2/c^2}}$$</p>
<p>Expanding the kinetic energy $K = E - mc^2$ as a series (when $\beta = v/c \ll 1$):</p>
<p>$$\gamma = \frac{1}{\sqrt{1 - \beta^2}} = 1 + \frac{1}{2}\beta^2 + \frac{3}{8}\beta^4 + \frac{5}{16}\beta^6 + \cdots$$</p>
<p>$$K = mc^2 (\gamma - 1)$$</p>
<p>$$= \underbrace{\frac{1}{2}mv^2}_{\text{Newtonian}} + \underbrace{\frac{3}{8}m\frac{v^4}{c^2} + \frac{5}{16}m\frac{v^6}{c^4} + \cdots}_{\text{Relativistic correction}}$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ìƒëŒ€ë¡ ì  ìš´ë™ ì—ë„ˆì§€ì˜ ê¸‰ìˆ˜ ê·¼ì‚¬</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>  <span class="c1"># v/c</span>

<span class="c1"># ì •í™•í•œ ìƒëŒ€ë¡ ì  ìš´ë™ ì—ë„ˆì§€: K/(mc^2) = gamma - 1</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">K_exact</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># mc^2 ë‹¨ìœ„</span>

<span class="c1"># ê¸‰ìˆ˜ ê·¼ì‚¬ (ì´í•­ê¸‰ìˆ˜ ì „ê°œ)</span>
<span class="n">K_order2</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mi">2</span>                                         <span class="c1"># ë‰´í„´ ì—­í•™</span>
<span class="n">K_order4</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mi">4</span>                      <span class="c1"># 1ì°¨ ë³´ì •</span>
<span class="n">K_order6</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mi">6</span>  <span class="c1"># 2ì°¨ ë³´ì •</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ìš´ë™ ì—ë„ˆì§€ ë¹„êµ</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">K_exact</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ìƒëŒ€ë¡ ì  (ì •í™•)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">K_order2</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë‰´í„´: (1/2)mv^2&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">K_order4</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1ì°¨ ë³´ì •&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">K_order6</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2ì°¨ ë³´ì •&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;beta = v/c&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;K / (mc^2)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìš´ë™ ì—ë„ˆì§€: ìƒëŒ€ë¡  vs ë‰´í„´&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ë‰´í„´ ì—­í•™ì˜ ìƒëŒ€ ì˜¤ì°¨</span>
<span class="n">beta_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">gamma_low</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta_low</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">K_exact_low</span> <span class="o">=</span> <span class="n">gamma_low</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">K_newton</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta_low</span><span class="o">**</span><span class="mi">2</span>
<span class="n">K_corr1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta_low</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta_low</span><span class="o">**</span><span class="mi">4</span>

<span class="n">rel_err_newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">K_newton</span> <span class="o">-</span> <span class="n">K_exact_low</span><span class="p">)</span> <span class="o">/</span> <span class="n">K_exact_low</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">rel_err_corr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">K_corr1</span> <span class="o">-</span> <span class="n">K_exact_low</span><span class="p">)</span> <span class="o">/</span> <span class="n">K_exact_low</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">beta_low</span><span class="p">,</span> <span class="n">rel_err_newton</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë‰´í„´ ì—­í•™ ì˜¤ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">beta_low</span><span class="p">,</span> <span class="n">rel_err_corr1</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1ì°¨ ë³´ì • í›„ ì˜¤ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1% ì˜¤ì°¨ì„ &#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;beta = v/c&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ìƒëŒ€ ì˜¤ì°¨ (%)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë‰´í„´ ì—­í•™ì˜ ìœ íš¨ ë²”ìœ„&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;relativistic_energy.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ê²°ê³¼ ì¶œë ¥</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ë‰´í„´ ì—­í•™ì´ ìœ íš¨í•œ ì†ë„ ë²”ìœ„ ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;v/c&#39;</span><span class="si">:</span><span class="s2">&gt;6s</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;ìƒëŒ€ë¡ ì  K&#39;</span><span class="si">:</span><span class="s2">&gt;12s</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;ë‰´í„´ K&#39;</span><span class="si">:</span><span class="s2">&gt;10s</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;ì˜¤ì°¨(%)&#39;</span><span class="si">:</span><span class="s2">&gt;8s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">42</span><span class="p">)</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]:</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">K_rel</span> <span class="o">=</span> <span class="n">g</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">K_new</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">err</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">K_new</span> <span class="o">-</span> <span class="n">K_rel</span><span class="p">)</span> <span class="o">/</span> <span class="n">K_rel</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">&gt;6.2f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">K_rel</span><span class="si">:</span><span class="s2">&gt;12.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">K_new</span><span class="si">:</span><span class="s2">&gt;10.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">err</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="63-electric-multipole-expansion">6.3 Electric Multipole Expansion<a class="header-link" href="#63-electric-multipole-expansion" title="Permanent link">&para;</a></h3>
<p>When a point charge $q$ is located at distance $d$ from the origin, the potential at a point far from the origin ($r \gg d$) can be expanded as a series.</p>
<div class="highlight"><pre><span></span><code>    Observation point P(r, theta)
    <span class="k">*</span>
    |\
    | \  r
    |  \
    |   \
    |theta\
    |------*--- Charge q (distance d, on z-axis)
    |
    Origin O
</code></pre></div>

<p>Distance to observation point:</p>
<p>$$\frac{1}{|\mathbf{r} - \mathbf{d}|} = \frac{1}{r} \sum_{l=0}^{\infty} \left(\frac{d}{r}\right)^l P_l(\cos\theta)$$</p>
<p>where $P_l$ are Legendre polynomials.</p>
<p>For an electric dipole ($+q$ and $-q$ separated by distance $d$):</p>
<p>$$V(r, \theta) \approx \frac{1}{4\pi\varepsilon_0} \frac{p\cos\theta}{r^2} \quad (r \gg d)$$</p>
<p>where $p = qd$ is the dipole moment.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">legendre</span>

<span class="c1"># ë‹¤ì¤‘ê·¹ ì „ê°œ (Multipole Expansion) ì‹œê°í™”</span>
<span class="c1"># ì „í•˜ qê°€ zì¶• ìœ„ d = 1ì— ìˆì„ ë•Œ, 1/|r - d*z_hat|ì˜ ê¸‰ìˆ˜ ì „ê°œ</span>

<span class="k">def</span><span class="w"> </span><span class="nf">exact_potential_ratio</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì •í™•í•œ ì „ìœ„ ë¹„ìœ¨: r / |r - d*z_hat| (1/r ì œì™¸í•œ ë¶€ë¶„)&quot;&quot;&quot;</span>
    <span class="c1"># |r - d*z_hat|^2 = r^2 - 2*r*d*cos(theta) + d^2</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">/</span> <span class="n">dist</span>

<span class="k">def</span><span class="w"> </span><span class="nf">multipole_approx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">L_max</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë‹¤ì¤‘ê·¹ ì „ê°œ: sum_{l=0}^{L_max} (d/r)^l * P_l(cos(theta))&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">cos_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">Pl</span> <span class="o">=</span> <span class="n">legendre</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="n">l</span> <span class="o">*</span> <span class="n">Pl</span><span class="p">(</span><span class="n">cos_theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># r/d ë¹„ìœ¨ì— ë”°ë¥¸ ë‹¤ì¤‘ê·¹ ì „ê°œì˜ ì •í™•ë„</span>
<span class="n">r_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1"># 45ë„</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">exact</span> <span class="o">=</span> <span class="n">exact_potential_ratio</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

<span class="k">for</span> <span class="n">L_max</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="n">multipole_approx</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">L_max</span><span class="o">=</span><span class="n">L_max</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;L_max = </span><span class="si">{</span><span class="n">L_max</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">exact</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì •í™•ê°’&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r/d&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;r * V(r) / (kq)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ë‹¤ì¤‘ê·¹ ì „ê°œ (theta = 45ë„)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ìŒê·¹ì ì „ìœ„ íŒ¨í„´ (2D)</span>
<span class="n">r_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">theta_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r_grid</span><span class="p">,</span> <span class="n">theta_grid</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>

<span class="c1"># ìŒê·¹ì ì „ìœ„: V ~ cos(theta)/r^2 (ë‹¨ìœ„ ìƒëµ)</span>
<span class="n">V_dipole</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">V_dipole</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „ê¸° ìŒê·¹ì ì „ìœ„ íŒ¨í„´&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1"># ì „í•˜ ìœ„ì¹˜ í‘œì‹œ</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;b_&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;multipole_expansion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ë¥´ì¥ë“œë¥´ ë‹¤í•­ì‹ì˜ ì²˜ìŒ ëª‡ ê°œ</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ë¥´ì¥ë“œë¥´ ë‹¤í•­ì‹ P_l(x) ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="n">x_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">Pl</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">legendre</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">x_sym</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P_</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">(x) = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">Pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-convergence-test-basic">Problem 1. Convergence Test (Basic)<a class="header-link" href="#problem-1-convergence-test-basic" title="Permanent link">&para;</a></h3>
<p>Determine the convergence/divergence of the following series. State the test used.</p>
<p>(a) $\sum_{n=1}^{\infty} \frac{n^2}{3^n}$</p>
<p>(b) $\sum_{n=2}^{\infty} \frac{1}{n \ln^2(n)}$</p>
<p>(c) $\sum_{n=1}^{\infty} \frac{(-1)^n n}{n^2 + 1}$</p>
<p><strong>Hint</strong>: (a) ratio test, (b) integral test, (c) alternating series test</p>
<h3 id="problem-2-radius-of-convergence-basic">Problem 2. Radius of Convergence (Basic)<a class="header-link" href="#problem-2-radius-of-convergence-basic" title="Permanent link">&para;</a></h3>
<p>Find the radius of convergence $R$ for the following power series.</p>
<p>(a) $\sum_{n=0}^{\infty} \frac{n! x^n}{(2n)!}$</p>
<p>(b) $\sum_{n=1}^{\infty} \frac{(-1)^{n+1} x^n}{n \cdot 3^n}$</p>
<h3 id="problem-3-taylor-series-approximation-intermediate">Problem 3. Taylor Series Approximation (Intermediate)<a class="header-link" href="#problem-3-taylor-series-approximation-intermediate" title="Permanent link">&para;</a></h3>
<p>Expand $f(x) = \sqrt{1 + x}$ as a Taylor series about $x = 0$ up to 3rd order, and:</p>
<p>(a) Find the approximate value of $\sqrt{1.1}$ (substitute $x = 0.1$)</p>
<p>(b) Calculate the relative error by comparing with the exact value</p>
<p>(c) Use Python to plot a comparison of errors for 1st, 2nd, and 3rd order approximations</p>
<h3 id="problem-4-physics-application-intermediate">Problem 4. Physics Application (Intermediate)<a class="header-link" href="#problem-4-physics-application-intermediate" title="Permanent link">&para;</a></h3>
<p>For a pendulum with maximum angle $\theta_0 = 30$ degrees:</p>
<p>(a) Calculate the exact period (elliptic integral)</p>
<p>(b) Compare with the small-angle approximation period and find the error</p>
<p>(c) Find the error when including the 2nd order correction term</p>
<h3 id="problem-5-stirlings-approximation-intermediate">Problem 5. Stirling's Approximation (Intermediate)<a class="header-link" href="#problem-5-stirlings-approximation-intermediate" title="Permanent link">&para;</a></h3>
<p>(a) Use Stirling's approximation to find $\log_{10}(100!)$</p>
<p>(b) Compare with Python's exact calculation</p>
<p>(c) For an ideal gas with $N$ molecules having $W$ microstates $W = N! / (n_1! n_2! \cdots n_k!)$, explain why Stirling's approximation is essential</p>
<h3 id="problem-6-comprehensive-application-advanced">Problem 6. Comprehensive Application (Advanced)<a class="header-link" href="#problem-6-comprehensive-application-advanced" title="Permanent link">&para;</a></h3>
<p>When an electron has velocity $v = 0.1c$:</p>
<p>(a) Find the exact relativistic kinetic energy in $mc^2$ units</p>
<p>(b) Compare with Newtonian kinetic energy and find the relative error</p>
<p>(c) Calculate how much the error reduces when including the 1st order relativistic correction term $\frac{3}{8}m\frac{v^4}{c^2}$</p>
<p>(d) Find the maximum $v/c$ for which Newtonian mechanics has an error less than 1%</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ì—°ìŠµ ë¬¸ì œ í’€ì´ ë„ìš°ë¯¸</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># ë¬¸ì œ 1(a) ê²€ì¦</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">a_n</span> <span class="o">=</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="o">**</span><span class="n">n</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Abs</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="o">**</span><span class="n">n</span><span class="p">))</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">oo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¬¸ì œ 1(a): ë¹„ìœ¨ = </span><span class="si">{</span><span class="n">rho</span><span class="si">}</span><span class="s2"> &lt; 1 =&gt; ìˆ˜ë ´&quot;</span><span class="p">)</span>

<span class="c1"># ë¬¸ì œ 4 ê²€ì¦</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">ellipk</span>
<span class="n">L</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">9.81</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">T_exact</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">ellipk</span><span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë¬¸ì œ 4: T_exact = </span><span class="si">{</span><span class="n">T_exact</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">s, T_0 = </span><span class="si">{</span><span class="n">T0</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì†Œê° ê·¼ì‚¬ ì˜¤ì°¨ = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">T0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">T_exact</span><span class="p">)</span><span class="o">/</span><span class="n">T_exact</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="n">T_corrected</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2ì°¨ ë³´ì • í›„ ì˜¤ì°¨ = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">T_corrected</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">T_exact</span><span class="p">)</span><span class="o">/</span><span class="n">T_exact</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># ë¬¸ì œ 5 ê²€ì¦</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="n">stirling_log10_100</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">200</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">exact_log10_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë¬¸ì œ 5: log10(100!) ìŠ¤í„¸ë§ = </span><span class="si">{</span><span class="n">stirling_log10_100</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;         log10(100!) ì •í™•ê°’ = </span><span class="si">{</span><span class="n">exact_log10_100</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;         ì˜¤ì°¨ = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">stirling_log10_100</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">exact_log10_100</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<h3 id="textbooks">Textbooks<a class="header-link" href="#textbooks" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Boas, M. L.</strong> (2005). <em>Mathematical Methods in the Physical Sciences</em>, 3rd ed., Chapter 1. Wiley.</li>
<li><strong>Arfken, G. B., Weber, H. J., &amp; Harris, F. E.</strong> (2012). <em>Mathematical Methods for Physicists</em>, 7th ed., Chapter 5. Academic Press.</li>
<li><strong>Riley, K. F. et al.</strong> (2006). <em>Mathematical Methods for Physics and Engineering</em>, Chapter 4. Cambridge University Press.</li>
</ol>
<h3 id="online-resources">Online Resources<a class="header-link" href="#online-resources" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>MIT OCW 18.01SC</strong>: Single Variable Calculus - Sequences and Series</li>
<li><strong>Paul's Online Math Notes</strong>: Series &amp; Sequences (https://tutorial.math.lamar.edu/)</li>
<li><strong>3Blue1Brown</strong>: Taylor series visualization</li>
</ol>
<h3 id="python-tools">Python Tools<a class="header-link" href="#python-tools" title="Permanent link">&para;</a></h3>
<ul>
<li><code>sympy.series()</code>: symbolic Taylor series calculation</li>
<li><code>scipy.special.ellipk()</code>: complete elliptic integral</li>
<li><code>scipy.special.factorial()</code>: factorial calculation</li>
<li><code>numpy.cumsum()</code>: partial sum calculation</li>
</ul>
<hr />
<h2 id="next-lesson">Next Lesson<a class="header-link" href="#next-lesson" title="Permanent link">&para;</a></h2>
<p><a href="02_Complex_Numbers.md">02. Complex Numbers</a> covers algebraic operations with complex numbers, polar and exponential representations, De Moivre's theorem, and Euler's formula which is essential in physics. We will use Taylor expansion learned in series to derive $e^{ix} = \cos(x) + i\sin(x)$.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Mathematical Methods in the Physical Sciences - Overview</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/02_Complex_Numbers.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">02. Complex Numbers</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}