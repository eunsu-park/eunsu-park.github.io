{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>04. Partial Differentiation - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Mathematical_Methods/">Mathematical Methods</a>
    <span class="separator">/</span>
    <span class="current">04. Partial Differentiation</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>04. Partial Differentiation</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/03_Linear_Algebra.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">03. Linear Algebra</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/05_Vector_Analysis.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">05. Vector Analysis</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-basics-of-partial-differentiation">1. Basics of Partial Differentiation</a><ul>
<li><a href="#11-multivariable-functions-and-partial-derivatives">1.1 Multivariable Functions and Partial Derivatives</a></li>
<li><a href="#12-total-differential">1.2 Total Differential</a></li>
<li><a href="#13-gradient">1.3 Gradient</a></li>
</ul>
</li>
<li><a href="#2-chain-rule">2. Chain Rule</a><ul>
<li><a href="#21-multivariable-chain-rule">2.1 Multivariable Chain Rule</a></li>
<li><a href="#22-implicit-differentiation">2.2 Implicit Differentiation</a></li>
</ul>
</li>
<li><a href="#3-extrema-and-saddle-points">3. Extrema and Saddle Points</a><ul>
<li><a href="#31-necessary-condition-for-extrema">3.1 Necessary Condition for Extrema</a></li>
<li><a href="#32-second-derivative-test">3.2 Second Derivative Test</a></li>
<li><a href="#33-practical-example-distance-minimization">3.3 Practical Example: Distance Minimization</a></li>
</ul>
</li>
<li><a href="#4-lagrange-multipliers">4. Lagrange Multipliers</a><ul>
<li><a href="#41-optimization-with-equality-constraints">4.1 Optimization with Equality Constraints</a></li>
<li><a href="#42-multiple-constraints">4.2 Multiple Constraints</a></li>
<li><a href="#43-numerical-optimization-with-scipy">4.3 Numerical Optimization with SciPy</a></li>
</ul>
</li>
<li><a href="#5-exact-differentials-and-thermodynamics">5. Exact Differentials and Thermodynamics</a><ul>
<li><a href="#51-condition-for-exact-differentials">5.1 Condition for Exact Differentials</a></li>
<li><a href="#52-thermodynamics-and-maxwell-relations">5.2 Thermodynamics and Maxwell Relations</a></li>
</ul>
</li>
<li><a href="#6-multivariate-taylor-series">6. Multivariate Taylor Series</a><ul>
<li><a href="#61-two-variable-taylor-expansion">6.1 Two-Variable Taylor Expansion</a></li>
<li><a href="#62-physics-approximations">6.2 Physics Approximations</a></li>
</ul>
</li>
<li><a href="#7-change-of-variables-and-jacobian">7. Change of Variables and Jacobian</a><ul>
<li><a href="#71-jacobian-matrix-and-determinant">7.1 Jacobian Matrix and Determinant</a></li>
<li><a href="#72-jacobians-of-common-coordinate-transformations">7.2 Jacobians of Common Coordinate Transformations</a></li>
</ul>
</li>
<li><a href="#exercises">Exercises</a><ul>
<li><a href="#basic-problems">Basic Problems</a></li>
<li><a href="#applied-problems">Applied Problems</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
<li><a href="#next-lesson">Next Lesson</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="04-partial-differentiation">04. Partial Differentiation<a class="header-link" href="#04-partial-differentiation" title="Permanent link">&para;</a></h1>
<blockquote>
<p><strong>Boas Chapter 4</strong> â€” Partial differentiation is a core tool across all physical sciences, including thermodynamics, electromagnetism, and fluid dynamics, because almost every law of physics is described by multivariable functions.</p>
</blockquote>
<hr />
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>Upon completing this lesson, you will be able to:</p>
<ul>
<li>Understand the definition and notation of <strong>partial derivatives</strong> and compute partial derivatives of multivariable functions</li>
<li>Apply the <strong>multivariable chain rule</strong> to find derivatives of composite functions</li>
<li>Perform <strong>implicit differentiation</strong> and apply it to physical relationships</li>
<li>Classify <strong>extrema and saddle points</strong> using the second derivative test</li>
<li>Solve constrained optimization problems using the <strong>Lagrange multiplier method</strong></li>
<li>Understand the conditions for <strong>exact differentials</strong> and derive Maxwell relations in thermodynamics</li>
<li>Expand <strong>multivariate Taylor series</strong> and apply them to physics approximations</li>
</ul>
<hr />
<h2 id="1-basics-of-partial-differentiation">1. Basics of Partial Differentiation<a class="header-link" href="#1-basics-of-partial-differentiation" title="Permanent link">&para;</a></h2>
<h3 id="11-multivariable-functions-and-partial-derivatives">1.1 Multivariable Functions and Partial Derivatives<a class="header-link" href="#11-multivariable-functions-and-partial-derivatives" title="Permanent link">&para;</a></h3>
<p>The <strong>partial derivative</strong> of a <strong>multivariable function</strong> $f(x, y, z, \ldots)$ with respect to a specific variable is obtained by treating all other variables as constants and differentiating only with respect to that variable:</p>
<p>$$
\frac{\partial f}{\partial x} = \lim_{\Delta x \to 0} \frac{f(x + \Delta x, y, z, \ldots) - f(x, y, z, \ldots)}{\Delta x}
$$</p>
<p><strong>Notation</strong>: $\frac{\partial f}{\partial x}$, $f_x$, $\partial_x f$</p>
<p><strong>Higher-order partial derivatives</strong>:</p>
<p>$$
\frac{\partial^2 f}{\partial x^2}, \quad \frac{\partial^2 f}{\partial x \partial y}, \quad \frac{\partial^2 f}{\partial y \partial x}
$$</p>
<blockquote>
<p><strong>Schwarz's theorem</strong>: If the second partial derivatives of $f$ are continuous, the order of differentiation can be exchanged:
$$\frac{\partial^2 f}{\partial x \partial y} = \frac{\partial^2 f}{\partial y \partial x}$$</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># SymPyë¥¼ ì´ìš©í•œ í¸ë¯¸ë¶„</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f = </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‚f/âˆ‚x = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‚f/âˆ‚y = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‚f/âˆ‚z = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 2ì°¨ í¸ë¯¸ë¶„</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âˆ‚Â²f/âˆ‚xÂ² = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‚Â²f/âˆ‚xâˆ‚y = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‚Â²f/âˆ‚yâˆ‚x = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í˜¼í•© í¸ë¯¸ë¶„ êµí™˜: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="12-total-differential">1.2 Total Differential<a class="header-link" href="#12-total-differential" title="Permanent link">&para;</a></h3>
<p>The <strong>total differential</strong> of a function $f(x, y, z)$:</p>
<p>$$
df = \frac{\partial f}{\partial x} dx + \frac{\partial f}{\partial y} dy + \frac{\partial f}{\partial z} dz
$$</p>
<p>This is a first-order approximation of the change in $f$ due to independent changes in each variable.</p>
<p><strong>Physical meaning</strong>: The infinitesimal change in pressure $P(V, T)$ is:
$$
dP = \left(\frac{\partial P}{\partial V}\right)_T dV + \left(\frac{\partial P}{\partial T}\right)_V dT
$$</p>
<blockquote>
<p>The subscript indicates the <strong>variable being held constant</strong>. This notation is very important in thermodynamics.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1"># ì´ìƒê¸°ì²´ PV = nRTì—ì„œì˜ ì „ë¯¸ë¶„</span>
<span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;P V T n R&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># P = nRT/V</span>
<span class="n">P_expr</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">V</span>

<span class="n">dP_dV</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P_expr</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">dP_dT</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P_expr</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P = </span><span class="si">{</span><span class="n">P_expr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(âˆ‚P/âˆ‚V)_T = </span><span class="si">{</span><span class="n">dP_dV</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(âˆ‚P/âˆ‚T)_V = </span><span class="si">{</span><span class="n">dP_dT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dP = (</span><span class="si">{</span><span class="n">dP_dV</span><span class="si">}</span><span class="s2">)dV + (</span><span class="si">{</span><span class="n">dP_dT</span><span class="si">}</span><span class="s2">)dT&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="13-gradient">1.3 Gradient<a class="header-link" href="#13-gradient" title="Permanent link">&para;</a></h3>
<p>The <strong>gradient</strong> of a scalar function $f(x, y, z)$ is a vector whose components are the partial derivatives:</p>
<p>$$
\nabla f = \left(\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z}\right)
$$</p>
<p><strong>Meaning of the gradient</strong>:
- <strong>Direction</strong> of $\nabla f$: direction of steepest increase of $f$
- $|\nabla f|$: rate of increase in that direction (maximum directional derivative)
- $\nabla f$ is <strong>perpendicular</strong> to the level surface $f = \text{const}$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># 2D ê¸°ìš¸ê¸° ì‹œê°í™”</span>
<span class="n">f_2d</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># f(x,y) = xÂ² + yÂ²</span>
<span class="n">grad_f</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_2d</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_2d</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f = </span><span class="si">{</span><span class="n">f_2d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡f = (</span><span class="si">{</span><span class="n">grad_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">grad_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># ìˆ˜ì¹˜ ì‹œê°í™”</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">U</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">X</span>  <span class="c1"># âˆ‚f/âˆ‚x</span>
<span class="n">V_field</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Y</span>  <span class="c1"># âˆ‚f/âˆ‚y</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V_field</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë“±ê³ ì„ ê³¼ ê¸°ìš¸ê¸° ë²¡í„° (âˆ‡f âŠ¥ ë“±ê³ ì„ )&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gradient_field.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="2-chain-rule">2. Chain Rule<a class="header-link" href="#2-chain-rule" title="Permanent link">&para;</a></h2>
<h3 id="21-multivariable-chain-rule">2.1 Multivariable Chain Rule<a class="header-link" href="#21-multivariable-chain-rule" title="Permanent link">&para;</a></h3>
<p>If $f(x, y)$ where $x = x(t)$, $y = y(t)$:</p>
<p>$$
\frac{df}{dt} = \frac{\partial f}{\partial x}\frac{dx}{dt} + \frac{\partial f}{\partial y}\frac{dy}{dt}
$$</p>
<p>More generally, if $f(x, y)$ where $x = x(s, t)$, $y = y(s, t)$:</p>
<p>$$
\frac{\partial f}{\partial s} = \frac{\partial f}{\partial x}\frac{\partial x}{\partial s} + \frac{\partial f}{\partial y}\frac{\partial y}{\partial s}
$$</p>
<p>$$
\frac{\partial f}{\partial t} = \frac{\partial f}{\partial x}\frac{\partial x}{\partial t} + \frac{\partial f}{\partial y}\frac{\partial y}{\partial t}
$$</p>
<p><strong>Matrix notation</strong> (Jacobian):</p>
<p>$$
\begin{pmatrix} \frac{\partial f}{\partial s} \\ \frac{\partial f}{\partial t} \end{pmatrix}
= \begin{pmatrix} \frac{\partial x}{\partial s} & \frac{\partial y}{\partial s} \\ \frac{\partial x}{\partial t} & \frac{\partial y}{\partial t} \end{pmatrix}
\begin{pmatrix} \frac{\partial f}{\partial x} \\ \frac{\partial f}{\partial y} \end{pmatrix}
$$</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ì—°ì‡„ë²•ì¹™ ì˜ˆì œ: ê·¹ì¢Œí‘œ ë³€í™˜</span>
<span class="n">r</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r theta&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_expr</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y_expr</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="c1"># f(x,y) = xÂ² + yÂ² ë¥¼ ê·¹ì¢Œí‘œë¡œ í‘œí˜„</span>
<span class="n">f_xy</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">f_polar</span> <span class="o">=</span> <span class="n">f_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_expr</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_expr</span><span class="p">)])</span>
<span class="n">f_polar_simplified</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">f_polar</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f(x,y) = </span><span class="si">{</span><span class="n">f_xy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f(r,Î¸) = </span><span class="si">{</span><span class="n">f_polar_simplified</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># rÂ²</span>

<span class="c1"># ì—°ì‡„ë²•ì¹™ìœ¼ë¡œ âˆ‚f/âˆ‚r ê³„ì‚°</span>
<span class="n">df_dr_chain</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_xy</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_expr</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_expr</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_expr</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">+</span> \
              <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_xy</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_expr</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_expr</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_expr</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="n">df_dr_direct</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_polar_simplified</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì—°ì‡„ë²•ì¹™: âˆ‚f/âˆ‚r = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">df_dr_chain</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì§ì ‘ ë¯¸ë¶„: âˆ‚f/âˆ‚r = </span><span class="si">{</span><span class="n">df_dr_direct</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ì•¼ì½”ë¹„ì•ˆ</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_expr</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_expr</span><span class="p">,</span> <span class="n">theta</span><span class="p">)],</span>
               <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_expr</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_expr</span><span class="p">,</span> <span class="n">theta</span><span class="p">)]])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì•¼ì½”ë¹„ì•ˆ J =</span><span class="se">\n</span><span class="si">{</span><span class="n">J</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;det(J) = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">det</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># r (ê·¹ì¢Œí‘œ ì•¼ì½”ë¹„ì•ˆ)</span>
</code></pre></div>

<h3 id="22-implicit-differentiation">2.2 Implicit Differentiation<a class="header-link" href="#22-implicit-differentiation" title="Permanent link">&para;</a></h3>
<p>When $y$ is implicitly defined as a function of $x$ by $F(x, y) = 0$:</p>
<p>$$
\frac{dy}{dx} = -\frac{\partial F / \partial x}{\partial F / \partial y} = -\frac{F_x}{F_y}
$$</p>
<p><strong>Derivation</strong>: Differentiating both sides of $F(x, y(x)) = 0$ with respect to $x$:</p>
<p>$$
\frac{\partial F}{\partial x} + \frac{\partial F}{\partial y}\frac{dy}{dx} = 0
$$</p>
<p><strong>Extension to three variables</strong>: If $z = z(x, y)$ from $F(x, y, z) = 0$:</p>
<p>$$
\frac{\partial z}{\partial x} = -\frac{F_x}{F_z}, \qquad \frac{\partial z}{\partial y} = -\frac{F_y}{F_z}
$$</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ìŒí•¨ìˆ˜ ë¯¸ë¶„ ì˜ˆì œ: íƒ€ì› xÂ²/4 + yÂ²/9 = 1</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">dy_dx</span> <span class="o">=</span> <span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F(x,y) = </span><span class="si">{</span><span class="n">F</span><span class="si">}</span><span class="s2"> = 0&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dy/dx = </span><span class="si">{</span><span class="n">dy_dx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">dy_dx</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ê²€ì¦: y = 3âˆš(1 - xÂ²/4) ë¥¼ ì§ì ‘ ë¯¸ë¶„</span>
<span class="n">y_explicit</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">dy_dx_explicit</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_explicit</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ëª…ì‹œì  ë¯¸ë¶„: dy/dx = </span><span class="si">{</span><span class="n">dy_dx_explicit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê°„ì†Œí™”: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">dy_dx_explicit</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ìˆœí™˜ ê´€ê³„ (cyclic relation)</span>
<span class="c1"># F(x,y,z) = 0ì¼ ë•Œ:</span>
<span class="c1"># (âˆ‚x/âˆ‚y)_z (âˆ‚y/âˆ‚z)_x (âˆ‚z/âˆ‚x)_y = -1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== ìˆœí™˜ ê´€ê³„ (ì´ìƒê¸°ì²´) ===&quot;</span><span class="p">)</span>
<span class="c1"># PV = nRT â†’ F(P,V,T) = PV - nRT = 0</span>
<span class="n">P_sym</span><span class="p">,</span> <span class="n">V_sym</span><span class="p">,</span> <span class="n">T_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;P V T&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">F_gas</span> <span class="o">=</span> <span class="n">P_sym</span> <span class="o">*</span> <span class="n">V_sym</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T_sym</span>

<span class="n">dP_dV_T</span> <span class="o">=</span> <span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_gas</span><span class="p">,</span> <span class="n">V_sym</span><span class="p">)</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_gas</span><span class="p">,</span> <span class="n">P_sym</span><span class="p">)</span>  <span class="c1"># (âˆ‚P/âˆ‚V)_T</span>
<span class="n">dV_dT_P</span> <span class="o">=</span> <span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_gas</span><span class="p">,</span> <span class="n">T_sym</span><span class="p">)</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_gas</span><span class="p">,</span> <span class="n">V_sym</span><span class="p">)</span>  <span class="c1"># (âˆ‚V/âˆ‚T)_P</span>
<span class="n">dT_dP_V</span> <span class="o">=</span> <span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_gas</span><span class="p">,</span> <span class="n">P_sym</span><span class="p">)</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_gas</span><span class="p">,</span> <span class="n">T_sym</span><span class="p">)</span>  <span class="c1"># (âˆ‚T/âˆ‚P)_V</span>

<span class="n">product</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">dP_dV_T</span> <span class="o">*</span> <span class="n">dV_dT_P</span> <span class="o">*</span> <span class="n">dT_dP_V</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(âˆ‚P/âˆ‚V)_T = </span><span class="si">{</span><span class="n">dP_dV_T</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(âˆ‚V/âˆ‚T)_P = </span><span class="si">{</span><span class="n">dV_dT_P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(âˆ‚T/âˆ‚P)_V = </span><span class="si">{</span><span class="n">dT_dP_V</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê³± = </span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># -1</span>
</code></pre></div>

<hr />
<h2 id="3-extrema-and-saddle-points">3. Extrema and Saddle Points<a class="header-link" href="#3-extrema-and-saddle-points" title="Permanent link">&para;</a></h2>
<h3 id="31-necessary-condition-for-extrema">3.1 Necessary Condition for Extrema<a class="header-link" href="#31-necessary-condition-for-extrema" title="Permanent link">&para;</a></h3>
<p>A <strong>critical point</strong> of a multivariable function $f(x, y)$: $\nabla f = 0$</p>
<p>$$
\frac{\partial f}{\partial x} = 0, \quad \frac{\partial f}{\partial y} = 0
$$</p>
<h3 id="32-second-derivative-test">3.2 Second Derivative Test<a class="header-link" href="#32-second-derivative-test" title="Permanent link">&para;</a></h3>
<p>At a critical point $(x_0, y_0)$, the <strong>Hessian matrix</strong>:</p>
<p>$$
H = \begin{pmatrix} f_{xx} & f_{xy} \\ f_{yx} & f_{yy} \end{pmatrix}
$$</p>
<p><strong>Discriminant</strong>:</p>
<p>$$
D = f_{xx} f_{yy} - (f_{xy})^2 = \det(H)
$$</p>
<table>
<thead>
<tr>
<th>Condition</th>
<th>Conclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td>$D > 0$, $f_{xx} > 0$</td>
<td><strong>Local minimum</strong></td>
</tr>
<tr>
<td>$D > 0$, $f_{xx} < 0$</td>
<td><strong>Local maximum</strong></td>
</tr>
<tr>
<td>$D < 0$</td>
<td><strong>Saddle point</strong></td>
</tr>
<tr>
<td>$D = 0$</td>
<td>Test inconclusive (higher order needed)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Connection to positive definiteness: $D > 0$ and $f_{xx} > 0$ is equivalent to the Hessian $H$ being positive definite. This means the quadratic form $\frac{1}{2}\delta\mathbf{x}^T H \delta\mathbf{x} > 0$, hence a minimum.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>

<span class="c1"># ì•ˆì¥ì ì„ í¬í•¨í•˜ëŠ” í•¨ìˆ˜</span>
<span class="n">f_saddle</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># ìŒê³¡ í¬ë¬¼ë©´</span>

<span class="c1"># ì„ê³„ì  ì°¾ê¸°</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_saddle</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fy</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_saddle</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">critical</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f(x,y) = </span><span class="si">{</span><span class="n">f_saddle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì„ê³„ì : </span><span class="si">{</span><span class="n">critical</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># í—¤ì‹œì•ˆ</span>
<span class="n">fxx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_saddle</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fxy</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_saddle</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">fyy</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_saddle</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">fxx</span> <span class="o">*</span> <span class="n">fyy</span> <span class="o">-</span> <span class="n">fxy</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">H = [[</span><span class="si">{</span><span class="n">fxx</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">fxy</span><span class="si">}</span><span class="s2">], [</span><span class="si">{</span><span class="n">fxy</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">fyy</span><span class="si">}</span><span class="s2">]]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;D = </span><span class="si">{</span><span class="n">D</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;D &lt; 0 â†’ ì•ˆì¥ì &quot;</span><span class="p">)</span>

<span class="c1"># ë‹¤ë¥¸ ì˜ˆ: ê·¹ì†Œ, ê·¹ëŒ€, ì•ˆì¥ì ì„ ëª¨ë‘ ê°€ì§„ í•¨ìˆ˜</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># ì›ìˆ­ì´ ì•ˆì¥ (monkey saddle)</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># ë‘ ê·¹ì†Œ, ë‘ ì•ˆì¥ì </span>

<span class="c1"># 3D ì‹œê°í™”</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Y_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X_mesh</span><span class="p">,</span> <span class="n">Y_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">Y_grid</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ê·¹ì†Œ: xÂ² + yÂ²</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">Z1</span> <span class="o">=</span> <span class="n">X_mesh</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y_mesh</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X_mesh</span><span class="p">,</span> <span class="n">Y_mesh</span><span class="p">,</span> <span class="n">Z1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê·¹ì†Œ: f = xÂ² + yÂ²&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="c1"># ì•ˆì¥ì : xÂ² - yÂ²</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">X_mesh</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Y_mesh</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X_mesh</span><span class="p">,</span> <span class="n">Y_mesh</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì•ˆì¥ì : f = xÂ² - yÂ²&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="c1"># ê·¹ëŒ€: -(xÂ² + yÂ²)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">Z3</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">X_mesh</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y_mesh</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X_mesh</span><span class="p">,</span> <span class="n">Y_mesh</span><span class="p">,</span> <span class="n">Z3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê·¹ëŒ€: f = -(xÂ² + yÂ²)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;critical_points.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="33-practical-example-distance-minimization">3.3 Practical Example: Distance Minimization<a class="header-link" href="#33-practical-example-distance-minimization" title="Permanent link">&para;</a></h3>
<p>Problem of minimizing the distance from point $(x, y, z)$ to plane $2x + y - z = 5$.</p>
<p>Method 1: Minimize the squared distance $d^2 = (x-a)^2 + (y-b)^2 + (z-c)^2$ (covered in the next section on Lagrange multipliers)</p>
<p>Method 2: Use the distance formula directly $d = |2x + y - z - 5| / \sqrt{4 + 1 + 1}$</p>
<hr />
<h2 id="4-lagrange-multipliers">4. Lagrange Multipliers<a class="header-link" href="#4-lagrange-multipliers" title="Permanent link">&para;</a></h2>
<h3 id="41-optimization-with-equality-constraints">4.1 Optimization with Equality Constraints<a class="header-link" href="#41-optimization-with-equality-constraints" title="Permanent link">&para;</a></h3>
<p><strong>Problem</strong>: Find the extrema of $f(x, y)$ subject to the constraint $g(x, y) = 0$.</p>
<p><strong>Lagrange function</strong>:</p>
<p>$$
\mathcal{L}(x, y, \lambda) = f(x, y) - \lambda \, g(x, y)
$$</p>
<p><strong>Necessary conditions</strong>:</p>
<p>$$
\frac{\partial \mathcal{L}}{\partial x} = 0, \quad \frac{\partial \mathcal{L}}{\partial y} = 0, \quad \frac{\partial \mathcal{L}}{\partial \lambda} = 0
$$</p>
<p>The third condition is the constraint $g = 0$ itself.</p>
<p><strong>Geometric meaning</strong>: At an extremum, $\nabla f$ and $\nabla g$ are <strong>parallel</strong>, i.e., $\nabla f = \lambda \nabla g$.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ì˜ˆì œ: ì› xÂ² + yÂ² = 1 ìœ„ì—ì„œ f(x,y) = x + yì˜ ìµœëŒ“ê°’</span>
<span class="n">lam</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;lambda&#39;</span><span class="p">)</span>

<span class="n">f_obj</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">g_constraint</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">f_obj</span> <span class="o">-</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">g_constraint</span>

<span class="c1"># ì—°ë¦½ë°©ì •ì‹</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">lam</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë¼ê·¸ë‘ì£¼ ì¡°ê±´:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">eqs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">eq</span><span class="si">}</span><span class="s2"> = 0&quot;</span><span class="p">)</span>

<span class="n">solutions</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lam</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í•´: </span><span class="si">{</span><span class="n">solutions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">solutions</span><span class="p">:</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">f_obj</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  (</span><span class="si">{</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">): f = </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">, Î» = </span><span class="si">{</span><span class="n">sol</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="42-multiple-constraints">4.2 Multiple Constraints<a class="header-link" href="#42-multiple-constraints" title="Permanent link">&para;</a></h3>
<p>With $m$ constraints $g_1 = 0, g_2 = 0, \ldots, g_m = 0$:</p>
<p>$$
\mathcal{L} = f - \lambda_1 g_1 - \lambda_2 g_2 - \cdots - \lambda_m g_m
$$</p>
<p><strong>Physics Application: Entropy Maximization</strong></p>
<p>In statistical mechanics, the <strong>Boltzmann distribution</strong> is the solution to the following optimization problem:</p>
<ul>
<li>Maximize: Entropy $S = -k_B \sum p_i \ln p_i$</li>
<li>Constraint 1: $\sum p_i = 1$ (normalization of probabilities)</li>
<li>Constraint 2: $\sum p_i E_i = \langle E \rangle$ (fixed average energy)</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># ë¼ê·¸ë‘ì£¼ ìŠ¹ìˆ˜ë²•ìœ¼ë¡œ ë³¼ì¸ ë§Œ ë¶„í¬ ìœ ë„ (ì´ì‚° ê²½ìš°)</span>
<span class="c1"># 3ê°œ ì—ë„ˆì§€ ì¤€ìœ„ Eâ‚=0, Eâ‚‚=1, Eâ‚ƒ=2</span>
<span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p1 p2 p3&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lam1</span><span class="p">,</span> <span class="n">lam2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;lambda1 lambda2&#39;</span><span class="p">)</span>

<span class="n">E_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">]</span>

<span class="c1"># ì—”íŠ¸ë¡œí”¼ (ë¶€í˜¸ ë°˜ì „í•˜ì—¬ ìµœì†Œí™”ë¡œ ë³€í™˜)</span>
<span class="n">S</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probs</span><span class="p">)</span>  <span class="c1"># ìµœì†Œí™”í•  ê²ƒ (-S)</span>

<span class="c1"># êµ¬ì† ì¡°ê±´</span>
<span class="n">g1</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">+</span> <span class="n">p3</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">g2</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">p1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">p2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">p3</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;E_avg&#39;</span><span class="p">)</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">S</span> <span class="o">+</span> <span class="n">lam1</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">lam2</span> <span class="o">*</span> <span class="n">g2</span>

<span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probs</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">g1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë¼ê·¸ë‘ì£¼ ì¡°ê±´ (âˆ‚L/âˆ‚páµ¢ = 0):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">eq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eqs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ln(p</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">) + 1 + Î»â‚ + </span><span class="si">{</span><span class="n">E_levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">Î»â‚‚ = 0&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">â†’ páµ¢ âˆ exp(-Î»â‚‚ Eáµ¢) : ë³¼ì¸ ë§Œ ë¶„í¬!&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="43-numerical-optimization-with-scipy">4.3 Numerical Optimization with SciPy<a class="header-link" href="#43-numerical-optimization-with-scipy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>

<span class="c1"># íƒ€ì› xÂ²/4 + yÂ²/9 = 1 ìœ„ì—ì„œ ì›ì ìœ¼ë¡œë¶€í„° ìµœëŒ€/ìµœì†Œ ê±°ë¦¬</span>
<span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># ìµœëŒ€í™” â†’ ë¶€í˜¸ ë°˜ì „</span>

<span class="k">def</span><span class="w"> </span><span class="nf">constraint</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># = 0</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="n">constraints</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">constraint</span><span class="p">},</span>
                  <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;íƒ€ì› ìœ„ ì›ì ì—ì„œ ê°€ì¥ ë¨¼ ì : (</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìµœëŒ€ ê±°ë¦¬: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ê°€ì¥ ê°€ê¹Œìš´ ì </span>
<span class="n">result_min</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">xy</span><span class="p">:</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
                       <span class="n">constraints</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">constraint</span><span class="p">},</span>
                       <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;íƒ€ì› ìœ„ ì›ì ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ì : (</span><span class="si">{</span><span class="n">result_min</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">result_min</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìµœì†Œ ê±°ë¦¬: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">result_min</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5-exact-differentials-and-thermodynamics">5. Exact Differentials and Thermodynamics<a class="header-link" href="#5-exact-differentials-and-thermodynamics" title="Permanent link">&para;</a></h2>
<h3 id="51-condition-for-exact-differentials">5.1 Condition for Exact Differentials<a class="header-link" href="#51-condition-for-exact-differentials" title="Permanent link">&para;</a></h3>
<p>For a differential form $M(x,y)\,dx + N(x,y)\,dy$ to be an <strong>exact differential</strong>, i.e., for there to exist a function $f$ such that $df = M\,dx + N\,dy$:</p>
<p>$$
\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}
$$</p>
<p>This is a direct consequence of <strong>Schwarz's theorem</strong>: If $M = \partial f / \partial x$, $N = \partial f / \partial y$, then $\partial M / \partial y = \partial^2 f / \partial y \partial x = \partial^2 f / \partial x \partial y = \partial N / \partial x$.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ì™„ì „ë¯¸ë¶„ íŒë³„ ì˜ˆì œ</span>
<span class="c1"># (2xy + 3)dx + (xÂ² + 4y)dy</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span>

<span class="n">dM_dy</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">dN_dx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M = </span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2">, N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‚M/âˆ‚y = </span><span class="si">{</span><span class="n">dM_dy</span><span class="si">}</span><span class="s2">, âˆ‚N/âˆ‚x = </span><span class="si">{</span><span class="n">dN_dx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì™„ì „ë¯¸ë¶„: </span><span class="si">{</span><span class="n">dM_dy</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">dN_dx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># í¬í…ì…œ í•¨ìˆ˜ f êµ¬í•˜ê¸°</span>
<span class="c1"># f = âˆ«M dx = xÂ²y + 3x + h(y)</span>
<span class="c1"># âˆ‚f/âˆ‚y = xÂ² + h&#39;(y) = N = xÂ² + 4y</span>
<span class="c1"># â†’ h&#39;(y) = 4y â†’ h(y) = 2yÂ²</span>
<span class="n">f_potential</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í¬í…ì…œ í•¨ìˆ˜: f = </span><span class="si">{</span><span class="n">f_potential</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²€ì¦: âˆ‚f/âˆ‚x = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_potential</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2"> (= M)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²€ì¦: âˆ‚f/âˆ‚y = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_potential</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2"> (= N)&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="52-thermodynamics-and-maxwell-relations">5.2 Thermodynamics and Maxwell Relations<a class="header-link" href="#52-thermodynamics-and-maxwell-relations" title="Permanent link">&para;</a></h3>
<p>Combining the first and second laws of thermodynamics:</p>
<p>$$
dU = TdS - PdV
$$</p>
<p>Since this is an exact differential ($U = U(S, V)$):</p>
<p>$$
T = \left(\frac{\partial U}{\partial S}\right)_V, \quad -P = \left(\frac{\partial U}{\partial V}\right)_S
$$</p>
<p>From the condition for exact differentials $\partial^2 U / \partial V \partial S = \partial^2 U / \partial S \partial V$:</p>
<p>$$
\left(\frac{\partial T}{\partial V}\right)_S = -\left(\frac{\partial P}{\partial S}\right)_V
$$</p>
<p>This is one of the <strong>Maxwell relations</strong>.</p>
<p><strong>Four thermodynamic potentials and Maxwell relations</strong>:</p>
<table>
<thead>
<tr>
<th>Potential</th>
<th>Differential</th>
<th>Maxwell Relation</th>
</tr>
</thead>
<tbody>
<tr>
<td>$U(S,V)$</td>
<td>$dU = TdS - PdV$</td>
<td>$\left(\frac{\partial T}{\partial V}\right)_S = -\left(\frac{\partial P}{\partial S}\right)_V$</td>
</tr>
<tr>
<td>$H(S,P)$</td>
<td>$dH = TdS + VdP$</td>
<td>$\left(\frac{\partial T}{\partial P}\right)_S = \left(\frac{\partial V}{\partial S}\right)_P$</td>
</tr>
<tr>
<td>$F(T,V)$</td>
<td>$dF = -SdT - PdV$</td>
<td>$\left(\frac{\partial S}{\partial V}\right)_T = \left(\frac{\partial P}{\partial T}\right)_V$</td>
</tr>
<tr>
<td>$G(T,P)$</td>
<td>$dG = -SdT + VdP$</td>
<td>$-\left(\frac{\partial S}{\partial P}\right)_T = \left(\frac{\partial V}{\partial T}\right)_P$</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Mnemonic (Born square)</strong>: By placing internal energy at the vertices and natural variables at the edges, you can systematically derive Maxwell relations.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1"># ë§¥ìŠ¤ì›° ê´€ê³„ì‹ ê²€ì¦ (ì´ìƒê¸°ì²´)</span>
<span class="c1"># PV = nRT â†’ P = nRT/V</span>
<span class="n">S</span><span class="p">,</span> <span class="n">V_td</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;S V&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">k</span><span class="p">,</span> <span class="n">N_a</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;k N_A&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ì´ìƒê¸°ì²´ì˜ ë‚´ë¶€ ì—ë„ˆì§€: U = (3/2)nRT = (3/2)nR * T(S,V)</span>
<span class="c1"># ê°„ë‹¨í•œ ëª¨ë¸: U(S,V) = A * exp(2S/3nR) * V^(-2/3)</span>
<span class="c1"># ì—¬ê¸°ì„œëŠ” ë§¥ìŠ¤ì›° ê´€ê³„ì‹ì˜ êµ¬ì¡°ë§Œ í™•ì¸</span>

<span class="c1"># í—¬ë¦„í™€ì¸  ììœ ì—ë„ˆì§€ F(T,V)ì—ì„œ</span>
<span class="c1"># dF = -SdT - PdV</span>
<span class="c1"># ì´ìƒê¸°ì²´: F = nRT(1 - ln(T/Tâ‚€)) - nRT ln(V/Vâ‚€) + const</span>

<span class="n">T_td</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">F_ideal</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T_td</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">T_td</span><span class="p">))</span> <span class="o">-</span> <span class="n">n</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T_td</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">V_td</span><span class="p">)</span>

<span class="n">S_from_F</span> <span class="o">=</span> <span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_ideal</span><span class="p">,</span> <span class="n">T_td</span><span class="p">)</span>
<span class="n">P_from_F</span> <span class="o">=</span> <span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">F_ideal</span><span class="p">,</span> <span class="n">V_td</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F = </span><span class="si">{</span><span class="n">F_ideal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;S = -âˆ‚F/âˆ‚T = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">S_from_F</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P = -âˆ‚F/âˆ‚V = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">P_from_F</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ë§¥ìŠ¤ì›°: (âˆ‚S/âˆ‚V)_T = (âˆ‚P/âˆ‚T)_V</span>
<span class="n">dS_dV</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">S_from_F</span><span class="p">,</span> <span class="n">V_td</span><span class="p">)</span>
<span class="n">dP_dT</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P_from_F</span><span class="p">,</span> <span class="n">T_td</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">(âˆ‚S/âˆ‚V)_T = </span><span class="si">{</span><span class="n">dS_dV</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(âˆ‚P/âˆ‚T)_V = </span><span class="si">{</span><span class="n">dP_dT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë§¥ìŠ¤ì›° ê´€ê³„ ì„±ë¦½: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">dS_dV</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dP_dT</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-multivariate-taylor-series">6. Multivariate Taylor Series<a class="header-link" href="#6-multivariate-taylor-series" title="Permanent link">&para;</a></h2>
<h3 id="61-two-variable-taylor-expansion">6.1 Two-Variable Taylor Expansion<a class="header-link" href="#61-two-variable-taylor-expansion" title="Permanent link">&para;</a></h3>
<p>Expansion of $f(x, y)$ near the point $(a, b)$:</p>
<p>$$
f(x, y) = f(a, b) + f_x(a,b)(x-a) + f_y(a,b)(y-b) \\
+ \frac{1}{2!}\left[f_{xx}(x-a)^2 + 2f_{xy}(x-a)(y-b) + f_{yy}(y-b)^2\right] + \cdots
$$</p>
<p><strong>Vector notation</strong>: $\mathbf{x}_0 = (a, b)$, $\delta\mathbf{x} = (x-a, y-b)$</p>
<p>$$
f(\mathbf{x}_0 + \delta\mathbf{x}) = f(\mathbf{x}_0) + \nabla f \cdot \delta\mathbf{x} + \frac{1}{2} \delta\mathbf{x}^T H \, \delta\mathbf{x} + \cdots
$$</p>
<p>where $H$ is the Hessian matrix.</p>
<h3 id="62-physics-approximations">6.2 Physics Approximations<a class="header-link" href="#62-physics-approximations" title="Permanent link">&para;</a></h3>
<p><strong>Small-amplitude approximation</strong>: Potential energy of a pendulum $U(\theta) = mgl(1 - \cos\theta)$ near $\theta = 0$:</p>
<p>$$
U \approx mgl \cdot \frac{\theta^2}{2} + O(\theta^4) \quad (\text{harmonic oscillator})
$$</p>
<p><strong>Multivariable function approximation</strong>: $f(x, y) = e^{x}\sin(y)$ near the origin:</p>
<p>$$
f \approx y + xy + \frac{1}{2}(y - \frac{y^3}{6} + \cdots) \approx y + xy - \frac{y^3}{6} + \cdots
$$</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ë‹¤ë³€ìˆ˜ í…Œì¼ëŸ¬ ê¸‰ìˆ˜</span>
<span class="n">f_taylor</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># ì›ì ì—ì„œ 3ì°¨ê¹Œì§€ ì „ê°œ</span>
<span class="n">taylor_2d</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">f_taylor</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f = exp(x)sin(y)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í…Œì¼ëŸ¬ (3ì°¨): </span><span class="si">{</span><span class="n">taylor_2d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># SymPyì˜ ë‹¤ë³€ìˆ˜ í…Œì¼ëŸ¬</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">O</span>
<span class="c1"># ìˆ˜ë™ ì „ê°œ</span>
<span class="n">f0</span> <span class="o">=</span> <span class="n">f_taylor</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">fx0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_taylor</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">fy0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_taylor</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">fxx0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_taylor</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">fxy0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_taylor</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">fyy0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f_taylor</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>

<span class="n">T2</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">+</span> <span class="n">fx0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">fy0</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fxx0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">fxy0</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">fyy0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2ì°¨ í…Œì¼ëŸ¬: </span><span class="si">{</span><span class="n">T2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ê·¼ì‚¬ ì •í™•ë„ ë¹„êµ</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">X_mesh</span><span class="p">,</span> <span class="n">Y_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>

<span class="n">Z_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">X_mesh</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Y_mesh</span><span class="p">)</span>
<span class="n">Z_approx</span> <span class="o">=</span> <span class="n">Y_mesh</span> <span class="o">+</span> <span class="n">X_mesh</span><span class="o">*</span><span class="n">Y_mesh</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">X_mesh</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Y_mesh</span><span class="p">)</span>  <span class="c1"># ì£¼ìš” í•­</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Z_exact</span><span class="p">,</span> <span class="s1">&#39;ì •í™•í•œ ê°’&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Z_approx</span><span class="p">,</span> <span class="s1">&#39;2ì°¨ ê·¼ì‚¬&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Z_exact</span> <span class="o">-</span> <span class="n">Z_approx</span><span class="p">,</span> <span class="s1">&#39;ì˜¤ì°¨&#39;</span><span class="p">)]:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X_mesh</span><span class="p">,</span> <span class="n">Y_mesh</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;taylor_2d.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7-change-of-variables-and-jacobian">7. Change of Variables and Jacobian<a class="header-link" href="#7-change-of-variables-and-jacobian" title="Permanent link">&para;</a></h2>
<h3 id="71-jacobian-matrix-and-determinant">7.1 Jacobian Matrix and Determinant<a class="header-link" href="#71-jacobian-matrix-and-determinant" title="Permanent link">&para;</a></h3>
<p>The <strong>Jacobian matrix</strong> of a coordinate transformation $(x, y) \to (u, v)$:</p>
<p>$$
J = \frac{\partial(x, y)}{\partial(u, v)} = \begin{pmatrix} \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\ \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v} \end{pmatrix}
$$</p>
<p><strong>Jacobian</strong> (determinant): $\left|\frac{\partial(x, y)}{\partial(u, v)}\right| = \det(J)$</p>
<p><strong>Change of variables in multiple integrals</strong>:</p>
<p>$$
\iint f(x, y) \, dx \, dy = \iint f(x(u,v), y(u,v)) \left|\frac{\partial(x, y)}{\partial(u, v)}\right| du \, dv
$$</p>
<h3 id="72-jacobians-of-common-coordinate-transformations">7.2 Jacobians of Common Coordinate Transformations<a class="header-link" href="#72-jacobians-of-common-coordinate-transformations" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Transformation</th>
<th>Jacobian</th>
</tr>
</thead>
<tbody>
<tr>
<td>Polar $(r, \theta)$</td>
<td>$r$</td>
</tr>
<tr>
<td>Cylindrical $(r, \theta, z)$</td>
<td>$r$</td>
</tr>
<tr>
<td>Spherical $(r, \theta, \phi)$</td>
<td>$r^2 \sin\theta$</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># ì•¼ì½”ë¹„ì•ˆ ê³„ì‚° ì˜ˆì œ</span>
<span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r theta phi&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># êµ¬ë©´ì¢Œí‘œ â†’ ì§êµì¢Œí‘œ</span>
<span class="n">x_sph</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">y_sph</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">z_sph</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">J_spherical</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
    <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_sph</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_sph</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_sph</span><span class="p">,</span> <span class="n">phi</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_sph</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_sph</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_sph</span><span class="p">,</span> <span class="n">phi</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z_sph</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z_sph</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z_sph</span><span class="p">,</span> <span class="n">phi</span><span class="p">)]</span>
<span class="p">])</span>

<span class="n">jacobian_det</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">J_spherical</span><span class="o">.</span><span class="n">det</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;êµ¬ë©´ì¢Œí‘œ ì•¼ì½”ë¹„ì•ˆ í–‰ë ¬:&quot;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">J_spherical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">|J| = </span><span class="si">{</span><span class="n">jacobian_det</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># rÂ² sin(Î¸)</span>

<span class="c1"># ì²´ì  ìš”ì†Œ</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">dV = |J| dr dÎ¸ dÏ† = </span><span class="si">{</span><span class="n">jacobian_det</span><span class="si">}</span><span class="s2"> dr dÎ¸ dÏ†&quot;</span><span class="p">)</span>

<span class="c1"># ì‘ìš©: êµ¬ì˜ ì²´ì </span>
<span class="c1"># V = âˆ«â‚€^a âˆ«â‚€^Ï€ âˆ«â‚€^{2Ï€} rÂ² sin(Î¸) dÏ† dÎ¸ dr</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">volume</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span>
    <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">)),</span>
    <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">êµ¬ì˜ ì²´ì  = </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (4/3)Ï€aÂ³</span>
</code></pre></div>

<hr />
<h2 id="exercises">Exercises<a class="header-link" href="#exercises" title="Permanent link">&para;</a></h2>
<h3 id="basic-problems">Basic Problems<a class="header-link" href="#basic-problems" title="Permanent link">&para;</a></h3>
<p><strong>1.</strong> Find all first and second partial derivatives of $f(x, y) = x^3 y^2 + \sin(xy)$ and verify that $\frac{\partial^2 f}{\partial x \partial y} = \frac{\partial^2 f}{\partial y \partial x}$.</p>
<p><strong>2.</strong> Express the Laplacian $\nabla^2 f = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2}$ in polar coordinates $(r, \theta)$ in terms of $r$ and $\theta$.</p>
<p><strong>3.</strong> Find all critical points of $f(x, y) = x^3 + y^3 - 3xy$ and classify each type (maximum/minimum/saddle point).</p>
<h3 id="applied-problems">Applied Problems<a class="header-link" href="#applied-problems" title="Permanent link">&para;</a></h3>
<p><strong>4.</strong> Using the Lagrange multiplier method, find the maximum and minimum values of $f(x, y, z) = x + 2y + 3z$ on the sphere $x^2 + y^2 + z^2 = 1$.</p>
<p><strong>5.</strong> For the van der Waals equation $(P + a/V^2)(V - b) = RT$, find $\left(\frac{\partial P}{\partial T}\right)_V$ and $\left(\frac{\partial V}{\partial T}\right)_P$.</p>
<p><strong>6.</strong> Calculate the three-dimensional Gaussian integral $\iiint e^{-(ax^2 + by^2 + cz^2)} \, dx \, dy \, dz$ (integration domain: all space) using spherical coordinate transformation and the Jacobian. (Hint: separate after principal axis transformation)</p>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Boas, <em>Mathematical Methods in the Physical Sciences</em>, Chapter 4</li>
<li>Arfken &amp; Weber, <em>Mathematical Methods for Physicists</em>, Chapter 1</li>
<li>Callen, <em>Thermodynamics and an Introduction to Thermostatistics</em> (Maxwell relations)</li>
<li>Previous lesson: <a href="./03_Linear_Algebra.md">03. Linear Algebra</a> (matrices, quadratic forms)</li>
<li>Next lesson: <a href="./05_Vector_Analysis.md">05. Vector Analysis</a></li>
</ul>
<hr />
<h2 id="next-lesson">Next Lesson<a class="header-link" href="#next-lesson" title="Permanent link">&para;</a></h2>
<p><a href="./05_Vector_Analysis.md">05. Vector Analysis</a> covers gradient, divergence, curl operators and integral theorems in depth.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/03_Linear_Algebra.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">03. Linear Algebra</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/05_Vector_Analysis.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">05. Vector Analysis</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}