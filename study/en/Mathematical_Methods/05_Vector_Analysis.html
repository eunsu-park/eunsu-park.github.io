{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>05. Vector Analysis - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Mathematical_Methods/">Mathematical Methods</a>
    <span class="separator">/</span>
    <span class="current">05. Vector Analysis</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>05. Vector Analysis</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/04_Partial_Differentiation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">04. Partial Differentiation</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/06_Curvilinear_Coordinates.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">06. Curvilinear Coordinates and Multiple Integrals</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-vector-differential-operators">1. Vector Differential Operators</a><ul>
<li><a href="#11-gradient-f">1.1 Gradient (âˆ‡f)</a></li>
<li><a href="#12-divergence-f">1.2 Divergence (âˆ‡Â·F)</a></li>
<li><a href="#13-curl-f">1.3 Curl (âˆ‡Ã—F)</a></li>
<li><a href="#14-laplacian-2">1.4 Laplacian (âˆ‡Â²)</a></li>
<li><a href="#15-vector-identities">1.5 Vector Identities</a></li>
</ul>
</li>
<li><a href="#2-line-integrals">2. Line Integrals</a><ul>
<li><a href="#21-line-integral-of-a-scalar-field">2.1 Line Integral of a Scalar Field</a></li>
<li><a href="#22-line-integral-of-a-vector-field-work">2.2 Line Integral of a Vector Field (Work)</a></li>
<li><a href="#23-conservative-fields-and-potential-functions">2.3 Conservative Fields and Potential Functions</a></li>
</ul>
</li>
<li><a href="#3-surface-integrals">3. Surface Integrals</a><ul>
<li><a href="#31-surface-element-and-normal-vector">3.1 Surface Element and Normal Vector</a></li>
<li><a href="#32-surface-integral-of-a-scalar-field">3.2 Surface Integral of a Scalar Field</a></li>
<li><a href="#33-surface-integral-of-a-vector-field-flux">3.3 Surface Integral of a Vector Field (Flux)</a></li>
</ul>
</li>
<li><a href="#4-integral-theorems">4. Integral Theorems</a><ul>
<li><a href="#41-greens-theorem">4.1 Green's Theorem</a></li>
<li><a href="#42-stokes-theorem">4.2 Stokes' Theorem</a></li>
<li><a href="#43-divergence-theorem-gausss-theorem">4.3 Divergence Theorem (Gauss's Theorem)</a></li>
<li><a href="#44-relationship-between-the-three-theorems">4.4 Relationship Between the Three Theorems</a></li>
</ul>
</li>
<li><a href="#5-physical-applications">5. Physical Applications</a><ul>
<li><a href="#51-electric-field-and-gausss-law">5.1 Electric Field and Gauss's Law</a></li>
<li><a href="#52-magnetic-field-and-amperes-law">5.2 Magnetic Field and AmpÃ¨re's Law</a></li>
<li><a href="#53-continuity-equation-in-fluid-dynamics">5.3 Continuity Equation in Fluid Dynamics</a></li>
<li><a href="#54-maxwells-equations-integral-and-differential-forms">5.4 Maxwell's Equations: Integral and Differential Forms</a></li>
</ul>
</li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-gradient-and-directional-derivative">Problem 1: Gradient and Directional Derivative</a></li>
<li><a href="#problem-2-divergence-and-curl">Problem 2: Divergence and Curl</a></li>
<li><a href="#problem-3-line-integrals">Problem 3: Line Integrals</a></li>
<li><a href="#problem-4-divergence-theorem-verification">Problem 4: Divergence Theorem Verification</a></li>
<li><a href="#problem-5-stokes-theorem-and-physical-application">Problem 5: Stokes' Theorem and Physical Application</a></li>
<li><a href="#problem-6-maxwell-equation-transformation">Problem 6: Maxwell Equation Transformation</a></li>
</ul>
</li>
<li><a href="#references">References</a><ul>
<li><a href="#textbooks">Textbooks</a></li>
<li><a href="#online-resources">Online Resources</a></li>
<li><a href="#python-tools">Python Tools</a></li>
</ul>
</li>
<li><a href="#next-lesson">Next Lesson</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="05-vector-analysis">05. Vector Analysis<a class="header-link" href="#05-vector-analysis" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Understand the physical meaning of gradient, divergence, and curl operators and be able to calculate them</li>
<li>Perform line integrals and surface integrals, and explain the criteria for conservative fields</li>
<li>State and apply Green's theorem, Stokes' theorem, and the divergence theorem</li>
<li>Convert Maxwell's equations between integral and differential forms</li>
<li>Visualize vector fields using Python (SymPy, Matplotlib) and numerically compute line/surface integrals</li>
</ul>
<hr />
<h2 id="1-vector-differential-operators">1. Vector Differential Operators<a class="header-link" href="#1-vector-differential-operators" title="Permanent link">&para;</a></h2>
<p>Vector differential operators are essential tools for describing the spatial variation of scalar fields and vector fields. In a 3D Cartesian coordinate system, the nabla operator is defined as:</p>
<p>$$
\nabla = \hat{x}\frac{\partial}{\partial x} + \hat{y}\frac{\partial}{\partial y} + \hat{z}\frac{\partial}{\partial z}
$$</p>
<h3 id="11-gradient-f">1.1 Gradient (âˆ‡f)<a class="header-link" href="#11-gradient-f" title="Permanent link">&para;</a></h3>
<p>The <strong>gradient</strong> of a scalar field $f(x, y, z)$ is a vector field that indicates the direction and rate at which $f$ increases most rapidly.</p>
<p>$$
\nabla f = \frac{\partial f}{\partial x}\hat{x} + \frac{\partial f}{\partial y}\hat{y} + \frac{\partial f}{\partial z}\hat{z}
$$</p>
<p><strong>Physical Meaning:</strong>
- Direction: the direction of fastest increase of $f$
- Magnitude: the rate of change in that direction (maximum directional derivative)
- Always perpendicular to level surfaces</p>
<p><strong>Example:</strong> Temperature distribution $T(x, y) = x^2 + y^2$ (2D heat source)</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.vector</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoordSys3D</span>

<span class="c1"># === SymPyë¥¼ ì´ìš©í•œ í•´ì„ì  gradient ê³„ì‚° ===</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">CoordSys3D</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>

<span class="c1"># ìŠ¤ì¹¼ë¼ì¥ ì •ì˜</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># gradient ê³„ì‚°</span>
<span class="n">grad_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">j</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f = </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡f = </span><span class="si">{</span><span class="n">grad_f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 2*x*N.i + 2*y*N.j</span>

<span class="c1"># === Matplotlibë¥¼ ì´ìš©í•œ ì‹œê°í™” ===</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># ì˜¨ë„ ë¶„í¬</span>

<span class="c1"># gradient ì„±ë¶„</span>
<span class="n">dTdx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">X</span>
<span class="n">dTdy</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Y</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># ë“±ê³ ì„  + gradient ë²¡í„°</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="mi">3</span><span class="p">,</span> <span class="p">::</span><span class="mi">3</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="mi">3</span><span class="p">,</span> <span class="p">::</span><span class="mi">3</span><span class="p">],</span> <span class="n">dTdx</span><span class="p">[::</span><span class="mi">3</span><span class="p">,</span> <span class="p">::</span><span class="mi">3</span><span class="p">],</span> <span class="n">dTdy</span><span class="p">[::</span><span class="mi">3</span><span class="p">,</span> <span class="p">::</span><span class="mi">3</span><span class="p">],</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T(x,y)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì˜¨ë„ ë¶„í¬ì™€ gradient ë²¡í„°&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># gradient í¬ê¸°</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">grad_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dTdx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dTdy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">grad_mag</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;|âˆ‡T|&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;gradient í¬ê¸° (ë³€í™”ìœ¨)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gradient_visualization.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="12-divergence-f">1.2 Divergence (âˆ‡Â·F)<a class="header-link" href="#12-divergence-f" title="Permanent link">&para;</a></h3>
<p>The <strong>divergence</strong> of a vector field $\mathbf{F} = F_x\hat{x} + F_y\hat{y} + F_z\hat{z}$ is a scalar quantity representing how much the field "spreads out" at each point.</p>
<p>$$
\nabla \cdot \mathbf{F} = \frac{\partial F_x}{\partial x} + \frac{\partial F_y}{\partial y} + \frac{\partial F_z}{\partial z}
$$</p>
<p><strong>Physical Meaning:</strong>
- $\nabla \cdot \mathbf{F} > 0$: the point is a <strong>source</strong> â€” field spreads outward
- $\nabla \cdot \mathbf{F} < 0$: the point is a <strong>sink</strong> â€” field converges inward
- $\nabla \cdot \mathbf{F} = 0$: <strong>solenoidal</strong> â€” no creation or annihilation</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>

<span class="c1"># ì›ì²œì´ ìˆëŠ” ë²¡í„°ì¥: F = (x, y) â€” ì›ì ì—ì„œ í¼ì ¸ë‚˜ê°</span>
<span class="n">Fx_expr</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">Fy_expr</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">div_F</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fx_expr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fy_expr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F = (</span><span class="si">{</span><span class="n">Fx_expr</span><span class="si">}</span><span class="s2">)xÌ‚ + (</span><span class="si">{</span><span class="n">Fy_expr</span><span class="si">}</span><span class="s2">)Å·&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Â·F = </span><span class="si">{</span><span class="n">div_F</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 2 (í•­ìƒ ì–‘ìˆ˜ â†’ ëª¨ë“  ì ì´ source)</span>

<span class="c1"># ë¹„ì••ì¶• ë²¡í„°ì¥: G = (-y, x) â€” íšŒì „ë§Œ í•˜ëŠ” ì¥</span>
<span class="n">Gx_expr</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span>
<span class="n">Gy_expr</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">div_G</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Gx_expr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Gy_expr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">G = (</span><span class="si">{</span><span class="n">Gx_expr</span><span class="si">}</span><span class="s2">)xÌ‚ + (</span><span class="si">{</span><span class="n">Gy_expr</span><span class="si">}</span><span class="s2">)Å·&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Â·G = </span><span class="si">{</span><span class="n">div_G</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0 (ë¹„ì••ì¶•)</span>

<span class="c1"># ì‹œê°í™”</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># F = (x, y): divergence &gt; 0 (source field)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;F = (x, y),  âˆ‡Â·F = </span><span class="si">{</span><span class="n">div_F</span><span class="si">}</span><span class="s1"> (ì›ì²œì¥)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># G = (-y, x): divergence = 0 (solenoidal)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">-</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;G = (-y, x),  âˆ‡Â·G = </span><span class="si">{</span><span class="n">div_G</span><span class="si">}</span><span class="s1"> (ë¹„ì••ì¶•ì¥)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;divergence_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="13-curl-f">1.3 Curl (âˆ‡Ã—F)<a class="header-link" href="#13-curl-f" title="Permanent link">&para;</a></h3>
<p>The <strong>curl</strong> of a vector field $\mathbf{F}$ is a vector field representing the "rotational tendency" and axis of rotation at each point.</p>
<p>$$
\nabla \times \mathbf{F} = \begin{vmatrix} \hat{x} & \hat{y} & \hat{z} \\ \frac{\partial}{\partial x} & \frac{\partial}{\partial y} & \frac{\partial}{\partial z} \\ F_x & F_y & F_z \end{vmatrix}
$$</p>
<p>Expanded form:</p>
<p>$$
\nabla \times \mathbf{F} = \left(\frac{\partial F_z}{\partial y} - \frac{\partial F_y}{\partial z}\right)\hat{x} + \left(\frac{\partial F_x}{\partial z} - \frac{\partial F_z}{\partial x}\right)\hat{y} + \left(\frac{\partial F_y}{\partial x} - \frac{\partial F_x}{\partial y}\right)\hat{z}
$$</p>
<p><strong>Physical Meaning:</strong>
- Direction: rotation axis according to the right-hand rule
- Magnitude: strength of rotation (circulation per unit area)
- $\nabla \times \mathbf{F} = \mathbf{0}$ indicates an <strong>irrotational field</strong> â€” necessary and sufficient condition for a conservative field (in simply connected domains)</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>

<span class="c1"># 3D ë²¡í„°ì¥: F = (-y, x, 0) â€” zì¶• ë‘˜ë ˆ íšŒì „</span>
<span class="n">Fx</span><span class="p">,</span> <span class="n">Fy</span><span class="p">,</span> <span class="n">Fz</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># curl ê³„ì‚°</span>
<span class="n">curl_x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fz</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fy</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">curl_y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fx</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fz</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">curl_z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fy</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fx</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F = (</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">)xÌ‚ + (</span><span class="si">{</span><span class="n">Fy</span><span class="si">}</span><span class="s2">)Å· + (</span><span class="si">{</span><span class="n">Fz</span><span class="si">}</span><span class="s2">)áº‘&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Ã—F = (</span><span class="si">{</span><span class="n">curl_x</span><span class="si">}</span><span class="s2">)xÌ‚ + (</span><span class="si">{</span><span class="n">curl_y</span><span class="si">}</span><span class="s2">)Å· + (</span><span class="si">{</span><span class="n">curl_z</span><span class="si">}</span><span class="s2">)áº‘&quot;</span><span class="p">)</span>
<span class="c1"># ê²°ê³¼: (0)xÌ‚ + (0)Å· + (2)áº‘ â†’ z ë°©í–¥ìœ¼ë¡œ ê· ì¼í•œ íšŒì „</span>

<span class="c1"># 2D streamplotìœ¼ë¡œ ì‹œê°í™”</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="n">U</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span>  <span class="c1"># Fx = -y</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">X</span>   <span class="c1"># Fy = x</span>
<span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">strm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">speed</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>
                      <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">strm</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;|F|&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;F = (-y, x): âˆ‡Ã—F = 2áº‘ (ê· ì¼í•œ íšŒì „ì¥)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;curl_streamplot.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="14-laplacian-2">1.4 Laplacian (âˆ‡Â²)<a class="header-link" href="#14-laplacian-2" title="Permanent link">&para;</a></h3>
<p>The <strong>scalar Laplacian</strong> is defined as the divergence of the gradient:</p>
<p>$$
\nabla^2 f = \nabla \cdot (\nabla f) = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} + \frac{\partial^2 f}{\partial z^2}
$$</p>
<p>The <strong>vector Laplacian</strong> applies the scalar Laplacian to each component:</p>
<p>$$
\nabla^2 \mathbf{F} = (\nabla^2 F_x)\hat{x} + (\nabla^2 F_y)\hat{y} + (\nabla^2 F_z)\hat{z}
$$</p>
<p><strong>Physical Meaning:</strong>
- Represents the difference between a point's value and the average of its neighborhood
- $\nabla^2 f > 0$: neighborhood average is greater than current value (local minimum tendency)
- $\nabla^2 f = 0$: <strong>harmonic function</strong> â€” solution to Laplace's equation</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>

<span class="c1"># ì¡°í™”í•¨ìˆ˜ì¸ì§€ í™•ì¸: f = 1/r (r = sqrt(x^2 + y^2 + z^2))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">r</span>

<span class="n">laplacian_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">laplacian_f_simplified</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">laplacian_f</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f = 1/r&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Â²f = </span><span class="si">{</span><span class="n">laplacian_f_simplified</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0 (r â‰  0ì—ì„œ ì¡°í™”í•¨ìˆ˜)</span>

<span class="c1"># ë¹„ì¡°í™”í•¨ìˆ˜ ì˜ˆì‹œ: g = x^2 + y^2</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">laplacian_g</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">g = </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Â²g = </span><span class="si">{</span><span class="n">laplacian_g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 4 (ë¹„ì¡°í™”)</span>
</code></pre></div>

<h3 id="15-vector-identities">1.5 Vector Identities<a class="header-link" href="#15-vector-identities" title="Permanent link">&para;</a></h3>
<p>Important identities frequently used in vector analysis:</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Key Vector Identities                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. âˆ‡Ã—(âˆ‡f) = 0          curl of gradient is always 0          â”‚
â”‚     â†’ conservative fields are always irrotational               â”‚
â”‚                                                                 â”‚
â”‚  2. âˆ‡Â·(âˆ‡Ã—F) = 0         divergence of curl is always 0        â”‚
â”‚     â†’ magnetic field is always divergence-free (âˆ‡Â·B = 0)       â”‚
â”‚                                                                 â”‚
â”‚  3. âˆ‡Ã—(âˆ‡Ã—F) = âˆ‡(âˆ‡Â·F) - âˆ‡Â²F                                   â”‚
â”‚     â†’ curl of curl decomposition (used in EM wave equations)   â”‚
â”‚                                                                 â”‚
â”‚  4. âˆ‡Â·(fF) = f(âˆ‡Â·F) + FÂ·(âˆ‡f)         divergence of product   â”‚
â”‚  5. âˆ‡Ã—(fF) = f(âˆ‡Ã—F) + (âˆ‡f)Ã—F         curl of product         â”‚
â”‚  6. âˆ‡(FÂ·G) = (FÂ·âˆ‡)G + (GÂ·âˆ‡)F + FÃ—(âˆ‡Ã—G) + GÃ—(âˆ‡Ã—F)           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.vector</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoordSys3D</span><span class="p">,</span> <span class="n">curl</span><span class="p">,</span> <span class="n">divergence</span><span class="p">,</span> <span class="n">gradient</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">CoordSys3D</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">z</span>

<span class="c1"># í•­ë“±ì‹ 1 ê²€ì¦: curl(grad(f)) = 0</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">grad_f</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">curl_grad_f</span> <span class="o">=</span> <span class="n">curl</span><span class="p">(</span><span class="n">grad_f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f = </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡f = </span><span class="si">{</span><span class="n">grad_f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Ã—(âˆ‡f) = </span><span class="si">{</span><span class="n">curl_grad_f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0</span>

<span class="c1"># í•­ë“±ì‹ 2 ê²€ì¦: div(curl(F)) = 0</span>
<span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">k</span>
<span class="n">curl_F</span> <span class="o">=</span> <span class="n">curl</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">div_curl_F</span> <span class="o">=</span> <span class="n">divergence</span><span class="p">(</span><span class="n">curl_F</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">F = </span><span class="si">{</span><span class="n">F</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Ã—F = </span><span class="si">{</span><span class="n">curl_F</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Â·(âˆ‡Ã—F) = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">div_curl_F</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0</span>
</code></pre></div>

<hr />
<h2 id="2-line-integrals">2. Line Integrals<a class="header-link" href="#2-line-integrals" title="Permanent link">&para;</a></h2>
<p>Line integrals integrate scalar or vector fields along curves, computing physical quantities such as work, circulation, and path length.</p>
<h3 id="21-line-integral-of-a-scalar-field">2.1 Line Integral of a Scalar Field<a class="header-link" href="#21-line-integral-of-a-scalar-field" title="Permanent link">&para;</a></h3>
<p>Integrating a scalar field $f$ along curve $C: \mathbf{r}(t) = (x(t), y(t), z(t))$, $a \leq t \leq b$:</p>
<p>$$
\int_C f \, ds = \int_a^b f(\mathbf{r}(t)) \left|\frac{d\mathbf{r}}{dt}\right| dt
$$</p>
<p>where $ds = |\mathbf{r}'(t)| \, dt$ is the arc length element.</p>
<p><strong>Applications:</strong> mass of a wire with variable density, arc length</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ: ë‚˜ì„  ê²½ë¡œ r(t) = (cos t, sin t, t), 0 &lt;= t &lt;= 2pi ìœ„ì—ì„œ</span>
<span class="c1"># f = x^2 + y^2 + z^2 ì˜ ì„ ì ë¶„</span>
<span class="n">x_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">y_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">z_t</span> <span class="o">=</span> <span class="n">t</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">x_t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y_t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z_t</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># cosÂ²t + sinÂ²t + tÂ² = 1 + tÂ²</span>

<span class="c1"># dr/dt ê³„ì‚°</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">dz</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">ds_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dz</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ds_dt_simplified</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">ds_dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;|dr/dt| = </span><span class="si">{</span><span class="n">ds_dt_simplified</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># sqrt(2)</span>

<span class="c1"># ì„ ì ë¶„ ê³„ì‚°</span>
<span class="n">integrand</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">ds_dt_simplified</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ«_C f ds = </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìˆ˜ì¹˜ê°’ = </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="22-line-integral-of-a-vector-field-work">2.2 Line Integral of a Vector Field (Work)<a class="header-link" href="#22-line-integral-of-a-vector-field-work" title="Permanent link">&para;</a></h3>
<p>Integrating vector field $\mathbf{F}$ along curve $C$ gives <strong>work</strong>:</p>
<p>$$
W = \int_C \mathbf{F} \cdot d\mathbf{r} = \int_a^b \mathbf{F}(\mathbf{r}(t)) \cdot \mathbf{r}'(t) \, dt
$$</p>
<p>Component form:</p>
<p>$$
W = \int_C F_x \, dx + F_y \, dy + F_z \, dz
$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

<span class="c1"># ë²¡í„°ì¥ F = (y, -x) ì—ì„œ ì›í˜• ê²½ë¡œë¥¼ ë”°ë¥¸ ì¼(work) ê³„ì‚°</span>
<span class="c1"># ê²½ë¡œ: r(t) = (cos t, sin t), 0 &lt;= t &lt;= 2pi</span>

<span class="c1"># ê²½ë¡œ ë§¤ê°œë³€ìˆ˜í™”</span>
<span class="n">x_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">y_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># ë²¡í„°ì¥ ì„±ë¶„ (ê²½ë¡œ ìœ„)</span>
<span class="n">Fx</span> <span class="o">=</span> <span class="n">y_t</span>    <span class="c1"># F_x = y = sin t</span>
<span class="n">Fy</span> <span class="o">=</span> <span class="o">-</span><span class="n">x_t</span>   <span class="c1"># F_y = -x = -cos t</span>

<span class="c1"># dr/dt</span>
<span class="n">dx_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># -sin t</span>
<span class="n">dy_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1">#  cos t</span>

<span class="c1"># F Â· dr/dt</span>
<span class="n">integrand</span> <span class="o">=</span> <span class="n">Fx</span> <span class="o">*</span> <span class="n">dx_dt</span> <span class="o">+</span> <span class="n">Fy</span> <span class="o">*</span> <span class="n">dy_dt</span>
<span class="n">integrand_simplified</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">integrand</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FÂ·dr/dt = </span><span class="si">{</span><span class="n">integrand_simplified</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># -1</span>

<span class="c1"># ì¼(work) ê³„ì‚°</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;W = âˆ® FÂ·dr = </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># -2*pi (ìŒìˆ˜: ì¥ì´ ê²½ë¡œì™€ ë°˜ëŒ€ ë°©í–¥)</span>

<span class="c1"># ì‹œê°í™”: ë²¡í„°ì¥ê³¼ ê²½ë¡œ</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">-</span><span class="n">X</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F = (y, -x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê²½ë¡œ C&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.71</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;âˆ® FÂ·dr = </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s1"> (ì‹œê³„ ë°©í–¥ ìˆœí™˜)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;line_integral_work.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="23-conservative-fields-and-potential-functions">2.3 Conservative Fields and Potential Functions<a class="header-link" href="#23-conservative-fields-and-potential-functions" title="Permanent link">&para;</a></h3>
<p>If vector field $\mathbf{F}$ is a <strong>conservative field</strong>, the line integral value is path-independent and depends only on endpoints.</p>
<p>$$
\mathbf{F} = \nabla \phi \quad \Longleftrightarrow \quad \int_A^B \mathbf{F} \cdot d\mathbf{r} = \phi(B) - \phi(A)
$$</p>
<p><strong>Equivalent conditions for conservative fields (in simply connected domains):</strong></p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">The</span><span class="w"> </span><span class="nx">following</span><span class="w"> </span><span class="nx">conditions</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">equivalent</span><span class="w"> </span><span class="p">(</span><span class="k">in</span><span class="w"> </span><span class="nx">simply</span><span class="w"> </span><span class="nx">connected</span><span class="p">):</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nx">There</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">potential</span><span class="w"> </span><span class="nx">function</span><span class="w"> </span><span class="nx">Ï†</span><span class="w"> </span><span class="nx">such</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">F</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="err">âˆ‡</span><span class="nx">Ï†</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="err">âˆ®</span><span class="nx">_C</span><span class="w"> </span><span class="nx">F</span><span class="err">Â·</span><span class="nx">dr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="nx">closed</span><span class="w"> </span><span class="nx">path</span><span class="p">)</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="err">âˆ«</span><span class="nx">_A</span><span class="o">^</span><span class="nx">B</span><span class="w"> </span><span class="nx">F</span><span class="err">Â·</span><span class="nx">dr</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">path</span><span class="o">-</span><span class="nx">independent</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="err">âˆ‡Ã—</span><span class="nx">F</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">                                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="nx">F_x</span><span class="w"> </span><span class="nx">dx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">F_y</span><span class="w"> </span><span class="nx">dy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">F_z</span><span class="w"> </span><span class="nx">dz</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">exact</span><span class="w"> </span><span class="nx">differential</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.vector</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoordSys3D</span><span class="p">,</span> <span class="n">curl</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">CoordSys3D</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">z</span>

<span class="c1"># === ë³´ì¡´ì¥ íŒë³„ ì˜ˆì œ ===</span>
<span class="c1"># F1 = (2xy + z)xÌ‚ + (xÂ² + 2yz)Å· + (x + yÂ²)áº‘</span>
<span class="n">F1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">k</span>
<span class="n">curl_F1</span> <span class="o">=</span> <span class="n">curl</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1 = </span><span class="si">{</span><span class="n">F1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Ã—F1 = </span><span class="si">{</span><span class="n">curl_F1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0 â†’ ë³´ì¡´ì¥!</span>

<span class="c1"># í¼í…ì…œ í•¨ìˆ˜ êµ¬í•˜ê¸°: âˆ‚Ï†/âˆ‚x = 2xy + z</span>
<span class="n">phi_x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># xÂ²y + xz + g(y,z)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âˆ« (2xy+z)dx = </span><span class="si">{</span><span class="n">phi</span><span class="si">}</span><span class="s2"> + g(y,z)&quot;</span><span class="p">)</span>

<span class="c1"># g(y,z) ê²°ì •: âˆ‚Ï†/âˆ‚y = xÂ² + âˆ‚g/âˆ‚y = xÂ² + 2yz â†’ âˆ‚g/âˆ‚y = 2yz</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># yÂ²z + h(z)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ« 2yz dy = </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2"> + h(z)&quot;</span><span class="p">)</span>

<span class="c1"># h(z) ê²°ì •: âˆ‚Ï†/âˆ‚z = x + yÂ² + h&#39;(z) = x + yÂ² â†’ h&#39;(z) = 0 â†’ h = C</span>
<span class="n">phi_total</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">z</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Ï†(x,y,z) = </span><span class="si">{</span><span class="n">phi_total</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ê²€ì¦: âˆ‡Ï† = F1?</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.vector</span><span class="w"> </span><span class="kn">import</span> <span class="n">gradient</span>
<span class="n">grad_phi</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">(</span><span class="n">phi_total</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Ï† = </span><span class="si">{</span><span class="n">grad_phi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1 = âˆ‡Ï†? </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">grad_phi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">N</span><span class="o">.</span><span class="n">zero</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># === ë¹„ë³´ì¡´ì¥ ì˜ˆì œ ===</span>
<span class="c1"># F2 = (y)xÌ‚ + (x + z)Å· + (y + 1)áº‘ â€” curl â‰  0 í™•ì¸</span>
<span class="n">F2</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">k</span>
<span class="n">curl_F2</span> <span class="o">=</span> <span class="n">curl</span><span class="p">(</span><span class="n">F2</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">F2 = </span><span class="si">{</span><span class="n">F2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Ã—F2 = </span><span class="si">{</span><span class="n">curl_F2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># ë¹„ë³´ì¡´ì¥ ì—¬ë¶€ í™•ì¸</span>
</code></pre></div>

<hr />
<h2 id="3-surface-integrals">3. Surface Integrals<a class="header-link" href="#3-surface-integrals" title="Permanent link">&para;</a></h2>
<h3 id="31-surface-element-and-normal-vector">3.1 Surface Element and Normal Vector<a class="header-link" href="#31-surface-element-and-normal-vector" title="Permanent link">&para;</a></h3>
<p>When surface $S$ is parameterized by $(u, v)$: $\mathbf{r}(u, v) = (x(u,v),\, y(u,v),\, z(u,v))$</p>
<p><strong>Surface element:</strong></p>
<p>$$
d\mathbf{S} = \left(\frac{\partial \mathbf{r}}{\partial u} \times \frac{\partial \mathbf{r}}{\partial v}\right) du \, dv = \hat{n} \, dA
$$</p>
<p>where $\hat{n}$ is the unit normal vector and $dA = |d\mathbf{S}|$ is the surface area element.</p>
<p><strong>For surfaces given as $z = g(x, y)$:</strong></p>
<p>$$
d\mathbf{S} = \left(-\frac{\partial g}{\partial x}\hat{x} - \frac{\partial g}{\partial y}\hat{y} + \hat{z}\right) dx \, dy
$$</p>
<h3 id="32-surface-integral-of-a-scalar-field">3.2 Surface Integral of a Scalar Field<a class="header-link" href="#32-surface-integral-of-a-scalar-field" title="Permanent link">&para;</a></h3>
<p>$$
\iint_S f \, dA = \iint_D f(\mathbf{r}(u,v)) \left|\frac{\partial \mathbf{r}}{\partial u} \times \frac{\partial \mathbf{r}}{\partial v}\right| du \, dv
$$</p>
<p><strong>Applications:</strong> surface area (when $f = 1$), total of physical quantity over surface</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># êµ¬ë©´ r = 1 ì˜ ë©´ì  ê³„ì‚° (êµ¬ë©´ì¢Œí‘œ)</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta phi&#39;</span><span class="p">)</span>

<span class="c1"># êµ¬ë©´ ë§¤ê°œë³€ìˆ˜í™”: r(Î¸, Ï†) = (sinÎ¸ cosÏ†, sinÎ¸ sinÏ†, cosÎ¸)</span>
<span class="n">r_theta</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>  <span class="c1"># âˆ‚r/âˆ‚Î¸</span>
                      <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
                      <span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
<span class="n">r_phi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="o">-</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>    <span class="c1"># âˆ‚r/âˆ‚Ï†</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
                    <span class="mi">0</span><span class="p">])</span>

<span class="c1"># ì™¸ì : âˆ‚r/âˆ‚Î¸ Ã— âˆ‚r/âˆ‚Ï†</span>
<span class="n">cross</span> <span class="o">=</span> <span class="n">r_theta</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">r_phi</span><span class="p">)</span>
<span class="n">dA</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">cross</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;|âˆ‚r/âˆ‚Î¸ Ã— âˆ‚r/âˆ‚Ï†| = </span><span class="si">{</span><span class="n">dA</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># sin(theta) (Î¸ âˆˆ [0, Ï€]ì—ì„œ ì–‘ìˆ˜)</span>

<span class="c1"># ë©´ì  ì ë¶„</span>
<span class="n">area</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;êµ¬ì˜ ë©´ì  = </span><span class="si">{</span><span class="n">area</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 4*pi</span>

<span class="c1"># 3D ì‹œê°í™”</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="c1"># ë²•ì„  ë²¡í„° í‘œì‹œ (ì¼ë¶€ ì ì—ì„œ)</span>
<span class="n">step</span> <span class="o">=</span> <span class="mi">8</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">step</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">step</span><span class="p">):</span>
        <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">Z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span><span class="p">,</span> <span class="n">px</span><span class="o">*</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">py</span><span class="o">*</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">pz</span><span class="o">*</span><span class="mf">0.3</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">arrow_length_ratio</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë‹¨ìœ„ êµ¬ë©´ê³¼ ë²•ì„  ë²¡í„°&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sphere_normal_vectors.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="33-surface-integral-of-a-vector-field-flux">3.3 Surface Integral of a Vector Field (Flux)<a class="header-link" href="#33-surface-integral-of-a-vector-field-flux" title="Permanent link">&para;</a></h3>
<p>The <strong>flux</strong> of vector field $\mathbf{F}$ through surface $S$:</p>
<p>$$
\Phi = \iint_S \mathbf{F} \cdot d\mathbf{S} = \iint_S \mathbf{F} \cdot \hat{n} \, dA
$$</p>
<p><strong>Physical Meaning:</strong>
- Electric flux: amount of electric field penetrating the surface (Gauss's law)
- Mass flux: mass flow rate through the surface</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u v&#39;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ: F = (x, y, z)ê°€ êµ¬ë©´ r = Rì„ í†µê³¼í•˜ëŠ” í”ŒëŸ­ìŠ¤</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta phi&#39;</span><span class="p">)</span>

<span class="c1"># êµ¬ë©´ ìœ„ì—ì„œ rÌ‚ = (sinÎ¸ cosÏ†, sinÎ¸ sinÏ†, cosÎ¸)</span>
<span class="c1"># êµ¬ë©´ ìœ„ì—ì„œ F = R*(sinÎ¸ cosÏ†, sinÎ¸ sinÏ†, cosÎ¸) = R*rÌ‚</span>
<span class="c1"># FÂ·nÌ‚ = FÂ·rÌ‚ = R (êµ¬ë©´ì—ì„œ ë²•ì„ ì€ rÌ‚ ë°©í–¥)</span>

<span class="c1"># dA = RÂ² sinÎ¸ dÎ¸ dÏ†</span>
<span class="n">integrand</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F = (x, y, z) ê°€ êµ¬ë©´ r=</span><span class="si">{</span><span class="n">R</span><span class="si">}</span><span class="s2">ì„ ê´€í†µí•˜ëŠ” í”ŒëŸ­ìŠ¤:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Î¦ = âˆ¬ FÂ·dS = </span><span class="si">{</span><span class="n">flux</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 4*pi*R^3</span>

<span class="c1"># ë°œì‚° ì •ë¦¬ë¡œ ê²€ì¦: âˆ¬ FÂ·dS = âˆ­ (âˆ‡Â·F) dV</span>
<span class="n">div_F</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># âˆ‡Â·(x,y,z) = 1 + 1 + 1 = 3</span>
<span class="n">volume</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">R</span><span class="o">**</span><span class="mi">3</span>
<span class="n">flux_divergence</span> <span class="o">=</span> <span class="n">div_F</span> <span class="o">*</span> <span class="n">volume</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë°œì‚° ì •ë¦¬ ê²€ì¦: âˆ­ (âˆ‡Â·F)dV = 3 Ã— (4/3)Ï€RÂ³ = </span><span class="si">{</span><span class="n">flux_divergence</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì¼ì¹˜ ì—¬ë¶€: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">flux</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">flux_divergence</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># True</span>
</code></pre></div>

<hr />
<h2 id="4-integral-theorems">4. Integral Theorems<a class="header-link" href="#4-integral-theorems" title="Permanent link">&para;</a></h2>
<p>The three fundamental integral theorems of vector analysis connect differential operations (gradient, curl, divergence) with integrals (line, surface, volume).</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Three Fundamental Theorems â€” by Dimension                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Dim    Theorem       Operator     Integrals                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
â”‚  2D     Green         âˆ‚/âˆ‚x, âˆ‚/âˆ‚y   Area â†” Line                 â”‚
â”‚  3D-S   Stokes        âˆ‡Ã—            Surface â†” Line             â”‚
â”‚  3D-V   Gauss         âˆ‡Â·            Volume â†” Surface           â”‚
â”‚                                                                 â”‚
â”‚  Common pattern: âˆ«âˆ«(differential) = âˆ®(boundary integral)       â”‚
â”‚                  &quot;interior differential = boundary integral&quot;   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="41-greens-theorem">4.1 Green's Theorem<a class="header-link" href="#41-greens-theorem" title="Permanent link">&para;</a></h3>
<p>In 2D, for a simple closed curve $C$ enclosing region $D$:</p>
<p>$$
\oint_C (P \, dx + Q \, dy) = \iint_D \left(\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}\right) dA
$$</p>
<p><strong>Physical Meaning:</strong> The <strong>circulation</strong> of a vector field equals the sum of the $z$-component curl over the interior.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y t&#39;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ: P = -yÂ², Q = xÂ² ì— ëŒ€í•´ ê·¸ë¦° ì •ë¦¬ ê²€ì¦</span>
<span class="c1"># ì˜ì—­: ë‹¨ìœ„ ì› xÂ² + yÂ² â‰¤ 1</span>
<span class="n">P</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># ì¢Œë³€: ì„ ì ë¶„ (ë‹¨ìœ„ ì› ê²½ë¡œ)</span>
<span class="n">x_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">y_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">dx_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">dy_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">P_on_C</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_t</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_t</span><span class="p">)])</span>
<span class="n">Q_on_C</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_t</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_t</span><span class="p">)])</span>

<span class="n">line_integral</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">P_on_C</span> <span class="o">*</span> <span class="n">dx_dt</span> <span class="o">+</span> <span class="n">Q_on_C</span> <span class="o">*</span> <span class="n">dy_dt</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì„ ì ë¶„ âˆ®(P dx + Q dy) = </span><span class="si">{</span><span class="n">line_integral</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ìš°ë³€: ë©´ì ë¶„ (ê·¹ì¢Œí‘œ)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r theta&#39;</span><span class="p">)</span>
<span class="n">dQ_dx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># 2x</span>
<span class="n">dP_dy</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># -2y</span>
<span class="n">integrand</span> <span class="o">=</span> <span class="n">dQ_dx</span> <span class="o">-</span> <span class="n">dP_dy</span>  <span class="c1"># 2x + 2y</span>

<span class="c1"># ê·¹ì¢Œí‘œ ë³€í™˜</span>
<span class="n">integrand_polar</span> <span class="o">=</span> <span class="n">integrand</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))])</span>
<span class="n">area_integral</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">integrand_polar</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë©´ì ë¶„ âˆ¬(âˆ‚Q/âˆ‚x - âˆ‚P/âˆ‚y)dA = </span><span class="si">{</span><span class="n">area_integral</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ê·¸ë¦° ì •ë¦¬ ì„±ë¦½: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">line_integral</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">area_integral</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Special form of Green's theorem â€” area formula:</strong></p>
<p>$$
A = \frac{1}{2} \oint_C (x \, dy - y \, dx)
$$</p>
<p>This formula is used in surveying and computer graphics to calculate polygon areas.</p>
<h3 id="42-stokes-theorem">4.2 Stokes' Theorem<a class="header-link" href="#42-stokes-theorem" title="Permanent link">&para;</a></h3>
<p>In 3D, for surface $S$ with boundary curve $C = \partial S$:</p>
<p>$$
\oint_C \mathbf{F} \cdot d\mathbf{r} = \iint_S (\nabla \times \mathbf{F}) \cdot d\mathbf{S}
$$</p>
<p><strong>Interpretation:</strong> Circulation around boundary = flux of curl through surface</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z t&#39;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ: F = (y, -x, zÂ²) ì— ëŒ€í•´ ìŠ¤í† í¬ìŠ¤ ì •ë¦¬ ê²€ì¦</span>
<span class="c1"># ê³¡ë©´ S: z = 1 - xÂ² - yÂ² (z â‰¥ 0ì¸ í¬ë¬¼ë©´)</span>
<span class="c1"># ê²½ê³„ C: z = 0ì—ì„œ xÂ² + yÂ² = 1 (ë‹¨ìœ„ ì›)</span>

<span class="c1"># --- curl(F) ê³„ì‚° ---</span>
<span class="n">Fx</span><span class="p">,</span> <span class="n">Fy</span><span class="p">,</span> <span class="n">Fz</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span>

<span class="n">curl_x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fz</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fy</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>  <span class="c1"># 0 - 0 = 0</span>
<span class="n">curl_y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fx</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fz</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># 0 - 0 = 0</span>
<span class="n">curl_z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fy</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Fx</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># -1 - 1 = -2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Ã—F = (</span><span class="si">{</span><span class="n">curl_x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">curl_y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">curl_z</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># --- ì¢Œë³€: ì„ ì ë¶„ âˆ®_C FÂ·dr ---</span>
<span class="c1"># C: r(t) = (cos t, sin t, 0), 0 â‰¤ t â‰¤ 2Ï€ (ë°˜ì‹œê³„)</span>
<span class="n">x_t</span><span class="p">,</span> <span class="n">y_t</span><span class="p">,</span> <span class="n">z_t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dx_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">dy_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">dz_dt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">Fx_C</span> <span class="o">=</span> <span class="n">Fy_expr</span> <span class="o">=</span> <span class="n">y_t</span>   <span class="c1"># Fx = y = sin t</span>
<span class="n">Fy_C</span> <span class="o">=</span> <span class="o">-</span><span class="n">x_t</span>             <span class="c1"># Fy = -x = -cos t</span>
<span class="n">Fz_C</span> <span class="o">=</span> <span class="n">z_t</span><span class="o">**</span><span class="mi">2</span>           <span class="c1"># Fz = zÂ² = 0</span>

<span class="n">line_int</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span>
    <span class="n">Fx_C</span> <span class="o">*</span> <span class="n">dx_dt</span> <span class="o">+</span> <span class="n">Fy_C</span> <span class="o">*</span> <span class="n">dy_dt</span> <span class="o">+</span> <span class="n">Fz_C</span> <span class="o">*</span> <span class="n">dz_dt</span><span class="p">,</span>
    <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì¢Œë³€ (ì„ ì ë¶„): âˆ® FÂ·dr = </span><span class="si">{</span><span class="n">line_int</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- ìš°ë³€: ë©´ì ë¶„ âˆ¬_S (âˆ‡Ã—F)Â·dS ---</span>
<span class="c1"># ê³¡ë©´ z = 1 - xÂ² - yÂ², dS = (-âˆ‚z/âˆ‚x, -âˆ‚z/âˆ‚y, 1) dx dy = (2x, 2y, 1) dx dy</span>
<span class="c1"># (âˆ‡Ã—F)Â·dS = (0, 0, -2)Â·(2x, 2y, 1) dx dy = -2 dx dy</span>

<span class="n">r_sym</span><span class="p">,</span> <span class="n">theta_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r_s theta_s&#39;</span><span class="p">)</span>
<span class="n">surface_int</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span>
    <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r_sym</span><span class="p">,</span>  <span class="c1"># -2 Ã— r (ì•¼ì½”ë¹„ì•ˆ)</span>
    <span class="p">(</span><span class="n">r_sym</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="n">theta_sym</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìš°ë³€ (ë©´ì ë¶„): âˆ¬ (âˆ‡Ã—F)Â·dS = </span><span class="si">{</span><span class="n">surface_int</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìŠ¤í† í¬ìŠ¤ ì •ë¦¬ ì„±ë¦½: </span><span class="si">{</span><span class="n">line_int</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">surface_int</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="43-divergence-theorem-gausss-theorem">4.3 Divergence Theorem (Gauss's Theorem)<a class="header-link" href="#43-divergence-theorem-gausss-theorem" title="Permanent link">&para;</a></h3>
<p>For closed surface $S$ enclosing volume $V$:</p>
<p>$$
\oiint_S \mathbf{F} \cdot d\mathbf{S} = \iiint_V (\nabla \cdot \mathbf{F}) \, dV
$$</p>
<p><strong>Interpretation:</strong> Total flux through closed surface = sum of divergence throughout interior</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ: F = (xÂ³, yÂ³, zÂ³), ë‹«íŒ ê³¡ë©´ = ë‹¨ìœ„ êµ¬ xÂ²+yÂ²+zÂ² = 1</span>

<span class="c1"># âˆ‡Â·F = 3xÂ² + 3yÂ² + 3zÂ² = 3rÂ²</span>
<span class="n">div_F</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ‡Â·F = </span><span class="si">{</span><span class="n">div_F</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 3xÂ² + 3yÂ² + 3zÂ²</span>

<span class="c1"># ì²´ì  ì ë¶„ (êµ¬ë©´ì¢Œí‘œ)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r theta phi&#39;</span><span class="p">)</span>
<span class="n">div_F_spherical</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># 3(xÂ² + yÂ² + zÂ²) = 3rÂ²</span>
<span class="n">jacobian</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">volume_int</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span>
    <span class="n">div_F_spherical</span> <span class="o">*</span> <span class="n">jacobian</span><span class="p">,</span>
    <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
    <span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ­ (âˆ‡Â·F) dV = </span><span class="si">{</span><span class="n">volume_int</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 12Ï€/5</span>

<span class="c1"># ì§ì ‘ ë©´ì ë¶„ìœ¼ë¡œ ê²€ì¦</span>
<span class="c1"># êµ¬ë©´ ìœ„ì—ì„œ rÌ‚ = (x, y, z) (ë‹¨ìœ„êµ¬ì´ë¯€ë¡œ |r| = 1)</span>
<span class="c1"># FÂ·rÌ‚ = xâ´ + yâ´ + zâ´ (êµ¬ë©´ ìœ„ì—ì„œ xÂ² + yÂ² + zÂ² = 1)</span>
<span class="c1"># êµ¬ë©´ì¢Œí‘œ: x = sinÎ¸ cosÏ†, y = sinÎ¸ sinÏ†, z = cosÎ¸</span>

<span class="n">F_dot_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> \
          <span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> \
          <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>

<span class="n">surface_int</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span>
    <span class="n">F_dot_n</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>  <span class="c1"># dA = sinÎ¸ dÎ¸ dÏ†</span>
    <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
    <span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">surface_int_simplified</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">surface_int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆ¬ FÂ·dS = </span><span class="si">{</span><span class="n">surface_int_simplified</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì¼ì¹˜: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">volume_int</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">surface_int_simplified</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="44-relationship-between-the-three-theorems">4.4 Relationship Between the Three Theorems<a class="header-link" href="#44-relationship-between-the-three-theorems" title="Permanent link">&para;</a></h3>
<p>All three integral theorems are special cases of the <strong>generalized Stokes' theorem</strong>:</p>
<p>$$
\int_{\partial \Omega} \omega = \int_{\Omega} d\omega
$$</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Unified View of Three Theorems                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Fundamental Theorem of Calculus (1D):                         â”‚
â”‚    âˆ«_a^b f&#39;(x) dx = f(b) - f(a)                                â”‚
â”‚    &quot;integral of derivative = difference of boundary values&quot;    â”‚
â”‚                                                                 â”‚
â”‚  Green&#39;s Theorem (2D):                                         â”‚
â”‚    âˆ¬_D (âˆ‚Q/âˆ‚x - âˆ‚P/âˆ‚y) dA = âˆ®_{âˆ‚D} (P dx + Q dy)             â”‚
â”‚    &quot;area integral of curl = line integral on boundary&quot;         â”‚
â”‚                                                                 â”‚
â”‚  Stokes&#39; Theorem (3D, surfaceâ†”boundary):                       â”‚
â”‚    âˆ¬_S (âˆ‡Ã—F)Â·dS = âˆ®_{âˆ‚S} FÂ·dr                                 â”‚
â”‚    &quot;surface integral of curl = line integral on boundary&quot;      â”‚
â”‚                                                                 â”‚
â”‚  Gauss&#39;s Theorem (3D, volumeâ†”boundary):                        â”‚
â”‚    âˆ­_V (âˆ‡Â·F) dV = âˆ¬_{âˆ‚V} FÂ·dS                                 â”‚
â”‚    &quot;volume integral of divergence = surface integral&quot;          â”‚
â”‚                                                                 â”‚
â”‚  Pattern: &quot;interior differential = boundary values&quot;            â”‚
â”‚           n-dimensional integral â†” (n-1)-dimensional boundary  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="5-physical-applications">5. Physical Applications<a class="header-link" href="#5-physical-applications" title="Permanent link">&para;</a></h2>
<h3 id="51-electric-field-and-gausss-law">5.1 Electric Field and Gauss's Law<a class="header-link" href="#51-electric-field-and-gausss-law" title="Permanent link">&para;</a></h3>
<p><strong>Gauss's Law (integral form):</strong></p>
<p>$$
\oiint_S \mathbf{E} \cdot d\mathbf{S} = \frac{Q_{\text{enc}}}{\epsilon_0}
$$</p>
<p><strong>Gauss's Law (differential form):</strong> Applying the divergence theorem:</p>
<p>$$
\nabla \cdot \mathbf{E} = \frac{\rho}{\epsilon_0}
$$</p>
<p>The divergence of the electric field is nonzero where charge density $\rho$ exists.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ì ì „í•˜ì˜ ì „ê¸°ì¥ ì‹œê°í™” (2D ë‹¨ë©´)</span>
<span class="c1"># E = q/(4Ï€Îµâ‚€) Ã— rÌ‚/rÂ² (ì¿¨ë¡± ë²•ì¹™)</span>

<span class="n">q</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># ì „í•˜ëŸ‰ (ì„ì˜ ë‹¨ìœ„)</span>
<span class="n">eps0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Îµâ‚€ (ë‹¨ìœ„ê³„ í¸ì˜ìƒ)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>  <span class="c1"># íŠ¹ì´ì  ë°©ì§€</span>

<span class="c1"># ì „ê¸°ì¥ ì„±ë¶„</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">eps0</span><span class="p">)</span>
<span class="n">Ex</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">X</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="mi">3</span>
<span class="n">Ey</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="mi">3</span>
<span class="n">E_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ex</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Ey</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># ì–‘ì „í•˜ (+q)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">E_mag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
              <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+q&#39;</span><span class="p">)</span>
<span class="n">circle1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê°€ìš°ìŠ¤ ë©´ r=1&#39;</span><span class="p">)</span>
<span class="n">circle2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê°€ìš°ìŠ¤ ë©´ r=2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì–‘ì „í•˜ì˜ ì „ê¸°ì¥ (ë°œì‚° &gt; 0)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># ìŒê·¹ì (dipole): +q at (1,0), -q at (-1,0)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">X</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R1</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">R1</span><span class="p">)</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R2</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">R2</span><span class="p">)</span>

<span class="n">Ex_dip</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">R1</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">R2</span><span class="o">**</span><span class="mi">3</span>
<span class="n">Ey_dip</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">R1</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">R2</span><span class="o">**</span><span class="mi">3</span>
<span class="n">E_dip_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ex_dip</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Ey_dip</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ex_dip</span><span class="p">,</span> <span class="n">Ey_dip</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">E_dip_mag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+q&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-q&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „ê¸° ìŒê·¹ì (dipole)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;electric_field_gauss.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-magnetic-field-and-amperes-law">5.2 Magnetic Field and AmpÃ¨re's Law<a class="header-link" href="#52-magnetic-field-and-amperes-law" title="Permanent link">&para;</a></h3>
<p><strong>AmpÃ¨re's Law (integral form):</strong></p>
<p>$$
\oint_C \mathbf{B} \cdot d\mathbf{r} = \mu_0 I_{\text{enc}}
$$</p>
<p><strong>AmpÃ¨re's Law (differential form):</strong> Applying Stokes' theorem:</p>
<p>$$
\nabla \times \mathbf{B} = \mu_0 \mathbf{J}
$$</p>
<p>where $\mathbf{J}$ is the current density.</p>
<p><strong>Physical Meaning:</strong>
- Curl of magnetic field is proportional to current density
- Magnetic field lines form closed loops around currents (right-hand rule)
- $\nabla \cdot \mathbf{B} = 0$ â€” magnetic monopoles do not exist</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ë¬´í•œ ì§ì„  ì „ë¥˜ì— ì˜í•œ ìê¸°ì¥</span>
<span class="c1"># B = Î¼â‚€I/(2Ï€r) Ã— Ï†Ì‚ (ì›í†µì¢Œí‘œ)</span>

<span class="n">mu0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Î¼â‚€ (ì„ì˜ ë‹¨ìœ„)</span>
<span class="n">I</span> <span class="o">=</span> <span class="mf">1.0</span>    <span class="c1"># ì „ë¥˜ (z ë°©í–¥)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>

<span class="c1"># B = Î¼â‚€I/(2Ï€r) Ã— Ï†Ì‚, ì—¬ê¸°ì„œ Ï†Ì‚ = (-y/r, x/r, 0)</span>
<span class="n">B_coeff</span> <span class="o">=</span> <span class="n">mu0</span> <span class="o">*</span> <span class="n">I</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>
<span class="n">Bx</span> <span class="o">=</span> <span class="n">B_coeff</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">Y</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span>
<span class="n">By</span> <span class="o">=</span> <span class="n">B_coeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">B_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">strm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">B_mag</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">),</span>
                      <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">strm</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;log|B|&#39;</span><span class="p">)</span>

<span class="c1"># ì „ë¥˜ ìœ„ì¹˜ (ì›ì , z ë°©í–¥)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g^&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I (z ë°©í–¥, ì§€ë©´ì—ì„œ ë‚˜ì˜´)&#39;</span><span class="p">)</span>

<span class="c1"># ì•™í˜ë¥´ ë£¨í”„ í‘œì‹œ</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]:</span>
    <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span>
                         <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì§ì„  ì „ë¥˜ ì£¼ìœ„ì˜ ìê¸°ì¥ (ì•™í˜ë¥´ ë²•ì¹™)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;magnetic_field_ampere.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="53-continuity-equation-in-fluid-dynamics">5.3 Continuity Equation in Fluid Dynamics<a class="header-link" href="#53-continuity-equation-in-fluid-dynamics" title="Permanent link">&para;</a></h3>
<p>The <strong>continuity equation</strong> expressing mass conservation:</p>
<p>$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0
$$</p>
<p>where $\rho$ is fluid density and $\mathbf{v}$ is the velocity field.</p>
<p><strong>Derivation:</strong>
1. Mass outflow rate through closed surface = $\oiint_S \rho \mathbf{v} \cdot d\mathbf{S}$
2. Rate of mass change in volume = $-\frac{\partial}{\partial t}\iiint_V \rho \, dV$
3. Apply divergence theorem: $\iiint_V \left[\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v})\right] dV = 0$
4. For arbitrary volume, integrand must be zero</p>
<p><strong>Incompressible fluid</strong> ($\rho$ = constant):</p>
<p>$$
\nabla \cdot \mathbf{v} = 0
$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># 2D ë¹„ì••ì¶• ìœ ì²´ íë¦„ ì˜ˆì‹œ</span>
<span class="c1"># íë¦„ í•¨ìˆ˜(stream function) Ïˆë¥¼ ì´ìš©: vx = âˆ‚Ïˆ/âˆ‚y, vy = -âˆ‚Ïˆ/âˆ‚x</span>
<span class="c1"># â†’ ìë™ìœ¼ë¡œ âˆ‡Â·v = 0 ë§Œì¡±</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

<span class="c1"># ì˜ˆì œ 1: ê· ì¼ íë¦„ + ì›í†µ ì£¼ìœ„ íë¦„ (í¼í…ì…œ íë¦„)</span>
<span class="c1"># Ïˆ = U*y*(1 - aÂ²/rÂ²), U = ììœ ë¥˜ ì†ë„, a = ì›í†µ ë°˜ì§€ë¦„</span>
<span class="n">U_inf</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">R_sq</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">R_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R_sq</span> <span class="o">&lt;</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">R_sq</span><span class="p">)</span>  <span class="c1"># ì›í†µ ë‚´ë¶€ ë§ˆìŠ¤í‚¹</span>

<span class="n">Vx</span> <span class="o">=</span> <span class="n">U_inf</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">R_sq</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">U_inf</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">R_sq</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># ì›í†µ ë‚´ë¶€ ì†ë„ = 0</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Vx</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Vy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">strm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Vx</span><span class="p">,</span> <span class="n">Vy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">speed</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">,</span>
                      <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">strm</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;|v| (ì†ë ¥)&#39;</span><span class="p">)</span>

<span class="c1"># ì›í†µ í‘œì‹œ</span>
<span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

<span class="c1"># ë°œì‚° ê³„ì‚° (ìˆ˜ì¹˜ì )</span>
<span class="n">dVx_dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">Vx</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dVy_dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">Vy</span><span class="p">,</span> <span class="n">Y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">div_v</span> <span class="o">=</span> <span class="n">dVx_dx</span> <span class="o">+</span> <span class="n">dVy_dy</span>
<span class="n">max_div</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">div_v</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ì›í†µ ì£¼ìœ„ ë¹„ì••ì¶• ìœ ì²´ íë¦„  (max|âˆ‡Â·v| â‰ˆ </span><span class="si">{</span><span class="n">max_div</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fluid_flow_cylinder.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="54-maxwells-equations-integral-and-differential-forms">5.4 Maxwell's Equations: Integral and Differential Forms<a class="header-link" href="#54-maxwells-equations-integral-and-differential-forms" title="Permanent link">&para;</a></h3>
<p>Maxwell's equations completely describe electromagnetic phenomena. Through vector analysis integral theorems (Gauss, Stokes), we can convert between integral and differential forms.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Maxwell&#39;s Equations                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Law               Differential Form        Integral Form      Theorem  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                          â”‚
â”‚  Gauss (electric)  âˆ‡Â·E = Ï/Îµâ‚€              âˆ® EÂ·dS = Q/Îµâ‚€       Gauss   â”‚
â”‚                                                                          â”‚
â”‚  Gauss (magnetic)  âˆ‡Â·B = 0                 âˆ® BÂ·dS = 0           Gauss   â”‚
â”‚                                                                          â”‚
â”‚  Faraday           âˆ‡Ã—E = -âˆ‚B/âˆ‚t            âˆ® EÂ·dr = -dÎ¦_B/dt   Stokes  â”‚
â”‚                                                                          â”‚
â”‚  AmpÃ¨re-Maxwell    âˆ‡Ã—B = Î¼â‚€J + Î¼â‚€Îµâ‚€âˆ‚E/âˆ‚t                      Stokes  â”‚
â”‚                                     âˆ® BÂ·dr = Î¼â‚€I + Î¼â‚€Îµâ‚€ dÎ¦_E/dt        â”‚
â”‚                                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                          â”‚
â”‚  Physical Meaning:                                                       â”‚
â”‚  â€¢ Gauss (electric): Charges are sources of electric field              â”‚
â”‚  â€¢ Gauss (magnetic): Magnetic monopoles do not exist                    â”‚
â”‚  â€¢ Faraday: Changing magnetic field induces electric field              â”‚
â”‚  â€¢ AmpÃ¨re-Maxwell: Current and changing E-field induce B-field          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p><strong>Converting from integral to differential form (Gauss's law example):</strong></p>
<p>$$
\oiint_S \mathbf{E} \cdot d\mathbf{S} = \frac{Q_{\text{enc}}}{\epsilon_0}
= \frac{1}{\epsilon_0}\iiint_V \rho \, dV
$$</p>
<p>Apply divergence theorem to left side:</p>
<p>$$
\iiint_V (\nabla \cdot \mathbf{E}) \, dV = \frac{1}{\epsilon_0}\iiint_V \rho \, dV
$$</p>
<p>Valid for arbitrary volume $V$:</p>
<p>$$
\nabla \cdot \mathbf{E} = \frac{\rho}{\epsilon_0}
$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ë§¥ìŠ¤ì›° ë°©ì •ì‹ì˜ ì‹œê°ì  ì •ë¦¬: ì „ê¸°ì¥ê³¼ ìê¸°ì¥ì˜ ê´€ê³„</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># === (1) ê°€ìš°ìŠ¤ ë²•ì¹™ (ì „ê¸°): âˆ‡Â·E = Ï/Îµâ‚€ ===</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="n">Ex</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="mi">3</span>
<span class="n">Ey</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="mi">3</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(1) ê°€ìš°ìŠ¤ ë²•ì¹™: âˆ‡Â·E = Ï/Îµâ‚€</span><span class="se">\n</span><span class="s1">ì „í•˜ â†’ ë°œì‚°í•˜ëŠ” E&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># === (2) ê°€ìš°ìŠ¤ ë²•ì¹™ (ìê¸°): âˆ‡Â·B = 0 ===</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># ìê¸° ìŒê·¹ì (ë‹¨ê·¹ì ì—†ìŒ)</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R1</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">R1</span><span class="p">)</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R2</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">R2</span><span class="p">)</span>
<span class="n">Bx</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">R1</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">X</span> <span class="o">/</span> <span class="n">R2</span><span class="o">**</span><span class="mi">3</span>
<span class="n">By</span> <span class="o">=</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">R1</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">R2</span><span class="o">**</span><span class="mi">3</span>
<span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">speed</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span>
              <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(2) ê°€ìš°ìŠ¤ ë²•ì¹™: âˆ‡Â·B = 0</span><span class="se">\n</span><span class="s1">ìê¸°ì¥ì„ ì€ ë‹«íŒ ë£¨í”„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># === (3) íŒ¨ëŸ¬ë°ì´ ë²•ì¹™: âˆ‡Ã—E = -âˆ‚B/âˆ‚t ===</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1"># ë³€í•˜ëŠ” ìê¸°ì¥ â†’ ìœ ë„ ì „ê¸°ì¥ (ì›í˜•)</span>
<span class="n">R_circ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R_circ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R_circ</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">R_circ</span><span class="p">)</span>
<span class="n">Ex_ind</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span> <span class="o">/</span> <span class="n">R_circ</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Ey_ind</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">R_circ</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ex_ind</span><span class="p">,</span> <span class="n">Ey_ind</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;dB/dt</span><span class="se">\n</span><span class="s1">(z ë°©í–¥)&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(3) íŒ¨ëŸ¬ë°ì´: âˆ‡Ã—E = -âˆ‚B/âˆ‚t</span><span class="se">\n</span><span class="s1">ë³€í•˜ëŠ” B â†’ ìœ ë„ E&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># === (4) ì•™í˜ë¥´-ë§¥ìŠ¤ì›°: âˆ‡Ã—B = Î¼â‚€J + Î¼â‚€Îµâ‚€ âˆ‚E/âˆ‚t ===</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">R_wire</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R_wire</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R_wire</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">R_wire</span><span class="p">)</span>
<span class="n">Bx_wire</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span> <span class="o">/</span> <span class="n">R_wire</span><span class="o">**</span><span class="mi">2</span>
<span class="n">By_wire</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">R_wire</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx_wire</span><span class="p">,</span> <span class="n">By_wire</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;I or âˆ‚E/âˆ‚t</span><span class="se">\n</span><span class="s1">(z ë°©í–¥)&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightyellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(4) ì•™í˜ë¥´-ë§¥ìŠ¤ì›°: âˆ‡Ã—B = Î¼â‚€J + Î¼â‚€Îµâ‚€âˆ‚E/âˆ‚t</span><span class="se">\n</span><span class="s1">ì „ë¥˜/ë³€í•˜ëŠ” E â†’ B&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ë§¥ìŠ¤ì›° ë°©ì •ì‹ì˜ 4ê°€ì§€ ë²•ì¹™&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;maxwell_equations.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-gradient-and-directional-derivative">Problem 1: Gradient and Directional Derivative<a class="header-link" href="#problem-1-gradient-and-directional-derivative" title="Permanent link">&para;</a></h3>
<p>For scalar field $f(x, y, z) = x^2 y + y^2 z + z^2 x$:
1. Find $\nabla f$.
2. Calculate the directional derivative at point $(1, 1, 1)$ in direction $\hat{u} = \frac{1}{\sqrt{3}}(1, 1, 1)$.
3. At point $(1, 1, 1)$, find the direction of fastest increase of $f$ and its rate.</p>
<h3 id="problem-2-divergence-and-curl">Problem 2: Divergence and Curl<a class="header-link" href="#problem-2-divergence-and-curl" title="Permanent link">&para;</a></h3>
<p>Calculate the divergence and curl of the following vector fields, and determine if they are conservative:</p>
<p>(a) $\mathbf{F} = (yz, xz, xy)$</p>
<p>(b) $\mathbf{G} = (x^2 - y, y^2 + x, z)$</p>
<p>If conservative, find the potential function.</p>
<h3 id="problem-3-line-integrals">Problem 3: Line Integrals<a class="header-link" href="#problem-3-line-integrals" title="Permanent link">&para;</a></h3>
<p>For vector field $\mathbf{F} = (2xy + z^2)\hat{x} + x^2\hat{y} + 2xz\hat{z}$:
1. Show that $\mathbf{F}$ is conservative and find potential function $\phi$.
2. Calculate the line integral from $(0, 0, 0)$ to $(1, 2, 3)$ using (a) the potential function, (b) direct integration along straight path $\mathbf{r}(t) = (t, 2t, 3t)$, and verify they match.</p>
<h3 id="problem-4-divergence-theorem-verification">Problem 4: Divergence Theorem Verification<a class="header-link" href="#problem-4-divergence-theorem-verification" title="Permanent link">&para;</a></h3>
<p>For $\mathbf{F} = (x^2, y^2, z^2)$ in the unit cube $[0,1]^3$, verify the divergence theorem:
1. Calculate $\nabla \cdot \mathbf{F}$ and compute the volume integral.
2. Calculate surface integrals on all 6 faces and sum them.
3. Verify that the two results match.</p>
<h3 id="problem-5-stokes-theorem-and-physical-application">Problem 5: Stokes' Theorem and Physical Application<a class="header-link" href="#problem-5-stokes-theorem-and-physical-application" title="Permanent link">&para;</a></h3>
<p>For uniform current density $\mathbf{J} = J_0 \hat{z}$ in a cylindrical wire of radius $a$:
1. Use AmpÃ¨re's law (integral form) to find magnetic field $\mathbf{B}$ for $r < a$ and $r > a$.
2. For $r < a$, directly verify that $\nabla \times \mathbf{B} = \mu_0 \mathbf{J}$ (use cylindrical coordinate curl formula).</p>
<h3 id="problem-6-maxwell-equation-transformation">Problem 6: Maxwell Equation Transformation<a class="header-link" href="#problem-6-maxwell-equation-transformation" title="Permanent link">&para;</a></h3>
<p>From Faraday's law integral form:</p>
<p>$$
\oint_C \mathbf{E} \cdot d\mathbf{r} = -\frac{d}{dt}\iint_S \mathbf{B} \cdot d\mathbf{S}
$$</p>
<p>Use Stokes' theorem to derive the differential form $\nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}$. Describe the derivation step by step.</p>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<h3 id="textbooks">Textbooks<a class="header-link" href="#textbooks" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Boas, M. L.</strong> (2005). <em>Mathematical Methods in the Physical Sciences</em>, 3rd ed., Chapter 6. Wiley.</li>
<li><strong>Griffiths, D. J.</strong> (2017). <em>Introduction to Electrodynamics</em>, 4th ed. Cambridge University Press.</li>
<li>Excellent reference for electromagnetic applications of vector analysis</li>
<li><strong>Arfken, G. B., Weber, H. J., &amp; Harris, F. E.</strong> (2012). <em>Mathematical Methods for Physicists</em>, 7th ed., Chapters 1-3. Academic Press.</li>
<li><strong>Schey, H. M.</strong> (2005). <em>Div, Grad, Curl, and All That</em>, 4th ed. W.W. Norton.</li>
<li>Intuitive introduction to vector analysis</li>
</ol>
<h3 id="online-resources">Online Resources<a class="header-link" href="#online-resources" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>3Blue1Brown</strong> â€” <a href="https://www.youtube.com/watch?v=rB83DpBJQsE">Divergence and Curl</a>: Visual understanding of divergence and curl</li>
<li><strong>MIT OCW 18.02</strong> â€” Multivariable Calculus: Vector analysis lectures</li>
<li><strong>Paul's Online Math Notes</strong> â€” Calculus III: Rich practice problems</li>
</ol>
<h3 id="python-tools">Python Tools<a class="header-link" href="#python-tools" title="Permanent link">&para;</a></h3>
<ul>
<li><code>sympy.vector</code>: Symbolic vector calculus (<code>gradient</code>, <code>divergence</code>, <code>curl</code>)</li>
<li><code>matplotlib.pyplot.quiver</code>: 2D vector field arrow visualization</li>
<li><code>matplotlib.pyplot.streamplot</code>: Streamline visualization</li>
<li><code>mpl_toolkits.mplot3d</code>: 3D surface and vector visualization</li>
</ul>
<hr />
<h2 id="next-lesson">Next Lesson<a class="header-link" href="#next-lesson" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Previous</strong>: <a href="02_Complex_Numbers.md">02. Complex Numbers</a> â€” Complex algebra, polar/exponential form, De Moivre's theorem</li>
<li><strong>Next</strong>: <a href="04_Curvilinear_Coordinates.md">04. Curvilinear Coordinates and Multiple Integrals</a> â€” Cylindrical/spherical coordinates, Jacobian, coordinate transformations</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/04_Partial_Differentiation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">04. Partial Differentiation</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/06_Curvilinear_Coordinates.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">06. Curvilinear Coordinates and Multiple Integrals</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}