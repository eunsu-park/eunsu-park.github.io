{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11. Series Solutions and Special Functions (ê¸‰ìˆ˜í•´ì™€ íŠ¹ìˆ˜í•¨ìˆ˜) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Mathematical_Methods/">Mathematical Methods</a>
    <span class="separator">/</span>
    <span class="current">11. Series Solutions and Special Functions (ê¸‰ìˆ˜í•´ì™€ íŠ¹ìˆ˜í•¨ìˆ˜)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>11. Series Solutions and Special Functions (ê¸‰ìˆ˜í•´ì™€ íŠ¹ìˆ˜í•¨ìˆ˜)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/10_Higher_Order_ODE_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. Higher-Order ODE and Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/12_Sturm_Liouville_Theory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. Sturm-Liouville Theory (ìŠ¤íˆ¬ë¦„-ë¦¬ìš°ë¹Œ ì´ë¡ )</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-power-series-method">1. Power Series Method</a><ul>
<li><a href="#11-ordinary-points-and-singular-points">1.1 Ordinary Points and Singular Points</a></li>
<li><a href="#12-series-solutions-around-ordinary-points">1.2 Series Solutions Around Ordinary Points</a></li>
</ul>
</li>
<li><a href="#2-frobenius-method">2. Frobenius Method</a><ul>
<li><a href="#21-regular-singular-points">2.1 Regular Singular Points</a></li>
<li><a href="#22-indicial-equation">2.2 Indicial Equation</a></li>
<li><a href="#23-three-cases">2.3 Three Cases</a></li>
</ul>
</li>
<li><a href="#3-bessel-functions">3. Bessel Functions</a><ul>
<li><a href="#31-bessels-equation">3.1 Bessel's Equation</a></li>
<li><a href="#32-bessel-functions-of-the-first-and-second-kind">3.2 Bessel Functions of the First and Second Kind</a></li>
<li><a href="#33-orthogonality-and-series-expansion">3.3 Orthogonality and Series Expansion</a></li>
<li><a href="#34-physics-applications-circular-membrane-vibration-cylindrical-problems">3.4 Physics Applications (Circular Membrane Vibration, Cylindrical Problems)</a></li>
<li><a href="#35-modified-bessel-functions">3.5 Modified Bessel Functions</a></li>
</ul>
</li>
<li><a href="#4-legendre-polynomials">4. Legendre Polynomials</a><ul>
<li><a href="#41-legendres-equation">4.1 Legendre's Equation</a></li>
<li><a href="#42-rodrigues-formula-and-generating-function">4.2 Rodrigues' Formula and Generating Function</a></li>
<li><a href="#43-orthogonality-and-series-expansion">4.3 Orthogonality and Series Expansion</a></li>
<li><a href="#44-physics-applications-multipole-expansion-spherically-symmetric-problems">4.4 Physics Applications (Multipole Expansion, Spherically Symmetric Problems)</a></li>
<li><a href="#45-associated-legendre-functions-and-spherical-harmonics">4.5 Associated Legendre Functions and Spherical Harmonics</a><ul>
<li><a href="#associated-legendre-functions">Associated Legendre Functions</a></li>
<li><a href="#spherical-harmonics">Spherical Harmonics</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#5-hermite-and-laguerre-functions">5. Hermite and Laguerre Functions</a><ul>
<li><a href="#51-hermite-functions-and-quantum-harmonic-oscillator">5.1 Hermite Functions and Quantum Harmonic Oscillator</a></li>
<li><a href="#52-laguerre-functions-and-hydrogen-atom">5.2 Laguerre Functions and Hydrogen Atom</a></li>
</ul>
</li>
<li><a href="#6-gamma-and-beta-functions">6. Gamma and Beta Functions</a><ul>
<li><a href="#61-definition-and-properties-of-the-gamma-function">6.1 Definition and Properties of the Gamma Function</a></li>
<li><a href="#62-beta-function">6.2 Beta Function</a></li>
</ul>
</li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#basic-problems">Basic Problems</a></li>
<li><a href="#application-problems">Application Problems</a></li>
</ul>
</li>
<li><a href="#references">References</a><ul>
<li><a href="#textbooks">Textbooks</a></li>
<li><a href="#online-resources">Online Resources</a></li>
<li><a href="#core-library-documentation">Core Library Documentation</a></li>
</ul>
</li>
<li><a href="#next-lesson">Next Lesson</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="11-series-solutions-and-special-functions">11. Series Solutions and Special Functions (ê¸‰ìˆ˜í•´ì™€ íŠ¹ìˆ˜í•¨ìˆ˜)<a class="header-link" href="#11-series-solutions-and-special-functions" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Distinguish between <strong>ordinary points</strong> and <strong>singular points</strong>, and apply the <strong>power series method</strong> around ordinary points</li>
<li>Solve for series solutions around <strong>regular singular points</strong> using the <strong>Frobenius method</strong>, and handle the three cases of the <strong>indicial equation</strong></li>
<li>Understand the properties, orthogonality, and recurrence relations of <strong>Bessel functions</strong> $J_n(x)$, $Y_n(x)$ and apply them to cylindrical coordinate problems</li>
<li>Understand Rodrigues' formula, generating functions, and orthogonality of <strong>Legendre polynomials</strong> $P_l(x)$ and apply them to spherical coordinate problems</li>
<li>Understand how <strong>Hermite functions</strong> and <strong>Laguerre functions</strong> appear in quantum mechanics problems (harmonic oscillator and hydrogen atom)</li>
<li>Know the definitions, properties, and relationships between <strong>gamma functions</strong> and <strong>beta functions</strong>, and apply them to integral calculations</li>
</ul>
<hr />
<h2 id="1-power-series-method">1. Power Series Method<a class="header-link" href="#1-power-series-method" title="Permanent link">&para;</a></h2>
<h3 id="11-ordinary-points-and-singular-points">1.1 Ordinary Points and Singular Points<a class="header-link" href="#11-ordinary-points-and-singular-points" title="Permanent link">&para;</a></h3>
<p>Consider the standard form of a second-order linear ODE:</p>
<p>$$y'' + P(x)y' + Q(x)y = 0$$</p>
<p>Classification at point $x = x_0$:</p>
<table>
<thead>
<tr>
<th>Classification</th>
<th>Condition</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ordinary point</strong></td>
<td>$P(x)$, $Q(x)$ are analytic at $x_0$</td>
<td>$x_0 = 0$ for $y'' + y = 0$</td>
</tr>
<tr>
<td><strong>Regular singular point</strong></td>
<td>$(x-x_0)P(x)$, $(x-x_0)^2 Q(x)$ are analytic</td>
<td>$x_0 = 0$ for Bessel's equation</td>
</tr>
<tr>
<td><strong>Irregular singular point</strong></td>
<td>Neither of the above</td>
<td>$x_0 = 0$ for $x^3 y'' + y = 0$</td>
</tr>
</tbody>
</table>
<p>At ordinary points, we use the <strong>power series method</strong>; at regular singular points, we use the <strong>Frobenius method</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># --- íŠ¹ì´ì  ë¶„ë¥˜ ---</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ: ë² ì…€ ë°©ì •ì‹ x^2 y&#39;&#39; + x y&#39; + (x^2 - n^2) y = 0</span>
<span class="c1"># í‘œì¤€í˜•ìœ¼ë¡œ ë³€í™˜: y&#39;&#39; + (1/x) y&#39; + (1 - n^2/x^2) y = 0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">P_bessel</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">x</span>
<span class="n">Q_bessel</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># x = 0ì—ì„œì˜ ë¶„ë¥˜</span>
<span class="n">xP</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">P_bessel</span><span class="p">)</span>   <span class="c1"># x * (1/x) = 1 (í•´ì„ì )</span>
<span class="n">x2Q</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q_bessel</span><span class="p">)</span>  <span class="c1"># x^2 * (1 - n^2/x^2) = x^2 - n^2 (í•´ì„ì )</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë² ì…€ ë°©ì •ì‹ (x=0):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  P(x) = </span><span class="si">{</span><span class="n">P_bessel</span><span class="si">}</span><span class="s2">  â†’  x=0ì—ì„œ íŠ¹ì´&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  xÂ·P(x) = </span><span class="si">{</span><span class="n">xP</span><span class="si">}</span><span class="s2">  â†’  í•´ì„ì &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  xÂ²Â·Q(x) = </span><span class="si">{</span><span class="n">x2Q</span><span class="si">}</span><span class="s2">  â†’  í•´ì„ì &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê²°ë¡ : x=0ì€ ì •ì¹™ íŠ¹ì´ì &quot;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ: ì—ì–´ë¦¬ ë°©ì •ì‹ y&#39;&#39; - x y = 0</span>
<span class="n">P_airy</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Q_airy</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì—ì–´ë¦¬ ë°©ì •ì‹ (x=0):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  P(x) = </span><span class="si">{</span><span class="n">P_airy</span><span class="si">}</span><span class="s2">, Q(x) = </span><span class="si">{</span><span class="n">Q_airy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ë‘˜ ë‹¤ x=0ì—ì„œ í•´ì„ì  â†’ x=0ì€ ì •ìƒì &quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="12-series-solutions-around-ordinary-points">1.2 Series Solutions Around Ordinary Points<a class="header-link" href="#12-series-solutions-around-ordinary-points" title="Permanent link">&para;</a></h3>
<p>Around an ordinary point $x_0 = 0$, we assume a solution as a power series:</p>
<p>$$y = \sum_{n=0}^{\infty} a_n x^n$$</p>
<p>Substitute this into the ODE to derive a <strong>recurrence relation</strong> and determine the coefficients $a_n$ sequentially.</p>
<p><strong>Example: Airy Equation</strong> $y'' - xy = 0$</p>
<p>$$\sum_{n=2}^{\infty} n(n-1) a_n x^{n-2} - \sum_{n=0}^{\infty} a_n x^{n+1} = 0$$</p>
<p>Aligning the indices (with substitution $m = n-2$):</p>
<p>$$\sum_{m=0}^{\infty} (m+2)(m+1) a_{m+2} x^m - \sum_{m=1}^{\infty} a_{m-1} x^m = 0$$</p>
<p>$x^0$ term: $2 \cdot 1 \cdot a_2 = 0 \;\Rightarrow\; a_2 = 0$</p>
<p>$x^m$ ($m \geq 1$) term: $(m+2)(m+1) a_{m+2} = a_{m-1}$</p>
<p>$$\boxed{a_{m+2} = \frac{a_{m-1}}{(m+2)(m+1)}, \quad m \geq 1}$$</p>
<p>$a_0$ and $a_1$ are free parameters (initial conditions), so we obtain two linearly independent solutions.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">airy</span>

<span class="c1"># --- ì—ì–´ë¦¬ ë°©ì •ì‹ì˜ ê¸‰ìˆ˜í•´ ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">airy_series</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">N_terms</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì—ì–´ë¦¬ ë°©ì •ì‹ y&#39;&#39; - xy = 0ì˜ ë©±ê¸‰ìˆ˜ í•´&quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_terms</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a0</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a1</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># a_2 = 0 í•­ìƒ</span>

    <span class="c1"># ì í™” ê´€ê³„: a[m+2] = a[m-1] / ((m+2)*(m+1)), m &gt;= 1</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_terms</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">((</span><span class="n">m</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">result</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_val</span><span class="o">**</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_terms</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># SciPyì˜ ì—ì–´ë¦¬ í•¨ìˆ˜ì™€ ë¹„êµ</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">Ai</span><span class="p">,</span> <span class="n">Aip</span><span class="p">,</span> <span class="n">Bi</span><span class="p">,</span> <span class="n">Bip</span> <span class="o">=</span> <span class="n">airy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># ê¸‰ìˆ˜í•´ (ìˆ˜ë ´ ë²”ìœ„ ë‚´ì—ì„œ)</span>
<span class="n">x_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">y_series_Ai</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">airy_series</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N_terms</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">])</span>
<span class="n">y_series_Bi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">airy_series</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_terms</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">])</span>

<span class="c1"># ì •ê·œí™” ìƒìˆ˜ (SciPy ì—ì–´ë¦¬ í•¨ìˆ˜ì™€ ë§ì¶”ê¸°)</span>
<span class="n">c_Ai</span> <span class="o">=</span> <span class="n">airy</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Ai(0)</span>
<span class="n">c_Bi</span> <span class="o">=</span> <span class="n">airy</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Bi(0)</span>
<span class="n">c_Ai_prime</span> <span class="o">=</span> <span class="n">airy</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Ai&#39;(0)</span>
<span class="n">c_Bi_prime</span> <span class="o">=</span> <span class="n">airy</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Bi&#39;(0)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Ai(x): ì œ1ì¢… ì—ì–´ë¦¬ í•¨ìˆ˜</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ai</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ai(x) (SciPy)&#39;</span><span class="p">)</span>
<span class="n">y_approx</span> <span class="o">=</span> <span class="n">c_Ai</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">airy_series</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">])</span> \
         <span class="o">+</span> <span class="n">c_Ai_prime</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">airy_series</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_series</span><span class="p">,</span> <span class="n">y_approx</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê¸‰ìˆ˜í•´ (60í•­)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Ai(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì—ì–´ë¦¬ í•¨ìˆ˜ Ai(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Bi(x): ì œ2ì¢… ì—ì–´ë¦¬ í•¨ìˆ˜</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Bi</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bi(x) (SciPy)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Bi(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì—ì–´ë¦¬ í•¨ìˆ˜ Bi(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ì—ì–´ë¦¬ ë°©ì •ì‹ $y</span><span class="se">\&#39;\&#39;</span><span class="s1"> - xy = 0$ì˜ í•´&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;airy_functions.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="2-frobenius-method">2. Frobenius Method<a class="header-link" href="#2-frobenius-method" title="Permanent link">&para;</a></h2>
<h3 id="21-regular-singular-points">2.1 Regular Singular Points<a class="header-link" href="#21-regular-singular-points" title="Permanent link">&para;</a></h3>
<p>Around a regular singular point $x_0 = 0$, a general power series may not converge. Instead, we assume a <strong>Frobenius series</strong>:</p>
<p>$$y = x^s \sum_{n=0}^{\infty} a_n x^n = \sum_{n=0}^{\infty} a_n x^{n+s}, \quad a_0 \neq 0$$</p>
<p>Here, $s$ is an unknown <strong>index</strong> to be determined by substituting into the ODE.</p>
<h3 id="22-indicial-equation">2.2 Indicial Equation<a class="header-link" href="#22-indicial-equation" title="Permanent link">&para;</a></h3>
<p>Write the ODE in the form $x^2 y'' + x b(x) y' + c(x) y = 0$ (where $b(x) = xP(x)$, $c(x) = x^2 Q(x)$), and substitute the Frobenius series. The coefficient of the lowest power ($x^s$) gives the <strong>indicial equation</strong>:</p>
<p>$$\boxed{s(s-1) + b_0 s + c_0 = 0}$$</p>
<p>where $b_0 = b(0)$, $c_0 = c(0)$. The two roots $s_1, s_2$ ($s_1 \geq s_2$) of this quadratic equation determine the form of the series solutions.</p>
<h3 id="23-three-cases">2.3 Three Cases<a class="header-link" href="#23-three-cases" title="Permanent link">&para;</a></h3>
<p>The difference $s_1 - s_2$ between the two roots of the indicial equation leads to three cases:</p>
<table>
<thead>
<tr>
<th>Case</th>
<th>Condition</th>
<th>Form of Solutions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Case 1</strong></td>
<td>$s_1 - s_2 \notin \mathbb{Z}$ (non-integer)</td>
<td>$y_1 = x^{s_1}\sum a_n x^n$, $y_2 = x^{s_2}\sum b_n x^n$</td>
</tr>
<tr>
<td><strong>Case 2</strong></td>
<td>$s_1 = s_2$ (repeated root)</td>
<td>$y_1 = x^s \sum a_n x^n$, $y_2 = y_1 \ln x + x^s \sum b_n x^n$</td>
</tr>
<tr>
<td><strong>Case 3</strong></td>
<td>$s_1 - s_2 \in \mathbb{Z}^+$ (positive integer)</td>
<td>$y_2$ may or may not contain a $\ln x$ term</td>
</tr>
</tbody>
</table>
<p><strong>Example: Bessel's Equation</strong> $x^2 y'' + x y' + (x^2 - \nu^2)y = 0$</p>
<p>$b(x) = 1$, $c(x) = x^2 - \nu^2$, so $b_0 = 1$, $c_0 = -\nu^2$.</p>
<p>Indicial equation: $s(s-1) + s - \nu^2 = s^2 - \nu^2 = 0$</p>
<p>$$s_1 = \nu, \quad s_2 = -\nu$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># --- í”„ë¡œë² ë‹ˆìš°ìŠ¤ ë°©ë²•: ë² ì…€ ë°©ì •ì‹ì˜ ì§€í‘œ ë°©ì •ì‹ ---</span>
<span class="n">s</span><span class="p">,</span> <span class="n">nu</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;s nu&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ì§€í‘œ ë°©ì •ì‹: s(s-1) + b0*s + c0 = 0</span>
<span class="n">b0</span> <span class="o">=</span> <span class="mi">1</span>        <span class="c1"># b(0) = 1</span>
<span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="n">nu</span><span class="o">**</span><span class="mi">2</span>   <span class="c1"># c(0) = -nu^2</span>

<span class="n">indicial_eq</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">c0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì§€í‘œ ë°©ì •ì‹: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">indicial_eq</span><span class="p">)</span><span class="si">}</span><span class="s2"> = 0&quot;</span><span class="p">)</span>
<span class="n">roots</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">indicial_eq</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì§€í‘œê·¼: s1 = </span><span class="si">{</span><span class="n">roots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, s2 = </span><span class="si">{</span><span class="n">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># nu = 0: ì¤‘ê·¼ (ê²½ìš° 2) â†’ ì œ2ì¢… ë² ì…€ í•¨ìˆ˜ì— ln í•­ í¬í•¨</span>
<span class="c1"># nu = 1/2: ë¹„ì •ìˆ˜ ì°¨ì´ (ê²½ìš° 1) â†’ ë‘ ë…ë¦½ ê¸‰ìˆ˜í•´</span>
<span class="c1"># nu = 1: ì •ìˆ˜ ì°¨ì´ (ê²½ìš° 3) â†’ ì£¼ì˜ í•„ìš”</span>
<span class="k">for</span> <span class="n">nu_val</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nu_val</span>  <span class="c1"># s1 - s2 = 2*nu</span>
    <span class="n">case</span> <span class="o">=</span> <span class="s2">&quot;ê²½ìš° 2 (ì¤‘ê·¼)&quot;</span> <span class="k">if</span> <span class="n">diff</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> \
           <span class="p">(</span><span class="s2">&quot;ê²½ìš° 1 (ë¹„ì •ìˆ˜)&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="o">.</span><span class="n">is_integer</span> <span class="k">else</span> <span class="s2">&quot;ê²½ìš° 3 (ì •ìˆ˜ ì°¨ì´)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  nu = </span><span class="si">{</span><span class="n">nu_val</span><span class="si">}</span><span class="s2">: s1-s2 = </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2"> â†’ </span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3-bessel-functions">3. Bessel Functions<a class="header-link" href="#3-bessel-functions" title="Permanent link">&para;</a></h2>
<h3 id="31-bessels-equation">3.1 Bessel's Equation<a class="header-link" href="#31-bessels-equation" title="Permanent link">&para;</a></h3>
<p><strong>Bessel's equation</strong> arises naturally when separating variables in Laplace's equation or Helmholtz equation in cylindrical coordinates:</p>
<p>$$x^2 y'' + x y' + (x^2 - \nu^2) y = 0$$</p>
<p>Here, $\nu \geq 0$ is the <strong>order</strong>. This equation is one of the most commonly encountered second-order ODEs in physics.</p>
<h3 id="32-bessel-functions-of-the-first-and-second-kind">3.2 Bessel Functions of the First and Second Kind<a class="header-link" href="#32-bessel-functions-of-the-first-and-second-kind" title="Permanent link">&para;</a></h3>
<p>The <strong>Bessel function of the first kind</strong> $J_\nu(x)$ is the solution with index $s = \nu$ obtained by the Frobenius method:</p>
<p>$$J_\nu(x) = \sum_{k=0}^{\infty} \frac{(-1)^k}{k! \, \Gamma(k + \nu + 1)} \left(\frac{x}{2}\right)^{2k + \nu}$$</p>
<p>The <strong>Bessel function of the second kind</strong> $Y_\nu(x)$ (Neumann function) is the second solution linearly independent of $J_\nu$:</p>
<p>$$Y_\nu(x) = \frac{J_\nu(x) \cos(\nu\pi) - J_{-\nu}(x)}{\sin(\nu\pi)}$$</p>
<p>When $\nu$ is an integer, this formula becomes the indeterminate form $0/0$, so it is defined as a limit.</p>
<p><strong>Key Properties</strong>:
- $J_\nu(x)$: finite at $x = 0$ (when $\nu \geq 0$)
- $Y_\nu(x)$: diverges to $-\infty$ as $x \to 0^+$
- Asymptotic behavior ($x \to \infty$): $J_\nu(x) \sim \sqrt{\frac{2}{\pi x}} \cos\left(x - \frac{\nu\pi}{2} - \frac{\pi}{4}\right)$</p>
<p><strong>Recurrence relations</strong>:</p>
<p>$$J_{\nu-1}(x) + J_{\nu+1}(x) = \frac{2\nu}{x} J_\nu(x)$$</p>
<p>$$J_{\nu-1}(x) - J_{\nu+1}(x) = 2 J_\nu'(x)$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">jv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="n">jn_zeros</span>

<span class="c1"># --- ë² ì…€ í•¨ìˆ˜ ì‹œê°í™” ---</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ì œ1ì¢… ë² ì…€ í•¨ìˆ˜</span>
<span class="k">for</span> <span class="n">nu</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">jv</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$J_</span><span class="se">{{</span><span class="si">{</span><span class="n">nu</span><span class="si">}</span><span class="se">}}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$J_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì œ1ì¢… ë² ì…€ í•¨ìˆ˜ $J_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ì œ2ì¢… ë² ì…€ í•¨ìˆ˜</span>
<span class="k">for</span> <span class="n">nu</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yv</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$Y_</span><span class="se">{{</span><span class="si">{</span><span class="n">nu</span><span class="si">}</span><span class="se">}}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$Y_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì œ2ì¢… ë² ì…€ í•¨ìˆ˜ $Y_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bessel_functions.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># --- ì í™”ì‹ ê²€ì¦ ---</span>
<span class="n">nu_test</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># J_{nu-1} + J_{nu+1} = (2*nu/x) * J_nu</span>
<span class="n">lhs</span> <span class="o">=</span> <span class="n">jv</span><span class="p">(</span><span class="n">nu_test</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_test</span><span class="p">)</span> <span class="o">+</span> <span class="n">jv</span><span class="p">(</span><span class="n">nu_test</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_test</span><span class="p">)</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">nu_test</span> <span class="o">/</span> <span class="n">x_test</span><span class="p">)</span> <span class="o">*</span> <span class="n">jv</span><span class="p">(</span><span class="n">nu_test</span><span class="p">,</span> <span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì í™”ì‹ ê²€ì¦ (nu=</span><span class="si">{</span><span class="n">nu_test</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  max|LHS - RHS| = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lhs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rhs</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="33-orthogonality-and-series-expansion">3.3 Orthogonality and Series Expansion<a class="header-link" href="#33-orthogonality-and-series-expansion" title="Permanent link">&para;</a></h3>
<p>If the zeros of $J_\nu$ are denoted $\alpha_{\nu,1} < \alpha_{\nu,2} < \cdots$, then the following <strong>orthogonality</strong> holds on the interval $[0, a]$:</p>
<p>$$\int_0^a x \, J_\nu\!\left(\frac{\alpha_{\nu,m}}{a} x\right) J_\nu\!\left(\frac{\alpha_{\nu,n}}{a} x\right) dx = \begin{cases} 0 & m \neq n \\ \frac{a^2}{2} [J_{\nu+1}(\alpha_{\nu,n})]^2 & m = n \end{cases}$$</p>
<p>Using this, a function $f(r)$ defined on the interval $[0, a]$ can be expanded in a <strong>Fourier-Bessel series</strong>:</p>
<p>$$f(r) = \sum_{n=1}^{\infty} c_n J_\nu\!\left(\frac{\alpha_{\nu,n}}{a} r\right)$$</p>
<p>$$c_n = \frac{2}{a^2 [J_{\nu+1}(\alpha_{\nu,n})]^2} \int_0^a r \, f(r) \, J_\nu\!\left(\frac{\alpha_{\nu,n}}{a} r\right) dr$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">jv</span><span class="p">,</span> <span class="n">jn_zeros</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- í‘¸ë¦¬ì—-ë² ì…€ ê¸‰ìˆ˜ ì˜ˆì œ: f(r) = 1ì„ J_0 ê¸‰ìˆ˜ë¡œ ì „ê°œ ---</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># êµ¬ê°„ [0, a]</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">N_terms</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># J_0ì˜ ì˜ì </span>
<span class="n">zeros</span> <span class="o">=</span> <span class="n">jn_zeros</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">N_terms</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_bessel_coeff</span><span class="p">(</span><span class="n">n_idx</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;í‘¸ë¦¬ì—-ë² ì…€ ê³„ìˆ˜ c_n ê³„ì‚°&quot;&quot;&quot;</span>
    <span class="n">alpha_n</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">[</span><span class="n">n_idx</span><span class="p">]</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">jv</span><span class="p">(</span><span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha_n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">integrand</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span> <span class="o">*</span> <span class="n">func</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">jv</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">alpha_n</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">integral</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">integral</span> <span class="o">/</span> <span class="n">norm</span>

<span class="c1"># f(r) = 1</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="mf">1.0</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">compute_bessel_coeff</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">nu</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_terms</span><span class="p">)]</span>

<span class="c1"># ê¸‰ìˆ˜ ì¬êµ¬ì„±</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">f_approx</span> <span class="o">=</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">f_approx</span><span class="p">:</span>
    <span class="n">f_approx</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">jv</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">zeros</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(r) = 1$&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">N</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">f_approx</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ë² ì…€ ê¸‰ìˆ˜ (</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">í•­)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(r)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;í‘¸ë¦¬ì—-ë² ì…€ ê¸‰ìˆ˜ ì „ê°œ: $f(r) = 1$ on $[0, 1]$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fourier_bessel_series.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="34-physics-applications-circular-membrane-vibration-cylindrical-problems">3.4 Physics Applications (Circular Membrane Vibration, Cylindrical Problems)<a class="header-link" href="#34-physics-applications-circular-membrane-vibration-cylindrical-problems" title="Permanent link">&para;</a></h3>
<p><strong>Circular membrane vibration</strong>: The vibration of a circular membrane of radius $a$ with fixed boundary is obtained by solving the 2D wave equation in polar coordinates:</p>
<p>$$u(r, \theta, t) = \sum_{m=0}^{\infty} \sum_{n=1}^{\infty} J_m\!\left(\frac{\alpha_{m,n}}{a} r\right) \left(A_{mn} \cos m\theta + B_{mn} \sin m\theta\right) \cos(\omega_{mn} t)$$</p>
<p>where $\omega_{mn} = c \, \alpha_{m,n}/a$ and $c$ is the wave speed. The boundary condition $u(a, \theta, t) = 0$ requires $J_m(\alpha_{m,n}) = 0$.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">jv</span><span class="p">,</span> <span class="n">jn_zeros</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- ì›í˜• ë§‰ì˜ ì •ìƒ ì§„ë™ ëª¨ë“œ ì‹œê°í™” ---</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;polar&#39;</span><span class="p">})</span>

<span class="n">modes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
         <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">modes</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">3</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>

    <span class="n">alpha_mn</span> <span class="o">=</span> <span class="n">jn_zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># në²ˆì§¸ ì˜ì </span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

    <span class="n">Z</span> <span class="o">=</span> <span class="n">jv</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">alpha_mn</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">Theta</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ëª¨ë“œ ($m$=</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1">, $n$=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>
                 <span class="sa">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha_</span><span class="se">{{</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="se">}}</span><span class="s1">$ = </span><span class="si">{</span><span class="n">alpha_mn</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_rticks</span><span class="p">([])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ì›í˜• ë§‰ ì§„ë™ ëª¨ë“œ â€” $J_m(</span><span class="se">\\</span><span class="s1">alpha_{m,n} r/a) </span><span class="se">\\</span><span class="s1">cos(m</span><span class="se">\\</span><span class="s1">theta)$&#39;</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;circular_membrane_modes.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># --- ì •ìƒ ëª¨ë“œì˜ ì§„ë™ìˆ˜ ë¹„ìœ¨ ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì›í˜• ë§‰ ì •ìƒ ëª¨ë“œ ì§„ë™ìˆ˜ ë¹„ìœ¨ (f_mn / f_01):&quot;</span><span class="p">)</span>
<span class="n">alpha_01</span> <span class="o">=</span> <span class="n">jn_zeros</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">alpha_mn</span> <span class="o">=</span> <span class="n">jn_zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">alpha_mn</span> <span class="o">/</span> <span class="n">alpha_01</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  (m=</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">, n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">): alpha = </span><span class="si">{</span><span class="n">alpha_mn</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;f/f_01 = </span><span class="si">{</span><span class="n">ratio</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Physical meaning</strong>: The frequency ratios of a circular membrane vibration are inharmonic â€” this is why drums do not produce clear pitches like pianos.</p>
<h3 id="35-modified-bessel-functions">3.5 Modified Bessel Functions<a class="header-link" href="#35-modified-bessel-functions" title="Permanent link">&para;</a></h3>
<p>The <strong>modified Bessel equation</strong> appears when exponential behavior in the $z$-direction emerges in cylindrical coordinate problems:</p>
<p>$$x^2 y'' + x y' - (x^2 + \nu^2) y = 0$$</p>
<p>This is obtained from Bessel's equation by substituting $x \to ix$, and the solutions are <strong>modified Bessel functions</strong>:</p>
<ul>
<li><strong>Modified Bessel function of the first kind</strong> $I_\nu(x) = i^{-\nu} J_\nu(ix)$: <strong>exponentially increasing</strong> as $x \to \infty$ ($I_\nu(x) \sim \frac{e^x}{\sqrt{2\pi x}}$)</li>
<li><strong>Modified Bessel function of the second kind</strong> $K_\nu(x)$: <strong>exponentially decreasing</strong> as $x \to \infty$ ($K_\nu(x) \sim \sqrt{\frac{\pi}{2x}} e^{-x}$)</li>
</ul>
<p>Series representation:</p>
<p>$$I_\nu(x) = \sum_{k=0}^{\infty} \frac{1}{k! \, \Gamma(k+\nu+1)} \left(\frac{x}{2}\right)^{2k+\nu}$$</p>
<p>(Compared to Bessel $J_\nu$: no $(-1)^k$, so all terms are positive â†’ monotonically increasing without oscillation)</p>
<p><strong>Physics applications</strong>:
- Attenuated modes in cylindrical waveguides
- Steady-state heat conduction in circular cross-sections
- Yukawa potential $\propto K_0(mr)/r$
- Diffusion problems reducing to the modified Bessel equation</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">iv</span><span class="p">,</span> <span class="n">kv</span><span class="p">,</span> <span class="n">jv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># I_nu(x): ì œ1ì¢… ë³€í˜• ë² ì…€</span>
<span class="k">for</span> <span class="n">nu</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">iv</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$I_</span><span class="se">{{</span><span class="si">{</span><span class="n">nu</span><span class="si">}</span><span class="se">}}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$I_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì œ1ì¢… ë³€í˜• ë² ì…€ í•¨ìˆ˜ $I_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># K_nu(x): ì œ2ì¢… ë³€í˜• ë² ì…€</span>
<span class="k">for</span> <span class="n">nu</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kv</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$K_</span><span class="se">{{</span><span class="si">{</span><span class="n">nu</span><span class="si">}</span><span class="se">}}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$K_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì œ2ì¢… ë³€í˜• ë² ì…€ í•¨ìˆ˜ $K_</span><span class="se">\\</span><span class="s1">nu(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;modified_bessel.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># J_nu vs I_nu ë¹„êµ: ì§„ë™ vs ë‹¨ì¡°ì¦ê°€</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">jv</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$J_0(x)$ (ì§„ë™)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">iv</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$I_0(x)$ (ë‹¨ì¡°ì¦ê°€)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kv</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$K_0(x)$ (ë‹¨ì¡°ê°ì†Œ)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë² ì…€ $J_0$ vs ë³€í˜• ë² ì…€ $I_0$, $K_0$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4-legendre-polynomials">4. Legendre Polynomials<a class="header-link" href="#4-legendre-polynomials" title="Permanent link">&para;</a></h2>
<h3 id="41-legendres-equation">4.1 Legendre's Equation<a class="header-link" href="#41-legendres-equation" title="Permanent link">&para;</a></h3>
<p><strong>Legendre's equation</strong> appears when separating variables in Laplace's equation in spherical coordinates:</p>
<p>$$(1 - x^2) y'' - 2x y' + l(l+1) y = 0$$</p>
<p>where $x = \cos\theta$ and $l$ is a non-negative integer. The points $x = \pm 1$ are regular singular points.</p>
<p>When $l$ is a non-negative integer, one series solution terminates as a <strong>polynomial</strong>, which is the <strong>Legendre polynomial</strong> $P_l(x)$.</p>
<h3 id="42-rodrigues-formula-and-generating-function">4.2 Rodrigues' Formula and Generating Function<a class="header-link" href="#42-rodrigues-formula-and-generating-function" title="Permanent link">&para;</a></h3>
<p><strong>Rodrigues' formula</strong>:</p>
<p>$$P_l(x) = \frac{1}{2^l l!} \frac{d^l}{dx^l} (x^2 - 1)^l$$</p>
<p>First few Legendre polynomials:</p>
<table>
<thead>
<tr>
<th>$l$</th>
<th>$P_l(x)$</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>$1$</td>
</tr>
<tr>
<td>1</td>
<td>$x$</td>
</tr>
<tr>
<td>2</td>
<td>$\frac{1}{2}(3x^2 - 1)$</td>
</tr>
<tr>
<td>3</td>
<td>$\frac{1}{2}(5x^3 - 3x)$</td>
</tr>
<tr>
<td>4</td>
<td>$\frac{1}{8}(35x^4 - 30x^2 + 3)$</td>
</tr>
</tbody>
</table>
<p><strong>Generating function</strong>:</p>
<p>$$\frac{1}{\sqrt{1 - 2xt + t^2}} = \sum_{l=0}^{\infty} P_l(x) t^l, \quad |t| < 1$$</p>
<p>The physical meaning of this generating function: it appears when expanding $\frac{1}{|\mathbf{r} - \mathbf{r}'|}$, and is the core of <strong>multipole expansion</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">legendre</span>

<span class="c1"># --- ë¥´ì¥ë“œë¥´ ë‹¤í•­ì‹: SymPy ë¡œë“œë¦¬ê²ŒìŠ¤ ê³µì‹ ---</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rodrigues</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë¡œë“œë¦¬ê²ŒìŠ¤ ê³µì‹ìœ¼ë¡œ P_l(x) ê³„ì‚°&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">diff</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">l</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
    <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë¡œë“œë¦¬ê²ŒìŠ¤ ê³µì‹ìœ¼ë¡œ êµ¬í•œ ë¥´ì¥ë“œë¥´ ë‹¤í•­ì‹:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">Pl</span> <span class="o">=</span> <span class="n">rodrigues</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  P_</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">(x) = </span><span class="si">{</span><span class="n">Pl</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- ì‹œê°í™” ---</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">Pl</span> <span class="o">=</span> <span class="n">legendre</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">Pl</span><span class="p">(</span><span class="n">x_vals</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$P_</span><span class="se">{{</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="se">}}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$P_l(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ë¥´ì¥ë“œë¥´ ë‹¤í•­ì‹ $P_l(x)$, $l = 0, 1, </span><span class="se">\\</span><span class="s1">ldots, 5$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;legendre_polynomials.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="43-orthogonality-and-series-expansion">4.3 Orthogonality and Series Expansion<a class="header-link" href="#43-orthogonality-and-series-expansion" title="Permanent link">&para;</a></h3>
<p>Legendre polynomials are <strong>orthogonal</strong> on the interval $[-1, 1]$:</p>
<p>$$\int_{-1}^{1} P_m(x) P_n(x) \, dx = \frac{2}{2n+1} \delta_{mn}$$</p>
<p>Therefore, a function $f(x)$ defined on the interval $[-1, 1]$ can be expanded in a <strong>Legendre series</strong>:</p>
<p>$$f(x) = \sum_{l=0}^{\infty} c_l P_l(x), \quad c_l = \frac{2l+1}{2} \int_{-1}^{1} f(x) P_l(x) \, dx$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">legendre</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- ë¥´ì¥ë“œë¥´ ê¸‰ìˆ˜ ì „ê°œ: f(x) = |x| ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">legendre_coeff</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë¥´ì¥ë“œë¥´ ê¸‰ìˆ˜ ê³„ìˆ˜ c_l ê³„ì‚°&quot;&quot;&quot;</span>
    <span class="n">Pl</span> <span class="o">=</span> <span class="n">legendre</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="n">integrand</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pl</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">integral</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">integral</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">N_max</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">legendre_coeff</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_max</span><span class="p">)]</span>

<span class="c1"># |x|ëŠ” ìš°í•¨ìˆ˜ì´ë¯€ë¡œ í™€ìˆ˜ l ê³„ìˆ˜ëŠ” 0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë¥´ì¥ë“œë¥´ ê¸‰ìˆ˜ ê³„ìˆ˜ (f(x) = |x|):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  c_</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">coeffs</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;(= 0 ì´ë¡ ì )&quot;</span> <span class="k">if</span> <span class="n">l</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># ê¸‰ìˆ˜ ì¬êµ¬ì„±</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(x) = |x|$&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">N</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)]:</span>
    <span class="n">f_approx</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">legendre</span><span class="p">(</span><span class="n">l</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_approx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ë¥´ì¥ë“œë¥´ ê¸‰ìˆ˜ (</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">í•­)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ë¥´ì¥ë“œë¥´ ê¸‰ìˆ˜ ì „ê°œ: $f(x) = |x|$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;legendre_series.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="44-physics-applications-multipole-expansion-spherically-symmetric-problems">4.4 Physics Applications (Multipole Expansion, Spherically Symmetric Problems)<a class="header-link" href="#44-physics-applications-multipole-expansion-spherically-symmetric-problems" title="Permanent link">&para;</a></h3>
<p><strong>Multipole Expansion</strong>: The potential at a far distance from a charge distribution is expanded in Legendre polynomials.</p>
<p>When a point charge $q$ is located at a distance $d$ from the origin, the potential at an observation point $r > d$:</p>
<p>$$\Phi(r, \theta) = \frac{q}{4\pi\epsilon_0} \frac{1}{|\mathbf{r} - \mathbf{d}|} = \frac{q}{4\pi\epsilon_0} \sum_{l=0}^{\infty} \frac{d^l}{r^{l+1}} P_l(\cos\theta)$$</p>
<ul>
<li>$l = 0$: <strong>monopole</strong> â€” total charge</li>
<li>$l = 1$: <strong>dipole</strong> â€” $\propto 1/r^2$</li>
<li>$l = 2$: <strong>quadrupole</strong> â€” $\propto 1/r^3$</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">legendre</span>

<span class="c1"># --- ë‹¤ì¤‘ê·¹ ì „ê°œ ì‹œê°í™” ---</span>
<span class="c1"># ì ì „í•˜ qê°€ zì¶• ìœ„ dì— ìœ„ì¹˜</span>
<span class="n">q</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># ì „í•˜ ìœ„ì¹˜ (ì›ì ì—ì„œ zë°©í–¥)</span>

<span class="c1"># ê·¹ì¢Œí‘œ ê·¸ë¦¬ë“œ (r &gt; d ì˜ì—­)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

<span class="c1"># ì •í™•í•œ ì „ìœ„</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Z</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Phi_exact</span> <span class="o">=</span> <span class="n">q</span> <span class="o">/</span> <span class="n">dist</span>

<span class="c1"># ë‹¤ì¤‘ê·¹ ê·¼ì‚¬</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ë‹¨ê·¹ì (l=0)&#39;</span><span class="p">,</span> <span class="s1">&#39;ë‹¨ê·¹ì+ìŒê·¹ì (l=0,1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ë‹¤ì¤‘ê·¹ (l=0,...,4)&#39;</span><span class="p">]</span>
<span class="n">L_max_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">L_max</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L_max_list</span><span class="p">):</span>
    <span class="n">Phi_approx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">Pl</span> <span class="o">=</span> <span class="n">legendre</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">Phi_approx</span> <span class="o">+=</span> <span class="n">q</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="n">l</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">Pl</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">))</span>

    <span class="c1"># r-theta í‰ë©´ì—ì„œ ë“±ê³ ì„  (x-z ë‹¨ë©´)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">Phi_exact</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">Phi_approx</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì ì „í•˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ë‹¤ì¤‘ê·¹ ì „ê°œ: ì •í™•í•´(íšŒìƒ‰ ì ì„ ) vs ê·¼ì‚¬(íŒŒë€ìƒ‰ ì‹¤ì„ )&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;multipole_expansion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="45-associated-legendre-functions-and-spherical-harmonics">4.5 Associated Legendre Functions and Spherical Harmonics<a class="header-link" href="#45-associated-legendre-functions-and-spherical-harmonics" title="Permanent link">&para;</a></h3>
<h4 id="associated-legendre-functions">Associated Legendre Functions<a class="header-link" href="#associated-legendre-functions" title="Permanent link">&para;</a></h4>
<p>In 3D spherical coordinate problems involving both $\theta$- and $\phi$-dependence, the <strong>associated Legendre equation</strong> appears:</p>
<p>$$(1 - x^2) y'' - 2x y' + \left[l(l+1) - \frac{m^2}{1-x^2}\right] y = 0$$</p>
<p>where $x = \cos\theta$, $l = 0, 1, 2, \ldots$, $m = -l, \ldots, l$.</p>
<p>The solutions are <strong>associated Legendre functions</strong> $P_l^m(x)$, given by an extension of Rodrigues' formula:</p>
<p>$$P_l^m(x) = (-1)^m (1-x^2)^{m/2} \frac{d^m}{dx^m} P_l(x), \quad m \geq 0$$</p>
<p>For negative $m$:</p>
<p>$$P_l^{-m}(x) = (-1)^m \frac{(l-m)!}{(l+m)!} P_l^m(x)$$</p>
<p>First few associated Legendre functions:</p>
<table>
<thead>
<tr>
<th>$P_l^m(\cos\theta)$</th>
<th>Explicit Form</th>
</tr>
</thead>
<tbody>
<tr>
<td>$P_0^0$</td>
<td>$1$</td>
</tr>
<tr>
<td>$P_1^0$</td>
<td>$\cos\theta$</td>
</tr>
<tr>
<td>$P_1^1$</td>
<td>$-\sin\theta$</td>
</tr>
<tr>
<td>$P_2^0$</td>
<td>$\frac{1}{2}(3\cos^2\theta - 1)$</td>
</tr>
<tr>
<td>$P_2^1$</td>
<td>$-3\sin\theta\cos\theta$</td>
</tr>
<tr>
<td>$P_2^2$</td>
<td>$3\sin^2\theta$</td>
</tr>
</tbody>
</table>
<p><strong>Orthogonality</strong>:</p>
<p>$$\int_{-1}^{1} P_l^m(x) P_{l'}^m(x) dx = \frac{2}{2l+1} \frac{(l+m)!}{(l-m)!} \delta_{ll'}$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">lpmv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ê²°í•© ë¥´ì¥ë“œë¥´ í•¨ìˆ˜ ì‹œê°í™”</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">funcs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">funcs</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">Plm</span> <span class="o">=</span> <span class="n">lpmv</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">Plm</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$P_</span><span class="se">{{</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="se">}}</span><span class="s1">^</span><span class="se">{{</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="se">}}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">cos</span><span class="se">\\</span><span class="s1">theta)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">theta$ (ë„)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ê²°í•© ë¥´ì¥ë“œë¥´ í•¨ìˆ˜&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ì§êµì„± ê²€ì¦ (ê°™ì€ m, ë‹¤ë¥¸ l)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ì§êµì„±: âˆ«P_l^m P_l&#39;^m dx (m=1) ===&quot;</span><span class="p">)</span>
<span class="n">x_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
        <span class="n">inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">lpmv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">x_fine</span><span class="p">)</span> <span class="o">*</span> <span class="n">lpmv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">x_fine</span><span class="p">),</span> <span class="n">x_fine</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &lt;P_</span><span class="si">{</span><span class="n">l1</span><span class="si">}</span><span class="s2">^1, P_</span><span class="si">{</span><span class="n">l2</span><span class="si">}</span><span class="s2">^1&gt; = </span><span class="si">{</span><span class="n">inner</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="spherical-harmonics">Spherical Harmonics<a class="header-link" href="#spherical-harmonics" title="Permanent link">&para;</a></h4>
<p>Combining $P_l^m$ with $e^{im\phi}$ yields <strong>spherical harmonics</strong> $Y_l^m(\theta, \phi)$:</p>
<p>$$Y_l^m(\theta, \phi) = \sqrt{\frac{2l+1}{4\pi} \frac{(l-m)!}{(l+m)!}} \, P_l^m(\cos\theta) \, e^{im\phi}$$</p>
<p>These are <strong>eigenfunctions of the Laplacian</strong> on the sphere:</p>
<p>$$\nabla^2_{S^2} Y_l^m = -l(l+1) Y_l^m$$</p>
<p><strong>Key Properties</strong>:
- <strong>Orthonormality</strong>: $\int_0^{2\pi}\int_0^{\pi} Y_l^m(\theta,\phi)^* Y_{l'}^{m'}(\theta,\phi) \sin\theta \, d\theta \, d\phi = \delta_{ll'}\delta_{mm'}$
- <strong>Completeness</strong>: Any function on the sphere $f(\theta, \phi) = \sum_{l=0}^{\infty} \sum_{m=-l}^{l} c_{lm} Y_l^m(\theta, \phi)$
- <strong>Symmetry relation</strong>: $Y_l^{-m} = (-1)^m (Y_l^m)^*$
- <strong>Addition theorem</strong>: $P_l(\cos\gamma) = \frac{4\pi}{2l+1} \sum_{m=-l}^{l} Y_l^{m*}(\theta', \phi') Y_l^m(\theta, \phi)$</p>
<p><strong>Physics applications</strong>:
- Angular part of hydrogen atom wavefunctions: $\psi_{nlm} = R_{nl}(r) Y_l^m(\theta, \phi)$
- Multipole expansion: potential, gravitational potential spherical expansion
- Geophysics: spherical harmonic analysis of geomagnetic field, gravitational field</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">sph_harm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># êµ¬ë©´ì¡°í™”í•¨ìˆ˜ |Y_l^m|Â² ì‹œê°í™”</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Theta</span><span class="p">,</span> <span class="n">Phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;3d&#39;</span><span class="p">})</span>

<span class="n">harmonics</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">harmonics</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>

    <span class="c1"># scipy sph_harm: sph_harm(m, l, phi, theta)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Theta</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
    <span class="n">Y_coord</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>

    <span class="c1"># ìœ„ìƒì— ë”°ë¥¸ ìƒ‰ìƒ</span>
    <span class="n">fcolors</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">real</span>
    <span class="n">fmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fcolors</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">fmax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fcolors</span> <span class="o">=</span> <span class="n">fcolors</span> <span class="o">/</span> <span class="n">fmax</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_coord</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">((</span><span class="n">fcolors</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                    <span class="n">rstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$Y_</span><span class="se">{{</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="se">}}</span><span class="s1">^</span><span class="se">{{</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="se">}}</span><span class="s1">(</span><span class="se">\\</span><span class="s1">theta, </span><span class="se">\\</span><span class="s1">phi)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;êµ¬ë©´ì¡°í™”í•¨ìˆ˜ (ì‹¤ìˆ˜ ë¶€ë¶„ì— ë”°ë¥¸ ìƒ‰ìƒ)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ì§êµì •ê·œì„± ê²€ì¦</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== êµ¬ë©´ì¡°í™”í•¨ìˆ˜ ì§êµì •ê·œì„± ===&quot;</span><span class="p">)</span>
<span class="n">dtheta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dphi</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">l1</span><span class="p">,</span> <span class="n">m1</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]:</span>
    <span class="k">for</span> <span class="n">l2</span><span class="p">,</span> <span class="n">m2</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]:</span>
        <span class="n">Y1</span> <span class="o">=</span> <span class="n">sph_harm</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Theta</span><span class="p">)</span>
        <span class="n">Y2</span> <span class="o">=</span> <span class="n">sph_harm</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Theta</span><span class="p">)</span>
        <span class="n">integrand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
        <span class="n">inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">inner</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.01</span> <span class="ow">or</span> <span class="p">(</span><span class="n">l1</span><span class="o">==</span><span class="n">l2</span> <span class="ow">and</span> <span class="n">m1</span><span class="o">==</span><span class="n">m2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &lt;Y_</span><span class="si">{</span><span class="n">l1</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">m1</span><span class="si">}</span><span class="s2">|Y_</span><span class="si">{</span><span class="n">l2</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">m2</span><span class="si">}</span><span class="s2">&gt; = </span><span class="si">{</span><span class="n">inner</span><span class="o">.</span><span class="n">real</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5-hermite-and-laguerre-functions">5. Hermite and Laguerre Functions<a class="header-link" href="#5-hermite-and-laguerre-functions" title="Permanent link">&para;</a></h2>
<h3 id="51-hermite-functions-and-quantum-harmonic-oscillator">5.1 Hermite Functions and Quantum Harmonic Oscillator<a class="header-link" href="#51-hermite-functions-and-quantum-harmonic-oscillator" title="Permanent link">&para;</a></h3>
<p><strong>Hermite equation</strong>:</p>
<p>$$y'' - 2xy' + 2ny = 0, \quad n = 0, 1, 2, \ldots$$</p>
<p>The polynomial solution is the <strong>Hermite polynomial</strong> $H_n(x)$:</p>
<p>$$H_n(x) = (-1)^n e^{x^2} \frac{d^n}{dx^n} e^{-x^2}$$</p>
<p>First few: $H_0 = 1$, $H_1 = 2x$, $H_2 = 4x^2 - 2$, $H_3 = 8x^3 - 12x$</p>
<p>The SchrÃ¶dinger equation for the <strong>quantum harmonic oscillator</strong>:</p>
<p>$$-\frac{\hbar^2}{2m}\frac{d^2\psi}{dx^2} + \frac{1}{2}m\omega^2 x^2 \psi = E\psi$$</p>
<p>Introducing the dimensionless variable $\xi = \sqrt{m\omega/\hbar} \, x$, the solutions are:</p>
<p>$$\psi_n(\xi) = \frac{1}{\sqrt{2^n n! \sqrt{\pi}}} H_n(\xi) e^{-\xi^2/2}, \quad E_n = \hbar\omega\left(n + \frac{1}{2}\right)$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">hermite</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">factorial</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span>

<span class="c1"># --- ì–‘ì ì¡°í™” ì§„ë™ì íŒŒë™í•¨ìˆ˜ ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">psi_n</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;në²ˆì§¸ ì¡°í™” ì§„ë™ì íŒŒë™í•¨ìˆ˜&quot;&quot;&quot;</span>
    <span class="n">Hn</span> <span class="o">=</span> <span class="n">hermite</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">Hn</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">xi</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># íŒŒë™í•¨ìˆ˜</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">psi_n</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">psi_</span><span class="se">{{</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="se">}}</span><span class="s1">$ ($E_</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">n</span><span class="o">+</span><span class="mf">0.5</span><span class="si">}</span><span class="se">\\</span><span class="s1">hbar</span><span class="se">\\</span><span class="s1">omega$)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">xi = </span><span class="se">\\</span><span class="s1">sqrt{m</span><span class="se">\\</span><span class="s1">omega/</span><span class="se">\\</span><span class="s1">hbar} </span><span class="se">\\</span><span class="s1">, x$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">psi_n(</span><span class="se">\\</span><span class="s1">xi)$ + offset&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì–‘ì ì¡°í™” ì§„ë™ì íŒŒë™í•¨ìˆ˜&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># í™•ë¥ ë°€ë„</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">psi_n</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">prob</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">prob</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$|</span><span class="se">\\</span><span class="s1">psi_</span><span class="se">{{</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="se">}}</span><span class="s1">|^2$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># ê³ ì „ì  í™•ë¥ ë°€ë„ (n=4, ë¹„êµìš©)</span>
<span class="n">n_class</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n_class</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xi_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">A</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">A</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">prob_class</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">xi_class</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi_class</span><span class="p">,</span> <span class="n">prob_class</span> <span class="o">+</span> <span class="n">n_class</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê³ ì „ì  ($n=4$)&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">xi$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|</span><span class="se">\\</span><span class="s1">psi_n|^2$ + offset&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;í™•ë¥ ë°€ë„ (ì–‘ì vs ê³ ì „ ëŒ€ì‘)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;quantum_harmonic_oscillator.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-laguerre-functions-and-hydrogen-atom">5.2 Laguerre Functions and Hydrogen Atom<a class="header-link" href="#52-laguerre-functions-and-hydrogen-atom" title="Permanent link">&para;</a></h3>
<p><strong>Associated Laguerre equation</strong>:</p>
<p>$$x y'' + (k + 1 - x) y' + n y = 0$$</p>
<p>The solutions are <strong>associated Laguerre polynomials</strong> $L_n^k(x)$.</p>
<p>The radial wavefunction for the <strong>hydrogen atom</strong>:</p>
<p>$$R_{nl}(r) = N_{nl} \left(\frac{2r}{na_0}\right)^l e^{-r/(na_0)} L_{n-l-1}^{2l+1}\!\left(\frac{2r}{na_0}\right)$$</p>
<p>where $n$ is the principal quantum number, $l$ is the orbital quantum number, and $a_0$ is the Bohr radius. Energy levels:</p>
<p>$$E_n = -\frac{13.6 \text{ eV}}{n^2}$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">assoc_laguerre</span><span class="p">,</span> <span class="n">factorial</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>

<span class="c1"># --- ìˆ˜ì†Œ ì›ì ë°©ì‚¬ íŒŒë™í•¨ìˆ˜ ---</span>
<span class="n">a0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># ë³´ì–´ ë°˜ì§€ë¦„ ë‹¨ìœ„</span>

<span class="k">def</span><span class="w"> </span><span class="nf">R_nl</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìˆ˜ì†Œ ì›ì ë°©ì‚¬ íŒŒë™í•¨ìˆ˜ R_nl(r)&quot;&quot;&quot;</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">a0</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">a0</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="n">l</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rho</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">assoc_laguerre</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># ë°©ì‚¬ íŒŒë™í•¨ìˆ˜ R_nl(r)</span>
<span class="n">states</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">R_nl</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$R_</span><span class="se">{{</span><span class="si">{</span><span class="n">n</span><span class="si">}{</span><span class="n">l</span><span class="si">}</span><span class="se">}}</span><span class="s1">$ ($n$=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">, $l$=</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r / a_0$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$R_</span><span class="si">{nl}</span><span class="s1">(r)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆ˜ì†Œ ì›ì ë°©ì‚¬ íŒŒë™í•¨ìˆ˜&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># ë°©ì‚¬ í™•ë¥ ë°€ë„ r^2 |R_nl|^2</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">R_nl</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$r^2|R_</span><span class="se">{{</span><span class="si">{</span><span class="n">n</span><span class="si">}{</span><span class="n">l</span><span class="si">}</span><span class="se">}}</span><span class="s1">|^2$&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r / a_0$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$r^2 |R_</span><span class="si">{nl}</span><span class="s1">|^2$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë°©ì‚¬ í™•ë¥ ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hydrogen_radial.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6-gamma-and-beta-functions">6. Gamma and Beta Functions<a class="header-link" href="#6-gamma-and-beta-functions" title="Permanent link">&para;</a></h2>
<h3 id="61-definition-and-properties-of-the-gamma-function">6.1 Definition and Properties of the Gamma Function<a class="header-link" href="#61-definition-and-properties-of-the-gamma-function" title="Permanent link">&para;</a></h3>
<p>The <strong>gamma function</strong> extends the factorial function to real (and complex) numbers:</p>
<p>$$\Gamma(z) = \int_0^{\infty} t^{z-1} e^{-t} \, dt, \quad \text{Re}(z) > 0$$</p>
<p><strong>Key Properties</strong>:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td>Recurrence relation</td>
<td>$\Gamma(z+1) = z \Gamma(z)$</td>
</tr>
<tr>
<td>Relationship with factorial</td>
<td>$\Gamma(n+1) = n!$ ($n$ is a non-negative integer)</td>
</tr>
<tr>
<td>Half-integer value</td>
<td>$\Gamma(1/2) = \sqrt{\pi}$</td>
</tr>
<tr>
<td>Reflection formula</td>
<td>$\Gamma(z)\Gamma(1-z) = \frac{\pi}{\sin(\pi z)}$</td>
</tr>
<tr>
<td>Duplication formula (Legendre)</td>
<td>$\Gamma(z)\Gamma(z+\frac{1}{2}) = \frac{\sqrt{\pi}}{2^{2z-1}}\Gamma(2z)$</td>
</tr>
<tr>
<td>Stirling approximation</td>
<td>$\Gamma(z+1) \sim \sqrt{2\pi z} \left(\frac{z}{e}\right)^z$ ($z \to \infty$)</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span>

<span class="c1"># --- ê°ë§ˆ í•¨ìˆ˜ ì‹œê°í™” ---</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ì‹¤ìˆ˜ì¶•ì—ì„œì˜ ê°ë§ˆ í•¨ìˆ˜</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gamma</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.01</span> <span class="ow">or</span> <span class="n">xi</span> <span class="o">&gt;</span> <span class="mi">0</span>
              <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="c1"># ì–‘ì˜ ì •ìˆ˜ì—ì„œì˜ ê°’ (ê³„ìŠ¹)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">! = </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">Gamma(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê°ë§ˆ í•¨ìˆ˜ $</span><span class="se">\\</span><span class="s1">Gamma(x)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ìŠ¤í„¸ë§ ê·¼ì‚¬ ë¹„êµ</span>
<span class="n">n_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gamma</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_vals</span><span class="p">])</span>
<span class="n">stirling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">n_vals</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_vals</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">)</span><span class="o">**</span><span class="n">n_vals</span>
<span class="n">rel_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stirling</span> <span class="o">-</span> <span class="n">exact</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">rel_error</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$n$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ìƒëŒ€ ì˜¤ì°¨&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìŠ¤í„¸ë§ ê·¼ì‚¬ $n! </span><span class="se">\\</span><span class="s1">approx </span><span class="se">\\</span><span class="s1">sqrt{2</span><span class="se">\\</span><span class="s1">pi n}(n/e)^n$ì˜ ì •í™•ë„&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gamma_function.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ë°˜ì‚¬ ê³µì‹ ê²€ì¦</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ê°ë§ˆ í•¨ìˆ˜ ë°˜ì‚¬ ê³µì‹ ê²€ì¦: Gamma(z) * Gamma(1-z) = pi/sin(pi*z)&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]:</span>
    <span class="n">lhs</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
    <span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  z = </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">: LHS = </span><span class="si">{</span><span class="n">lhs</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">, RHS = </span><span class="si">{</span><span class="n">rhs</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">, &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;ì°¨ì´ = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">lhs</span><span class="o">-</span><span class="n">rhs</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="62-beta-function">6.2 Beta Function<a class="header-link" href="#62-beta-function" title="Permanent link">&para;</a></h3>
<p>The <strong>beta function</strong> is defined as:</p>
<p>$$B(p, q) = \int_0^1 t^{p-1}(1-t)^{q-1} \, dt, \quad p, q > 0$$</p>
<p>Relationship with the gamma function:</p>
<p>$$\boxed{B(p, q) = \frac{\Gamma(p)\Gamma(q)}{\Gamma(p+q)}}$$</p>
<p>This formula is very useful, allowing complex integrals to be computed directly using gamma function values.</p>
<p><strong>Application example</strong>: $\int_0^{\pi/2} \sin^m\theta \cos^n\theta \, d\theta = \frac{1}{2} B\!\left(\frac{m+1}{2}, \frac{n+1}{2}\right)$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">beta</span>

<span class="c1"># --- ë² íƒ€ í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ì ë¶„ ê³„ì‚° ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë² íƒ€ í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ì ë¶„ ê³„ì‚°:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">55</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ 1: int_0^1 x^3 (1-x)^4 dx = B(4, 5) = 3!*4!/8!</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">beta</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">exact</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">/</span> <span class="mi">40320</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âˆ«â‚€Â¹ xÂ³(1-x)â´ dx = B(4,5) = </span><span class="si">{</span><span class="n">result</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  = 3!Â·4!/8! = </span><span class="si">{</span><span class="n">exact</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ 2: int_0^{pi/2} sin^5(theta) d(theta)</span>
<span class="c1"># = (1/2) B(3, 1/2) = (1/2) * Gamma(3)*Gamma(1/2) / Gamma(7/2)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">integral</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta</span><span class="p">((</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âˆ«â‚€^(Ï€/2) sinâµÎ¸ dÎ¸ = (1/2)B(3, 1/2) = </span><span class="si">{</span><span class="n">integral</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì´ë¡ ê°’ = 8/15 = </span><span class="si">{</span><span class="mi">8</span><span class="o">/</span><span class="mi">15</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì œ 3: ê°€ìš°ì‹œì•ˆ ì ë¶„ì˜ ì¼ë°˜í™”</span>
<span class="c1"># int_0^inf x^(2n) e^(-x^2) dx = Gamma(n + 1/2) / 2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ê°€ìš°ì‹œì•ˆ ì ë¶„ì˜ ì¼ë°˜í™”:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âˆ«â‚€^âˆ x^</span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="si">}</span><span class="s2"> e^(-xÂ²) dx = Î“(</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">+1/2)/2 = </span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ìŠ¤í„¸ë§ ê³µì‹: Gamma(1/2) = sqrt(pi) í™•ì¸</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Î“(1/2) = </span><span class="si">{</span><span class="n">gamma</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âˆšÏ€     = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="basic-problems">Basic Problems<a class="header-link" href="#basic-problems" title="Permanent link">&para;</a></h3>
<p><strong>Problem 1</strong>: Classify the ordinary points and singular points of the following ODEs.
- (a) $(1-x^2)y'' - 2xy' + 6y = 0$ (Legendre's equation, $l=2$)
- (b) $xy'' + (1-x)y' + ny = 0$ (Laguerre's equation)
- (c) $y'' + \frac{1}{x}y' + \left(1 - \frac{4}{x^2}\right)y = 0$ (Bessel's equation, $\nu=2$)</p>
<details>
<summary>Solution Hint</summary>

(a) Standard form: $P(x) = \frac{-2x}{1-x^2}$, $Q(x) = \frac{6}{1-x^2}$

- $x = 0$: ordinary point ($P$, $Q$ analytic)
- $x = \pm 1$: singular points ($P$, $Q$ diverge)
  - $(x-1)P(x) = \frac{-2x}{-(1+x)} \to 1$ (analytic), $(x-1)^2 Q(x) \to 0$ (analytic) â†’ regular singular point

(b) Standard form: $P(x) = (1-x)/x$, $Q(x) = n/x$

- $x = 0$: $xP(x) = 1-x$ (analytic), $x^2 Q(x) = nx$ (analytic) â†’ regular singular point

(c) $x = 0$: $xP(x) = 1$ (analytic), $x^2 Q(x) = x^2 - 4$ (analytic) â†’ regular singular point

</details>

<p><strong>Problem 2</strong>: For the Airy equation $y'' - xy = 0$, find the first 6 non-zero terms in the power series solution (cases $a_0 = 1$, $a_1 = 0$ and $a_0 = 0$, $a_1 = 1$).</p>
<details>
<summary>Solution Hint</summary>

Recurrence relation: $a_{m+2} = \frac{a_{m-1}}{(m+2)(m+1)}$, $a_2 = 0$

**Case 1** ($a_0 = 1$, $a_1 = 0$): $a_3 = \frac{1}{6}$, $a_6 = \frac{1}{180}$, $a_9 = \frac{1}{12960}$, ...

$$y_1 = 1 + \frac{x^3}{6} + \frac{x^6}{180} + \frac{x^9}{12960} + \cdots$$

**Case 2** ($a_0 = 0$, $a_1 = 1$): $a_4 = \frac{1}{12}$, $a_7 = \frac{1}{504}$, $a_{10} = \frac{1}{45360}$, ...

$$y_2 = x + \frac{x^4}{12} + \frac{x^7}{504} + \frac{x^{10}}{45360} + \cdots$$


<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;power_series&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</code></pre></div>



</details>

<h3 id="application-problems">Application Problems<a class="header-link" href="#application-problems" title="Permanent link">&para;</a></h3>
<p><strong>Problem 3</strong> (Bessel functions): For a circular membrane of radius $a = 1$, find the first 5 eigenfrequency ratios $\omega_n / \omega_1$ for axisymmetric ($m = 0$) modes.</p>
<details>
<summary>Solution Hint</summary>

Frequencies for axisymmetric modes: $\omega_n = c \, \alpha_{0,n} / a$

where $\alpha_{0,n}$ is the $n$-th positive root of $J_0(x) = 0$.


<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">jn_zeros</span>

<span class="n">zeros_J0</span> <span class="o">=</span> <span class="n">jn_zeros</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;J_0(x)ì˜ ì˜ì :&quot;</span><span class="p">,</span> <span class="n">zeros_J0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì§„ë™ìˆ˜ ë¹„ìœ¨:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  omega_</span><span class="si">{</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/omega_1 = </span><span class="si">{</span><span class="n">zeros_J0</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="n">zeros_J0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>



</details>

<p><strong>Problem 4</strong> (Legendre polynomials): Using Legendre polynomials, expand the potential of an electric dipole with charge $+q$ at $(0, 0, d)$ and $-q$ at $(0, 0, -d)$ in the region $r \gg d$, and show that the dipole term ($l = 1$) dominates.</p>
<details>
<summary>Solution Hint</summary>

$$\Phi = \frac{q}{4\pi\epsilon_0}\left(\frac{1}{|\mathbf{r} - d\hat{z}|} - \frac{1}{|\mathbf{r} + d\hat{z}|}\right)$$

Expand each in a Legendre series:

$$\Phi = \frac{q}{4\pi\epsilon_0} \sum_{l=0}^{\infty} \frac{d^l}{r^{l+1}} P_l(\cos\theta) [1 - (-1)^l]$$

When $l$ is even, $[1 - 1] = 0$, so only odd $l$ remain. The $l = 1$ (dipole) term:

$$\Phi_{\text{dipole}} = \frac{q \cdot 2d}{4\pi\epsilon_0} \frac{\cos\theta}{r^2} = \frac{p \cos\theta}{4\pi\epsilon_0 r^2}$$

where $p = 2qd$ is the dipole moment.

</details>

<p><strong>Problem 5</strong> (Gamma/Beta functions): Calculate the following integrals using gamma and beta functions.</p>
<ul>
<li>(a) $\int_0^{\infty} x^4 e^{-x^2} dx$</li>
<li>(b) $\int_0^1 x^2 \sqrt{1 - x^2} \, dx$</li>
<li>(c) For the volume of an $n$-dimensional hypersphere $V_n(R) = \frac{\pi^{n/2}}{\Gamma(n/2 + 1)} R^n$, find $V_1, V_2, V_3, V_4$.</li>
</ul>
<details>
<summary>Solution Hint</summary>

(a) Substitute $t = x^2$: $\frac{1}{2}\int_0^{\infty} t^{3/2} e^{-t} dt = \frac{1}{2}\Gamma(5/2) = \frac{1}{2} \cdot \frac{3}{2} \cdot \frac{1}{2} \cdot \sqrt{\pi} = \frac{3\sqrt{\pi}}{8}$

(b) Substitute $x = \sin\theta$: $\int_0^{\pi/2} \sin^2\theta \cos^2\theta \, d\theta = \frac{1}{2}B(3/2, 3/2) = \frac{\pi}{16}$

(c)

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;V_</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">(R=1) = pi^(</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">/2) / Gamma(</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">/2 + 1) = </span><span class="si">{</span><span class="n">V</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># V_1 = 2 (ì„ ë¶„ ê¸¸ì´), V_2 = pi (ì›), V_3 = 4pi/3 (êµ¬), V_4 = pi^2/2</span>
</code></pre></div>



</details>

<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<h3 id="textbooks">Textbooks<a class="header-link" href="#textbooks" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Boas, M. L.</strong> (2005). <em>Mathematical Methods in the Physical Sciences</em>, 3rd ed., Chapters 11-12. Wiley.</li>
<li>Main reference for this lesson</li>
<li><strong>Arfken, G. B., Weber, H. J., &amp; Harris, F. E.</strong> (2012). <em>Mathematical Methods for Physicists</em>, 7th ed., Chapters 7-11. Academic Press.</li>
<li>Graduate-level theory of special functions</li>
<li><strong>Watson, G. N.</strong> (1995). <em>A Treatise on the Theory of Bessel Functions</em>, 2nd ed. Cambridge University Press.</li>
<li>Classical reference on Bessel functions</li>
<li><strong>Griffiths, D. J.</strong> (2018). <em>Introduction to Quantum Mechanics</em>, 3rd ed. Cambridge University Press.</li>
<li>Quantum mechanics applications of Hermite/Laguerre functions</li>
</ol>
<h3 id="online-resources">Online Resources<a class="header-link" href="#online-resources" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>NIST Digital Library of Mathematical Functions</strong>: https://dlmf.nist.gov/</li>
<li>Standard reference for formulas, properties, and numerical data of special functions</li>
<li><strong>MIT OCW 18.03</strong>: Differential Equations â€” Power Series Solutions</li>
<li><strong>3Blue1Brown</strong>: Intuitive understanding of special functions</li>
</ol>
<h3 id="core-library-documentation">Core Library Documentation<a class="header-link" href="#core-library-documentation" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>SciPy <code>scipy.special</code></strong>: https://docs.scipy.org/doc/scipy/reference/special.html</li>
<li><code>jv</code>, <code>yv</code> (Bessel), <code>legendre</code> (Legendre), <code>hermite</code> (Hermite), <code>gamma</code>, <code>beta</code>, etc.</li>
<li><strong>SymPy Special Functions</strong>: https://docs.sympy.org/latest/modules/functions/special.html</li>
</ol>
<hr />
<h2 id="next-lesson">Next Lesson<a class="header-link" href="#next-lesson" title="Permanent link">&para;</a></h2>
<p>In <a href="12_Sturm_Liouville_Theory.md">12. Sturm-Liouville Theory</a>, we will show that Bessel functions, Legendre polynomials, Hermite functions, and others covered in this lesson are all special cases of the <strong>Sturm-Liouville eigenvalue problem</strong>, and cover the mathematical foundation of <strong>completeness of orthogonal function systems</strong> and <strong>generalized Fourier series</strong>.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Mathematical_Methods/10_Higher_Order_ODE_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. Higher-Order ODE and Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Mathematical_Methods/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Mathematical_Methods/12_Sturm_Liouville_Theory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. Sturm-Liouville Theory (ìŠ¤íˆ¬ë¦„-ë¦¬ìš°ë¹Œ ì´ë¡ )</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}