{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2. Coulomb Collisions - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Plasma_Physics/">Plasma Physics</a>
    <span class="separator">/</span>
    <span class="current">2. Coulomb Collisions</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>2. Coulomb Collisions</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Plasma_Physics/01_Introduction_to_Plasma.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">1. Introduction to Plasma</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Plasma_Physics/03_Plasma_Description_Hierarchy.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">3. Plasma Description Hierarchy</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-coulomb-scattering">1. Coulomb Scattering</a><ul>
<li><a href="#11-the-two-body-problem">1.1 The Two-Body Problem</a></li>
<li><a href="#12-scattering-geometry">1.2 Scattering Geometry</a></li>
<li><a href="#13-rutherford-cross-section">1.3 Rutherford Cross-Section</a></li>
<li><a href="#14-momentum-transfer-cross-section">1.4 Momentum Transfer Cross-Section</a></li>
</ul>
</li>
<li><a href="#2-the-coulomb-logarithm">2. The Coulomb Logarithm</a><ul>
<li><a href="#21-cutoffs-for-the-coulomb-interaction">2.1 Cutoffs for the Coulomb Interaction</a></li>
<li><a href="#22-definition-of-the-coulomb-logarithm">2.2 Definition of the Coulomb Logarithm</a></li>
<li><a href="#23-weak-logarithmic-dependence">2.3 Weak Logarithmic Dependence</a></li>
</ul>
</li>
<li><a href="#3-collision-frequencies">3. Collision Frequencies</a><ul>
<li><a href="#31-momentum-transfer-collision-frequency">3.1 Momentum Transfer Collision Frequency</a></li>
<li><a href="#32-electron-ion-collision-frequency">3.2 Electron-Ion Collision Frequency</a></li>
<li><a href="#33-electron-electron-collision-frequency">3.3 Electron-Electron Collision Frequency</a></li>
<li><a href="#34-ion-ion-collision-frequency">3.4 Ion-Ion Collision Frequency</a></li>
<li><a href="#35-ordering-of-collision-frequencies">3.5 Ordering of Collision Frequencies</a></li>
</ul>
</li>
<li><a href="#4-spitzer-resistivity">4. Spitzer Resistivity</a><ul>
<li><a href="#41-derivation-from-collision-frequency">4.1 Derivation from Collision Frequency</a></li>
<li><a href="#42-temperature-dependence">4.2 Temperature Dependence</a></li>
<li><a href="#43-collisional-heating">4.3 Collisional Heating</a></li>
<li><a href="#44-comparison-with-classical-resistivity">4.4 Comparison with Classical Resistivity</a></li>
</ul>
</li>
<li><a href="#5-mean-free-path-and-collisionality">5. Mean Free Path and Collisionality</a><ul>
<li><a href="#51-mean-free-path">5.1 Mean Free Path</a></li>
<li><a href="#52-knudsen-number">5.2 Knudsen Number</a></li>
<li><a href="#53-examples">5.3 Examples</a></li>
</ul>
</li>
<li><a href="#6-energy-equipartition">6. Energy Equipartition</a><ul>
<li><a href="#61-energy-exchange-between-species">6.1 Energy Exchange Between Species</a></li>
<li><a href="#62-equipartition-time">6.2 Equipartition Time</a></li>
<li><a href="#63-electron-vs-ion-heating">6.3 Electron vs Ion Heating</a></li>
</ul>
</li>
<li><a href="#7-computational-examples">7. Computational Examples</a><ul>
<li><a href="#71-collision-frequency-calculator">7.1 Collision Frequency Calculator</a></li>
<li><a href="#72-resistivity-vs-temperature">7.2 Resistivity vs Temperature</a></li>
<li><a href="#73-collision-frequency-scaling">7.3 Collision Frequency Scaling</a></li>
<li><a href="#74-collisionality-map">7.4 Collisionality Map</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-collision-frequency-in-a-glow-discharge">Problem 1: Collision Frequency in a Glow Discharge</a></li>
<li><a href="#problem-2-spitzer-resistivity-in-a-tokamak">Problem 2: Spitzer Resistivity in a Tokamak</a></li>
<li><a href="#problem-3-temperature-equilibration">Problem 3: Temperature Equilibration</a></li>
<li><a href="#problem-4-impact-parameter-estimates">Problem 4: Impact Parameter Estimates</a></li>
<li><a href="#problem-5-collisionality-regimes">Problem 5: Collisionality Regimes</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="2-coulomb-collisions">2. Coulomb Collisions<a class="header-link" href="#2-coulomb-collisions" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Understand the physics of Coulomb scattering between charged particles and derive the Rutherford cross-section</li>
<li>Calculate collision frequencies for electron-electron, ion-ion, and electron-ion interactions</li>
<li>Derive the Coulomb logarithm and understand its role in determining collision rates</li>
<li>Compute Spitzer resistivity and understand its temperature dependence</li>
<li>Distinguish between collisional and collisionless plasma regimes using the Knudsen number</li>
<li>Apply Python tools to analyze collision dynamics and transport properties</li>
</ul>
<h2 id="1-coulomb-scattering">1. Coulomb Scattering<a class="header-link" href="#1-coulomb-scattering" title="Permanent link">&para;</a></h2>
<h3 id="11-the-two-body-problem">1.1 The Two-Body Problem<a class="header-link" href="#11-the-two-body-problem" title="Permanent link">&para;</a></h3>
<p>Consider two charged particles with charges $q_1$ and $q_2$, masses $m_1$ and $m_2$, interacting via the Coulomb force. In the center-of-mass frame, this reduces to a single-particle problem with reduced mass:</p>
<p>$$\mu = \frac{m_1 m_2}{m_1 + m_2}$$</p>
<p>The particle moves in the Coulomb potential:</p>
<p>$$V(r) = \frac{1}{4\pi\epsilon_0} \frac{q_1 q_2}{r}$$</p>
<h3 id="12-scattering-geometry">1.2 Scattering Geometry<a class="header-link" href="#12-scattering-geometry" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Scattering</span><span class="w"> </span><span class="nv">Geometry</span><span class="w"> </span><span class="ss">(</span><span class="nv">Lab</span><span class="w"> </span><span class="nv">Frame</span><span class="ss">)</span>:

<span class="w">              </span><span class="nv">b</span><span class="w"> </span><span class="ss">(</span><span class="nv">impact</span><span class="w"> </span><span class="nv">parameter</span><span class="ss">)</span>
<span class="w">              </span>‚Üì
<span class="w">    </span>‚óè‚Üí‚Üí‚Üí‚Üí‚Üí‚Üí‚Üí‚Üí‚Üí‚óè‚Üí‚Üí‚Üí‚Üí‚Üí‚Üí‚Üí
<span class="w">   </span><span class="nv">particle</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span>‚Üë<span class="w">  </span><span class="nv">scattered</span><span class="w"> </span><span class="nv">particle</span>
<span class="w">            </span><span class="nv">target</span>
<span class="w">         </span><span class="ss">(</span><span class="nv">particle</span><span class="w"> </span><span class="mi">2</span><span class="ss">)</span>

<span class="w">              </span>œá<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">scattering</span><span class="w"> </span><span class="nv">angle</span>

<span class="nv">Classical</span><span class="w"> </span><span class="nv">orbit</span>:
<span class="o">-</span><span class="w"> </span><span class="nv">Hyperbolic</span><span class="w"> </span><span class="nv">trajectory</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">repulsive</span><span class="w"> </span><span class="nv">force</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Deflection</span><span class="w"> </span><span class="nv">angle</span><span class="w"> </span>œá<span class="w"> </span><span class="nv">depends</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">impact</span><span class="w"> </span><span class="nv">parameter</span><span class="w"> </span><span class="nv">b</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Small</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span>‚Üí<span class="w"> </span><span class="nv">large</span><span class="w"> </span><span class="nv">deflection</span>
<span class="o">-</span><span class="w"> </span><span class="nv">Large</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span>‚Üí<span class="w"> </span><span class="nv">small</span><span class="w"> </span><span class="nv">deflection</span>
</code></pre></div>

<p>For a <strong>repulsive</strong> Coulomb interaction ($q_1 q_2 > 0$), the scattering angle $\chi$ is related to the impact parameter $b$ by:</p>
<p>$$\tan\left(\frac{\chi}{2}\right) = \frac{b_{90}}{b}$$</p>
<p>where $b_{90}$ is the <strong>impact parameter for 90¬∞ scattering</strong>:</p>
<p>$$b_{90} = \frac{1}{4\pi\epsilon_0} \frac{q_1 q_2}{\mu v_0^2} = \frac{q_1 q_2}{4\pi\epsilon_0 E_{cm}}$$</p>
<p>Here, $v_0$ is the initial relative velocity and $E_{cm} = \frac{1}{2}\mu v_0^2$ is the center-of-mass kinetic energy.</p>
<p><strong>Physical interpretation:</strong> $b_{90}$ is the impact parameter at which the Coulomb potential energy equals the kinetic energy:</p>
<p>$$\frac{1}{4\pi\epsilon_0}\frac{q_1 q_2}{b_{90}} = \frac{1}{2}\mu v_0^2$$</p>
<h3 id="13-rutherford-cross-section">1.3 Rutherford Cross-Section<a class="header-link" href="#13-rutherford-cross-section" title="Permanent link">&para;</a></h3>
<p>The <strong>differential cross-section</strong> describes the probability of scattering into a solid angle $d\Omega$ at angle $\chi$:</p>
<p>$$\frac{d\sigma}{d\Omega} = \left(\frac{b_{90}}{2}\right)^2 \frac{1}{\sin^4(\chi/2)}$$</p>
<p>This is the <strong>Rutherford scattering formula</strong>, one of the most important results in classical scattering theory.</p>
<p><strong>Key features:</strong>
1. Strong forward-bias: $d\sigma/d\Omega \to \infty$ as $\chi \to 0$ (small-angle scattering dominates)
2. Symmetry: depends only on $|\chi|$
3. Divergence: total cross-section $\sigma_{total} = \int (d\sigma/d\Omega) d\Omega$ diverges!</p>
<p>The divergence arises because:
- Small-angle scattering ($\chi \ll 1$) dominates
- Long-range Coulomb force allows arbitrarily large impact parameters
- Many weak deflections are more important than rare large deflections</p>
<h3 id="14-momentum-transfer-cross-section">1.4 Momentum Transfer Cross-Section<a class="header-link" href="#14-momentum-transfer-cross-section" title="Permanent link">&para;</a></h3>
<p>For transport properties, we need the <strong>momentum transfer cross-section</strong>, weighted by $(1 - \cos\chi)$:</p>
<p>$$\sigma_m = \int (1 - \cos\chi) \frac{d\sigma}{d\Omega} d\Omega$$</p>
<p>This integral also diverges, but the divergence is milder ($\ln b_{max}$). We'll address this shortly with Debye screening.</p>
<h2 id="2-the-coulomb-logarithm">2. The Coulomb Logarithm<a class="header-link" href="#2-the-coulomb-logarithm" title="Permanent link">&para;</a></h2>
<h3 id="21-cutoffs-for-the-coulomb-interaction">2.1 Cutoffs for the Coulomb Interaction<a class="header-link" href="#21-cutoffs-for-the-coulomb-interaction" title="Permanent link">&para;</a></h3>
<p>The Rutherford formula assumes an infinite-range unscreened Coulomb potential. In a plasma, two physical effects provide cutoffs:</p>
<p><strong>1. Maximum impact parameter ($b_{max}$):</strong> Debye shielding</p>
<p>At distances $b > \lambda_D$, the Coulomb potential is exponentially screened. Thus:</p>
<p>$$b_{max} \sim \lambda_D = \sqrt{\frac{\epsilon_0 k_B T}{n e^2}}$$</p>
<p><strong>2. Minimum impact parameter ($b_{min}$):</strong> Classical distance of closest approach or quantum uncertainty</p>
<p>The minimum impact parameter is the larger of:</p>
<p>(a) <strong>Classical closest approach</strong> $b_{90}$ (when potential energy equals kinetic energy)</p>
<p>(b) <strong>Quantum de Broglie wavelength</strong> $\lambda_{dB} = \hbar/(mv_{thermal})$ (when wave effects matter)</p>
<p>For most plasmas, the classical limit dominates:</p>
<p>$$b_{min} \sim b_{90} = \frac{q_1 q_2}{4\pi\epsilon_0 \mu v_{th}^2}$$</p>
<p>where $v_{th} = \sqrt{k_B T/m}$ is the thermal velocity.</p>
<h3 id="22-definition-of-the-coulomb-logarithm">2.2 Definition of the Coulomb Logarithm<a class="header-link" href="#22-definition-of-the-coulomb-logarithm" title="Permanent link">&para;</a></h3>
<p>The <strong>Coulomb logarithm</strong> is defined as:</p>
<p>$$\ln\Lambda = \ln\left(\frac{b_{max}}{b_{min}}\right)$$</p>
<p><strong>For electron-ion collisions:</strong></p>
<p>$$\ln\Lambda_{ei} \approx \ln\left(\frac{12\pi n_e \lambda_D^3}{Z}\right)$$</p>
<p>Using $\lambda_D = \sqrt{\epsilon_0 k_B T_e/(n_e e^2)}$:</p>
<p>$$\ln\Lambda_{ei} \approx \begin{cases}
23 - \ln\left(\sqrt{n_e/10^6} \, Z \, T_e^{-3/2}\right) & T_e < 10 Z^2 \text{ eV} \\
24 - \ln\left(\sqrt{n_e/10^6} \, T_e^{-1}\right) & T_e > 10 Z^2 \text{ eV}
\end{cases}$$</p>
<p>where $n_e$ is in cm$^{-3}$ and $T_e$ is in eV.</p>
<p><strong>Typical values:</strong>
- Laboratory plasmas: $\ln\Lambda \approx 10 - 15$
- Fusion plasmas: $\ln\Lambda \approx 15 - 20$
- Astrophysical plasmas: $\ln\Lambda \approx 20 - 30$</p>
<div class="highlight"><pre><span></span><code>Physical Meaning of ln Œõ:

ln Œõ ‚âà ln(number of particles in Debye sphere) ‚âà ln(N_D)

    b_max ~ Œª_D
       ‚Üì
  ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè     Debye sphere
  ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè     contains ~N_D particles
  ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè
       ‚Üë
    b_min ~ b_90

ln Œõ counts the &quot;effective range&quot; of Coulomb interactions
in units of logarithms (weak dependence on plasma parameters)
</code></pre></div>

<h3 id="23-weak-logarithmic-dependence">2.3 Weak Logarithmic Dependence<a class="header-link" href="#23-weak-logarithmic-dependence" title="Permanent link">&para;</a></h3>
<p>The remarkable feature of $\ln\Lambda$ is its <strong>weak dependence</strong> on plasma parameters. Even though $n$ and $T$ vary by many orders of magnitude across different plasmas, $\ln\Lambda$ only varies by a factor of 2-3.</p>
<table>
<thead>
<tr>
<th>Plasma</th>
<th>$n$ [m$^{-3}$]</th>
<th>$T$ [eV]</th>
<th>$\ln\Lambda$</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tokamak core</td>
<td>$10^{20}$</td>
<td>10,000</td>
<td>17</td>
</tr>
<tr>
<td>Tokamak edge</td>
<td>$10^{19}$</td>
<td>100</td>
<td>15</td>
</tr>
<tr>
<td>Solar corona</td>
<td>$10^{14}$</td>
<td>100</td>
<td>19</td>
</tr>
<tr>
<td>Ionosphere</td>
<td>$10^{12}$</td>
<td>0.1</td>
<td>12</td>
</tr>
<tr>
<td>Glow discharge</td>
<td>$10^{16}$</td>
<td>2</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>This weak dependence allows us to treat $\ln\Lambda \approx 15$ as a constant in many estimates.</p>
<h2 id="3-collision-frequencies">3. Collision Frequencies<a class="header-link" href="#3-collision-frequencies" title="Permanent link">&para;</a></h2>
<h3 id="31-momentum-transfer-collision-frequency">3.1 Momentum Transfer Collision Frequency<a class="header-link" href="#31-momentum-transfer-collision-frequency" title="Permanent link">&para;</a></h3>
<p>The <strong>collision frequency</strong> $\nu$ is the rate at which a particle undergoes momentum-changing collisions. It's defined as:</p>
<p>$$\nu = n \sigma_m v_{th}$$</p>
<p>where $\sigma_m$ is the momentum transfer cross-section.</p>
<p>For Coulomb collisions, integrating the Rutherford formula with cutoffs:</p>
<p>$$\sigma_m \sim \pi b_{90}^2 \ln\Lambda$$</p>
<h3 id="32-electron-ion-collision-frequency">3.2 Electron-Ion Collision Frequency<a class="header-link" href="#32-electron-ion-collision-frequency" title="Permanent link">&para;</a></h3>
<p>The <strong>electron-ion collision frequency</strong> is:</p>
<p>$$\nu_{ei} = \frac{n_i Z^2 e^4 \ln\Lambda}{4\pi\epsilon_0^2 m_e^2 v_e^3}$$</p>
<p>Using the electron thermal velocity $v_e = \sqrt{k_B T_e/m_e}$:</p>
<p>$$\nu_{ei} = \frac{n_i Z^2 e^4 \ln\Lambda}{4\pi\epsilon_0^2 m_e^{1/2} (k_B T_e)^{3/2}}$$</p>
<p><strong>Numerical formula:</strong></p>
<p>$$\nu_{ei} \approx 2.91 \times 10^{-6} \, \frac{n_e[\text{m}^{-3}] \, Z \, \ln\Lambda}{T_e[\text{eV}]^{3/2}} \quad [\text{s}^{-1}]$$</p>
<p><strong>Key scaling:</strong> $\nu_{ei} \propto n T^{-3/2}$</p>
<ul>
<li>Collisions increase with density (more targets)</li>
<li>Collisions decrease rapidly with temperature (faster particles spend less time in collision region)</li>
</ul>
<h3 id="33-electron-electron-collision-frequency">3.3 Electron-Electron Collision Frequency<a class="header-link" href="#33-electron-electron-collision-frequency" title="Permanent link">&para;</a></h3>
<p>For <strong>like-particle collisions</strong> (electron-electron or ion-ion), the kinematics differ. The collision frequency is:</p>
<p>$$\nu_{ee} \approx \nu_{ei}$$</p>
<p>(same order of magnitude, with a numerical factor of order unity).</p>
<p>More precisely:</p>
<p>$$\nu_{ee} = \frac{n_e e^4 \ln\Lambda}{8\pi\epsilon_0^2 m_e^{1/2} (k_B T_e)^{3/2}} \approx 1.45 \times 10^{-6} \, \frac{n_e[\text{m}^{-3}] \, \ln\Lambda}{T_e[\text{eV}]^{3/2}} \quad [\text{s}^{-1}]$$</p>
<h3 id="34-ion-ion-collision-frequency">3.4 Ion-Ion Collision Frequency<a class="header-link" href="#34-ion-ion-collision-frequency" title="Permanent link">&para;</a></h3>
<p>Similarly, for ions:</p>
<p>$$\nu_{ii} = \frac{n_i Z^4 e^4 \ln\Lambda}{8\pi\epsilon_0^2 m_i^{1/2} (k_B T_i)^{3/2}}$$</p>
<p><strong>Comparison with electron collision frequency:</strong></p>
<p>$$\frac{\nu_{ii}}{\nu_{ei}} \sim \sqrt{\frac{m_e}{m_i}} \left(\frac{T_e}{T_i}\right)^{3/2}$$</p>
<p>For $T_e \sim T_i$ and hydrogen plasma:</p>
<p>$$\nu_{ii} \sim \frac{\nu_{ei}}{43}$$</p>
<p>Ions collide much less frequently than electrons (slower thermal velocities).</p>
<h3 id="35-ordering-of-collision-frequencies">3.5 Ordering of Collision Frequencies<a class="header-link" href="#35-ordering-of-collision-frequencies" title="Permanent link">&para;</a></h3>
<p>For typical plasmas with $T_e \sim T_i$ and $m_i \gg m_e$:</p>
<p>$$\nu_{ee} \sim \nu_{ei} \gg \nu_{ie} \gg \nu_{ii}$$</p>
<p>where $\nu_{ie}$ is the ion-electron collision frequency.</p>
<p><strong>Physical interpretation:</strong>
- Electrons collide frequently with both electrons and ions
- Ions collide primarily with ions; electrons are too fast and light to deflect ions significantly
- Momentum and energy exchange between species occurs on the slower ion timescale</p>
<h2 id="4-spitzer-resistivity">4. Spitzer Resistivity<a class="header-link" href="#4-spitzer-resistivity" title="Permanent link">&para;</a></h2>
<h3 id="41-derivation-from-collision-frequency">4.1 Derivation from Collision Frequency<a class="header-link" href="#41-derivation-from-collision-frequency" title="Permanent link">&para;</a></h3>
<p>Electrical resistivity arises from momentum transfer between electrons (carrying current) and ions (stationary).</p>
<p>In a simple Drude model, the conductivity is:</p>
<p>$$\sigma_{\parallel} = \frac{n_e e^2}{m_e \nu_{ei}}$$</p>
<p>The <strong>Spitzer resistivity</strong> is:</p>
<p>$$\eta = \frac{1}{\sigma_{\parallel}} = \frac{m_e \nu_{ei}}{n_e e^2}$$</p>
<p>Substituting $\nu_{ei}$:</p>
<p>$$\eta = \frac{Z \, m_e e^2 \ln\Lambda}{4\pi\epsilon_0^2 (k_B T_e)^{3/2}}$$</p>
<p><strong>Numerical formula:</strong></p>
<p>$$\eta \approx 5.2 \times 10^{-5} \, \frac{Z \, \ln\Lambda}{T_e[\text{eV}]^{3/2}} \quad [\Omega \cdot \text{m}]$$</p>
<h3 id="42-temperature-dependence">4.2 Temperature Dependence<a class="header-link" href="#42-temperature-dependence" title="Permanent link">&para;</a></h3>
<p>The key result is the <strong>strong temperature dependence</strong>:</p>
<p>$$\eta \propto T_e^{-3/2}$$</p>
<p><strong>Implications:</strong>
- Hot plasmas are excellent conductors (low resistivity)
- Resistivity decreases rapidly with heating
- For fusion plasmas ($T_e \sim 10$ keV), $\eta \sim 10^{-8}$ Œ©¬∑m (comparable to room-temperature copper!)</p>
<div class="highlight"><pre><span></span><code><span class="n">Resistivity</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="nl">Temperature</span><span class="p">:</span>

<span class="n">Œ∑</span><span class="w"> </span><span class="o">[</span><span class="n">Œ©‚ãÖm</span><span class="o">]</span>
<span class="w"> </span><span class="err">‚Üë</span>
<span class="mi">10</span><span class="err">‚Åª</span><span class="n">‚Å¥</span><span class="err">‚îÇ</span><span class="w">         </span><span class="p">.</span>
<span class="w">     </span><span class="err">‚îÇ</span><span class="w">       </span><span class="p">.</span>
<span class="mi">10</span><span class="err">‚Åª</span><span class="n">‚Åµ</span><span class="err">‚îÇ</span><span class="w">      </span><span class="p">.</span>
<span class="w">     </span><span class="err">‚îÇ</span><span class="w">    </span><span class="p">.</span>
<span class="mi">10</span><span class="err">‚Åª</span><span class="n">‚Å∂</span><span class="err">‚îÇ</span><span class="w">   </span><span class="p">.</span>
<span class="w">     </span><span class="err">‚îÇ</span><span class="w">  </span><span class="p">.</span>
<span class="mi">10</span><span class="err">‚Åª</span><span class="n">‚Å∑</span><span class="err">‚îÇ</span><span class="w"> </span><span class="p">.</span>
<span class="w">     </span><span class="err">‚îÇ</span><span class="p">.</span>
<span class="mi">10</span><span class="err">‚Åª</span><span class="n">‚Å∏</span><span class="err">‚îÇ</span>
<span class="w">     </span><span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí</span><span class="w"> </span><span class="n">T_e</span><span class="w"> </span><span class="o">[</span><span class="n">eV</span><span class="o">]</span>
<span class="w">     </span><span class="mi">10</span><span class="w">   </span><span class="mi">100</span><span class="w">   </span><span class="mi">1000</span><span class="w">  </span><span class="mi">10000</span>

<span class="nl">Spitzer</span><span class="p">:</span><span class="w"> </span><span class="n">Œ∑</span><span class="w"> </span><span class="err">‚àù</span><span class="w"> </span><span class="n">T</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>

<h3 id="43-collisional-heating">4.3 Collisional Heating<a class="header-link" href="#43-collisional-heating" title="Permanent link">&para;</a></h3>
<p>Resistivity dissipates electrical energy as heat. The power density is:</p>
<p>$$P_{Ohmic} = \eta J^2 = \eta \frac{I^2}{A^2}$$</p>
<p>where $J$ is current density and $I$ is total current.</p>
<p>In tokamaks, <strong>Ohmic heating</strong> dominates at low temperatures but becomes ineffective at high $T$ due to the $T^{-3/2}$ scaling.</p>
<h3 id="44-comparison-with-classical-resistivity">4.4 Comparison with Classical Resistivity<a class="header-link" href="#44-comparison-with-classical-resistivity" title="Permanent link">&para;</a></h3>
<p>Compare Spitzer resistivity to classical metals:</p>
<table>
<thead>
<tr>
<th>Material</th>
<th>$\eta$ [Œ©¬∑m] at 300 K</th>
</tr>
</thead>
<tbody>
<tr>
<td>Copper</td>
<td>$1.7 \times 10^{-8}$</td>
</tr>
<tr>
<td>Aluminum</td>
<td>$2.7 \times 10^{-8}$</td>
</tr>
<tr>
<td>Plasma ($T_e=10$ keV)</td>
<td>$\sim 10^{-8}$</td>
</tr>
</tbody>
</table>
<p>Hot plasmas are as conductive as metals! However, the physical mechanism is different:
- Metals: electron-phonon scattering
- Plasmas: electron-ion Coulomb collisions</p>
<h2 id="5-mean-free-path-and-collisionality">5. Mean Free Path and Collisionality<a class="header-link" href="#5-mean-free-path-and-collisionality" title="Permanent link">&para;</a></h2>
<h3 id="51-mean-free-path">5.1 Mean Free Path<a class="header-link" href="#51-mean-free-path" title="Permanent link">&para;</a></h3>
<p>The <strong>mean free path</strong> $\lambda_{mfp}$ is the average distance a particle travels between collisions:</p>
<p>$$\lambda_{mfp} = \frac{v_{th}}{\nu}$$</p>
<p><strong>For electrons:</strong></p>
<p>$$\lambda_{mfp,e} = \frac{v_{te}}{\nu_{ei}} = \frac{\sqrt{k_B T_e/m_e}}{\nu_{ei}}$$</p>
<p><strong>Numerical estimate:</strong></p>
<p>$$\lambda_{mfp,e} \approx 3.44 \times 10^{11} \, \frac{T_e[\text{eV}]^2}{n_e[\text{m}^{-3}] \, Z \, \ln\Lambda} \quad [\text{m}]$$</p>
<h3 id="52-knudsen-number">5.2 Knudsen Number<a class="header-link" href="#52-knudsen-number" title="Permanent link">&para;</a></h3>
<p>The <strong>Knudsen number</strong> compares the mean free path to the system size $L$:</p>
<p>$$Kn = \frac{\lambda_{mfp}}{L}$$</p>
<p><strong>Collisionality regimes:</strong></p>
<ul>
<li><strong>Collisional (fluid-like):</strong> $Kn \ll 1$</li>
<li>Many collisions occur within system size</li>
<li>Local thermodynamic equilibrium (LTE)</li>
<li>
<p>Fluid (MHD) description valid</p>
</li>
<li>
<p><strong>Collisionless (kinetic):</strong> $Kn \gg 1$</p>
</li>
<li>Few or no collisions within system size</li>
<li>Distribution function non-Maxwellian</li>
<li>
<p>Kinetic (Vlasov) description required</p>
</li>
<li>
<p><strong>Transitional:</strong> $Kn \sim 1$</p>
</li>
<li>Neither limit applicable</li>
<li>Most difficult regime to model</li>
</ul>
<h3 id="53-examples">5.3 Examples<a class="header-link" href="#53-examples" title="Permanent link">&para;</a></h3>
<p><strong>Tokamak core:</strong>
- $n_e = 10^{20}$ m$^{-3}$, $T_e = 10$ keV, $L = 1$ m, $\ln\Lambda = 17$
- $\nu_{ei} \approx 1.7 \times 10^4$ s$^{-1}$
- $v_{te} \approx 4.2 \times 10^7$ m/s
- $\lambda_{mfp} \approx 2500$ m $\gg L$
- $Kn \approx 2500$ ‚Üí <strong>collisionless</strong></p>
<p><strong>Magnetospheric plasma:</strong>
- $n \sim 10^6$ m$^{-3}$, $T \sim 1$ keV, $L \sim 10^7$ m
- $\lambda_{mfp} \sim 10^{15}$ m $\gg L$
- Extremely collisionless</p>
<p><strong>Glow discharge:</strong>
- $n \sim 10^{16}$ m$^{-3}$, $T \sim 2$ eV, $L \sim 0.1$ m
- $\lambda_{mfp} \sim 1$ m $\gtrsim L$
- Transitional regime</p>
<h2 id="6-energy-equipartition">6. Energy Equipartition<a class="header-link" href="#6-energy-equipartition" title="Permanent link">&para;</a></h2>
<h3 id="61-energy-exchange-between-species">6.1 Energy Exchange Between Species<a class="header-link" href="#61-energy-exchange-between-species" title="Permanent link">&para;</a></h3>
<p>When $T_e \ne T_i$, energy is transferred between species via collisions. The <strong>energy exchange frequency</strong> is:</p>
<p>$$\nu_{E,ei} = \frac{2m_e}{m_i} \nu_{ei}$$</p>
<p>The factor $2m_e/m_i \ll 1$ reflects inefficient energy transfer in collisions between particles of very different masses.</p>
<h3 id="62-equipartition-time">6.2 Equipartition Time<a class="header-link" href="#62-equipartition-time" title="Permanent link">&para;</a></h3>
<p>The <strong>equipartition time</strong> is the time for temperatures to equilibrate:</p>
<p>$$\tau_{eq} = \frac{1}{\nu_{E,ei}} = \frac{m_i}{2m_e \nu_{ei}}$$</p>
<p><strong>Numerical estimate:</strong></p>
<p>$$\tau_{eq} \approx 1.09 \times 10^{13} \, \frac{A \, T_e[\text{eV}]^{3/2}}{n_e[\text{m}^{-3}] \, Z \, \ln\Lambda} \quad [\text{s}]$$</p>
<p>where $A$ is the ion mass number.</p>
<p>For hydrogen plasma ($A=1$) in a tokamak:
- $n_e = 10^{20}$ m$^{-3}$, $T_e = 10$ keV
- $\tau_{eq} \approx 1$ s</p>
<p>This is <strong>long</strong> compared to energy confinement times ($\sim 0.1$ s), so $T_e$ and $T_i$ can differ significantly.</p>
<h3 id="63-electron-vs-ion-heating">6.3 Electron vs Ion Heating<a class="header-link" href="#63-electron-vs-ion-heating" title="Permanent link">&para;</a></h3>
<p>In fusion experiments:
- <strong>Electron heating</strong> (e.g., ECRH, Ohmic): heats $T_e$ directly
- <strong>Ion heating</strong> (e.g., neutral beam injection, ICRH): heats $T_i$ directly</p>
<p>Due to slow equipartition ($\tau_{eq} \gg \tau_E$), separate control of $T_e$ and $T_i$ is possible. Typical tokamak profiles show $T_e \gtrsim T_i$ in the core.</p>
<h2 id="7-computational-examples">7. Computational Examples<a class="header-link" href="#7-computational-examples" title="Permanent link">&para;</a></h2>
<h3 id="71-collision-frequency-calculator">7.1 Collision Frequency Calculator<a class="header-link" href="#71-collision-frequency-calculator" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Constants</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">1.602176634e-19</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.1093837015e-31</span>
<span class="n">m_p</span> <span class="o">=</span> <span class="mf">1.672621898e-27</span>
<span class="n">epsilon_0</span> <span class="o">=</span> <span class="mf">8.8541878128e-12</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.380649e-23</span>
<span class="n">eV_to_K</span> <span class="o">=</span> <span class="mf">11604.518</span>

<span class="k">def</span><span class="w"> </span><span class="nf">coulomb_logarithm</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate Coulomb logarithm.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    n_e : float</span>
<span class="sd">        Electron density [m^-3]</span>
<span class="sd">    T_e : float</span>
<span class="sd">        Electron temperature [eV]</span>
<span class="sd">    Z : int</span>
<span class="sd">        Ion charge state</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    ln_Lambda : float</span>
<span class="sd">        Coulomb logarithm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_e_cgs</span> <span class="o">=</span> <span class="n">n_e</span> <span class="o">*</span> <span class="mf">1e-6</span>  <span class="c1"># Convert to cm^-3</span>

    <span class="k">if</span> <span class="n">T_e</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="mi">23</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_e_cgs</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">T_e</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="mi">24</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_e_cgs</span><span class="p">)</span> <span class="o">*</span> <span class="n">T_e</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">ln_Lambda</span>

<span class="k">def</span><span class="w"> </span><span class="nf">nu_ei</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Electron-ion collision frequency.</span>

<span class="sd">    Returns: frequency [s^-1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ln_Lambda</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="n">coulomb_logarithm</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>

    <span class="k">return</span> <span class="mf">2.91e-6</span> <span class="o">*</span> <span class="n">n_e</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">ln_Lambda</span> <span class="o">/</span> <span class="n">T_e</span><span class="o">**</span><span class="mf">1.5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">nu_ee</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Electron-electron collision frequency.</span>

<span class="sd">    Returns: frequency [s^-1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ln_Lambda</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="n">coulomb_logarithm</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">)</span>

    <span class="k">return</span> <span class="mf">1.45e-6</span> <span class="o">*</span> <span class="n">n_e</span> <span class="o">*</span> <span class="n">ln_Lambda</span> <span class="o">/</span> <span class="n">T_e</span><span class="o">**</span><span class="mf">1.5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">nu_ii</span><span class="p">(</span><span class="n">n_i</span><span class="p">,</span> <span class="n">T_i</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ion-ion collision frequency.</span>

<span class="sd">    Returns: frequency [s^-1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ln_Lambda</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="n">coulomb_logarithm</span><span class="p">(</span><span class="n">n_i</span><span class="p">,</span> <span class="n">T_i</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>

    <span class="c1"># Conversion factor</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="mf">1.45e-6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m_e</span> <span class="o">/</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">m_p</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">n_i</span> <span class="o">*</span> <span class="n">Z</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">ln_Lambda</span> <span class="o">/</span> <span class="n">T_i</span><span class="o">**</span><span class="mf">1.5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">spitzer_resistivity</span><span class="p">(</span><span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spitzer resistivity.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    T_e : float</span>
<span class="sd">        Electron temperature [eV]</span>
<span class="sd">    Z : int</span>
<span class="sd">        Ion charge</span>
<span class="sd">    ln_Lambda : float, optional</span>
<span class="sd">        Coulomb logarithm</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    eta : float</span>
<span class="sd">        Resistivity [Ohm*m]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ln_Lambda</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Typical value</span>

    <span class="k">return</span> <span class="mf">5.2e-5</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">ln_Lambda</span> <span class="o">/</span> <span class="n">T_e</span><span class="o">**</span><span class="mf">1.5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mean_free_path</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Electron mean free path.</span>

<span class="sd">    Returns: lambda_mfp [m]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ln_Lambda</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="n">coulomb_logarithm</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>

    <span class="k">return</span> <span class="mf">3.44e11</span> <span class="o">*</span> <span class="n">T_e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_e</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">ln_Lambda</span><span class="p">)</span>

<span class="c1"># Demonstration</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;COLLISION FREQUENCY ANALYSIS&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>

    <span class="c1"># Example: Tokamak parameters</span>
    <span class="n">n_e</span> <span class="o">=</span> <span class="mf">1e20</span>  <span class="c1"># m^-3</span>
    <span class="n">T_e</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># eV</span>
    <span class="n">T_i</span> <span class="o">=</span> <span class="mi">8000</span>   <span class="c1"># eV</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Deuterium</span>

    <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="n">coulomb_logarithm</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plasma Parameters:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  n_e = </span><span class="si">{</span><span class="n">n_e</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m^-3&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  T_e = </span><span class="si">{</span><span class="n">T_e</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  T_i = </span><span class="si">{</span><span class="n">T_i</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Z   = </span><span class="si">{</span><span class="n">Z</span><span class="si">}</span><span class="s2">, A = </span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ln Œõ = </span><span class="si">{</span><span class="n">ln_Lambda</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>

    <span class="n">nu_ei_val</span> <span class="o">=</span> <span class="n">nu_ei</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="p">)</span>
    <span class="n">nu_ee_val</span> <span class="o">=</span> <span class="n">nu_ee</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="p">)</span>
    <span class="n">nu_ii_val</span> <span class="o">=</span> <span class="n">nu_ii</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_i</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Collision Frequencies:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ŒΩ_ei = </span><span class="si">{</span><span class="n">nu_ei_val</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> s^-1  (period: </span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">nu_ei_val</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> s)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ŒΩ_ee = </span><span class="si">{</span><span class="n">nu_ee_val</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> s^-1  (period: </span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">nu_ee_val</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> s)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ŒΩ_ii = </span><span class="si">{</span><span class="n">nu_ii_val</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> s^-1  (period: </span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">nu_ii_val</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> s)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ratio ŒΩ_ei/ŒΩ_ii = </span><span class="si">{</span><span class="n">nu_ei_val</span><span class="o">/</span><span class="n">nu_ii_val</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>

    <span class="n">eta</span> <span class="o">=</span> <span class="n">spitzer_resistivity</span><span class="p">(</span><span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Spitzer Resistivity:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Œ∑ = </span><span class="si">{</span><span class="n">eta</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> Œ©¬∑m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  (Copper at 300 K: 1.7e-8 Œ©¬∑m)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>

    <span class="n">lambda_mfp</span> <span class="o">=</span> <span class="n">mean_free_path</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="p">)</span>
    <span class="n">v_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">eV_to_K</span> <span class="o">/</span> <span class="n">m_e</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mean Free Path:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Œª_mfp = </span><span class="si">{</span><span class="n">lambda_mfp</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  v_te  = </span><span class="si">{</span><span class="n">v_te</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  For system size L = 1 m:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Knudsen number Kn = </span><span class="si">{</span><span class="n">lambda_mfp</span><span class="o">/</span><span class="mi">1</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Regime: </span><span class="si">{</span><span class="s1">&#39;Collisionless&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">lambda_mfp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Collisional&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>

    <span class="c1"># Energy equipartition time</span>
    <span class="n">tau_eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">m_p</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m_e</span> <span class="o">*</span> <span class="n">nu_ei_val</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Energy Equipartition:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  œÑ_eq = </span><span class="si">{</span><span class="n">tau_eq</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> s = </span><span class="si">{</span><span class="n">tau_eq</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
</code></pre></div>

<h3 id="72-resistivity-vs-temperature">7.2 Resistivity vs Temperature<a class="header-link" href="#72-resistivity-vs-temperature" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_resistivity_vs_temperature</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot Spitzer resistivity as a function of temperature.&quot;&quot;&quot;</span>

    <span class="n">T_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># 1 eV to 10 keV</span>
    <span class="n">Z_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1"># H, He, C</span>

    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Linear-log plot</span>
    <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="n">Z_vals</span><span class="p">:</span>
        <span class="n">eta_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">spitzer_resistivity</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_vals</span><span class="p">]</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T_vals</span><span class="p">,</span> <span class="n">eta_vals</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Z=</span><span class="si">{</span><span class="n">Z</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Add reference: T^(-3/2) scaling</span>
    <span class="n">eta_ref</span> <span class="o">=</span> <span class="n">spitzer_resistivity</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_vals</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T_vals</span><span class="p">,</span> <span class="n">eta_ref</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\propto T^{-3/2}$&#39;</span><span class="p">)</span>

    <span class="c1"># Copper resistivity (room temp)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.7e-8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Copper (300 K)&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature $T_e$ [eV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Resistivity $\eta$ [Œ©¬∑m]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spitzer Resistivity vs Temperature&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e4</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>

    <span class="c1"># Conductivity plot</span>
    <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="n">Z_vals</span><span class="p">:</span>
        <span class="n">sigma_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">spitzer_resistivity</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">ln_Lambda</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_vals</span><span class="p">]</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T_vals</span><span class="p">,</span> <span class="n">sigma_vals</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Z=</span><span class="si">{</span><span class="n">Z</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature $T_e$ [eV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Conductivity $\sigma$ [S/m]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Electrical Conductivity vs Temperature&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e4</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;spitzer_resistivity.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_resistivity_vs_temperature</span><span class="p">()</span>
</code></pre></div>

<h3 id="73-collision-frequency-scaling">7.3 Collision Frequency Scaling<a class="header-link" href="#73-collision-frequency-scaling" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_collision_frequency_scaling</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize scaling of collision frequencies with n and T.&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Scan 1: Vary density at fixed T</span>
    <span class="n">n_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">T_fixed</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># eV</span>

    <span class="n">nu_ei_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">nu_ei</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_fixed</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_vals</span><span class="p">]</span>
    <span class="n">nu_ee_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">nu_ee</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_fixed</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_vals</span><span class="p">]</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">nu_ei_vals</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\nu_</span><span class="si">{ei}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_vals</span><span class="p">,</span> <span class="n">nu_ee_vals</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\nu_</span><span class="si">{ee}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Density $n_e$ [m$^{-3}$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Collision Frequency [s$^{-1}$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Collision Frequency vs Density (T=</span><span class="si">{</span><span class="n">T_fixed</span><span class="si">}</span><span class="s1"> eV)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Scan 2: Vary temperature at fixed n</span>
    <span class="n">T_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">n_fixed</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># m^-3</span>

    <span class="n">nu_ei_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">nu_ei</span><span class="p">(</span><span class="n">n_fixed</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_vals</span><span class="p">]</span>
    <span class="n">nu_ee_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">nu_ee</span><span class="p">(</span><span class="n">n_fixed</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_vals</span><span class="p">]</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T_vals</span><span class="p">,</span> <span class="n">nu_ei_vals</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\nu_</span><span class="si">{ei}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T_vals</span><span class="p">,</span> <span class="n">nu_ee_vals</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\nu_</span><span class="si">{ee}</span><span class="s1">$&#39;</span><span class="p">)</span>

    <span class="c1"># Reference line: T^(-3/2)</span>
    <span class="n">nu_ref</span> <span class="o">=</span> <span class="n">nu_ei</span><span class="p">(</span><span class="n">n_fixed</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_vals</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T_vals</span><span class="p">,</span> <span class="n">nu_ref</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
              <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\propto T^{-3/2}$&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature $T_e$ [eV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Collision Frequency [s$^{-1}$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Collision Frequency vs Temperature (n=</span><span class="si">{</span><span class="n">n_fixed</span><span class="si">:</span><span class="s1">.0e</span><span class="si">}</span><span class="s1"> m‚Åª¬≥)&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Scan 3: Mean free path vs temperature</span>
    <span class="n">lambda_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">mean_free_path</span><span class="p">(</span><span class="n">n_fixed</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_vals</span><span class="p">]</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T_vals</span><span class="p">,</span> <span class="n">lambda_vals</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;L = 1 m (device size)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature $T_e$ [eV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Mean Free Path $\lambda_</span><span class="si">{mfp}</span><span class="s1">$ [m]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Free Path vs Temperature (n=</span><span class="si">{</span><span class="n">n_fixed</span><span class="si">:</span><span class="s1">.0e</span><span class="si">}</span><span class="s1"> m‚Åª¬≥)&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Scan 4: Coulomb logarithm landscape</span>
    <span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">T_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">T_range</span><span class="p">)</span>

    <span class="n">ln_Lambda_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T_range</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_range</span><span class="p">)):</span>
            <span class="n">ln_Lambda_map</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">coulomb_logarithm</span><span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">ln_Lambda_map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\ln\Lambda$&#39;</span><span class="p">)</span>

    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">ln_Lambda_map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                    <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Density $n_e$ [m$^{-3}$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature $T_e$ [eV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Coulomb Logarithm Landscape&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;collision_frequency_scaling.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_collision_frequency_scaling</span><span class="p">()</span>
</code></pre></div>

<h3 id="74-collisionality-map">7.4 Collisionality Map<a class="header-link" href="#74-collisionality-map" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_collisionality_map</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a map showing collisional vs collisionless regimes</span>
<span class="sd">    for various system sizes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">T_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">T_range</span><span class="p">)</span>

    <span class="c1"># Mean free path</span>
    <span class="n">lambda_mfp_map</span> <span class="o">=</span> <span class="mf">3.44e11</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mi">15</span><span class="p">)</span>  <span class="c1"># ln Œõ ‚âà 15</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># Plot 1: Mean free path contours</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">1e4</span><span class="p">]</span>
    <span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">lambda_mfp_map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">())</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Mean Free Path $\lambda_</span><span class="si">{mfp}</span><span class="s1">$ [m]&#39;</span><span class="p">)</span>

    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">lambda_mfp_map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1"> m&#39;</span><span class="p">)</span>

    <span class="c1"># Mark typical system sizes</span>
    <span class="n">system_sizes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Tokamak&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;Lab device&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;Magnetosphere&#39;</span><span class="p">:</span> <span class="mf">1e7</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">system_sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Line where lambda_mfp = L (Kn = 1)</span>
        <span class="n">T_Kn1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="mf">3.44e11</span><span class="p">)</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">T_Kn1</span> <span class="o">&gt;=</span> <span class="n">T_range</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">T_Kn1</span> <span class="o">&lt;=</span> <span class="n">T_range</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="n">valid</span><span class="p">],</span> <span class="n">T_Kn1</span><span class="p">[</span><span class="n">valid</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

        <span class="c1"># Label</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">valid</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Kn=1 (L=</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s1">m)&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">T_Kn1</span><span class="p">[</span><span class="n">idx</span><span class="p">]),</span>
                       <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                       <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Density $n_e$ [m$^{-3}$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature $T_e$ [eV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean Free Path Landscape&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Plot 2: Knudsen number for L=1m</span>
    <span class="n">L_ref</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># m</span>
    <span class="n">Kn_map</span> <span class="o">=</span> <span class="n">lambda_mfp_map</span> <span class="o">/</span> <span class="n">L_ref</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">levels_Kn</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
    <span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Kn_map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels_Kn</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">())</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Knudsen Number (L=</span><span class="si">{</span><span class="n">L_ref</span><span class="si">}</span><span class="s1">m)&#39;</span><span class="p">)</span>

    <span class="c1"># Mark Kn = 1 (boundary)</span>
    <span class="n">cs_boundary</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Kn_map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                             <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs_boundary</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;Kn=1&#39;</span><span class="p">)</span>

    <span class="c1"># Shade regions</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e15</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;Collisionless</span><span class="se">\n</span><span class="s1">(Kn &gt;&gt; 1)&#39;</span><span class="p">,</span>
           <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
           <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e23</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Collisional</span><span class="se">\n</span><span class="s1">(Kn &lt;&lt; 1)&#39;</span><span class="p">,</span>
           <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
           <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Density $n_e$ [m$^{-3}$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature $T_e$ [eV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Collisionality Regime (L=</span><span class="si">{</span><span class="n">L_ref</span><span class="si">}</span><span class="s1"> m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;collisionality_map.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_collisionality_map</span><span class="p">()</span>
</code></pre></div>

<h2 id="summary">Summary<a class="header-link" href="#summary" title="Permanent link">&para;</a></h2>
<p>Coulomb collisions arise from the long-range electromagnetic interaction between charged particles and profoundly influence plasma transport and dynamics:</p>
<ol>
<li>
<p><strong>Rutherford scattering</strong> describes binary Coulomb collisions, with a differential cross-section strongly peaked in the forward direction.</p>
</li>
<li>
<p><strong>The Coulomb logarithm</strong> $\ln\Lambda \approx 10-20$ regularizes divergences by accounting for Debye screening (maximum impact parameter) and quantum/classical effects (minimum impact parameter).</p>
</li>
<li>
<p><strong>Collision frequencies</strong> scale as $\nu \propto n T^{-3/2}$, with electrons colliding much more frequently than ions due to their lower mass.</p>
</li>
<li>
<p><strong>Spitzer resistivity</strong> $\eta \propto T_e^{-3/2}$ decreases rapidly with temperature, making hot plasmas excellent conductors.</p>
</li>
<li>
<p><strong>Collisionality regimes</strong> are characterized by the Knudsen number $Kn = \lambda_{mfp}/L$, with fusion plasmas typically collisionless ($Kn \gg 1$) and requiring kinetic descriptions.</p>
</li>
<li>
<p><strong>Energy equipartition</strong> between electrons and ions occurs on slow timescales $\tau_{eq} \sim (m_i/m_e)\nu_{ei}^{-1}$, allowing separate temperature evolution in auxiliary-heated plasmas.</p>
</li>
</ol>
<p>Understanding collision dynamics is essential for modeling transport, heating, current drive, and the transition between kinetic and fluid descriptions.</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-collision-frequency-in-a-glow-discharge">Problem 1: Collision Frequency in a Glow Discharge<a class="header-link" href="#problem-1-collision-frequency-in-a-glow-discharge" title="Permanent link">&para;</a></h3>
<p>A neon glow discharge has $n_e = 10^{16}$ m$^{-3}$, $T_e = 2$ eV, $T_i = 0.05$ eV.</p>
<p>(a) Calculate the Coulomb logarithm.</p>
<p>(b) Compute the electron-ion collision frequency $\nu_{ei}$ and the collision period.</p>
<p>(c) Find the mean free path. Compare to a typical discharge tube diameter of 3 cm. Is this a collisional or collisionless plasma?</p>
<p>(d) Calculate the electron-electron collision frequency and compare to $\nu_{ei}$.</p>
<h3 id="problem-2-spitzer-resistivity-in-a-tokamak">Problem 2: Spitzer Resistivity in a Tokamak<a class="header-link" href="#problem-2-spitzer-resistivity-in-a-tokamak" title="Permanent link">&para;</a></h3>
<p>Consider a deuterium tokamak with:
- Core: $n_e = 5 \times 10^{19}$ m$^{-3}$, $T_e = 12$ keV
- Edge: $n_e = 2 \times 10^{18}$ m$^{-3}$, $T_e = 100$ eV</p>
<p>(a) Calculate the Spitzer resistivity at both locations.</p>
<p>(b) If a current density $J = 1$ MA/m$^2$ flows through the core, compute the Ohmic heating power density $P = \eta J^2$.</p>
<p>(c) The edge carries the same total current but through a smaller cross-section with $J_{edge} = 3$ MA/m$^2$. Compare the Ohmic heating power densities. Where is resistive heating more important?</p>
<p>(d) Estimate the voltage drop along a 10 m toroidal path for both core and edge.</p>
<h3 id="problem-3-temperature-equilibration">Problem 3: Temperature Equilibration<a class="header-link" href="#problem-3-temperature-equilibration" title="Permanent link">&para;</a></h3>
<p>An electron cyclotron resonance heating (ECRH) system deposits 1 MW into electrons in a deuterium plasma with $n_e = 10^{20}$ m$^{-3}$, $T_e = 5$ keV, $T_i = 3$ keV, and volume $V = 10$ m$^3$.</p>
<p>(a) Calculate the energy equipartition time $\tau_{eq}$.</p>
<p>(b) Estimate the rate of energy transfer from electrons to ions (in watts).</p>
<p>(c) If the energy confinement time is $\tau_E = 0.1$ s, compare $\tau_{eq}$ and $\tau_E$. Will the temperatures equilibrate?</p>
<p>(d) Find the steady-state electron and ion temperatures assuming all input power is lost through transport (neglect radiation and other losses). Use the fact that power balance gives:
   $$P_{ECRH} = P_{ei} + P_{loss,e}$$
   $$P_{ei} = P_{loss,i}$$
   where $P_{ei} \propto (T_e - T_i)/\tau_{eq}$ and $P_{loss} \propto 3nT/\tau_E$.</p>
<h3 id="problem-4-impact-parameter-estimates">Problem 4: Impact Parameter Estimates<a class="header-link" href="#problem-4-impact-parameter-estimates" title="Permanent link">&para;</a></h3>
<p>For an electron-ion collision in a hydrogen plasma at $T_e = 10$ eV and $n_e = 10^{18}$ m$^{-3}$:</p>
<p>(a) Calculate the Debye length $\lambda_D$.</p>
<p>(b) Compute the 90¬∞ scattering impact parameter $b_{90}$ using the thermal velocity.</p>
<p>(c) Find the de Broglie wavelength $\lambda_{dB} = \hbar/(m_e v_{th})$ and compare to $b_{90}$. Which determines $b_{min}$?</p>
<p>(d) Calculate $\ln\Lambda = \ln(b_{max}/b_{min})$ and compare to the standard formula.</p>
<h3 id="problem-5-collisionality-regimes">Problem 5: Collisionality Regimes<a class="header-link" href="#problem-5-collisionality-regimes" title="Permanent link">&para;</a></h3>
<p>A magnetized plasma column has $B = 0.5$ T along the axis, with length $L_\parallel = 2$ m and radius $r = 0.1$ m.</p>
<p>(a) For $n_e = 10^{18}$ m$^{-3}$ and $T_e = 50$ eV, calculate the parallel and perpendicular mean free paths. (Hint: $\lambda_{\parallel} = v_{th,\parallel}/\nu$ and $\lambda_\perp \sim r_L$ if $r_L \ll \lambda_{mfp}$.)</p>
<p>(b) Compute the Knudsen numbers $Kn_\parallel = \lambda_{mfp}/L_\parallel$ and $Kn_\perp = \lambda_{mfp}/r$.</p>
<p>(c) Is the plasma collisional or collisionless along field lines? Across field lines?</p>
<p>(d) Repeat for $n_e = 10^{20}$ m$^{-3}$ and $T_e = 1$ keV. How does the collisionality change?</p>
<hr />
<p><strong>Previous:</strong> <a href="./01_Introduction_to_Plasma.md">Introduction to Plasma</a> | <strong>Next:</strong> <a href="./03_Plasma_Description_Hierarchy.md">Plasma Description Hierarchy</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Plasma_Physics/01_Introduction_to_Plasma.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">1. Introduction to Plasma</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Plasma_Physics/03_Plasma_Description_Hierarchy.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">3. Plasma Description Hierarchy</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}