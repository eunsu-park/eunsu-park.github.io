{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10. Electrostatic Waves - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Plasma_Physics/">Plasma Physics</a>
    <span class="separator">/</span>
    <span class="current">10. Electrostatic Waves</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>10. Electrostatic Waves</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Plasma_Physics/09_Collisional_Kinetics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">9. Collisional Kinetics</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Plasma_Physics/11_Electromagnetic_Waves.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">11. Electromagnetic Waves in Plasma</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#1-general-electrostatic-dispersion-framework">1. General Electrostatic Dispersion Framework</a><ul>
<li><a href="#11-dielectric-function-and-susceptibility">1.1 Dielectric Function and Susceptibility</a></li>
<li><a href="#12-cold-plasma-limit">1.2 Cold Plasma Limit</a></li>
<li><a href="#13-warm-plasma-kinetic-effects">1.3 Warm Plasma: Kinetic Effects</a></li>
</ul>
</li>
<li><a href="#2-langmuir-waves-electron-plasma-oscillations">2. Langmuir Waves (Electron Plasma Oscillations)</a><ul>
<li><a href="#21-cold-plasma-pure-oscillation">2.1 Cold Plasma: Pure Oscillation</a></li>
<li><a href="#22-warm-plasma-bohm-gross-dispersion">2.2 Warm Plasma: Bohm-Gross Dispersion</a></li>
<li><a href="#23-landau-damping-of-langmuir-waves">2.3 Landau Damping of Langmuir Waves</a></li>
</ul>
</li>
<li><a href="#3-ion-acoustic-waves">3. Ion Acoustic Waves</a><ul>
<li><a href="#31-derivation-two-fluid-model">3.1 Derivation: Two-Fluid Model</a></li>
<li><a href="#32-physical-picture">3.2 Physical Picture</a></li>
<li><a href="#33-ion-landau-damping">3.3 Ion Landau Damping</a></li>
<li><a href="#34-role-in-turbulence">3.4 Role in Turbulence</a></li>
</ul>
</li>
<li><a href="#4-waves-in-magnetized-plasmas">4. Waves in Magnetized Plasmas</a><ul>
<li><a href="#41-upper-hybrid-resonance">4.1 Upper Hybrid Resonance</a></li>
<li><a href="#42-lower-hybrid-resonance">4.2 Lower Hybrid Resonance</a></li>
<li><a href="#43-warm-plasma-corrections">4.3 Warm Plasma Corrections</a></li>
</ul>
</li>
<li><a href="#5-bernstein-modes">5. Bernstein Modes</a><ul>
<li><a href="#51-electron-bernstein-modes">5.1 Electron Bernstein Modes</a></li>
<li><a href="#52-ion-bernstein-modes">5.2 Ion Bernstein Modes</a></li>
<li><a href="#53-mode-conversion">5.3 Mode Conversion</a></li>
</ul>
</li>
<li><a href="#6-python-implementation">6. Python Implementation</a><ul>
<li><a href="#61-langmuir-wave-dispersion">6.1 Langmuir Wave Dispersion</a></li>
<li><a href="#62-ion-acoustic-wave-dispersion">6.2 Ion Acoustic Wave Dispersion</a></li>
<li><a href="#63-upper-and-lower-hybrid-frequencies">6.3 Upper and Lower Hybrid Frequencies</a></li>
<li><a href="#64-bernstein-mode-dispersion">6.4 Bernstein Mode Dispersion</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-langmuir-wave-properties">Problem 1: Langmuir Wave Properties</a></li>
<li><a href="#problem-2-ion-acoustic-wave-damping">Problem 2: Ion Acoustic Wave Damping</a></li>
<li><a href="#problem-3-hybrid-resonances">Problem 3: Hybrid Resonances</a></li>
<li><a href="#problem-4-bernstein-wave-heating">Problem 4: Bernstein Wave Heating</a></li>
<li><a href="#problem-5-dispersion-relation-analysis">Problem 5: Dispersion Relation Analysis</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="10-electrostatic-waves">10. Electrostatic Waves<a class="header-link" href="#10-electrostatic-waves" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Understand the general framework for electrostatic wave dispersion relations</li>
<li>Derive the Bohm-Gross dispersion for Langmuir waves in warm plasmas</li>
<li>Analyze ion acoustic waves and their damping conditions</li>
<li>Compute upper hybrid and lower hybrid resonances in magnetized plasmas</li>
<li>Learn about Bernstein modes and their role in wave heating</li>
<li>Solve electrostatic dispersion relations numerically for various plasma parameters</li>
</ul>
<h2 id="introduction">Introduction<a class="header-link" href="#introduction" title="Permanent link">&para;</a></h2>
<p>In the previous lessons, we studied MHD and electromagnetic waves, which involve magnetic field perturbations. Now we focus on <strong>electrostatic waves</strong>, where:</p>
<p>$$\mathbf{B}_1 = 0, \quad \mathbf{E}_1 = -\nabla\phi_1$$</p>
<p>These waves involve only electric field fluctuations and can be derived from the scalar potential. They arise from charge separation and are governed by Poisson's equation:</p>
<p>$$\nabla \cdot \mathbf{E}_1 = \frac{\rho_1}{\epsilon_0}$$</p>
<p>Electrostatic waves are important for:
- Plasma heating and current drive (electron cyclotron, lower hybrid)
- Diagnostics (Thomson scattering, collective modes)
- Understanding instabilities (two-stream, drift waves)
- Wave-particle interactions (Landau damping, quasilinear theory)</p>
<p>The key tool is the <strong>dielectric function</strong> $\epsilon(\mathbf{k}, \omega)$, which encodes the plasma's response to electromagnetic perturbations.</p>
<h2 id="1-general-electrostatic-dispersion-framework">1. General Electrostatic Dispersion Framework<a class="header-link" href="#1-general-electrostatic-dispersion-framework" title="Permanent link">&para;</a></h2>
<h3 id="11-dielectric-function-and-susceptibility">1.1 Dielectric Function and Susceptibility<a class="header-link" href="#11-dielectric-function-and-susceptibility" title="Permanent link">&para;</a></h3>
<p>For a perturbation $\propto e^{i(\mathbf{k}\cdot\mathbf{x} - \omega t)}$, Poisson's equation becomes:</p>
<p>$$\mathbf{k} \cdot \mathbf{E}_1 = \frac{\rho_1}{\epsilon_0}$$</p>
<p>The induced charge density $\rho_1$ depends on the electric field through the plasma response. Define the <strong>dielectric function</strong> $\epsilon(\mathbf{k}, \omega)$ such that:</p>
<p>$$\mathbf{k} \cdot \mathbf{D} = \mathbf{k} \cdot (\epsilon_0 \epsilon \mathbf{E}_1) = 0$$</p>
<p>For electrostatic waves, this gives:</p>
<p>$$\boxed{\epsilon(\mathbf{k}, \omega) = 0}$$</p>
<p>This is the <strong>electrostatic dispersion relation</strong>.</p>
<p>The dielectric function is related to the <strong>susceptibility</strong> $\chi_s$ of each species:</p>
<p>$$\epsilon = 1 + \sum_s \chi_s(\mathbf{k}, \omega)$$</p>
<p>The susceptibility describes how species $s$ responds to the electric field:</p>
<p>$$\chi_s = \frac{n_{1s}/n_0}{\epsilon_0 E_1 / (e_s n_0)}$$</p>
<p>From the linearized Vlasov equation, the susceptibility for species $s$ is:</p>
<p>$$\chi_s(\mathbf{k}, \omega) = -\frac{\omega_{ps}^2}{k^2} \int \frac{\mathbf{k} \cdot \partial f_0/\partial \mathbf{v}}{\omega - \mathbf{k}\cdot\mathbf{v}} d^3v$$</p>
<p>where $\omega_{ps}^2 = n_0 e_s^2 / (\epsilon_0 m_s)$ is the plasma frequency.</p>
<h3 id="12-cold-plasma-limit">1.2 Cold Plasma Limit<a class="header-link" href="#12-cold-plasma-limit" title="Permanent link">&para;</a></h3>
<p>For a <strong>cold plasma</strong> ($T = 0$, $f_0 = n_0 \delta(\mathbf{v})$), the integral simplifies. Particles respond to the wave electric field via:</p>
<p>$$m \frac{d\mathbf{v}_1}{dt} = e \mathbf{E}_1$$</p>
<p>For harmonic perturbations $\propto e^{-i\omega t}$:
$$-i\omega m \mathbf{v}_1 = e \mathbf{E}_1$$</p>
<p>The density perturbation from continuity is:
$$-i\omega n_1 + n_0 i\mathbf{k}\cdot\mathbf{v}_1 = 0$$</p>
<p>Combining:
$$n_1 = \frac{n_0 \mathbf{k}\cdot\mathbf{v}_1}{\omega} = \frac{n_0 e \mathbf{k}\cdot\mathbf{E}_1}{m\omega^2}$$</p>
<p>The susceptibility is:
$$\chi_s = \frac{n_1 e_s}{\epsilon_0 E_1 n_0} = -\frac{\omega_{ps}^2}{\omega^2}$$</p>
<p>The dielectric function for multiple cold species:</p>
<p>$$\epsilon = 1 - \sum_s \frac{\omega_{ps}^2}{\omega^2}$$</p>
<h3 id="13-warm-plasma-kinetic-effects">1.3 Warm Plasma: Kinetic Effects<a class="header-link" href="#13-warm-plasma-kinetic-effects" title="Permanent link">&para;</a></h3>
<p>For a <strong>warm plasma</strong> with thermal velocity $v_{th}$, kinetic effects become important when:</p>
<p>$$\frac{\omega}{k} \sim v_{th}$$</p>
<p>The phase velocity $v_\phi = \omega/k$ is comparable to particle velocities. This leads to:
- <strong>Landau damping</strong>: resonant wave-particle interaction
- <strong>Thermal dispersion</strong>: wave frequency depends on $k v_{th}$</p>
<p>For a Maxwellian distribution:
$$f_0(\mathbf{v}) = n_0 \left(\frac{m}{2\pi k_B T}\right)^{3/2} \exp\left(-\frac{m v^2}{2k_B T}\right)$$</p>
<p>the 1D susceptibility (for $\mathbf{k} = k \hat{z}$) involves the <strong>plasma dispersion function</strong> $Z(\zeta)$:</p>
<p>$$\chi_s = -\frac{\omega_{ps}^2}{k^2 v_{th,s}^2} \left[1 + \zeta_s Z(\zeta_s)\right]$$</p>
<p>where $\zeta_s = \omega/(k v_{th,s})$ and:</p>
<p>$$Z(\zeta) = \frac{1}{\sqrt{\pi}} \int_{-\infty}^{\infty} \frac{e^{-x^2}}{x - \zeta} dx$$</p>
<p>For large $|\zeta|$ (phase velocity $\gg v_{th}$):
$$Z(\zeta) \approx -\frac{1}{\zeta}\left(1 + \frac{1}{2\zeta^2} + \frac{3}{4\zeta^4} + \cdots\right)$$</p>
<p>This gives thermal corrections to the cold plasma result.</p>
<h2 id="2-langmuir-waves-electron-plasma-oscillations">2. Langmuir Waves (Electron Plasma Oscillations)<a class="header-link" href="#2-langmuir-waves-electron-plasma-oscillations" title="Permanent link">&para;</a></h2>
<h3 id="21-cold-plasma-pure-oscillation">2.1 Cold Plasma: Pure Oscillation<a class="header-link" href="#21-cold-plasma-pure-oscillation" title="Permanent link">&para;</a></h3>
<p>In an unmagnetized plasma with stationary ions, the cold plasma dispersion is:</p>
<p>$$\epsilon = 1 - \frac{\omega_{pe}^2}{\omega^2} = 0$$</p>
<p>This gives:
$$\boxed{\omega = \omega_{pe}}$$</p>
<p>These are <strong>Langmuir waves</strong> (or electron plasma oscillations), first observed by Langmuir and Tonks in 1929.</p>
<p>Properties:
- <strong>Dispersionless</strong>: $\omega$ independent of $k$
- <strong>No propagation</strong>: group velocity $v_g = d\omega/dk = 0$
- <strong>Standing oscillation</strong>: electrons oscillate collectively
- <strong>High frequency</strong>: $\omega_{pe} \sim 10^{9}-10^{11}$ rad/s for typical plasmas</p>
<p>Physical picture:</p>
<div class="highlight"><pre><span></span><code>Time t=0:           Time t=T/4:         Time t=T/2:
-  +  -  +  -       - - -  +  +  +      -  +  -  +  -
Ions (stationary)   Electrons          Back to equilibrium
                    displaced
</code></pre></div>

<h3 id="22-warm-plasma-bohm-gross-dispersion">2.2 Warm Plasma: Bohm-Gross Dispersion<a class="header-link" href="#22-warm-plasma-bohm-gross-dispersion" title="Permanent link">&para;</a></h3>
<p>Including electron thermal motion, the dispersion becomes:</p>
<p>$$1 - \frac{\omega_{pe}^2}{k^2 v_{th,e}^2}[1 + \zeta_e Z(\zeta_e)] = 0$$</p>
<p>For $\omega \gg k v_{th,e}$ (weak thermal effects), expand to first order:</p>
<p>$$1 - \frac{\omega_{pe}^2}{\omega^2}\left(1 + \frac{3k^2 v_{th,e}^2}{\omega^2}\right) = 0$$</p>
<p>Solving for $\omega^2$:</p>
<p>$$\boxed{\omega^2 = \omega_{pe}^2 + 3k^2 v_{th,e}^2}$$</p>
<p>This is the <strong>Bohm-Gross dispersion relation</strong> (1949), where $v_{th,e} = \sqrt{k_B T_e / m_e}$.</p>
<p>Properties:
- <strong>Dispersive</strong>: $\omega$ depends on $k$
- <strong>Phase velocity</strong>: $v_\phi = \omega/k = \sqrt{\omega_{pe}^2/k^2 + 3v_{th,e}^2}$
- <strong>Group velocity</strong>: $v_g = d\omega/dk = 3k v_{th,e}^2/\omega$
- <strong>Cutoff</strong>: minimum frequency $\omega_{pe}$ at $k = 0$</p>
<p>The thermal correction is important when:
$$k\lambda_D \sim 1$$</p>
<p>where $\lambda_D = v_{th,e}/\omega_{pe}$ is the Debye length.</p>
<h3 id="23-landau-damping-of-langmuir-waves">2.3 Landau Damping of Langmuir Waves<a class="header-link" href="#23-landau-damping-of-langmuir-waves" title="Permanent link">&para;</a></h3>
<p>For $\omega/k \sim v_{th,e}$, the imaginary part of $Z(\zeta)$ gives damping:</p>
<p>$$\text{Im}\,\omega = -\sqrt{\frac{\pi}{8}} \frac{\omega_{pe}}{k^3 \lambda_D^3} \exp\left(-\frac{\omega_{pe}^2}{2k^2 v_{th,e}^2} - \frac{3}{2}\right)$$</p>
<p>The damping rate decreases exponentially for $k\lambda_D \ll 1$.</p>
<p>Physical picture: particles moving at $v \approx \omega/k$ can exchange energy with the wave resonantly. If there are more slow particles than fast particles (Maxwellian has negative slope at high $v$), the wave loses energy.</p>
<h2 id="3-ion-acoustic-waves">3. Ion Acoustic Waves<a class="header-link" href="#3-ion-acoustic-waves" title="Permanent link">&para;</a></h2>
<h3 id="31-derivation-two-fluid-model">3.1 Derivation: Two-Fluid Model<a class="header-link" href="#31-derivation-two-fluid-model" title="Permanent link">&para;</a></h3>
<p>Consider <strong>low-frequency</strong> oscillations where:
- Electrons respond adiabatically (fast, isothermal)
- Ions respond dynamically (slow, inertial)</p>
<p><strong>Electron response</strong> (Boltzmann relation):
$$n_e = n_0 \exp\left(\frac{e\phi}{k_B T_e}\right) \approx n_0\left(1 + \frac{e\phi}{k_B T_e}\right)$$</p>
<p><strong>Ion continuity and momentum</strong>:
$$\frac{\partial n_i}{\partial t} + \nabla\cdot(n_i \mathbf{v}_i) = 0$$</p>
<p>$$m_i n_i \frac{\partial \mathbf{v}_i}{\partial t} = -e n_i \nabla\phi - \nabla(n_i k_B T_i)$$</p>
<p><strong>Poisson equation</strong>:
$$\epsilon_0 \nabla^2 \phi = e(n_e - n_i)$$</p>
<p>Linearizing with $n_e = n_0 + n_{e1}$, $n_i = n_0 + n_{i1}$, $\phi = \phi_1$, and assuming $e^{i(kx - \omega t)}$:</p>
<p>$$-\omega^2 m_i n_{i1} = -k^2 e n_{i1} \phi_1 - k^2 n_{i1} k_B T_i$$</p>
<p>$$-k^2 \epsilon_0 \phi_1 = e\left(\frac{e n_0 \phi_1}{k_B T_e} - n_{i1}\right)$$</p>
<p>Combining:
$$-k^2 \epsilon_0 \phi_1 = e\left(\frac{e n_0 \phi_1}{k_B T_e} - \frac{k^2 e \phi_1 (n_0 + k_B T_i k^2/\omega^2 m_i)}{\omega^2 m_i - k^2 k_B T_i}\right)$$</p>
<p>After algebra, the dispersion relation is:</p>
<p>$$\omega^2 = \frac{k^2 k_B T_e}{m_i (1 + k^2 \lambda_D^2)} \left(\frac{1 + 3T_i/T_e}{1 + k^2\lambda_D^2}\right)$$</p>
<p>For $k\lambda_D \ll 1$:</p>
<p>$$\boxed{\omega \approx k c_s}$$</p>
<p>where the <strong>ion acoustic speed</strong> is:</p>
<p>$$\boxed{c_s = \sqrt{\frac{k_B T_e}{m_i}}}$$</p>
<p>assuming $T_i \ll T_e$.</p>
<h3 id="32-physical-picture">3.2 Physical Picture<a class="header-link" href="#32-physical-picture" title="Permanent link">&para;</a></h3>
<p>Ion acoustic waves are analogous to sound waves in a neutral gas, but:
- Restoring force: electron pressure (not ion pressure)
- Inertia: ion mass
- Electrons act as a thermodynamic reservoir</p>
<div class="highlight"><pre><span></span><code>Ion density:     High    Low     High    Low
                  |       |       |       |
                  v       ^       v       ^
                 +++     ---     +++     ---
Electron cloud: (responds adiabatically)

Wave propagates at c_s ~ ‚àö(Te/mi)
</code></pre></div>

<p>Typical speeds:
- $T_e = 10$ eV, hydrogen: $c_s \approx 50$ km/s
- $T_e = 1$ keV, deuterium: $c_s \approx 200$ km/s</p>
<p>Much slower than electron thermal velocity ($v_{th,e} \sim 10^3$ km/s), but faster than ion thermal velocity ($v_{th,i} \sim 10$ km/s).</p>
<h3 id="33-ion-landau-damping">3.3 Ion Landau Damping<a class="header-link" href="#33-ion-landau-damping" title="Permanent link">&para;</a></h3>
<p>For $\omega/k \sim v_{th,i}$, ions moving near the wave phase velocity can damp the wave:</p>
<p>$$\gamma \approx -\sqrt{\frac{\pi}{8}} \frac{c_s}{k\lambda_D} \left(\frac{T_i}{T_e}\right)^{3/2} \exp\left(-\frac{1}{2k^2\lambda_D^2} - \frac{3}{2}\right)$$</p>
<p>The condition for <strong>weak damping</strong> is:</p>
<p>$$T_e \gg T_i$$</p>
<p>If $T_e \sim T_i$, the waves are heavily damped and don't propagate effectively.</p>
<p>This is observed in lab plasmas:
- Hot electrons, cold ions: strong ion acoustic waves
- Comparable temperatures: waves damped out</p>
<h3 id="34-role-in-turbulence">3.4 Role in Turbulence<a class="header-link" href="#34-role-in-turbulence" title="Permanent link">&para;</a></h3>
<p>Ion acoustic turbulence is ubiquitous in plasmas:
- Driven by current (ion acoustic instability)
- Nonlinear interactions create spectrum of modes
- Leads to anomalous resistivity, heating</p>
<p>Observed in:
- Ionosphere (radar scatter)
- Solar wind
- Tokamak edge plasmas</p>
<h2 id="4-waves-in-magnetized-plasmas">4. Waves in Magnetized Plasmas<a class="header-link" href="#4-waves-in-magnetized-plasmas" title="Permanent link">&para;</a></h2>
<h3 id="41-upper-hybrid-resonance">4.1 Upper Hybrid Resonance<a class="header-link" href="#41-upper-hybrid-resonance" title="Permanent link">&para;</a></h3>
<p>In a magnetized plasma, electrons gyrate at $\omega_{ce}$ while also oscillating at $\omega_{pe}$. For waves propagating perpendicular to $\mathbf{B}$ ($\mathbf{k} \perp \mathbf{B}$), the two motions couple.</p>
<p>The dispersion relation for electrostatic waves across $\mathbf{B}$ is:</p>
<p>$$\epsilon_{\perp} = 1 - \frac{\omega_{pe}^2}{\omega^2 - \omega_{ce}^2} = 0$$</p>
<p>This gives:</p>
<p>$$\boxed{\omega_{UH}^2 = \omega_{pe}^2 + \omega_{ce}^2}$$</p>
<p>This is the <strong>upper hybrid frequency</strong>.</p>
<p>Physical picture:
- Electrons oscillate at $\omega_{pe}$
- Magnetic field adds restoring force from $\mathbf{v} \times \mathbf{B}$
- Effective frequency is geometric mean of the two</p>
<p>The upper hybrid layer (where $\omega = \omega_{UH}$) is used for:
- Plasma heating (upper hybrid resonance heating)
- Current drive
- Diagnostics (reflectometry)</p>
<h3 id="42-lower-hybrid-resonance">4.2 Lower Hybrid Resonance<a class="header-link" href="#42-lower-hybrid-resonance" title="Permanent link">&para;</a></h3>
<p>For lower frequencies involving ion motion, the <strong>lower hybrid frequency</strong> arises from coupling of ion cyclotron and ion plasma oscillations:</p>
<p>$$\frac{1}{\omega_{LH}^2} = \frac{1}{\omega_{ci}\omega_{ce}} + \frac{1}{\omega_{pi}^2 + \omega_{ci}^2}$$</p>
<p>For $\omega_{pi}^2 \gg \omega_{ci}^2$:</p>
<p>$$\boxed{\omega_{LH} \approx \sqrt{\frac{\omega_{ci}\omega_{ce}}{1 + \omega_{pe}^2/\omega_{ce}^2}} \approx \sqrt{\omega_{ci}\omega_{ce}}}$$</p>
<p>(assuming $\omega_{pe}^2 \ll \omega_{ce}^2$).</p>
<p>Typical values:
- $B = 5$ T, $n = 10^{20}$ m$^{-3}$, hydrogen
- $f_{ce} \approx 140$ GHz, $f_{ci} \approx 76$ MHz
- $f_{LH} \approx 3.3$ GHz</p>
<p>Lower hybrid waves are used extensively for:
- <strong>Current drive</strong>: can drive currents efficiently via Landau damping
- Heating (though less efficient than ECRH or ICRH)
- Plasma startup in tokamaks</p>
<p>The waves can propagate at specific angles to $\mathbf{B}$, allowing localized deposition.</p>
<h3 id="43-warm-plasma-corrections">4.3 Warm Plasma Corrections<a class="header-link" href="#43-warm-plasma-corrections" title="Permanent link">&para;</a></h3>
<p>Including finite temperature, the cutoff and resonances shift:</p>
<p>$$\omega_{UH}^2 = \omega_{pe}^2 + \omega_{ce}^2 + 3k^2 v_{th,e}^2$$</p>
<p>For lower hybrid:
$$\omega_{LH}^2 \approx \omega_{ci}\omega_{ce} \left(1 + \frac{\omega_{pe}^2}{\omega_{ce}^2}\right)^{-1}\left(1 + k^2\lambda_D^2\right)$$</p>
<p>The thermal corrections become important when $k\lambda_D \sim 1$ or $k\rho_L \sim 1$ (where $\rho_L$ is Larmor radius).</p>
<h2 id="5-bernstein-modes">5. Bernstein Modes<a class="header-link" href="#5-bernstein-modes" title="Permanent link">&para;</a></h2>
<h3 id="51-electron-bernstein-modes">5.1 Electron Bernstein Modes<a class="header-link" href="#51-electron-bernstein-modes" title="Permanent link">&para;</a></h3>
<p>At harmonics of the electron cyclotron frequency, <strong>electrostatic</strong> modes can propagate even when electromagnetic waves are cutoff. These are <strong>Bernstein modes</strong>.</p>
<p>The dispersion relation involves Bessel functions. Near the $n$-th harmonic:</p>
<p>$$\omega \approx n\omega_{ce}\left(1 + \frac{k^2 v_{th,e}^2}{2\omega_{ce}^2}\right)$$</p>
<p>These modes exist for $\omega \approx n\omega_{ce}$, $n = 1, 2, 3, \ldots$</p>
<p>Properties:
- Electrostatic (no $\mathbf{B}_1$)
- Can propagate where EM waves cannot
- Strong interaction with resonant electrons
- Used for heating and current drive</p>
<p>The hot plasma dielectric for $\mathbf{k} \perp \mathbf{B}$ is:</p>
<p>$$\epsilon_{\perp} = 1 + \frac{\omega_{pe}^2}{k^2 v_{th,e}^2} \sum_{n=-\infty}^{\infty} \frac{I_n(\lambda) e^{-\lambda}}{\omega/\omega_{ce} - n} \left(\frac{\omega}{k v_{th,e}}\right)Z\left(\frac{\omega - n\omega_{ce}}{k v_{th,e}}\right)$$</p>
<p>where $\lambda = k^2 \rho_L^2$ and $I_n$ is the modified Bessel function.</p>
<h3 id="52-ion-bernstein-modes">5.2 Ion Bernstein Modes<a class="header-link" href="#52-ion-bernstein-modes" title="Permanent link">&para;</a></h3>
<p>Similarly, ion Bernstein modes exist near harmonics of $\omega_{ci}$:</p>
<p>$$\omega \approx n\omega_{ci}\left(1 + \frac{k^2 v_{th,i}^2}{2\omega_{ci}^2}\right)$$</p>
<p>These are important for:
- Ion heating in dense plasmas
- Mode conversion heating (EM wave converts to electrostatic Bernstein mode)
- Understanding kinetic Alfv√©n waves at small scales</p>
<h3 id="53-mode-conversion">5.3 Mode Conversion<a class="header-link" href="#53-mode-conversion" title="Permanent link">&para;</a></h3>
<p>In inhomogeneous plasmas, electromagnetic waves can <strong>mode convert</strong> to electrostatic waves at specific locations:</p>
<div class="highlight"><pre><span></span><code>EM wave (O-mode or X-mode)
       |
       v
  Cutoff/Resonance layer
       |
       v
Bernstein wave (electrostatic)
       |
       v
   Absorption via Landau/cyclotron damping
</code></pre></div>

<p>This is used in <strong>mode conversion heating</strong> schemes, avoiding cutoff issues with direct EM wave injection.</p>
<h2 id="6-python-implementation">6. Python Implementation<a class="header-link" href="#6-python-implementation" title="Permanent link">&para;</a></h2>
<h3 id="61-langmuir-wave-dispersion">6.1 Langmuir Wave Dispersion<a class="header-link" href="#61-langmuir-wave-dispersion" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">wofz</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plasma_dispersion_Z</span><span class="p">(</span><span class="n">zeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plasma dispersion function Z(Œ∂).</span>

<span class="sd">    Z(Œ∂) = (1/‚àöœÄ) ‚à´ exp(-x¬≤)/(x - Œ∂) dx</span>

<span class="sd">    Uses Faddeeva function: Z(Œ∂) = i‚àöœÄ w(Œ∂) where w(z) = exp(-z¬≤)erfc(-iz)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">wofz</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">langmuir_dispersion_cold</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">omega_pe</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cold plasma dispersion: œâ = œâ_pe (independent of k).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">omega_pe</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">langmuir_dispersion_warm</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">omega_pe</span><span class="p">,</span> <span class="n">v_th</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Warm plasma dispersion (Bohm-Gross): œâ¬≤ = œâ_pe¬≤ + 3k¬≤v_th¬≤.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">omega_pe</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v_th</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">langmuir_dispersion_kinetic</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">omega_pe</span><span class="p">,</span> <span class="n">v_th</span><span class="p">,</span> <span class="n">num_points</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve full kinetic dispersion using plasma dispersion function.</span>

<span class="sd">    Œµ = 1 - (œâ_pe¬≤/k¬≤v_th¬≤)[1 + Œ∂Z(Œ∂)] = 0</span>
<span class="sd">    where Œ∂ = œâ/(kv_th)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">omega_solutions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k_val</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k_val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">omega_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">omega_pe</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># Search for real part of œâ</span>
        <span class="n">omega_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">omega_pe</span><span class="p">,</span> <span class="n">omega_pe</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>

        <span class="n">epsilon</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">omega</span> <span class="ow">in</span> <span class="n">omega_range</span><span class="p">:</span>
            <span class="n">zeta</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_val</span> <span class="o">*</span> <span class="n">v_th</span><span class="p">)</span>
            <span class="n">Z_val</span> <span class="o">=</span> <span class="n">plasma_dispersion_Z</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
            <span class="n">eps</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">omega_pe</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_val</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v_th</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">zeta</span> <span class="o">*</span> <span class="n">Z_val</span><span class="p">)</span>
            <span class="n">epsilon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eps</span><span class="p">))</span>

        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">epsilon</span><span class="p">)</span>

        <span class="c1"># Find zero crossing</span>
        <span class="n">sign_changes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">epsilon</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sign_changes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">sign_changes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">omega_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">omega_range</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">omega_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">omega_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">omega_solutions</span><span class="p">)</span>

<span class="c1"># Parameters</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># m^-3</span>
<span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># eV</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.109e-31</span>  <span class="c1"># kg</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">1.602e-19</span>  <span class="c1"># C</span>
<span class="n">epsilon_0</span> <span class="o">=</span> <span class="mf">8.854e-12</span>  <span class="c1"># F/m</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.381e-23</span>  <span class="c1"># J/K</span>

<span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">epsilon_0</span> <span class="o">*</span> <span class="n">m_e</span><span class="p">))</span>
<span class="n">v_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">m_e</span><span class="p">)</span>
<span class="n">lambda_D</span> <span class="o">=</span> <span class="n">v_th</span> <span class="o">/</span> <span class="n">omega_pe</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plasma frequency: f_pe = </span><span class="si">{</span><span class="n">omega_pe</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Thermal velocity: v_th = </span><span class="si">{</span><span class="n">v_th</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Mm/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Debye length: Œª_D = </span><span class="si">{</span><span class="n">lambda_D</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Œºm&quot;</span><span class="p">)</span>

<span class="c1"># Wavenumber array</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">lambda_D</span>  <span class="c1"># Normalize to 1/Œª_D</span>

<span class="c1"># Compute dispersions</span>
<span class="n">omega_cold</span> <span class="o">=</span> <span class="n">langmuir_dispersion_cold</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">omega_pe</span><span class="p">)</span>
<span class="n">omega_warm</span> <span class="o">=</span> <span class="n">langmuir_dispersion_warm</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">omega_pe</span><span class="p">,</span> <span class="n">v_th</span><span class="p">)</span>
<span class="n">omega_kinetic</span> <span class="o">=</span> <span class="n">langmuir_dispersion_kinetic</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">omega_pe</span><span class="p">,</span> <span class="n">v_th</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Dispersion relation</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">omega_cold</span> <span class="o">/</span> <span class="n">omega_pe</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cold plasma&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">omega_warm</span> <span class="o">/</span> <span class="n">omega_pe</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bohm-Gross&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">omega_kinetic</span> <span class="o">/</span> <span class="n">omega_pe</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic (full)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$k</span><span class="se">\\</span><span class="s1">lambda_D$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega / </span><span class="se">\\</span><span class="s1">omega_</span><span class="si">{pe}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Langmuir Wave Dispersion&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">])</span>

<span class="c1"># Phase and group velocity</span>
<span class="n">v_phase_warm</span> <span class="o">=</span> <span class="n">omega_warm</span> <span class="o">/</span> <span class="n">k</span>
<span class="n">v_group_warm</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v_th</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">omega_warm</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">v_phase_warm</span> <span class="o">/</span> <span class="n">v_th</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_</span><span class="se">\\</span><span class="s1">phi$ (Bohm-Gross)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">v_group_warm</span> <span class="o">/</span> <span class="n">v_th</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_g$ (Bohm-Gross)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_</span><span class="si">{th}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$k</span><span class="se">\\</span><span class="s1">lambda_D$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity / $v_</span><span class="si">{th}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase and Group Velocity&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;langmuir_dispersion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="62-ion-acoustic-wave-dispersion">6.2 Ion Acoustic Wave Dispersion<a class="header-link" href="#62-ion-acoustic-wave-dispersion" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ion_acoustic_dispersion</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">T_i</span><span class="p">,</span> <span class="n">m_i</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ion acoustic wave dispersion with damping.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    k : array</span>
<span class="sd">        Wavenumber (m^-1)</span>
<span class="sd">    n : float</span>
<span class="sd">        Density (m^-3)</span>
<span class="sd">    T_e : float</span>
<span class="sd">        Electron temperature (eV)</span>
<span class="sd">    T_i : float</span>
<span class="sd">        Ion temperature (eV)</span>
<span class="sd">    m_i : float</span>
<span class="sd">        Ion mass (kg)</span>
<span class="sd">    Z : int</span>
<span class="sd">        Ion charge number</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    omega_real : array</span>
<span class="sd">        Real frequency</span>
<span class="sd">    gamma : array</span>
<span class="sd">        Damping rate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T_e_J</span> <span class="o">=</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span>
    <span class="n">T_i_J</span> <span class="o">=</span> <span class="n">T_i</span> <span class="o">*</span> <span class="n">e</span>

    <span class="c1"># Ion acoustic speed</span>
    <span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e_J</span> <span class="o">/</span> <span class="n">m_i</span><span class="p">)</span>

    <span class="c1"># Debye length</span>
    <span class="n">v_th_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e_J</span> <span class="o">/</span> <span class="n">m_e</span><span class="p">)</span>
    <span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">epsilon_0</span> <span class="o">*</span> <span class="n">m_e</span><span class="p">))</span>
    <span class="n">lambda_D</span> <span class="o">=</span> <span class="n">v_th_e</span> <span class="o">/</span> <span class="n">omega_pe</span>

    <span class="c1"># Real frequency</span>
    <span class="n">omega_real</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">c_s</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Damping rate (approximate, for T_e &gt;&gt; T_i)</span>
    <span class="n">v_th_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_i_J</span> <span class="o">/</span> <span class="n">m_i</span><span class="p">)</span>
    <span class="n">zeta_i</span> <span class="o">=</span> <span class="n">omega_real</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">v_th_i</span><span class="p">)</span>

    <span class="c1"># Landau damping (asymptotic form for large Œ∂)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega_real</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">))</span> <span class="o">*</span> \
            <span class="p">(</span><span class="n">T_i</span> <span class="o">/</span> <span class="n">T_e</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">lambda_D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">omega_real</span><span class="p">,</span> <span class="n">gamma</span>

<span class="c1"># Parameters</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># m^-3</span>
<span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># eV</span>
<span class="n">m_i</span> <span class="o">=</span> <span class="mf">1.673e-27</span>  <span class="c1"># kg (proton)</span>
<span class="n">T_i_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>  <span class="c1"># eV</span>

<span class="c1"># Compute Debye length</span>
<span class="n">v_th_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">m_e</span><span class="p">)</span>
<span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">epsilon_0</span> <span class="o">*</span> <span class="n">m_e</span><span class="p">))</span>
<span class="n">lambda_D</span> <span class="o">=</span> <span class="n">v_th_e</span> <span class="o">/</span> <span class="n">omega_pe</span>
<span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">m_i</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ion acoustic speed: c_s = </span><span class="si">{</span><span class="n">c_s</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="o">/</span> <span class="n">lambda_D</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">T_i_array</span><span class="p">):</span>
    <span class="n">omega_real</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">ion_acoustic_dispersion</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">T_i</span><span class="p">,</span> <span class="n">m_i</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">omega_real</span> <span class="o">*</span> <span class="n">lambda_D</span> <span class="o">/</span> <span class="n">c_s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
             <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$T_i = </span><span class="si">{</span><span class="n">T_i</span><span class="si">}</span><span class="s1">$ eV&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">/</span> <span class="n">omega_real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$T_i = </span><span class="si">{</span><span class="n">T_i</span><span class="si">}</span><span class="s1">$ eV&#39;</span><span class="p">)</span>

<span class="c1"># Add linear dispersion line</span>
<span class="n">k_linear</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">lambda_D</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_linear</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="n">k_linear</span> <span class="o">*</span> <span class="n">lambda_D</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega = kc_s$&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$k</span><span class="se">\\</span><span class="s1">lambda_D$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega</span><span class="se">\\</span><span class="s1">lambda_D / c_s$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ion Acoustic Dispersion&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$k</span><span class="se">\\</span><span class="s1">lambda_D$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$|</span><span class="se">\\</span><span class="s1">gamma| / </span><span class="se">\\</span><span class="s1">omega$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Landau Damping Rate&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ion_acoustic_dispersion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="63-upper-and-lower-hybrid-frequencies">6.3 Upper and Lower Hybrid Frequencies<a class="header-link" href="#63-upper-and-lower-hybrid-frequencies" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hybrid_frequencies</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute upper and lower hybrid frequencies.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    n : array</span>
<span class="sd">        Density (m^-3)</span>
<span class="sd">    B : array</span>
<span class="sd">        Magnetic field (T)</span>
<span class="sd">    Z : int</span>
<span class="sd">        Ion charge</span>
<span class="sd">    A : float</span>
<span class="sd">        Ion mass number</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    dict with frequencies</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m_i</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="mf">1.673e-27</span>

    <span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">epsilon_0</span> <span class="o">*</span> <span class="n">m_e</span><span class="p">))</span>
    <span class="n">omega_pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">Z</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">epsilon_0</span> <span class="o">*</span> <span class="n">m_i</span><span class="p">))</span>
    <span class="n">omega_ce</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">m_e</span>
    <span class="n">omega_ci</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">m_i</span>

    <span class="n">omega_UH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">omega_pe</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">omega_ce</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Lower hybrid</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">omega_ci</span> <span class="o">*</span> <span class="n">omega_ce</span><span class="p">)</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">omega_pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">omega_ci</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">omega_LH</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;omega_pe&#39;</span><span class="p">:</span> <span class="n">omega_pe</span><span class="p">,</span>
        <span class="s1">&#39;omega_pi&#39;</span><span class="p">:</span> <span class="n">omega_pi</span><span class="p">,</span>
        <span class="s1">&#39;omega_ce&#39;</span><span class="p">:</span> <span class="n">omega_ce</span><span class="p">,</span>
        <span class="s1">&#39;omega_ci&#39;</span><span class="p">:</span> <span class="n">omega_ci</span><span class="p">,</span>
        <span class="s1">&#39;omega_UH&#39;</span><span class="p">:</span> <span class="n">omega_UH</span><span class="p">,</span>
        <span class="s1">&#39;omega_LH&#39;</span><span class="p">:</span> <span class="n">omega_LH</span>
    <span class="p">}</span>

<span class="c1"># Parameter ranges</span>
<span class="n">B_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># T</span>
<span class="n">n_ref</span> <span class="o">=</span> <span class="mf">1e20</span>  <span class="c1"># m^-3</span>

<span class="n">freq</span> <span class="o">=</span> <span class="n">hybrid_frequencies</span><span class="p">(</span><span class="n">n_ref</span><span class="p">,</span> <span class="n">B_array</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Deuterium</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Upper hybrid</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_array</span><span class="p">,</span> <span class="n">freq</span><span class="p">[</span><span class="s1">&#39;omega_pe&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f_</span><span class="si">{pe}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_array</span><span class="p">,</span> <span class="n">freq</span><span class="p">[</span><span class="s1">&#39;omega_ce&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f_</span><span class="si">{ce}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_array</span><span class="p">,</span> <span class="n">freq</span><span class="p">[</span><span class="s1">&#39;omega_UH&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f_</span><span class="si">{UH}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Magnetic Field (T)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (GHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Upper Hybrid Frequency ($n = </span><span class="si">{</span><span class="n">n_ref</span><span class="si">:</span><span class="s1">.0e</span><span class="si">}</span><span class="s1">$ m$^</span><span class="se">{{</span><span class="s1">-3</span><span class="se">}}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Lower hybrid</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_array</span><span class="p">,</span> <span class="n">freq</span><span class="p">[</span><span class="s1">&#39;omega_ci&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f_</span><span class="si">{ci}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_array</span><span class="p">,</span> <span class="n">freq</span><span class="p">[</span><span class="s1">&#39;omega_LH&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f_</span><span class="si">{LH}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Magnetic Field (T)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (MHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lower Hybrid Frequency ($n = </span><span class="si">{</span><span class="n">n_ref</span><span class="si">:</span><span class="s1">.0e</span><span class="si">}</span><span class="s1">$ m$^</span><span class="se">{{</span><span class="s1">-3</span><span class="se">}}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hybrid_frequencies.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print typical ITER values</span>
<span class="n">B_ITER</span> <span class="o">=</span> <span class="mf">5.3</span>  <span class="c1"># T</span>
<span class="n">n_ITER</span> <span class="o">=</span> <span class="mf">1e20</span>  <span class="c1"># m^-3</span>
<span class="n">freq_ITER</span> <span class="o">=</span> <span class="n">hybrid_frequencies</span><span class="p">(</span><span class="n">n_ITER</span><span class="p">,</span> <span class="n">B_ITER</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ITER-like parameters (B = </span><span class="si">{</span><span class="n">B_ITER</span><span class="si">}</span><span class="s2"> T, n = </span><span class="si">{</span><span class="n">n_ITER</span><span class="si">:</span><span class="s2">.0e</span><span class="si">}</span><span class="s2"> m^-3):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  f_pe = </span><span class="si">{</span><span class="n">freq_ITER</span><span class="p">[</span><span class="s1">&#39;omega_pe&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  f_ce = </span><span class="si">{</span><span class="n">freq_ITER</span><span class="p">[</span><span class="s1">&#39;omega_ce&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  f_UH = </span><span class="si">{</span><span class="n">freq_ITER</span><span class="p">[</span><span class="s1">&#39;omega_UH&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  f_ci = </span><span class="si">{</span><span class="n">freq_ITER</span><span class="p">[</span><span class="s1">&#39;omega_ci&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MHz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  f_LH = </span><span class="si">{</span><span class="n">freq_ITER</span><span class="p">[</span><span class="s1">&#39;omega_LH&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MHz&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="64-bernstein-mode-dispersion">6.4 Bernstein Mode Dispersion<a class="header-link" href="#64-bernstein-mode-dispersion" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">iv</span>  <span class="c1"># Modified Bessel function</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bernstein_mode_approximate</span><span class="p">(</span><span class="n">n_harmonic</span><span class="p">,</span> <span class="n">k_perp</span><span class="p">,</span> <span class="n">rho_L</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Approximate Bernstein mode dispersion near n-th harmonic.</span>

<span class="sd">    œâ ‚âà nœâ_c(1 + k¬≤v_th¬≤/(2œâ_c¬≤))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lambda_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">k_perp</span> <span class="o">*</span> <span class="n">rho_L</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">n_harmonic</span> <span class="o">*</span> <span class="n">omega_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">lambda_val</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">omega</span>

<span class="c1"># Parameters</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># T</span>
<span class="n">T_e</span> <span class="o">=</span> <span class="mf">5e3</span>  <span class="c1"># eV (5 keV)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">5e19</span>  <span class="c1"># m^-3</span>

<span class="n">omega_ce</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">m_e</span>
<span class="n">v_th_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">m_e</span><span class="p">)</span>
<span class="n">rho_L</span> <span class="o">=</span> <span class="n">v_th_e</span> <span class="o">/</span> <span class="n">omega_ce</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Electron cyclotron frequency: f_ce = </span><span class="si">{</span><span class="n">omega_ce</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Larmor radius: œÅ_L = </span><span class="si">{</span><span class="n">rho_L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> mm&quot;</span><span class="p">)</span>

<span class="c1"># Wavenumber</span>
<span class="n">k_perp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span> <span class="o">/</span> <span class="n">rho_L</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">harmonics</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">harmonics</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n_harm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">harmonics</span><span class="p">):</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">bernstein_mode_approximate</span><span class="p">(</span><span class="n">n_harm</span><span class="p">,</span> <span class="n">k_perp</span><span class="p">,</span> <span class="n">rho_L</span><span class="p">,</span> <span class="n">omega_ce</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_perp</span> <span class="o">*</span> <span class="n">rho_L</span><span class="p">,</span> <span class="n">omega</span> <span class="o">/</span> <span class="n">omega_ce</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="n">n_harm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Mark the harmonic</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">n_harm</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$k_</span><span class="se">\\</span><span class="s1">perp </span><span class="se">\\</span><span class="s1">rho_L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">omega / </span><span class="se">\\</span><span class="s1">omega_</span><span class="si">{ce}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Electron Bernstein Mode Dispersion&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bernstein_modes.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="summary">Summary<a class="header-link" href="#summary" title="Permanent link">&para;</a></h2>
<p>Electrostatic waves are fundamental modes in plasmas, characterized by:</p>
<p><strong>General framework</strong>:
- Dispersion relation: $\epsilon(\mathbf{k}, \omega) = 0$
- Dielectric function from susceptibilities: $\epsilon = 1 + \sum_s \chi_s$
- Cold plasma: algebraic dispersion
- Warm plasma: kinetic effects via plasma dispersion function $Z(\zeta)$</p>
<p><strong>Langmuir waves</strong>:
- Cold plasma: $\omega = \omega_{pe}$ (no propagation)
- Warm plasma (Bohm-Gross): $\omega^2 = \omega_{pe}^2 + 3k^2v_{th}^2$
- Group velocity: $v_g = 3kv_{th}^2/\omega$
- Landau damping when $\omega/k \sim v_{th}$</p>
<p><strong>Ion acoustic waves</strong>:
- Dispersion: $\omega = kc_s$ where $c_s = \sqrt{k_B T_e/m_i}$
- Electron pressure restoring force, ion inertia
- Weak damping requires $T_e \gg T_i$
- Important for turbulence and transport</p>
<p><strong>Magnetized plasma resonances</strong>:
- Upper hybrid: $\omega_{UH}^2 = \omega_{pe}^2 + \omega_{ce}^2$
- Lower hybrid: $\omega_{LH} \approx \sqrt{\omega_{ci}\omega_{ce}}$
- Used for plasma heating and current drive</p>
<p><strong>Bernstein modes</strong>:
- Electrostatic modes near cyclotron harmonics: $\omega \approx n\omega_c$
- Exist where EM waves are cutoff
- Mode conversion allows heating in overdense plasmas</p>
<p>Applications include:
- Plasma diagnostics (Thomson scattering, reflectometry)
- Heating and current drive (ECRH, LHCD)
- Understanding instabilities and turbulence
- Astrophysical phenomena (solar radio bursts, pulsar emissions)</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-langmuir-wave-properties">Problem 1: Langmuir Wave Properties<a class="header-link" href="#problem-1-langmuir-wave-properties" title="Permanent link">&para;</a></h3>
<p>A plasma has $n = 5 \times 10^{18}$ m$^{-3}$ and $T_e = 5$ eV.</p>
<p>(a) Calculate the plasma frequency $f_{pe}$ and Debye length $\lambda_D$.</p>
<p>(b) For a Langmuir wave with $k = 0.1/\lambda_D$, calculate the frequency using the Bohm-Gross relation.</p>
<p>(c) Compute the phase velocity $v_\phi$ and group velocity $v_g$. How do they compare to $v_{th,e}$?</p>
<p>(d) At what wavenumber does the thermal correction to $\omega$ become 10% of $\omega_{pe}$?</p>
<h3 id="problem-2-ion-acoustic-wave-damping">Problem 2: Ion Acoustic Wave Damping<a class="header-link" href="#problem-2-ion-acoustic-wave-damping" title="Permanent link">&para;</a></h3>
<p>An argon plasma ($A = 40$) has $n = 10^{19}$ m$^{-3}$, $T_e = 20$ eV, $T_i = 2$ eV.</p>
<p>(a) Calculate the ion acoustic speed $c_s$.</p>
<p>(b) For $k\lambda_D = 0.3$, find the real frequency $\omega$ and the Landau damping rate $\gamma$.</p>
<p>(c) Calculate the damping length $L_d = v_g/|\gamma|$ where $v_g = d\omega/dk$.</p>
<p>(d) If the ion temperature increases to $T_i = 10$ eV, how does the damping change? Is the wave still observable?</p>
<h3 id="problem-3-hybrid-resonances">Problem 3: Hybrid Resonances<a class="header-link" href="#problem-3-hybrid-resonances" title="Permanent link">&para;</a></h3>
<p>A tokamak has $B = 3$ T and a density that varies from $n = 10^{20}$ m$^{-3}$ (core) to $n = 10^{18}$ m$^{-3}$ (edge).</p>
<p>(a) Calculate $f_{UH}$ at the core and edge.</p>
<p>(b) A heating system operates at 110 GHz. Where is the upper hybrid resonance layer located?</p>
<p>(c) Calculate $f_{LH}$ at the core and edge (assume deuterium).</p>
<p>(d) If a lower hybrid system operates at 5 GHz, sketch where the resonance layer is located as a function of radius.</p>
<h3 id="problem-4-bernstein-wave-heating">Problem 4: Bernstein Wave Heating<a class="header-link" href="#problem-4-bernstein-wave-heating" title="Permanent link">&para;</a></h3>
<p>Consider a dense plasma where $\omega_{pe} > \omega_{ce}$, making the plasma overdense for electron cyclotron waves.</p>
<p>(a) For $B = 1.5$ T, $T_e = 3$ keV, find the maximum density for which $\omega_{pe} < \omega_{ce}$.</p>
<p>(b) If $n = 5 \times 10^{20}$ m$^{-3}$ (overdense), calculate $\omega_{UH}/\omega_{ce}$.</p>
<p>(c) An O-mode wave at $\omega = \omega_{ce}$ cannot penetrate. Explain how mode conversion to a Bernstein wave at the upper hybrid layer can allow heating.</p>
<p>(d) Estimate the perpendicular wavenumber $k_\perp \rho_L$ of the Bernstein wave needed for efficient electron heating at the first harmonic.</p>
<h3 id="problem-5-dispersion-relation-analysis">Problem 5: Dispersion Relation Analysis<a class="header-link" href="#problem-5-dispersion-relation-analysis" title="Permanent link">&para;</a></h3>
<p>The electrostatic dispersion relation for an electron-ion plasma is:</p>
<p>$$1 - \frac{\omega_{pe}^2}{k^2 v_{th,e}^2}[1 + \zeta_e Z(\zeta_e)] - \frac{\omega_{pi}^2}{k^2 v_{th,i}^2}[1 + \zeta_i Z(\zeta_i)] = 0$$</p>
<p>where $\zeta_s = \omega/(k v_{th,s})$.</p>
<p>(a) In the limit $\omega \gg k v_{th,e}$, expand to show this gives the Bohm-Gross relation.</p>
<p>(b) In the limit $\omega \ll k v_{th,e}$ but $\omega \sim k v_{th,i}$, show this gives ion acoustic waves with electron Boltzmann response.</p>
<p>(c) For $m_i/m_e = 1836$, $T_e = T_i = 1$ keV, numerically solve for $\omega(k)$ over the range $0.01 < k\lambda_D < 10$. Identify the Langmuir and ion acoustic branches.</p>
<p>(d) At what value of $k\lambda_D$ do the two branches have comparable frequencies? What physics occurs in this regime?</p>
<hr />
<p><strong>Previous</strong>: <a href="./09_Collisional_Kinetics.md">9. Collisional Kinetics</a>
<strong>Next</strong>: <a href="./11_Electromagnetic_Waves.md">11. Electromagnetic Waves</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Plasma_Physics/09_Collisional_Kinetics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">9. Collisional Kinetics</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Plasma_Physics/11_Electromagnetic_Waves.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">11. Electromagnetic Waves in Plasma</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}