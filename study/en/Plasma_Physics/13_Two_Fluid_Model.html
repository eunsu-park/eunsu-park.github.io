{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13. Two-Fluid Model - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Plasma_Physics/">Plasma Physics</a>
    <span class="separator">/</span>
    <span class="current">13. Two-Fluid Model</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>13. Two-Fluid Model</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Plasma_Physics/12_Wave_Heating_and_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">12. Wave Heating and Instabilities</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Plasma_Physics/14_From_Kinetic_to_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">14. From Kinetic to MHD</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#1-from-vlasov-to-fluid-equations">1. From Vlasov to Fluid Equations</a><ul>
<li><a href="#11-the-moment-hierarchy">1.1 The Moment Hierarchy</a></li>
<li><a href="#12-zeroth-moment-continuity-equation">1.2 Zeroth Moment: Continuity Equation</a></li>
<li><a href="#13-first-moment-momentum-equation">1.3 First Moment: Momentum Equation</a></li>
<li><a href="#14-second-moment-energy-equation">1.4 Second Moment: Energy Equation</a></li>
<li><a href="#15-the-closure-problem">1.5 The Closure Problem</a></li>
<li><a href="#16-two-fluid-equations-summary">1.6 Two-Fluid Equations Summary</a></li>
</ul>
</li>
<li><a href="#2-generalized-ohms-law">2. Generalized Ohm's Law</a><ul>
<li><a href="#21-derivation-from-electron-momentum-equation">2.1 Derivation from Electron Momentum Equation</a></li>
<li><a href="#22-physical-interpretation-of-each-term">2.2 Physical Interpretation of Each Term</a></li>
<li><a href="#23-scale-analysis-when-does-each-term-matter">2.3 Scale Analysis: When Does Each Term Matter?</a></li>
<li><a href="#24-limiting-cases">2.4 Limiting Cases</a></li>
</ul>
</li>
<li><a href="#3-the-hall-effect">3. The Hall Effect</a><ul>
<li><a href="#31-physics-of-the-hall-term">3.1 Physics of the Hall Term</a></li>
<li><a href="#32-hall-parameter">3.2 Hall Parameter</a></li>
<li><a href="#33-decoupling-of-ions-from-magnetic-field">3.3 Decoupling of Ions from Magnetic Field</a></li>
<li><a href="#34-hall-mhd-waves">3.4 Hall MHD Waves</a></li>
</ul>
</li>
<li><a href="#4-diamagnetic-drift">4. Diamagnetic Drift</a><ul>
<li><a href="#41-particle-vs-fluid-drifts">4.1 Particle vs. Fluid Drifts</a></li>
<li><a href="#42-derivation-of-diamagnetic-drift">4.2 Derivation of Diamagnetic Drift</a></li>
<li><a href="#43-diamagnetic-current">4.3 Diamagnetic Current</a></li>
<li><a href="#44-physical-interpretation-magnetization-current">4.4 Physical Interpretation: Magnetization Current</a></li>
<li><a href="#45-example-cylindrical-plasma-column">4.5 Example: Cylindrical Plasma Column</a></li>
</ul>
</li>
<li><a href="#5-two-fluid-waves">5. Two-Fluid Waves</a><ul>
<li><a href="#51-kinetic-alfven-wave">5.1 Kinetic Alfv√©n Wave</a></li>
<li><a href="#52-whistler-wave-from-two-fluid-perspective">5.2 Whistler Wave from Two-Fluid Perspective</a></li>
<li><a href="#53-ion-cyclotron-wave">5.3 Ion-Cyclotron Wave</a></li>
<li><a href="#54-two-stream-instability">5.4 Two-Stream Instability</a></li>
</ul>
</li>
<li><a href="#6-python-code-examples">6. Python Code Examples</a><ul>
<li><a href="#61-two-fluid-vs-single-fluid-dispersion-relations">6.1 Two-Fluid vs. Single-Fluid Dispersion Relations</a></li>
<li><a href="#62-generalized-ohms-law-relative-term-magnitudes">6.2 Generalized Ohm's Law: Relative Term Magnitudes</a></li>
<li><a href="#63-diamagnetic-drift-visualization">6.3 Diamagnetic Drift Visualization</a></li>
<li><a href="#64-two-fluid-closure-comparison">6.4 Two-Fluid Closure Comparison</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-moment-calculation">Problem 1: Moment Calculation</a></li>
<li><a href="#problem-2-hall-mhd-dispersion">Problem 2: Hall MHD Dispersion</a></li>
<li><a href="#problem-3-diamagnetic-current-in-a-tokamak">Problem 3: Diamagnetic Current in a Tokamak</a></li>
<li><a href="#problem-4-generalized-ohms-law-in-a-current-sheet">Problem 4: Generalized Ohm's Law in a Current Sheet</a></li>
<li><a href="#problem-5-two-fluid-instability">Problem 5: Two-Fluid Instability</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="13-two-fluid-model">13. Two-Fluid Model<a class="header-link" href="#13-two-fluid-model" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="header-link" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Derive fluid equations from kinetic theory by taking velocity-space moments of the Vlasov equation</li>
<li>Understand the closure problem and various closure approximations (isothermal, adiabatic, CGL)</li>
<li>Derive the generalized Ohm's law from the electron momentum equation and analyze each term's physical significance</li>
<li>Explain the Hall effect and its role in decoupling ions from the magnetic field at small scales</li>
<li>Distinguish between particle drifts and fluid drifts, particularly the diamagnetic drift</li>
<li>Apply two-fluid theory to understand wave phenomena beyond single-fluid MHD</li>
</ul>
<h2 id="1-from-vlasov-to-fluid-equations">1. From Vlasov to Fluid Equations<a class="header-link" href="#1-from-vlasov-to-fluid-equations" title="Permanent link">&para;</a></h2>
<h3 id="11-the-moment-hierarchy">1.1 The Moment Hierarchy<a class="header-link" href="#11-the-moment-hierarchy" title="Permanent link">&para;</a></h3>
<p>The Vlasov equation describes the evolution of the distribution function $f_s(\mathbf{r}, \mathbf{v}, t)$ for species $s$:</p>
<p>$$\frac{\partial f_s}{\partial t} + \mathbf{v} \cdot \nabla f_s + \frac{q_s}{m_s}(\mathbf{E} + \mathbf{v} \times \mathbf{B}) \cdot \frac{\partial f_s}{\partial \mathbf{v}} = \left(\frac{\partial f_s}{\partial t}\right)_{\text{coll}}$$</p>
<p>While the Vlasov equation contains complete information about the plasma, it is a 6D partial differential equation that is computationally expensive to solve. For many applications, we don't need the full distribution function‚Äîwe only care about macroscopic quantities like density, flow velocity, and pressure.</p>
<p>The <strong>method of moments</strong> reduces the dimensionality by integrating the Vlasov equation over velocity space with different weights. The $n$-th moment is obtained by multiplying the Vlasov equation by $v^n$ and integrating:</p>
<p>$$\int (\text{Vlasov equation}) \times (\text{weight function}) \, d^3v$$</p>
<p>This generates a hierarchy of fluid equations, where each equation involves the next higher-order moment.</p>
<h3 id="12-zeroth-moment-continuity-equation">1.2 Zeroth Moment: Continuity Equation<a class="header-link" href="#12-zeroth-moment-continuity-equation" title="Permanent link">&para;</a></h3>
<p>The zeroth moment (weight = 1) gives the <strong>continuity equation</strong>:</p>
<p>$$\int \frac{\partial f_s}{\partial t} d^3v + \int \mathbf{v} \cdot \nabla f_s d^3v + \int \frac{q_s}{m_s}(\mathbf{E} + \mathbf{v} \times \mathbf{B}) \cdot \frac{\partial f_s}{\partial \mathbf{v}} d^3v = 0$$</p>
<p>The number density is:
$$n_s(\mathbf{r}, t) = \int f_s(\mathbf{r}, \mathbf{v}, t) d^3v$$</p>
<p>For the first term:
$$\int \frac{\partial f_s}{\partial t} d^3v = \frac{\partial}{\partial t} \int f_s d^3v = \frac{\partial n_s}{\partial t}$$</p>
<p>For the second term, using the divergence theorem in velocity space:
$$\int \mathbf{v} \cdot \nabla f_s d^3v = \nabla \cdot \int \mathbf{v} f_s d^3v = \nabla \cdot (n_s \mathbf{u}_s)$$</p>
<p>where the mean flow velocity is:
$$\mathbf{u}_s = \frac{1}{n_s} \int \mathbf{v} f_s d^3v$$</p>
<p>For the third term, the Lorentz force term vanishes because:
$$\int \frac{\partial f_s}{\partial \mathbf{v}} d^3v = [f_s]_{v=-\infty}^{v=+\infty} = 0$$</p>
<p>(assuming $f_s \to 0$ as $|\mathbf{v}| \to \infty$).</p>
<p>The result is the <strong>continuity equation</strong>:</p>
<p>$$\boxed{\frac{\partial n_s}{\partial t} + \nabla \cdot (n_s \mathbf{u}_s) = 0}$$</p>
<p>This is conservation of particles. In the presence of ionization/recombination, a source term would appear on the right-hand side.</p>
<h3 id="13-first-moment-momentum-equation">1.3 First Moment: Momentum Equation<a class="header-link" href="#13-first-moment-momentum-equation" title="Permanent link">&para;</a></h3>
<p>The first moment (weight = $m_s \mathbf{v}$) gives the <strong>momentum equation</strong>. We multiply the Vlasov equation by $m_s \mathbf{v}$ and integrate:</p>
<p>Define the momentum density:
$$\mathbf{p}_s = m_s n_s \mathbf{u}_s = m_s \int \mathbf{v} f_s d^3v$$</p>
<p>The peculiar velocity (thermal velocity) is:
$$\mathbf{w} = \mathbf{v} - \mathbf{u}_s$$</p>
<p>The pressure tensor is:
$$\overleftrightarrow{P}_s = m_s \int \mathbf{w} \mathbf{w} f_s d^3v$$</p>
<p>After considerable algebra (using integration by parts and the divergence theorem), the momentum equation becomes:</p>
<p>$$\boxed{m_s n_s \frac{d \mathbf{u}_s}{dt} = q_s n_s (\mathbf{E} + \mathbf{u}_s \times \mathbf{B}) - \nabla \cdot \overleftrightarrow{P}_s + \mathbf{R}_s}$$</p>
<p>where $d/dt = \partial/\partial t + \mathbf{u}_s \cdot \nabla$ is the convective derivative, and $\mathbf{R}_s$ is the momentum transfer from collisions with other species.</p>
<p>This is Newton's second law for a fluid element:
- <strong>LHS</strong>: mass √ó acceleration
- <strong>RHS</strong>: Lorentz force + pressure gradient force + collision force</p>
<p><strong>Key point</strong>: This equation introduces a new quantity, the pressure tensor $\overleftrightarrow{P}_s$, which is a second-order moment of the distribution function.</p>
<h3 id="14-second-moment-energy-equation">1.4 Second Moment: Energy Equation<a class="header-link" href="#14-second-moment-energy-equation" title="Permanent link">&para;</a></h3>
<p>The second moment (weight = $\frac{1}{2} m_s v^2$) gives the <strong>energy equation</strong>:</p>
<p>Define the thermal energy density:
$$\mathcal{E}_s = \frac{1}{2} m_s \int w^2 f_s d^3v$$</p>
<p>For an isotropic pressure ($\overleftrightarrow{P}_s = p_s \overleftrightarrow{I}$), we have:
$$p_s = \frac{1}{3} m_s \int w^2 f_s d^3v = \frac{2}{3} \mathcal{E}_s$$</p>
<p>The energy equation becomes:</p>
<p>$$\frac{\partial \mathcal{E}_s}{\partial t} + \nabla \cdot (\mathcal{E}_s \mathbf{u}_s) = -p_s \nabla \cdot \mathbf{u}_s - \nabla \cdot \mathbf{q}_s + Q_s$$</p>
<p>where:
- $\mathbf{q}_s = \frac{1}{2} m_s \int w^2 \mathbf{w} f_s d^3v$ is the heat flux vector (third-order moment)
- $Q_s$ is the collisional energy transfer</p>
<p>Using $p_s = \frac{2}{3} \mathcal{E}_s$, this can be rewritten as:</p>
<p>$$\frac{3}{2} \frac{d p_s}{dt} + \frac{5}{2} p_s \nabla \cdot \mathbf{u}_s = -\nabla \cdot \mathbf{q}_s + Q_s$$</p>
<p><strong>The closure problem</strong>: The energy equation introduces the heat flux $\mathbf{q}_s$, a third-order moment. If we took the third moment, we'd get an equation involving a fourth-order moment, and so on. This infinite hierarchy must be <strong>closed</strong> by making an assumption about the highest-order moment.</p>
<h3 id="15-the-closure-problem">1.5 The Closure Problem<a class="header-link" href="#15-the-closure-problem" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Moment</span><span class="w"> </span><span class="nv">hierarchy</span>:

<span class="mi">0</span><span class="nv">th</span><span class="w"> </span><span class="nv">moment</span>:<span class="w">  </span>‚àÇ<span class="nv">n</span><span class="o">/</span>‚àÇ<span class="nv">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>‚àá¬∑<span class="ss">(</span><span class="nv">nu</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">              </span><span class="ss">(</span><span class="nv">introduces</span><span class="w"> </span><span class="nv">u</span><span class="ss">)</span>
<span class="mi">1</span><span class="nv">st</span><span class="w"> </span><span class="nv">moment</span>:<span class="w">  </span><span class="nv">mn</span><span class="ss">(</span><span class="nv">du</span><span class="o">/</span><span class="nv">dt</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">qn</span><span class="ss">(</span><span class="nv">E</span><span class="o">+</span><span class="nv">u</span>√ó<span class="nv">B</span><span class="ss">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>‚àá¬∑<span class="nv">P</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">R</span><span class="w">  </span><span class="ss">(</span><span class="nv">introduces</span><span class="w"> </span><span class="nv">P</span><span class="ss">)</span>
<span class="mi">2</span><span class="nv">nd</span><span class="w"> </span><span class="nv">moment</span>:<span class="w">  </span><span class="nv">dp</span><span class="o">/</span><span class="nv">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nv">p</span>‚àá¬∑<span class="nv">u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>‚àá¬∑<span class="nv">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">Q</span><span class="w">          </span><span class="ss">(</span><span class="nv">introduces</span><span class="w"> </span><span class="nv">q</span><span class="ss">)</span>
<span class="mi">3</span><span class="nv">rd</span><span class="w"> </span><span class="nv">moment</span>:<span class="w">  </span>...<span class="w">                              </span><span class="ss">(</span><span class="nv">introduces</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="nv">moment</span><span class="ss">)</span>
...

<span class="nv">Each</span><span class="w"> </span><span class="nv">equation</span><span class="w"> </span><span class="nv">introduces</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">unknown</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="nv">higher</span><span class="w"> </span><span class="nv">moment</span>.
<span class="nv">This</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">CLOSURE</span><span class="w"> </span><span class="nv">PROBLEM</span>.
</code></pre></div>

<p>We need to <strong>truncate</strong> the hierarchy by assuming a relationship between the highest moment and lower moments. Common closures:</p>
<p><strong>1. Isothermal closure</strong>: Assume constant temperature
$$p_s = n_s k_B T_s, \quad T_s = \text{const}$$</p>
<p>This is valid when heat conduction is very efficient, so temperature equilibrates instantly.</p>
<p><strong>2. Adiabatic closure</strong>: Assume no heat flux ($\mathbf{q}_s = 0$) and adiabatic evolution
$$\frac{d}{dt}\left( \frac{p_s}{n_s^\gamma} \right) = 0$$</p>
<p>where $\gamma$ is the adiabatic index ($\gamma = 5/3$ for a monatomic gas). This is valid for rapid processes where heat conduction is negligible.</p>
<p><strong>3. CGL closure</strong> (Chew-Goldberger-Low): For collisionless magnetized plasmas, pressure is anisotropic:
$$\overleftrightarrow{P}_s = p_{\perp s} \overleftrightarrow{I} + (p_{\parallel s} - p_{\perp s}) \hat{\mathbf{b}} \hat{\mathbf{b}}$$</p>
<p>with double adiabatic equations:
$$\frac{d}{dt}\left( \frac{p_{\perp s}}{n_s B} \right) = 0, \quad \frac{d}{dt}\left( \frac{p_{\parallel s} B^2}{n_s^3} \right) = 0$$</p>
<p>We'll discuss CGL in Lesson 14.</p>
<h3 id="16-two-fluid-equations-summary">1.6 Two-Fluid Equations Summary<a class="header-link" href="#16-two-fluid-equations-summary" title="Permanent link">&para;</a></h3>
<p>For each species (electrons $e$, ions $i$), we have:</p>
<p><strong>Continuity</strong>:
$$\frac{\partial n_s}{\partial t} + \nabla \cdot (n_s \mathbf{u}_s) = 0$$</p>
<p><strong>Momentum</strong>:
$$m_s n_s \frac{d \mathbf{u}_s}{dt} = q_s n_s (\mathbf{E} + \mathbf{u}_s \times \mathbf{B}) - \nabla p_s + \mathbf{R}_s$$</p>
<p>(assuming isotropic pressure)</p>
<p><strong>Energy</strong> (with adiabatic closure):
$$\frac{d}{dt}\left( \frac{p_s}{n_s^\gamma} \right) = 0$$</p>
<p>These are coupled to <strong>Maxwell's equations</strong>:
$$\nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}, \quad \nabla \times \mathbf{B} = \mu_0 \mathbf{J} + \mu_0 \epsilon_0 \frac{\partial \mathbf{E}}{\partial t}$$
$$\nabla \cdot \mathbf{E} = \frac{\rho}{\epsilon_0}, \quad \nabla \cdot \mathbf{B} = 0$$</p>
<p>where the charge and current densities are:
$$\rho = \sum_s q_s n_s, \quad \mathbf{J} = \sum_s q_s n_s \mathbf{u}_s$$</p>
<p>The collision terms $\mathbf{R}_s$ couple the species. For electron-ion collisions:
$$\mathbf{R}_e = -\mathbf{R}_i = -\frac{m_e n_e}{\tau_{ei}} (\mathbf{u}_e - \mathbf{u}_i)$$</p>
<p>where $\tau_{ei}$ is the electron-ion collision time.</p>
<h2 id="2-generalized-ohms-law">2. Generalized Ohm's Law<a class="header-link" href="#2-generalized-ohms-law" title="Permanent link">&para;</a></h2>
<h3 id="21-derivation-from-electron-momentum-equation">2.1 Derivation from Electron Momentum Equation<a class="header-link" href="#21-derivation-from-electron-momentum-equation" title="Permanent link">&para;</a></h3>
<p>One of the most important results from two-fluid theory is the <strong>generalized Ohm's law</strong>, which relates the electric field to the current. In ideal MHD, we have the simple form:
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = 0$$</p>
<p>But this is a severe approximation. Let's derive the full form from the electron momentum equation.</p>
<p>Starting with:
$$m_e n_e \frac{d \mathbf{u}_e}{dt} = -e n_e (\mathbf{E} + \mathbf{u}_e \times \mathbf{B}) - \nabla p_e + \mathbf{R}_e$$</p>
<p>The collision term can be written as:
$$\mathbf{R}_e = -\frac{m_e n_e}{\tau_{ei}} (\mathbf{u}_e - \mathbf{u}_i) \approx -\frac{m_e n_e \mathbf{u}_e}{\tau_{ei}}$$</p>
<p>(assuming $u_e \gg u_i$ for current-carrying electrons).</p>
<p>Rearranging:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = \frac{m_e}{e \tau_{ei}} \mathbf{u}_e - \frac{1}{e n_e} \nabla p_e + \frac{m_e}{e n_e} \frac{d \mathbf{u}_e}{dt}$$</p>
<p>Now, express everything in terms of the <strong>current density</strong> $\mathbf{J}$ and the <strong>center-of-mass velocity</strong> $\mathbf{v}$.</p>
<p>Define:
$$\mathbf{J} = -e n_e \mathbf{u}_e + e n_i \mathbf{u}_i \approx -e n_e (\mathbf{u}_e - \mathbf{u}_i)$$
$$\mathbf{v} = \frac{m_i n_i \mathbf{u}_i + m_e n_e \mathbf{u}_e}{m_i n_i + m_e n_e} \approx \mathbf{u}_i$$</p>
<p>(using $m_i \gg m_e$ and quasi-neutrality $n_e \approx n_i \equiv n$).</p>
<p>From the current definition:
$$\mathbf{u}_e = \mathbf{u}_i - \frac{\mathbf{J}}{e n} \approx \mathbf{v} - \frac{\mathbf{J}}{e n}$$</p>
<p>Substituting into the rearranged electron equation:</p>
<p>$$\mathbf{E} + \left( \mathbf{v} - \frac{\mathbf{J}}{en} \right) \times \mathbf{B} = \frac{m_e}{e^2 n \tau_{ei}} \mathbf{J} - \frac{1}{en} \nabla p_e + \frac{m_e}{e^2 n} \frac{d}{dt}\left( -\frac{\mathbf{J}}{e n} \right)$$</p>
<p>Simplifying the cross product:
$$\mathbf{u}_e \times \mathbf{B} = \mathbf{v} \times \mathbf{B} - \frac{\mathbf{J} \times \mathbf{B}}{en}$$</p>
<p>This gives the <strong>generalized Ohm's law</strong>:</p>
<p>$$\boxed{\mathbf{E} + \mathbf{v} \times \mathbf{B} = \eta \mathbf{J} + \frac{1}{en} \mathbf{J} \times \mathbf{B} - \frac{1}{en} \nabla p_e + \frac{m_e}{e^2 n^2} \frac{d \mathbf{J}}{dt}}$$</p>
<p>where the <strong>resistivity</strong> is:
$$\eta = \frac{m_e}{e^2 n \tau_{ei}}$$</p>
<h3 id="22-physical-interpretation-of-each-term">2.2 Physical Interpretation of Each Term<a class="header-link" href="#22-physical-interpretation-of-each-term" title="Permanent link">&para;</a></h3>
<p>Let's identify each term on the RHS:</p>
<ol>
<li><strong>Resistive term</strong>: $\eta \mathbf{J}$</li>
<li>Ohmic dissipation due to electron-ion collisions</li>
<li>Causes magnetic diffusion (resistive MHD)</li>
<li>
<p>$\eta \sim T_e^{-3/2}$ (decreases with temperature)</p>
</li>
<li>
<p><strong>Hall term</strong>: $\frac{1}{en} \mathbf{J} \times \mathbf{B}$</p>
</li>
<li>Decoupling of ions from magnetic field</li>
<li>Important at scales $\sim$ ion skin depth $d_i = c/\omega_{pi}$</li>
<li>
<p>Enables fast magnetic reconnection</p>
</li>
<li>
<p><strong>Electron pressure term</strong>: $-\frac{1}{en} \nabla p_e$</p>
</li>
<li>Pressure gradient drives current even without E field</li>
<li>
<p>Important in steep gradient regions (e.g., current sheets)</p>
</li>
<li>
<p><strong>Electron inertia term</strong>: $\frac{m_e}{e^2 n^2} \frac{d \mathbf{J}}{dt}$</p>
</li>
<li>Important at electron skin depth $d_e = c/\omega_{pe}$</li>
<li>Relevant for very fast phenomena (whistler waves, reconnection)</li>
</ol>
<h3 id="23-scale-analysis-when-does-each-term-matter">2.3 Scale Analysis: When Does Each Term Matter?<a class="header-link" href="#23-scale-analysis-when-does-each-term-matter" title="Permanent link">&para;</a></h3>
<p>Let's perform an <strong>order-of-magnitude analysis</strong> to determine when each term is important.</p>
<p>Define characteristic scales:
- Length: $L$
- Velocity: $V$
- Magnetic field: $B_0$
- Density: $n_0$
- Current: $J_0 \sim B_0/(\mu_0 L)$ (from Amp√®re's law)</p>
<p><strong>Ideal MHD term</strong> (LHS):
$$\mathbf{v} \times \mathbf{B} \sim V B_0$$</p>
<p><strong>Resistive term</strong>:
$$\eta \mathbf{J} \sim \eta \frac{B_0}{\mu_0 L}$$</p>
<p>Ratio:
$$\frac{\eta J}{\mathbf{v} \times \mathbf{B}} \sim \frac{\eta}{\mu_0 V L} = \frac{1}{R_m}$$</p>
<p>where $R_m = \mu_0 V L / \eta$ is the <strong>magnetic Reynolds number</strong>. Resistivity is important when $R_m \lesssim 1$.</p>
<p><strong>Hall term</strong>:
$$\frac{\mathbf{J} \times \mathbf{B}}{en} \sim \frac{B_0^2}{\mu_0 e n_0 L}$$</p>
<p>Ratio:
$$\frac{J \times B / en}{\mathbf{v} \times \mathbf{B}} \sim \frac{B_0}{\mu_0 e n_0 V L} = \frac{V_A}{V} \frac{d_i}{L}$$</p>
<p>where $d_i = c/\omega_{pi} = \sqrt{m_i / (\mu_0 e^2 n_0)}$ is the <strong>ion skin depth</strong> and $V_A = B_0/\sqrt{\mu_0 m_i n_0}$ is the Alfv√©n speed.</p>
<p>The Hall term is important when $L \lesssim d_i$ or when $V \lesssim V_A$ at ion scales.</p>
<p><strong>Electron pressure term</strong>:
$$\frac{\nabla p_e}{en} \sim \frac{k_B T_e}{eL}$$</p>
<p>Ratio:
$$\frac{\nabla p_e / en}{\mathbf{v} \times \mathbf{B}} \sim \frac{k_B T_e}{e V B_0 L} = \frac{v_{te}^2}{V^2} \frac{\rho_e}{L}$$</p>
<p>where $v_{te} = \sqrt{k_B T_e / m_e}$ is the electron thermal speed and $\rho_e = v_{te}/\omega_{ce}$ is the electron gyroradius.</p>
<p>This term is important in regions of steep pressure gradients.</p>
<p><strong>Electron inertia term</strong>:
$$\frac{m_e}{e^2 n^2} \frac{dJ}{dt} \sim \frac{m_e}{e^2 n_0^2} \frac{B_0}{\mu_0 L} \frac{V}{L} = \frac{m_e V B_0}{\mu_0 e^2 n_0 L^2}$$</p>
<p>Ratio:
$$\frac{m_e dJ/dt / (e^2 n^2)}{v \times B} \sim \frac{m_e}{\mu_0 e^2 n_0 L^2} = \frac{d_e^2}{L^2}$$</p>
<p>where $d_e = c/\omega_{pe}$ is the <strong>electron skin depth</strong>.</p>
<p>This term is important when $L \lesssim d_e$.</p>
<p><strong>Summary</strong>:</p>
<div class="highlight"><pre><span></span><code>Term                Scale               When important
----------------    -----------------   ------------------------
Resistive           1/R_m               R_m ~ 1 (low T, small L)
Hall                d_i/L               L ~ d_i (ion scales)
Electron pressure   Œ≤_e œÅ_e/L           Steep gradients
Electron inertia    (d_e/L)^2           L ~ d_e (electron scales)

Typical ordering: d_e &lt;&lt; œÅ_e &lt;&lt; d_i &lt;&lt; L (MHD)
</code></pre></div>

<h3 id="24-limiting-cases">2.4 Limiting Cases<a class="header-link" href="#24-limiting-cases" title="Permanent link">&para;</a></h3>
<p><strong>Ideal MHD</strong> ($R_m \to \infty$, $L \gg d_i$):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = 0$$</p>
<p>Magnetic field is frozen into the fluid.</p>
<p><strong>Resistive MHD</strong> (keep resistive term, drop others):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \eta \mathbf{J}$$</p>
<p>Allows magnetic reconnection, but slow (Sweet-Parker rate).</p>
<p><strong>Hall MHD</strong> (keep Hall term, drop resistive/inertia):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \frac{1}{en} \mathbf{J} \times \mathbf{B}$$</p>
<p>Enables fast reconnection (Petschek rate), whistler waves.</p>
<p><strong>Electron MHD</strong> (keep Hall + inertia, drop resistive):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \frac{1}{en} \mathbf{J} \times \mathbf{B} + \frac{m_e}{e^2 n^2} \frac{d \mathbf{J}}{dt}$$</p>
<p>Relevant at electron scales (e.g., reconnection diffusion region).</p>
<h2 id="3-the-hall-effect">3. The Hall Effect<a class="header-link" href="#3-the-hall-effect" title="Permanent link">&para;</a></h2>
<h3 id="31-physics-of-the-hall-term">3.1 Physics of the Hall Term<a class="header-link" href="#31-physics-of-the-hall-term" title="Permanent link">&para;</a></h3>
<p>The Hall term $\frac{1}{en} \mathbf{J} \times \mathbf{B}$ arises from the difference in electron and ion motions. When a current flows across a magnetic field, electrons and ions experience different Lorentz forces, creating a charge separation and thus an <strong>electric field perpendicular to both $\mathbf{J}$ and $\mathbf{B}$</strong>.</p>
<p>Consider a current $\mathbf{J} = J_x \hat{\mathbf{x}}$ in a magnetic field $\mathbf{B} = B_0 \hat{\mathbf{z}}$:</p>
<p>$$\mathbf{J} \times \mathbf{B} = J_x B_0 \hat{\mathbf{y}}$$</p>
<p>This creates an electric field:
$$E_y = \frac{J_x B_0}{en}$$</p>
<p>This is the <strong>Hall electric field</strong>.</p>
<h3 id="32-hall-parameter">3.2 Hall Parameter<a class="header-link" href="#32-hall-parameter" title="Permanent link">&para;</a></h3>
<p>The <strong>Hall parameter</strong> quantifies the importance of the magnetic field:</p>
<p>$$\Omega_s \tau_s = \omega_{cs} \tau_{cs}$$</p>
<p>where $\omega_{cs} = q_s B / m_s$ is the cyclotron frequency and $\tau_{cs}$ is the collision time.</p>
<ul>
<li>When $\Omega_s \tau_s \ll 1$: collisions dominate, particle orbits are interrupted before completing a gyration ‚Üí <strong>unmagnetized</strong></li>
<li>When $\Omega_s \tau_s \gg 1$: particles complete many gyrations between collisions ‚Üí <strong>magnetized</strong></li>
</ul>
<p>For electrons in typical plasmas, $\Omega_e \tau_e \gg 1$ (strongly magnetized).
For ions, $\Omega_i \tau_i$ can vary (weakly magnetized in collisional plasmas, strongly magnetized in hot fusion plasmas).</p>
<h3 id="33-decoupling-of-ions-from-magnetic-field">3.3 Decoupling of Ions from Magnetic Field<a class="header-link" href="#33-decoupling-of-ions-from-magnetic-field" title="Permanent link">&para;</a></h3>
<p>At scales larger than the ion skin depth $d_i$, both electrons and ions are frozen to the magnetic field (ideal MHD). But at scales $L \lesssim d_i$, the Hall term becomes important, and <strong>ions decouple from the magnetic field</strong>.</p>
<p>To see this, consider the ion and electron momentum equations:</p>
<p><strong>Ions</strong>:
$$m_i n \frac{d \mathbf{u}_i}{dt} = e n (\mathbf{E} + \mathbf{u}_i \times \mathbf{B}) - \nabla p_i$$</p>
<p><strong>Electrons</strong> (from generalized Ohm's law, keeping only Hall term):
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} \approx \frac{1}{en} \mathbf{J} \times \mathbf{B}$$</p>
<p>Using $\mathbf{J} = en(\mathbf{u}_i - \mathbf{u}_e)$:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = \frac{1}{en} en (\mathbf{u}_i - \mathbf{u}_e) \times \mathbf{B}$$</p>
<p>Rearranging:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = (\mathbf{u}_i - \mathbf{u}_e) \times \mathbf{B}$$
$$\mathbf{E} + \mathbf{u}_i \times \mathbf{B} = 0$$</p>
<p>So <strong>electrons</strong> satisfy the frozen-in condition:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = 0$$</p>
<p>But <strong>ions</strong> do not! They experience an electric field:
$$\mathbf{E} = -\mathbf{u}_i \times \mathbf{B} + (\mathbf{u}_i - \mathbf{u}_e) \times \mathbf{B} = \mathbf{u}_e \times \mathbf{B} \neq -\mathbf{u}_i \times \mathbf{B}$$</p>
<p>This means the magnetic field is <strong>frozen into the electron fluid</strong>, not the ion fluid, at scales $\sim d_i$.</p>
<h3 id="34-hall-mhd-waves">3.4 Hall MHD Waves<a class="header-link" href="#34-hall-mhd-waves" title="Permanent link">&para;</a></h3>
<p>Including the Hall term modifies MHD wave dispersion. The key change is the appearance of <strong>whistler waves</strong> at high frequencies.</p>
<p>The Hall MHD dispersion relation (in the low-frequency, small-amplitude limit) gives:</p>
<p><strong>Alfv√©n/whistler branch</strong>:
$$\omega = k_\parallel V_A \sqrt{1 + k^2 d_i^2}$$</p>
<ul>
<li>At $k d_i \ll 1$ (large scales): $\omega \approx k_\parallel V_A$ (Alfv√©n wave)</li>
<li>At $k d_i \gg 1$ (small scales): $\omega \approx k_\parallel V_A k d_i = k \sqrt{k_\parallel V_A d_i}$ (whistler)</li>
</ul>
<p>Whistler waves have:
- <strong>Right-hand circular polarization</strong> (in ion frame)
- <strong>Dispersive</strong>: phase velocity increases with $k$
- <strong>No ion motion</strong>: only electrons respond</p>
<p>We'll compute this dispersion relation in the Python code below.</p>
<h2 id="4-diamagnetic-drift">4. Diamagnetic Drift<a class="header-link" href="#4-diamagnetic-drift" title="Permanent link">&para;</a></h2>
<h3 id="41-particle-vs-fluid-drifts">4.1 Particle vs. Fluid Drifts<a class="header-link" href="#41-particle-vs-fluid-drifts" title="Permanent link">&para;</a></h3>
<p>In Lesson 3, we derived <strong>particle drifts</strong> from single-particle orbit theory:</p>
<p>$$\mathbf{v}_E = \frac{\mathbf{E} \times \mathbf{B}}{B^2}, \quad \mathbf{v}_{\nabla B} = \frac{m v_\perp^2}{2 q B^3} \mathbf{B} \times \nabla B, \quad \text{etc.}$$</p>
<p>These are drifts of individual particles.</p>
<p>In fluid theory, we have <strong>fluid drifts</strong> that emerge from pressure gradients and other collective effects. The most important is the <strong>diamagnetic drift</strong>.</p>
<h3 id="42-derivation-of-diamagnetic-drift">4.2 Derivation of Diamagnetic Drift<a class="header-link" href="#42-derivation-of-diamagnetic-drift" title="Permanent link">&para;</a></h3>
<p>Consider the momentum equation in a magnetized plasma with a pressure gradient perpendicular to $\mathbf{B}$:</p>
<p>$$m_s n_s \frac{d \mathbf{u}_s}{dt} = q_s n_s (\mathbf{E} + \mathbf{u}_s \times \mathbf{B}) - \nabla p_s$$</p>
<p>In equilibrium ($d\mathbf{u}_s/dt = 0$) with no electric field ($\mathbf{E} = 0$):</p>
<p>$$0 = q_s n_s \mathbf{u}_s \times \mathbf{B} - \nabla p_s$$</p>
<p>Taking the cross product with $\mathbf{B}$:</p>
<p>$$q_s n_s (\mathbf{u}_s \times \mathbf{B}) \times \mathbf{B} = -\nabla p_s \times \mathbf{B}$$</p>
<p>Using the vector identity $(\mathbf{A} \times \mathbf{B}) \times \mathbf{C} = \mathbf{B}(\mathbf{A} \cdot \mathbf{C}) - \mathbf{A}(\mathbf{B} \cdot \mathbf{C})$:</p>
<p>$$q_s n_s [\mathbf{B} (\mathbf{u}_s \cdot \mathbf{B}) - \mathbf{u}_s B^2] = -\nabla p_s \times \mathbf{B}$$</p>
<p>If the flow is perpendicular to $\mathbf{B}$ (i.e., $\mathbf{u}_s \cdot \mathbf{B} = 0$):</p>
<p>$$\mathbf{u}_s = \frac{\nabla p_s \times \mathbf{B}}{q_s n_s B^2} = -\frac{\mathbf{B} \times \nabla p_s}{q_s n_s B^2}$$</p>
<p>This is the <strong>diamagnetic drift velocity</strong>:</p>
<p>$$\boxed{\mathbf{v}_{*s} = -\frac{\mathbf{B} \times \nabla p_s}{q_s n_s B^2}}$$</p>
<p>For electrons ($q_e = -e$):
$$\mathbf{v}_{*e} = \frac{\mathbf{B} \times \nabla p_e}{e n_e B^2}$$</p>
<p>For ions ($q_i = +e$):
$$\mathbf{v}_{*i} = -\frac{\mathbf{B} \times \nabla p_i}{e n_i B^2}$$</p>
<h3 id="43-diamagnetic-current">4.3 Diamagnetic Current<a class="header-link" href="#43-diamagnetic-current" title="Permanent link">&para;</a></h3>
<p>The <strong>diamagnetic current</strong> is:</p>
<p>$$\mathbf{J}_* = \sum_s q_s n_s \mathbf{v}_{*s} = -\frac{\mathbf{B} \times \nabla p_e}{B^2} - \frac{\mathbf{B} \times \nabla p_i}{B^2} = \frac{\mathbf{B} \times \nabla p}{B^2}$$</p>
<p>where $p = p_e + p_i$ is the total pressure.</p>
<p>This can also be written as:
$$\mathbf{J}_* = -\nabla p \times \frac{\mathbf{B}}{B^2}$$</p>
<p><strong>Key point</strong>: The diamagnetic drift is <strong>not a particle drift</strong>! If you solve for individual particle orbits, you won't find this drift. It arises from the <strong>spatial variation of the distribution function</strong> due to pressure gradients.</p>
<p>To see this, note that the diamagnetic drift velocity depends on the gradient scale length $L_p = p / |\nabla p|$:</p>
<p>$$v_* \sim \frac{p}{q n B L_p} = \frac{k_B T}{q B L_p} \sim \frac{\rho}{L_p} v_{th}$$</p>
<p>where $\rho = v_{th}/\omega_c$ is the gyroradius.</p>
<p>In a collisionless plasma, particles on different gyro-orbits have different densities, creating a net drift when averaged over a distribution.</p>
<h3 id="44-physical-interpretation-magnetization-current">4.4 Physical Interpretation: Magnetization Current<a class="header-link" href="#44-physical-interpretation-magnetization-current" title="Permanent link">&para;</a></h3>
<p>The diamagnetic current can be understood as a <strong>magnetization current</strong> arising from the magnetic moments of gyrating particles.</p>
<p>The magnetization is:
$$\mathbf{M} = -n \mu \frac{\mathbf{B}}{B}$$</p>
<p>where $\mu = m v_\perp^2 / (2B)$ is the magnetic moment.</p>
<p>The magnetization current is:
$$\mathbf{J}_m = \nabla \times \mathbf{M}$$</p>
<p>For a pressure gradient perpendicular to $\mathbf{B}$, this gives:
$$\mathbf{J}_m = \frac{\mathbf{B} \times \nabla p_\perp}{B^2}$$</p>
<p>which is exactly the diamagnetic current.</p>
<h3 id="45-example-cylindrical-plasma-column">4.5 Example: Cylindrical Plasma Column<a class="header-link" href="#45-example-cylindrical-plasma-column" title="Permanent link">&para;</a></h3>
<p>Consider a cylindrical plasma column with:
- Axial magnetic field: $\mathbf{B} = B_0 \hat{\mathbf{z}}$
- Radial pressure profile: $p(r) = p_0 \left(1 - \frac{r^2}{a^2}\right)$</p>
<p>The pressure gradient is:
$$\nabla p = \frac{dp}{dr} \hat{\mathbf{r}} = -\frac{2 p_0 r}{a^2} \hat{\mathbf{r}}$$</p>
<p>The diamagnetic current is:
$$\mathbf{J}_* = \frac{\mathbf{B} \times \nabla p}{B^2} = \frac{B_0 \hat{\mathbf{z}} \times \left( -\frac{2 p_0 r}{a^2} \hat{\mathbf{r}} \right)}{B_0^2} = \frac{2 p_0 r}{B_0 a^2} \hat{\boldsymbol{\theta}}$$</p>
<p>This is an azimuthal current that opposes the applied field (diamagnetic).</p>
<p>The diamagnetic drift velocity for electrons is:
$$\mathbf{v}_{*e} = \frac{\mathbf{B} \times \nabla p_e}{e n_e B^2} = \frac{2 k_B T_e r}{e B_0 a^2} \hat{\boldsymbol{\theta}}$$</p>
<p>Electrons drift in the $+\hat{\boldsymbol{\theta}}$ direction (counterclockwise when viewed from above).</p>
<p>Ions drift in the opposite direction:
$$\mathbf{v}_{*i} = -\frac{2 k_B T_i r}{e B_0 a^2} \hat{\boldsymbol{\theta}}$$</p>
<p>The net current is the sum of electron and ion contributions.</p>
<h2 id="5-two-fluid-waves">5. Two-Fluid Waves<a class="header-link" href="#5-two-fluid-waves" title="Permanent link">&para;</a></h2>
<h3 id="51-kinetic-alfven-wave">5.1 Kinetic Alfv√©n Wave<a class="header-link" href="#51-kinetic-alfven-wave" title="Permanent link">&para;</a></h3>
<p>At scales approaching the ion gyroradius, the Alfv√©n wave is modified by kinetic effects. The <strong>kinetic Alfv√©n wave (KAW)</strong> has a dispersion relation:</p>
<p>$$\omega^2 = k_\parallel^2 V_A^2 \left( 1 + k_\perp^2 \rho_s^2 \right)$$</p>
<p>where $\rho_s = c_s / \omega_{ci}$ is the <strong>ion sound gyroradius</strong> (or hybrid gyroradius), with $c_s = \sqrt{k_B T_e / m_i}$ the ion sound speed.</p>
<p>Key features:
- Finite $k_\perp$ increases the wave frequency
- Electric field has a parallel component: $E_\parallel \neq 0$
- Electrons can be accelerated parallel to $\mathbf{B}$</p>
<p>The KAW is important in:
- Auroral acceleration
- Solar wind turbulence
- Tokamak edge turbulence</p>
<h3 id="52-whistler-wave-from-two-fluid-perspective">5.2 Whistler Wave from Two-Fluid Perspective<a class="header-link" href="#52-whistler-wave-from-two-fluid-perspective" title="Permanent link">&para;</a></h3>
<p>In Lesson 10, we derived whistler waves from kinetic theory. Here's the two-fluid perspective:</p>
<p>Starting from Hall MHD (electron inertia neglected), the dispersion relation for electromagnetic waves is:</p>
<p>$$\omega = \frac{k_\parallel^2 V_A^2}{\omega_{ci}} \equiv k_\parallel V_A k_\parallel d_i$$</p>
<p>This is the <strong>whistler wave</strong>:
- High-frequency ($\omega \ll \omega_{ce}$, but $\omega \gg \omega_{ci}$)
- Right-hand polarized (electrons gyrate, ions stationary)
- Phase velocity increases with $k$ (dispersive)</p>
<p>The whistler wave plays a key role in:
- Magnetic reconnection (enables fast inflow)
- Radiation belt dynamics (pitch-angle scattering of energetic electrons)
- Solar corona heating</p>
<h3 id="53-ion-cyclotron-wave">5.3 Ion-Cyclotron Wave<a class="header-link" href="#53-ion-cyclotron-wave" title="Permanent link">&para;</a></h3>
<p>At frequencies near the ion cyclotron frequency, the <strong>ion-cyclotron wave</strong> (or <strong>ion Bernstein wave</strong>) appears:</p>
<p>$$\omega \approx \omega_{ci} + k_\parallel^2 V_A^2 / \omega_{ci}$$</p>
<p>Features:
- Left-hand polarized (ions gyrate, electrons respond adiabatically)
- Resonant absorption at $\omega = \omega_{ci}$
- Used for plasma heating (ICRF heating in tokamaks)</p>
<h3 id="54-two-stream-instability">5.4 Two-Stream Instability<a class="header-link" href="#54-two-stream-instability" title="Permanent link">&para;</a></h3>
<p>When two fluids have relative streaming velocity $u_0$, the system can be unstable. Consider ions at rest and electrons streaming with velocity $u_0$:</p>
<p>The dispersion relation becomes:
$$\omega^2 - k^2 c_s^2 - \omega_{pe}^2 = 0, \quad \text{(ion acoustic)}$$
$$(\omega - k u_0)^2 - \omega_{pe}^2 = 0 \quad \text{(Langmuir shifted by Doppler)}$$</p>
<p>When these modes couple, we get the <strong>two-stream instability</strong> if $u_0 > v_{te}$ (electron thermal speed).</p>
<p>Growth rate:
$$\gamma \sim \frac{\omega_{pe}}{3^{1/3}} \left( \frac{u_0}{v_{te}} \right)^{2/3}$$</p>
<p>This is a <strong>kinetic instability</strong>, but it can be captured in two-fluid theory with appropriate closure.</p>
<h2 id="6-python-code-examples">6. Python Code Examples<a class="header-link" href="#6-python-code-examples" title="Permanent link">&para;</a></h2>
<h3 id="61-two-fluid-vs-single-fluid-dispersion-relations">6.1 Two-Fluid vs. Single-Fluid Dispersion Relations<a class="header-link" href="#61-two-fluid-vs-single-fluid-dispersion-relations" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Plasma parameters</span>
<span class="n">m_i</span> <span class="o">=</span> <span class="mf">1.67e-27</span>  <span class="c1"># proton mass (kg)</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.11e-31</span>  <span class="c1"># electron mass (kg)</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">1.6e-19</span>     <span class="c1"># elementary charge (C)</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">3e8</span>         <span class="c1"># speed of light (m/s)</span>
<span class="n">mu_0</span> <span class="o">=</span> <span class="mf">4e-7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># permeability</span>

<span class="n">n</span> <span class="o">=</span> <span class="mf">1e19</span>        <span class="c1"># density (m^-3)</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">0.1</span>         <span class="c1"># magnetic field (T)</span>
<span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>        <span class="c1"># electron temperature (eV)</span>
<span class="n">T_i</span> <span class="o">=</span> <span class="mi">10</span>        <span class="c1"># ion temperature (eV)</span>

<span class="c1"># Convert temperature to Joules</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-23</span>
<span class="n">T_e_J</span> <span class="o">=</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span>
<span class="n">T_i_J</span> <span class="o">=</span> <span class="n">T_i</span> <span class="o">*</span> <span class="n">e</span>

<span class="c1"># Derived quantities</span>
<span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">omega_pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_i</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">omega_ce</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">m_e</span>
<span class="n">omega_ci</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">m_i</span>

<span class="n">v_A</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu_0</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m_i</span><span class="p">)</span>  <span class="c1"># Alfv√©n speed</span>
<span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">T_e_J</span> <span class="o">+</span> <span class="n">T_i_J</span><span class="p">)</span> <span class="o">/</span> <span class="n">m_i</span><span class="p">)</span>  <span class="c1"># ion sound speed</span>
<span class="n">d_i</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">omega_pi</span>  <span class="c1"># ion skin depth</span>
<span class="n">d_e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">omega_pe</span>  <span class="c1"># electron skin depth</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plasma parameters:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Alfv√©n speed V_A = </span><span class="si">{</span><span class="n">v_A</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s = </span><span class="si">{</span><span class="n">v_A</span><span class="o">/</span><span class="n">c</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> c&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion sound speed c_s = </span><span class="si">{</span><span class="n">c_s</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion skin depth d_i = </span><span class="si">{</span><span class="n">d_i</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Electron skin depth d_e = </span><span class="si">{</span><span class="n">d_e</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion gyrofrequency œâ_ci = </span><span class="si">{</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Electron gyrofrequency œâ_ce = </span><span class="si">{</span><span class="n">omega_ce</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Wavenumber range (parallel to B)</span>
<span class="n">k_min</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">)</span>
<span class="n">k_max</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">k_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">k_max</span><span class="p">),</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># MHD Alfv√©n wave (single-fluid)</span>
<span class="n">omega_MHD</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v_A</span>

<span class="c1"># Hall MHD Alfv√©n/whistler wave (two-fluid)</span>
<span class="n">omega_Hall</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v_A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Kinetic Alfv√©n wave (with finite k_perp)</span>
<span class="n">k_perp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># assume oblique propagation</span>
<span class="n">rho_s</span> <span class="o">=</span> <span class="n">c_s</span> <span class="o">/</span> <span class="n">omega_ci</span>  <span class="c1"># ion sound gyroradius</span>
<span class="n">omega_KAW</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v_A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k_perp</span> <span class="o">*</span> <span class="n">rho_s</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot dispersion relations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">omega_MHD</span> <span class="o">/</span> <span class="n">omega_ci</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MHD Alfv√©n&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">omega_Hall</span> <span class="o">/</span> <span class="n">omega_ci</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hall MHD (whistler)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">omega_KAW</span> <span class="o">/</span> <span class="n">omega_ci</span><span class="p">,</span> <span class="s1">&#39;g-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic Alfv√©n&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$k d_i = 1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$k d_i$ (normalized wavenumber)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega / \omega_</span><span class="si">{ci}</span><span class="s1">$ (normalized frequency)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Two-Fluid Dispersion Relations: Alfv√©n to Whistler Transition&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;two_fluid_dispersion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At k d_i = 1:&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  MHD: œâ/œâ_ci = </span><span class="si">{</span><span class="n">omega_MHD</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Hall MHD: œâ/œâ_ci = </span><span class="si">{</span><span class="n">omega_Hall</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Kinetic Alfv√©n: œâ/œâ_ci = </span><span class="si">{</span><span class="n">omega_KAW</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="62-generalized-ohms-law-relative-term-magnitudes">6.2 Generalized Ohm's Law: Relative Term Magnitudes<a class="header-link" href="#62-generalized-ohms-law-relative-term-magnitudes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate relative magnitudes of generalized Ohm&#39;s law terms.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    n: density (m^-3)</span>
<span class="sd">    T_e: electron temperature (eV)</span>
<span class="sd">    B: magnetic field (T)</span>
<span class="sd">    L: length scale (m)</span>
<span class="sd">    V: flow velocity (m/s)</span>
<span class="sd">    eta: resistivity (Œ©¬∑m), if None calculate from Spitzer</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">e</span> <span class="o">=</span> <span class="mf">1.6e-19</span>
    <span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.11e-31</span>
    <span class="n">m_i</span> <span class="o">=</span> <span class="mf">1.67e-27</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mf">4e-7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-23</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mf">3e8</span>

    <span class="c1"># Spitzer resistivity (if not provided)</span>
    <span class="k">if</span> <span class="n">eta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">T_e_eV</span> <span class="o">=</span> <span class="n">T_e</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Coulomb logarithm (typical)</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="mf">5.2e-5</span> <span class="o">*</span> <span class="n">ln_Lambda</span> <span class="o">*</span> <span class="n">T_e_eV</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Œ©¬∑m</span>

    <span class="c1"># Current density (from Ampere&#39;s law estimate)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="p">(</span><span class="n">mu_0</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>

    <span class="c1"># Characteristic electric field (ideal MHD)</span>
    <span class="n">E_ideal</span> <span class="o">=</span> <span class="n">V</span> <span class="o">*</span> <span class="n">B</span>

    <span class="c1"># Generalized Ohm&#39;s law terms</span>
    <span class="n">E_resistive</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">J</span>
    <span class="n">E_Hall</span> <span class="o">=</span> <span class="n">J</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">E_pressure</span> <span class="o">=</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>  <span class="c1"># ‚àáp_e ~ nkT/L</span>

    <span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
    <span class="n">d_e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">omega_pe</span>
    <span class="n">E_inertia</span> <span class="o">=</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="p">(</span><span class="n">V</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span>

    <span class="c1"># Normalize to ideal MHD term</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Ideal (v√óB)&#39;</span><span class="p">:</span> <span class="n">E_ideal</span><span class="p">,</span>
        <span class="s1">&#39;Resistive (Œ∑J)&#39;</span><span class="p">:</span> <span class="n">E_resistive</span><span class="p">,</span>
        <span class="s1">&#39;Hall (J√óB/ne)&#39;</span><span class="p">:</span> <span class="n">E_Hall</span><span class="p">,</span>
        <span class="s1">&#39;Pressure (‚àáp_e/ne)&#39;</span><span class="p">:</span> <span class="n">E_pressure</span><span class="p">,</span>
        <span class="s1">&#39;Inertia (m_e dJ/dt)&#39;</span><span class="p">:</span> <span class="n">E_inertia</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">/</span><span class="n">E_ideal</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span> <span class="n">eta</span>

<span class="c1"># Parameter scan: vary length scale</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># 1 mm to 1 km</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">1e19</span>
<span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">V</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># 100 km/s</span>

<span class="n">terms_vs_L</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Ideal (v√óB)&#39;</span><span class="p">,</span> <span class="s1">&#39;Resistive (Œ∑J)&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Hall (J√óB/ne)&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure (‚àáp_e/ne)&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Inertia (m_e dJ/dt)&#39;</span><span class="p">]}</span>

<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span>
    <span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">terms_vs_L</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">terms_vs_L</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;Ideal (v√óB)&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Mark characteristic scales</span>
<span class="n">d_e</span> <span class="o">=</span> <span class="mf">3e8</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.6e-19</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">9.11e-31</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">d_i</span> <span class="o">=</span> <span class="mf">3e8</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.6e-19</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.67e-27</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">d_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$d_e$ = </span><span class="si">{</span><span class="n">d_e</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">d_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$d_i$ = </span><span class="si">{</span><span class="n">d_i</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Length scale L (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative magnitude (normalized to v√óB)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Generalized Ohm</span><span class="se">\&#39;</span><span class="s1">s Law: Term Magnitudes vs. Scale&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ohm_law_terms.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print values at specific scales</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Relative term magnitudes:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At L = </span><span class="si">{</span><span class="n">d_e</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m (electron skin depth):&quot;</span><span class="p">)</span>
<span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">d_e</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">25s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At L = </span><span class="si">{</span><span class="n">d_i</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m (ion skin depth):&quot;</span><span class="p">)</span>
<span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">25s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At L = 1 m (macroscopic scale):&quot;</span><span class="p">)</span>
<span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">25s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="63-diamagnetic-drift-visualization">6.3 Diamagnetic Drift Visualization<a class="header-link" href="#63-diamagnetic-drift-visualization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circle</span>

<span class="k">def</span><span class="w"> </span><span class="nf">diamagnetic_drift_cylinder</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize diamagnetic drift in a cylindrical plasma column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Plasma parameters</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># plasma radius (m)</span>
    <span class="n">B_0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># axial magnetic field (T)</span>
    <span class="n">p_0</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># peak pressure (Pa)</span>
    <span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># electron temperature (eV)</span>
    <span class="n">T_i</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># ion temperature (eV)</span>
    <span class="n">n_0</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># peak density (m^-3)</span>

    <span class="n">e</span> <span class="o">=</span> <span class="mf">1.6e-19</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-23</span>

    <span class="c1"># Radial grid</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Pressure profile (parabolic)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p_e</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">p_i</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Pressure gradient</span>
    <span class="n">dp_dr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p_0</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">dp_e_dr</span> <span class="o">=</span> <span class="n">dp_dr</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dp_i_dr</span> <span class="o">=</span> <span class="n">dp_dr</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Diamagnetic drift velocities</span>
    <span class="n">v_star_e</span> <span class="o">=</span> <span class="o">-</span><span class="n">dp_e_dr</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">B_0</span><span class="p">)</span>  <span class="c1"># azimuthal (Œ∏) direction</span>
    <span class="n">v_star_i</span> <span class="o">=</span> <span class="n">dp_i_dr</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">B_0</span><span class="p">)</span>

    <span class="c1"># Diamagnetic current density</span>
    <span class="n">J_theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">dp_dr</span> <span class="o">/</span> <span class="n">B_0</span>

    <span class="c1"># Plot profiles</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Pressure profile</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p_e</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Electron&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p_i</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ion&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (kPa)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pressure Profile&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Diamagnetic drift velocities</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">v_star_e</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Electron&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">v_star_i</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ion&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Drift velocity (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Diamagnetic Drift Velocity (azimuthal)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Diamagnetic current</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">J_theta</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Current density (kA/m¬≤)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Diamagnetic Current Density (azimuthal)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># 2D visualization: top view</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>

    <span class="c1"># Pressure contour</span>
    <span class="n">P_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">Y</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">P_grid</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pressure (kPa)&#39;</span><span class="p">)</span>

    <span class="c1"># Velocity vectors (sample points)</span>
    <span class="n">n_arrows</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">r_arrows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">theta_arrows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_arrows</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">r_arrows</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">theta_arrows</span><span class="p">:</span>
            <span class="n">xi</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
            <span class="n">yi</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

            <span class="c1"># Diamagnetic drift is in theta direction</span>
            <span class="c1"># In Cartesian: v_theta = -sin(Œ∏) v_r_hat + cos(Œ∏) v_Œ∏_hat</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">ri</span><span class="p">))</span>
            <span class="n">v_mag</span> <span class="o">=</span> <span class="n">v_star_e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

            <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">v_mag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
            <span class="n">vy</span> <span class="o">=</span> <span class="n">v_mag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">yi</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">vx</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">vy</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span>
                    <span class="n">head_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Electron Diamagnetic Drift (top view)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">a</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;diamagnetic_drift.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Print values at r = a/2</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At r = a/2 = </span><span class="si">{</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> cm:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Pressure: </span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kPa&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Electron drift: </span><span class="si">{</span><span class="n">v_star_e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion drift: </span><span class="si">{</span><span class="n">v_star_i</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current density: </span><span class="si">{</span><span class="n">J_theta</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kA/m¬≤&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Drift frequency: </span><span class="si">{</span><span class="n">v_star_e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Compare to œâ_ci = </span><span class="si">{</span><span class="n">e</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.67e-27</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>

<span class="n">diamagnetic_drift_cylinder</span><span class="p">()</span>
</code></pre></div>

<h3 id="64-two-fluid-closure-comparison">6.4 Two-Fluid Closure Comparison<a class="header-link" href="#64-two-fluid-closure-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compare_closures</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compare different closure models: isothermal vs. adiabatic.</span>
<span class="sd">    Simulate compression of a plasma element.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initial conditions</span>
    <span class="n">n_0</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># m^-3</span>
    <span class="n">T_0</span> <span class="o">=</span> <span class="mi">10</span>    <span class="c1"># eV</span>
    <span class="n">V_0</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># m^3</span>

    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># adiabatic index</span>

    <span class="c1"># Compression ratio</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">V_0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">V_0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n_0</span> <span class="o">*</span> <span class="p">(</span><span class="n">V_0</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span>  <span class="c1"># density increases as volume decreases</span>

    <span class="c1"># Isothermal: T = const</span>
    <span class="n">T_isothermal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">*</span> <span class="n">T_0</span>
    <span class="n">p_isothermal</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">T_isothermal</span>

    <span class="c1"># Adiabatic: p V^Œ≥ = const</span>
    <span class="n">p_adiabatic</span> <span class="o">=</span> <span class="n">n_0</span> <span class="o">*</span> <span class="n">T_0</span> <span class="o">*</span> <span class="p">(</span><span class="n">V_0</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="n">gamma</span>
    <span class="n">T_adiabatic</span> <span class="o">=</span> <span class="n">p_adiabatic</span> <span class="o">/</span> <span class="n">n</span>

    <span class="c1"># Plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Temperature vs. compression</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="n">V_0</span><span class="p">,</span> <span class="n">T_isothermal</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Isothermal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="n">V_0</span><span class="p">,</span> <span class="n">T_adiabatic</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Adiabatic (Œ≥=5/3)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;V / V‚ÇÄ&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature Evolution under Compression&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Pressure vs. density</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">n_0</span><span class="p">,</span> <span class="n">p_isothermal</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Isothermal (p ‚àù n)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">n_0</span><span class="p">,</span> <span class="n">p_adiabatic</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Adiabatic (p ‚àù n^Œ≥)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n / n‚ÇÄ&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;p / (n‚ÇÄ T‚ÇÄ)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pressure vs. Density&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;closure_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># At 50% compression</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="n">V_0</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At 50</span><span class="si">% c</span><span class="s2">ompression (V = 0.5 V‚ÇÄ):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Density: </span><span class="si">{</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">n_0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> n‚ÇÄ&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Isothermal:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    T = </span><span class="si">{</span><span class="n">T_isothermal</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (unchanged)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    p = </span><span class="si">{</span><span class="n">p_isothermal</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (n‚ÇÄ T‚ÇÄ)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Adiabatic:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    T = </span><span class="si">{</span><span class="n">T_adiabatic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    p = </span><span class="si">{</span><span class="n">p_adiabatic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (n‚ÇÄ T‚ÇÄ)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Pressure ratio (adiabatic/isothermal): </span><span class="si">{</span><span class="n">p_adiabatic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">p_isothermal</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">compare_closures</span><span class="p">()</span>
</code></pre></div>

<h2 id="summary">Summary<a class="header-link" href="#summary" title="Permanent link">&para;</a></h2>
<p>In this lesson, we derived the two-fluid model by taking velocity-space moments of the Vlasov equation. Key points:</p>
<ol>
<li>
<p><strong>Moment hierarchy</strong>: Each moment equation introduces the next higher-order moment, leading to a closure problem.</p>
</li>
<li>
<p><strong>Closure models</strong>: Isothermal, adiabatic, and CGL closures truncate the hierarchy with different physical assumptions.</p>
</li>
<li>
<p><strong>Generalized Ohm's law</strong>: The full form includes resistive, Hall, electron pressure, and electron inertia terms. Each term becomes important at different length scales:</p>
</li>
<li>Resistive: low $R_m$ (collisional plasmas)</li>
<li>Hall: $L \sim d_i$ (ion skin depth)</li>
<li>Electron pressure: steep gradients</li>
<li>
<p>Electron inertia: $L \sim d_e$ (electron skin depth)</p>
</li>
<li>
<p><strong>Hall effect</strong>: At scales $\lesssim d_i$, ions decouple from the magnetic field while electrons remain frozen-in. This enables fast magnetic reconnection and whistler wave propagation.</p>
</li>
<li>
<p><strong>Diamagnetic drift</strong>: A fluid drift arising from pressure gradients, not a single-particle drift. Creates a current $\mathbf{J}_* = \mathbf{B} \times \nabla p / B^2$.</p>
</li>
<li>
<p><strong>Two-fluid waves</strong>: Hall MHD modifies Alfv√©n waves into whistler waves at small scales. Kinetic Alfv√©n waves include finite-$k_\perp$ effects.</p>
</li>
</ol>
<p>The two-fluid model bridges the gap between single-particle kinetic theory and single-fluid MHD. It captures important physics at intermediate scales (ion gyroradius to ion skin depth) that are missed by ideal MHD but don't require the full complexity of kinetic theory.</p>
<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-moment-calculation">Problem 1: Moment Calculation<a class="header-link" href="#problem-1-moment-calculation" title="Permanent link">&para;</a></h3>
<p>Starting from the Vlasov equation, derive the second moment (energy equation) explicitly. Show that the heat flux $\mathbf{q}_s = \frac{1}{2} m_s \int w^2 \mathbf{w} f_s d^3v$ appears. What physical process does the heat flux represent?</p>
<h3 id="problem-2-hall-mhd-dispersion">Problem 2: Hall MHD Dispersion<a class="header-link" href="#problem-2-hall-mhd-dispersion" title="Permanent link">&para;</a></h3>
<p>Derive the dispersion relation for whistler waves in Hall MHD:
$$\omega = \frac{k_\parallel^2 V_A^2}{\omega_{ci}}$$
Start from the two-fluid equations with the Hall term, assume $\omega \ll \omega_{ce}$ and $\omega \gg \omega_{ci}$, and use the cold plasma approximation ($p = 0$).</p>
<h3 id="problem-3-diamagnetic-current-in-a-tokamak">Problem 3: Diamagnetic Current in a Tokamak<a class="header-link" href="#problem-3-diamagnetic-current-in-a-tokamak" title="Permanent link">&para;</a></h3>
<p>In a tokamak with major radius $R_0 = 3$ m and minor radius $a = 1$ m, the electron pressure profile is:
$$p_e(r) = p_0 \left(1 - \frac{r^2}{a^2}\right)^2$$
with $p_0 = 5 \times 10^5$ Pa. The toroidal magnetic field is $B_\phi = 5$ T. Calculate:
(a) The diamagnetic current density at $r = a/2$.
(b) The total poloidal current from the diamagnetic effect (integrate $J_\theta$ over the cross-section).
(c) Compare this to the bootstrap current (which has a similar profile).</p>
<h3 id="problem-4-generalized-ohms-law-in-a-current-sheet">Problem 4: Generalized Ohm's Law in a Current Sheet<a class="header-link" href="#problem-4-generalized-ohms-law-in-a-current-sheet" title="Permanent link">&para;</a></h3>
<p>In a magnetic reconnection current sheet, the length scale is $L = 10 d_i$, where $d_i = 100$ km is the ion skin depth. The plasma density is $n = 10^7$ m$^{-3}$ (solar wind), electron temperature $T_e = 100$ eV, and magnetic field $B = 10$ nT. Calculate the relative magnitudes of:
(a) The ideal MHD term $\mathbf{v} \times \mathbf{B}$
(b) The Hall term $\mathbf{J} \times \mathbf{B} / (en)$
(c) The electron pressure term $\nabla p_e / (en)$
(d) The electron inertia term
Which term(s) are important in this current sheet?</p>
<h3 id="problem-5-two-fluid-instability">Problem 5: Two-Fluid Instability<a class="header-link" href="#problem-5-two-fluid-instability" title="Permanent link">&para;</a></h3>
<p>Consider a two-fluid plasma with $T_e = T_i$ and a density gradient $\nabla n = -n_0 / L_n \hat{\mathbf{x}}$ in a magnetic field $\mathbf{B} = B_0 \hat{\mathbf{z}}$.
(a) Calculate the electron and ion diamagnetic drift velocities.
(b) The drift-wave instability occurs when the phase difference between density and potential perturbations causes wave growth. Using the continuity equation and quasi-neutrality, show that electrostatic drift waves have the dispersion relation:
$$\omega = \frac{k_y k_B T_e}{e B_0 L_n}$$
where $k_y$ is the wavenumber perpendicular to both $\mathbf{B}$ and $\nabla n$.
(c) For $L_n = 1$ cm, $T_e = 1$ eV, $B_0 = 0.1$ T, and $k_y = 100$ m$^{-1}$, calculate the drift wave frequency.</p>
<hr />
<p><strong>Previous</strong>: <a href="./12_Wave_Heating_and_Instabilities.md">Wave Heating and Instabilities</a> | <strong>Next</strong>: <a href="./14_From_Kinetic_to_MHD.md">From Kinetic to MHD</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Plasma_Physics/12_Wave_Heating_and_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">12. Wave Heating and Instabilities</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Plasma_Physics/14_From_Kinetic_to_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">14. From Kinetic to MHD</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}