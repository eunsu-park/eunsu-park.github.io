{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Design Principles - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Programming/">Programming</a>
    <span class="separator">/</span>
    <span class="current">API Design Principles</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>API Design Principles</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Programming/12_Concurrency_and_Parallelism.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Concurrency & Parallelism</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Programming/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Programming/14_Version_Control_Workflows.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Version Control and Collaboration</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-an-api">What Is an API?</a><ul>
<li><a href="#types-of-apis">Types of APIs</a></li>
</ul>
</li>
<li><a href="#rest-api-design">REST API Design</a><ul>
<li><a href="#core-principles">Core Principles</a><ul>
<li><a href="#1-resources-and-uris">1. Resources and URIs</a></li>
<li><a href="#2-http-methods">2. HTTP Methods</a></li>
<li><a href="#3-http-status-codes">3. HTTP Status Codes</a></li>
<li><a href="#4-pagination">4. Pagination</a></li>
<li><a href="#5-filtering-sorting-searching">5. Filtering, Sorting, Searching</a></li>
<li><a href="#6-hateoas">6. HATEOAS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rpc-style-apis">RPC-Style APIs</a><ul>
<li><a href="#grpc">gRPC</a></li>
<li><a href="#when-to-use-rpc-vs-rest">When to Use RPC vs REST</a></li>
</ul>
</li>
<li><a href="#graphql">GraphQL</a><ul>
<li><a href="#schema-definition">Schema Definition</a></li>
<li><a href="#queries-and-mutations">Queries and Mutations</a></li>
<li><a href="#the-n1-problem">The N+1 Problem</a></li>
<li><a href="#when-graphql-shines">When GraphQL Shines</a></li>
</ul>
</li>
<li><a href="#api-design-principles_1">API Design Principles</a><ul>
<li><a href="#1-consistency">1. Consistency</a></li>
<li><a href="#2-principle-of-least-surprise">2. Principle of Least Surprise</a></li>
<li><a href="#3-idempotency">3. Idempotency</a></li>
<li><a href="#4-backward-compatibility">4. Backward Compatibility</a></li>
</ul>
</li>
<li><a href="#versioning-strategies">Versioning Strategies</a><ul>
<li><a href="#1-url-versioning">1. URL Versioning</a></li>
<li><a href="#2-header-versioning">2. Header Versioning</a></li>
<li><a href="#3-query-parameter">3. Query Parameter</a></li>
</ul>
</li>
<li><a href="#authentication-and-authorization">Authentication and Authorization</a><ul>
<li><a href="#api-keys">API Keys</a></li>
<li><a href="#oauth-20">OAuth 2.0</a></li>
<li><a href="#jwt-json-web-tokens">JWT (JSON Web Tokens)</a></li>
</ul>
</li>
<li><a href="#rate-limiting-and-throttling">Rate Limiting and Throttling</a></li>
<li><a href="#error-responses">Error Responses</a></li>
<li><a href="#documentation">Documentation</a><ul>
<li><a href="#openapi-swagger">OpenAPI (Swagger)</a></li>
<li><a href="#essential-documentation-elements">Essential Documentation Elements</a></li>
</ul>
</li>
<li><a href="#internal-api-design-libraries-and-modules">Internal API Design (Libraries and Modules)</a><ul>
<li><a href="#minimal-surface-area">Minimal Surface Area</a></li>
<li><a href="#encapsulation">Encapsulation</a></li>
<li><a href="#fluent-interfaces-and-builder-pattern">Fluent Interfaces and Builder Pattern</a></li>
<li><a href="#consistent-naming-and-parameter-ordering">Consistent Naming and Parameter Ordering</a></li>
</ul>
</li>
<li><a href="#exercises">Exercises</a><ul>
<li><a href="#exercise-1-design-a-rest-api-for-a-bookstore">Exercise 1: Design a REST API for a Bookstore</a></li>
<li><a href="#exercise-2-api-review">Exercise 2: API Review</a></li>
<li><a href="#exercise-3-versioning-strategy">Exercise 3: Versioning Strategy</a></li>
<li><a href="#exercise-4-error-handling-design">Exercise 4: Error Handling Design</a></li>
<li><a href="#exercise-5-library-api-design">Exercise 5: Library API Design</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#navigation">Navigation</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="api-design-principles">API Design Principles<a class="header-link" href="#api-design-principles" title="Permanent link">&para;</a></h1>
<blockquote>
<p><strong>Topic</strong>: Programming
<strong>Lesson</strong>: 13 of 16
<strong>Prerequisites</strong>: Object-oriented programming, HTTP basics, JSON/XML formats
<strong>Objective</strong>: Learn how to design clear, consistent, and maintainable APIs for libraries, modules, and web services</p>
</blockquote>
<h2 id="introduction">Introduction<a class="header-link" href="#introduction" title="Permanent link">&para;</a></h2>
<p>An <strong>API (Application Programming Interface)</strong> is a contract that defines how software components communicate. Whether you're designing a library function, a REST endpoint, or a system interface, good API design makes your software easier to use, maintain, and evolve.</p>
<p>Poor API design leads to:
- Confused users who misuse your interface
- Brittle code that breaks with minor changes
- Support burden from unclear documentation
- Integration difficulties for consumers</p>
<p>Great API design is invisible‚Äîusers accomplish their goals without friction.</p>
<h2 id="what-is-an-api">What Is an API?<a class="header-link" href="#what-is-an-api" title="Permanent link">&para;</a></h2>
<p>An API is an <strong>abstraction</strong> that hides implementation details while exposing functionality:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Bad: exposing implementation details</span>
<span class="n">user_data</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">execute_raw_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE id = ?&quot;</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span>

<span class="c1"># Good: abstraction through API</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">user_service</span><span class="o">.</span><span class="n">get_user_by_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
</code></pre></div>

<h3 id="types-of-apis">Types of APIs<a class="header-link" href="#types-of-apis" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Library/Module APIs</strong>: Functions and classes in code libraries</li>
<li><strong>Web APIs</strong>: HTTP-based services (REST, GraphQL, gRPC)</li>
<li><strong>Operating System APIs</strong>: System calls, file I/O, process management</li>
<li><strong>Hardware APIs</strong>: Device drivers, firmware interfaces</li>
</ol>
<p>This lesson focuses primarily on web APIs and library APIs, as they represent the most common design challenges.</p>
<h2 id="rest-api-design">REST API Design<a class="header-link" href="#rest-api-design" title="Permanent link">&para;</a></h2>
<p><strong>REST (Representational State Transfer)</strong> is an architectural style for web APIs that uses HTTP methods and URIs to represent resources.</p>
<h3 id="core-principles">Core Principles<a class="header-link" href="#core-principles" title="Permanent link">&para;</a></h3>
<h4 id="1-resources-and-uris">1. Resources and URIs<a class="header-link" href="#1-resources-and-uris" title="Permanent link">&para;</a></h4>
<p>Resources are <strong>nouns</strong>, not verbs. URIs identify resources; HTTP methods indicate actions.</p>
<p><strong>Good URI Design</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nv">GET</span><span class="w">    </span><span class="o">/</span><span class="nv">users</span><span class="w">              </span>#<span class="w"> </span><span class="nv">List</span><span class="w"> </span><span class="nv">users</span>
<span class="nv">GET</span><span class="w">    </span><span class="o">/</span><span class="nv">users</span><span class="o">/</span><span class="mi">123</span><span class="w">          </span>#<span class="w"> </span><span class="nv">Get</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="mi">123</span>
<span class="nv">POST</span><span class="w">   </span><span class="o">/</span><span class="nv">users</span><span class="w">              </span>#<span class="w"> </span><span class="nv">Create</span><span class="w"> </span><span class="nv">user</span>
<span class="nv">PUT</span><span class="w">    </span><span class="o">/</span><span class="nv">users</span><span class="o">/</span><span class="mi">123</span><span class="w">          </span>#<span class="w"> </span><span class="nv">Update</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="mi">123</span>
<span class="nv">DELETE</span><span class="w"> </span><span class="o">/</span><span class="nv">users</span><span class="o">/</span><span class="mi">123</span><span class="w">          </span>#<span class="w"> </span><span class="nv">Delete</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="mi">123</span>
<span class="nv">GET</span><span class="w">    </span><span class="o">/</span><span class="nv">users</span><span class="o">/</span><span class="mi">123</span><span class="o">/</span><span class="nv">orders</span><span class="w">   </span>#<span class="w"> </span><span class="nv">Get</span><span class="w"> </span><span class="nv">orders</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="mi">123</span>
</code></pre></div>

<p><strong>Poor URI Design</strong>:</p>
<div class="highlight"><pre><span></span><code>GET    /getUsers           # Verb in URI
POST   /createUser         # Verb in URI
GET    /users/delete/123   # Action in URI path
GET    /user_orders?id=123 # Inconsistent naming
</code></pre></div>

<p><strong>Naming Conventions</strong>:
- Use <strong>plural nouns</strong> for collections (<code>/users</code>, not <code>/user</code>)
- Use <strong>lowercase</strong> with hyphens (<code>/order-items</code>, not <code>/OrderItems</code>)
- Represent <strong>hierarchies</strong> with path segments (<code>/users/123/addresses/456</code>)</p>
<h4 id="2-http-methods">2. HTTP Methods<a class="header-link" href="#2-http-methods" title="Permanent link">&para;</a></h4>
<p>Use HTTP methods semantically:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Purpose</th>
<th>Idempotent?</th>
<th>Safe?</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>Retrieve resource</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>POST</td>
<td>Create resource</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>PUT</td>
<td>Replace resource</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>PATCH</td>
<td>Partial update</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>DELETE</td>
<td>Remove resource</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<p><strong>Idempotent</strong>: Multiple identical requests have the same effect as a single request
<strong>Safe</strong>: Request doesn't modify server state</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Express.js example</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/users/:id&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">userService</span><span class="p">.</span><span class="nx">findById</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">userService</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">201</span><span class="p">).</span><span class="nx">json</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;/users/:id&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">userService</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">patch</span><span class="p">(</span><span class="s1">&#39;/users/:id&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">userService</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="s1">&#39;/users/:id&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">userService</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">204</span><span class="p">).</span><span class="nx">send</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<h4 id="3-http-status-codes">3. HTTP Status Codes<a class="header-link" href="#3-http-status-codes" title="Permanent link">&para;</a></h4>
<p>Use appropriate status codes to communicate outcomes:</p>
<p><strong>2xx Success</strong>:
- <code>200 OK</code>: Standard success response
- <code>201 Created</code>: Resource created (POST)
- <code>204 No Content</code>: Success with no response body (DELETE)</p>
<p><strong>4xx Client Errors</strong>:
- <code>400 Bad Request</code>: Invalid input
- <code>401 Unauthorized</code>: Authentication required
- <code>403 Forbidden</code>: Authenticated but not authorized
- <code>404 Not Found</code>: Resource doesn't exist
- <code>409 Conflict</code>: Resource state conflict
- <code>422 Unprocessable Entity</code>: Validation error</p>
<p><strong>5xx Server Errors</strong>:
- <code>500 Internal Server Error</code>: Generic server error
- <code>503 Service Unavailable</code>: Temporary outage</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Flask example</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="ow">or</span> <span class="s1">&#39;email&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Email is required&#39;</span><span class="p">}),</span> <span class="mi">400</span>

    <span class="k">if</span> <span class="n">user_exists</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;User already exists&#39;</span><span class="p">}),</span> <span class="mi">409</span>

    <span class="n">user</span> <span class="o">=</span> <span class="n">create_user_in_db</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">user</span><span class="p">),</span> <span class="mi">201</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/users/&lt;int:user_id&gt;&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">find_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;User not found&#39;</span><span class="p">}),</span> <span class="mi">404</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">user</span><span class="p">),</span> <span class="mi">200</span>
</code></pre></div>

<h4 id="4-pagination">4. Pagination<a class="header-link" href="#4-pagination" title="Permanent link">&para;</a></h4>
<p>For collections, implement pagination to prevent overwhelming responses:</p>
<p><strong>Offset-based pagination</strong>:</p>
<div class="highlight"><pre><span></span><code>GET /users?offset=20&amp;limit=10

Response:
{
  &quot;data&quot;: [...],
  &quot;pagination&quot;: {
    &quot;offset&quot;: 20,
    &quot;limit&quot;: 10,
    &quot;total&quot;: 150
  }
}
</code></pre></div>

<p><strong>Cursor-based pagination</strong> (better for real-time data):</p>
<div class="highlight"><pre><span></span><code>GET /users?cursor=eyJpZCI6MTIzfQ==&amp;limit=10

Response:
{
  &quot;data&quot;: [...],
  &quot;next_cursor&quot;: &quot;eyJpZCI6MTMzfQ==&quot;
}
</code></pre></div>

<h4 id="5-filtering-sorting-searching">5. Filtering, Sorting, Searching<a class="header-link" href="#5-filtering-sorting-searching" title="Permanent link">&para;</a></h4>
<p>Provide query parameters for flexible data retrieval:</p>
<div class="highlight"><pre><span></span><code>GET /users?role=admin&amp;sort=-created_at&amp;search=john
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">// Java Spring Boot example</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/users&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@GetMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Page</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nf">getUsers</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">role</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">search</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;20&quot;</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">sortBy</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ASC&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Sort</span><span class="p">.</span><span class="na">Direction</span><span class="w"> </span><span class="n">direction</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Pageable</span><span class="w"> </span><span class="n">pageable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PageRequest</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">Sort</span><span class="p">.</span><span class="na">by</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span><span class="w"> </span><span class="n">sortBy</span><span class="p">));</span>
<span class="w">        </span><span class="n">Page</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userService</span><span class="p">.</span><span class="na">findUsers</span><span class="p">(</span><span class="n">role</span><span class="p">,</span><span class="w"> </span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="n">pageable</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">users</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="6-hateoas">6. HATEOAS<a class="header-link" href="#6-hateoas" title="Permanent link">&para;</a></h4>
<p><strong>HATEOAS (Hypermedia As The Engine Of Application State)</strong> includes links to related resources in responses:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;john@example.com&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;_links&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;self&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/users/123&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;orders&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/users/123/orders&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;addresses&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/users/123/addresses&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>This makes APIs self-documenting and discoverable.</p>
<h2 id="rpc-style-apis">RPC-Style APIs<a class="header-link" href="#rpc-style-apis" title="Permanent link">&para;</a></h2>
<p><strong>RPC (Remote Procedure Call)</strong> APIs model actions as function calls rather than resources.</p>
<h3 id="grpc">gRPC<a class="header-link" href="#grpc" title="Permanent link">&para;</a></h3>
<p>gRPC uses <strong>Protocol Buffers</strong> for efficient binary serialization:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// user.proto</span>
<span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="kd">service</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetUser</span><span class="w"> </span><span class="p">(</span><span class="n">GetUserRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">User</span><span class="p">);</span>
<span class="w">  </span><span class="k">rpc</span><span class="w"> </span><span class="n">CreateUser</span><span class="w"> </span><span class="p">(</span><span class="n">CreateUserRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">User</span><span class="p">);</span>
<span class="w">  </span><span class="k">rpc</span><span class="w"> </span><span class="n">ListUsers</span><span class="w"> </span><span class="p">(</span><span class="n">ListUsersRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">ListUsersResponse</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">User</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int32</span><span class="w"> </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetUserRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int32</span><span class="w"> </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Python gRPC server</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">grpc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">concurrent</span><span class="w"> </span><span class="kn">import</span> <span class="n">futures</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">user_pb2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">user_pb2_grpc</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">(</span><span class="n">user_pb2_grpc</span><span class="o">.</span><span class="n">UserServiceServicer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">GetUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">find_user</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">abort</span><span class="p">(</span><span class="n">grpc</span><span class="o">.</span><span class="n">StatusCode</span><span class="o">.</span><span class="n">NOT_FOUND</span><span class="p">,</span> <span class="s1">&#39;User not found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user_pb2</span><span class="o">.</span><span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">)</span>

<span class="n">server</span> <span class="o">=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">server</span><span class="p">(</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">user_pb2_grpc</span><span class="o">.</span><span class="n">add_UserServiceServicer_to_server</span><span class="p">(</span><span class="n">UserService</span><span class="p">(),</span> <span class="n">server</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">add_insecure_port</span><span class="p">(</span><span class="s1">&#39;[::]:50051&#39;</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>

<h3 id="when-to-use-rpc-vs-rest">When to Use RPC vs REST<a class="header-link" href="#when-to-use-rpc-vs-rest" title="Permanent link">&para;</a></h3>
<p><strong>Use RPC (gRPC) when</strong>:
- High performance and low latency are critical
- You need bidirectional streaming
- Internal microservice communication
- Type safety is important</p>
<p><strong>Use REST when</strong>:
- Public-facing APIs
- Broad client compatibility (browsers, mobile)
- Human-readable debugging
- Caching and standard HTTP tooling</p>
<h2 id="graphql">GraphQL<a class="header-link" href="#graphql" title="Permanent link">&para;</a></h2>
<p><strong>GraphQL</strong> is a query language that allows clients to request exactly the data they need.</p>
<h3 id="schema-definition">Schema Definition<a class="header-link" href="#schema-definition" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">type</span><span class="w"> </span><span class="err">User</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">id</span><span class="p">:</span><span class="w"> </span><span class="n">ID</span><span class="err">!</span>
<span class="w">  </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">String</span><span class="err">!</span>
<span class="w">  </span><span class="nl">email</span><span class="p">:</span><span class="w"> </span><span class="n">String</span><span class="err">!</span>
<span class="w">  </span><span class="nl">orders</span><span class="p">:</span><span class="w"> </span><span class="err">[</span><span class="n">Order</span><span class="err">!]!</span>
<span class="p">}</span>

<span class="k">type</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">id</span><span class="p">:</span><span class="w"> </span><span class="n">ID</span><span class="err">!</span>
<span class="w">  </span><span class="nl">total</span><span class="p">:</span><span class="w"> </span><span class="n">Float</span><span class="err">!</span>
<span class="w">  </span><span class="nl">items</span><span class="p">:</span><span class="w"> </span><span class="err">[</span><span class="n">OrderItem</span><span class="err">!]!</span>
<span class="p">}</span>

<span class="k">type</span><span class="w"> </span><span class="err">Query</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">user</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="no">ID</span><span class="err">!</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">User</span>
<span class="w">  </span><span class="n">users</span><span class="p">(</span><span class="n">limit</span><span class="p">:</span><span class="w"> </span><span class="no">Int</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">:</span><span class="w"> </span><span class="no">Int</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="err">[</span><span class="n">User</span><span class="err">!]!</span>
<span class="p">}</span>

<span class="k">type</span><span class="w"> </span><span class="err">Mutation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">createUser</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="no">String</span><span class="err">!</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="no">String</span><span class="err">!</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">User</span><span class="err">!</span>
<span class="w">  </span><span class="n">updateUser</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="no">ID</span><span class="err">!</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="no">String</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="no">String</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">User</span><span class="err">!</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="queries-and-mutations">Queries and Mutations<a class="header-link" href="#queries-and-mutations" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Client query - request only needed fields</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span>
<span class="sb">  query GetUser($id: ID!) {</span>
<span class="sb">    user(id: $id) {</span>
<span class="sb">      name</span>
<span class="sb">      email</span>
<span class="sb">      orders {</span>
<span class="sb">        total</span>
<span class="sb">      }</span>
<span class="sb">    }</span>
<span class="sb">  }</span>
<span class="sb">`</span><span class="p">;</span>

<span class="c1">// Server resolver (Node.js)</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">resolvers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">Query</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">context</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">findUserById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">User</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">orders</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">,</span><span class="w"> </span><span class="nx">context</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">findOrdersByUserId</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nx">Mutation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">createUser</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">context</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">createUser</span><span class="p">({</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">};</span>
</code></pre></div>

<h3 id="the-n1-problem">The N+1 Problem<a class="header-link" href="#the-n1-problem" title="Permanent link">&para;</a></h3>
<p>GraphQL can cause performance issues when resolving nested fields:</p>
<div class="highlight"><pre><span></span><code><span class="k">query</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">users</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">name</span>
<span class="w">    </span><span class="n">orders</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c"># N+1: One query per user</span>
<span class="w">      </span><span class="n">total</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Solution: DataLoader</strong> batches and caches requests:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">DataLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;dataloader&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">orderLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DataLoader</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">userIds</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">findOrdersByUserIds</span><span class="p">(</span><span class="nx">userIds</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">userIds</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">orders</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">o</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">o</span><span class="p">.</span><span class="nx">userId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">id</span><span class="p">));</span>
<span class="p">});</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">resolvers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">User</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">orders</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">orderLoader</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">orderLoader</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">};</span>
</code></pre></div>

<h3 id="when-graphql-shines">When GraphQL Shines<a class="header-link" href="#when-graphql-shines" title="Permanent link">&para;</a></h3>
<p><strong>Use GraphQL when</strong>:
- Clients need flexible data fetching (mobile, web dashboards)
- You want to avoid over-fetching or under-fetching
- Rapid frontend iteration without backend changes</p>
<p><strong>Avoid GraphQL when</strong>:
- Simple CRUD operations (REST is simpler)
- File uploads (GraphQL has poor file handling)
- Caching is critical (HTTP caching works better with REST)</p>
<h2 id="api-design-principles_1">API Design Principles<a class="header-link" href="#api-design-principles_1" title="Permanent link">&para;</a></h2>
<h3 id="1-consistency">1. Consistency<a class="header-link" href="#1-consistency" title="Permanent link">&para;</a></h3>
<p>Consistency reduces cognitive load. Establish conventions and follow them:</p>
<p><strong>Naming conventions</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Consistent
GET /users
GET /orders
GET /products

<span class="gh">#</span> Inconsistent
GET /users
GET /getOrders
GET /product_list
</code></pre></div>

<p><strong>Response formats</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Consistent success response</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Consistent error response</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VALIDATION_ERROR&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Email is required&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;fields&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This field is required&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="2-principle-of-least-surprise">2. Principle of Least Surprise<a class="header-link" href="#2-principle-of-least-surprise" title="Permanent link">&para;</a></h3>
<p>APIs should behave as users expect. Avoid surprising behavior:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Surprising: method name suggests read-only, but mutates state</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user_or_create</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">find_user</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">create_user</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>  <span class="c1"># Surprise!</span>
    <span class="k">return</span> <span class="n">user</span>

<span class="c1"># Clear: name indicates possible mutation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_or_create_user</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">find_user</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">create_user</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">user</span>
</code></pre></div>

<h3 id="3-idempotency">3. Idempotency<a class="header-link" href="#3-idempotency" title="Permanent link">&para;</a></h3>
<p>Idempotent operations can be safely retried without side effects:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Idempotent: PUT replaces entire resource</span>
<span class="n">PUT</span> <span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="mi">123</span>
<span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;john@example.com&quot;</span> <span class="p">}</span>

<span class="c1"># Not idempotent: PATCH might increment</span>
<span class="n">PATCH</span> <span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="mi">123</span>
<span class="p">{</span> <span class="s2">&quot;login_count&quot;</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}</span>  <span class="c1"># What if retried?</span>

<span class="c1"># Better: server-controlled increments</span>
<span class="n">POST</span> <span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="mi">123</span><span class="o">/</span><span class="n">login</span>
</code></pre></div>

<h3 id="4-backward-compatibility">4. Backward Compatibility<a class="header-link" href="#4-backward-compatibility" title="Permanent link">&para;</a></h3>
<p>Never break existing clients. Evolve APIs carefully:</p>
<p><strong>Safe changes</strong>:
- Adding optional fields
- Adding new endpoints
- Deprecating fields (with grace period)</p>
<p><strong>Breaking changes</strong>:
- Removing fields
- Changing field types
- Renaming fields
- Changing validation rules</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Backward compatible: new optional field</span>
<span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;email&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;john@example.com&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;phone&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;555-1234&quot;</span><span class="w">  </span><span class="c1">// New, optional</span>
<span class="p">}</span>

<span class="c1">// Breaking: removed field</span>
<span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span>
<span class="w">  </span><span class="c1">// &quot;email&quot; removed - breaks clients!</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="versioning-strategies">Versioning Strategies<a class="header-link" href="#versioning-strategies" title="Permanent link">&para;</a></h2>
<p>When breaking changes are necessary, version your API:</p>
<h3 id="1-url-versioning">1. URL Versioning<a class="header-link" href="#1-url-versioning" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>GET /v1/users
GET /v2/users
</code></pre></div>

<p><strong>Pros</strong>: Clear, easy to route
<strong>Cons</strong>: URL changes, caching issues</p>
<h3 id="2-header-versioning">2. Header Versioning<a class="header-link" href="#2-header-versioning" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>GET /users
Accept: application/vnd.myapi.v2+json
</code></pre></div>

<p><strong>Pros</strong>: Clean URLs
<strong>Cons</strong>: Less visible, harder to test in browser</p>
<h3 id="3-query-parameter">3. Query Parameter<a class="header-link" href="#3-query-parameter" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>GET /users?version=2
</code></pre></div>

<p><strong>Pros</strong>: Easy to test
<strong>Cons</strong>: Mixes versioning with filtering</p>
<p><strong>Recommendation</strong>: URL versioning for major versions, feature flags for minor changes.</p>
<h2 id="authentication-and-authorization">Authentication and Authorization<a class="header-link" href="#authentication-and-authorization" title="Permanent link">&para;</a></h2>
<h3 id="api-keys">API Keys<a class="header-link" href="#api-keys" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>GET /users
X-API-Key: abc123xyz
</code></pre></div>

<p>Simple but less secure. Use for low-stakes internal APIs.</p>
<h3 id="oauth-20">OAuth 2.0<a class="header-link" href="#oauth-20" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>GET /users
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
</code></pre></div>

<p>Industry standard for delegated authorization. Use for third-party integrations.</p>
<h3 id="jwt-json-web-tokens">JWT (JSON Web Tokens)<a class="header-link" href="#jwt-json-web-tokens" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Node.js JWT example</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">jwt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jsonwebtoken&#39;</span><span class="p">);</span>

<span class="c1">// Create token</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="mf">123</span><span class="p">,</span><span class="w"> </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET_KEY</span><span class="p">,</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">expiresIn</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1h&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="p">);</span>

<span class="c1">// Verify token</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">authenticate</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">authorization</span><span class="o">?</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mf">1</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">token</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">401</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Unauthorized&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET_KEY</span><span class="p">);</span>
<span class="w">    </span><span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">payload</span><span class="p">;</span>
<span class="w">    </span><span class="nx">next</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">403</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Invalid token&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="rate-limiting-and-throttling">Rate Limiting and Throttling<a class="header-link" href="#rate-limiting-and-throttling" title="Permanent link">&para;</a></h2>
<p>Protect your API from abuse:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Python Flask rate limiting</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask_limiter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Limiter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask_limiter.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_remote_address</span>

<span class="n">limiter</span> <span class="o">=</span> <span class="n">Limiter</span><span class="p">(</span>
    <span class="n">app</span><span class="p">,</span>
    <span class="n">key_func</span><span class="o">=</span><span class="n">get_remote_address</span><span class="p">,</span>
    <span class="n">default_limits</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;100 per hour&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/search&#39;</span><span class="p">)</span>
<span class="nd">@limiter</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="s2">&quot;10 per minute&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">perform_expensive_search</span><span class="p">()</span>
</code></pre></div>

<p><strong>Response headers</strong>:</p>
<div class="highlight"><pre><span></span><code>X-RateLimit-Limit: 100
X-RateLimit-Remaining: 87
X-RateLimit-Reset: 1614556800
</code></pre></div>

<p>Return <code>429 Too Many Requests</code> when limit exceeded.</p>
<h2 id="error-responses">Error Responses<a class="header-link" href="#error-responses" title="Permanent link">&para;</a></h2>
<p>Provide consistent, helpful error messages:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VALIDATION_ERROR&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Request validation failed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;email&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Email is required&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;age&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Age must be at least 18&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;request_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;req_abc123&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">// C++ library API error handling</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ApiException</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="w"> </span><span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">message_</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">code_</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">ApiException</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">code_</span><span class="p">(</span><span class="n">code</span><span class="p">),</span><span class="w"> </span><span class="n">message_</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">code_</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">message_</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">User</span><span class="w"> </span><span class="n">getUser</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">ApiException</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Invalid user ID&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">findById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">ApiException</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;User not found&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">user</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</code></pre></div>

<h2 id="documentation">Documentation<a class="header-link" href="#documentation" title="Permanent link">&para;</a></h2>
<p>Great APIs have great documentation.</p>
<h3 id="openapi-swagger">OpenAPI (Swagger)<a class="header-link" href="#openapi-swagger" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># openapi.yaml</span>
<span class="nt">openapi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.0.0</span>
<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">User API</span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0</span>
<span class="nt">paths</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">/users/{userId}</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="nt">get</span><span class="p">:</span>
<span class="w">      </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get user by ID</span>
<span class="w">      </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">userId</span>
<span class="w">          </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path</span>
<span class="w">          </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">schema</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">      </span><span class="nt">responses</span><span class="p">:</span>
<span class="w">        </span><span class="s">&#39;200&#39;</span><span class="p p-Indicator">:</span>
<span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">User found</span>
<span class="w">          </span><span class="nt">content</span><span class="p">:</span>
<span class="w">            </span><span class="nt">application/json</span><span class="p">:</span>
<span class="w">              </span><span class="nt">schema</span><span class="p">:</span>
<span class="w">                </span><span class="nt">$ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#/components/schemas/User&#39;</span>
<span class="w">        </span><span class="s">&#39;404&#39;</span><span class="p p-Indicator">:</span>
<span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">User not found</span>
<span class="nt">components</span><span class="p">:</span>
<span class="w">  </span><span class="nt">schemas</span><span class="p">:</span>
<span class="w">    </span><span class="nt">User</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">id</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">email</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">email</span>
</code></pre></div>

<p><strong>Benefits</strong>:
- Auto-generated interactive documentation
- Client SDK generation
- Validation</p>
<h3 id="essential-documentation-elements">Essential Documentation Elements<a class="header-link" href="#essential-documentation-elements" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Getting Started</strong>: Quick example to make first API call</li>
<li><strong>Authentication</strong>: How to obtain and use credentials</li>
<li><strong>Rate Limits</strong>: Throttling rules and headers</li>
<li><strong>Error Codes</strong>: Comprehensive list with examples</li>
<li><strong>SDKs</strong>: Client libraries for popular languages</li>
<li><strong>Changelog</strong>: Version history and migration guides</li>
</ol>
<h2 id="internal-api-design-libraries-and-modules">Internal API Design (Libraries and Modules)<a class="header-link" href="#internal-api-design-libraries-and-modules" title="Permanent link">&para;</a></h2>
<h3 id="minimal-surface-area">Minimal Surface Area<a class="header-link" href="#minimal-surface-area" title="Permanent link">&para;</a></h3>
<p>Expose only what's necessary:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Bad: exposing internals</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Database</span><span class="w"> </span><span class="n">db</span><span class="p">;</span><span class="w">  </span><span class="c1">// Exposed!</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">validateEmail</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">// Public but internal</span>
<span class="p">}</span>

<span class="c1">// Good: minimal interface</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Database</span><span class="w"> </span><span class="n">db</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="nf">getUser</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="nf">createUser</span><span class="p">(</span><span class="n">UserData</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">validateEmail</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">// Private</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="encapsulation">Encapsulation<a class="header-link" href="#encapsulation" title="Permanent link">&para;</a></h3>
<p>Hide implementation details:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Bad: implementation exposed</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ShoppingCart</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Direct access to internal list</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

<span class="n">cart</span> <span class="o">=</span> <span class="n">ShoppingCart</span><span class="p">()</span>
<span class="n">cart</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">invalid_item</span><span class="p">)</span>  <span class="c1"># Can bypass validation!</span>

<span class="c1"># Good: encapsulated</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ShoppingCart</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># Return copy, not reference</span>
</code></pre></div>

<h3 id="fluent-interfaces-and-builder-pattern">Fluent Interfaces and Builder Pattern<a class="header-link" href="#fluent-interfaces-and-builder-pattern" title="Permanent link">&para;</a></h3>
<p>Make APIs pleasant to use:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Fluent interface</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">QueryBuilder</span><span class="p">()</span>
<span class="w">  </span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">18</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">orderBy</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mf">10</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">build</span><span class="p">();</span>

<span class="c1">// Builder pattern</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">UserBuilder</span><span class="p">()</span>
<span class="w">  </span><span class="p">.</span><span class="nx">withName</span><span class="p">(</span><span class="s1">&#39;John Doe&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">withEmail</span><span class="p">(</span><span class="s1">&#39;john@example.com&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">withRole</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">build</span><span class="p">();</span>
</code></pre></div>

<h3 id="consistent-naming-and-parameter-ordering">Consistent Naming and Parameter Ordering<a class="header-link" href="#consistent-naming-and-parameter-ordering" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Consistent: resource first, then options</span>
<span class="n">user_service</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">include_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">order_service</span><span class="o">.</span><span class="n">get_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">,</span> <span class="n">include_items</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Inconsistent</span>
<span class="n">user_service</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">include_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">order_service</span><span class="o">.</span><span class="n">find_order</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># What does True mean?</span>
</code></pre></div>

<h2 id="exercises">Exercises<a class="header-link" href="#exercises" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-design-a-rest-api-for-a-bookstore">Exercise 1: Design a REST API for a Bookstore<a class="header-link" href="#exercise-1-design-a-rest-api-for-a-bookstore" title="Permanent link">&para;</a></h3>
<p>Design a REST API for an online bookstore with the following requirements:
- Browse books (with filtering by genre, author)
- Search books
- User accounts and authentication
- Shopping cart
- Order placement
- Order history</p>
<p>Provide:
1. List of endpoints with HTTP methods
2. Sample request/response bodies
3. Status codes for each endpoint
4. Pagination strategy</p>
<h3 id="exercise-2-api-review">Exercise 2: API Review<a class="header-link" href="#exercise-2-api-review" title="Permanent link">&para;</a></h3>
<p>Review this API design and identify violations of good API design principles:</p>
<div class="highlight"><pre><span></span><code><span class="nv">GET</span><span class="w"> </span><span class="o">/</span><span class="nv">getBook</span>?<span class="nv">id</span><span class="o">=</span><span class="mi">123</span>
<span class="nv">POST</span><span class="w"> </span><span class="o">/</span><span class="nv">createBook</span>?<span class="nv">title</span><span class="o">=</span><span class="nv">NewBook</span><span class="o">&amp;</span><span class="nv">author</span><span class="o">=</span><span class="nv">JohnDoe</span>
<span class="nv">GET</span><span class="w"> </span><span class="o">/</span><span class="nv">updateBook</span>?<span class="nv">id</span><span class="o">=</span><span class="mi">123</span><span class="o">&amp;</span><span class="nv">title</span><span class="o">=</span><span class="nv">UpdatedTitle</span>
<span class="nv">DELETE</span><span class="w"> </span><span class="o">/</span><span class="nv">books</span><span class="o">/</span><span class="nv">remove</span><span class="o">/</span><span class="mi">123</span>
<span class="nv">GET</span><span class="w"> </span><span class="o">/</span><span class="nv">books</span>?<span class="nv">page</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nv">limit</span><span class="o">=</span><span class="mi">1000</span>
<span class="nv">POST</span><span class="w"> </span><span class="o">/</span><span class="nv">users</span><span class="o">/</span><span class="nv">login</span><span class="w">  </span><span class="ss">(</span><span class="nv">returns</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="nv">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">credentials</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">wrong</span><span class="ss">)</span>
</code></pre></div>

<p>List what's wrong and propose improvements.</p>
<h3 id="exercise-3-versioning-strategy">Exercise 3: Versioning Strategy<a class="header-link" href="#exercise-3-versioning-strategy" title="Permanent link">&para;</a></h3>
<p>Your API currently has this endpoint:</p>
<div class="highlight"><pre><span></span><code><span class="k">GET</span><span class="w"> </span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="mi">123</span>
<span class="nl">Response</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="ss">&quot;name&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;John&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;email&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;john@example.com&quot;</span><span class="w"> </span><span class="err">}</span>
</code></pre></div>

<p>You need to add a breaking change: split <code>name</code> into <code>first_name</code> and <code>last_name</code>. Design a versioning strategy that:
1. Doesn't break existing clients
2. Allows new clients to use the improved structure
3. Provides a migration path</p>
<h3 id="exercise-4-error-handling-design">Exercise 4: Error Handling Design<a class="header-link" href="#exercise-4-error-handling-design" title="Permanent link">&para;</a></h3>
<p>Design a comprehensive error response format for a banking API that needs to handle:
- Validation errors (multiple fields)
- Insufficient funds
- Account locked
- Rate limiting
- Server errors</p>
<p>Provide JSON examples for each error type.</p>
<h3 id="exercise-5-library-api-design">Exercise 5: Library API Design<a class="header-link" href="#exercise-5-library-api-design" title="Permanent link">&para;</a></h3>
<p>Design a fluent API for a SQL query builder in your preferred language that supports:
- SELECT with multiple columns
- FROM with table name
- WHERE with multiple conditions (AND/OR)
- JOIN operations
- ORDER BY
- LIMIT and OFFSET</p>
<p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="sx">query.select(&#39;id&#39;,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="sx">)</span>
<span class="w">     </span><span class="sx">.from(&#39;users&#39;)</span>
<span class="w">     </span><span class="sx">.where(&#39;age</span><span class="w"> </span><span class="sx">&gt;</span><span class="w"> </span><span class="sx">?&#39;,</span><span class="w"> </span><span class="sx">18)</span>
<span class="w">     </span><span class="sx">.orderBy(&#39;name&#39;)</span>
<span class="w">     </span><span class="sx">.limit(10)</span>
</code></pre></div>

<h2 id="summary">Summary<a class="header-link" href="#summary" title="Permanent link">&para;</a></h2>
<p>Good API design is about empathy for your users:</p>
<ul>
<li><strong>REST</strong>: Resource-oriented, uses HTTP semantics, best for public APIs</li>
<li><strong>RPC/gRPC</strong>: Action-oriented, efficient, best for internal microservices</li>
<li><strong>GraphQL</strong>: Flexible querying, best for data-heavy client applications</li>
<li><strong>Consistency</strong>: Predictable naming, structure, and behavior</li>
<li><strong>Idempotency</strong>: Safe retries for PUT and DELETE</li>
<li><strong>Versioning</strong>: Manage changes without breaking clients</li>
<li><strong>Documentation</strong>: Make APIs self-explanatory with examples</li>
<li><strong>Error Handling</strong>: Clear, actionable error messages</li>
</ul>
<p>Remember: APIs are products. Treat your API consumers as customers‚Äîinvest in their experience.</p>
<h2 id="navigation">Navigation<a class="header-link" href="#navigation" title="Permanent link">&para;</a></h2>
<p><a href="12_Performance_Optimization.md">‚Üê Previous: Performance Optimization</a> | <a href="14_Version_Control_Workflows.md">Next: Version Control Workflows ‚Üí</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Programming/12_Concurrency_and_Parallelism.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Concurrency & Parallelism</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Programming/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Programming/14_Version_Control_Workflows.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Version Control and Collaboration</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}