{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Fundamentals and Threat Modeling - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Security/">Security</a>
    <span class="separator">/</span>
    <span class="current">Security Fundamentals and Threat Modeling</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Security Fundamentals and Threat Modeling</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Security/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Security</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Security/02_Cryptography_Basics.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Cryptography Basics</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-the-cia-triad">1. The CIA Triad</a><ul>
<li><a href="#11-confidentiality">1.1 Confidentiality</a></li>
<li><a href="#12-integrity">1.2 Integrity</a></li>
<li><a href="#13-availability">1.3 Availability</a></li>
<li><a href="#14-cia-trade-offs">1.4 CIA Trade-offs</a></li>
</ul>
</li>
<li><a href="#2-extended-security-properties">2. Extended Security Properties</a><ul>
<li><a href="#21-authentication-factors">2.1 Authentication Factors</a></li>
</ul>
</li>
<li><a href="#3-threat-modeling-with-stride">3. Threat Modeling with STRIDE</a><ul>
<li><a href="#31-stride-analysis-process">3.1 STRIDE Analysis Process</a></li>
<li><a href="#32-data-flow-diagram-elements">3.2 Data Flow Diagram Elements</a></li>
<li><a href="#33-example-threat-model-for-a-web-application">3.3 Example: Threat Model for a Web Application</a></li>
</ul>
</li>
<li><a href="#4-risk-scoring-with-dread">4. Risk Scoring with DREAD</a></li>
<li><a href="#5-attack-surfaces-and-threat-vectors">5. Attack Surfaces and Threat Vectors</a><ul>
<li><a href="#51-what-is-an-attack-surface">5.1 What Is an Attack Surface?</a></li>
<li><a href="#52-attack-surface-enumeration">5.2 Attack Surface Enumeration</a></li>
<li><a href="#53-common-threat-vectors">5.3 Common Threat Vectors</a></li>
</ul>
</li>
<li><a href="#6-defense-in-depth">6. Defense in Depth</a><ul>
<li><a href="#61-implementing-layered-security">6.1 Implementing Layered Security</a></li>
</ul>
</li>
<li><a href="#7-principle-of-least-privilege">7. Principle of Least Privilege</a><ul>
<li><a href="#71-least-privilege-in-database-access">7.1 Least Privilege in Database Access</a></li>
<li><a href="#72-least-privilege-in-code">7.2 Least Privilege in Code</a></li>
<li><a href="#73-least-privilege-in-cloud-aws-iam-example">7.3 Least Privilege in Cloud (AWS IAM Example)</a></li>
</ul>
</li>
<li><a href="#8-security-by-design-vs-security-by-obscurity">8. Security by Design vs Security by Obscurity</a><ul>
<li><a href="#81-security-by-design">8.1 Security by Design</a></li>
<li><a href="#82-security-by-obscurity-and-why-it-fails">8.2 Security by Obscurity (and Why It Fails)</a></li>
</ul>
</li>
<li><a href="#9-risk-assessment-frameworks">9. Risk Assessment Frameworks</a><ul>
<li><a href="#91-qualitative-risk-assessment">9.1 Qualitative Risk Assessment</a></li>
<li><a href="#92-risk-assessment-in-code">9.2 Risk Assessment in Code</a></li>
<li><a href="#93-notable-risk-frameworks">9.3 Notable Risk Frameworks</a></li>
</ul>
</li>
<li><a href="#10-common-vulnerability-scoring-system-cvss">10. Common Vulnerability Scoring System (CVSS)</a><ul>
<li><a href="#101-cvss-v31-v40-metrics">10.1 CVSS v3.1 / v4.0 Metrics</a></li>
<li><a href="#102-cvss-score-calculator">10.2 CVSS Score Calculator</a></li>
</ul>
</li>
<li><a href="#11-putting-it-all-together-a-worked-example">11. Putting It All Together: A Worked Example</a><ul>
<li><a href="#111-system-description">11.1 System Description</a></li>
<li><a href="#112-stride-threat-summary">11.2 STRIDE Threat Summary</a></li>
<li><a href="#113-defense-in-depth-applied">11.3 Defense in Depth Applied</a></li>
<li><a href="#114-least-privilege-applied">11.4 Least Privilege Applied</a></li>
</ul>
</li>
<li><a href="#12-exercises">12. Exercises</a><ul>
<li><a href="#exercise-1-cia-analysis-beginner">Exercise 1: CIA Analysis (Beginner)</a></li>
<li><a href="#exercise-2-stride-threat-model-intermediate">Exercise 2: STRIDE Threat Model (Intermediate)</a></li>
<li><a href="#exercise-3-cvss-scoring-intermediate">Exercise 3: CVSS Scoring (Intermediate)</a></li>
<li><a href="#exercise-4-defense-in-depth-design-advanced">Exercise 4: Defense in Depth Design (Advanced)</a></li>
<li><a href="#exercise-5-least-privilege-audit-advanced">Exercise 5: Least Privilege Audit (Advanced)</a></li>
<li><a href="#exercise-6-security-by-design-review-advanced">Exercise 6: Security by Design Review (Advanced)</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
<li><a href="#next-lesson">Next Lesson</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="security-fundamentals-and-threat-modeling">Security Fundamentals and Threat Modeling<a class="header-link" href="#security-fundamentals-and-threat-modeling" title="Permanent link">&para;</a></h1>
<p><strong>Next</strong>: <a href="./02_Cryptography_Basics.md">02. Cryptography Basics</a></p>
<hr />
<p>Security engineering is the discipline of building systems that remain dependable in the face of malice, error, and mischance. Before diving into specific technologies like cryptography or TLS, we need a shared vocabulary for reasoning about threats, risks, and defenses. This lesson establishes the conceptual foundations that every subsequent lesson builds upon.</p>
<p><strong>Difficulty</strong>: â­â­</p>
<p><strong>Learning Objectives</strong>:
- Understand the CIA Triad and extended security properties
- Apply threat modeling methodologies (STRIDE, DREAD) to real systems
- Identify attack surfaces and threat vectors in software architectures
- Design layered defenses using the defense-in-depth principle
- Apply the principle of least privilege in system design
- Distinguish security by design from security by obscurity
- Perform basic risk assessments using standard frameworks
- Interpret Common Vulnerability Scoring System (CVSS) scores</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-the-cia-triad">The CIA Triad</a></li>
<li><a href="#2-extended-security-properties">Extended Security Properties</a></li>
<li><a href="#3-threat-modeling-with-stride">Threat Modeling with STRIDE</a></li>
<li><a href="#4-risk-scoring-with-dread">Risk Scoring with DREAD</a></li>
<li><a href="#5-attack-surfaces-and-threat-vectors">Attack Surfaces and Threat Vectors</a></li>
<li><a href="#6-defense-in-depth">Defense in Depth</a></li>
<li><a href="#7-principle-of-least-privilege">Principle of Least Privilege</a></li>
<li><a href="#8-security-by-design-vs-security-by-obscurity">Security by Design vs Security by Obscurity</a></li>
<li><a href="#9-risk-assessment-frameworks">Risk Assessment Frameworks</a></li>
<li><a href="#10-common-vulnerability-scoring-system-cvss">Common Vulnerability Scoring System (CVSS)</a></li>
<li><a href="#11-putting-it-all-together-a-worked-example">Putting It All Together: A Worked Example</a></li>
<li><a href="#12-exercises">Exercises</a></li>
<li><a href="#13-references">References</a></li>
</ol>
<hr />
<h2 id="1-the-cia-triad">1. The CIA Triad<a class="header-link" href="#1-the-cia-triad" title="Permanent link">&para;</a></h2>
<p>The CIA Triad is the most fundamental model in information security. Every security control, every attack, and every risk can be analyzed through these three properties.</p>
<div class="highlight"><pre><span></span><code>                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   Confidentiality     â”‚
                         â”‚                       â”‚
                         â”‚   &quot;Who can see it?&quot;    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
                    â–¼                â–¼                â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    Integrity    â”‚              â”‚  Availability   â”‚
          â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚
          â”‚ &quot;Can I trust    â”‚              â”‚ &quot;Can I access   â”‚
          â”‚  it?&quot;           â”‚              â”‚  it when I      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  need to?&quot;      â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="11-confidentiality">1.1 Confidentiality<a class="header-link" href="#11-confidentiality" title="Permanent link">&para;</a></h3>
<p>Confidentiality ensures that information is accessible only to those authorized to have access. A breach of confidentiality means unauthorized disclosure of information.</p>
<p><strong>Threats to confidentiality:</strong>
- Eavesdropping on network traffic (packet sniffing)
- Unauthorized access to databases
- Social engineering (phishing)
- Shoulder surfing, dumpster diving
- Insider threats</p>
<p><strong>Controls for confidentiality:</strong>
- Encryption (at rest and in transit)
- Access control lists (ACLs)
- Authentication mechanisms
- Data classification and handling policies
- Physical security controls</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Example: Demonstrating confidentiality through encryption</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.fernet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fernet</span>

<span class="c1"># Generate a secret key (only authorized parties should have this)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># Sensitive data</span>
<span class="n">secret_message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Patient diagnosis: confidential medical record&quot;</span>

<span class="c1"># Encrypt - now only key holders can read this</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">secret_message</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted: </span><span class="si">{</span><span class="n">encrypted</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt - requires the key</span>
<span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Without the key, the data is meaningless</span>
<span class="n">wrong_key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span>
<span class="n">wrong_cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">wrong_key</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">wrong_cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unauthorized access denied: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="12-integrity">1.2 Integrity<a class="header-link" href="#12-integrity" title="Permanent link">&para;</a></h3>
<p>Integrity ensures that information has not been altered in an unauthorized manner. Data should be accurate, consistent, and trustworthy.</p>
<p><strong>Threats to integrity:</strong>
- Man-in-the-middle (MITM) attacks
- SQL injection modifying database records
- Malware altering files
- Unauthorized configuration changes
- Bit-rot or storage corruption</p>
<p><strong>Controls for integrity:</strong>
- Cryptographic hash functions (SHA-256)
- Digital signatures
- Message Authentication Codes (MAC/HMAC)
- Version control systems
- Database constraints and transactions</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_integrity_hash</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a SHA-256 hash of structured data for integrity verification.&quot;&quot;&quot;</span>
    <span class="c1"># Canonical JSON encoding ensures consistent hashing</span>
    <span class="n">canonical</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">canonical</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="c1"># Original financial record</span>
<span class="n">record</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;account&quot;</span><span class="p">:</span> <span class="s2">&quot;ACCT-001&quot;</span><span class="p">,</span>
    <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">1500.00</span><span class="p">,</span>
    <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2026-01-15T10:30:00Z&quot;</span>
<span class="p">}</span>

<span class="n">original_hash</span> <span class="o">=</span> <span class="n">compute_integrity_hash</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original hash: </span><span class="si">{</span><span class="n">original_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Verify integrity - unchanged data</span>
<span class="n">verified_hash</span> <span class="o">=</span> <span class="n">compute_integrity_hash</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verification:  </span><span class="si">{</span><span class="n">verified_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Integrity OK:  </span><span class="si">{</span><span class="n">original_hash</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">verified_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Tampered record - even a tiny change completely changes the hash</span>
<span class="n">tampered</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">tampered</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1500.01</span>  <span class="c1"># Changed by $0.01</span>
<span class="n">tampered_hash</span> <span class="o">=</span> <span class="n">compute_integrity_hash</span><span class="p">(</span><span class="n">tampered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tampered hash: </span><span class="si">{</span><span class="n">tampered_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Integrity OK:  </span><span class="si">{</span><span class="n">original_hash</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">tampered_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># False</span>
</code></pre></div>

<h3 id="13-availability">1.3 Availability<a class="header-link" href="#13-availability" title="Permanent link">&para;</a></h3>
<p>Availability ensures that information and systems are accessible when needed by authorized users.</p>
<p><strong>Threats to availability:</strong>
- Distributed Denial of Service (DDoS) attacks
- Hardware failures
- Software bugs and crashes
- Natural disasters
- Ransomware</p>
<p><strong>Controls for availability:</strong>
- Redundancy and failover systems
- Load balancing
- Regular backups and disaster recovery plans
- DDoS mitigation services
- Capacity planning and monitoring</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Example: Simple health check and availability monitor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ServiceHealthCheck</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor service availability.&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">endpoints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">check_history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate checking an endpoint&#39;s availability.&quot;&quot;&quot;</span>
        <span class="c1"># In production, this would make actual HTTP requests</span>
        <span class="n">is_up</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.1</span>  <span class="c1"># 90% uptime simulation</span>
        <span class="n">latency_ms</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_up</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;UP&quot;</span> <span class="k">if</span> <span class="n">is_up</span> <span class="k">else</span> <span class="s2">&quot;DOWN&quot;</span><span class="p">,</span>
            <span class="s2">&quot;latency_ms&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">latency_ms</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">latency_ms</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check all endpoints and compute availability.&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_endpoint</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span> <span class="k">for</span> <span class="n">ep</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">]</span>
        <span class="n">up_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UP&quot;</span><span class="p">)</span>
        <span class="n">availability</span> <span class="o">=</span> <span class="n">up_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;total_endpoints&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
            <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="n">up_count</span><span class="p">,</span>
            <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">-</span> <span class="n">up_count</span><span class="p">,</span>
            <span class="s2">&quot;availability_pct&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">availability</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="n">results</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">summary</span>

<span class="c1"># Define service endpoints</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">ServiceHealthCheck</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Payment API&quot;</span><span class="p">,</span>
    <span class="n">endpoints</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;https://api.example.com/v1/health&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://api-backup.example.com/v1/health&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://api-eu.example.com/v1/health&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Run health check</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">check_all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Availability: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;availability_pct&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]:</span>
    <span class="n">status_icon</span> <span class="o">=</span> <span class="s2">&quot;[OK]&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UP&quot;</span> <span class="k">else</span> <span class="s2">&quot;[!!]&quot;</span>
    <span class="n">latency</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;latency_ms&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">ms&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;latency_ms&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">status_icon</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">latency</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="14-cia-trade-offs">1.4 CIA Trade-offs<a class="header-link" href="#14-cia-trade-offs" title="Permanent link">&para;</a></h3>
<p>In practice, the three properties often tension against each other:</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CIA Trade-off Examples                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Scenario         â”‚ Trade-off                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Full-disk        â”‚ Confidentiality â†‘  Availability â†“              â”‚
â”‚ encryption       â”‚ (Decryption adds latency; lost key = no data)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Database         â”‚ Integrity â†‘  Availability â†“                    â”‚
â”‚ replication      â”‚ (Synchronous replication slows writes)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Public API       â”‚ Availability â†‘  Confidentiality â†“              â”‚
â”‚ with no auth     â”‚ (Anyone can access; maximum availability)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Air-gapped       â”‚ Confidentiality â†‘  Availability â†“              â”‚
â”‚ network          â”‚ (Very secure but hard to access remotely)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-extended-security-properties">2. Extended Security Properties<a class="header-link" href="#2-extended-security-properties" title="Permanent link">&para;</a></h2>
<p>Beyond the CIA Triad, several additional properties are essential for a complete security model.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                     </span><span class="nv">Extended</span><span class="w"> </span><span class="nv">Security</span><span class="w"> </span><span class="nv">Properties</span><span class="w">                     </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                                     </span>â”‚
â”‚<span class="w">  </span><span class="nv">Authentication</span><span class="w">        </span><span class="s2">&quot;Are you who you claim to be?&quot;</span><span class="w">               </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Something</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">know</span><span class="w"> </span><span class="ss">(</span><span class="nv">password</span>,<span class="w"> </span><span class="nv">PIN</span><span class="ss">)</span><span class="w">                             </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Something</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">have</span><span class="w"> </span><span class="ss">(</span><span class="nv">token</span>,<span class="w"> </span><span class="nv">smart</span><span class="w"> </span><span class="nv">card</span>,<span class="w"> </span><span class="nv">phone</span><span class="ss">)</span><span class="w">                  </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Something</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">are</span><span class="w">  </span><span class="ss">(</span><span class="nv">fingerprint</span>,<span class="w"> </span><span class="nv">face</span>,<span class="w"> </span><span class="nv">iris</span><span class="ss">)</span><span class="w">                   </span>â”‚
â”‚<span class="w">                                                                     </span>â”‚
â”‚<span class="w">  </span><span class="nv">Authorization</span><span class="w">         </span><span class="s2">&quot;What are you allowed to do?&quot;</span><span class="w">                </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Role</span><span class="o">-</span><span class="nv">Based</span><span class="w"> </span><span class="nv">Access</span><span class="w"> </span><span class="nv">Control</span><span class="w"> </span><span class="ss">(</span><span class="nv">RBAC</span><span class="ss">)</span><span class="w">                               </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Attribute</span><span class="o">-</span><span class="nv">Based</span><span class="w"> </span><span class="nv">Access</span><span class="w"> </span><span class="nv">Control</span><span class="w"> </span><span class="ss">(</span><span class="nv">ABAC</span><span class="ss">)</span><span class="w">                          </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Mandatory</span><span class="w"> </span><span class="nv">Access</span><span class="w"> </span><span class="nv">Control</span><span class="w"> </span><span class="ss">(</span><span class="nv">MAC</span><span class="ss">)</span><span class="w">                                 </span>â”‚
â”‚<span class="w">                                                                     </span>â”‚
â”‚<span class="w">  </span><span class="nv">Non</span><span class="o">-</span><span class="nv">repudiation</span><span class="w">       </span><span class="s2">&quot;Can you deny you did this?&quot;</span><span class="w">                 </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Digital</span><span class="w"> </span><span class="nv">signatures</span><span class="w">                                             </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Audit</span><span class="w"> </span><span class="nv">logs</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">tamper</span><span class="o">-</span><span class="nv">evident</span><span class="w"> </span><span class="nv">storage</span><span class="w">                         </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Blockchain</span><span class="o">-</span><span class="nv">based</span><span class="w"> </span><span class="nv">records</span><span class="w">                                       </span>â”‚
â”‚<span class="w">                                                                     </span>â”‚
â”‚<span class="w">  </span><span class="nv">Accountability</span><span class="w">        </span><span class="s2">&quot;Can we trace actions to actors?&quot;</span><span class="w">            </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Comprehensive</span><span class="w"> </span><span class="nv">logging</span><span class="w">                                          </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Session</span><span class="w"> </span><span class="nv">tracking</span><span class="w">                                               </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Forensic</span><span class="w"> </span><span class="nv">analysis</span><span class="w"> </span><span class="nv">capabilities</span><span class="w">                                 </span>â”‚
â”‚<span class="w">                                                                     </span>â”‚
â”‚<span class="w">  </span><span class="nv">Privacy</span><span class="w">               </span><span class="s2">&quot;Is personal data properly protected?&quot;</span><span class="w">       </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Data</span><span class="w"> </span><span class="nv">minimization</span><span class="w">                                              </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Purpose</span><span class="w"> </span><span class="nv">limitation</span><span class="w">                                             </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Consent</span><span class="w"> </span><span class="nv">management</span><span class="w"> </span><span class="ss">(</span><span class="nv">GDPR</span>,<span class="w"> </span><span class="nv">CCPA</span><span class="ss">)</span><span class="w">                                </span>â”‚
â”‚<span class="w">                                                                     </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="21-authentication-factors">2.1 Authentication Factors<a class="header-link" href="#21-authentication-factors" title="Permanent link">&para;</a></h3>
<p>Multi-factor authentication (MFA) combines two or more independent factors:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AuthFactor</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">KNOWLEDGE</span> <span class="o">=</span> <span class="s2">&quot;something_you_know&quot;</span>    <span class="c1"># Password, PIN</span>
    <span class="n">POSSESSION</span> <span class="o">=</span> <span class="s2">&quot;something_you_have&quot;</span>   <span class="c1"># TOTP token, smart card</span>
    <span class="n">INHERENCE</span> <span class="o">=</span> <span class="s2">&quot;something_you_are&quot;</span>     <span class="c1"># Biometric</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AuthenticationAttempt</span><span class="p">:</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">factors_provided</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SimpleAuthenticator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrates multi-factor authentication concepts.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_attempts</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lockout_duration</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># 5 minutes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register with salted password hash.&quot;&quot;&quot;</span>
        <span class="n">salt</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_hex</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">password_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span>
            <span class="p">(</span><span class="n">salt</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;salt&quot;</span><span class="p">:</span> <span class="n">salt</span><span class="p">,</span>
            <span class="s2">&quot;password_hash&quot;</span><span class="p">:</span> <span class="n">password_hash</span><span class="p">,</span>
            <span class="s2">&quot;totp_secret&quot;</span><span class="p">:</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_hex</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>  <span class="c1"># For MFA</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">verify_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify knowledge factor (password).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="c1"># Constant-time comparison to prevent user enumeration</span>
            <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;dummy_computation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
        <span class="n">computed</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span>
            <span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s2">&quot;salt&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">secrets</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">computed</span><span class="p">,</span> <span class="n">user</span><span class="p">[</span><span class="s2">&quot;password_hash&quot;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_locked_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if account is locked due to failed attempts.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attempts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_attempts</span><span class="p">:</span>
            <span class="n">last_attempt</span> <span class="o">=</span> <span class="n">attempts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_attempt</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockout_duration</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="c1"># Lockout expired, reset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attempt</span><span class="p">:</span> <span class="n">AuthenticationAttempt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process authentication attempt with multiple factors.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_locked_out</span><span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">username</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;Account locked. Try again later.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;factors_verified&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">}</span>

        <span class="n">factors_verified</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">attempt</span><span class="o">.</span><span class="n">factors_provided</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_password</span><span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]):</span>
                    <span class="n">factors_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">POSSESSION</span><span class="p">:</span>
                <span class="c1"># In production: verify TOTP code</span>
                <span class="n">factors_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AuthFactor</span><span class="o">.</span><span class="n">POSSESSION</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">INHERENCE</span><span class="p">:</span>
                <span class="c1"># In production: verify biometric</span>
                <span class="n">factors_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AuthFactor</span><span class="o">.</span><span class="n">INHERENCE</span><span class="p">)</span>

        <span class="n">success</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">factors_verified</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>  <span class="c1"># Require at least 2 factors</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">success</span><span class="p">,</span>
            <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;MFA verified&quot;</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;Insufficient factors&quot;</span><span class="p">,</span>
            <span class="s2">&quot;factors_verified&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">factors_verified</span><span class="p">]</span>
        <span class="p">}</span>

<span class="c1"># Usage</span>
<span class="n">auth</span> <span class="o">=</span> <span class="n">SimpleAuthenticator</span><span class="p">()</span>
<span class="n">auth</span><span class="o">.</span><span class="n">register_user</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;correct-horse-battery-staple&quot;</span><span class="p">)</span>

<span class="c1"># Single factor - insufficient</span>
<span class="n">attempt_1fa</span> <span class="o">=</span> <span class="n">AuthenticationAttempt</span><span class="p">(</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span>
    <span class="n">factors_provided</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;correct-horse-battery-staple&quot;</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="n">ip_address</span><span class="o">=</span><span class="s2">&quot;192.168.1.100&quot;</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">attempt_1fa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1FA Result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># {&#39;success&#39;: False, &#39;reason&#39;: &#39;Insufficient factors&#39;, ...}</span>

<span class="c1"># Two factors - success</span>
<span class="n">attempt_2fa</span> <span class="o">=</span> <span class="n">AuthenticationAttempt</span><span class="p">(</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span>
    <span class="n">factors_provided</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;correct-horse-battery-staple&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">POSSESSION</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;123456&quot;</span><span class="p">}</span>  <span class="c1"># TOTP code</span>
    <span class="p">],</span>
    <span class="n">ip_address</span><span class="o">=</span><span class="s2">&quot;192.168.1.100&quot;</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">attempt_2fa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2FA Result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># {&#39;success&#39;: True, &#39;reason&#39;: &#39;MFA verified&#39;, ...}</span>
</code></pre></div>

<hr />
<h2 id="3-threat-modeling-with-stride">3. Threat Modeling with STRIDE<a class="header-link" href="#3-threat-modeling-with-stride" title="Permanent link">&para;</a></h2>
<p>STRIDE is a threat modeling framework developed at Microsoft. Each letter identifies a category of threat that maps to a specific security property violation.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        STRIDE Threat Model                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Threat         â”‚ Violates             â”‚ Example                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ S - Spoofing   â”‚ Authentication       â”‚ Fake login page,             â”‚
â”‚                â”‚                      â”‚ forged JWT token             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ T - Tampering  â”‚ Integrity            â”‚ Modified API request,        â”‚
â”‚                â”‚                      â”‚ SQL injection                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R - Repudiationâ”‚ Non-repudiation      â”‚ Denying a transaction,       â”‚
â”‚                â”‚                      â”‚ deleting logs                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ I - Informationâ”‚ Confidentiality      â”‚ Data leak, packet            â”‚
â”‚   Disclosure   â”‚                      â”‚ sniffing, error messages     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ D - Denial of  â”‚ Availability         â”‚ DDoS, resource               â”‚
â”‚   Service      â”‚                      â”‚ exhaustion, crash bugs       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ E - Elevation  â”‚ Authorization        â”‚ Privilege escalation,        â”‚
â”‚   of Privilege â”‚                      â”‚ path traversal               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="31-stride-analysis-process">3.1 STRIDE Analysis Process<a class="header-link" href="#31-stride-analysis-process" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Step 1: Decompose the system
         â”‚
         â–¼
Step 2: Create a Data Flow Diagram (DFD)
         â”‚
         â–¼
Step 3: Identify threats using STRIDE per element
         â”‚
         â–¼
Step 4: Rate and prioritize threats
         â”‚
         â–¼
Step 5: Plan mitigations
</code></pre></div>

<h3 id="32-data-flow-diagram-elements">3.2 Data Flow Diagram Elements<a class="header-link" href="#32-data-flow-diagram-elements" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DFD Element Types                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    External Entity (user, external system)         â”‚
â”‚  â”‚ Entity  â”‚    - Outside your trust boundary                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    - Source or destination of data                 â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Process (code that transforms data)             â”‚
â”‚  â”‚(Process)â”‚    - Your application logic                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    - APIs, services, functions                     â”‚
â”‚                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•    Data Store (database, file, cache)              â”‚
â”‚  â•‘ Store   â•‘    - Where data persists                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•    - Databases, files, queues                      â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    Data Flow (data moving between elements)        â”‚
â”‚                 - HTTP requests, API calls, file reads           â”‚
â”‚                                                                 â”‚
â”‚  - - - - - -    Trust Boundary                                  â”‚
â”‚  |          |   - Separates different trust levels               â”‚
â”‚  - - - - - -    - Network boundary, process boundary            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="33-example-threat-model-for-a-web-application">3.3 Example: Threat Model for a Web Application<a class="header-link" href="#33-example-threat-model-for-a-web-application" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Web Application DFD                                  â”‚
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         HTTPS          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚  Browser â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Web Server  â”‚              â”‚
â”‚   â”‚  (User)  â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (Nginx)     â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                               â”‚                      â”‚
â”‚   - - - - - - - - - - - - - - - - - - - - - -â”‚- - - - - - - - - -  â”‚
â”‚   â”‚         Trust Boundary (DMZ â†’ Internal)   â”‚                  â”‚  â”‚
â”‚   - - - - - - - - - - - - - - - - - - - - - -â”‚- - - - - - - - - -  â”‚
â”‚                                               â”‚                      â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                                        â”‚  App Server  â”‚             â”‚
â”‚                                        â”‚  (Flask/     â”‚             â”‚
â”‚                                        â”‚   Django)    â”‚             â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                               â”‚                      â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                               â”‚               â”‚               â”‚     â”‚
â”‚                        â•â•â•â•â•â•â•â–¼â•â•â•â•â•â•â• â•â•â•â•â•â•â•â–¼â•â•â•â•â•â•â• â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”‚
â”‚                        â•‘  PostgreSQL â•‘ â•‘   Redis     â•‘ â”‚ Externalâ”‚  â”‚
â”‚                        â•‘  (Users,   â•‘ â•‘   (Sessions,â•‘ â”‚ Payment â”‚  â”‚
â”‚                        â•‘   Orders)  â•‘ â•‘   Cache)    â•‘ â”‚ API     â”‚  â”‚
â”‚                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>Now apply STRIDE to each element:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Threat</span><span class="p">:</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>       <span class="c1"># S, T, R, I, D, or E</span>
    <span class="n">element</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># Which DFD element</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>    <span class="c1"># What could go wrong</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>       <span class="c1"># Critical, High, Medium, Low</span>
    <span class="n">mitigation</span><span class="p">:</span> <span class="nb">str</span>     <span class="c1"># How to prevent it</span>

<span class="k">def</span><span class="w"> </span><span class="nf">stride_analysis</span><span class="p">(</span><span class="n">system_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Threat</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Example STRIDE analysis for a web application.&quot;&quot;&quot;</span>
    <span class="n">threats</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1"># Spoofing threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Spoofing&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Browser â†’ Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Attacker impersonates a legitimate user with &quot;</span>
                        <span class="s2">&quot;stolen credentials or forged session tokens&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Implement MFA, use short-lived JWTs, &quot;</span>
                       <span class="s2">&quot;enforce strong password policies&quot;</span>
        <span class="p">),</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Spoofing&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;App Server â†’ Payment API&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Attacker intercepts and replays API calls &quot;</span>
                        <span class="s2">&quot;to the payment processor&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Use mutual TLS (mTLS), API key rotation, &quot;</span>
                       <span class="s2">&quot;request signing with timestamps&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Tampering threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Tampering&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Browser â†’ Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Attacker modifies request parameters to change &quot;</span>
                        <span class="s2">&quot;order amounts or access other users&#39; data&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Server-side validation, HMAC on critical parameters, &quot;</span>
                       <span class="s2">&quot;parameterized queries&quot;</span>
        <span class="p">),</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Tampering&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;PostgreSQL&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;SQL injection allows attacker to modify database &quot;</span>
                        <span class="s2">&quot;records directly&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Prepared statements, ORM usage, input sanitization, &quot;</span>
                       <span class="s2">&quot;database-level access controls&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Repudiation threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Repudiation&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;App Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;User denies making a purchase; no audit trail exists&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Comprehensive audit logging with timestamps, &quot;</span>
                       <span class="s2">&quot;digital signatures on transactions&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Information Disclosure threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Information Disclosure&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Verbose error messages reveal stack traces, &quot;</span>
                        <span class="s2">&quot;database schema, or internal IPs&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Custom error pages, structured logging &quot;</span>
                       <span class="s2">&quot;(not exposed to clients), security headers&quot;</span>
        <span class="p">),</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Information Disclosure&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Redis&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Session data stored in Redis without encryption &quot;</span>
                        <span class="s2">&quot;is readable if Redis is compromised&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Encrypt session data, enable Redis AUTH, &quot;</span>
                       <span class="s2">&quot;network isolation for Redis&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Denial of Service threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Denial of Service&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Volumetric DDoS attack overwhelms the web server&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;CDN/WAF (e.g., Cloudflare), rate limiting, &quot;</span>
                       <span class="s2">&quot;auto-scaling infrastructure&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Elevation of Privilege threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Elevation of Privilege&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;App Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Regular user accesses admin endpoints due to &quot;</span>
                        <span class="s2">&quot;missing authorization checks (IDOR/broken access control)&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;RBAC enforcement on every endpoint, &quot;</span>
                       <span class="s2">&quot;automated authorization testing&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">threats</span>

<span class="c1"># Run analysis</span>
<span class="n">threats</span> <span class="o">=</span> <span class="n">stride_analysis</span><span class="p">(</span><span class="s2">&quot;E-Commerce Web App&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;STRIDE Analysis: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">threats</span><span class="p">)</span><span class="si">}</span><span class="s2"> threats identified</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Summary by category</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="n">by_category</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">category</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threats</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">by_category</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">cat</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> threats&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Critical threats</span>
<span class="n">critical</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threats</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="s2">&quot;Critical&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Critical threats (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">critical</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">critical</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">element</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Risk: </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Fix:  </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">mitigation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4-risk-scoring-with-dread">4. Risk Scoring with DREAD<a class="header-link" href="#4-risk-scoring-with-dread" title="Permanent link">&para;</a></h2>
<p>DREAD provides a numerical scoring system for prioritizing threats. Each factor is rated 1-10.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                      </span><span class="n">DREAD</span><span class="w"> </span><span class="n">Scoring</span><span class="w"> </span><span class="n">Model</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Factor</span><span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Question</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Damage</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="n">How</span><span class="w"> </span><span class="n">bad</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">be</span><span class="err">?</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trivial</span><span class="w">  </span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">compromise</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Reproducibil</span><span class="o">.</span><span class="err">â”‚</span><span class="w"> </span><span class="n">How</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reproduce</span><span class="err">?</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">hard</span><span class="w">  </span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">reproducible</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Exploitab</span><span class="o">.</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">How</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">effort</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">launch</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">attack</span><span class="err">?</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expert</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">tools</span><span class="w">  </span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">browser</span><span class="w"> </span><span class="n">only</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Affected</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">How</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">impacted</span><span class="err">?</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">   </span><span class="n">Users</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">user</span><span class="w">  </span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">users</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Discoverab</span><span class="o">.</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">How</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vulnerability</span><span class="err">?</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">code</span><span class="w">  </span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obvious</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">URL</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="n">DREAD</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">D</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">5</span>

<span class="n">Rating</span><span class="p">:</span><span class="w">    </span><span class="mi">1</span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Low</span><span class="w">    </span><span class="mi">4</span><span class="o">-</span><span class="mi">6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Medium</span><span class="w">    </span><span class="mi">7</span><span class="o">-</span><span class="mi">9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">High</span><span class="w">    </span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Critical</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DREADScore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DREAD risk scoring for a vulnerability.&quot;&quot;&quot;</span>
    <span class="n">vulnerability</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">damage</span><span class="p">:</span> <span class="nb">int</span>          <span class="c1"># 1-10</span>
    <span class="n">reproducibility</span><span class="p">:</span> <span class="nb">int</span> <span class="c1"># 1-10</span>
    <span class="n">exploitability</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># 1-10</span>
    <span class="n">affected_users</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># 1-10</span>
    <span class="n">discoverability</span><span class="p">:</span> <span class="nb">int</span> <span class="c1"># 1-10</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">damage</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">reproducibility</span> <span class="o">+</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">exploitability</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_users</span> <span class="o">+</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">discoverability</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">total</span> <span class="o">/</span> <span class="mi">5</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rating</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;CRITICAL&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HIGH&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;MEDIUM&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;LOW&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vulnerability</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;  D=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">damage</span><span class="si">}</span><span class="s2"> R=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reproducibility</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;E=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exploitability</span><span class="si">}</span><span class="s2"> A=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">affected_users</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;D=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">discoverability</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;  Score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rating</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

<span class="c1"># Score several vulnerabilities</span>
<span class="n">vulns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;SQL Injection in login form&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">8</span>
    <span class="p">),</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;Missing rate limiting on password reset&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">7</span>
    <span class="p">),</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;XSS in user profile bio field&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">),</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;Cleartext password in debug log&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Sort by score descending</span>
<span class="n">vulns</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DREAD Vulnerability Ranking&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vulns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">#</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5-attack-surfaces-and-threat-vectors">5. Attack Surfaces and Threat Vectors<a class="header-link" href="#5-attack-surfaces-and-threat-vectors" title="Permanent link">&para;</a></h2>
<h3 id="51-what-is-an-attack-surface">5.1 What Is an Attack Surface?<a class="header-link" href="#51-what-is-an-attack-surface" title="Permanent link">&para;</a></h3>
<p>The attack surface is the sum of all points where an attacker can try to enter or extract data from a system.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">Attack</span><span class="w"> </span><span class="n">Surface</span><span class="w"> </span><span class="n">Categories</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Network</span><span class="w"> </span><span class="n">Attack</span><span class="w"> </span><span class="n">Surface</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Open</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">services</span><span class="w"> </span><span class="p">(</span><span class="n">SSH</span><span class="p">,</span><span class="w"> </span><span class="n">HTTP</span><span class="p">,</span><span class="w"> </span><span class="n">SMTP</span><span class="p">)</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="n">endpoints</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">DNS</span><span class="w"> </span><span class="n">configuration</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Network</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="p">(</span><span class="n">TCP</span><span class="p">,</span><span class="w"> </span><span class="n">UDP</span><span class="p">,</span><span class="w"> </span><span class="n">ICMP</span><span class="p">)</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Software</span><span class="w"> </span><span class="n">Attack</span><span class="w"> </span><span class="n">Surface</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Web</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="p">(</span><span class="n">forms</span><span class="p">,</span><span class="w"> </span><span class="n">URLs</span><span class="p">,</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="n">cookies</span><span class="p">)</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">upload</span><span class="w"> </span><span class="n">functionality</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Third</span><span class="o">-</span><span class="n">party</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="p">(</span><span class="n">npm</span><span class="p">,</span><span class="w"> </span><span class="n">pip</span><span class="w"> </span><span class="n">packages</span><span class="p">)</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Database</span><span class="w"> </span><span class="n">interfaces</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">IPC</span><span class="w"> </span><span class="n">mechanisms</span><span class="w"> </span><span class="p">(</span><span class="n">pipes</span><span class="p">,</span><span class="w"> </span><span class="n">sockets</span><span class="p">,</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">memory</span><span class="p">)</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Physical</span><span class="w"> </span><span class="n">Attack</span><span class="w"> </span><span class="n">Surface</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">USB</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">servers</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Physical</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">centers</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Removable</span><span class="w"> </span><span class="n">media</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Hardware</span><span class="w"> </span><span class="n">implants</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Human</span><span class="w"> </span><span class="n">Attack</span><span class="w"> </span><span class="n">Surface</span><span class="w">                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Phishing</span><span class="w"> </span><span class="n">targets</span><span class="w"> </span><span class="p">(</span><span class="n">employees</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">access</span><span class="p">)</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Social</span><span class="w"> </span><span class="n">engineering</span><span class="w"> </span><span class="p">(</span><span class="n">help</span><span class="w"> </span><span class="n">desk</span><span class="p">,</span><span class="w"> </span><span class="n">support</span><span class="p">)</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Insider</span><span class="w"> </span><span class="n">threats</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Third</span><span class="o">-</span><span class="n">party</span><span class="w"> </span><span class="n">vendors</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">contractors</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                     </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="52-attack-surface-enumeration">5.2 Attack Surface Enumeration<a class="header-link" href="#52-attack-surface-enumeration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SurfaceType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">NETWORK</span> <span class="o">=</span> <span class="s2">&quot;network&quot;</span>
    <span class="n">SOFTWARE</span> <span class="o">=</span> <span class="s2">&quot;software&quot;</span>
    <span class="n">PHYSICAL</span> <span class="o">=</span> <span class="s2">&quot;physical&quot;</span>
    <span class="n">HUMAN</span> <span class="o">=</span> <span class="s2">&quot;human&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RiskLevel</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AttackSurfaceEntry</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">surface_type</span><span class="p">:</span> <span class="n">SurfaceType</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">risk_level</span><span class="p">:</span> <span class="n">RiskLevel</span>
    <span class="n">exposed_to</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># Who can reach this?</span>
    <span class="n">current_controls</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">recommendations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AttackSurfaceReport</span><span class="p">:</span>
    <span class="n">system_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">entries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AttackSurfaceEntry</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">AttackSurfaceEntry</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="n">by_type</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">by_risk</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">by_type</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">surface_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">by_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">surface_type</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">by_risk</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">by_risk</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;by_type&quot;</span><span class="p">:</span> <span class="n">by_type</span><span class="p">,</span> <span class="s2">&quot;by_risk&quot;</span><span class="p">:</span> <span class="n">by_risk</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attack Surface Report: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">system_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total attack surface entries: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;By type: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;by_type&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;By risk: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;by_risk&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Show critical/high items</span>
        <span class="n">urgent</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span>
                  <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">RiskLevel</span><span class="o">.</span><span class="n">HIGH</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">urgent</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">High/Critical Items (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">urgent</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">urgent</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">surface_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">recommendations</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Recommendation: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">recommendations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Build an attack surface report</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">AttackSurfaceReport</span><span class="p">(</span><span class="s2">&quot;Corporate Web Portal&quot;</span><span class="p">)</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Public API (port 443)&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">NETWORK</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;REST API serving 50+ endpoints to internet&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Internet&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WAF&quot;</span><span class="p">,</span> <span class="s2">&quot;Rate limiting&quot;</span><span class="p">,</span> <span class="s2">&quot;JWT auth&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Add API gateway with stricter rate limits&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Admin panel (/admin)&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">SOFTWARE</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Django admin interface accessible on same domain&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Internet (by misconfiguration)&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Username/password&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Restrict to VPN only&quot;</span><span class="p">,</span> <span class="s2">&quot;Add MFA&quot;</span><span class="p">,</span> <span class="s2">&quot;Separate domain&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;npm dependencies (347 packages)&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">SOFTWARE</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Third-party JavaScript packages in frontend build&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Supply chain&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;npm audit in CI&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pin dependency versions&quot;</span><span class="p">,</span> <span class="s2">&quot;Use lockfile&quot;</span><span class="p">,</span> <span class="s2">&quot;Add Snyk/Dependabot&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Employee email accounts&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">HUMAN</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;150 employees with corporate email, potential phishing targets&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Internet (email)&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Spam filter&quot;</span><span class="p">,</span> <span class="s2">&quot;Annual security training&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Quarterly phishing simulations&quot;</span><span class="p">,</span> <span class="s2">&quot;DMARC/DKIM enforcement&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">print_report</span><span class="p">()</span>
</code></pre></div>

<h3 id="53-common-threat-vectors">5.3 Common Threat Vectors<a class="header-link" href="#53-common-threat-vectors" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                      </span><span class="nx">Common</span><span class="w"> </span><span class="nx">Threat</span><span class="w"> </span><span class="nx">Vectors</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Vector</span><span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Description</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">Examples</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Network</span><span class="o">-</span><span class="nx">based</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Port</span><span class="w"> </span><span class="nx">scanning</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">exploitation</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Man</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="nx">the</span><span class="o">-</span><span class="nx">middle</span><span class="w"> </span><span class="nx">attacks</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">DNS</span><span class="w"> </span><span class="nx">spoofing</span><span class="o">/</span><span class="nx">poisoning</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">ARP</span><span class="w"> </span><span class="nx">spoofing</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Web</span><span class="w"> </span><span class="nx">application</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">injection</span><span class="w"> </span><span class="p">(</span><span class="nx">SQLi</span><span class="p">)</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Cross</span><span class="o">-</span><span class="nx">site</span><span class="w"> </span><span class="nx">scripting</span><span class="w"> </span><span class="p">(</span><span class="nx">XSS</span><span class="p">)</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Cross</span><span class="o">-</span><span class="nx">site</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="nx">forgery</span><span class="w"> </span><span class="p">(</span><span class="nx">CSRF</span><span class="p">)</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Server</span><span class="o">-</span><span class="nx">side</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="nx">forgery</span><span class="w"> </span><span class="p">(</span><span class="nx">SSRF</span><span class="p">)</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Insecure</span><span class="w"> </span><span class="nx">direct</span><span class="w"> </span><span class="nx">object</span><span class="w"> </span><span class="nx">references</span><span class="w"> </span><span class="p">(</span><span class="nx">IDOR</span><span class="p">)</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Supply</span><span class="w"> </span><span class="nx">chain</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Compromised</span><span class="w"> </span><span class="nx">dependencies</span><span class="w"> </span><span class="p">(</span><span class="nx">SolarWinds</span><span class="p">,</span><span class="w"> </span><span class="nx">log4j</span><span class="p">)</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Typosquatting</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kn">package</span><span class="w"> </span><span class="nx">registries</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Malicious</span><span class="w"> </span><span class="nx">code</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">build</span><span class="w"> </span><span class="nx">pipelines</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Social</span><span class="w"> </span><span class="nx">engineer</span><span class="p">.</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Phishing</span><span class="w"> </span><span class="p">(</span><span class="nx">email</span><span class="p">,</span><span class="w"> </span><span class="nx">SMS</span><span class="p">,</span><span class="w"> </span><span class="nx">voice</span><span class="p">)</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Pretexting</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">baiting</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Tailgating</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">piggybacking</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Physical</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">USB</span><span class="w"> </span><span class="nx">drop</span><span class="w"> </span><span class="nx">attacks</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Evil</span><span class="w"> </span><span class="nx">maid</span><span class="w"> </span><span class="nx">attacks</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Hardware</span><span class="w"> </span><span class="nx">implants</span><span class="w">                              </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Insider</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Disgruntled</span><span class="w"> </span><span class="nx">employees</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Accidental</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="nx">exposure</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â€¢</span><span class="w"> </span><span class="nx">Credential</span><span class="w"> </span><span class="nx">sharing</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="6-defense-in-depth">6. Defense in Depth<a class="header-link" href="#6-defense-in-depth" title="Permanent link">&para;</a></h2>
<p>Defense in depth is a strategy that employs multiple layers of security controls throughout an information system. If one layer fails, subsequent layers continue to provide protection.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Defense in Depth Layers                            â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Layer 7: DATA                                               â”‚    â”‚
â”‚  â”‚  Encryption at rest, DLP, data classification, backups       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Layer 6: APPLICATION                                â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Input validation, WAF, secure coding, SAST/DAST     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Layer 5: HOST                               â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  OS hardening, AV/EDR, patching, FIM         â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Layer 4: INTERNAL NETWORK           â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Segmentation, VLAN, IDS/IPS, NTA    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Layer 3: PERIMETER          â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Firewalls, DMZ, VPN, proxy  â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Layer 2: PHYSICAL   â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Guards, locks, CCTV â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Layer 1:    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ POLICIES    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ &amp; TRAINING  â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="61-implementing-layered-security">6.1 Implementing Layered Security<a class="header-link" href="#61-implementing-layered-security" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SecurityAction</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">ALLOW</span> <span class="o">=</span> <span class="s2">&quot;ALLOW&quot;</span>
    <span class="n">BLOCK</span> <span class="o">=</span> <span class="s2">&quot;BLOCK&quot;</span>
    <span class="n">LOG</span> <span class="o">=</span> <span class="s2">&quot;LOG&quot;</span>
    <span class="n">ALERT</span> <span class="o">=</span> <span class="s2">&quot;ALERT&quot;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityEvent</span><span class="p">:</span>
    <span class="n">source_ip</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">request_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">headers</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="n">body</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">blocked_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">actions_taken</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single layer in the defense-in-depth chain.&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">order</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">check</span><span class="p">:</span> <span class="n">Callable</span>  <span class="c1"># Function that returns (SecurityAction, reason)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DefenseInDepth</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Chain of security layers processed in order.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SecurityLayer</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">:</span> <span class="n">SecurityLayer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SecurityEvent</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process an event through all security layers.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
            <span class="n">action</span><span class="p">,</span> <span class="n">reason</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">actions_taken</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">blocked_by</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span>
                <span class="k">return</span> <span class="n">event</span>

        <span class="k">return</span> <span class="n">event</span>

<span class="c1"># Define security layers as check functions</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rate_limiter</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 1: Rate limiting (perimeter).&quot;&quot;&quot;</span>
    <span class="c1"># Simplified - in production, track request counts per IP</span>
    <span class="n">suspicious_ips</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;10.0.0.99&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.1.200&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">source_ip</span> <span class="ow">in</span> <span class="n">suspicious_ips</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;IP </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">source_ip</span><span class="si">}</span><span class="s2"> rate limited&quot;</span>
    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;Rate check passed&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">waf_check</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 2: Web Application Firewall.&quot;&quot;&quot;</span>
    <span class="c1"># Check for common attack patterns</span>
    <span class="n">sqli_patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">r</span><span class="s2">&quot;(\b(union|select|insert|update|delete|drop)\b.*\b(from|into|table)\b)&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;(--|#|/\*)&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;(\bor\b\s+\b\d+\b\s*=\s*\b\d+\b)&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">xss_patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">r</span><span class="s2">&quot;&lt;script[^&gt;]*&gt;&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;javascript:&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;on(load|error|click)\s*=&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">full_input</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">request_path</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">sqli_patterns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">full_input</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;SQLi pattern detected: </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">xss_patterns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">full_input</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;XSS pattern detected: </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;WAF check passed&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">auth_check</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 3: Authentication verification.&quot;&quot;&quot;</span>
    <span class="n">auth_header</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Authorization&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_header</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">request_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/api/&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="s2">&quot;Missing authentication for API endpoint&quot;</span>
    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;Auth check passed&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">input_validation</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 4: Application-level input validation.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="s2">&quot;Request body exceeds maximum size&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;../&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">request_path</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="s2">&quot;Path traversal attempt detected&quot;</span>
    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;Input validation passed&quot;</span>

<span class="c1"># Assemble defense layers</span>
<span class="n">defense</span> <span class="o">=</span> <span class="n">DefenseInDepth</span><span class="p">()</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;Rate Limiter&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rate_limiter</span><span class="p">))</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;WAF&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">waf_check</span><span class="p">))</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;Auth Check&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">auth_check</span><span class="p">))</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;Input Validation&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">input_validation</span><span class="p">))</span>

<span class="c1"># Test with various events</span>
<span class="n">events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">SecurityEvent</span><span class="p">(</span>
        <span class="n">source_ip</span><span class="o">=</span><span class="s2">&quot;203.0.113.50&quot;</span><span class="p">,</span>
        <span class="n">request_path</span><span class="o">=</span><span class="s2">&quot;/api/users/1&quot;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer eyJ...&quot;</span><span class="p">},</span>
        <span class="n">body</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="p">),</span>
    <span class="n">SecurityEvent</span><span class="p">(</span>
        <span class="n">source_ip</span><span class="o">=</span><span class="s2">&quot;203.0.113.51&quot;</span><span class="p">,</span>
        <span class="n">request_path</span><span class="o">=</span><span class="s2">&quot;/api/users&quot;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer eyJ...&quot;</span><span class="p">},</span>
        <span class="n">body</span><span class="o">=</span><span class="s2">&quot;name=test&#39; OR 1=1 --&quot;</span>
    <span class="p">),</span>
    <span class="n">SecurityEvent</span><span class="p">(</span>
        <span class="n">source_ip</span><span class="o">=</span><span class="s2">&quot;203.0.113.52&quot;</span><span class="p">,</span>
        <span class="n">request_path</span><span class="o">=</span><span class="s2">&quot;/api/files/../../../etc/passwd&quot;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer eyJ...&quot;</span><span class="p">},</span>
        <span class="n">body</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">defense</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;BLOCKED&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">blocked_by</span> <span class="k">else</span> <span class="s2">&quot;ALLOWED&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Event #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">request_path</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">actions_taken</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">blocked_by</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &gt;&gt;&gt; Blocked by: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">blocked_by</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7-principle-of-least-privilege">7. Principle of Least Privilege<a class="header-link" href="#7-principle-of-least-privilege" title="Permanent link">&para;</a></h2>
<p>The principle of least privilege (PoLP) states that every module, user, or process should operate using only the minimum set of privileges necessary to complete its task.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">              </span><span class="n">Principle</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Least</span><span class="w"> </span><span class="n">Privilege</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Examples</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">BAD</span><span class="w"> </span><span class="p">(</span><span class="n">Over</span><span class="o">-</span><span class="n">privileged</span><span class="p">):</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Web</span><span class="w"> </span><span class="n">App</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Account</span><span class="w">                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">DB</span><span class="p">:</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="p">(</span><span class="n">can</span><span class="w"> </span><span class="n">DROP</span><span class="w"> </span><span class="n">DATABASE</span><span class="p">)</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Files</span><span class="p">:</span><span class="w"> </span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">filesystem</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Network</span><span class="p">:</span><span class="w"> </span><span class="n">unrestricted</span><span class="w"> </span><span class="n">outbound</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Processes</span><span class="p">:</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">spawn</span><span class="w"> </span><span class="n">anything</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">root</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">GOOD</span><span class="w"> </span><span class="p">(</span><span class="n">Least</span><span class="w"> </span><span class="n">privilege</span><span class="p">):</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Web</span><span class="w"> </span><span class="n">App</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Account</span><span class="w">                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">DB</span><span class="p">:</span><span class="w"> </span><span class="n">SELECT</span><span class="p">,</span><span class="w"> </span><span class="n">INSERT</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">app_db</span><span class="o">.</span><span class="n">users</span><span class="p">,</span><span class="w"> </span><span class="n">app_db</span><span class="o">.</span><span class="n">orders</span><span class="w"> </span><span class="n">only</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Files</span><span class="p">:</span><span class="w"> </span><span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="w"> </span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="k">static</span><span class="p">,</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">uploads</span><span class="w"> </span><span class="n">only</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">Network</span><span class="p">:</span><span class="w"> </span><span class="n">outbound</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">payment</span><span class="o">-</span><span class="n">api</span><span class="o">.</span><span class="n">internal</span><span class="p">:</span><span class="mi">443</span><span class="w">      </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="n">Processes</span><span class="p">:</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">unprivileged</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">(</span><span class="n">uid</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w">         </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="71-least-privilege-in-database-access">7.1 Least Privilege in Database Access<a class="header-link" href="#71-least-privilege-in-database-access" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- BAD: Application uses root/superuser</span>
<span class="c1">-- GRANT ALL PRIVILEGES ON *.* TO &#39;webapp&#39;@&#39;%&#39;;</span>

<span class="c1">-- GOOD: Granular permissions per function</span>
<span class="c1">-- Read-only user for reporting</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;strong_random_pw&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">users</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">orders</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">products</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>

<span class="c1">-- Write user for the application (limited tables and operations)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;another_strong_pw&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">users</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">orders</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">products</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="c1">-- Note: No DELETE, no DROP, no ALTER, no access to other databases</span>

<span class="c1">-- Admin user (separate account, not used by the application)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;db_admin&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.1&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;very_strong_admin_pw&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;db_admin&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.1&#39;</span><span class="p">;</span>
<span class="c1">-- Only accessible from a single bastion host IP</span>
</code></pre></div>

<h3 id="72-least-privilege-in-code">7.2 Least Privilege in Code<a class="header-link" href="#72-least-privilege-in-code" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SandboxedFileAccess</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enforce least privilege for file system access.&quot;&quot;&quot;</span>
    <span class="n">allowed_read_dirs</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">allowed_write_dirs</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">max_file_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># 10 MB default</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_within_allowed_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">dirs</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a resolved path falls within allowed directories.&quot;&quot;&quot;</span>
        <span class="n">resolved</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">resolved</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a file only if it&#39;s within allowed read directories.&quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="c1"># Prevent path traversal</span>
        <span class="k">if</span> <span class="s2">&quot;..&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path traversal not allowed: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_within_allowed_dirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_read_dirs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Read access denied: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2"> is outside allowed directories&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a file only if it&#39;s within allowed write directories.&quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;..&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path traversal not allowed: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_within_allowed_dirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_write_dirs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Write access denied: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2"> is outside allowed directories&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_file_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;File size </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="si">}</span><span class="s2"> exceeds max </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_file_size</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># Usage: application can only read from /app/config and write to /app/uploads</span>
<span class="n">sandbox</span> <span class="o">=</span> <span class="n">SandboxedFileAccess</span><span class="p">(</span>
    <span class="n">allowed_read_dirs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/app/config&quot;</span><span class="p">,</span> <span class="s2">&quot;/app/static&quot;</span><span class="p">],</span>
    <span class="n">allowed_write_dirs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/app/uploads&quot;</span><span class="p">],</span>
    <span class="n">max_file_size</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># 5 MB</span>
<span class="p">)</span>

<span class="c1"># This would succeed (within allowed read directory)</span>
<span class="c1"># content = sandbox.read_file(&quot;/app/config/settings.json&quot;)</span>

<span class="c1"># This would raise PermissionError (outside allowed directories)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">sandbox</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">PermissionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Blocked: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># This would raise PermissionError (path traversal attempt)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">sandbox</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;/app/config/../../etc/shadow&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">PermissionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Blocked: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="73-least-privilege-in-cloud-aws-iam-example">7.3 Least Privilege in Cloud (AWS IAM Example)<a class="header-link" href="#73-least-privilege-in-cloud-aws-iam-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Statement&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AllowS3ReadSpecificBucket&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;s3:GetObject&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;s3:ListBucket&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads/*&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AllowDynamoDBReadWrite&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;dynamodb:GetItem&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;dynamodb:PutItem&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;dynamodb:Query&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:dynamodb:us-east-1:123456789:table/users&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DenyAllElse&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Deny&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;NotResource&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads/*&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:dynamodb:us-east-1:123456789:table/users&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="8-security-by-design-vs-security-by-obscurity">8. Security by Design vs Security by Obscurity<a class="header-link" href="#8-security-by-design-vs-security-by-obscurity" title="Permanent link">&para;</a></h2>
<h3 id="81-security-by-design">8.1 Security by Design<a class="header-link" href="#81-security-by-design" title="Permanent link">&para;</a></h3>
<p>Security by design means building security into the system from the start, rather than adding it as an afterthought.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nx">Security</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">Design</span><span class="w"> </span><span class="nx">Principles</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Minimize</span><span class="w"> </span><span class="nx">Attack</span><span class="w"> </span><span class="nx">Surface</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Remove</span><span class="w"> </span><span class="nx">unnecessary</span><span class="w"> </span><span class="nx">features</span><span class="p">,</span><span class="w"> </span><span class="nx">ports</span><span class="p">,</span><span class="w"> </span><span class="nx">services</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Establish</span><span class="w"> </span><span class="nx">Secure</span><span class="w"> </span><span class="nx">Defaults</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">configuration</span><span class="w"> </span><span class="nx">should</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">most</span><span class="w"> </span><span class="nx">secure</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Principle</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">Least</span><span class="w"> </span><span class="nx">Privilege</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Grant</span><span class="w"> </span><span class="nx">minimum</span><span class="w"> </span><span class="nx">access</span><span class="w"> </span><span class="nx">needed</span><span class="w">                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="nx">Defense</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">Depth</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Multiple</span><span class="w"> </span><span class="nx">independent</span><span class="w"> </span><span class="nx">layers</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">security</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">5</span><span class="p">.</span><span class="w"> </span><span class="nx">Fail</span><span class="w"> </span><span class="nx">Securely</span><span class="w">                                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Errors</span><span class="w"> </span><span class="nx">should</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">create</span><span class="w"> </span><span class="nx">security</span><span class="w"> </span><span class="nx">holes</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">6</span><span class="p">.</span><span class="w"> </span><span class="nx">Don</span><span class="err">&#39;</span><span class="nx">t</span><span class="w"> </span><span class="nx">Trust</span><span class="w"> </span><span class="nx">Services</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Validate</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="kd">external</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">responses</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">7</span><span class="p">.</span><span class="w"> </span><span class="nx">Separation</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">Duties</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">single</span><span class="w"> </span><span class="nx">person</span><span class="o">/</span><span class="nx">process</span><span class="w"> </span><span class="nx">controls</span><span class="w"> </span><span class="nx">everything</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">8</span><span class="p">.</span><span class="w"> </span><span class="nx">Keep</span><span class="w"> </span><span class="nx">Security</span><span class="w"> </span><span class="nx">Simple</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Complex</span><span class="w"> </span><span class="nx">security</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">often</span><span class="w"> </span><span class="nx">bypassed</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">misconfigured</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">9</span><span class="p">.</span><span class="w"> </span><span class="nx">Fix</span><span class="w"> </span><span class="nx">Issues</span><span class="w"> </span><span class="nx">Correctly</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="nx">Address</span><span class="w"> </span><span class="nx">root</span><span class="w"> </span><span class="nx">causes</span><span class="p">,</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">symptoms</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<p><strong>Kerckhoffs' Principle (1883):</strong> A cryptographic system should be secure even if everything about the system, except the key, is public knowledge. This is the gold standard for security by design.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Security by Design: Fail-secure examples</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_user_role</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fail-secure: if anything goes wrong, return the most restrictive role.</span>
<span class="sd">    Never fail into a privileged state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">user</span><span class="o">.</span><span class="n">role</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">user</span><span class="o">.</span><span class="n">role</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Log this in production</span>

    <span class="c1"># Fail secure: default to no access</span>
    <span class="k">return</span> <span class="s2">&quot;none&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_authorized</span><span class="p">(</span><span class="n">user_role</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">required_role</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Security by design: explicit allowlist, not blocklist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">role_hierarchy</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;admin&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;editor&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;viewer&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;none&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Unknown roles get no access (fail secure)</span>
    <span class="n">user_level</span> <span class="o">=</span> <span class="n">role_hierarchy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_role</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">required_level</span> <span class="o">=</span> <span class="n">role_hierarchy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">required_role</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">user_level</span> <span class="o">&gt;=</span> <span class="n">required_level</span>


<span class="c1"># Secure defaults in configuration</span>
<span class="n">SECURE_DEFAULTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;session_timeout_minutes&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>       <span class="c1"># Short timeout</span>
    <span class="s2">&quot;max_login_attempts&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>             <span class="c1"># Lockout after failures</span>
    <span class="s2">&quot;password_min_length&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>           <span class="c1"># Strong passwords</span>
    <span class="s2">&quot;require_mfa&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>                 <span class="c1"># MFA on by default</span>
    <span class="s2">&quot;cors_origins&quot;</span><span class="p">:</span> <span class="p">[],</span>                  <span class="c1"># No CORS by default (deny all)</span>
    <span class="s2">&quot;debug_mode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>                 <span class="c1"># Never expose debug info</span>
    <span class="s2">&quot;tls_min_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2&quot;</span><span class="p">,</span>           <span class="c1"># No legacy TLS</span>
    <span class="s2">&quot;cookie_secure&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>               <span class="c1"># HTTPS-only cookies</span>
    <span class="s2">&quot;cookie_httponly&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>             <span class="c1"># No JS access to cookies</span>
    <span class="s2">&quot;cookie_samesite&quot;</span><span class="p">:</span> <span class="s2">&quot;Strict&quot;</span><span class="p">,</span>         <span class="c1"># Prevent CSRF</span>
    <span class="s2">&quot;content_security_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;default-src &#39;self&#39;&quot;</span><span class="p">,</span>  <span class="c1"># Strict CSP</span>
    <span class="s2">&quot;x_frame_options&quot;</span><span class="p">:</span> <span class="s2">&quot;DENY&quot;</span><span class="p">,</span>           <span class="c1"># Prevent clickjacking</span>
    <span class="s2">&quot;hsts_max_age&quot;</span><span class="p">:</span> <span class="mi">31536000</span><span class="p">,</span>           <span class="c1"># 1 year HSTS</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="82-security-by-obscurity-and-why-it-fails">8.2 Security by Obscurity (and Why It Fails)<a class="header-link" href="#82-security-by-obscurity-and-why-it-fails" title="Permanent link">&para;</a></h3>
<p>Security by obscurity relies on secrecy of the implementation rather than the soundness of the design. It is not a valid security strategy on its own.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">          </span><span class="n">Security</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">Obscurity</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Common</span><span class="w"> </span><span class="p">(</span><span class="n">Bad</span><span class="p">)</span><span class="w"> </span><span class="n">Examples</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="s2">&quot;Nobody will find our admin panel at /xK9mQ2p&quot;</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="n">Trivially</span><span class="w"> </span><span class="n">discovered</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">brute</span><span class="o">-</span><span class="n">forcing</span><span class="p">,</span><span class="w"> </span><span class="n">logs</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="n">browser</span><span class="w"> </span><span class="n">history</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="s2">&quot;Our custom encryption algorithm is secret, so it&#39;s secure&quot;</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="n">Reverse</span><span class="o">-</span><span class="n">engineered</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">leaked</span><span class="p">;</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">review</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">bugs</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="s2">&quot;We hide the server version headers&quot;</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="n">Fingerprinting</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">identifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">software</span><span class="w">            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="s2">&quot;Our database port is 54321 instead of 5432&quot;</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="n">Port</span><span class="w"> </span><span class="n">scanners</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="mi">65535</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">seconds</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="s2">&quot;API keys are embedded in minified JavaScript&quot;</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="err">â†’</span><span class="w"> </span><span class="n">Browser</span><span class="w"> </span><span class="n">devtools</span><span class="w"> </span><span class="n">expose</span><span class="w"> </span><span class="n">everything</span><span class="w"> </span><span class="n">instantly</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">Obscurity</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">SUPPLEMENTARY</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="p">(</span><span class="n">defense</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">depth</span><span class="p">)</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">but</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">NEVER</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">PRIMARY</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">mechanism</span><span class="o">.</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Examples</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">obscurity</span><span class="w"> </span><span class="n">adds</span><span class="w"> </span><span class="n">marginal</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Changing</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">SSH</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p">(</span><span class="n">reduces</span><span class="w"> </span><span class="n">noise</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">attacks</span><span class="p">)</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Removing</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">banners</span><span class="w"> </span><span class="p">(</span><span class="n">slows</span><span class="w"> </span><span class="n">automated</span><span class="w"> </span><span class="n">scanners</span><span class="w"> </span><span class="n">slightly</span><span class="p">)</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">standard</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="p">(</span><span class="n">deters</span><span class="w"> </span><span class="n">casual</span><span class="w"> </span><span class="n">browsing</span><span class="p">)</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="9-risk-assessment-frameworks">9. Risk Assessment Frameworks<a class="header-link" href="#9-risk-assessment-frameworks" title="Permanent link">&para;</a></h2>
<h3 id="91-qualitative-risk-assessment">9.1 Qualitative Risk Assessment<a class="header-link" href="#91-qualitative-risk-assessment" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Risk = Likelihood Ã— Impact

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Risk Assessment Matrix (5Ã—5)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚ Negligibleâ”‚  Minor   â”‚ Moderate â”‚  Major   â”‚ Catastrophic â”‚
â”‚          â”‚ Impact   â”‚ Impact   â”‚ Impact   â”‚ Impact   â”‚  Impact      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Almost   â”‚  Medium  â”‚   High   â”‚   High   â”‚ Critical â”‚  Critical    â”‚
â”‚ Certain  â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Likely   â”‚   Low    â”‚  Medium  â”‚   High   â”‚   High   â”‚  Critical    â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Possible â”‚   Low    â”‚  Medium  â”‚  Medium  â”‚   High   â”‚   High       â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Unlikely â”‚   Low    â”‚   Low    â”‚  Medium  â”‚  Medium  â”‚   High       â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rare     â”‚   Low    â”‚   Low    â”‚   Low    â”‚  Medium  â”‚  Medium      â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="92-risk-assessment-in-code">9.2 Risk Assessment in Code<a class="header-link" href="#92-risk-assessment-in-code" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntEnum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Likelihood</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">RARE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">UNLIKELY</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">POSSIBLE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">LIKELY</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">ALMOST_CERTAIN</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Impact</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">NEGLIGIBLE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">MINOR</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">MODERATE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">MAJOR</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">CATASTROPHIC</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Risk</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">likelihood</span><span class="p">:</span> <span class="n">Likelihood</span>
    <span class="n">impact</span><span class="p">:</span> <span class="n">Impact</span>
    <span class="n">existing_controls</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">recommended_actions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">impact</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rating</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;CRITICAL&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HIGH&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;MEDIUM&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;LOW&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">response_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine risk response based on rating.&quot;&quot;&quot;</span>
        <span class="n">strategies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;CRITICAL&quot;</span><span class="p">:</span> <span class="s2">&quot;Mitigate immediately - stop and fix&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HIGH&quot;</span><span class="p">:</span> <span class="s2">&quot;Mitigate soon - plan remediation within sprint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MEDIUM&quot;</span><span class="p">:</span> <span class="s2">&quot;Accept with monitoring, or mitigate in backlog&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LOW&quot;</span><span class="p">:</span> <span class="s2">&quot;Accept - document and monitor&quot;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">strategies</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rating</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">risk_assessment</span><span class="p">(</span><span class="n">risks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Risk</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform and display a risk assessment.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RISK ASSESSMENT REPORT&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

    <span class="c1"># Sort by score (highest risk first)</span>
    <span class="n">sorted_risks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">risks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">risk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_risks</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Risk #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Description:  </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Likelihood:   </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Impact:       </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">impact</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">impact</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:        </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">score</span><span class="si">}</span><span class="s2"> / 25&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating:       </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">rating</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Response:     </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">response_strategy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Controls:     </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">risk</span><span class="o">.</span><span class="n">existing_controls</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Recommended:  </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">risk</span><span class="o">.</span><span class="n">recommended_actions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Summary statistics</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
    <span class="n">ratings</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">rating</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">risks</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rating</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;CRITICAL&quot;</span><span class="p">,</span> <span class="s2">&quot;HIGH&quot;</span><span class="p">,</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span> <span class="s2">&quot;LOW&quot;</span><span class="p">]:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rating</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">bar</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">count</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">rating</span><span class="si">:</span><span class="s2">10s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">bar</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Example assessment</span>
<span class="n">risks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Unpatched web server&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Apache 2.4.49 with known path traversal CVE-2021-41773&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">ALMOST_CERTAIN</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">MAJOR</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WAF in front of server&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Patch immediately to 2.4.52+&quot;</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;No encryption at rest&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Customer PII stored in plaintext in PostgreSQL&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">POSSIBLE</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">CATASTROPHIC</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Database behind VPN&quot;</span><span class="p">,</span> <span class="s2">&quot;Access logging&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;Enable TDE or application-level encryption&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Classify and encrypt PII columns&quot;</span>
        <span class="p">]</span>
    <span class="p">),</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Weak password policy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Minimum 6 characters, no complexity requirements&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">LIKELY</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">MODERATE</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Account lockout after 10 attempts&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;Require 12+ characters&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Check against breached password lists&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Implement MFA&quot;</span>
        <span class="p">]</span>
    <span class="p">),</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Missing CSRF protection&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;State-changing forms lack CSRF tokens&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">POSSIBLE</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">MODERATE</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SameSite=Lax cookies&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Add CSRF tokens to all forms&quot;</span><span class="p">,</span> <span class="s2">&quot;Use SameSite=Strict&quot;</span><span class="p">]</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="n">risk_assessment</span><span class="p">(</span><span class="n">risks</span><span class="p">)</span>
</code></pre></div>

<h3 id="93-notable-risk-frameworks">9.3 Notable Risk Frameworks<a class="header-link" href="#93-notable-risk-frameworks" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="nx">Risk</span><span class="w"> </span><span class="nx">Assessment</span><span class="w"> </span><span class="nx">Frameworks</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Framework</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Description</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">NIST</span><span class="w"> </span><span class="nx">RMF</span><span class="w">        </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Risk</span><span class="w"> </span><span class="nx">Management</span><span class="w"> </span><span class="nx">Framework</span><span class="w"> </span><span class="p">(</span><span class="nx">SP</span><span class="w"> </span><span class="mi">800</span><span class="o">-</span><span class="mi">37</span><span class="p">)</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="p">(</span><span class="nx">SP</span><span class="w"> </span><span class="mi">800</span><span class="o">-</span><span class="mi">37</span><span class="p">)</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Categorize</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Select</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Implement</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Assess</span><span class="w"> </span><span class="err">â†’</span><span class="w">     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">   </span><span class="nx">Authorize</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Monitor</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">US</span><span class="w"> </span><span class="nx">government</span><span class="w"> </span><span class="nx">standard</span><span class="p">,</span><span class="w"> </span><span class="nx">widely</span><span class="w"> </span><span class="nx">adopted</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">ISO</span><span class="w"> </span><span class="mi">27005</span><span class="w">       </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Information</span><span class="w"> </span><span class="nx">security</span><span class="w"> </span><span class="nx">risk</span><span class="w"> </span><span class="nx">management</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Context</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Assessment</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Treatment</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">Monitoring</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">International</span><span class="w"> </span><span class="nx">standard</span><span class="p">,</span><span class="w"> </span><span class="nx">certification</span><span class="w"> </span><span class="nx">available</span><span class="w"> </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">FAIR</span><span class="w">            </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Factor</span><span class="w"> </span><span class="nx">Analysis</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">Information</span><span class="w"> </span><span class="nx">Risk</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Quantitative</span><span class="p">:</span><span class="w"> </span><span class="nx">estimates</span><span class="w"> </span><span class="nx">risk</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">dollar</span><span class="w"> </span><span class="nx">terms</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Loss</span><span class="w"> </span><span class="nx">Event</span><span class="w"> </span><span class="nx">Frequency</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="nx">Loss</span><span class="w"> </span><span class="nx">Magnitude</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">OCTAVE</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Operationally</span><span class="w"> </span><span class="nx">Critical</span><span class="w"> </span><span class="nx">Threat</span><span class="p">,</span><span class="w"> </span><span class="nx">Asset</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Vulnerability</span><span class="w"> </span><span class="nx">Evaluation</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">Self</span><span class="o">-</span><span class="nx">directed</span><span class="p">,</span><span class="w"> </span><span class="nx">organization</span><span class="o">-</span><span class="nx">focused</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Good</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">smaller</span><span class="w"> </span><span class="nx">teams</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">OWASP</span><span class="w"> </span><span class="nx">Risk</span><span class="w">      </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Focused</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">web</span><span class="w"> </span><span class="nx">application</span><span class="w"> </span><span class="nx">risks</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Rating</span><span class="w">          </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Likelihood</span><span class="w"> </span><span class="err">Ã—</span><span class="w"> </span><span class="nx">Impact</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">detailed</span><span class="w"> </span><span class="nx">factors</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="err">â”‚</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Aligned</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">OWASP</span><span class="w"> </span><span class="nx">Top</span><span class="w"> </span><span class="mi">10</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="10-common-vulnerability-scoring-system-cvss">10. Common Vulnerability Scoring System (CVSS)<a class="header-link" href="#10-common-vulnerability-scoring-system-cvss" title="Permanent link">&para;</a></h2>
<p>CVSS provides a standardized way to capture the principal characteristics of a vulnerability and produce a numerical score (0-10) reflecting its severity.</p>
<h3 id="101-cvss-v31-v40-metrics">10.1 CVSS v3.1 / v4.0 Metrics<a class="header-link" href="#101-cvss-v31-v40-metrics" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                   </span><span class="nv">CVSS</span><span class="w"> </span><span class="nv">v3</span>.<span class="mi">1</span><span class="w"> </span><span class="nv">Metric</span><span class="w"> </span><span class="nv">Groups</span><span class="w">                            </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                                      </span>â”‚
â”‚<span class="w">  </span><span class="nv">BASE</span><span class="w"> </span><span class="nv">METRICS</span><span class="w"> </span><span class="ss">(</span><span class="nv">Intrinsic</span><span class="w"> </span><span class="nv">vulnerability</span><span class="w"> </span><span class="nv">characteristics</span><span class="ss">)</span><span class="w">              </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Attack</span><span class="w"> </span><span class="nv">Vector</span><span class="w"> </span><span class="ss">(</span><span class="nv">AV</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Network</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Adjacent</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Local</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Physical</span><span class="w">      </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Attack</span><span class="w"> </span><span class="nv">Complexity</span><span class="w"> </span><span class="ss">(</span><span class="nv">AC</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">High</span><span class="w">                              </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Privileges</span><span class="w"> </span><span class="nv">Required</span><span class="w"> </span><span class="ss">(</span><span class="nv">PR</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">None</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">High</span><span class="w">                    </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">User</span><span class="w"> </span><span class="nv">Interaction</span><span class="w"> </span><span class="ss">(</span><span class="nv">UI</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">None</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Required</span><span class="w">                          </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Scope</span><span class="w"> </span><span class="ss">(</span><span class="nv">S</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Unchanged</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Changed</span><span class="w">                                  </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Confidentiality</span><span class="w"> </span><span class="nv">Impact</span><span class="w"> </span><span class="ss">(</span><span class="nv">C</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">None</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">High</span><span class="w">                  </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Integrity</span><span class="w"> </span><span class="nv">Impact</span><span class="w"> </span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">None</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">High</span><span class="w">                        </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Availability</span><span class="w"> </span><span class="nv">Impact</span><span class="w"> </span><span class="ss">(</span><span class="nv">A</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">None</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">High</span><span class="w">                     </span>â”‚
â”‚<span class="w">                                                                      </span>â”‚
â”‚<span class="w">  </span><span class="nv">TEMPORAL</span><span class="w"> </span><span class="nv">METRICS</span><span class="w"> </span><span class="ss">(</span><span class="nv">Change</span><span class="w"> </span><span class="nv">over</span><span class="w"> </span><span class="nv">time</span><span class="ss">)</span><span class="w">                                 </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Exploit</span><span class="w"> </span><span class="nv">Code</span><span class="w"> </span><span class="nv">Maturity</span>:<span class="w"> </span><span class="nv">Not</span><span class="w"> </span><span class="nv">Defined</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Unproven</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">PoC</span><span class="w"> </span><span class="o">/</span><span class="w">          </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                          </span><span class="nv">Functional</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">High</span><span class="w">                        </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Remediation</span><span class="w"> </span><span class="nv">Level</span>:<span class="w"> </span><span class="nv">Not</span><span class="w"> </span><span class="nv">Defined</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Official</span><span class="w"> </span><span class="nv">Fix</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Temp</span><span class="w"> </span><span class="nv">Fix</span><span class="w"> </span><span class="o">/</span><span class="w">     </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                      </span><span class="nv">Workaround</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Unavailable</span><span class="w">                    </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Report</span><span class="w"> </span><span class="nv">Confidence</span>:<span class="w"> </span><span class="nv">Not</span><span class="w"> </span><span class="nv">Defined</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Unknown</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Reasonable</span><span class="w"> </span><span class="o">/</span><span class="w">        </span>â”‚
â”‚<span class="w">                         </span><span class="nv">Confirmed</span><span class="w">                                   </span>â”‚
â”‚<span class="w">                                                                      </span>â”‚
â”‚<span class="w">  </span><span class="nv">ENVIRONMENTAL</span><span class="w"> </span><span class="nv">METRICS</span><span class="w"> </span><span class="ss">(</span><span class="nv">Organization</span><span class="o">-</span><span class="nv">specific</span><span class="ss">)</span><span class="w">                       </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Modified</span><span class="w"> </span><span class="nv">Base</span><span class="w"> </span><span class="nv">metrics</span><span class="w"> </span><span class="ss">(</span><span class="nv">customized</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span><span class="nv">environment</span><span class="ss">)</span><span class="w">        </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="nv">Security</span><span class="w"> </span><span class="nv">Requirements</span><span class="w"> </span><span class="ss">(</span><span class="nv">CR</span>,<span class="w"> </span><span class="nv">IR</span>,<span class="w"> </span><span class="nv">AR</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Medium</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">High</span><span class="w">       </span>â”‚
â”‚<span class="w">                                                                      </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="nv">Score</span><span class="w"> </span><span class="nv">Ranges</span>:
<span class="w">  </span><span class="mi">0</span>.<span class="mi">0</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nv">None</span>
<span class="w">  </span><span class="mi">0</span>.<span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span>.<span class="mi">9</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">Low</span>
<span class="w">  </span><span class="mi">4</span>.<span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span>.<span class="mi">9</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">Medium</span>
<span class="w">  </span><span class="mi">7</span>.<span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8</span>.<span class="mi">9</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">High</span>
<span class="w">  </span><span class="mi">9</span>.<span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">10</span>.<span class="mi">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Critical</span>
</code></pre></div>

<h3 id="102-cvss-score-calculator">10.2 CVSS Score Calculator<a class="header-link" href="#102-cvss-score-calculator" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CVSSv31</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplified CVSS v3.1 Base Score calculator.</span>
<span class="sd">    Reference: https://www.first.org/cvss/v3.1/specification-document</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Attack Vector</span>
    <span class="n">attack_vector</span><span class="p">:</span> <span class="nb">str</span>       <span class="c1"># N(etwork), A(djacent), L(ocal), P(hysical)</span>
    <span class="c1"># Attack Complexity</span>
    <span class="n">attack_complexity</span><span class="p">:</span> <span class="nb">str</span>   <span class="c1"># L(ow), H(igh)</span>
    <span class="c1"># Privileges Required</span>
    <span class="n">privileges_required</span><span class="p">:</span> <span class="nb">str</span> <span class="c1"># N(one), L(ow), H(igh)</span>
    <span class="c1"># User Interaction</span>
    <span class="n">user_interaction</span><span class="p">:</span> <span class="nb">str</span>    <span class="c1"># N(one), R(equired)</span>
    <span class="c1"># Scope</span>
    <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span>               <span class="c1"># U(nchanged), C(hanged)</span>
    <span class="c1"># Impact</span>
    <span class="n">confidentiality</span><span class="p">:</span> <span class="nb">str</span>     <span class="c1"># N(one), L(ow), H(igh)</span>
    <span class="n">integrity</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># N(one), L(ow), H(igh)</span>
    <span class="n">availability</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># N(one), L(ow), H(igh)</span>

    <span class="c1"># Metric value lookups</span>
    <span class="n">AV_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mf">0.62</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">}</span>
    <span class="n">AC_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.77</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.44</span><span class="p">}</span>
    <span class="n">PR_VALUES_UNCHANGED</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.62</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.27</span><span class="p">}</span>
    <span class="n">PR_VALUES_CHANGED</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.68</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">}</span>
    <span class="n">UI_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span> <span class="mf">0.62</span><span class="p">}</span>
    <span class="n">IMPACT_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.00</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.22</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.56</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vector_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CVSS:3.1/AV:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_vector</span><span class="si">}</span><span class="s2">/AC:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_complexity</span><span class="si">}</span><span class="s2">/&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;PR:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">privileges_required</span><span class="si">}</span><span class="s2">/UI:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">user_interaction</span><span class="si">}</span><span class="s2">/&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;S:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="si">}</span><span class="s2">/C:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">confidentiality</span><span class="si">}</span><span class="s2">/&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;I:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">integrity</span><span class="si">}</span><span class="s2">/A:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">availability</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_exploitability_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">av</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AV_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_vector</span><span class="p">]</span>
        <span class="n">ac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AC_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_complexity</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
            <span class="n">pr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PR_VALUES_CHANGED</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">privileges_required</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PR_VALUES_UNCHANGED</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">privileges_required</span><span class="p">]</span>

        <span class="n">ui</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UI_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">user_interaction</span><span class="p">]</span>
        <span class="k">return</span> <span class="mf">8.22</span> <span class="o">*</span> <span class="n">av</span> <span class="o">*</span> <span class="n">ac</span> <span class="o">*</span> <span class="n">pr</span> <span class="o">*</span> <span class="n">ui</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_impact_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMPACT_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">confidentiality</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMPACT_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">integrity</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMPACT_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">availability</span><span class="p">]</span>

        <span class="n">iss</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">6.42</span> <span class="o">*</span> <span class="n">iss</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">7.52</span> <span class="o">*</span> <span class="p">(</span><span class="n">iss</span> <span class="o">-</span> <span class="mf">0.029</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.25</span> <span class="o">*</span> <span class="p">((</span><span class="n">iss</span> <span class="o">-</span> <span class="mf">0.02</span><span class="p">)</span> <span class="o">**</span> <span class="mi">15</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">base_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">impact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_impact_score</span><span class="p">()</span>
        <span class="n">exploitability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exploitability_score</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">impact</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">impact</span> <span class="o">+</span> <span class="n">exploitability</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.08</span> <span class="o">*</span> <span class="p">(</span><span class="n">impact</span> <span class="o">+</span> <span class="n">exploitability</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Round up to nearest 0.1</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">score</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">severity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;NONE&quot;</span>
        <span class="k">elif</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="mf">3.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;LOW&quot;</span>
        <span class="k">elif</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="mf">6.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;MEDIUM&quot;</span>
        <span class="k">elif</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="mf">8.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HIGH&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;CRITICAL&quot;</span>

<span class="c1"># Example: Log4Shell (CVE-2021-44228)</span>
<span class="n">log4shell</span> <span class="o">=</span> <span class="n">CVSSv31</span><span class="p">(</span>
    <span class="n">attack_vector</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>      <span class="c1"># Network - remotely exploitable</span>
    <span class="n">attack_complexity</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>   <span class="c1"># Low - trivial to exploit</span>
    <span class="n">privileges_required</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="c1"># None - no auth needed</span>
    <span class="n">user_interaction</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>    <span class="c1"># None - no user action needed</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>               <span class="c1"># Changed - can affect other components</span>
    <span class="n">confidentiality</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>     <span class="c1"># High - full read access</span>
    <span class="n">integrity</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>           <span class="c1"># High - full write access</span>
    <span class="n">availability</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>        <span class="c1"># High - can crash/DoS</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Log4Shell (CVE-2021-44228)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vector: </span><span class="si">{</span><span class="n">log4shell</span><span class="o">.</span><span class="n">vector_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:  </span><span class="si">{</span><span class="n">log4shell</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating: </span><span class="si">{</span><span class="n">log4shell</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Example: A less severe vulnerability (local privilege escalation)</span>
<span class="n">local_vuln</span> <span class="o">=</span> <span class="n">CVSSv31</span><span class="p">(</span>
    <span class="n">attack_vector</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>      <span class="c1"># Local - requires local access</span>
    <span class="n">attack_complexity</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>   <span class="c1"># High - specific conditions needed</span>
    <span class="n">privileges_required</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="c1"># Low - needs basic user account</span>
    <span class="n">user_interaction</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>    <span class="c1"># None</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;U&quot;</span><span class="p">,</span>               <span class="c1"># Unchanged</span>
    <span class="n">confidentiality</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>     <span class="c1"># High</span>
    <span class="n">integrity</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>           <span class="c1"># High</span>
    <span class="n">availability</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>        <span class="c1"># None</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Local Privilege Escalation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vector: </span><span class="si">{</span><span class="n">local_vuln</span><span class="o">.</span><span class="n">vector_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:  </span><span class="si">{</span><span class="n">local_vuln</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating: </span><span class="si">{</span><span class="n">local_vuln</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Example: Low severity (reflected XSS requiring user interaction)</span>
<span class="n">xss_vuln</span> <span class="o">=</span> <span class="n">CVSSv31</span><span class="p">(</span>
    <span class="n">attack_vector</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
    <span class="n">attack_complexity</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="n">privileges_required</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
    <span class="n">user_interaction</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">,</span>    <span class="c1"># Requires user to click a link</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>               <span class="c1"># Can affect other origins</span>
    <span class="n">confidentiality</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>     <span class="c1"># Low - can steal some data</span>
    <span class="n">integrity</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>           <span class="c1"># Low - can modify some page content</span>
    <span class="n">availability</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>        <span class="c1"># None</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reflected XSS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vector: </span><span class="si">{</span><span class="n">xss_vuln</span><span class="o">.</span><span class="n">vector_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:  </span><span class="si">{</span><span class="n">xss_vuln</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating: </span><span class="si">{</span><span class="n">xss_vuln</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="11-putting-it-all-together-a-worked-example">11. Putting It All Together: A Worked Example<a class="header-link" href="#11-putting-it-all-together-a-worked-example" title="Permanent link">&para;</a></h2>
<p>Let us walk through a complete security analysis for a hypothetical online banking application.</p>
<h3 id="111-system-description">11.1 System Description<a class="header-link" href="#111-system-description" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Online Banking System                              â”‚
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTPS     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     gRPC     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Mobile   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   API     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Accountâ”‚ â”‚
â”‚   â”‚ App      â”‚               â”‚  Gateway  â”‚             â”‚ Serviceâ”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTPS     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”     gRPC     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Web      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   Auth    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚Transferâ”‚ â”‚
â”‚   â”‚ Browser  â”‚               â”‚  Service  â”‚             â”‚Service â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Admin    â”‚ â”€â”€ VPN â”€â”€â”€â”€â”€â”€â–¶â”‚  Admin    â”‚ â”€â”€ SQL â”€â”€â”€â”€â–¶â”‚  DB    â”‚ â”‚
â”‚   â”‚ Console  â”‚               â”‚  Portal   â”‚              â”‚(PgSQL) â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="112-stride-threat-summary">11.2 STRIDE Threat Summary<a class="header-link" href="#112-stride-threat-summary" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>Threat</th>
<th>Category</th>
<th>CIA Impact</th>
<th>DREAD Score</th>
<th>Mitigation</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>Stolen session token reused</td>
<td>Spoofing</td>
<td>C</td>
<td>7.2</td>
<td>Short-lived JWTs, token binding</td>
</tr>
<tr>
<td>T2</td>
<td>Modified transfer amount</td>
<td>Tampering</td>
<td>I</td>
<td>8.0</td>
<td>Request signing, server validation</td>
</tr>
<tr>
<td>T3</td>
<td>User denies making transfer</td>
<td>Repudiation</td>
<td>Non-rep</td>
<td>5.4</td>
<td>Signed audit logs, digital receipts</td>
</tr>
<tr>
<td>T4</td>
<td>Account numbers leaked</td>
<td>Info Disc.</td>
<td>C</td>
<td>7.8</td>
<td>Encryption at rest, field masking</td>
</tr>
<tr>
<td>T5</td>
<td>DDoS on API gateway</td>
<td>DoS</td>
<td>A</td>
<td>6.2</td>
<td>CDN, rate limiting, auto-scaling</td>
</tr>
<tr>
<td>T6</td>
<td>Admin escalates to super admin</td>
<td>Elev. Priv</td>
<td>Auth</td>
<td>8.6</td>
<td>RBAC, approval workflows, MFA</td>
</tr>
</tbody>
</table>
<h3 id="113-defense-in-depth-applied">11.3 Defense in Depth Applied<a class="header-link" href="#113-defense-in-depth-applied" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Layer</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Policies</span>:<span class="w">     </span><span class="nv">Security</span><span class="w"> </span><span class="nv">training</span>,<span class="w"> </span><span class="nv">incident</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="nv">plan</span>
<span class="nv">Layer</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Physical</span>:<span class="w">     </span><span class="nv">Data</span><span class="w"> </span><span class="nv">center</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">biometric</span><span class="w"> </span><span class="nv">access</span>
<span class="nv">Layer</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Perimeter</span>:<span class="w">    </span><span class="nv">CDN</span><span class="o">/</span><span class="nv">WAF</span>,<span class="w"> </span><span class="nv">DDoS</span><span class="w"> </span><span class="nv">protection</span>,<span class="w"> </span><span class="nv">VPN</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">admin</span>
<span class="nv">Layer</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Network</span>:<span class="w">      </span><span class="nv">VLAN</span><span class="w"> </span><span class="nv">segmentation</span>,<span class="w"> </span><span class="nv">mTLS</span><span class="w"> </span><span class="nv">between</span><span class="w"> </span><span class="nv">services</span>
<span class="nv">Layer</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Host</span>:<span class="w">         </span><span class="nv">Hardened</span><span class="w"> </span><span class="nv">OS</span>,<span class="w"> </span><span class="nv">auto</span><span class="o">-</span><span class="nv">patching</span>,<span class="w"> </span><span class="nv">EDR</span><span class="w"> </span><span class="nv">agents</span>
<span class="nv">Layer</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Application</span>:<span class="w">  </span><span class="nv">Input</span><span class="w"> </span><span class="nv">validation</span>,<span class="w"> </span><span class="nv">CSRF</span><span class="w"> </span><span class="nv">tokens</span>,<span class="w"> </span><span class="nv">CSP</span><span class="w"> </span><span class="nv">headers</span>
<span class="nv">Layer</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">Data</span>:<span class="w">         </span><span class="nv">AES</span><span class="o">-</span><span class="mi">256</span><span class="w"> </span><span class="nv">encryption</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">rest</span>,<span class="w"> </span><span class="nv">TLS</span><span class="w"> </span><span class="mi">1</span>.<span class="mi">3</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">transit</span>
</code></pre></div>

<h3 id="114-least-privilege-applied">11.4 Least Privilege Applied<a class="header-link" href="#114-least-privilege-applied" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">Mobile</span><span class="w"> </span><span class="nt">App</span><span class="o">:</span><span class="w">     </span><span class="nt">Can</span><span class="w"> </span><span class="nt">only</span><span class="w"> </span><span class="nt">call</span><span class="w"> </span><span class="nt">API</span><span class="w"> </span><span class="nt">Gateway</span><span class="w"> </span><span class="o">(</span><span class="nt">read</span><span class="w"> </span><span class="nt">own</span><span class="w"> </span><span class="nt">account</span><span class="o">,</span><span class="w"> </span><span class="nt">initiate</span><span class="w"> </span><span class="nt">transfers</span><span class="o">)</span>
<span class="nt">API</span><span class="w"> </span><span class="nt">Gateway</span><span class="o">:</span><span class="w">    </span><span class="nt">Can</span><span class="w"> </span><span class="nt">route</span><span class="w"> </span><span class="nt">to</span><span class="w"> </span><span class="nt">Auth</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">Account</span><span class="w"> </span><span class="nt">services</span><span class="o">;</span><span class="w"> </span><span class="nt">no</span><span class="w"> </span><span class="nt">direct</span><span class="w"> </span><span class="nt">DB</span><span class="w"> </span><span class="nt">access</span>
<span class="nt">Auth</span><span class="w"> </span><span class="nt">Service</span><span class="o">:</span><span class="w">   </span><span class="nt">Read-only</span><span class="w"> </span><span class="nt">on</span><span class="w"> </span><span class="nt">users</span><span class="w"> </span><span class="nt">table</span><span class="o">;</span><span class="w"> </span><span class="nt">write-only</span><span class="w"> </span><span class="nt">on</span><span class="w"> </span><span class="nt">sessions</span><span class="w"> </span><span class="nt">table</span>
<span class="nt">Account</span><span class="w"> </span><span class="nt">Svc</span><span class="o">:</span><span class="w">    </span><span class="nt">Read</span><span class="o">/</span><span class="nt">write</span><span class="w"> </span><span class="nt">on</span><span class="w"> </span><span class="nt">accounts</span><span class="w"> </span><span class="nt">table</span><span class="o">;</span><span class="w"> </span><span class="nt">no</span><span class="w"> </span><span class="nt">access</span><span class="w"> </span><span class="nt">to</span><span class="w"> </span><span class="nt">users</span>
<span class="nt">Transfer</span><span class="w"> </span><span class="nt">Svc</span><span class="o">:</span><span class="w">   </span><span class="nt">Insert-only</span><span class="w"> </span><span class="nt">on</span><span class="w"> </span><span class="nt">transfers</span><span class="w"> </span><span class="nt">table</span><span class="o">;</span><span class="w"> </span><span class="nt">read</span><span class="w"> </span><span class="nt">on</span><span class="w"> </span><span class="nt">accounts</span>
<span class="nt">Admin</span><span class="w"> </span><span class="nt">Portal</span><span class="o">:</span><span class="w">   </span><span class="nt">Accessible</span><span class="w"> </span><span class="nt">only</span><span class="w"> </span><span class="nt">via</span><span class="w"> </span><span class="nt">VPN</span><span class="o">;</span><span class="w"> </span><span class="nt">requires</span><span class="w"> </span><span class="nt">MFA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">manager</span><span class="w"> </span><span class="nt">approval</span>
<span class="nt">Database</span><span class="o">:</span><span class="w">       </span><span class="nt">No</span><span class="w"> </span><span class="nt">internet</span><span class="w"> </span><span class="nt">access</span><span class="o">;</span><span class="w"> </span><span class="nt">connections</span><span class="w"> </span><span class="nt">only</span><span class="w"> </span><span class="nt">from</span><span class="w"> </span><span class="nt">service</span><span class="w"> </span><span class="nt">VPC</span>
</code></pre></div>

<hr />
<h2 id="12-exercises">12. Exercises<a class="header-link" href="#12-exercises" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-cia-analysis-beginner">Exercise 1: CIA Analysis (Beginner)<a class="header-link" href="#exercise-1-cia-analysis-beginner" title="Permanent link">&para;</a></h3>
<p>For each scenario below, identify which CIA property is primarily violated and what controls could prevent it:</p>
<ol>
<li>A hospital's electronic health record system goes offline during a ransomware attack.</li>
<li>A hacker changes the price of items in an e-commerce database from $99 to $0.01.</li>
<li>An employee emails a spreadsheet of customer Social Security numbers to their personal email.</li>
<li>DNS records are modified to redirect bank customers to a phishing site.</li>
<li>A disgruntled employee deletes the production database backups.</li>
</ol>
<h3 id="exercise-2-stride-threat-model-intermediate">Exercise 2: STRIDE Threat Model (Intermediate)<a class="header-link" href="#exercise-2-stride-threat-model-intermediate" title="Permanent link">&para;</a></h3>
<p>Draw a Data Flow Diagram for a food delivery application with these components:
- Customer mobile app
- Restaurant dashboard (web)
- API server
- Payment processor (Stripe)
- Delivery tracking service
- PostgreSQL database</p>
<p>Apply STRIDE to identify at least 8 threats. For each threat, specify:
- STRIDE category
- Affected DFD element
- Severity (use DREAD scoring)
- At least one mitigation</p>
<h3 id="exercise-3-cvss-scoring-intermediate">Exercise 3: CVSS Scoring (Intermediate)<a class="header-link" href="#exercise-3-cvss-scoring-intermediate" title="Permanent link">&para;</a></h3>
<p>Calculate the CVSS v3.1 base score for these vulnerabilities:</p>
<ol>
<li>
<p>A web application allows unauthenticated users to download any file from the server by manipulating a URL parameter (path traversal). No user interaction is required.</p>
</li>
<li>
<p>A desktop application has a buffer overflow that can be triggered by opening a specially crafted file. The attacker needs the victim to open the file, and successful exploitation gives the attacker the same privileges as the victim.</p>
</li>
<li>
<p>An API endpoint requires authentication but fails to check if the authenticated user has permission to access the requested resource (IDOR). Only affects data within the same application.</p>
</li>
</ol>
<h3 id="exercise-4-defense-in-depth-design-advanced">Exercise 4: Defense in Depth Design (Advanced)<a class="header-link" href="#exercise-4-defense-in-depth-design-advanced" title="Permanent link">&para;</a></h3>
<p>You are designing a security architecture for a startup that processes credit card payments. They currently have:
- A single web server running both the application and database
- No encryption at rest
- Admin access via SSH with password authentication
- No logging or monitoring
- All employees share one database admin password</p>
<p>Design a 7-layer defense-in-depth strategy. For each layer, specify:
- At least 2 specific controls
- The threats each control mitigates
- Priority (implement first/second/third)</p>
<h3 id="exercise-5-least-privilege-audit-advanced">Exercise 5: Least Privilege Audit (Advanced)<a class="header-link" href="#exercise-5-least-privilege-audit-advanced" title="Permanent link">&para;</a></h3>
<p>Given the following AWS IAM policy, identify all violations of least privilege and rewrite it to be properly scoped:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Statement&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s3:*&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;ec2:*&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;rds:*&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;iam:*&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>Context: This policy is for a web application backend that needs to:
- Read and write files to a single S3 bucket (<code>my-app-uploads</code>)
- Read from an RDS PostgreSQL instance (<code>my-app-db</code>)
- No EC2 management needed (runs on ECS)
- No IAM management needed</p>
<h3 id="exercise-6-security-by-design-review-advanced">Exercise 6: Security by Design Review (Advanced)<a class="header-link" href="#exercise-6-security-by-design-review-advanced" title="Permanent link">&para;</a></h3>
<p>Review the following Flask code and identify all security issues. Rewrite it following security-by-design principles:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>

    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;users.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">password_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE username=&#39;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39; AND password=&#39;</span><span class="si">{</span><span class="n">password_hash</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">3</span><span class="p">]})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;failed&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;No user found with username </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/admin/delete_user/&lt;user_id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">delete_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;users.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DELETE FROM users WHERE id=</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;deleted&quot;</span><span class="p">})</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Identify at least 10 security issues and provide the corrected code.</p>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Anderson, R. (2020). <em>Security Engineering</em>, 3rd Edition. Wiley.</li>
<li>Shostack, A. (2014). <em>Threat Modeling: Designing for Security</em>. Wiley.</li>
<li>OWASP Threat Modeling - https://owasp.org/www-community/Threat_Modeling</li>
<li>NIST SP 800-30: Guide for Conducting Risk Assessments</li>
<li>NIST SP 800-37: Risk Management Framework</li>
<li>FIRST CVSS v3.1 Specification - https://www.first.org/cvss/v3.1/specification-document</li>
<li>Microsoft STRIDE - https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool-threats</li>
</ul>
<hr />
<h2 id="next-lesson">Next Lesson<a class="header-link" href="#next-lesson" title="Permanent link">&para;</a></h2>
<p><a href="./02_Cryptography_Basics.md">02. Cryptography Basics</a> covers symmetric and asymmetric encryption, key exchange, and digital signatures with practical Python examples.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Security/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Security</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Security/02_Cryptography_Basics.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Cryptography Basics</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}