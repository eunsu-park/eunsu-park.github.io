{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shell Fundamentals and Execution Environment - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Shell_Script/">Shell Script</a>
    <span class="separator">/</span>
    <span class="current">Shell Fundamentals and Execution Environment</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Shell Fundamentals and Execution Environment</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Shell_Script/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Shell Scripting Study Guide</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Shell_Script/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Shell_Script/02_Parameter_Expansion.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Parameter Expansion and Variable Attributes ‚≠ê‚≠ê</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#1-types-of-shells">1. Types of Shells</a><ul>
<li><a href="#shell-comparison-table">Shell Comparison Table</a></li>
<li><a href="#when-to-use-each-shell">When to Use Each Shell</a></li>
</ul>
</li>
<li><a href="#2-posix-compliance">2. POSIX Compliance</a><ul>
<li><a href="#posix-vs-bash-isms">POSIX vs Bash-isms</a></li>
<li><a href="#writing-portable-posix-scripts">Writing Portable POSIX Scripts</a></li>
</ul>
</li>
<li><a href="#3-shell-modes">3. Shell Modes</a><ul>
<li><a href="#login-vs-non-login-shells">Login vs Non-Login Shells</a></li>
<li><a href="#interactive-vs-non-interactive-shells">Interactive vs Non-Interactive Shells</a></li>
</ul>
</li>
<li><a href="#4-startup-files-loading-order">4. Startup Files Loading Order</a><ul>
<li><a href="#startup-sequence-diagram">Startup Sequence Diagram</a></li>
<li><a href="#startup-files-purpose">Startup Files Purpose</a></li>
<li><a href="#example-startup-file-structure">Example Startup File Structure</a></li>
</ul>
</li>
<li><a href="#5-exit-codes">5. Exit Codes</a><ul>
<li><a href="#exit-code-conventions">Exit Code Conventions</a></li>
<li><a href="#using-exit-codes">Using Exit Codes</a></li>
<li><a href="#exit-code-best-practices">Exit Code Best Practices</a></li>
</ul>
</li>
<li><a href="#6-shell-options-overview">6. Shell Options Overview</a><ul>
<li><a href="#important-set-options">Important set Options</a></li>
<li><a href="#common-set-options">Common set Options</a></li>
<li><a href="#important-shopt-options">Important shopt Options</a></li>
<li><a href="#useful-shopt-options">Useful shopt Options</a></li>
<li><a href="#strict-mode-example">Strict Mode Example</a></li>
</ul>
</li>
<li><a href="#7-the-env-command-and-usrbinenv-bash">7. The env Command and #!/usr/bin/env bash</a><ul>
<li><a href="#why-use-usrbinenv-bash">Why Use #!/usr/bin/env bash</a></li>
<li><a href="#using-env-to-set-environment">Using env to Set Environment</a></li>
<li><a href="#env-for-clean-environment">env for Clean Environment</a></li>
<li><a href="#script-template-with-best-practices">Script Template with Best Practices</a></li>
</ul>
</li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-shell-detection-script">Problem 1: Shell Detection Script</a></li>
<li><a href="#problem-2-startup-file-analyzer">Problem 2: Startup File Analyzer</a></li>
<li><a href="#problem-3-exit-code-logger">Problem 3: Exit Code Logger</a></li>
<li><a href="#problem-4-portable-script-checker">Problem 4: Portable Script Checker</a></li>
<li><a href="#problem-5-environment-snapshot">Problem 5: Environment Snapshot</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="shell-fundamentals-and-execution-environment">Shell Fundamentals and Execution Environment<a class="header-link" href="#shell-fundamentals-and-execution-environment" title="Permanent link">&para;</a></h1>
<p><strong>Next</strong>: <a href="./02_Parameter_Expansion.md">02_Parameter_Expansion.md</a></p>
<hr />
<p>This lesson explores the shell execution environment, different shell types, startup mechanisms, and fundamental concepts that affect how your scripts behave in different contexts.</p>
<h2 id="1-types-of-shells">1. Types of Shells<a class="header-link" href="#1-types-of-shells" title="Permanent link">&para;</a></h2>
<p>Different shells offer varying features and compatibility levels. Understanding these differences is crucial for writing portable scripts.</p>
<h3 id="shell-comparison-table">Shell Comparison Table<a class="header-link" href="#shell-comparison-table" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>bash</th>
<th>sh (dash)</th>
<th>zsh</th>
<th>fish</th>
</tr>
</thead>
<tbody>
<tr>
<td>POSIX compliant</td>
<td>Mostly</td>
<td>Yes</td>
<td>Mostly</td>
<td>No</td>
</tr>
<tr>
<td>Arrays</td>
<td>Yes</td>
<td>No</td>
<td>Yes (better)</td>
<td>Yes</td>
</tr>
<tr>
<td>Associative arrays</td>
<td>Yes (4.0+)</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>[[ ]] test</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Process substitution</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Here strings</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Arithmetic (( ))</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Command completion</td>
<td>Good</td>
<td>Basic</td>
<td>Excellent</td>
<td>Excellent</td>
</tr>
<tr>
<td>Startup performance</td>
<td>Medium</td>
<td>Fast</td>
<td>Slow</td>
<td>Medium</td>
</tr>
<tr>
<td>Scripting focus</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Default on Debian/Ubuntu</td>
<td>bash</td>
<td>dash (/bin/sh)</td>
<td>bash</td>
<td>fish</td>
</tr>
<tr>
<td>Configuration syntax</td>
<td>bash</td>
<td>POSIX sh</td>
<td>zsh-extended</td>
<td>Fish-specific</td>
</tr>
</tbody>
</table>
<h3 id="when-to-use-each-shell">When to Use Each Shell<a class="header-link" href="#when-to-use-each-shell" title="Permanent link">&para;</a></h3>
<p><strong>bash</strong>: General-purpose scripting, most systems have it, good balance of features and portability.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># Use bash for scripts needing arrays, [[ ]], or process substitution</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>config
config<span class="o">[</span>host<span class="o">]=</span><span class="s2">&quot;localhost&quot;</span>
config<span class="o">[</span>port<span class="o">]=</span><span class="m">8080</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">config</span><span class="p">[host]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">config</span><span class="p">[host]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
</code></pre></div>

<p><strong>sh (POSIX)</strong>: Maximum portability, embedded systems, minimal environments.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># POSIX-compliant script - no bash-isms</span>
<span class="c1"># No arrays, no [[, no process substitution</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOST</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Host: </span><span class="nv">$HOST</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="c1"># Use case instead of [[ with regex</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$filename</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span>*.txt<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Text file&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="w">    </span>*.log<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Log file&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div>

<p><strong>zsh</strong>: Interactive use, advanced completion, better array handling.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/zsh</span>
<span class="c1"># zsh has more powerful array features</span>
<span class="nv">array</span><span class="o">=(</span>one<span class="w"> </span>two<span class="w"> </span>three<span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$array</span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w">  </span><span class="c1"># zsh arrays are 1-indexed (bash uses 0-indexed)</span>

<span class="c1"># Advanced globbing</span>
setopt<span class="w"> </span>extended_glob
<span class="nv">files</span><span class="o">=(</span>^*.txt<span class="o">)</span><span class="w">  </span><span class="c1"># all files except .txt</span>
</code></pre></div>

<p><strong>fish</strong>: Interactive shell, user-friendly, NOT for portable scripts.</p>
<div class="highlight"><pre><span></span><code><span class="c">#!/usr/bin/fish</span>
<span class="c"># Fish has different syntax - not POSIX compatible</span>
<span class="k">set</span> host localhost
<span class="k">set</span> port 8080

<span class="k">if</span> <span class="k">test</span> -n <span class="s2">&quot;</span><span class="nv">$host</span><span class="s2">&quot;</span>
    <span class="k">echo</span> <span class="s2">&quot;Host: </span><span class="nv">$host</span><span class="s2">&quot;</span>
<span class="k">end</span>
</code></pre></div>

<h2 id="2-posix-compliance">2. POSIX Compliance<a class="header-link" href="#2-posix-compliance" title="Permanent link">&para;</a></h2>
<p>POSIX (Portable Operating System Interface) defines a standard for shell behavior. POSIX-compliant scripts run on any POSIX shell (sh, bash, dash, ksh, etc.).</p>
<h3 id="posix-vs-bash-isms">POSIX vs Bash-isms<a class="header-link" href="#posix-vs-bash-isms" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>POSIX sh</th>
<th>bash Extension</th>
</tr>
</thead>
<tbody>
<tr>
<td>Test command</td>
<td><code>[ ]</code></td>
<td><code>[[ ]]</code></td>
</tr>
<tr>
<td>String comparison</td>
<td><code>[ "$a" = "$b" ]</code></td>
<td><code>[[ $a == $b ]]</code></td>
</tr>
<tr>
<td>Regex matching</td>
<td>(use grep)</td>
<td><code>[[ $str =~ regex ]]</code></td>
</tr>
<tr>
<td>Arrays</td>
<td>Not supported</td>
<td><code>arr=(1 2 3)</code></td>
</tr>
<tr>
<td>Functions</td>
<td><code>func() { }</code></td>
<td><code>function func { }</code></td>
</tr>
<tr>
<td>Arithmetic</td>
<td><code>expr</code>, <code>$(( ))</code></td>
<td><code>let</code>, <code>(( ))</code></td>
</tr>
<tr>
<td>Process substitution</td>
<td>Not supported</td>
<td><code>&lt;(cmd)</code>, <code>&gt;(cmd)</code></td>
</tr>
<tr>
<td>Here strings</td>
<td>Not supported</td>
<td><code>&lt;&lt;&lt; "string"</code></td>
</tr>
<tr>
<td>Local variables</td>
<td>Not in POSIX</td>
<td><code>local var=value</code></td>
</tr>
</tbody>
</table>
<h3 id="writing-portable-posix-scripts">Writing Portable POSIX Scripts<a class="header-link" href="#writing-portable-posix-scripts" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># POSIX-compliant script example</span>

<span class="c1"># Use [ ] instead of [[ ]]</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;start&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting service...&quot;</span>
<span class="k">fi</span>

<span class="c1"># Use $(( )) for arithmetic (this IS POSIX)</span>
<span class="nv">count</span><span class="o">=</span><span class="m">0</span>
<span class="nv">count</span><span class="o">=</span><span class="k">$((</span><span class="nv">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>

<span class="c1"># Use case for pattern matching</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$filename</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span>*.tar.gz<span class="p">|</span>*.tgz<span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Compressed tarball&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span>*.zip<span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ZIP archive&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span>*<span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Unknown format&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="k">esac</span>

<span class="c1"># Avoid arrays - use positional parameters or temporary files</span>
<span class="nb">set</span><span class="w"> </span>--<span class="w"> </span><span class="s2">&quot;item1&quot;</span><span class="w"> </span><span class="s2">&quot;item2&quot;</span><span class="w"> </span><span class="s2">&quot;item3&quot;</span>
<span class="k">for</span><span class="w"> </span>item<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$item</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Use command substitution $(cmd) not backticks</span>
<span class="nv">current_dir</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>

<span class="c1"># Check command existence portably</span>
<span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>docker<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Docker is installed&quot;</span>
<span class="k">fi</span>
</code></pre></div>

<h2 id="3-shell-modes">3. Shell Modes<a class="header-link" href="#3-shell-modes" title="Permanent link">&para;</a></h2>
<p>Shells operate in different modes depending on how they are invoked. This affects which startup files are read.</p>
<h3 id="login-vs-non-login-shells">Login vs Non-Login Shells<a class="header-link" href="#login-vs-non-login-shells" title="Permanent link">&para;</a></h3>
<p><strong>Login shell</strong>: Started when you log in (SSH, console login, <code>bash --login</code>).</p>
<p><strong>Non-login shell</strong>: Started from an existing session (opening terminal in GUI, running bash from bash).</p>
<p>Test if shell is login shell:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># Check if running as login shell</span>
<span class="k">if</span><span class="w"> </span><span class="nb">shopt</span><span class="w"> </span>-q<span class="w"> </span>login_shell<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This is a login shell&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This is a non-login shell&quot;</span>
<span class="k">fi</span>

<span class="c1"># Alternative method</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$-</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span>*l*<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Login shell&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="w">    </span>*<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Non-login shell&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div>

<h3 id="interactive-vs-non-interactive-shells">Interactive vs Non-Interactive Shells<a class="header-link" href="#interactive-vs-non-interactive-shells" title="Permanent link">&para;</a></h3>
<p><strong>Interactive</strong>: Terminal attached, accepts user input (normal terminal session).</p>
<p><strong>Non-interactive</strong>: Running scripts, no terminal interaction.</p>
<p>Test if shell is interactive:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># Check if running interactively</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$-</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*i*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Interactive shell&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Non-interactive shell (script)&quot;</span>
<span class="k">fi</span>

<span class="c1"># Alternative method</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$-</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span>*i*<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Interactive&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="w">    </span>*<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Non-interactive&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="k">esac</span>

<span class="c1"># Check if stdin is a terminal</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-t<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;stdin is a terminal&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;stdin is not a terminal (piped/redirected)&quot;</span>
<span class="k">fi</span>
</code></pre></div>

<h2 id="4-startup-files-loading-order">4. Startup Files Loading Order<a class="header-link" href="#4-startup-files-loading-order" title="Permanent link">&para;</a></h2>
<p>The order in which bash reads configuration files depends on the shell mode.</p>
<h3 id="startup-sequence-diagram">Startup Sequence Diagram<a class="header-link" href="#startup-sequence-diagram" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Login Shell (bash --login or SSH)
‚îú‚îÄ‚îÄ /etc/profile (system-wide)
‚îÇ   ‚îî‚îÄ‚îÄ /etc/profile.d/*.sh (if sourced by /etc/profile)
‚îî‚îÄ‚îÄ First found:
    ‚îú‚îÄ‚îÄ ~/.bash_profile
    ‚îú‚îÄ‚îÄ ~/.bash_login  (if ~/.bash_profile not found)
    ‚îî‚îÄ‚îÄ ~/.profile     (if neither above found)
        ‚îî‚îÄ‚îÄ (many .bash_profile files source ~/.bashrc)

Non-Login Interactive Shell (terminal window)
‚îú‚îÄ‚îÄ /etc/bash.bashrc (Debian/Ubuntu)
‚îî‚îÄ‚îÄ ~/.bashrc

Non-Interactive Shell (scripts)
‚îú‚îÄ‚îÄ $BASH_ENV (if set, file path to source)
‚îî‚îÄ‚îÄ (typically nothing)

Login Shell Exit
‚îî‚îÄ‚îÄ ~/.bash_logout
</code></pre></div>

<h3 id="startup-files-purpose">Startup Files Purpose<a class="header-link" href="#startup-files-purpose" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>File</th>
<th>Purpose</th>
<th>Typical Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/etc/profile</code></td>
<td>System-wide login settings</td>
<td>PATH, LANG, umask</td>
</tr>
<tr>
<td><code>/etc/bash.bashrc</code></td>
<td>System-wide interactive settings</td>
<td>PS1, aliases (Debian/Ubuntu)</td>
</tr>
<tr>
<td><code>~/.bash_profile</code></td>
<td>User login settings</td>
<td>Source ~/.bashrc, set PATH</td>
</tr>
<tr>
<td><code>~/.bashrc</code></td>
<td>User interactive settings</td>
<td>Aliases, functions, PS1</td>
</tr>
<tr>
<td><code>~/.profile</code></td>
<td>POSIX login settings</td>
<td>Portable login settings</td>
</tr>
<tr>
<td><code>~/.bash_logout</code></td>
<td>Cleanup on logout</td>
<td>Clear screen, clean temp files</td>
</tr>
</tbody>
</table>
<h3 id="example-startup-file-structure">Example Startup File Structure<a class="header-link" href="#example-startup-file-structure" title="Permanent link">&para;</a></h3>
<p><strong>~/.bash_profile</strong> (login shell entry point):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ~/.bash_profile - loaded by login shells</span>

<span class="c1"># Set PATH for user binaries</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/bin:</span><span class="nv">$HOME</span><span class="s2">/.local/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span>

<span class="c1"># Load .bashrc if it exists (for interactive login shells)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>~/.bashrc<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>.<span class="w"> </span>~/.bashrc
<span class="k">fi</span>

<span class="c1"># Login-specific settings</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Last login: </span><span class="k">$(</span>date<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.login_log
</code></pre></div>

<p><strong>~/.bashrc</strong> (interactive shell settings):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ~/.bashrc - loaded by interactive non-login shells</span>

<span class="c1"># If not running interactively, don&#39;t do anything</span>
<span class="k">case</span><span class="w"> </span><span class="nv">$-</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span>*i*<span class="o">)</span><span class="w"> </span><span class="p">;;</span>
<span class="w">      </span>*<span class="o">)</span><span class="w"> </span><span class="k">return</span><span class="p">;;</span>
<span class="k">esac</span>

<span class="c1"># History settings</span>
<span class="nv">HISTCONTROL</span><span class="o">=</span>ignoreboth
<span class="nv">HISTSIZE</span><span class="o">=</span><span class="m">10000</span>
<span class="nv">HISTFILESIZE</span><span class="o">=</span><span class="m">20000</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>histappend

<span class="c1"># Prompt</span>
<span class="nv">PS1</span><span class="o">=</span><span class="s1">&#39;\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &#39;</span>

<span class="c1"># Aliases</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">ll</span><span class="o">=</span><span class="s1">&#39;ls -lah&#39;</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">grep</span><span class="o">=</span><span class="s1">&#39;grep --color=auto&#39;</span>

<span class="c1"># Load functions from separate file</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>~/.bash_functions<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>.<span class="w"> </span>~/.bash_functions
<span class="k">fi</span>
</code></pre></div>

<p><strong>~/.profile</strong> (POSIX-compatible login settings):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ~/.profile - POSIX-compatible login settings</span>
<span class="c1"># Used when bash is invoked as sh, or by other POSIX shells</span>

<span class="c1"># Set PATH</span>
<span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span>
<span class="nb">export</span><span class="w"> </span>PATH

<span class="c1"># Environment variables</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">EDITOR</span><span class="o">=</span>vim
<span class="nb">export</span><span class="w"> </span><span class="nv">PAGER</span><span class="o">=</span>less

<span class="c1"># If bash, source .bashrc</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BASH_VERSION</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.bashrc&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>.<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.bashrc&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">fi</span>
</code></pre></div>

<h2 id="5-exit-codes">5. Exit Codes<a class="header-link" href="#5-exit-codes" title="Permanent link">&para;</a></h2>
<p>Exit codes indicate whether a command succeeded or failed. By convention:</p>
<h3 id="exit-code-conventions">Exit Code Conventions<a class="header-link" href="#exit-code-conventions" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Success</td>
</tr>
<tr>
<td>1</td>
<td>General error</td>
</tr>
<tr>
<td>2</td>
<td>Misuse of shell builtin</td>
</tr>
<tr>
<td>126</td>
<td>Command found but not executable</td>
</tr>
<tr>
<td>127</td>
<td>Command not found</td>
</tr>
<tr>
<td>128</td>
<td>Invalid exit argument</td>
</tr>
<tr>
<td>128+N</td>
<td>Fatal error signal N (130 = Ctrl+C (SIGINT=2))</td>
</tr>
<tr>
<td>255</td>
<td>Exit status out of range</td>
</tr>
</tbody>
</table>
<h3 id="using-exit-codes">Using Exit Codes<a class="header-link" href="#using-exit-codes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Check exit code with $?</span>
grep<span class="w"> </span><span class="s2">&quot;pattern&quot;</span><span class="w"> </span>file.txt
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Pattern found&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Pattern not found&quot;</span>
<span class="k">fi</span>

<span class="c1"># Better: use command directly in if</span>
<span class="k">if</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;pattern&quot;</span><span class="w"> </span>file.txt<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Pattern found&quot;</span>
<span class="k">fi</span>

<span class="c1"># Return custom exit codes from functions</span>
validate_input<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">input</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$input</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Error: input is empty&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$input</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Error: input must be numeric&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">2</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$input</span><span class="s2">&quot;</span><span class="w"> </span>-lt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$input</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Error: input must be between 0 and 100&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">3</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="o">}</span>

<span class="c1"># Use function and check exit code</span>
<span class="k">if</span><span class="w"> </span>validate_input<span class="w"> </span><span class="s2">&quot;42&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Input is valid&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span><span class="m">1</span><span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Empty input&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="w">        </span><span class="m">2</span><span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Not numeric&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="w">        </span><span class="m">3</span><span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Out of range&quot;</span><span class="w"> </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>
<span class="k">fi</span>

<span class="c1"># Exit script with specific code</span>
check_prerequisites<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>docker<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Error: docker not found&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">        </span><span class="nb">exit</span><span class="w"> </span><span class="m">127</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-r<span class="w"> </span>/etc/config.conf<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Error: config file not readable&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">        </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>
</code></pre></div>

<h3 id="exit-code-best-practices">Exit Code Best Practices<a class="header-link" href="#exit-code-best-practices" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="nb">set</span><span class="w"> </span>-e<span class="w">  </span><span class="c1"># Exit on error (but be careful with this)</span>

<span class="c1"># Explicitly handle errors</span>
perform_backup<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">source</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">dest</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span>tar<span class="w"> </span>czf<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dest</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$source</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Backup failed&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Backup successful&quot;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="o">}</span>

<span class="c1"># Chain commands with proper error handling</span>
<span class="k">if</span><span class="w"> </span>perform_backup<span class="w"> </span><span class="s2">&quot;/data&quot;</span><span class="w"> </span><span class="s2">&quot;/backup/data.tar.gz&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Cleaning up old backups...&quot;</span>
<span class="w">    </span>find<span class="w"> </span>/backup<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.tar.gz&quot;</span><span class="w"> </span>-mtime<span class="w"> </span>+7<span class="w"> </span>-delete
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Backup failed, keeping old backups&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span>
</code></pre></div>

<h2 id="6-shell-options-overview">6. Shell Options Overview<a class="header-link" href="#6-shell-options-overview" title="Permanent link">&para;</a></h2>
<p>Shell options control shell behavior. Two commands manage options:</p>
<ul>
<li><strong>set</strong>: POSIX-standard options</li>
<li><strong>shopt</strong>: Bash-specific extended options</li>
</ul>
<h3 id="important-set-options">Important set Options<a class="header-link" href="#important-set-options" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Show current options</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$-</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># e.g., &quot;himBH&quot; (each letter is an active option)</span>

<span class="c1"># Enable options</span>
<span class="nb">set</span><span class="w"> </span>-e<span class="w">  </span><span class="c1"># Exit on error (errexit)</span>
<span class="nb">set</span><span class="w"> </span>-u<span class="w">  </span><span class="c1"># Error on undefined variables (nounset)</span>
<span class="nb">set</span><span class="w"> </span>-o<span class="w"> </span>pipefail<span class="w">  </span><span class="c1"># Pipeline fails if any command fails</span>
<span class="nb">set</span><span class="w"> </span>-x<span class="w">  </span><span class="c1"># Print commands before executing (xtrace)</span>

<span class="c1"># Disable options</span>
<span class="nb">set</span><span class="w"> </span>+e<span class="w">  </span><span class="c1"># Don&#39;t exit on error</span>
<span class="nb">set</span><span class="w"> </span>+x<span class="w">  </span><span class="c1"># Stop printing commands</span>

<span class="c1"># Combine options</span>
<span class="nb">set</span><span class="w"> </span>-euo<span class="w"> </span>pipefail<span class="w">  </span><span class="c1"># Common &quot;strict mode&quot;</span>

<span class="c1"># Example: noclobber prevents overwriting files</span>
<span class="nb">set</span><span class="w"> </span>-o<span class="w"> </span>noclobber
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;test&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>file.txt<span class="w">  </span><span class="c1"># Creates file</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;test&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>file.txt<span class="w">  </span><span class="c1"># Error: file exists</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;test&quot;</span><span class="w"> </span>&gt;<span class="p">|</span><span class="w"> </span>file.txt<span class="w">  </span><span class="c1"># Override noclobber with &gt;|</span>
</code></pre></div>

<h3 id="common-set-options">Common set Options<a class="header-link" href="#common-set-options" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Option</th>
<th>Short</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-e</code> (errexit)</td>
<td><code>-e</code></td>
<td>Exit if command fails</td>
</tr>
<tr>
<td><code>-u</code> (nounset)</td>
<td><code>-u</code></td>
<td>Error on undefined variable</td>
</tr>
<tr>
<td><code>-x</code> (xtrace)</td>
<td><code>-x</code></td>
<td>Print commands before execution</td>
</tr>
<tr>
<td><code>-o pipefail</code></td>
<td>(long only)</td>
<td>Pipeline fails if any command fails</td>
</tr>
<tr>
<td><code>-o noclobber</code></td>
<td><code>-C</code></td>
<td>Prevent &gt; from overwriting files</td>
</tr>
<tr>
<td><code>-o noglob</code></td>
<td><code>-f</code></td>
<td>Disable pathname expansion</td>
</tr>
<tr>
<td><code>-o vi</code></td>
<td>(long only)</td>
<td>Vi-style command line editing</td>
</tr>
<tr>
<td><code>-o emacs</code></td>
<td>(long only)</td>
<td>Emacs-style editing (default)</td>
</tr>
</tbody>
</table>
<h3 id="important-shopt-options">Important shopt Options<a class="header-link" href="#important-shopt-options" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Enable bash extended options</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>extglob<span class="w">  </span><span class="c1"># Extended pattern matching</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>globstar<span class="w">  </span><span class="c1"># ** for recursive glob</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>nullglob<span class="w">  </span><span class="c1"># Non-matching globs expand to nothing</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>dotglob<span class="w">  </span><span class="c1"># Include hidden files in globs</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>nocaseglob<span class="w">  </span><span class="c1"># Case-insensitive globbing</span>

<span class="c1"># Disable options</span>
<span class="nb">shopt</span><span class="w"> </span>-u<span class="w"> </span>dotglob<span class="w">  </span><span class="c1"># Exclude hidden files</span>

<span class="c1"># Check if option is set</span>
<span class="k">if</span><span class="w"> </span><span class="nb">shopt</span><span class="w"> </span>-q<span class="w"> </span>nullglob<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;nullglob is enabled&quot;</span>
<span class="k">fi</span>

<span class="c1"># Example: nullglob</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>nullglob
<span class="nv">files</span><span class="o">=(</span>*.txt<span class="o">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;No .txt files found&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Found </span><span class="si">${#</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2"> .txt files&quot;</span>
<span class="k">fi</span>

<span class="c1"># Example: globstar</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>globstar
<span class="c1"># Find all Python files recursively</span>
<span class="k">for</span><span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span>**/*.py<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Example: extglob (covered more in Lesson 04)</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>extglob
rm<span class="w"> </span>!<span class="o">(</span>*.txt<span class="p">|</span>*.log<span class="o">)</span><span class="w">  </span><span class="c1"># Remove all except .txt and .log files</span>
</code></pre></div>

<h3 id="useful-shopt-options">Useful shopt Options<a class="header-link" href="#useful-shopt-options" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>extglob</code></td>
<td>Extended pattern matching (!(pat), *(pat), etc.)</td>
</tr>
<tr>
<td><code>globstar</code></td>
<td>** matches recursively</td>
</tr>
<tr>
<td><code>nullglob</code></td>
<td>Non-matching globs expand to null, not literal</td>
</tr>
<tr>
<td><code>dotglob</code></td>
<td>Include hidden files in pathname expansion</td>
</tr>
<tr>
<td><code>nocaseglob</code></td>
<td>Case-insensitive pathname expansion</td>
</tr>
<tr>
<td><code>failglob</code></td>
<td>Unmatched globs cause error</td>
</tr>
<tr>
<td><code>checkjobs</code></td>
<td>Check running jobs before exiting</td>
</tr>
<tr>
<td><code>autocd</code></td>
<td>Change directory by typing directory name</td>
</tr>
<tr>
<td><code>cdspell</code></td>
<td>Autocorrect minor cd errors</td>
</tr>
</tbody>
</table>
<h3 id="strict-mode-example">Strict Mode Example<a class="header-link" href="#strict-mode-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># Strict mode for safer scripts</span>

<span class="nb">set</span><span class="w"> </span>-euo<span class="w"> </span>pipefail
<span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n\t&#39;</span>

<span class="c1"># -e: exit on error</span>
<span class="c1"># -u: error on undefined variable</span>
<span class="c1"># -o pipefail: pipeline fails if any command fails</span>
<span class="c1"># IFS: safer word splitting</span>

<span class="c1"># Now errors will stop the script</span>
command_that_fails<span class="w">  </span><span class="c1"># Script exits here</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This won&#39;t execute&quot;</span>

<span class="c1"># To handle errors explicitly:</span>
<span class="k">if</span><span class="w"> </span>!<span class="w"> </span>command_that_might_fail<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Command failed, handling error&quot;</span>
<span class="w">    </span><span class="c1"># Do cleanup</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span>
</code></pre></div>

<h2 id="7-the-env-command-and-usrbinenv-bash">7. The env Command and #!/usr/bin/env bash<a class="header-link" href="#7-the-env-command-and-usrbinenv-bash" title="Permanent link">&para;</a></h2>
<h3 id="why-use-usrbinenv-bash">Why Use #!/usr/bin/env bash<a class="header-link" href="#why-use-usrbinenv-bash" title="Permanent link">&para;</a></h3>
<p>The shebang line tells the system which interpreter to use. Two approaches:</p>
<p><strong>Direct path</strong>: <code>#!/bin/bash</code>
- Fast (no PATH search)
- Not portable (bash might be in /usr/local/bin)</p>
<p><strong>env approach</strong>: <code>#!/usr/bin/env bash</code>
- Portable (finds bash in PATH)
- Standard in modern scripts
- Works across different systems</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>
<span class="c1"># This finds bash wherever it is in PATH</span>

<span class="c1"># Check where bash is located</span>
which<span class="w"> </span>bash

<span class="c1"># On macOS: /bin/bash</span>
<span class="c1"># On FreeBSD: /usr/local/bin/bash</span>
<span class="c1"># On Nix: /nix/store/.../bin/bash</span>
</code></pre></div>

<h3 id="using-env-to-set-environment">Using env to Set Environment<a class="header-link" href="#using-env-to-set-environment" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env -S bash -euo pipefail</span>
<span class="c1"># -S flag allows passing multiple arguments (GNU env 8.30+)</span>

<span class="c1"># Alternative for older env:</span>
<span class="c1">#!/usr/bin/env bash</span>
<span class="nb">set</span><span class="w"> </span>-euo<span class="w"> </span>pipefail
</code></pre></div>

<h3 id="env-for-clean-environment">env for Clean Environment<a class="header-link" href="#env-for-clean-environment" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Run command with clean environment</span>
env<span class="w"> </span>-i<span class="w"> </span>bash<span class="w"> </span>--norc<span class="w"> </span>--noprofile

<span class="c1"># Run with specific variables only</span>
env<span class="w"> </span>-i<span class="w"> </span><span class="nv">HOME</span><span class="o">=</span>/tmp<span class="w"> </span><span class="nv">USER</span><span class="o">=</span>testuser<span class="w"> </span>bash

<span class="c1"># Remove specific variables</span>
env<span class="w"> </span>-u<span class="w"> </span>DISPLAY<span class="w"> </span>firefox

<span class="c1"># Add variables</span>
env<span class="w"> </span><span class="nv">FOO</span><span class="o">=</span>bar<span class="w"> </span>./script.sh

<span class="c1"># Inspect environment</span>
env<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort
</code></pre></div>

<h3 id="script-template-with-best-practices">Script Template with Best Practices<a class="header-link" href="#script-template-with-best-practices" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>
<span class="c1"># Script: example.sh</span>
<span class="c1"># Description: Example script with best practices</span>
<span class="c1"># Author: Your Name</span>
<span class="c1"># Created: 2026-02-13</span>

<span class="c1"># Strict mode</span>
<span class="nb">set</span><span class="w"> </span>-euo<span class="w"> </span>pipefail
<span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n\t&#39;</span>

<span class="c1"># Trap errors</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;echo &quot;Error on line $LINENO&quot; &gt;&amp;2&#39;</span><span class="w"> </span>ERR

<span class="c1"># Useful shell options</span>
<span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>nullglob<span class="w"> </span>globstar

<span class="c1"># Constants</span>
<span class="nb">readonly</span><span class="w"> </span><span class="nv">SCRIPT_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>dirname<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nb">readonly</span><span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>basename<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># Functions</span>
usage<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<span class="s">Usage: $SCRIPT_NAME [OPTIONS] &lt;argument&gt;</span>

<span class="s">Options:</span>
<span class="s">    -h, --help      Show this help message</span>
<span class="s">    -v, --verbose   Enable verbose output</span>
<span class="s">    -d, --debug     Enable debug mode</span>

<span class="s">Examples:</span>
<span class="s">    $SCRIPT_NAME input.txt</span>
<span class="s">    $SCRIPT_NAME -v input.txt</span>
<span class="s">EOF</span>
<span class="o">}</span>

main<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1"># Main script logic</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Running from: </span><span class="nv">$SCRIPT_DIR</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Script name: </span><span class="nv">$SCRIPT_NAME</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Parse arguments</span>
<span class="k">while</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span>-h<span class="p">|</span>--help<span class="o">)</span>
<span class="w">            </span>usage
<span class="w">            </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>-v<span class="p">|</span>--verbose<span class="o">)</span>
<span class="w">            </span><span class="nb">set</span><span class="w"> </span>-x
<span class="w">            </span><span class="nb">shift</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>-d<span class="p">|</span>--debug<span class="o">)</span>
<span class="w">            </span><span class="nb">set</span><span class="w"> </span>-x
<span class="w">            </span><span class="nb">shift</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>-*<span class="o">)</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Unknown option: </span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">            </span>usage<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">            </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>*<span class="o">)</span>
<span class="w">            </span><span class="k">break</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>
<span class="k">done</span>

<span class="c1"># Run main function</span>
main<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</code></pre></div>

<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-shell-detection-script">Problem 1: Shell Detection Script<a class="header-link" href="#problem-1-shell-detection-script" title="Permanent link">&para;</a></h3>
<p>Write a script that detects:
- Which shell it's running in (bash, zsh, sh, etc.)
- Whether it's a login or non-login shell
- Whether it's interactive or non-interactive
- The version of the shell</p>
<p><strong>Expected output</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="n">Shell</span><span class="o">:</span><span class="w"> </span><span class="n">bash</span>
<span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="mf">5.1</span><span class="o">.</span><span class="mi">16</span>
<span class="n">Type</span><span class="o">:</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">login</span><span class="o">,</span><span class="w"> </span><span class="n">interactive</span>
</code></pre></div>

<h3 id="problem-2-startup-file-analyzer">Problem 2: Startup File Analyzer<a class="header-link" href="#problem-2-startup-file-analyzer" title="Permanent link">&para;</a></h3>
<p>Create a script that:
- Lists all bash startup files that exist on the system
- Shows the order they would be loaded for login vs non-login shells
- Displays the first 5 lines of each file
- Checks for common mistakes (like setting aliases in .bash_profile instead of .bashrc)</p>
<h3 id="problem-3-exit-code-logger">Problem 3: Exit Code Logger<a class="header-link" href="#problem-3-exit-code-logger" title="Permanent link">&para;</a></h3>
<p>Write a function that wraps any command and:
- Logs the command being executed
- Captures and logs the exit code
- Logs execution time
- Appends to a log file: <code>timestamp | command | exit_code | duration</code></p>
<p><strong>Example usage</strong>:</p>
<div class="highlight"><pre><span></span><code>log_command<span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span>/nonexistent
<span class="c1"># Should log: 2026-02-13 10:30:45 | ls -la /nonexistent | 2 | 0.003s</span>
</code></pre></div>

<h3 id="problem-4-portable-script-checker">Problem 4: Portable Script Checker<a class="header-link" href="#problem-4-portable-script-checker" title="Permanent link">&para;</a></h3>
<p>Create a script that analyzes another bash script and reports:
- Non-POSIX constructs used ([[ ]], arrays, etc.)
- Bashisms that would fail in sh
- Suggestions for making it more portable
- A "portability score" (0-100%)</p>
<p><strong>Hint</strong>: Search for patterns like <code>[[</code>, <code>declare</code>, <code>function keyword</code>, etc.</p>
<h3 id="problem-5-environment-snapshot">Problem 5: Environment Snapshot<a class="header-link" href="#problem-5-environment-snapshot" title="Permanent link">&para;</a></h3>
<p>Write a script that:
- Saves current environment variables to a file
- Saves current shell options (set -o, shopt -p) to a file
- Can restore the environment from the saved state
- Shows diff between saved and current state</p>
<p><strong>Usage</strong>:</p>
<div class="highlight"><pre><span></span><code>./envsnap.sh<span class="w"> </span>save<span class="w"> </span>snapshot.env
<span class="c1"># ... make changes ...</span>
./envsnap.sh<span class="w"> </span>diff<span class="w"> </span>snapshot.env
./envsnap.sh<span class="w"> </span>restore<span class="w"> </span>snapshot.env
</code></pre></div>

<hr />
<p><strong>Next</strong>: <a href="./02_Parameter_Expansion.md">02_Parameter_Expansion.md</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Shell_Script/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Shell Scripting Study Guide</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Shell_Script/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Shell_Script/02_Parameter_Expansion.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Parameter Expansion and Variable Attributes ‚≠ê‚≠ê</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}