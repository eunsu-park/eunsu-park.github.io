{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arrays and Data Structures ‚≠ê‚≠ê - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Shell_Script/">Shell Script</a>
    <span class="separator">/</span>
    <span class="current">Arrays and Data Structures ‚≠ê‚≠ê</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Arrays and Data Structures ‚≠ê‚≠ê</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Shell_Script/02_Parameter_Expansion.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Parameter Expansion and Variable Attributes ‚≠ê‚≠ê</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Shell_Script/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Shell_Script/04_Advanced_Control_Flow.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Advanced Control Flow ‚≠ê‚≠ê</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#1-indexed-array-operations">1. Indexed Array Operations</a><ul>
<li><a href="#array-declaration-and-initialization">Array Declaration and Initialization</a></li>
<li><a href="#accessing-array-elements">Accessing Array Elements</a></li>
<li><a href="#modifying-arrays">Modifying Arrays</a></li>
<li><a href="#array-slicing">Array Slicing</a></li>
<li><a href="#iteration">Iteration</a></li>
<li><a href="#array-copying-and-merging">Array Copying and Merging</a></li>
</ul>
</li>
<li><a href="#2-associative-arrays">2. Associative Arrays</a><ul>
<li><a href="#declaration-and-basic-operations">Declaration and Basic Operations</a></li>
<li><a href="#iteration_1">Iteration</a></li>
<li><a href="#comparison-indexed-vs-associative-arrays">Comparison: Indexed vs Associative Arrays</a></li>
<li><a href="#practical-examples">Practical Examples</a></li>
<li><a href="#nested-data-simulation">Nested Data Simulation</a></li>
</ul>
</li>
<li><a href="#3-array-patterns-stack-queue-set">3. Array Patterns: Stack, Queue, Set</a><ul>
<li><a href="#stack-lifo-last-in-first-out">Stack (LIFO - Last In, First Out)</a></li>
<li><a href="#queue-fifo-first-in-first-out">Queue (FIFO - First In, First Out)</a></li>
<li><a href="#set-unique-values">Set (Unique Values)</a></li>
</ul>
</li>
<li><a href="#4-csv-parsing">4. CSV Parsing</a><ul>
<li><a href="#basic-csv-reader">Basic CSV Reader</a></li>
<li><a href="#advanced-csv-parser-handles-quotes">Advanced CSV Parser (Handles Quotes)</a></li>
<li><a href="#csv-column-extraction">CSV Column Extraction</a></li>
<li><a href="#csv-to-associative-array">CSV to Associative Array</a></li>
</ul>
</li>
<li><a href="#5-config-file-loading">5. Config File Loading</a><ul>
<li><a href="#simple-key-value-config">Simple Key-Value Config</a></li>
<li><a href="#ini-style-config-with-sections">INI-Style Config with Sections</a></li>
<li><a href="#config-with-defaults">Config with Defaults</a></li>
</ul>
</li>
<li><a href="#6-multi-dimensional-data">6. Multi-Dimensional Data</a><ul>
<li><a href="#2d-array-simulation">2D Array Simulation</a></li>
<li><a href="#table-data-structure">Table Data Structure</a></li>
<li><a href="#serialization-with-declare-p">Serialization with declare -p</a></li>
</ul>
</li>
<li><a href="#7-practical-patterns">7. Practical Patterns</a><ul>
<li><a href="#argument-collection">Argument Collection</a></li>
<li><a href="#building-commands-dynamically">Building Commands Dynamically</a></li>
<li><a href="#safe-word-splitting">Safe Word Splitting</a></li>
</ul>
</li>
<li><a href="#practice-problems">Practice Problems</a><ul>
<li><a href="#problem-1-advanced-csv-processor">Problem 1: Advanced CSV Processor</a></li>
<li><a href="#problem-2-configuration-manager">Problem 2: Configuration Manager</a></li>
<li><a href="#problem-3-data-structure-library">Problem 3: Data Structure Library</a></li>
<li><a href="#problem-4-table-data-processor">Problem 4: Table Data Processor</a></li>
<li><a href="#problem-5-log-aggregator">Problem 5: Log Aggregator</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="arrays-and-data-structures">Arrays and Data Structures ‚≠ê‚≠ê<a class="header-link" href="#arrays-and-data-structures" title="Permanent link">&para;</a></h1>
<p><strong>Previous</strong>: <a href="./02_Parameter_Expansion.md">02_Parameter_Expansion.md</a> | <strong>Next</strong>: <a href="./04_Advanced_Control_Flow.md">04_Advanced_Control_Flow.md</a></p>
<hr />
<p>This lesson covers bash arrays and how to work with structured data. We'll explore indexed and associative arrays, common data structure patterns, parsing CSV and config files, and practical techniques for managing complex data in shell scripts.</p>
<h2 id="1-indexed-array-operations">1. Indexed Array Operations<a class="header-link" href="#1-indexed-array-operations" title="Permanent link">&para;</a></h2>
<p>Indexed arrays store elements with numeric indices starting at 0.</p>
<h3 id="array-declaration-and-initialization">Array Declaration and Initialization<a class="header-link" href="#array-declaration-and-initialization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Empty array</span>
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>empty_array

<span class="c1"># Array with initial values</span>
<span class="nv">fruits</span><span class="o">=(</span><span class="s2">&quot;apple&quot;</span><span class="w"> </span><span class="s2">&quot;banana&quot;</span><span class="w"> </span><span class="s2">&quot;cherry&quot;</span><span class="o">)</span>

<span class="c1"># Explicit declaration</span>
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">numbers</span><span class="o">=(</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="o">)</span>

<span class="c1"># Sparse array (indices don&#39;t need to be continuous)</span>
sparse<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="s2">&quot;first&quot;</span>
sparse<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="s2">&quot;sixth&quot;</span>
sparse<span class="o">[</span><span class="m">10</span><span class="o">]=</span><span class="s2">&quot;eleventh&quot;</span>

<span class="c1"># Multi-line declaration</span>
<span class="nv">servers</span><span class="o">=(</span>
<span class="w">    </span><span class="s2">&quot;web1.example.com&quot;</span>
<span class="w">    </span><span class="s2">&quot;web2.example.com&quot;</span>
<span class="w">    </span><span class="s2">&quot;web3.example.com&quot;</span>
<span class="o">)</span>

<span class="c1"># From command output</span>
<span class="nv">files</span><span class="o">=(</span>*.txt<span class="o">)</span><span class="w">  </span><span class="c1"># All .txt files in current directory</span>
<span class="nv">lines</span><span class="o">=(</span><span class="k">$(</span>cat<span class="w"> </span>file.txt<span class="k">)</span><span class="o">)</span><span class="w">  </span><span class="c1"># WARNING: splits on whitespace</span>

<span class="c1"># Safe way to read lines into array</span>
mapfile<span class="w"> </span>-t<span class="w"> </span>lines<span class="w"> </span>&lt;<span class="w"> </span>file.txt
<span class="c1"># or</span>
readarray<span class="w"> </span>-t<span class="w"> </span>lines<span class="w"> </span>&lt;<span class="w"> </span>file.txt
</code></pre></div>

<h3 id="accessing-array-elements">Accessing Array Elements<a class="header-link" href="#accessing-array-elements" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">fruits</span><span class="o">=(</span><span class="s2">&quot;apple&quot;</span><span class="w"> </span><span class="s2">&quot;banana&quot;</span><span class="w"> </span><span class="s2">&quot;cherry&quot;</span><span class="w"> </span><span class="s2">&quot;date&quot;</span><span class="o">)</span>

<span class="c1"># Access single element</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">     </span><span class="c1"># apple</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[2]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">     </span><span class="c1"># cherry</span>

<span class="c1"># Access last element</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[-1]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">    </span><span class="c1"># date (bash 4.3+)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[@]: -1</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="c1"># date (older bash)</span>

<span class="c1"># Access all elements</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">     </span><span class="c1"># apple banana cherry date</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[*]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">     </span><span class="c1"># apple banana cherry date</span>

<span class="c1"># Difference between @ and *</span>
<span class="k">for</span><span class="w"> </span>fruit<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Fruit: </span><span class="nv">$fruit</span><span class="s2">&quot;</span>
<span class="k">done</span>
<span class="c1"># Iterates 4 times, one per element</span>

<span class="k">for</span><span class="w"> </span>fruit<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[*]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Fruit: </span><span class="nv">$fruit</span><span class="s2">&quot;</span>
<span class="k">done</span>
<span class="c1"># Iterates 1 time, all elements as single string</span>

<span class="c1"># Array length</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">    </span><span class="c1"># 4 (number of elements)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">fruits</span><span class="p">[*]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">    </span><span class="c1"># 4 (same)</span>

<span class="c1"># Length of specific element</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">fruits</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">    </span><span class="c1"># 6 (length of &quot;banana&quot;)</span>
</code></pre></div>

<h3 id="modifying-arrays">Modifying Arrays<a class="header-link" href="#modifying-arrays" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Append elements</span>
<span class="nv">fruits</span><span class="o">=(</span><span class="s2">&quot;apple&quot;</span><span class="w"> </span><span class="s2">&quot;banana&quot;</span><span class="o">)</span>
<span class="nv">fruits</span><span class="o">+=(</span><span class="s2">&quot;cherry&quot;</span><span class="o">)</span><span class="w">              </span><span class="c1"># Add one</span>
<span class="nv">fruits</span><span class="o">+=(</span><span class="s2">&quot;date&quot;</span><span class="w"> </span><span class="s2">&quot;elderberry&quot;</span><span class="o">)</span><span class="w">   </span><span class="c1"># Add multiple</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># apple banana cherry date elderberry</span>

<span class="c1"># Modify element</span>
fruits<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="s2">&quot;blueberry&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># apple blueberry cherry date elderberry</span>

<span class="c1"># Delete element (creates sparse array)</span>
<span class="nb">unset</span><span class="w"> </span><span class="s1">&#39;fruits[2]&#39;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">           </span><span class="c1"># apple blueberry date elderberry</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">          </span><span class="c1"># 4 (still 4 elements)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!fruits[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">          </span><span class="c1"># 0 1 3 4 (indices)</span>

<span class="c1"># Delete entire array</span>
<span class="nb">unset</span><span class="w"> </span>fruits

<span class="c1"># Prepend elements (create new array)</span>
<span class="nv">nums</span><span class="o">=(</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="o">)</span>
<span class="nv">nums</span><span class="o">=(</span><span class="m">0</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">nums</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">nums</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 0 1 2 3</span>

<span class="c1"># Insert in middle (requires recreation)</span>
<span class="nv">arr</span><span class="o">=(</span>a<span class="w"> </span>b<span class="w"> </span>c<span class="w"> </span>d<span class="o">)</span>
<span class="nv">arr</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[@]:</span><span class="nv">0</span><span class="p">:</span><span class="nv">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;X&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[@]:</span><span class="nv">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># a b X c d</span>
</code></pre></div>

<h3 id="array-slicing">Array Slicing<a class="header-link" href="#array-slicing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># ${array[@]:start:length}</span>

<span class="nv">numbers</span><span class="o">=(</span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">9</span><span class="o">)</span>

<span class="c1"># Extract from index 2, length 3</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">numbers</span><span class="p">[@]:</span><span class="nv">2</span><span class="p">:</span><span class="nv">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 2 3 4</span>

<span class="c1"># Extract from index 5 to end</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">numbers</span><span class="p">[@]:</span><span class="nv">5</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">    </span><span class="c1"># 5 6 7 8 9</span>

<span class="c1"># Extract last 3 elements</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">numbers</span><span class="p">[@]: -3</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 7 8 9</span>

<span class="c1"># Copy array</span>
<span class="nv">copy</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">numbers</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">copy</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Copy slice</span>
<span class="nv">subset</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">numbers</span><span class="p">[@]:</span><span class="nv">2</span><span class="p">:</span><span class="nv">5</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">subset</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 2 3 4 5 6</span>
</code></pre></div>

<h3 id="iteration">Iteration<a class="header-link" href="#iteration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">servers</span><span class="o">=(</span><span class="s2">&quot;web1&quot;</span><span class="w"> </span><span class="s2">&quot;web2&quot;</span><span class="w"> </span><span class="s2">&quot;db1&quot;</span><span class="w"> </span><span class="s2">&quot;cache1&quot;</span><span class="o">)</span>

<span class="c1"># Iterate over values</span>
<span class="k">for</span><span class="w"> </span>server<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">servers</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Processing: </span><span class="nv">$server</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Iterate over indices</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!servers[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Server </span><span class="nv">$i</span><span class="s2">: </span><span class="si">${</span><span class="nv">servers</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Iterate with index using C-style for</span>
<span class="k">for</span><span class="w"> </span><span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span>i&lt;<span class="si">${#</span><span class="nv">servers</span><span class="p">[@]</span><span class="si">}</span><span class="p">;</span><span class="w"> </span>i++<span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$i</span><span class="s2">] = </span><span class="si">${</span><span class="nv">servers</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Iterate in reverse</span>
<span class="k">for</span><span class="w"> </span><span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="si">${#</span><span class="nv">servers</span><span class="p">[@]</span><span class="si">}</span>-1<span class="p">;</span><span class="w"> </span>i&gt;<span class="o">=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span>i--<span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">servers</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>
</code></pre></div>

<h3 id="array-copying-and-merging">Array Copying and Merging<a class="header-link" href="#array-copying-and-merging" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Copy array</span>
<span class="nv">original</span><span class="o">=(</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="o">)</span>
<span class="nv">copy</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">original</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
copy<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">99</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Original: </span><span class="si">${</span><span class="nv">original</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># 1 2 3</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Copy: </span><span class="si">${</span><span class="nv">copy</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">          </span><span class="c1"># 99 2 3</span>

<span class="c1"># Merge arrays</span>
<span class="nv">arr1</span><span class="o">=(</span>a<span class="w"> </span>b<span class="w"> </span>c<span class="o">)</span>
<span class="nv">arr2</span><span class="o">=(</span>d<span class="w"> </span>e<span class="w"> </span>f<span class="o">)</span>
<span class="nv">merged</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr1</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr2</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">merged</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># a b c d e f</span>

<span class="c1"># Merge multiple arrays</span>
<span class="nv">arr3</span><span class="o">=(</span>g<span class="w"> </span>h<span class="w"> </span>i<span class="o">)</span>
<span class="nv">all</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr1</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr2</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr3</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">all</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># a b c d e f g h i</span>

<span class="c1"># Append array to array</span>
<span class="nv">arr1</span><span class="o">+=(</span>x<span class="w"> </span>y<span class="w"> </span>z<span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr1</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># a b c x y z</span>
</code></pre></div>

<h2 id="2-associative-arrays">2. Associative Arrays<a class="header-link" href="#2-associative-arrays" title="Permanent link">&para;</a></h2>
<p>Associative arrays (hash maps, dictionaries) use strings as keys instead of numeric indices. Available in bash 4.0+.</p>
<h3 id="declaration-and-basic-operations">Declaration and Basic Operations<a class="header-link" href="#declaration-and-basic-operations" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Must declare as associative array</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>config

<span class="c1"># Assign values</span>
config<span class="o">[</span>host<span class="o">]=</span><span class="s2">&quot;localhost&quot;</span>
config<span class="o">[</span>port<span class="o">]=</span><span class="m">8080</span>
config<span class="o">[</span>database<span class="o">]=</span><span class="s2">&quot;myapp&quot;</span>

<span class="c1"># Alternative: initialize at declaration</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">user</span><span class="o">=(</span>
<span class="w">    </span><span class="o">[</span>name<span class="o">]=</span><span class="s2">&quot;John Doe&quot;</span>
<span class="w">    </span><span class="o">[</span>email<span class="o">]=</span><span class="s2">&quot;john@example.com&quot;</span>
<span class="w">    </span><span class="o">[</span>role<span class="o">]=</span><span class="s2">&quot;admin&quot;</span>
<span class="o">)</span>

<span class="c1"># Access values</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">config</span><span class="p">[host]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">     </span><span class="c1"># localhost</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">user</span><span class="p">[name]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">       </span><span class="c1"># John Doe</span>

<span class="c1"># Check if key exists</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-v<span class="w"> </span>config<span class="o">[</span>host<span class="o">]</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Host is configured&quot;</span>
<span class="k">fi</span>

<span class="c1"># Alternative key existence check</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">config</span><span class="p">[host]+exists</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;exists&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Host key exists&quot;</span>
<span class="k">fi</span>

<span class="c1"># Get all keys</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!config[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">       </span><span class="c1"># host port database</span>

<span class="c1"># Get all values</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">config</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">        </span><span class="c1"># localhost 8080 myapp</span>

<span class="c1"># Number of entries</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">config</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w">       </span><span class="c1"># 3</span>
</code></pre></div>

<h3 id="iteration_1">Iteration<a class="header-link" href="#iteration_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">settings</span><span class="o">=(</span>
<span class="w">    </span><span class="o">[</span>theme<span class="o">]=</span><span class="s2">&quot;dark&quot;</span>
<span class="w">    </span><span class="o">[</span>language<span class="o">]=</span><span class="s2">&quot;en&quot;</span>
<span class="w">    </span><span class="o">[</span>notifications<span class="o">]=</span><span class="s2">&quot;enabled&quot;</span>
<span class="w">    </span><span class="o">[</span>auto_save<span class="o">]=</span><span class="s2">&quot;true&quot;</span>
<span class="o">)</span>

<span class="c1"># Iterate over keys</span>
<span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!settings[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2"> = </span><span class="si">${</span><span class="nv">settings</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Iterate over values</span>
<span class="k">for</span><span class="w"> </span>value<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">settings</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Value: </span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Sort keys before iteration</span>
<span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!settings[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2"> = </span><span class="si">${</span><span class="nv">settings</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>
</code></pre></div>

<h3 id="comparison-indexed-vs-associative-arrays">Comparison: Indexed vs Associative Arrays<a class="header-link" href="#comparison-indexed-vs-associative-arrays" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Indexed Array</th>
<th>Associative Array</th>
</tr>
</thead>
<tbody>
<tr>
<td>Declaration</td>
<td><code>arr=()</code> or <code>declare -a arr</code></td>
<td><code>declare -A arr</code></td>
</tr>
<tr>
<td>Keys</td>
<td>Integers (0, 1, 2, ...)</td>
<td>Strings</td>
</tr>
<tr>
<td>Ordering</td>
<td>Preserved</td>
<td>Unordered</td>
</tr>
<tr>
<td>Available since</td>
<td>All bash versions</td>
<td>Bash 4.0+</td>
</tr>
<tr>
<td>Use case</td>
<td>Sequential data</td>
<td>Key-value pairs</td>
</tr>
<tr>
<td>Iteration</td>
<td>Order guaranteed</td>
<td>Order undefined</td>
</tr>
<tr>
<td>Access</td>
<td><code>${arr[0]}` | `${arr[key]}</code></td>
<td></td>
</tr>
<tr>
<td>All keys</td>
<td><code>${!arr[@]}` | `${!arr[@]}</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="practical-examples">Practical Examples<a class="header-link" href="#practical-examples" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># HTTP status codes</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">http_status</span><span class="o">=(</span>
<span class="w">    </span><span class="o">[</span><span class="m">200</span><span class="o">]=</span><span class="s2">&quot;OK&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="m">201</span><span class="o">]=</span><span class="s2">&quot;Created&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="m">301</span><span class="o">]=</span><span class="s2">&quot;Moved Permanently&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="m">400</span><span class="o">]=</span><span class="s2">&quot;Bad Request&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="m">401</span><span class="o">]=</span><span class="s2">&quot;Unauthorized&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="m">403</span><span class="o">]=</span><span class="s2">&quot;Forbidden&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="m">404</span><span class="o">]=</span><span class="s2">&quot;Not Found&quot;</span>
<span class="w">    </span><span class="o">[</span><span class="m">500</span><span class="o">]=</span><span class="s2">&quot;Internal Server Error&quot;</span>
<span class="o">)</span>

lookup_status<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">code</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-v<span class="w"> </span>http_status<span class="o">[</span><span class="nv">$code</span><span class="o">]</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$code</span><span class="s2"> </span><span class="si">${</span><span class="nv">http_status</span><span class="p">[</span><span class="nv">$code</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$code</span><span class="s2"> Unknown&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

lookup_status<span class="w"> </span><span class="m">200</span><span class="w">  </span><span class="c1"># 200 OK</span>
lookup_status<span class="w"> </span><span class="m">404</span><span class="w">  </span><span class="c1"># 404 Not Found</span>
lookup_status<span class="w"> </span><span class="m">999</span><span class="w">  </span><span class="c1"># 999 Unknown</span>

<span class="c1"># Environment-specific configuration</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">db_config_dev</span><span class="o">=(</span>
<span class="w">    </span><span class="o">[</span>host<span class="o">]=</span><span class="s2">&quot;localhost&quot;</span>
<span class="w">    </span><span class="o">[</span>port<span class="o">]=</span><span class="m">5432</span>
<span class="w">    </span><span class="o">[</span>name<span class="o">]=</span><span class="s2">&quot;dev_db&quot;</span>
<span class="w">    </span><span class="o">[</span>user<span class="o">]=</span><span class="s2">&quot;dev_user&quot;</span>
<span class="o">)</span>

<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">db_config_prod</span><span class="o">=(</span>
<span class="w">    </span><span class="o">[</span>host<span class="o">]=</span><span class="s2">&quot;db.example.com&quot;</span>
<span class="w">    </span><span class="o">[</span>port<span class="o">]=</span><span class="m">5432</span>
<span class="w">    </span><span class="o">[</span>name<span class="o">]=</span><span class="s2">&quot;prod_db&quot;</span>
<span class="w">    </span><span class="o">[</span>user<span class="o">]=</span><span class="s2">&quot;app_user&quot;</span>
<span class="o">)</span>

get_db_config<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">env</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">config_ref</span><span class="o">=</span><span class="s2">&quot;db_config_</span><span class="nv">$env</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Database configuration for </span><span class="nv">$env</span><span class="s2">:&quot;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!config_ref[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  </span><span class="nv">$key</span><span class="s2">: </span><span class="si">${</span><span class="nv">config_ref</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">done</span>
<span class="o">}</span>

get_db_config<span class="w"> </span><span class="s2">&quot;dev&quot;</span>
get_db_config<span class="w"> </span><span class="s2">&quot;prod&quot;</span>
</code></pre></div>

<h3 id="nested-data-simulation">Nested Data Simulation<a class="header-link" href="#nested-data-simulation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Simulate nested structure using naming convention</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>data

<span class="c1"># user.name</span>
data<span class="o">[</span>user.name<span class="o">]=</span><span class="s2">&quot;John Doe&quot;</span>
data<span class="o">[</span>user.email<span class="o">]=</span><span class="s2">&quot;john@example.com&quot;</span>
data<span class="o">[</span>user.age<span class="o">]=</span><span class="m">30</span>

<span class="c1"># user.address.city</span>
data<span class="o">[</span>user.address.city<span class="o">]=</span><span class="s2">&quot;New York&quot;</span>
data<span class="o">[</span>user.address.country<span class="o">]=</span><span class="s2">&quot;USA&quot;</span>

<span class="c1"># settings.theme</span>
data<span class="o">[</span>settings.theme<span class="o">]=</span><span class="s2">&quot;dark&quot;</span>
data<span class="o">[</span>settings.language<span class="o">]=</span><span class="s2">&quot;en&quot;</span>

<span class="c1"># Access nested data</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Name: </span><span class="si">${</span><span class="nv">data</span><span class="p">[user.name]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;City: </span><span class="si">${</span><span class="nv">data</span><span class="p">[user.address.city]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Theme: </span><span class="si">${</span><span class="nv">data</span><span class="p">[settings.theme]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Get all user.address.* keys</span>
<span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!data[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>user.address.*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2"> = </span><span class="si">${</span><span class="nv">data</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">done</span>
</code></pre></div>

<h2 id="3-array-patterns-stack-queue-set">3. Array Patterns: Stack, Queue, Set<a class="header-link" href="#3-array-patterns-stack-queue-set" title="Permanent link">&para;</a></h2>
<h3 id="stack-lifo-last-in-first-out">Stack (LIFO - Last In, First Out)<a class="header-link" href="#stack-lifo-last-in-first-out" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Stack implementation using array</span>
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>stack

<span class="c1"># Push</span>
push<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">stack</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1"># Pop</span>
pop<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">stack</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">stack</span><span class="p">[-1]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">unset</span><span class="w"> </span><span class="s1">&#39;stack[-1]&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Peek (view top without removing)</span>
peek<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">stack</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">stack</span><span class="p">[-1]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Is empty</span>
is_empty<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">stack</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span>
<span class="o">}</span>

<span class="c1"># Size</span>
size<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">stack</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Usage</span>
push<span class="w"> </span><span class="s2">&quot;first&quot;</span>
push<span class="w"> </span><span class="s2">&quot;second&quot;</span>
push<span class="w"> </span><span class="s2">&quot;third&quot;</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Top: </span><span class="k">$(</span>peek<span class="k">)</span><span class="s2">&quot;</span><span class="w">           </span><span class="c1"># third</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Size: </span><span class="k">$(</span>size<span class="k">)</span><span class="s2">&quot;</span><span class="w">          </span><span class="c1"># 3</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Pop: </span><span class="k">$(</span>pop<span class="k">)</span><span class="s2">&quot;</span><span class="w">            </span><span class="c1"># third</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Pop: </span><span class="k">$(</span>pop<span class="k">)</span><span class="s2">&quot;</span><span class="w">            </span><span class="c1"># second</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Size: </span><span class="k">$(</span>size<span class="k">)</span><span class="s2">&quot;</span><span class="w">          </span><span class="c1"># 1</span>
</code></pre></div>

<h3 id="queue-fifo-first-in-first-out">Queue (FIFO - First In, First Out)<a class="header-link" href="#queue-fifo-first-in-first-out" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Queue implementation using array</span>
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>queue

<span class="c1"># Enqueue (add to end)</span>
enqueue<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">queue</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1"># Dequeue (remove from front)</span>
dequeue<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">queue</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">queue</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nv">queue</span><span class="o">=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">queue</span><span class="p">[@]:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span><span class="w">  </span><span class="c1"># Remove first element</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Front (peek at first element)</span>
front<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">queue</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">queue</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Usage</span>
enqueue<span class="w"> </span><span class="s2">&quot;job1&quot;</span>
enqueue<span class="w"> </span><span class="s2">&quot;job2&quot;</span>
enqueue<span class="w"> </span><span class="s2">&quot;job3&quot;</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Front: </span><span class="k">$(</span>front<span class="k">)</span><span class="s2">&quot;</span><span class="w">         </span><span class="c1"># job1</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Dequeue: </span><span class="k">$(</span>dequeue<span class="k">)</span><span class="s2">&quot;</span><span class="w">     </span><span class="c1"># job1</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Dequeue: </span><span class="k">$(</span>dequeue<span class="k">)</span><span class="s2">&quot;</span><span class="w">     </span><span class="c1"># job2</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Front: </span><span class="k">$(</span>front<span class="k">)</span><span class="s2">&quot;</span><span class="w">         </span><span class="c1"># job3</span>
</code></pre></div>

<h3 id="set-unique-values">Set (Unique Values)<a class="header-link" href="#set-unique-values" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Set implementation using associative array</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nb">set</span>

<span class="c1"># Add element</span>
set_add<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span>set<span class="o">[</span><span class="nv">$value</span><span class="o">]=</span><span class="m">1</span>
<span class="o">}</span>

<span class="c1"># Remove element</span>
set_remove<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">unset</span><span class="w"> </span><span class="s2">&quot;set[</span><span class="nv">$value</span><span class="s2">]&quot;</span>
<span class="o">}</span>

<span class="c1"># Contains</span>
set_contains<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span>-v<span class="w"> </span>set<span class="o">[</span><span class="nv">$value</span><span class="o">]</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

<span class="c1"># Size</span>
set_size<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">set</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Get all elements</span>
set_elements<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!set[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Union</span>
set_union<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">set1</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">set2</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-A<span class="w"> </span>result

<span class="w">    </span><span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!set1[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span>result<span class="o">[</span><span class="nv">$key</span><span class="o">]=</span><span class="m">1</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!set2[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span>result<span class="o">[</span><span class="nv">$key</span><span class="o">]=</span><span class="m">1</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!result[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Intersection</span>
set_intersection<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">set1</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">set2</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-A<span class="w"> </span>result

<span class="w">    </span><span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!set1[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-v<span class="w"> </span>set2<span class="o">[</span><span class="nv">$key</span><span class="o">]</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>result<span class="o">[</span><span class="nv">$key</span><span class="o">]=</span><span class="m">1</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!result[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Usage</span>
set_add<span class="w"> </span><span class="s2">&quot;apple&quot;</span>
set_add<span class="w"> </span><span class="s2">&quot;banana&quot;</span>
set_add<span class="w"> </span><span class="s2">&quot;cherry&quot;</span>
set_add<span class="w"> </span><span class="s2">&quot;apple&quot;</span><span class="w">  </span><span class="c1"># Duplicate, ignored</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Size: </span><span class="k">$(</span>set_size<span class="k">)</span><span class="s2">&quot;</span><span class="w">      </span><span class="c1"># 3</span>
set_contains<span class="w"> </span><span class="s2">&quot;banana&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Contains banana&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Elements: </span><span class="k">$(</span>set_elements<span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># Set operations</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">set_a</span><span class="o">=([</span><span class="s2">&quot;a&quot;</span><span class="o">]=</span><span class="m">1</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;b&quot;</span><span class="o">]=</span><span class="m">1</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;c&quot;</span><span class="o">]=</span><span class="m">1</span><span class="o">)</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">set_b</span><span class="o">=([</span><span class="s2">&quot;b&quot;</span><span class="o">]=</span><span class="m">1</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;c&quot;</span><span class="o">]=</span><span class="m">1</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;d&quot;</span><span class="o">]=</span><span class="m">1</span><span class="o">)</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Union: </span><span class="k">$(</span>set_union<span class="w"> </span>set_a<span class="w"> </span>set_b<span class="k">)</span><span class="s2">&quot;</span><span class="w">           </span><span class="c1"># a b c d</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Intersection: </span><span class="k">$(</span>set_intersection<span class="w"> </span>set_a<span class="w"> </span>set_b<span class="k">)</span><span class="s2">&quot;</span><span class="w">  </span><span class="c1"># b c</span>
</code></pre></div>

<h2 id="4-csv-parsing">4. CSV Parsing<a class="header-link" href="#4-csv-parsing" title="Permanent link">&para;</a></h2>
<p>Parse CSV (Comma-Separated Values) files into arrays.</p>
<h3 id="basic-csv-reader">Basic CSV Reader<a class="header-link" href="#basic-csv-reader" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Read CSV into array</span>
read_csv<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">rows_ref</span><span class="o">=</span><span class="nv">$2</span>

<span class="w">    </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span>line
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nv">rows_ref</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Parse CSV line into array</span>
parse_csv_line<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">fields_ref</span><span class="o">=</span><span class="nv">$2</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>
<span class="w">    </span><span class="nb">read</span><span class="w"> </span>-ra<span class="w"> </span>fields_ref<span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Example CSV file</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>data.csv<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">name,age,city</span>
<span class="s">John,30,New York</span>
<span class="s">Jane,25,Los Angeles</span>
<span class="s">Bob,35,Chicago</span>
<span class="s">EOF</span>

<span class="c1"># Read and parse</span>
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>rows
read_csv<span class="w"> </span><span class="s2">&quot;data.csv&quot;</span><span class="w"> </span>rows

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Total rows: </span><span class="si">${#</span><span class="nv">rows</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">for</span><span class="w"> </span>row<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">rows</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>fields
<span class="w">    </span>parse_csv_line<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$row</span><span class="s2">&quot;</span><span class="w"> </span>fields
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Fields: </span><span class="si">${</span><span class="nv">fields</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

rm<span class="w"> </span>data.csv
</code></pre></div>

<h3 id="advanced-csv-parser-handles-quotes">Advanced CSV Parser (Handles Quotes)<a class="header-link" href="#advanced-csv-parser-handles-quotes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Parse CSV with quoted fields</span>
parse_csv_advanced<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">result</span><span class="o">=</span><span class="nv">$2</span>

<span class="w">    </span><span class="nv">result</span><span class="o">=()</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">field</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">in_quotes</span><span class="o">=</span><span class="nb">false</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>i<span class="w"> </span>char

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span>i&lt;<span class="si">${#</span><span class="nv">line</span><span class="si">}</span><span class="p">;</span><span class="w"> </span>i++<span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nv">char</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">:</span><span class="nv">i</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$char</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">            </span><span class="s1">&#39;&quot;&#39;</span><span class="o">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nv">$in_quotes</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c1"># Check for escaped quote &quot;&quot;</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">:</span><span class="nv">i</span><span class="p">+1:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                        </span><span class="nv">field</span><span class="o">+=</span><span class="s2">&quot;</span><span class="nv">$char</span><span class="s2">&quot;</span>
<span class="w">                        </span><span class="o">((</span>i++<span class="o">))</span>
<span class="w">                    </span><span class="k">else</span>
<span class="w">                        </span><span class="nv">in_quotes</span><span class="o">=</span><span class="nb">false</span>
<span class="w">                    </span><span class="k">fi</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                    </span><span class="nv">in_quotes</span><span class="o">=</span><span class="nb">true</span>
<span class="w">                </span><span class="k">fi</span>
<span class="w">                </span><span class="p">;;</span>
<span class="w">            </span><span class="s1">&#39;,&#39;</span><span class="o">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nv">$in_quotes</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="nv">field</span><span class="o">+=</span><span class="s2">&quot;</span><span class="nv">$char</span><span class="s2">&quot;</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                    </span><span class="nv">result</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$field</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">                    </span><span class="nv">field</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="w">                </span><span class="k">fi</span>
<span class="w">                </span><span class="p">;;</span>
<span class="w">            </span>*<span class="o">)</span>
<span class="w">                </span><span class="nv">field</span><span class="o">+=</span><span class="s2">&quot;</span><span class="nv">$char</span><span class="s2">&quot;</span>
<span class="w">                </span><span class="p">;;</span>
<span class="w">        </span><span class="k">esac</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="c1"># Add last field</span>
<span class="w">    </span><span class="nv">result</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$field</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1"># Test CSV with quotes</span>
<span class="nv">csv_line</span><span class="o">=</span><span class="s1">&#39;John,&quot;New York, NY&quot;,&quot;He said &quot;&quot;Hello&quot;&quot;&quot;&#39;</span>

<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>fields
parse_csv_advanced<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$csv_line</span><span class="s2">&quot;</span><span class="w"> </span>fields

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Number of fields: </span><span class="si">${#</span><span class="nv">fields</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!fields[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Field </span><span class="nv">$i</span><span class="s2">: </span><span class="si">${</span><span class="nv">fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>
<span class="c1"># Field 0: John</span>
<span class="c1"># Field 1: New York, NY</span>
<span class="c1"># Field 2: He said &quot;Hello&quot;</span>
</code></pre></div>

<h3 id="csv-column-extraction">CSV Column Extraction<a class="header-link" href="#csv-column-extraction" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Extract specific column from CSV</span>
extract_column<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">column_index</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">result</span><span class="o">=</span><span class="nv">$3</span>

<span class="w">    </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span>line
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span>,<span class="w"> </span><span class="nb">read</span><span class="w"> </span>-ra<span class="w"> </span>fields<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">fields</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-gt<span class="w"> </span><span class="nv">$column_index</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nv">result</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">fields</span><span class="p">[</span><span class="nv">$column_index</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Example</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>employees.csv<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">name,department,salary</span>
<span class="s">John,Engineering,80000</span>
<span class="s">Jane,Marketing,75000</span>
<span class="s">Bob,Engineering,85000</span>
<span class="s">Alice,Sales,70000</span>
<span class="s">EOF</span>

<span class="c1"># Extract departments (column 1)</span>
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>departments
extract_column<span class="w"> </span><span class="s2">&quot;employees.csv&quot;</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>departments

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Departments:&quot;</span>
<span class="k">for</span><span class="w"> </span>dept<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">departments</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  </span><span class="nv">$dept</span><span class="s2">&quot;</span>
<span class="k">done</span>

rm<span class="w"> </span>employees.csv
</code></pre></div>

<h3 id="csv-to-associative-array">CSV to Associative Array<a class="header-link" href="#csv-to-associative-array" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Load CSV into array of associative arrays</span>
load_csv_records<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">records_ref</span><span class="o">=</span><span class="nv">$2</span>

<span class="w">    </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>

<span class="w">    </span><span class="c1"># Read header</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>header
<span class="w">    </span><span class="nv">IFS</span><span class="o">=</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>header<span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># Parse header</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>
<span class="w">    </span><span class="nb">read</span><span class="w"> </span>-ra<span class="w"> </span>headers<span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$header</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># Read data rows</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>line<span class="w"> </span><span class="nv">row_num</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="c1"># Skip header</span>
<span class="w">        </span><span class="o">[</span><span class="w"> </span><span class="nv">$row_num</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="o">((</span>row_num++<span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>

<span class="w">        </span><span class="c1"># Parse row</span>
<span class="w">        </span><span class="nb">local</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>
<span class="w">        </span><span class="nb">read</span><span class="w"> </span>-ra<span class="w"> </span>values<span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="c1"># Create record name</span>
<span class="w">        </span><span class="nb">local</span><span class="w"> </span><span class="nv">record_prefix</span><span class="o">=</span><span class="s2">&quot;record_</span><span class="si">${</span><span class="nv">row_num</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="c1"># Store each field</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!headers[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">            </span><span class="nb">local</span><span class="w"> </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">record_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">headers</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span>records_ref<span class="o">[</span><span class="nv">$key</span><span class="o">]=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">values</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">done</span>

<span class="w">        </span><span class="o">((</span>row_num++<span class="o">))</span>
<span class="w">    </span><span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># Return number of records</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="k">$((</span><span class="nv">row_num</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="o">}</span>

<span class="c1"># Example</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>users.csv<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">name,email,role</span>
<span class="s">John,john@example.com,admin</span>
<span class="s">Jane,jane@example.com,user</span>
<span class="s">Bob,bob@example.com,user</span>
<span class="s">EOF</span>

<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>records
<span class="nv">num_records</span><span class="o">=</span><span class="k">$(</span>load_csv_records<span class="w"> </span><span class="s2">&quot;users.csv&quot;</span><span class="w"> </span>records<span class="k">)</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Loaded </span><span class="nv">$num_records</span><span class="s2"> records&quot;</span>

<span class="c1"># Access records</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>seq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="nv">$num_records</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Record </span><span class="nv">$i</span><span class="s2">:&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  Name: </span><span class="si">${</span><span class="nv">records</span><span class="p">[record_</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="nv">_name</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  Email: </span><span class="si">${</span><span class="nv">records</span><span class="p">[record_</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="nv">_email</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  Role: </span><span class="si">${</span><span class="nv">records</span><span class="p">[record_</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="nv">_role</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

rm<span class="w"> </span>users.csv
</code></pre></div>

<h2 id="5-config-file-loading">5. Config File Loading<a class="header-link" href="#5-config-file-loading" title="Permanent link">&para;</a></h2>
<h3 id="simple-key-value-config">Simple Key-Value Config<a class="header-link" href="#simple-key-value-config" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Load key=value config file</span>
load_config<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">config_file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">config_ref</span><span class="o">=</span><span class="nv">$2</span>

<span class="w">    </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$config_file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span>line<span class="w"> </span>key<span class="w"> </span>value
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="c1"># Skip empty lines and comments</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[[</span>:space:<span class="o">]]</span>*$<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">continue</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[[</span>:space:<span class="o">]]</span>*#<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">continue</span>

<span class="w">        </span><span class="c1"># Remove inline comments</span>
<span class="w">        </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%%#*</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="c1"># Trim whitespace</span>
<span class="w">        </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="c1"># Must contain =</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>*<span class="o">=</span>*<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">continue</span>

<span class="w">        </span><span class="c1"># Parse key=value</span>
<span class="w">        </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%%=*</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">#*=</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="c1"># Trim key and value</span>
<span class="w">        </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="c1"># Remove quotes from value</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="se">\&quot;</span>.*<span class="se">\&quot;</span>$<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="se">\&#39;</span>.*<span class="se">\&#39;</span>$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">:</span><span class="nv">1</span><span class="k">:-</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">fi</span>

<span class="w">        </span>config_ref<span class="o">[</span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$config_file</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Example config file</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>app.conf<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s"># Application configuration</span>
<span class="s">host = localhost</span>
<span class="s">port = 8080</span>
<span class="s">database = &quot;myapp&quot;</span>

<span class="s"># Feature flags</span>
<span class="s">debug = true</span>
<span class="s">verbose = false  # Verbose logging</span>
<span class="s">EOF</span>

<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>config
load_config<span class="w"> </span><span class="s2">&quot;app.conf&quot;</span><span class="w"> </span>config

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Configuration:&quot;</span>
<span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!config[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  </span><span class="nv">$key</span><span class="s2"> = </span><span class="si">${</span><span class="nv">config</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

rm<span class="w"> </span>app.conf
</code></pre></div>

<h3 id="ini-style-config-with-sections">INI-Style Config with Sections<a class="header-link" href="#ini-style-config-with-sections" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Load INI-style config with sections</span>
load_ini_config<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">config_file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">config_ref</span><span class="o">=</span><span class="nv">$2</span>

<span class="w">    </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$config_file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">section</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>line<span class="w"> </span>key<span class="w"> </span>value

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="c1"># Skip empty and comments</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[[</span>:space:<span class="o">]]</span>*$<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">continue</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[[</span>:space:<span class="o">]]</span>*<span class="o">[</span><span class="c1">#\;] ]] &amp;&amp; continue</span>

<span class="w">        </span><span class="c1"># Trim whitespace</span>
<span class="w">        </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="c1"># Section header</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="se">\[</span>.*<span class="se">\]</span>$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nv">section</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">:</span><span class="nv">1</span><span class="k">:-</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="k">fi</span>

<span class="w">        </span><span class="c1"># Key=value</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="o">=</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%%=*</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">#*=</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="c1"># Trim</span>
<span class="w">            </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="c1"># Remove quotes</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="se">\&quot;</span>.*<span class="se">\&quot;</span>$<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="se">\&#39;</span>.*<span class="se">\&#39;</span>$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">:</span><span class="nv">1</span><span class="k">:-</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="k">fi</span>

<span class="w">            </span><span class="c1"># Store with section prefix</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$section</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span>config_ref<span class="o">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">section</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span>config_ref<span class="o">[</span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="k">fi</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$config_file</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Example INI file</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>config.ini<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">; Global settings</span>
<span class="s">timeout = 30</span>

<span class="s">[database]</span>
<span class="s">host = localhost</span>
<span class="s">port = 5432</span>
<span class="s">name = myapp</span>

<span class="s">[cache]</span>
<span class="s">host = localhost</span>
<span class="s">port = 6379</span>
<span class="s">ttl = 3600</span>
<span class="s">EOF</span>

<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>config
load_ini_config<span class="w"> </span><span class="s2">&quot;config.ini&quot;</span><span class="w"> </span>config

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Configuration:&quot;</span>
<span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!config[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  </span><span class="nv">$key</span><span class="s2"> = </span><span class="si">${</span><span class="nv">config</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

<span class="c1"># Access specific sections</span>
<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nDatabase config:&quot;</span>
<span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!config[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>database.*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  </span><span class="si">${</span><span class="nv">key</span><span class="p">#database.</span><span class="si">}</span><span class="s2"> = </span><span class="si">${</span><span class="nv">config</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">done</span>

rm<span class="w"> </span>config.ini
</code></pre></div>

<h3 id="config-with-defaults">Config with Defaults<a class="header-link" href="#config-with-defaults" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Config loader with default values</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">default_config</span><span class="o">=(</span>
<span class="w">    </span><span class="o">[</span>host<span class="o">]=</span><span class="s2">&quot;localhost&quot;</span>
<span class="w">    </span><span class="o">[</span>port<span class="o">]=</span><span class="s2">&quot;8080&quot;</span>
<span class="w">    </span><span class="o">[</span>debug<span class="o">]=</span><span class="s2">&quot;false&quot;</span>
<span class="w">    </span><span class="o">[</span>max_connections<span class="o">]=</span><span class="s2">&quot;100&quot;</span>
<span class="w">    </span><span class="o">[</span>timeout<span class="o">]=</span><span class="s2">&quot;30&quot;</span>
<span class="o">)</span>

load_config_with_defaults<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">config_file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">config_ref</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">defaults_ref</span><span class="o">=</span><span class="nv">$3</span>

<span class="w">    </span><span class="c1"># Start with defaults</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!defaults_ref[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span>config_ref<span class="o">[</span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">defaults_ref</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="c1"># Load config file if exists</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$config_file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">local</span><span class="w"> </span>line<span class="w"> </span>key<span class="w"> </span>value
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="nv">IFS</span><span class="o">=</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">            </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[[</span>:space:<span class="o">]]</span>*$<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">continue</span>
<span class="w">            </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[[</span>:space:<span class="o">]]</span>*#<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">continue</span>

<span class="w">            </span><span class="nv">line</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%%#*</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>*<span class="o">=</span>*<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">continue</span>

<span class="w">            </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">%%=*</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">line</span><span class="p">#*=</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">key</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">#</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">%%[![:</span><span class="nv">space</span><span class="p">:]]*</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">%</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">##*[![:</span><span class="nv">space</span><span class="p">:]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[</span><span class="se">\&quot;\&#39;</span><span class="o">]</span>.*<span class="o">[</span><span class="se">\&quot;\&#39;</span><span class="o">]</span>$<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">value</span><span class="p">:</span><span class="nv">1</span><span class="k">:-</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">            </span>config_ref<span class="o">[</span><span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$config_file</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># Test with partial config</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>partial.conf<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">host = production.example.com</span>
<span class="s">debug = true</span>
<span class="s">EOF</span>

<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>config
load_config_with_defaults<span class="w"> </span><span class="s2">&quot;partial.conf&quot;</span><span class="w"> </span>config<span class="w"> </span>default_config

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Final configuration:&quot;</span>
<span class="k">for</span><span class="w"> </span>key<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!config[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;  </span><span class="nv">$key</span><span class="s2"> = </span><span class="si">${</span><span class="nv">config</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>

rm<span class="w"> </span>partial.conf
</code></pre></div>

<h2 id="6-multi-dimensional-data">6. Multi-Dimensional Data<a class="header-link" href="#6-multi-dimensional-data" title="Permanent link">&para;</a></h2>
<p>Bash doesn't natively support multi-dimensional arrays, but we can simulate them.</p>
<h3 id="2d-array-simulation">2D Array Simulation<a class="header-link" href="#2d-array-simulation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Simulate 2D array using naming convention: arr_row_col</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>matrix

<span class="c1"># Set value at [row][col]</span>
matrix_set<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">row</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="nv">$3</span>
<span class="w">    </span>matrix<span class="o">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">row</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Get value at [row][col]</span>
matrix_get<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">row</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">matrix</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">row</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Create 3x3 matrix</span>
matrix_set<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span>
matrix_set<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
matrix_set<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span>
matrix_set<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span>
matrix_set<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span>
matrix_set<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">6</span>
matrix_set<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">7</span>
matrix_set<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">8</span>
matrix_set<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">9</span>

<span class="c1"># Print matrix</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Matrix:&quot;</span>
<span class="k">for</span><span class="w"> </span>row<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>col<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%3s&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>matrix_get<span class="w"> </span><span class="nv">$row</span><span class="w"> </span><span class="nv">$col</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">done</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="k">done</span>
</code></pre></div>

<h3 id="table-data-structure">Table Data Structure<a class="header-link" href="#table-data-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Table with named columns</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>table
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">columns</span><span class="o">=(</span><span class="s2">&quot;name&quot;</span><span class="w"> </span><span class="s2">&quot;age&quot;</span><span class="w"> </span><span class="s2">&quot;city&quot;</span><span class="o">)</span>
<span class="nb">declare</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">row_count</span><span class="o">=</span><span class="m">0</span>

<span class="c1"># Add row</span>
table_add_row<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">age</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">city</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>

<span class="w">    </span>table<span class="o">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">row_count</span><span class="si">}</span><span class="s2">_name&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$name</span><span class="s2">&quot;</span>
<span class="w">    </span>table<span class="o">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">row_count</span><span class="si">}</span><span class="s2">_age&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$age</span><span class="s2">&quot;</span>
<span class="w">    </span>table<span class="o">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">row_count</span><span class="si">}</span><span class="s2">_city&quot;</span><span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$city</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="o">((</span>row_count++<span class="o">))</span>
<span class="o">}</span>

<span class="c1"># Get cell value</span>
table_get<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">row</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">table</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">row</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Print table</span>
table_print<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1"># Header</span>
<span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%-15s %-5s %-20s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">columns</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%-15s %-5s %-20s\n&quot;</span><span class="w"> </span><span class="s2">&quot;---------------&quot;</span><span class="w"> </span><span class="s2">&quot;-----&quot;</span><span class="w"> </span><span class="s2">&quot;--------------------&quot;</span>

<span class="w">    </span><span class="c1"># Rows</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span>i&lt;row_count<span class="p">;</span><span class="w"> </span>i++<span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%-15s %-5s %-20s\n&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">            </span><span class="s2">&quot;</span><span class="k">$(</span>table_get<span class="w"> </span><span class="nv">$i</span><span class="w"> </span>name<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">            </span><span class="s2">&quot;</span><span class="k">$(</span>table_get<span class="w"> </span><span class="nv">$i</span><span class="w"> </span>age<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">            </span><span class="s2">&quot;</span><span class="k">$(</span>table_get<span class="w"> </span><span class="nv">$i</span><span class="w"> </span>city<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">done</span>
<span class="o">}</span>

<span class="c1"># Usage</span>
table_add_row<span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="s2">&quot;New York&quot;</span>
table_add_row<span class="w"> </span><span class="s2">&quot;Jane Smith&quot;</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="s2">&quot;Los Angeles&quot;</span>
table_add_row<span class="w"> </span><span class="s2">&quot;Bob Johnson&quot;</span><span class="w"> </span><span class="m">35</span><span class="w"> </span><span class="s2">&quot;Chicago&quot;</span>

table_print
</code></pre></div>

<h3 id="serialization-with-declare-p">Serialization with declare -p<a class="header-link" href="#serialization-with-declare-p" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Save array to file</span>
save_array<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">array_name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="nb">declare</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$array_name</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Load array from file</span>
load_array<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>

<span class="w">    </span><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Example with indexed array</span>
<span class="nv">my_array</span><span class="o">=(</span>apple<span class="w"> </span>banana<span class="w"> </span>cherry<span class="o">)</span>
save_array<span class="w"> </span><span class="s2">&quot;my_array&quot;</span><span class="w"> </span><span class="s2">&quot;array.dat&quot;</span>

<span class="c1"># Clear array</span>
<span class="nb">unset</span><span class="w"> </span>my_array

<span class="c1"># Reload</span>
load_array<span class="w"> </span><span class="s2">&quot;array.dat&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Restored: </span><span class="si">${</span><span class="nv">my_array</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Example with associative array</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">my_map</span><span class="o">=([</span>host<span class="o">]=</span>localhost<span class="w"> </span><span class="o">[</span>port<span class="o">]=</span><span class="m">8080</span><span class="o">)</span>
save_array<span class="w"> </span><span class="s2">&quot;my_map&quot;</span><span class="w"> </span><span class="s2">&quot;map.dat&quot;</span>

<span class="c1"># Clear and reload</span>
<span class="nb">unset</span><span class="w"> </span>my_map
load_array<span class="w"> </span><span class="s2">&quot;map.dat&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Restored: </span><span class="si">${</span><span class="p">!my_map[@]</span><span class="si">}</span><span class="s2">&quot;</span>

rm<span class="w"> </span>array.dat<span class="w"> </span>map.dat
</code></pre></div>

<h2 id="7-practical-patterns">7. Practical Patterns<a class="header-link" href="#7-practical-patterns" title="Permanent link">&para;</a></h2>
<h3 id="argument-collection">Argument Collection<a class="header-link" href="#argument-collection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Collect arguments into arrays</span>
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>files
<span class="nb">declare</span><span class="w"> </span>-a<span class="w"> </span>options
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>flags

<span class="k">while</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span>-v<span class="p">|</span>--verbose<span class="o">)</span>
<span class="w">            </span>flags<span class="o">[</span>verbose<span class="o">]=</span><span class="m">1</span>
<span class="w">            </span><span class="nb">shift</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>-o<span class="p">|</span>--output<span class="o">)</span>
<span class="w">            </span>flags<span class="o">[</span>output<span class="o">]=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nb">shift</span><span class="w"> </span><span class="m">2</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>--option<span class="o">=</span>*<span class="o">)</span>
<span class="w">            </span><span class="nv">option</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">#*=</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">options</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$option</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="nb">shift</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>-*<span class="o">)</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Unknown option: </span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">            </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>*<span class="o">)</span>
<span class="w">            </span><span class="nv">files</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="nb">shift</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>
<span class="k">done</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Files: </span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Options: </span><span class="si">${</span><span class="nv">options</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Verbose: </span><span class="si">${</span><span class="nv">flags</span><span class="p">[verbose]</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Output: </span><span class="si">${</span><span class="nv">flags</span><span class="p">[output]</span><span class="k">:-</span><span class="nv">stdout</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>

<h3 id="building-commands-dynamically">Building Commands Dynamically<a class="header-link" href="#building-commands-dynamically" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Build command with options</span>
build_command<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">cmd</span><span class="o">=(</span>rsync<span class="w"> </span>-av<span class="o">)</span>

<span class="w">    </span><span class="c1"># Add optional flags</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DRY_RUN</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">cmd</span><span class="o">+=(</span>--dry-run<span class="o">)</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DELETE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">cmd</span><span class="o">+=(</span>--delete<span class="o">)</span>
<span class="w">    </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$COMPRESS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">cmd</span><span class="o">+=(</span>--compress<span class="o">)</span>

<span class="w">    </span><span class="c1"># Add exclude patterns</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">excludes</span><span class="o">=(</span>
<span class="w">        </span><span class="s2">&quot;*.tmp&quot;</span>
<span class="w">        </span><span class="s2">&quot;*.log&quot;</span>
<span class="w">        </span><span class="s2">&quot;.git&quot;</span>
<span class="w">    </span><span class="o">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span>pattern<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">excludes</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nv">cmd</span><span class="o">+=(</span>--exclude<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$pattern</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="c1"># Add source and destination</span>
<span class="w">    </span><span class="nv">cmd</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="nv">$SOURCE</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DEST</span><span class="s2">&quot;</span><span class="o">)</span>

<span class="w">    </span><span class="c1"># Execute</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Running: </span><span class="si">${</span><span class="nv">cmd</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">cmd</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Usage</span>
<span class="nv">SOURCE</span><span class="o">=</span><span class="s2">&quot;/data&quot;</span>
<span class="nv">DEST</span><span class="o">=</span><span class="s2">&quot;/backup&quot;</span>
<span class="nv">DRY_RUN</span><span class="o">=</span><span class="m">1</span>
<span class="nv">DELETE</span><span class="o">=</span><span class="m">1</span>

build_command
</code></pre></div>

<h3 id="safe-word-splitting">Safe Word Splitting<a class="header-link" href="#safe-word-splitting" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># UNSAFE: word splitting on spaces</span>
<span class="nv">unsafe_cmd</span><span class="o">=</span><span class="s2">&quot;ls -la /tmp&quot;</span>
<span class="nv">$unsafe_cmd</span><span class="w">  </span><span class="c1"># Vulnerable to injection</span>

<span class="c1"># SAFE: use array</span>
<span class="nv">safe_cmd</span><span class="o">=(</span>ls<span class="w"> </span>-la<span class="w"> </span>/tmp<span class="o">)</span>
<span class="s2">&quot;</span><span class="si">${</span><span class="nv">safe_cmd</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Building complex commands</span>
build_find_command<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">shift</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">cmd</span><span class="o">=(</span>find<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span><span class="o">)</span>

<span class="w">    </span><span class="c1"># Add search criteria</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">            </span>--name<span class="o">)</span>
<span class="w">                </span><span class="nv">cmd</span><span class="o">+=(</span>-name<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">                </span><span class="nb">shift</span><span class="w"> </span><span class="m">2</span>
<span class="w">                </span><span class="p">;;</span>
<span class="w">            </span>--type<span class="o">)</span>
<span class="w">                </span><span class="nv">cmd</span><span class="o">+=(</span>-type<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">                </span><span class="nb">shift</span><span class="w"> </span><span class="m">2</span>
<span class="w">                </span><span class="p">;;</span>
<span class="w">            </span>--newer<span class="o">)</span>
<span class="w">                </span><span class="nv">cmd</span><span class="o">+=(</span>-newer<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">                </span><span class="nb">shift</span><span class="w"> </span><span class="m">2</span>
<span class="w">                </span><span class="p">;;</span>
<span class="w">            </span>*<span class="o">)</span>
<span class="w">                </span><span class="nb">shift</span>
<span class="w">                </span><span class="p">;;</span>
<span class="w">        </span><span class="k">esac</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="c1"># Execute safely</span>
<span class="w">    </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">cmd</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Usage</span>
build_find_command<span class="w"> </span><span class="s2">&quot;/var/log&quot;</span><span class="w"> </span>--type<span class="w"> </span>f<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;*.log&quot;</span>
</code></pre></div>

<h2 id="practice-problems">Practice Problems<a class="header-link" href="#practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-advanced-csv-processor">Problem 1: Advanced CSV Processor<a class="header-link" href="#problem-1-advanced-csv-processor" title="Permanent link">&para;</a></h3>
<p>Create a CSV processing tool that:
- Parses CSV with quoted fields and escaped quotes
- Filters rows based on column values (regex support)
- Sorts by specified columns (multiple columns, asc/desc)
- Calculates aggregate functions (sum, avg, min, max, count)
- Joins two CSV files on common column
- Exports results in CSV or JSON format</p>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code>csv_tool<span class="w"> </span>data.csv<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--filter<span class="w"> </span><span class="s2">&quot;age &gt; 25&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--filter<span class="w"> </span><span class="s2">&quot;city =~ ^New&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--sort<span class="w"> </span><span class="s2">&quot;age:desc,name:asc&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--aggregate<span class="w"> </span><span class="s2">&quot;avg(salary)&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output<span class="w"> </span>result.csv
</code></pre></div>

<h3 id="problem-2-configuration-manager">Problem 2: Configuration Manager<a class="header-link" href="#problem-2-configuration-manager" title="Permanent link">&para;</a></h3>
<p>Build a configuration management system that:
- Loads configs from multiple sources (files, environment, CLI args)
- Supports layered configs (defaults &lt; system &lt; user &lt; environment)
- Validates config against schema (required fields, types, ranges)
- Provides get/set/list operations
- Exports configs in different formats (INI, JSON, YAML-like)
- Watches config files for changes</p>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code>config<span class="w"> </span>load<span class="w"> </span>defaults.conf<span class="w"> </span>system.conf<span class="w"> </span>user.conf
config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>database.host<span class="w"> </span>localhost
config<span class="w"> </span>get<span class="w"> </span>database.port<span class="w">  </span><span class="c1"># Returns with fallback to defaults</span>
config<span class="w"> </span>validate<span class="w">           </span><span class="c1"># Check all required fields</span>
config<span class="w"> </span><span class="nb">export</span><span class="w"> </span>--format<span class="w"> </span>json<span class="w"> </span>&gt;<span class="w"> </span>config.json
</code></pre></div>

<h3 id="problem-3-data-structure-library">Problem 3: Data Structure Library<a class="header-link" href="#problem-3-data-structure-library" title="Permanent link">&para;</a></h3>
<p>Implement a library of data structures:
- <strong>Stack</strong>: push, pop, peek, size, clear
- <strong>Queue</strong>: enqueue, dequeue, front, back, size
- <strong>Priority Queue</strong>: insert with priority, extract_max
- <strong>Set</strong>: add, remove, contains, union, intersection, difference
- <strong>Map</strong>: put, get, remove, keys, values, entries
- <strong>List</strong>: append, prepend, insert, remove, get, size</p>
<p>Include persistence (save/load to files) for each structure.</p>
<h3 id="problem-4-table-data-processor">Problem 4: Table Data Processor<a class="header-link" href="#problem-4-table-data-processor" title="Permanent link">&para;</a></h3>
<p>Create a table manipulation tool with:
- Load data from CSV/TSV/fixed-width files
- Add/remove/rename columns
- Filter rows with complex conditions
- Transform values (map function over columns)
- Group by columns with aggregation
- Pivot/unpivot operations
- Export to various formats</p>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code>table<span class="w"> </span>load<span class="w"> </span>employees.csv
table<span class="w"> </span>filter<span class="w"> </span><span class="s1">&#39;salary &gt; 50000&#39;</span>
table<span class="w"> </span>group_by<span class="w"> </span>department<span class="w"> </span>--aggregate<span class="w"> </span><span class="s1">&#39;avg(salary),count(*)&#39;</span>
table<span class="w"> </span>sort<span class="w"> </span>salary:desc
table<span class="w"> </span><span class="k">select</span><span class="w"> </span>name,department,salary
table<span class="w"> </span><span class="nb">export</span><span class="w"> </span>--format<span class="w"> </span>markdown
</code></pre></div>

<h3 id="problem-5-log-aggregator">Problem 5: Log Aggregator<a class="header-link" href="#problem-5-log-aggregator" title="Permanent link">&para;</a></h3>
<p>Write a log aggregation tool that:
- Parses logs from multiple files (different formats)
- Extracts structured data (timestamp, level, message, metadata)
- Stores in searchable data structure
- Filters by time range, level, pattern
- Groups and counts by various fields
- Generates statistics (error rate, patterns, top errors)
- Exports reports in different formats</p>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code>log_agg<span class="w"> </span>--input<span class="w"> </span><span class="s2">&quot;*.log&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--format<span class="w"> </span>apache<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--time-range<span class="w"> </span><span class="s2">&quot;2024-02-13 00:00 to 2024-02-13 23:59&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--filter<span class="w"> </span><span class="s2">&quot;level=ERROR&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--group-by<span class="w"> </span>hour<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--top<span class="w"> </span>errors<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output<span class="w"> </span>report.html
</code></pre></div>

<hr />
<p><strong>Previous</strong>: <a href="./02_Parameter_Expansion.md">02_Parameter_Expansion.md</a> | <strong>Next</strong>: <a href="./04_Advanced_Control_Flow.md">04_Advanced_Control_Flow.md</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Shell_Script/02_Parameter_Expansion.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Parameter Expansion and Variable Attributes ‚≠ê‚≠ê</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Shell_Script/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Shell_Script/04_Advanced_Control_Flow.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Advanced Control Flow ‚≠ê‚≠ê</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}