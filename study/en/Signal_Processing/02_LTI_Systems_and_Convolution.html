{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LTI Systems and Convolution - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">LTI Systems and Convolution</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>LTI Systems and Convolution</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/01_Signals_and_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Signals and Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/03_Fourier_Series_and_Applications.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Fourier Series and Applications</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-why-lti-systems">1. Why LTI Systems?</a><ul>
<li><a href="#11-the-power-of-linearity-and-time-invariance">1.1 The Power of Linearity and Time Invariance</a></li>
<li><a href="#12-representation-of-signals-using-impulses">1.2 Representation of Signals Using Impulses</a></li>
</ul>
</li>
<li><a href="#2-impulse-response">2. Impulse Response</a><ul>
<li><a href="#21-definition">2.1 Definition</a></li>
<li><a href="#22-why-the-impulse-response-characterizes-the-system">2.2 Why the Impulse Response Characterizes the System</a></li>
<li><a href="#23-examples-of-impulse-responses">2.3 Examples of Impulse Responses</a></li>
</ul>
</li>
<li><a href="#3-the-convolution-sum-discrete-time">3. The Convolution Sum (Discrete-Time)</a><ul>
<li><a href="#31-definition">3.1 Definition</a></li>
<li><a href="#32-interpretation">3.2 Interpretation</a></li>
<li><a href="#33-graphical-convolution">3.3 Graphical Convolution</a></li>
<li><a href="#34-special-convolution-results">3.4 Special Convolution Results</a></li>
</ul>
</li>
<li><a href="#4-the-convolution-integral-continuous-time">4. The Convolution Integral (Continuous-Time)</a><ul>
<li><a href="#41-definition">4.1 Definition</a></li>
<li><a href="#42-interpretation">4.2 Interpretation</a></li>
<li><a href="#43-example-exponential-convolved-with-step">4.3 Example: Exponential Convolved with Step</a></li>
<li><a href="#44-example-rectangular-pulse-self-convolution">4.4 Example: Rectangular Pulse Self-Convolution</a></li>
<li><a href="#45-convolution-with-causal-signals">4.5 Convolution with Causal Signals</a></li>
</ul>
</li>
<li><a href="#5-computing-convolutions">5. Computing Convolutions</a><ul>
<li><a href="#51-analytical-methods">5.1 Analytical Methods</a></li>
<li><a href="#52-numerical-methods">5.2 Numerical Methods</a></li>
<li><a href="#53-numpy-and-scipy-functions">5.3 NumPy and SciPy Functions</a></li>
<li><a href="#54-convolution-modes-comparison">5.4 Convolution Modes Comparison</a></li>
</ul>
</li>
<li><a href="#6-properties-of-convolution">6. Properties of Convolution</a><ul>
<li><a href="#61-commutativity">6.1 Commutativity</a></li>
<li><a href="#62-associativity">6.2 Associativity</a></li>
<li><a href="#63-distributivity-over-addition">6.3 Distributivity over Addition</a></li>
<li><a href="#64-identity-element">6.4 Identity Element</a></li>
<li><a href="#65-shift-property">6.5 Shift Property</a></li>
<li><a href="#66-width-property">6.6 Width Property</a></li>
<li><a href="#67-convolution-with-scaled-impulse-pair-echo-system">6.7 Convolution with Scaled Impulse Pair (Echo System)</a></li>
</ul>
</li>
<li><a href="#7-step-response">7. Step Response</a><ul>
<li><a href="#71-definition">7.1 Definition</a></li>
<li><a href="#72-relationship-to-impulse-response">7.2 Relationship to Impulse Response</a></li>
<li><a href="#73-example">7.3 Example</a></li>
</ul>
</li>
<li><a href="#8-system-interconnections">8. System Interconnections</a><ul>
<li><a href="#81-cascade-series-connection">8.1 Cascade (Series) Connection</a></li>
<li><a href="#82-parallel-connection">8.2 Parallel Connection</a></li>
<li><a href="#83-feedback-connection">8.3 Feedback Connection</a></li>
</ul>
</li>
<li><a href="#9-lti-system-stability">9. LTI System Stability</a><ul>
<li><a href="#91-bibo-stability-criterion">9.1 BIBO Stability Criterion</a></li>
<li><a href="#92-stability-of-common-systems">9.2 Stability of Common Systems</a></li>
<li><a href="#93-causality-and-stability">9.3 Causality and Stability</a></li>
</ul>
</li>
<li><a href="#10-frequency-response-of-lti-systems">10. Frequency Response of LTI Systems</a><ul>
<li><a href="#101-complex-exponentials-as-eigenfunctions">10.1 Complex Exponentials as Eigenfunctions</a></li>
<li><a href="#102-magnitude-and-phase-response">10.2 Magnitude and Phase Response</a></li>
<li><a href="#103-continuous-time-frequency-response">10.3 Continuous-Time Frequency Response</a></li>
<li><a href="#104-example-moving-average-filter">10.4 Example: Moving Average Filter</a></li>
</ul>
</li>
<li><a href="#11-python-examples">11. Python Examples</a><ul>
<li><a href="#111-complete-convolution-toolkit">11.1 Complete Convolution Toolkit</a></li>
<li><a href="#112-echo-simulation">11.2 Echo Simulation</a></li>
<li><a href="#113-system-identification-from-step-response">11.3 System Identification from Step Response</a></li>
<li><a href="#114-frequency-response-analysis">11.4 Frequency Response Analysis</a></li>
</ul>
</li>
<li><a href="#12-summary">12. Summary</a><ul>
<li><a href="#key-formulas">Key Formulas</a></li>
<li><a href="#convolution-properties">Convolution Properties</a></li>
<li><a href="#conceptual-map">Conceptual Map</a></li>
</ul>
</li>
<li><a href="#13-exercises">13. Exercises</a><ul>
<li><a href="#exercise-1-analytical-convolution">Exercise 1: Analytical Convolution</a></li>
<li><a href="#exercise-2-continuous-time-convolution">Exercise 2: Continuous-Time Convolution</a></li>
<li><a href="#exercise-3-system-analysis">Exercise 3: System Analysis</a></li>
<li><a href="#exercise-4-cascade-vs-parallel">Exercise 4: Cascade vs. Parallel</a></li>
<li><a href="#exercise-5-moving-average-filter-analysis">Exercise 5: Moving Average Filter Analysis</a></li>
<li><a href="#exercise-6-convolution-in-practice">Exercise 6: Convolution in Practice</a></li>
<li><a href="#exercise-7-system-identification">Exercise 7: System Identification</a></li>
<li><a href="#exercise-8-deconvolution">Exercise 8: Deconvolution</a></li>
</ul>
</li>
<li><a href="#14-references">14. References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="lti-systems-and-convolution">LTI Systems and Convolution<a class="header-link" href="#lti-systems-and-convolution" title="Permanent link">&para;</a></h1>
<p><strong>Previous</strong>: <a href="./01_Signals_and_Systems.md">01. Signals and Systems</a> | <strong>Next</strong>: <a href="./03_Fourier_Series_and_Applications.md">03. Fourier Series and Applications</a></p>
<hr />
<p>In Lesson 01 we established the language of signals and the properties that characterize systems. Among all possible systems, one class stands above the rest in importance: <strong>Linear Time-Invariant (LTI) systems</strong>. The behavior of any LTI system is completely determined by a single function ‚Äî its <strong>impulse response</strong> ‚Äî and the output for any input can be computed through <strong>convolution</strong>. This lesson develops these ideas from first principles and shows why convolution is the central operation in signal processing.</p>
<p><strong>Difficulty</strong>: ‚≠ê‚≠ê‚≠ê</p>
<p><strong>Learning Objectives</strong>:
- Explain why LTI systems are so important in signal processing
- Derive the convolution integral and convolution sum from the superposition principle
- Compute convolutions analytically and numerically
- Apply the properties of convolution (commutativity, associativity, distributivity)
- Relate step response to impulse response
- Analyze cascade, parallel, and feedback system interconnections
- Determine BIBO stability from the impulse response
- Compute the frequency response of an LTI system</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-why-lti-systems">Why LTI Systems?</a></li>
<li><a href="#2-impulse-response">Impulse Response</a></li>
<li><a href="#3-the-convolution-sum-discrete-time">The Convolution Sum (Discrete-Time)</a></li>
<li><a href="#4-the-convolution-integral-continuous-time">The Convolution Integral (Continuous-Time)</a></li>
<li><a href="#5-computing-convolutions">Computing Convolutions</a></li>
<li><a href="#6-properties-of-convolution">Properties of Convolution</a></li>
<li><a href="#7-step-response">Step Response</a></li>
<li><a href="#8-system-interconnections">System Interconnections</a></li>
<li><a href="#9-lti-system-stability">LTI System Stability</a></li>
<li><a href="#10-frequency-response-of-lti-systems">Frequency Response of LTI Systems</a></li>
<li><a href="#11-python-examples">Python Examples</a></li>
<li><a href="#12-summary">Summary</a></li>
<li><a href="#13-exercises">Exercises</a></li>
<li><a href="#14-references">References</a></li>
</ol>
<hr />
<h2 id="1-why-lti-systems">1. Why LTI Systems?<a class="header-link" href="#1-why-lti-systems" title="Permanent link">&para;</a></h2>
<h3 id="11-the-power-of-linearity-and-time-invariance">1.1 The Power of Linearity and Time Invariance<a class="header-link" href="#11-the-power-of-linearity-and-time-invariance" title="Permanent link">&para;</a></h3>
<p>An LTI system satisfies two properties simultaneously:</p>
<p><strong>Linearity</strong> (superposition):</p>
<p>$$\mathcal{T}\{a x_1(t) + b x_2(t)\} = a \mathcal{T}\{x_1(t)\} + b \mathcal{T}\{x_2(t)\}$$</p>
<p><strong>Time Invariance</strong> (shift invariance):</p>
<p>$$\text{If } x(t) \to y(t), \text{ then } x(t - t_0) \to y(t - t_0)$$</p>
<p>Together, these properties give us an extraordinary capability: if we know how the system responds to a single, simple input (the impulse), we can determine the response to <strong>any</strong> input. This is because:</p>
<ol>
<li><strong>Linearity</strong> lets us decompose any input into a weighted sum of elementary components</li>
<li><strong>Time invariance</strong> ensures the system responds to each shifted component in the same way</li>
<li><strong>Linearity</strong> again lets us add up all the individual responses</li>
</ol>
<h3 id="12-representation-of-signals-using-impulses">1.2 Representation of Signals Using Impulses<a class="header-link" href="#12-representation-of-signals-using-impulses" title="Permanent link">&para;</a></h3>
<p>Any discrete-time signal can be written as a weighted sum of shifted impulses:</p>
<p>$$x[n] = \sum_{k=-\infty}^{\infty} x[k] \delta[n - k]$$</p>
<p>This is simply the <strong>sifting property</strong> restated. Each $x[k]\delta[n-k]$ is a scaled, shifted impulse.</p>
<p>For continuous-time:</p>
<p>$$x(t) = \int_{-\infty}^{\infty} x(\tau) \delta(t - \tau) \, d\tau$$</p>
<p>This decomposition is the key that unlocks convolution.</p>
<hr />
<h2 id="2-impulse-response">2. Impulse Response<a class="header-link" href="#2-impulse-response" title="Permanent link">&para;</a></h2>
<h3 id="21-definition">2.1 Definition<a class="header-link" href="#21-definition" title="Permanent link">&para;</a></h3>
<p>The <strong>impulse response</strong> $h(t)$ (or $h[n]$) is the output of the system when the input is the unit impulse:</p>
<p>$$h(t) = \mathcal{T}\{\delta(t)\}, \qquad h[n] = \mathcal{T}\{\delta[n]\}$$</p>
<p>For an LTI system, the impulse response <strong>completely characterizes</strong> the system. No other information is needed.</p>
<h3 id="22-why-the-impulse-response-characterizes-the-system">2.2 Why the Impulse Response Characterizes the System<a class="header-link" href="#22-why-the-impulse-response-characterizes-the-system" title="Permanent link">&para;</a></h3>
<p><strong>Discrete-time derivation</strong>: If the input $\delta[n]$ produces $h[n]$, then by time invariance, $\delta[n-k]$ produces $h[n-k]$. By homogeneity, $x[k]\delta[n-k]$ produces $x[k]h[n-k]$. By additivity:</p>
<p>$$y[n] = \mathcal{T}\left\{\sum_k x[k]\delta[n-k]\right\} = \sum_k x[k] h[n-k]$$</p>
<p>This is the <strong>convolution sum</strong>.</p>
<p><strong>Continuous-time derivation</strong>: Similarly:</p>
<p>$$y(t) = \mathcal{T}\left\{\int x(\tau)\delta(t-\tau)d\tau\right\} = \int x(\tau) h(t - \tau) \, d\tau$$</p>
<p>This is the <strong>convolution integral</strong>.</p>
<h3 id="23-examples-of-impulse-responses">2.3 Examples of Impulse Responses<a class="header-link" href="#23-examples-of-impulse-responses" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>System</th>
<th>Impulse Response</th>
<th>Properties</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ideal delay by $D$</td>
<td>$h[n] = \delta[n - D]$</td>
<td>FIR, causal, stable</td>
</tr>
<tr>
<td>Moving average (length $M$)</td>
<td>$h[n] = \frac{1}{M}\sum_{k=0}^{M-1}\delta[n-k]$</td>
<td>FIR, causal, stable</td>
</tr>
<tr>
<td>First-order recursive</td>
<td>$h[n] = a^n u[n]$</td>
<td>IIR, causal, stable if $\|a\| < 1$</td>
</tr>
<tr>
<td>Ideal lowpass filter</td>
<td>$h(t) = \text{sinc}(2Bt)$</td>
<td>Noncausal, not realizable</td>
</tr>
<tr>
<td>RC lowpass circuit</td>
<td>$h(t) = \frac{1}{RC}e^{-t/RC}u(t)$</td>
<td>Causal, stable</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Impulse response examples ---</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># 1. Ideal delay (D=3)</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">h_delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">D</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h_delay</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ideal Delay: $h[n] = </span><span class="se">\\</span><span class="s1">delta[n - </span><span class="si">{</span><span class="n">D</span><span class="si">}</span><span class="s1">]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Moving average (M=5)</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">M</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">M</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h_ma</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moving Average (M=</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">): $h[n] = </span><span class="se">\\</span><span class="s1">frac</span><span class="se">{{</span><span class="s1">1</span><span class="se">}}{{</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="se">}}</span><span class="s1">$, $0 </span><span class="se">\\</span><span class="s1">leq n &lt; </span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. First-order recursive (a=0.8)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">h_recursive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h_recursive</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;First-Order Recursive: $h[n] = (</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">)^n u[n]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 4. RC lowpass (continuous-time, simulated)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">RC</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">h_rc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">RC</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="n">RC</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h_rc</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RC Lowpass: $h(t) = </span><span class="se">\\</span><span class="s1">frac</span><span class="se">{{</span><span class="s1">1</span><span class="se">}}{{</span><span class="s1">RC</span><span class="se">}}</span><span class="s1">e^</span><span class="se">{{</span><span class="s1">-t/RC</span><span class="se">}}</span><span class="s1">u(t)$, RC=</span><span class="si">{</span><span class="n">RC</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h(t)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">],</span> <span class="n">h_rc</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;impulse_responses.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="3-the-convolution-sum-discrete-time">3. The Convolution Sum (Discrete-Time)<a class="header-link" href="#3-the-convolution-sum-discrete-time" title="Permanent link">&para;</a></h2>
<h3 id="31-definition">3.1 Definition<a class="header-link" href="#31-definition" title="Permanent link">&para;</a></h3>
<p>The <strong>convolution sum</strong> computes the output $y[n]$ of a discrete-time LTI system with impulse response $h[n]$ and input $x[n]$:</p>
<p>$$y[n] = x[n] * h[n] = \sum_{k=-\infty}^{\infty} x[k] \, h[n - k]$$</p>
<p>The asterisk $*$ denotes convolution (not multiplication).</p>
<h3 id="32-interpretation">3.2 Interpretation<a class="header-link" href="#32-interpretation" title="Permanent link">&para;</a></h3>
<p>For each output sample $y[n]$:</p>
<ol>
<li><strong>Flip</strong> $h[k]$ about $k = 0$ to get $h[-k]$</li>
<li><strong>Shift</strong> by $n$ to get $h[n - k]$</li>
<li><strong>Multiply</strong> $x[k]$ and $h[n - k]$ element-wise</li>
<li><strong>Sum</strong> over all $k$</li>
</ol>
<p>This "flip-shift-multiply-sum" procedure is the mechanical recipe for computing convolution.</p>
<h3 id="33-graphical-convolution">3.3 Graphical Convolution<a class="header-link" href="#33-graphical-convolution" title="Permanent link">&para;</a></h3>
<p>For hand computation, graphical convolution is invaluable. The idea is to fix $n$ and visualize the overlap between $x[k]$ and $h[n-k]$ as $k$ varies.</p>
<p><strong>Example</strong>: Convolve $x[n] = \{1, 2, 3\}$ (for $n = 0, 1, 2$) with $h[n] = \{1, 1, 1, 1\}$ (for $n = 0, 1, 2, 3$):</p>
<p>The output length is $\text{len}(x) + \text{len}(h) - 1 = 3 + 4 - 1 = 6$.</p>
<table>
<thead>
<tr>
<th>$n$</th>
<th>Overlapping products</th>
<th>$y[n]$</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>$1 \cdot 1$</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>$1 \cdot 2 + 1 \cdot 1$</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>$1 \cdot 3 + 1 \cdot 2 + 1 \cdot 1$</td>
<td>6</td>
</tr>
<tr>
<td>3</td>
<td>$1 \cdot 3 + 1 \cdot 2 + 1 \cdot 1$</td>
<td>6</td>
</tr>
<tr>
<td>4</td>
<td>$1 \cdot 3 + 1 \cdot 2$</td>
<td>5</td>
</tr>
<tr>
<td>5</td>
<td>$1 \cdot 3$</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>So $y[n] = \{1, 3, 6, 6, 5, 3\}$.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Graphical convolution step-by-step ---</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Full convolution</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x =&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h =&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y = x * h =&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Visualize step-by-step</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">n_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">n_val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">n_values</span><span class="p">)):</span>
    <span class="c1"># x[k]</span>
    <span class="n">x_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ki</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">x_full</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ki</span><span class="p">]</span>

    <span class="c1"># h[n-k] (flipped and shifted)</span>
    <span class="n">h_shifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ki</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">idx_h</span> <span class="o">=</span> <span class="n">n_val</span> <span class="o">-</span> <span class="n">ki</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">idx_h</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
            <span class="n">h_shifted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">idx_h</span><span class="p">]</span>

    <span class="c1"># Product</span>
    <span class="n">product</span> <span class="o">=</span> <span class="n">x_full</span> <span class="o">*</span> <span class="n">h_shifted</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x_full</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x[k]$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">h_shifted</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;rs&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$h[n-k]$&#39;</span><span class="p">)</span>

    <span class="c1"># Highlight overlap region</span>
    <span class="n">overlap_mask</span> <span class="o">=</span> <span class="n">product</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">overlap_mask</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">pi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="n">overlap_mask</span><span class="p">],</span> <span class="n">product</span><span class="p">[</span><span class="n">overlap_mask</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pi</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">ki</span> <span class="o">+</span> <span class="mf">0.07</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_full</span><span class="p">[</span><span class="n">k</span> <span class="o">==</span> <span class="n">ki</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">h_shifted</span><span class="p">[</span><span class="n">k</span> <span class="o">==</span> <span class="n">ki</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.15</span><span class="p">),</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$n = </span><span class="si">{</span><span class="n">n_val</span><span class="si">}</span><span class="s1">$: $y[</span><span class="si">{</span><span class="n">n_val</span><span class="si">}</span><span class="s1">] = </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">n_val</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Graphical Convolution: Flip-Shift-Multiply-Sum&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;graphical_convolution.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="34-special-convolution-results">3.4 Special Convolution Results<a class="header-link" href="#34-special-convolution-results" title="Permanent link">&para;</a></h3>
<p><strong>Convolution with impulse</strong> (identity):</p>
<p>$$x[n] * \delta[n] = x[n]$$</p>
<p><strong>Convolution with shifted impulse</strong> (delay):</p>
<p>$$x[n] * \delta[n - n_0] = x[n - n_0]$$</p>
<p><strong>Convolution with unit step</strong>:</p>
<p>$$x[n] * u[n] = \sum_{k=-\infty}^{n} x[k] \quad \text{(running sum / accumulator)}$$</p>
<hr />
<h2 id="4-the-convolution-integral-continuous-time">4. The Convolution Integral (Continuous-Time)<a class="header-link" href="#4-the-convolution-integral-continuous-time" title="Permanent link">&para;</a></h2>
<h3 id="41-definition">4.1 Definition<a class="header-link" href="#41-definition" title="Permanent link">&para;</a></h3>
<p>The <strong>convolution integral</strong> is the continuous-time counterpart:</p>
<p>$$y(t) = x(t) * h(t) = \int_{-\infty}^{\infty} x(\tau) \, h(t - \tau) \, d\tau$$</p>
<h3 id="42-interpretation">4.2 Interpretation<a class="header-link" href="#42-interpretation" title="Permanent link">&para;</a></h3>
<p>The procedure mirrors the discrete case:</p>
<ol>
<li><strong>Flip</strong>: $h(\tau) \to h(-\tau)$</li>
<li><strong>Shift</strong>: $h(-\tau) \to h(t - \tau)$</li>
<li><strong>Multiply</strong>: $x(\tau) \cdot h(t - \tau)$</li>
<li><strong>Integrate</strong>: $\int_{-\infty}^{\infty} (\cdot) \, d\tau$</li>
</ol>
<h3 id="43-example-exponential-convolved-with-step">4.3 Example: Exponential Convolved with Step<a class="header-link" href="#43-example-exponential-convolved-with-step" title="Permanent link">&para;</a></h3>
<p>Compute $y(t) = e^{-at}u(t) * u(t)$ for $a > 0$.</p>
<p>$$y(t) = \int_{-\infty}^{\infty} e^{-a\tau}u(\tau) \cdot u(t - \tau) \, d\tau$$</p>
<p>The integrand is nonzero only when $\tau \geq 0$ (from $u(\tau)$) and $\tau \leq t$ (from $u(t-\tau)$), so for $t \geq 0$:</p>
<p>$$y(t) = \int_0^t e^{-a\tau} \, d\tau = \frac{1}{a}(1 - e^{-at}), \quad t \geq 0$$</p>
<p>For $t < 0$: $y(t) = 0$.</p>
<p>Therefore: $y(t) = \frac{1}{a}(1 - e^{-at})u(t)$</p>
<h3 id="44-example-rectangular-pulse-self-convolution">4.4 Example: Rectangular Pulse Self-Convolution<a class="header-link" href="#44-example-rectangular-pulse-self-convolution" title="Permanent link">&para;</a></h3>
<p>Compute $y(t) = \text{rect}(t) * \text{rect}(t)$ where $\text{rect}(t)$ is 1 for $|t| \leq 1/2$.</p>
<p>By the flip-shift-integrate procedure:</p>
<p>$$y(t) = \int_{-\infty}^{\infty} \text{rect}(\tau) \cdot \text{rect}(t - \tau) \, d\tau$$</p>
<p>The overlap between two rectangles of width 1 centered at 0 and $t$ gives a <strong>triangular pulse</strong>:</p>
<p>$$y(t) = \text{tri}(t) = \begin{cases} 1 - |t| & |t| \leq 1 \\ 0 & |t| > 1 \end{cases}$$</p>
<blockquote>
<p>This is a fundamental result: convolving a rectangle with itself produces a triangle. Convolving again produces a smoother shape, and in the limit, the result approaches a Gaussian (by the Central Limit Theorem).</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Continuous-time convolution examples ---</span>

<span class="c1"># Example 1: exp(-at)u(t) * u(t)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Numerical convolution</span>
<span class="n">y_numerical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">t_conv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_numerical</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Analytical result</span>
<span class="n">y_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">t</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$h(t) = e^{-2t}u(t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$x(t) = u(t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_analytical</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_conv</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="n">y_numerical</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Numerical&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$y(t) = </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{1}{a}</span><span class="s1">(1 - e^{-at})u(t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Example 2: rect * rect = triangle</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">dt2</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">tri_conv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt2</span>
<span class="n">t2_conv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tri_conv</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">tri_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t2</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">tri_analytical</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;tri(t) analytical&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2_conv</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">t2</span><span class="p">)]</span> <span class="o">+</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tri_conv</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">t2</span><span class="p">)],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;rect*rect numerical&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;rect$(t)$ * rect$(t)$ = tri$(t)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;convolution_examples.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="45-convolution-with-causal-signals">4.5 Convolution with Causal Signals<a class="header-link" href="#45-convolution-with-causal-signals" title="Permanent link">&para;</a></h3>
<p>When both $x(t)$ and $h(t)$ are causal (zero for $t < 0$), the integral limits simplify:</p>
<p>$$y(t) = \int_0^t x(\tau) h(t - \tau) \, d\tau, \quad t \geq 0$$</p>
<p>This is because $x(\tau) = 0$ for $\tau < 0$ and $h(t - \tau) = 0$ for $\tau > t$.</p>
<hr />
<h2 id="5-computing-convolutions">5. Computing Convolutions<a class="header-link" href="#5-computing-convolutions" title="Permanent link">&para;</a></h2>
<h3 id="51-analytical-methods">5.1 Analytical Methods<a class="header-link" href="#51-analytical-methods" title="Permanent link">&para;</a></h3>
<p><strong>Method 1: Direct integration</strong> ‚Äî Identify the limits of integration where the integrand is nonzero, then integrate.</p>
<p><strong>Method 2: Laplace/Z-transform</strong> ‚Äî In the transform domain, convolution becomes multiplication:</p>
<p>$$\mathcal{L}\{x * h\} = X(s) \cdot H(s)$$</p>
<p>$$\mathcal{Z}\{x * h\} = X(z) \cdot H(z)$$</p>
<p>This is often much simpler than direct computation. We will explore this in detail in later lessons.</p>
<h3 id="52-numerical-methods">5.2 Numerical Methods<a class="header-link" href="#52-numerical-methods" title="Permanent link">&para;</a></h3>
<p><strong>Direct implementation</strong> (naive, $O(N^2)$):</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convolve_direct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Direct convolution: O(N*M) where N=len(x), M=len(h).&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">y</span>
</code></pre></div>

<p><strong>FFT-based convolution</strong> (fast, $O(N \log N)$):</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convolve_fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;FFT-based convolution: O(N log N).&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="c1"># Pad to next power of 2 for FFT efficiency</span>
    <span class="n">N_fft</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>
</code></pre></div>

<p>The FFT approach exploits the <strong>convolution theorem</strong>: convolution in time equals multiplication in frequency. For large signals, this is dramatically faster.</p>
<h3 id="53-numpy-and-scipy-functions">5.3 NumPy and SciPy Functions<a class="header-link" href="#53-numpy-and-scipy-functions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="c1"># Full convolution (output length = len(x) + len(h) - 1)</span>
<span class="n">y_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Full:&quot;</span><span class="p">,</span> <span class="n">y_full</span><span class="p">)</span>

<span class="c1"># Same-size output (centered, length = max(len(x), len(h)))</span>
<span class="n">y_same</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Same:&quot;</span><span class="p">,</span> <span class="n">y_same</span><span class="p">)</span>

<span class="c1"># Valid (only where signals fully overlap, length = max(N,M) - min(N,M) + 1)</span>
<span class="n">y_valid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valid:&quot;</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>

<span class="c1"># scipy.signal.fftconvolve for large arrays (FFT-based)</span>
<span class="n">y_fft</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FFT:&quot;</span><span class="p">,</span> <span class="n">y_fft</span><span class="p">)</span>
</code></pre></div>

<h3 id="54-convolution-modes-comparison">5.4 Convolution Modes Comparison<a class="header-link" href="#54-convolution-modes-comparison" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Output Length</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>'full'</code></td>
<td>$N + M - 1$</td>
<td>Complete convolution result</td>
</tr>
<tr>
<td><code>'same'</code></td>
<td>$\max(N, M)$</td>
<td>Output same size as largest input</td>
</tr>
<tr>
<td><code>'valid'</code></td>
<td>$|N - M| + 1$</td>
<td>Only where inputs fully overlap</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Convolution modes visualization ---</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>

<span class="n">y_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="n">y_same</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">y_valid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Input x[n] (length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_full</span><span class="p">)),</span> <span class="n">y_full</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mode=&#39;full&#39; (length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_full</span><span class="p">)</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="si">}</span><span class="s2"> - 1)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_same</span><span class="p">)),</span> <span class="n">y_same</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mode=&#39;same&#39; (length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_same</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_valid</span><span class="p">)),</span> <span class="n">y_valid</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;mo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mode=&#39;valid&#39; (length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_valid</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;convolution_modes.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6-properties-of-convolution">6. Properties of Convolution<a class="header-link" href="#6-properties-of-convolution" title="Permanent link">&para;</a></h2>
<p>Convolution satisfies several algebraic properties that are both theoretically important and practically useful.</p>
<h3 id="61-commutativity">6.1 Commutativity<a class="header-link" href="#61-commutativity" title="Permanent link">&para;</a></h3>
<p>$$x[n] * h[n] = h[n] * x[n]$$</p>
<p>or equivalently:</p>
<p>$$\sum_k x[k]h[n-k] = \sum_k h[k]x[n-k]$$</p>
<p><strong>Proof</strong>: Substitute $m = n - k$ in the first sum.</p>
<p><strong>Implication</strong>: The roles of input and system can be interchanged. When computing convolution, we can choose to "flip" whichever signal is more convenient.</p>
<h3 id="62-associativity">6.2 Associativity<a class="header-link" href="#62-associativity" title="Permanent link">&para;</a></h3>
<p>$$(x * h_1) * h_2 = x * (h_1 * h_2)$$</p>
<p><strong>Implication</strong>: A cascade of two LTI systems with impulse responses $h_1$ and $h_2$ is equivalent to a single LTI system with impulse response $h_1 * h_2$, regardless of the cascade order.</p>
<h3 id="63-distributivity-over-addition">6.3 Distributivity over Addition<a class="header-link" href="#63-distributivity-over-addition" title="Permanent link">&para;</a></h3>
<p>$$x * (h_1 + h_2) = x * h_1 + x * h_2$$</p>
<p><strong>Implication</strong>: A parallel combination of two LTI systems is equivalent to a single system whose impulse response is the sum of the individual impulse responses.</p>
<h3 id="64-identity-element">6.4 Identity Element<a class="header-link" href="#64-identity-element" title="Permanent link">&para;</a></h3>
<p>$$x * \delta = x$$</p>
<p>The impulse $\delta$ is the identity for convolution, just as 1 is the identity for multiplication.</p>
<h3 id="65-shift-property">6.5 Shift Property<a class="header-link" href="#65-shift-property" title="Permanent link">&para;</a></h3>
<p>$$x[n] * \delta[n - n_0] = x[n - n_0]$$</p>
<p>Convolution with a shifted impulse delays the signal.</p>
<h3 id="66-width-property">6.6 Width Property<a class="header-link" href="#66-width-property" title="Permanent link">&para;</a></h3>
<p>If $x[n]$ has support $[N_1, N_2]$ and $h[n]$ has support $[M_1, M_2]$, then $y[n] = x[n] * h[n]$ has support $[N_1 + M_1, N_2 + M_2]$.</p>
<p>The output <strong>duration</strong> (width) equals the sum of input durations (minus 1 for discrete-time).</p>
<h3 id="67-convolution-with-scaled-impulse-pair-echo-system">6.7 Convolution with Scaled Impulse Pair (Echo System)<a class="header-link" href="#67-convolution-with-scaled-impulse-pair-echo-system" title="Permanent link">&para;</a></h3>
<p>A common application: the system $h[n] = \delta[n] + \alpha \delta[n - D]$ (echo with delay $D$ and attenuation $\alpha$) produces:</p>
<p>$$y[n] = x[n] + \alpha x[n - D]$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># --- Verify convolution properties ---</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Commutativity</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h1</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Commutativity error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y2</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Associativity</span>
<span class="n">y_assoc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h1</span><span class="p">),</span> <span class="n">h2</span><span class="p">)</span>
<span class="n">y_assoc2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Associativity error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_assoc1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_assoc2</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Distributivity</span>
<span class="n">y_dist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">h1</span><span class="p">)])</span>  <span class="c1"># need same length for addition</span>
<span class="n">h_padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">h2</span><span class="p">)))</span>
<span class="n">h_padded</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">h1</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">h1</span>
<span class="n">h_padded2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">h2</span><span class="p">)))</span>
<span class="n">h_padded2</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">h2</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">h2</span>
<span class="n">y_dist_lhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_padded</span> <span class="o">+</span> <span class="n">h_padded2</span><span class="p">)</span>
<span class="n">y_dist_rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_dist_lhs</span><span class="p">))</span>
<span class="n">y_r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_padded</span><span class="p">)</span>
<span class="n">y_r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_padded2</span><span class="p">)</span>
<span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_r1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_r2</span><span class="p">))</span>
<span class="n">y_dist_rhs_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">max_len</span><span class="p">)</span>
<span class="n">y_dist_rhs_a</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_r1</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">y_r1</span>
<span class="n">y_dist_rhs_a</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_r2</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">y_r2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distributivity error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_dist_lhs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_dist_rhs_a</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_dist_lhs</span><span class="p">)]))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Identity</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">y_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Identity error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_id</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7-step-response">7. Step Response<a class="header-link" href="#7-step-response" title="Permanent link">&para;</a></h2>
<h3 id="71-definition">7.1 Definition<a class="header-link" href="#71-definition" title="Permanent link">&para;</a></h3>
<p>The <strong>step response</strong> $s(t)$ (or $s[n]$) is the output when the input is the unit step:</p>
<p>$$s(t) = h(t) * u(t) = \int_{-\infty}^{t} h(\tau) \, d\tau$$</p>
<p>$$s[n] = h[n] * u[n] = \sum_{k=-\infty}^{n} h[k]$$</p>
<h3 id="72-relationship-to-impulse-response">7.2 Relationship to Impulse Response<a class="header-link" href="#72-relationship-to-impulse-response" title="Permanent link">&para;</a></h3>
<p>The step response is the <strong>running integral</strong> (continuous) or <strong>running sum</strong> (discrete) of the impulse response:</p>
<p>$$s(t) = \int_{-\infty}^{t} h(\tau) \, d\tau \quad \Leftrightarrow \quad h(t) = \frac{ds(t)}{dt}$$</p>
<p>$$s[n] = \sum_{k=-\infty}^{n} h[k] \quad \Leftrightarrow \quad h[n] = s[n] - s[n-1]$$</p>
<p>This means we can determine the impulse response by differentiating (or first-differencing) the step response, and vice versa.</p>
<h3 id="73-example">7.3 Example<a class="header-link" href="#73-example" title="Permanent link">&para;</a></h3>
<p>For $h[n] = (0.8)^n u[n]$:</p>
<p>$$s[n] = \sum_{k=0}^{n} (0.8)^k = \frac{1 - (0.8)^{n+1}}{1 - 0.8} = 5(1 - (0.8)^{n+1}), \quad n \geq 0$$</p>
<p>As $n \to \infty$: $s[\infty] = 5$, which is the <strong>DC gain</strong> of the system.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Impulse response and step response ---</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">a</span> <span class="o">**</span> <span class="n">n</span>  <span class="c1"># impulse response</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>  <span class="c1"># step response = running sum of h</span>

<span class="c1"># Analytical step response</span>
<span class="n">s_analytical</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.8</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Impulse Response: $h[n] = (</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">)^n u[n]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Numerical&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">s_analytical</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DC gain = 5&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Step Response: $s[n] = 5(1 - </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">^</span><span class="se">{{</span><span class="s1">n+1</span><span class="se">}}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;s[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;step_response.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8-system-interconnections">8. System Interconnections<a class="header-link" href="#8-system-interconnections" title="Permanent link">&para;</a></h2>
<p>LTI systems can be combined in several ways, and the resulting composite system is also LTI.</p>
<h3 id="81-cascade-series-connection">8.1 Cascade (Series) Connection<a class="header-link" href="#81-cascade-series-connection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="o">[</span><span class="n">h‚ÇÅ</span><span class="o">]</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="o">[</span><span class="n">h‚ÇÇ</span><span class="o">]</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">y</span>
</code></pre></div>

<p><strong>Equivalent impulse response</strong>: $h_{\text{eq}} = h_1 * h_2$</p>
<p>By associativity and commutativity of convolution:</p>
<p>$$y = x * h_1 * h_2 = x * (h_1 * h_2) = x * (h_2 * h_1)$$</p>
<p>The order of cascade stages does not matter (for LTI systems).</p>
<h3 id="82-parallel-connection">8.2 Parallel Connection<a class="header-link" href="#82-parallel-connection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="w">     </span><span class="err">‚îå‚îÄ</span><span class="o">[</span><span class="n">h‚ÇÅ</span><span class="o">]</span><span class="err">‚îÄ‚îê</span>
<span class="n">x</span><span class="w"> </span><span class="err">‚îÄ‚îÄ‚ñ∫‚îÇ</span><span class="w">       </span><span class="err">‚îú‚îÄ‚îÄ‚ñ∫</span><span class="w"> </span><span class="p">(</span><span class="o">+</span><span class="p">)</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">y</span>
<span class="w">     </span><span class="err">‚îî‚îÄ</span><span class="o">[</span><span class="n">h‚ÇÇ</span><span class="o">]</span><span class="err">‚îÄ‚îò</span>
</code></pre></div>

<p><strong>Equivalent impulse response</strong>: $h_{\text{eq}} = h_1 + h_2$</p>
<p>By distributivity:</p>
<p>$$y = x * h_1 + x * h_2 = x * (h_1 + h_2)$$</p>
<h3 id="83-feedback-connection">8.3 Feedback Connection<a class="header-link" href="#83-feedback-connection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="p">(</span><span class="o">+</span><span class="p">)</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="o">[</span><span class="n">h‚ÇÅ</span><span class="o">]</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">y</span>
<span class="w">      </span><span class="err">‚Üë</span><span class="w">            </span><span class="err">‚îÇ</span>
<span class="w">      </span><span class="err">‚îî‚îÄ‚îÄ</span><span class="w"> </span><span class="o">[</span><span class="n">h‚ÇÇ</span><span class="o">]</span><span class="w"> </span><span class="err">‚óÑ‚îÄ‚îÄ‚îò</span>
</code></pre></div>

<p>With negative feedback: $e[n] = x[n] - h_2[n] * y[n]$ and $y[n] = h_1[n] * e[n]$.</p>
<p>This gives: $y = h_1 * (x - h_2 * y)$</p>
<p>In the transform domain (where convolution becomes multiplication):</p>
<p>$$Y(z) = H_1(z)(X(z) - H_2(z)Y(z))$$</p>
<p>$$H_{\text{eq}}(z) = \frac{Y(z)}{X(z)} = \frac{H_1(z)}{1 + H_1(z)H_2(z)}$$</p>
<p>Feedback is fundamental for creating IIR (recursive) filters and control systems.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- System interconnections ---</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="c1"># Two simple systems</span>
<span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a1</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a2</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Input signal</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># impulse input</span>

<span class="c1"># Cascade</span>
<span class="n">h_cascade</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>
<span class="n">y_cascade</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_cascade</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>

<span class="c1"># Parallel</span>
<span class="n">h_parallel</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span>
<span class="n">y_parallel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_parallel</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>

<span class="c1"># Verify cascade commutativity</span>
<span class="n">h_cascade_rev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">h1</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$h_1$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;rs&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$h_2$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Individual Impulse Responses&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h_cascade</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$h_1 * h_2$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">h_cascade_rev</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$h_2 * h_1$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cascade: $h_1 * h_2 = h_2 * h_1$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h_parallel</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Parallel: $h_1 + h_2$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Compare cascade and parallel responses</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">y_cascade</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cascade&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">y_parallel</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Parallel&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Response Comparison&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;system_interconnections.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="9-lti-system-stability">9. LTI System Stability<a class="header-link" href="#9-lti-system-stability" title="Permanent link">&para;</a></h2>
<h3 id="91-bibo-stability-criterion">9.1 BIBO Stability Criterion<a class="header-link" href="#91-bibo-stability-criterion" title="Permanent link">&para;</a></h3>
<p>As established in Lesson 01, an LTI system is BIBO stable if and only if its impulse response is <strong>absolutely summable</strong> (discrete) or <strong>absolutely integrable</strong> (continuous):</p>
<p><strong>Discrete-time</strong>:</p>
<p>$$\sum_{n=-\infty}^{\infty} |h[n]| < \infty$$</p>
<p><strong>Continuous-time</strong>:</p>
<p>$$\int_{-\infty}^{\infty} |h(t)| \, dt < \infty$$</p>
<h3 id="92-stability-of-common-systems">9.2 Stability of Common Systems<a class="header-link" href="#92-stability-of-common-systems" title="Permanent link">&para;</a></h3>
<p><strong>First-order recursive</strong>: $h[n] = a^n u[n]$</p>
<p>$$\sum_{n=0}^{\infty} |a|^n = \frac{1}{1 - |a|} < \infty \iff |a| < 1$$</p>
<p>Stable when the pole is inside the unit circle.</p>
<p><strong>FIR system</strong>: $h[n]$ has finite duration (say $N$ samples)</p>
<p>$$\sum_{n} |h[n]| = \text{finite sum} < \infty$$</p>
<p>FIR systems are <strong>always BIBO stable</strong> (assuming finite coefficient values).</p>
<p><strong>Ideal integrator / accumulator</strong>: $h[n] = u[n]$</p>
<p>$$\sum_{n=0}^{\infty} 1 = \infty$$</p>
<p>Unstable. A constant input produces linearly growing output.</p>
<h3 id="93-causality-and-stability">9.3 Causality and Stability<a class="header-link" href="#93-causality-and-stability" title="Permanent link">&para;</a></h3>
<p>For a causal LTI system, the impulse response satisfies $h[n] = 0$ for $n < 0$ (or $h(t) = 0$ for $t < 0$).</p>
<p>In the Z-transform domain, a causal system is stable when all poles of $H(z)$ lie <strong>inside the unit circle</strong> $|z| < 1$.</p>
<p>In the Laplace domain, a causal system is stable when all poles of $H(s)$ lie in the <strong>left half-plane</strong> $\text{Re}(s) < 0$.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Stability analysis for first-order systems ---</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">poles</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a=0.3 (stable)&#39;</span><span class="p">,</span> <span class="s1">&#39;a=0.7 (stable)&#39;</span><span class="p">,</span> <span class="s1">&#39;a=0.95 (stable)&#39;</span><span class="p">,</span>
          <span class="s1">&#39;a=1.0 (marginally unstable)&#39;</span><span class="p">,</span> <span class="s1">&#39;a=1.05 (unstable)&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">poles</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">a</span> <span class="o">**</span> <span class="n">n</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Impulse Response $h[n] = a^n u[n]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Cumulative sum of |h[n]| (should converge for stable systems)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">poles</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">a</span> <span class="o">**</span> <span class="n">n</span>
    <span class="n">cum_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">cum_sum</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Running Sum $</span><span class="se">\\</span><span class="s1">sum_{k=0}^</span><span class="si">{n}</span><span class="s1"> |h[k]|$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Partial sum&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;stability_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="10-frequency-response-of-lti-systems">10. Frequency Response of LTI Systems<a class="header-link" href="#10-frequency-response-of-lti-systems" title="Permanent link">&para;</a></h2>
<h3 id="101-complex-exponentials-as-eigenfunctions">10.1 Complex Exponentials as Eigenfunctions<a class="header-link" href="#101-complex-exponentials-as-eigenfunctions" title="Permanent link">&para;</a></h3>
<p>The defining property that makes frequency-domain analysis possible:</p>
<blockquote>
<p>If the input to an LTI system is a complex exponential $x[n] = e^{j\omega n}$, the output is:</p>
<p>$$y[n] = H(e^{j\omega}) \cdot e^{j\omega n}$$</p>
<p>where $H(e^{j\omega})$ is the <strong>frequency response</strong> of the system.</p>
</blockquote>
<p><strong>Proof</strong>:</p>
<p>$$y[n] = \sum_k h[k] e^{j\omega(n-k)} = e^{j\omega n} \sum_k h[k] e^{-j\omega k} = e^{j\omega n} H(e^{j\omega})$$</p>
<p>where:</p>
<p>$$H(e^{j\omega}) = \sum_{n=-\infty}^{\infty} h[n] e^{-j\omega n}$$</p>
<p>This is the <strong>Discrete-Time Fourier Transform (DTFT)</strong> of the impulse response.</p>
<h3 id="102-magnitude-and-phase-response">10.2 Magnitude and Phase Response<a class="header-link" href="#102-magnitude-and-phase-response" title="Permanent link">&para;</a></h3>
<p>The frequency response is generally complex:</p>
<p>$$H(e^{j\omega}) = |H(e^{j\omega})| e^{j\angle H(e^{j\omega})}$$</p>
<ul>
<li>$|H(e^{j\omega})|$ is the <strong>magnitude response</strong> ‚Äî how much the system amplifies or attenuates each frequency</li>
<li>$\angle H(e^{j\omega})$ is the <strong>phase response</strong> ‚Äî how much the system delays each frequency component</li>
</ul>
<h3 id="103-continuous-time-frequency-response">10.3 Continuous-Time Frequency Response<a class="header-link" href="#103-continuous-time-frequency-response" title="Permanent link">&para;</a></h3>
<p>For continuous-time LTI systems:</p>
<p>$$H(j\omega) = \int_{-\infty}^{\infty} h(t) e^{-j\omega t} \, dt$$</p>
<p>This is the <strong>Fourier transform</strong> of $h(t)$. If the input is $x(t) = e^{j\omega_0 t}$, the output is $y(t) = H(j\omega_0)e^{j\omega_0 t}$.</p>
<h3 id="104-example-moving-average-filter">10.4 Example: Moving Average Filter<a class="header-link" href="#104-example-moving-average-filter" title="Permanent link">&para;</a></h3>
<p>For a 5-point moving average: $h[n] = \frac{1}{5}$ for $n = 0, 1, 2, 3, 4$:</p>
<p>$$H(e^{j\omega}) = \frac{1}{5} \sum_{n=0}^{4} e^{-j\omega n} = \frac{1}{5} \cdot \frac{1 - e^{-j5\omega}}{1 - e^{-j\omega}}$$</p>
<p>The magnitude:</p>
<p>$$|H(e^{j\omega})| = \frac{1}{5} \left|\frac{\sin(5\omega/2)}{\sin(\omega/2)}\right|$$</p>
<p>This is a lowpass filter ‚Äî it passes low frequencies and attenuates high frequencies.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Frequency response of common systems ---</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 1. Moving average (M=5)</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">H_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="n">H_ma</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">M</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_ma</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moving Average (M=</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">) ‚Äî Magnitude Response&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency ($</span><span class="se">\\</span><span class="s1">omega/</span><span class="se">\\</span><span class="s1">pi$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H_ma</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moving Average (M=</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1">) ‚Äî Phase Response&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency ($</span><span class="se">\\</span><span class="s1">omega/</span><span class="se">\\</span><span class="s1">pi$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (radians)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. First-order IIR: h[n] = a^n u[n], H(z) = 1/(1-az^{-1})</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]:</span>
    <span class="n">H_iir</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_iir</span><span class="p">)),</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;a=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;First-Order IIR ‚Äî Magnitude Response&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Frequency ($</span><span class="se">\\</span><span class="s1">omega/</span><span class="se">\\</span><span class="s1">pi$)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Effect of filtering on a signal</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">n_sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">n_sig</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">n_sig</span><span class="p">)</span>
<span class="n">x_noisy</span> <span class="o">=</span> <span class="n">x_signal</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># Apply 11-point moving average</span>
<span class="n">M_filt</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">h_filt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M_filt</span><span class="p">)</span> <span class="o">/</span> <span class="n">M_filt</span>
<span class="n">y_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x_noisy</span><span class="p">,</span> <span class="n">h_filt</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_sig</span><span class="p">,</span> <span class="n">x_noisy</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Noisy input&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_sig</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MA(</span><span class="si">{</span><span class="n">M_filt</span><span class="si">}</span><span class="s1">) filtered&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_sig</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">n_sig</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Low-freq component&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Moving Average as Lowpass Filter&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;frequency_response.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11-python-examples">11. Python Examples<a class="header-link" href="#11-python-examples" title="Permanent link">&para;</a></h2>
<h3 id="111-complete-convolution-toolkit">11.1 Complete Convolution Toolkit<a class="header-link" href="#111-complete-convolution-toolkit" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ConvolutionToolkit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Comprehensive toolkit for computing and analyzing convolutions.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">convolve_direct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Direct O(NM) convolution.&quot;&quot;&quot;</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
                    <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">convolve_fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;FFT-based O(N log N) convolution.&quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">N_fft</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">N_fft</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">benchmark</span><span class="p">(</span><span class="n">N_values</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare direct vs FFT convolution speed.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;N&#39;</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Direct (ms)&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;FFT (ms)&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;NumPy (ms)&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Speedup&#39;</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_values</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

            <span class="c1"># Direct (only for small N)</span>
            <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">5000</span><span class="p">:</span>
                <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
                <span class="n">y_direct</span> <span class="o">=</span> <span class="n">ConvolutionToolkit</span><span class="o">.</span><span class="n">convolve_direct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
                <span class="n">t_direct</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t_direct</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

            <span class="c1"># FFT</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
            <span class="n">y_fft</span> <span class="o">=</span> <span class="n">ConvolutionToolkit</span><span class="o">.</span><span class="n">convolve_fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="n">t_fft</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>

            <span class="c1"># NumPy</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
            <span class="n">y_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="n">t_numpy</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>

            <span class="n">speedup</span> <span class="o">=</span> <span class="n">t_direct</span> <span class="o">/</span> <span class="n">t_fft</span> <span class="k">if</span> <span class="n">t_direct</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
            <span class="n">t_direct_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t_direct</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">t_direct</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;skipped&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">N</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">t_direct_str</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">t_fft</span><span class="si">:</span><span class="s2">&gt;12.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">t_numpy</span><span class="si">:</span><span class="s2">&gt;12.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">speedup</span><span class="si">:</span><span class="s2">&gt;8.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>


<span class="c1"># Run benchmark</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Convolution Performance Benchmark ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ConvolutionToolkit</span><span class="o">.</span><span class="n">benchmark</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
</code></pre></div>

<h3 id="112-echo-simulation">11.2 Echo Simulation<a class="header-link" href="#112-echo-simulation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Echo system simulation ---</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c1"># sampling rate</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">duration</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">fs</span>

<span class="c1"># Original signal: sum of two sinusoids</span>
<span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

<span class="c1"># Fade in/out</span>
<span class="n">fade_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.02</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">x</span><span class="p">[:</span><span class="n">fade_len</span><span class="p">]</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fade_len</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="n">fade_len</span><span class="p">:]</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fade_len</span><span class="p">)</span>

<span class="c1"># Echo system: h[n] = delta[n] + 0.6*delta[n-D1] + 0.3*delta[n-D2]</span>
<span class="n">D1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>   <span class="c1"># 100ms delay</span>
<span class="n">D2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>  <span class="c1"># 250ms delay</span>
<span class="n">h_echo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">D2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">h_echo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">h_echo</span><span class="p">[</span><span class="n">D1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">h_echo</span><span class="p">[</span><span class="n">D2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="c1"># Apply echo</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h_echo</span><span class="p">)</span>
<span class="n">t_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="n">fs</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Signal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_echo</span><span class="p">))</span> <span class="o">/</span> <span class="n">fs</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">h_echo</span><span class="p">,</span>
             <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Echo Impulse Response: $</span><span class="se">\\</span><span class="s1">delta[n] + 0.6</span><span class="se">\\</span><span class="s1">delta[n-</span><span class="si">{</span><span class="n">D1</span><span class="si">}</span><span class="s1">] + 0.3</span><span class="se">\\</span><span class="s1">delta[n-</span><span class="si">{</span><span class="n">D2</span><span class="si">}</span><span class="s1">]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;h[n]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_out</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output with Echo&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;echo_simulation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="113-system-identification-from-step-response">11.3 System Identification from Step Response<a class="header-link" href="#113-system-identification-from-step-response" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Recover impulse response from step response ---</span>

<span class="c1"># Unknown system: 3-tap FIR h = [0.5, 1.0, 0.5]</span>
<span class="n">h_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="c1"># Apply unit step to get step response</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># unit step</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">h_true</span><span class="p">)[:</span><span class="n">N</span><span class="p">]</span>

<span class="c1"># Recover impulse response by first differencing</span>
<span class="n">h_recovered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">h_recovered</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">h_recovered</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True impulse response:&quot;</span><span class="p">,</span> <span class="n">h_true</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recovered (first 5):&quot;</span><span class="p">,</span> <span class="n">h_recovered</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_true</span><span class="p">)),</span> <span class="n">h_true</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;True Impulse Response $h[n]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Measured Step Response $s[n]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">h_recovered</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Recovered $h[n] = s[n] - s[n-1]$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;system_identification.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="114-frequency-response-analysis">11.4 Frequency Response Analysis<a class="header-link" href="#114-frequency-response-analysis" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Frequency response from impulse response ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_freq_response</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;System&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot magnitude and phase response of a discrete-time system.&quot;&quot;&quot;</span>
    <span class="c1"># Compute DTFT at 1024 frequency points</span>
    <span class="n">N_freq</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">N_freq</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_freq</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">omega</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">hn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
            <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hn</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">w</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>

    <span class="n">mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>
    <span class="n">group_delay</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>

    <span class="n">freq</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="k">if</span> <span class="n">fs</span> <span class="o">!=</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="n">omega</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

    <span class="c1"># Magnitude</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">mag_db</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1"> ‚Äî Magnitude Response&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Phase</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">phase</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1"> ‚Äî Phase Response&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (degrees)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Group delay</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">group_delay</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1"> ‚Äî Group Delay&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span> <span class="k">if</span> <span class="n">fs</span> <span class="o">!=</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="s1">&#39;Normalized Frequency ($</span><span class="se">\\</span><span class="s1">omega/</span><span class="se">\\</span><span class="s1">pi$)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;freq_response_</span><span class="si">{</span><span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Example 1: 7-point moving average</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">h_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">/</span> <span class="n">M</span>
<span class="n">plot_freq_response</span><span class="p">(</span><span class="n">h_ma</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;7-Point Moving Average&quot;</span><span class="p">)</span>

<span class="c1"># Example 2: Difference filter (high-pass)</span>
<span class="n">h_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_freq_response</span><span class="p">(</span><span class="n">h_diff</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;First Difference&quot;</span><span class="p">)</span>

<span class="c1"># Example 3: Bandpass-like filter</span>
<span class="n">h_bp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="n">plot_freq_response</span><span class="p">(</span><span class="n">h_bp</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Bandpass-Like FIR&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="12-summary">12. Summary<a class="header-link" href="#12-summary" title="Permanent link">&para;</a></h2>
<h3 id="key-formulas">Key Formulas<a class="header-link" href="#key-formulas" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Discrete-Time</th>
<th>Continuous-Time</th>
</tr>
</thead>
<tbody>
<tr>
<td>Convolution</td>
<td>$y[n] = \sum_k x[k]h[n-k]$</td>
<td>$y(t) = \int x(\tau)h(t-\tau)d\tau$</td>
</tr>
<tr>
<td>Impulse response</td>
<td>$h[n] = \mathcal{T}\{\delta[n]\}$</td>
<td>$h(t) = \mathcal{T}\{\delta(t)\}$</td>
</tr>
<tr>
<td>Step response</td>
<td>$s[n] = \sum_{k \leq n} h[k]$</td>
<td>$s(t) = \int_{-\infty}^{t} h(\tau)d\tau$</td>
</tr>
<tr>
<td>Frequency response</td>
<td>$H(e^{j\omega}) = \sum_n h[n]e^{-j\omega n}$</td>
<td>$H(j\omega) = \int h(t)e^{-j\omega t}dt$</td>
</tr>
<tr>
<td>BIBO stability</td>
<td>$\sum |h[n]| < \infty$</td>
<td>$\int |h(t)|dt < \infty$</td>
</tr>
</tbody>
</table>
<h3 id="convolution-properties">Convolution Properties<a class="header-link" href="#convolution-properties" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td>Commutativity</td>
<td>$x * h = h * x$</td>
</tr>
<tr>
<td>Associativity</td>
<td>$(x * h_1) * h_2 = x * (h_1 * h_2)$</td>
</tr>
<tr>
<td>Distributivity</td>
<td>$x * (h_1 + h_2) = x * h_1 + x * h_2$</td>
</tr>
<tr>
<td>Identity</td>
<td>$x * \delta = x$</td>
</tr>
<tr>
<td>Shift</td>
<td>$x * \delta_{n_0} = x[n - n_0]$</td>
</tr>
<tr>
<td>Width</td>
<td>Support of $y$ = sum of supports</td>
</tr>
</tbody>
</table>
<h3 id="conceptual-map">Conceptual Map<a class="header-link" href="#conceptual-map" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="w">          </span><span class="n">Impulse</span><span class="w"> </span><span class="n">Œ¥</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">              </span><span class="err">‚îÇ</span>
<span class="w">              </span><span class="err">‚ñº</span>
<span class="w">    </span><span class="n">LTI</span><span class="w"> </span><span class="k">System</span><span class="w"> </span><span class="n">T</span><span class="err">{¬∑}</span><span class="w">  </span><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫</span><span class="w">  </span><span class="n">Impulse</span><span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="n">h</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">              </span><span class="err">‚îÇ</span><span class="w">                        </span><span class="err">‚îÇ</span>
<span class="w">              </span><span class="err">‚îÇ</span><span class="w">                </span><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
<span class="w">              </span><span class="err">‚îÇ</span><span class="w">                </span><span class="err">‚ñº</span><span class="w">       </span><span class="err">‚ñº</span><span class="w">       </span><span class="err">‚ñº</span>
<span class="w">              </span><span class="err">‚îÇ</span><span class="w">           </span><span class="n">Stability</span><span class="w">  </span><span class="n">Freq</span><span class="p">.</span><span class="w">   </span><span class="n">Step</span>
<span class="w">              </span><span class="err">‚îÇ</span><span class="w">           </span><span class="k">Check</span><span class="w">      </span><span class="n">Response</span><span class="w"> </span><span class="n">Response</span>
<span class="w">              </span><span class="err">‚îÇ</span>
<span class="w">    </span><span class="ow">Any</span><span class="w"> </span><span class="k">Input</span><span class="w"> </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">              </span><span class="err">‚îÇ</span>
<span class="w">              </span><span class="err">‚ñº</span>
<span class="w">    </span><span class="n">y</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">CONVOLUTION</span><span class="p">)</span>
</code></pre></div>

<p>The key insight of this lesson: <strong>for LTI systems, everything reduces to convolution</strong>. Once you know the impulse response, you know everything about the system.</p>
<hr />
<h2 id="13-exercises">13. Exercises<a class="header-link" href="#13-exercises" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-analytical-convolution">Exercise 1: Analytical Convolution<a class="header-link" href="#exercise-1-analytical-convolution" title="Permanent link">&para;</a></h3>
<p>Compute the following convolutions by hand. Verify your results using <code>np.convolve()</code>.</p>
<ol>
<li>$x[n] = \{2, 1, -1\}$ and $h[n] = \{1, 3, 2\}$ (starting at $n = 0$)</li>
<li>$x[n] = u[n] - u[n-4]$ and $h[n] = (0.5)^n u[n]$</li>
<li>$x[n] = (0.8)^n u[n]$ and $h[n] = (0.6)^n u[n]$ (use the closed-form of geometric series)</li>
</ol>
<h3 id="exercise-2-continuous-time-convolution">Exercise 2: Continuous-Time Convolution<a class="header-link" href="#exercise-2-continuous-time-convolution" title="Permanent link">&para;</a></h3>
<p>Compute analytically:</p>
<ol>
<li>$y(t) = e^{-t}u(t) * e^{-2t}u(t)$</li>
<li>$y(t) = u(t) * u(t)$ (what is the result, and why does it reveal a stability issue?)</li>
<li>$y(t) = \text{rect}(t/2) * e^{-t}u(t)$</li>
</ol>
<h3 id="exercise-3-system-analysis">Exercise 3: System Analysis<a class="header-link" href="#exercise-3-system-analysis" title="Permanent link">&para;</a></h3>
<p>A causal LTI system is described by the difference equation:</p>
<p>$$y[n] = 0.5 y[n-1] + x[n]$$</p>
<ol>
<li>Find the impulse response $h[n]$ by setting $x[n] = \delta[n]$ and iterating</li>
<li>Is the system BIBO stable? Prove your answer</li>
<li>Compute the step response</li>
<li>Find the frequency response $H(e^{j\omega})$</li>
<li>Plot the magnitude and phase response using Python</li>
</ol>
<h3 id="exercise-4-cascade-vs-parallel">Exercise 4: Cascade vs. Parallel<a class="header-link" href="#exercise-4-cascade-vs-parallel" title="Permanent link">&para;</a></h3>
<p>Two LTI systems have impulse responses:</p>
<p>$$h_1[n] = (0.7)^n u[n], \qquad h_2[n] = (0.5)^n u[n]$$</p>
<ol>
<li>Find the impulse response of the cascade connection $h_1 * h_2$</li>
<li>Find the impulse response of the parallel connection $h_1 + h_2$</li>
<li>Verify numerically that the cascade order does not matter: $h_1 * h_2 = h_2 * h_1$</li>
<li>For input $x[n] = \delta[n] - 0.3\delta[n-1]$, compute and plot the output for both configurations</li>
</ol>
<h3 id="exercise-5-moving-average-filter-analysis">Exercise 5: Moving Average Filter Analysis<a class="header-link" href="#exercise-5-moving-average-filter-analysis" title="Permanent link">&para;</a></h3>
<p>For an $M$-point moving average filter $h[n] = \frac{1}{M}$ for $n = 0, 1, \ldots, M-1$:</p>
<ol>
<li>Derive the frequency response $H(e^{j\omega})$ in closed form</li>
<li>At what frequencies are the nulls (zeros of $H$)?</li>
<li>What is the 3-dB bandwidth as a function of $M$?</li>
<li>Plot the magnitude response for $M = 3, 7, 15, 31$ on the same graph</li>
<li>Apply each filter to a signal containing 50 Hz and 400 Hz components at $f_s = 1000$ Hz. Which $M$ best separates them?</li>
</ol>
<h3 id="exercise-6-convolution-in-practice">Exercise 6: Convolution in Practice<a class="header-link" href="#exercise-6-convolution-in-practice" title="Permanent link">&para;</a></h3>
<ol>
<li>Generate a 1-second chirp signal sweeping from 100 Hz to 2000 Hz at $f_s = 8000$ Hz</li>
<li>Create an echo system with three reflections at 50ms, 120ms, and 200ms with decreasing amplitudes</li>
<li>Convolve the chirp with the echo system</li>
<li>Compare the direct convolution time vs. FFT convolution time</li>
<li>Plot the input and output spectrograms side by side</li>
</ol>
<h3 id="exercise-7-system-identification">Exercise 7: System Identification<a class="header-link" href="#exercise-7-system-identification" title="Permanent link">&para;</a></h3>
<p>You are given access to an unknown LTI system (a black box). You can apply any input and observe the output.</p>
<ol>
<li>Apply a unit impulse to directly measure $h[n]$</li>
<li>Apply a unit step to measure $s[n]$, then recover $h[n] = s[n] - s[n-1]$</li>
<li>Apply white noise of length 10000 and use cross-correlation to estimate $h[n]$</li>
<li>Compare the three methods. Which gives the most accurate result with the least signal energy?</li>
</ol>
<p>Implement this using the following black-box system (do not look at the implementation when testing):</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">black_box_system</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unknown LTI system ‚Äî treat as a black box.&quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</code></pre></div>

<h3 id="exercise-8-deconvolution">Exercise 8: Deconvolution<a class="header-link" href="#exercise-8-deconvolution" title="Permanent link">&para;</a></h3>
<p>Given $y[n] = x[n] * h[n]$ where $h[n]$ is known and $y[n]$ is measured, recovering $x[n]$ is called <strong>deconvolution</strong>.</p>
<ol>
<li>Generate a sparse signal $x[n]$ with 5 nonzero values in 100 samples</li>
<li>Convolve with $h[n] = [1, 0.5, 0.25]$ to get $y[n]$</li>
<li>Add small noise: $y_{\text{noisy}}[n] = y[n] + 0.01 \cdot w[n]$ where $w$ is white noise</li>
<li>Attempt deconvolution using FFT: $X = Y/H$ in the frequency domain</li>
<li>Explain why direct deconvolution is problematic (hint: consider frequencies where $H \approx 0$)</li>
<li>Implement Wiener deconvolution: $\hat{X} = \frac{H^* Y}{|H|^2 + \lambda}$ and show the improvement</li>
</ol>
<hr />
<h2 id="14-references">14. References<a class="header-link" href="#14-references" title="Permanent link">&para;</a></h2>
<ol>
<li>Oppenheim, A. V. &amp; Willsky, A. S. <em>Signals and Systems</em> (2nd ed.), Ch. 2-3. Prentice Hall, 1997.</li>
<li>Oppenheim, A. V. &amp; Schafer, R. W. <em>Discrete-Time Signal Processing</em> (3rd ed.), Ch. 2. Pearson, 2010.</li>
<li>Haykin, S. &amp; Van Veen, B. <em>Signals and Systems</em> (2nd ed.), Ch. 2-4. Wiley, 2003.</li>
<li>Smith, S. W. <em>The Scientist and Engineer's Guide to Digital Signal Processing</em>, Ch. 6-7. California Technical Publishing, 1997. (Free online: dspguide.com)</li>
</ol>
<hr />
<p><a href="./01_Signals_and_Systems.md">Previous: 01. Signals and Systems</a> | <a href="./03_Fourier_Series_and_Applications.md">Next: 03. Fourier Series and Applications</a> | <a href="./00_Overview.md">Overview</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/01_Signals_and_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Signals and Systems</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/03_Fourier_Series_and_Applications.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Fourier Series and Applications</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}