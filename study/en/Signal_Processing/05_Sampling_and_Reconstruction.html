{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sampling and Reconstruction - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">Sampling and Reconstruction</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Sampling and Reconstruction</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/04_Continuous_Fourier_Transform.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Continuous Fourier Transform</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/06_Discrete_Fourier_Transform.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Discrete Fourier Transform</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#1-sampling-of-continuous-time-signals">1. Sampling of Continuous-Time Signals</a><ul>
<li><a href="#11-why-sample">1.1 Why Sample?</a></li>
<li><a href="#12-the-sampling-process">1.2 The Sampling Process</a></li>
</ul>
</li>
<li><a href="#2-ideal-sampling-with-impulse-train">2. Ideal Sampling with Impulse Train</a><ul>
<li><a href="#21-mathematical-model">2.1 Mathematical Model</a></li>
<li><a href="#22-frequency-domain-analysis">2.2 Frequency Domain Analysis</a></li>
<li><a href="#23-visualizing-spectral-replication">2.3 Visualizing Spectral Replication</a></li>
</ul>
</li>
<li><a href="#3-the-nyquist-shannon-sampling-theorem">3. The Nyquist-Shannon Sampling Theorem</a><ul>
<li><a href="#31-statement-of-the-theorem">3.1 Statement of the Theorem</a></li>
<li><a href="#32-key-definitions">3.2 Key Definitions</a></li>
<li><a href="#33-proof-sketch">3.3 Proof Sketch</a></li>
<li><a href="#34-reconstruction-formula">3.4 Reconstruction Formula</a></li>
</ul>
</li>
<li><a href="#4-aliasing">4. Aliasing</a><ul>
<li><a href="#41-what-is-aliasing">4.1 What Is Aliasing?</a></li>
<li><a href="#42-aliasing-examples">4.2 Aliasing Examples</a></li>
<li><a href="#43-aliasing-in-real-world-scenarios">4.3 Aliasing in Real-World Scenarios</a></li>
<li><a href="#44-the-wagon-wheel-effect">4.4 The Wagon Wheel Effect</a></li>
</ul>
</li>
<li><a href="#5-anti-aliasing-filters">5. Anti-Aliasing Filters</a><ul>
<li><a href="#51-purpose">5.1 Purpose</a></li>
<li><a href="#52-ideal-vs-practical-anti-aliasing">5.2 Ideal vs. Practical Anti-Aliasing</a></li>
<li><a href="#53-practical-considerations">5.3 Practical Considerations</a></li>
</ul>
</li>
<li><a href="#6-reconstruction">6. Reconstruction</a><ul>
<li><a href="#61-ideal-reconstruction-sinc-interpolation">6.1 Ideal Reconstruction (Sinc Interpolation)</a></li>
<li><a href="#62-individual-sinc-contributions">6.2 Individual Sinc Contributions</a></li>
</ul>
</li>
<li><a href="#7-zero-order-hold-and-first-order-hold">7. Zero-Order Hold and First-Order Hold</a><ul>
<li><a href="#71-zero-order-hold-zoh">7.1 Zero-Order Hold (ZOH)</a></li>
<li><a href="#72-first-order-hold-foh">7.2 First-Order Hold (FOH)</a></li>
<li><a href="#73-comparison-of-reconstruction-methods">7.3 Comparison of Reconstruction Methods</a></li>
</ul>
</li>
<li><a href="#8-practical-adcdac-considerations">8. Practical ADC/DAC Considerations</a><ul>
<li><a href="#81-analog-to-digital-conversion-adc">8.1 Analog-to-Digital Conversion (ADC)</a></li>
<li><a href="#82-quantization">8.2 Quantization</a></li>
<li><a href="#83-digital-to-analog-conversion-dac">8.3 Digital-to-Analog Conversion (DAC)</a></li>
<li><a href="#84-compensation-for-zoh-distortion">8.4 Compensation for ZOH Distortion</a></li>
</ul>
</li>
<li><a href="#9-oversampling-and-its-benefits">9. Oversampling and Its Benefits</a><ul>
<li><a href="#91-what-is-oversampling">9.1 What Is Oversampling?</a></li>
<li><a href="#92-benefits-of-oversampling">9.2 Benefits of Oversampling</a></li>
<li><a href="#93-sigma-delta-latex72-oversampling-adc">9.3 Sigma-Delta ( LATEX72 ) Oversampling ADC</a></li>
<li><a href="#94-decimation-after-oversampling">9.4 Decimation After Oversampling</a></li>
</ul>
</li>
<li><a href="#10-multirate-signal-processing-preview">10. Multirate Signal Processing Preview</a><ul>
<li><a href="#101-decimation-downsampling">10.1 Decimation (Downsampling)</a></li>
<li><a href="#102-interpolation-upsampling">10.2 Interpolation (Upsampling)</a></li>
<li><a href="#103-sample-rate-conversion">10.3 Sample Rate Conversion</a></li>
</ul>
</li>
<li><a href="#11-summary">11. Summary</a></li>
<li><a href="#12-exercises">12. Exercises</a><ul>
<li><a href="#exercise-1-sampling-rate-determination">Exercise 1: Sampling Rate Determination</a></li>
<li><a href="#exercise-2-aliasing-analysis">Exercise 2: Aliasing Analysis</a></li>
<li><a href="#exercise-3-sinc-interpolation-implementation">Exercise 3: Sinc Interpolation Implementation</a></li>
<li><a href="#exercise-4-quantization-noise-analysis">Exercise 4: Quantization Noise Analysis</a></li>
<li><a href="#exercise-5-zoh-frequency-response">Exercise 5: ZOH Frequency Response</a></li>
<li><a href="#exercise-6-oversampling-vs-bit-depth-trade-off">Exercise 6: Oversampling vs. Bit Depth Trade-off</a></li>
<li><a href="#exercise-7-complete-adcdac-pipeline">Exercise 7: Complete ADC/DAC Pipeline</a></li>
</ul>
</li>
<li><a href="#13-further-reading">13. Further Reading</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="sampling-and-reconstruction">Sampling and Reconstruction<a class="header-link" href="#sampling-and-reconstruction" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>Sampling is the bridge between continuous-time (analog) and discrete-time (digital) signals. Understanding the sampling process, its limitations, and how to faithfully reconstruct the original signal is fundamental to all digital signal processing. This lesson covers the Nyquist-Shannon sampling theorem, aliasing, anti-aliasing strategies, reconstruction techniques, and practical ADC/DAC considerations.</p>
<p><strong>Learning Objectives:</strong>
- Understand the mathematical framework for ideal sampling
- State and prove the Nyquist-Shannon sampling theorem
- Identify and prevent aliasing
- Implement reconstruction using sinc interpolation and hold circuits
- Analyze practical ADC/DAC systems and the benefits of oversampling</p>
<p><strong>Prerequisites:</strong> <a href="04_Fourier_Transform.md">04. Fourier Transform and Frequency Domain</a></p>
<hr />
<h2 id="1-sampling-of-continuous-time-signals">1. Sampling of Continuous-Time Signals<a class="header-link" href="#1-sampling-of-continuous-time-signals" title="Permanent link">&para;</a></h2>
<h3 id="11-why-sample">1.1 Why Sample?<a class="header-link" href="#11-why-sample" title="Permanent link">&para;</a></h3>
<p>Digital systems (computers, DSP chips, microcontrollers) cannot process continuous-time signals directly. We must convert analog signals to sequences of numbers. The key question: <strong>under what conditions can we perfectly recover the original signal from its samples?</strong></p>
<h3 id="12-the-sampling-process">1.2 The Sampling Process<a class="header-link" href="#12-the-sampling-process" title="Permanent link">&para;</a></h3>
<p>Given a continuous-time signal $x(t)$, sampling at interval $T_s$ (the sampling period) produces a discrete-time signal:</p>
<p>$$x[n] = x(nT_s), \quad n \in \mathbb{Z}$$</p>
<p>The sampling frequency (sample rate) is:</p>
<p>$$f_s = \frac{1}{T_s} \quad \text{(Hz)}$$</p>
<p>The angular sampling frequency is:</p>
<p>$$\Omega_s = 2\pi f_s = \frac{2\pi}{T_s} \quad \text{(rad/s)}$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_sampling</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the basic sampling process.&quot;&quot;&quot;</span>
    <span class="c1"># Continuous-time signal (simulated with dense grid)</span>
    <span class="n">t_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">f_signal</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># 5 Hz sine wave</span>
    <span class="n">x_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_signal</span> <span class="o">*</span> <span class="n">t_cont</span><span class="p">)</span>

    <span class="c1"># Sample at different rates</span>
    <span class="n">sample_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>  <span class="c1"># Hz</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_rates</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">sample_rates</span><span class="p">):</span>
        <span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
        <span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_signal</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_cont</span><span class="p">,</span> <span class="n">x_cont</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Continuous signal&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span>
                <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Samples (fs=</span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sampling at fs = </span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz (Ts = </span><span class="si">{</span><span class="n">Ts</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> s)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sampling_basic.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">demonstrate_sampling</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="2-ideal-sampling-with-impulse-train">2. Ideal Sampling with Impulse Train<a class="header-link" href="#2-ideal-sampling-with-impulse-train" title="Permanent link">&para;</a></h2>
<h3 id="21-mathematical-model">2.1 Mathematical Model<a class="header-link" href="#21-mathematical-model" title="Permanent link">&para;</a></h3>
<p>Ideal sampling multiplies $x(t)$ by an impulse train (Dirac comb):</p>
<p>$$s(t) = \sum_{n=-\infty}^{\infty} \delta(t - nT_s)$$</p>
<p>The sampled signal is:</p>
<p>$$x_s(t) = x(t) \cdot s(t) = \sum_{n=-\infty}^{\infty} x(nT_s) \, \delta(t - nT_s)$$</p>
<h3 id="22-frequency-domain-analysis">2.2 Frequency Domain Analysis<a class="header-link" href="#22-frequency-domain-analysis" title="Permanent link">&para;</a></h3>
<p>The Fourier transform of the impulse train is another impulse train:</p>
<p>$$S(j\Omega) = \frac{2\pi}{T_s} \sum_{k=-\infty}^{\infty} \delta\!\left(\Omega - k\Omega_s\right)$$</p>
<p>Since multiplication in time corresponds to convolution in frequency:</p>
<p>$$X_s(j\Omega) = \frac{1}{2\pi} X(j\Omega) * S(j\Omega)$$</p>
<p>Substituting and simplifying:</p>
<p>$$\boxed{X_s(j\Omega) = \frac{1}{T_s} \sum_{k=-\infty}^{\infty} X\!\left(j(\Omega - k\Omega_s)\right)}$$</p>
<p>This is the <strong>fundamental result of sampling</strong>: the spectrum of the sampled signal is a periodic repetition of the original spectrum $X(j\Omega)$, shifted by integer multiples of $\Omega_s$ and scaled by $1/T_s$.</p>
<h3 id="23-visualizing-spectral-replication">2.3 Visualizing Spectral Replication<a class="header-link" href="#23-visualizing-spectral-replication" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_spectral_replication</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show how sampling replicates the spectrum periodically.&quot;&quot;&quot;</span>
    <span class="c1"># Original signal: bandlimited with max frequency B</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Hz (bandwidth)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>

    <span class="c1"># Triangular spectrum (simplified representation)</span>
    <span class="n">X_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">/</span> <span class="n">B</span><span class="p">)</span>

    <span class="c1"># Sampling frequency</span>
    <span class="n">fs_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>  <span class="c1"># Hz</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s1">&#39;fs = 15 Hz &gt; 2B = 10 Hz (No aliasing)&#39;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;fs = 10 Hz = 2B (Critical sampling)&#39;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;fs = 7 Hz &lt; 2B (Aliasing!)&#39;</span>
    <span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fs_values</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># Original spectrum</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X_orig</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X_orig</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Spectrum X(f)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|X(f)|&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fs_values</span><span class="p">,</span> <span class="n">titles</span><span class="p">):</span>
        <span class="c1"># Sum of shifted replicas</span>
        <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">X_sampled</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span> <span class="o">/</span> <span class="n">B</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X_sampled</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X_sampled</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

        <span class="c1"># Show individual replicas as dashed</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">replica</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span> <span class="o">/</span> <span class="n">B</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">replica</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Mark Nyquist boundaries</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;fs/2 = </span><span class="si">{</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|Xs(f)|&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;spectral_replication.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">visualize_spectral_replication</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="3-the-nyquist-shannon-sampling-theorem">3. The Nyquist-Shannon Sampling Theorem<a class="header-link" href="#3-the-nyquist-shannon-sampling-theorem" title="Permanent link">&para;</a></h2>
<h3 id="31-statement-of-the-theorem">3.1 Statement of the Theorem<a class="header-link" href="#31-statement-of-the-theorem" title="Permanent link">&para;</a></h3>
<p><strong>Theorem (Nyquist-Shannon):</strong> A bandlimited signal $x(t)$ with no frequency components above $B$ Hz (i.e., $X(j\Omega) = 0$ for $|\Omega| > 2\pi B$) is completely determined by its samples $x[n] = x(nT_s)$ if the sampling rate satisfies:</p>
<p>$$\boxed{f_s > 2B}$$</p>
<p>or equivalently:</p>
<p>$$T_s < \frac{1}{2B}$$</p>
<h3 id="32-key-definitions">3.2 Key Definitions<a class="header-link" href="#32-key-definitions" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Term</th>
<th>Definition</th>
<th>Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nyquist rate</strong></td>
<td>Minimum sampling rate to avoid aliasing</td>
<td>$f_{\text{Nyquist}} = 2B$</td>
</tr>
<tr>
<td><strong>Nyquist frequency</strong></td>
<td>Highest frequency representable at sampling rate $f_s$</td>
<td>$f_{\text{max}} = f_s / 2$</td>
</tr>
<tr>
<td><strong>Nyquist interval</strong></td>
<td>Maximum spacing between samples</td>
<td>$T_{\text{Nyquist}} = 1/(2B)$</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Important distinction:</strong> The Nyquist <em>rate</em> depends on the signal ($2B$), while the Nyquist <em>frequency</em> depends on the sampling rate ($f_s/2$). They are equal only at the critical sampling condition.</p>
</blockquote>
<h3 id="33-proof-sketch">3.3 Proof Sketch<a class="header-link" href="#33-proof-sketch" title="Permanent link">&para;</a></h3>
<ol>
<li>The sampled spectrum is $X_s(j\Omega) = \frac{1}{T_s} \sum_k X(j(\Omega - k\Omega_s))$.</li>
<li>If $\Omega_s > 2(2\pi B)$, the shifted replicas do not overlap.</li>
<li>We can recover $X(j\Omega)$ by applying an ideal lowpass filter with cutoff $\Omega_s / 2$.</li>
<li>Therefore $x(t)$ is fully recoverable from its samples.</li>
</ol>
<h3 id="34-reconstruction-formula">3.4 Reconstruction Formula<a class="header-link" href="#34-reconstruction-formula" title="Permanent link">&para;</a></h3>
<p>When the sampling theorem is satisfied, the original signal can be reconstructed exactly:</p>
<p>$$\boxed{x(t) = \sum_{n=-\infty}^{\infty} x[n] \, \operatorname{sinc}\!\left(\frac{t - nT_s}{T_s}\right)}$$</p>
<p>where $\operatorname{sinc}(u) = \frac{\sin(\pi u)}{\pi u}$.</p>
<p>This is the <strong>Whittaker-Shannon interpolation formula</strong> (ideal sinc interpolation).</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_nyquist_theorem</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the sampling theorem with different rates.&quot;&quot;&quot;</span>
    <span class="c1"># Signal: sum of sinusoids</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span>  <span class="c1"># Hz</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mi">7</span>  <span class="c1"># Bandwidth</span>
    <span class="n">nyquist_rate</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">B</span>  <span class="c1"># 14 Hz</span>

    <span class="n">t_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">x_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t_cont</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t_cont</span><span class="p">)</span>

    <span class="n">sample_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  <span class="c1"># Above, at, below Nyquist rate</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s1">&#39;fs = 30 Hz &gt; 2B = </span><span class="si">{</span><span class="n">nyquist_rate</span><span class="si">}</span><span class="s1"> Hz (Well sampled)&#39;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;fs = 14 Hz = 2B = </span><span class="si">{</span><span class="n">nyquist_rate</span><span class="si">}</span><span class="s1"> Hz (Critical)&#39;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;fs = 10 Hz &lt; 2B = </span><span class="si">{</span><span class="n">nyquist_rate</span><span class="si">}</span><span class="s1"> Hz (Undersampled!)&#39;</span>
    <span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">sample_rates</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
        <span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>

        <span class="c1"># Sinc interpolation to reconstruct</span>
        <span class="n">t_recon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
        <span class="n">x_recon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_recon</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ns</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
            <span class="n">x_recon</span> <span class="o">+=</span> <span class="n">x_samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">t_recon</span> <span class="o">-</span> <span class="n">ns</span><span class="p">)</span> <span class="o">/</span> <span class="n">Ts</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_cont</span><span class="p">,</span> <span class="n">x_cont</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_recon</span><span class="p">,</span> <span class="n">x_recon</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconstructed&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
                <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;nyquist_theorem.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">demonstrate_nyquist_theorem</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4-aliasing">4. Aliasing<a class="header-link" href="#4-aliasing" title="Permanent link">&para;</a></h2>
<h3 id="41-what-is-aliasing">4.1 What Is Aliasing?<a class="header-link" href="#41-what-is-aliasing" title="Permanent link">&para;</a></h3>
<p>Aliasing occurs when the sampling rate is insufficient ($f_s < 2B$), causing the spectral replicas to overlap. High-frequency components "fold back" and appear as lower frequencies that are <strong>indistinguishable</strong> from genuine low-frequency content.</p>
<p>The aliased frequency of a component at frequency $f_0$ sampled at rate $f_s$ is:</p>
<p>$$f_{\text{alias}} = |f_0 - k \cdot f_s|, \quad k = \operatorname{round}(f_0 / f_s)$$</p>
<p>More precisely, the apparent frequency after sampling is:</p>
<p>$$f_{\text{apparent}} = \left| \left( (f_0 + f_s/2) \bmod f_s \right) - f_s/2 \right|$$</p>
<h3 id="42-aliasing-examples">4.2 Aliasing Examples<a class="header-link" href="#42-aliasing-examples" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_aliasing</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show aliasing with concrete sinusoidal examples.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Sampling frequency: 20 Hz</span>
    <span class="n">nyquist</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># 10 Hz</span>

    <span class="c1"># Three signals: below, at, and above Nyquist</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">]</span>  <span class="c1"># Hz</span>
    <span class="c1"># f=3 Hz: well below Nyquist, sampled correctly</span>
    <span class="c1"># f=10 Hz: at Nyquist, ambiguous</span>
    <span class="c1"># f=17 Hz: above Nyquist, aliases to |17 - 20| = 3 Hz</span>

    <span class="n">t_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">t_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">freqs</span><span class="p">):</span>
        <span class="n">x_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t_cont</span><span class="p">)</span>
        <span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t_samples</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_cont</span><span class="p">,</span> <span class="n">x_cont</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Original: </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>

        <span class="c1"># Show the aliased frequency</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">&gt;</span> <span class="n">nyquist</span><span class="p">:</span>
            <span class="n">f_alias</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">-</span> <span class="n">f</span>  <span class="c1"># For f &lt; fs</span>
            <span class="n">x_alias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_alias</span> <span class="o">*</span> <span class="n">t_cont</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_cont</span><span class="p">,</span> <span class="n">x_alias</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Alias: </span><span class="si">{</span><span class="n">f_alias</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
                <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;f = </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1"> Hz, fs = </span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz, Nyquist = </span><span class="si">{</span><span class="n">nyquist</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;aliasing_demo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">demonstrate_aliasing</span><span class="p">()</span>
</code></pre></div>

<h3 id="43-aliasing-in-real-world-scenarios">4.3 Aliasing in Real-World Scenarios<a class="header-link" href="#43-aliasing-in-real-world-scenarios" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Cause</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Audio</strong></td>
<td>Recording &gt; Nyquist/2 frequencies</td>
<td>Harsh, metallic artifacts</td>
</tr>
<tr>
<td><strong>Video</strong></td>
<td>Spinning wheels in film (24 fps)</td>
<td>Wheels appear to rotate backward</td>
</tr>
<tr>
<td><strong>Photography</strong></td>
<td>Fine patterns (Moire effect)</td>
<td>False color/pattern artifacts</td>
</tr>
<tr>
<td><strong>Medical imaging</strong></td>
<td>Insufficient spatial sampling</td>
<td>Spatial aliasing in MRI/CT</td>
</tr>
<tr>
<td><strong>Radar</strong></td>
<td>PRF too low for target velocity</td>
<td>Velocity ambiguity</td>
</tr>
</tbody>
</table>
<h3 id="44-the-wagon-wheel-effect">4.4 The Wagon Wheel Effect<a class="header-link" href="#44-the-wagon-wheel-effect" title="Permanent link">&para;</a></h3>
<p>A classic example of temporal aliasing is the "wagon wheel effect" in film:</p>
<ul>
<li>A wheel rotates at $f_{\text{wheel}}$ Hz (revolutions per second)</li>
<li>Camera samples at $f_s = 24$ fps</li>
<li>If $f_{\text{wheel}} > 12$ Hz, the wheel appears to rotate backward or at the wrong speed</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wagon_wheel_effect</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate the wagon wheel aliasing effect.&quot;&quot;&quot;</span>
    <span class="n">fps</span> <span class="o">=</span> <span class="mi">24</span>  <span class="c1"># Camera frame rate</span>

    <span class="c1"># Wheel rotation frequencies</span>
    <span class="n">rotation_freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wagon Wheel Effect (Camera: 24 fps)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">f_rot</span> <span class="ow">in</span> <span class="n">rotation_freqs</span><span class="p">:</span>
        <span class="c1"># Apparent frequency after aliasing</span>
        <span class="n">f_apparent</span> <span class="o">=</span> <span class="n">f_rot</span> <span class="o">%</span> <span class="n">fps</span>
        <span class="k">if</span> <span class="n">f_apparent</span> <span class="o">&gt;</span> <span class="n">fps</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">f_apparent</span> <span class="o">=</span> <span class="n">f_apparent</span> <span class="o">-</span> <span class="n">fps</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Actual: </span><span class="si">{</span><span class="n">f_rot</span><span class="si">:</span><span class="s2">3d</span><span class="si">}</span><span class="s2"> Hz -&gt; Apparent: </span><span class="si">{</span><span class="n">f_apparent</span><span class="si">:</span><span class="s2">+6.1f</span><span class="si">}</span><span class="s2"> Hz &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="s1">&#39;backward&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">f_apparent</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;forward&#39;</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">wagon_wheel_effect</span><span class="p">()</span>
</code></pre></div>

<p>Output:</p>
<div class="highlight"><pre><span></span><code><span class="n">Wagon</span><span class="w"> </span><span class="n">Wheel</span><span class="w"> </span><span class="n">Effect</span><span class="w"> </span><span class="p">(</span><span class="n">Camera</span><span class="o">:</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="n">fps</span><span class="p">)</span>
<span class="o">==================================================</span>
<span class="w">  </span><span class="n">Actual</span><span class="o">:</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Apparent</span><span class="o">:</span><span class="w">   </span><span class="o">+</span><span class="mf">5.0</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="p">(</span><span class="n">forward</span><span class="p">)</span>
<span class="w">  </span><span class="n">Actual</span><span class="o">:</span><span class="w">  </span><span class="mi">12</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Apparent</span><span class="o">:</span><span class="w">  </span><span class="o">+</span><span class="mf">12.0</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="p">(</span><span class="n">forward</span><span class="p">)</span>
<span class="w">  </span><span class="n">Actual</span><span class="o">:</span><span class="w">  </span><span class="mi">23</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Apparent</span><span class="o">:</span><span class="w">   </span><span class="o">-</span><span class="mf">1.0</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="p">(</span><span class="n">backward</span><span class="p">)</span>
<span class="w">  </span><span class="n">Actual</span><span class="o">:</span><span class="w">  </span><span class="mi">25</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Apparent</span><span class="o">:</span><span class="w">   </span><span class="o">+</span><span class="mf">1.0</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="p">(</span><span class="n">forward</span><span class="p">)</span>
<span class="w">  </span><span class="n">Actual</span><span class="o">:</span><span class="w">  </span><span class="mi">47</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Apparent</span><span class="o">:</span><span class="w">   </span><span class="o">-</span><span class="mf">1.0</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="p">(</span><span class="n">backward</span><span class="p">)</span>
<span class="w">  </span><span class="n">Actual</span><span class="o">:</span><span class="w">  </span><span class="mi">48</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Apparent</span><span class="o">:</span><span class="w">   </span><span class="o">+</span><span class="mf">0.0</span><span class="w"> </span><span class="n">Hz</span><span class="w"> </span><span class="p">(</span><span class="n">forward</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5-anti-aliasing-filters">5. Anti-Aliasing Filters<a class="header-link" href="#5-anti-aliasing-filters" title="Permanent link">&para;</a></h2>
<h3 id="51-purpose">5.1 Purpose<a class="header-link" href="#51-purpose" title="Permanent link">&para;</a></h3>
<p>An <strong>anti-aliasing filter</strong> is a lowpass filter applied to the continuous-time signal <em>before</em> sampling. It removes (attenuates) frequency components above $f_s/2$ to prevent aliasing.</p>
<h3 id="52-ideal-vs-practical-anti-aliasing">5.2 Ideal vs. Practical Anti-Aliasing<a class="header-link" href="#52-ideal-vs-practical-anti-aliasing" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Ideal Filter</th>
<th>Practical Filter</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cutoff</td>
<td>Brick-wall at $f_s/2$</td>
<td>Gradual roll-off</td>
</tr>
<tr>
<td>Transition band</td>
<td>Zero width</td>
<td>Finite width</td>
</tr>
<tr>
<td>Stopband attenuation</td>
<td>Infinite</td>
<td>Finite (e.g., -80 dB)</td>
</tr>
<tr>
<td>Causality</td>
<td>Non-causal</td>
<td>Causal</td>
</tr>
<tr>
<td>Implementation</td>
<td>Impossible</td>
<td>Analog circuit</td>
</tr>
</tbody>
</table>
<h3 id="53-practical-considerations">5.3 Practical Considerations<a class="header-link" href="#53-practical-considerations" title="Permanent link">&para;</a></h3>
<p>Since ideal brick-wall filters are unrealizable, practical anti-aliasing involves:</p>
<ol>
<li><strong>Guard band</strong>: Sample somewhat higher than $2B$ to allow for filter roll-off</li>
<li><strong>Filter order</strong>: Higher-order filters have steeper roll-off but more phase distortion</li>
<li><strong>Common choices</strong>: Butterworth (maximally flat), Chebyshev (steeper roll-off), Elliptic (steepest)</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">def</span><span class="w"> </span><span class="nf">design_anti_aliasing_filter</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Design and compare anti-aliasing filters.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency</span>
    <span class="n">f_nyquist</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">f_cutoff</span> <span class="o">=</span> <span class="mi">400</span>  <span class="c1"># Desired signal bandwidth</span>

    <span class="c1"># Normalized cutoff for analog filter design</span>
    <span class="n">Wn</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_cutoff</span>  <span class="c1"># Angular frequency</span>

    <span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
    <span class="n">f_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 10 Hz to ~3 kHz</span>
    <span class="n">w_plot</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_plot</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Butterworth filters of different orders</span>
    <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">w_plot</span><span class="p">)</span>

        <span class="n">mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>
        <span class="n">phase_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">mag_db</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Butterworth order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">phase_deg</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Butterworth order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Mark important frequencies</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_cutoff</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Cutoff = </span><span class="si">{</span><span class="n">f_cutoff</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_nyquist</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nyquist = </span><span class="si">{</span><span class="n">f_nyquist</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Anti-Aliasing Filter: Magnitude Response&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (degrees)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Anti-Aliasing Filter: Phase Response&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;anti_aliasing_filter.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">design_anti_aliasing_filter</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6-reconstruction">6. Reconstruction<a class="header-link" href="#6-reconstruction" title="Permanent link">&para;</a></h2>
<h3 id="61-ideal-reconstruction-sinc-interpolation">6.1 Ideal Reconstruction (Sinc Interpolation)<a class="header-link" href="#61-ideal-reconstruction-sinc-interpolation" title="Permanent link">&para;</a></h3>
<p>The ideal reconstruction uses the Whittaker-Shannon interpolation formula:</p>
<p>$$x_r(t) = \sum_{n=-\infty}^{\infty} x[n] \, \operatorname{sinc}\!\left(\frac{t - nT_s}{T_s}\right)$$</p>
<p>In the frequency domain, this is equivalent to applying an ideal lowpass filter with:
- Gain: $T_s$ in the passband
- Cutoff frequency: $\Omega_s / 2$</p>
<p><strong>Properties of ideal sinc interpolation:</strong>
- Passes through all sample points exactly: $x_r(nT_s) = x[n]$
- Perfect reconstruction if sampling theorem is satisfied
- Non-causal (requires all past and future samples)
- Impractical due to infinite support of sinc function</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sinc_interpolation_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate ideal sinc interpolation for reconstruction.&quot;&quot;&quot;</span>
    <span class="c1"># Original signal</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span>
    <span class="n">t_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">x_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t_true</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t_true</span><span class="p">)</span>

    <span class="c1"># Sample at fs = 20 Hz (Nyquist rate = 14 Hz, so well sampled)</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
    <span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span> <span class="o">+</span> \
                <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>

    <span class="c1"># Sinc interpolation</span>
    <span class="n">t_recon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">x_recon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_recon</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">tn</span><span class="p">,</span> <span class="n">xn</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">)):</span>
        <span class="n">x_recon</span> <span class="o">+=</span> <span class="n">xn</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">t_recon</span> <span class="o">-</span> <span class="n">tn</span><span class="p">)</span> <span class="o">/</span> <span class="n">Ts</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Reconstruction</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_true</span><span class="p">,</span> <span class="n">x_true</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_recon</span><span class="p">,</span> <span class="n">x_recon</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sinc reconstructed&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
                 <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sinc Interpolation (fs = </span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Reconstruction error</span>
    <span class="c1"># Interpolate true signal at same points for comparison</span>
    <span class="n">x_true_at_recon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t_recon</span><span class="p">)</span> <span class="o">+</span> \
                      <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t_recon</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">x_true_at_recon</span> <span class="o">-</span> <span class="n">x_recon</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_recon</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Reconstruction Error (max = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error</span><span class="p">))</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sinc_interpolation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">sinc_interpolation_demo</span><span class="p">()</span>
</code></pre></div>

<h3 id="62-individual-sinc-contributions">6.2 Individual Sinc Contributions<a class="header-link" href="#62-individual-sinc-contributions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_sinc_contributions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show how individual sinc functions combine for reconstruction.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Low rate for visualization</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
    <span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">])</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Individual sinc contributions</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">tn</span><span class="p">,</span> <span class="n">xn</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">)):</span>
        <span class="n">sinc_contrib</span> <span class="o">=</span> <span class="n">xn</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="n">tn</span><span class="p">)</span> <span class="o">/</span> <span class="n">Ts</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">sinc_contrib</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sinc_contrib</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;x[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]=</span><span class="si">{</span><span class="n">xn</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> * sinc&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tn</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Individual Sinc Contributions&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Total reconstruction</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconstructed signal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
                 <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sum of All Sinc Functions&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sinc_contributions.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">visualize_sinc_contributions</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7-zero-order-hold-and-first-order-hold">7. Zero-Order Hold and First-Order Hold<a class="header-link" href="#7-zero-order-hold-and-first-order-hold" title="Permanent link">&para;</a></h2>
<h3 id="71-zero-order-hold-zoh">7.1 Zero-Order Hold (ZOH)<a class="header-link" href="#71-zero-order-hold-zoh" title="Permanent link">&para;</a></h3>
<p>The simplest practical reconstruction: hold each sample value constant until the next sample.</p>
<p>$$x_{\text{ZOH}}(t) = x[n], \quad nT_s \leq t < (n+1)T_s$$</p>
<p>Equivalently, convolution with a rectangular pulse:</p>
<p>$$x_{\text{ZOH}}(t) = \sum_{n} x[n] \, p(t - nT_s)$$</p>
<p>where $p(t) = \begin{cases} 1 & 0 \leq t < T_s \\ 0 & \text{otherwise} \end{cases}$</p>
<p>The frequency response of the ZOH is:</p>
<p>$$H_{\text{ZOH}}(j\Omega) = T_s \, e^{-j\Omega T_s/2} \, \operatorname{sinc}\!\left(\frac{\Omega T_s}{2\pi}\right)$$</p>
<p>This introduces:
- <strong>Amplitude distortion</strong>: sinc envelope attenuates higher frequencies
- <strong>Phase distortion</strong>: half-sample delay ($T_s/2$)</p>
<h3 id="72-first-order-hold-foh">7.2 First-Order Hold (FOH)<a class="header-link" href="#72-first-order-hold-foh" title="Permanent link">&para;</a></h3>
<p>Linear interpolation between consecutive samples:</p>
<p>$$x_{\text{FOH}}(t) = x[n] + \frac{x[n+1] - x[n]}{T_s}(t - nT_s), \quad nT_s \leq t < (n+1)T_s$$</p>
<p>Equivalently, convolution with a triangular pulse:</p>
<p>$$\Lambda(t) = \begin{cases} 1 - |t|/T_s & |t| \leq T_s \\ 0 & \text{otherwise} \end{cases}$$</p>
<p>The FOH provides better high-frequency approximation than ZOH but introduces one full sample delay.</p>
<h3 id="73-comparison-of-reconstruction-methods">7.3 Comparison of Reconstruction Methods<a class="header-link" href="#73-comparison-of-reconstruction-methods" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_reconstruction_methods</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare ZOH, FOH, and sinc reconstruction.&quot;&quot;&quot;</span>
    <span class="c1"># Original signal</span>
    <span class="n">f_sig</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Hz</span>
    <span class="n">t_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">x_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_sig</span> <span class="o">*</span> <span class="n">t_true</span><span class="p">)</span> <span class="o">+</span> \
             <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">t_true</span><span class="p">)</span>

    <span class="c1"># Sample at fs = 20 Hz</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">t_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
    <span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_sig</span> <span class="o">*</span> <span class="n">t_samples</span><span class="p">)</span> <span class="o">+</span> \
                <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">t_samples</span><span class="p">)</span>

    <span class="n">t_recon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

    <span class="c1"># 1. Zero-Order Hold</span>
    <span class="n">x_zoh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_recon</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_samples</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_samples</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_recon</span> <span class="o">&gt;=</span> <span class="n">t_samples</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t_recon</span> <span class="o">&lt;</span> <span class="n">t_samples</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">t_recon</span> <span class="o">&gt;=</span> <span class="n">t_samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">x_zoh</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># 2. First-Order Hold (linear interpolation)</span>
    <span class="n">x_foh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_recon</span><span class="p">,</span> <span class="n">t_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">)</span>

    <span class="c1"># 3. Sinc interpolation</span>
    <span class="n">x_sinc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_recon</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tn</span><span class="p">,</span> <span class="n">xn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">t_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">):</span>
        <span class="n">x_sinc</span> <span class="o">+=</span> <span class="n">xn</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">((</span><span class="n">t_recon</span> <span class="o">-</span> <span class="n">tn</span><span class="p">)</span> <span class="o">/</span> <span class="n">Ts</span><span class="p">)</span>

    <span class="c1"># Plot comparison</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;Zero-Order Hold (ZOH)&#39;</span><span class="p">,</span> <span class="n">x_zoh</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;First-Order Hold (FOH)&#39;</span><span class="p">,</span> <span class="n">x_foh</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Sinc Interpolation (Ideal)&#39;</span><span class="p">,</span> <span class="n">x_sinc</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">x_rec</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">methods</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_true</span><span class="p">,</span> <span class="n">x_true</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_recon</span><span class="p">,</span> <span class="n">x_rec</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t_samples</span><span class="p">,</span> <span class="n">x_samples</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;go&#39;</span><span class="p">,</span>
                <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>

        <span class="c1"># Compute error</span>
        <span class="n">x_true_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_sig</span> <span class="o">*</span> <span class="n">t_recon</span><span class="p">)</span> <span class="o">+</span> \
                        <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">t_recon</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">x_true_interp</span> <span class="o">-</span> <span class="n">x_rec</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">  |  RMSE = </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reconstruction_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">compare_reconstruction_methods</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8-practical-adcdac-considerations">8. Practical ADC/DAC Considerations<a class="header-link" href="#8-practical-adcdac-considerations" title="Permanent link">&para;</a></h2>
<h3 id="81-analog-to-digital-conversion-adc">8.1 Analog-to-Digital Conversion (ADC)<a class="header-link" href="#81-analog-to-digital-conversion-adc" title="Permanent link">&para;</a></h3>
<p>A practical ADC involves three steps:</p>
<ol>
<li><strong>Anti-aliasing filter</strong>: Analog lowpass filter before sampling</li>
<li><strong>Sample-and-hold</strong>: Captures the instantaneous analog value</li>
<li><strong>Quantization</strong>: Maps continuous amplitude to discrete levels</li>
</ol>
<p>Key ADC specifications:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Typical Values</th>
</tr>
</thead>
<tbody>
<tr>
<td>Resolution</td>
<td>Number of bits</td>
<td>8, 12, 16, 24 bits</td>
</tr>
<tr>
<td>Sampling rate</td>
<td>Samples per second</td>
<td>44.1 kHz (audio), 1 MSPS (general)</td>
</tr>
<tr>
<td>SNR</td>
<td>Signal-to-noise ratio</td>
<td>$\approx 6.02N + 1.76$ dB for $N$ bits</td>
</tr>
<tr>
<td>ENOB</td>
<td>Effective number of bits</td>
<td>Accounts for all noise sources</td>
</tr>
<tr>
<td>INL/DNL</td>
<td>Integral/differential nonlinearity</td>
<td>Ideally &lt; 1 LSB</td>
</tr>
</tbody>
</table>
<h3 id="82-quantization">8.2 Quantization<a class="header-link" href="#82-quantization" title="Permanent link">&para;</a></h3>
<p>Quantization maps a continuous amplitude to one of $2^N$ discrete levels for an $N$-bit ADC.</p>
<p><strong>Uniform quantizer:</strong></p>
<p>$$x_q = \Delta \cdot \left\lfloor \frac{x}{\Delta} + 0.5 \right\rfloor$$</p>
<p>where $\Delta = \frac{x_{\max} - x_{\min}}{2^N}$ is the quantization step size (LSB).</p>
<p><strong>Quantization error (noise):</strong></p>
<p>$$e_q = x_q - x, \quad -\frac{\Delta}{2} \leq e_q < \frac{\Delta}{2}$$</p>
<p>For uniformly distributed quantization noise, the <strong>signal-to-quantization-noise ratio (SQNR)</strong>:</p>
<p>$$\text{SQNR} \approx 6.02 N + 1.76 \text{ dB}$$</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_quantization</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate ADC quantization effects.&quot;&quot;&quot;</span>
    <span class="c1"># Original signal</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">f_sig</span> <span class="o">=</span> <span class="mi">440</span>  <span class="c1"># Hz (A4 note)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_sig</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">bit_depths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bit_depths</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">bits</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">bit_depths</span><span class="p">):</span>
        <span class="n">n_levels</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">bits</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">n_levels</span>  <span class="c1"># Range [-1, 1]</span>

        <span class="c1"># Quantize</span>
        <span class="n">x_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta</span>
        <span class="n">x_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x_q</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="c1"># Quantization error</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">x_q</span> <span class="o">-</span> <span class="n">x</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x_q</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bits</span><span class="si">}</span><span class="s1">-bit quantized&#39;</span><span class="p">)</span>

        <span class="n">sqnr</span> <span class="o">=</span> <span class="mf">6.02</span> <span class="o">*</span> <span class="n">bits</span> <span class="o">+</span> <span class="mf">1.76</span>
        <span class="n">actual_sqnr</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">error</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> \
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">error</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bits</span><span class="si">}</span><span class="s1">-bit Quantization (</span><span class="si">{</span><span class="n">n_levels</span><span class="si">}</span><span class="s1"> levels) | &#39;</span>
                     <span class="sa">f</span><span class="s1">&#39;SQNR: theoretical=</span><span class="si">{</span><span class="n">sqnr</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> dB, actual=</span><span class="si">{</span><span class="n">actual_sqnr</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;quantization.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">demonstrate_quantization</span><span class="p">()</span>
</code></pre></div>

<h3 id="83-digital-to-analog-conversion-dac">8.3 Digital-to-Analog Conversion (DAC)<a class="header-link" href="#83-digital-to-analog-conversion-dac" title="Permanent link">&para;</a></h3>
<p>A DAC converts digital samples back to an analog signal:</p>
<ol>
<li><strong>D/A conversion</strong>: Convert digital code to analog voltage/current</li>
<li><strong>Reconstruction filter</strong>: Lowpass filter to smooth the staircase output</li>
</ol>
<p>Most DACs inherently use ZOH, producing a staircase output that requires a post-DAC reconstruction filter to remove the spectral images.</p>
<h3 id="84-compensation-for-zoh-distortion">8.4 Compensation for ZOH Distortion<a class="header-link" href="#84-compensation-for-zoh-distortion" title="Permanent link">&para;</a></h3>
<p>Since ZOH introduces a sinc roll-off, a <strong>sinc compensation filter</strong> (inverse sinc) can be applied digitally before the DAC:</p>
<p>$$H_{\text{comp}}(e^{j\omega}) = \frac{\omega T_s / 2}{\sin(\omega T_s / 2)}$$</p>
<p>This pre-equalizes the digital signal so that after ZOH, the output is flat in the passband.</p>
<hr />
<h2 id="9-oversampling-and-its-benefits">9. Oversampling and Its Benefits<a class="header-link" href="#9-oversampling-and-its-benefits" title="Permanent link">&para;</a></h2>
<h3 id="91-what-is-oversampling">9.1 What Is Oversampling?<a class="header-link" href="#91-what-is-oversampling" title="Permanent link">&para;</a></h3>
<p>Oversampling means sampling at a rate significantly higher than the Nyquist rate:</p>
<p>$$f_s = M \cdot 2B$$</p>
<p>where $M > 1$ is the <strong>oversampling ratio</strong>.</p>
<h3 id="92-benefits-of-oversampling">9.2 Benefits of Oversampling<a class="header-link" href="#92-benefits-of-oversampling" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Relaxed anti-aliasing filter requirements</strong>: Wider transition band allows simpler analog filters</li>
<li><strong>Increased SNR through noise shaping</strong>: Quantization noise is spread over a wider bandwidth, and filtering can remove out-of-band noise</li>
<li><strong>SNR improvement</strong>: Oversampling by factor $M$ gives $10 \log_{10}(M)$ dB improvement (before noise shaping)</li>
<li><strong>Easier reconstruction</strong>: Wider spectral gap simplifies the reconstruction filter</li>
</ol>
<h3 id="93-sigma-delta-latex72-oversampling-adc">9.3 Sigma-Delta ($\Sigma\Delta$) Oversampling ADC<a class="header-link" href="#93-sigma-delta-latex72-oversampling-adc" title="Permanent link">&para;</a></h3>
<p>Modern high-resolution ADCs (audio, instrumentation) use $\Sigma\Delta$ modulation:</p>
<ol>
<li>Oversample at $M \times f_s$ (e.g., $M = 64$ or $128$)</li>
<li>Use a 1-bit quantizer (comparator)</li>
<li>Shape quantization noise to high frequencies (noise shaping)</li>
<li>Digitally filter and decimate to the desired rate</li>
</ol>
<p>Effective resolution: $N_{\text{eff}} \approx N + \frac{(2L+1)}{2} \log_2(M) - \frac{1}{2} \log_2\!\left(\frac{\pi^{2L}}{2L+1}\right)$</p>
<p>where $L$ is the order of the noise shaping loop and $N$ is the quantizer resolution.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_oversampling</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show the benefits of oversampling.&quot;&quot;&quot;</span>
    <span class="c1"># Original signal: 100 Hz sinusoid</span>
    <span class="n">f_sig</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Hz</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mi">200</span>      <span class="c1"># Signal bandwidth</span>

    <span class="c1"># Nyquist rate</span>
    <span class="n">f_nyquist</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">B</span>  <span class="c1"># 400 Hz</span>

    <span class="n">oversampling_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Oversampling Benefits&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal bandwidth B = </span><span class="si">{</span><span class="n">B</span><span class="si">}</span><span class="s2"> Hz, Nyquist rate = </span><span class="si">{</span><span class="n">f_nyquist</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;M&#39;</span><span class="si">:</span><span class="s2">&gt;4s</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;fs (Hz)&#39;</span><span class="si">:</span><span class="s2">&gt;10s</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;SNR gain (dB)&#39;</span><span class="si">:</span><span class="s2">&gt;15s</span><span class="si">}</span><span class="s2"> | &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Transition band&#39;</span><span class="si">:</span><span class="s2">&gt;18s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">oversampling_ratios</span><span class="p">:</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">f_nyquist</span>
        <span class="n">snr_gain</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="k">if</span> <span class="n">M</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">transition</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">B</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">M</span><span class="si">:</span><span class="s2">4d</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">fs</span><span class="si">:</span><span class="s2">10d</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">snr_gain</span><span class="si">:</span><span class="s2">15.2f</span><span class="si">}</span><span class="s2"> | &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transition</span><span class="si">:</span><span class="s2">14.0f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

    <span class="c1"># Visualize filter requirements</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># M = 1: tight filter needed</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">fs1</span> <span class="o">=</span> <span class="mi">400</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span> <span class="o">&lt;=</span> <span class="n">B</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">fs1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nyquist freq = </span><span class="si">{</span><span class="n">fs1</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">fs1</span> <span class="o">-</span> <span class="n">B</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;First alias starts = </span><span class="si">{</span><span class="n">fs1</span><span class="o">-</span><span class="n">B</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>

    <span class="c1"># Anti-aliasing region (narrow!)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">fs1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Transition band = </span><span class="si">{</span><span class="n">fs1</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">B</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;M = 1 (fs = </span><span class="si">{</span><span class="n">fs1</span><span class="si">}</span><span class="s1"> Hz): Narrow transition band&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># M = 4: relaxed filter</span>
    <span class="n">fs4</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">400</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">fs4</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nyquist freq = </span><span class="si">{</span><span class="n">fs4</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>

    <span class="n">f_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
    <span class="n">spec_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f_ext</span> <span class="o">&lt;=</span> <span class="n">B</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">f_ext</span><span class="p">[:</span><span class="mi">800</span><span class="p">],</span> <span class="n">spec_ext</span><span class="p">[:</span><span class="mi">800</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">fs4</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Transition band = </span><span class="si">{</span><span class="n">fs4</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">B</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;M = 4 (fs = </span><span class="si">{</span><span class="n">fs4</span><span class="si">}</span><span class="s1"> Hz): Wide transition band&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;oversampling.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">demonstrate_oversampling</span><span class="p">()</span>
</code></pre></div>

<h3 id="94-decimation-after-oversampling">9.4 Decimation After Oversampling<a class="header-link" href="#94-decimation-after-oversampling" title="Permanent link">&para;</a></h3>
<p>After oversampling and digital filtering, the sample rate can be reduced (decimated) to the desired output rate:</p>
<ol>
<li>Apply a sharp digital lowpass filter (easy to implement precisely)</li>
<li>Downsample by factor $M$ (keep every $M$-th sample)</li>
</ol>
<p>This is the basis of modern $\Sigma\Delta$ ADC architecture.</p>
<hr />
<h2 id="10-multirate-signal-processing-preview">10. Multirate Signal Processing Preview<a class="header-link" href="#10-multirate-signal-processing-preview" title="Permanent link">&para;</a></h2>
<h3 id="101-decimation-downsampling">10.1 Decimation (Downsampling)<a class="header-link" href="#101-decimation-downsampling" title="Permanent link">&para;</a></h3>
<p>Reduce sample rate by factor $M$:</p>
<p>$$y[n] = x[nM]$$</p>
<p>Must apply anti-aliasing filter first to prevent aliasing.</p>
<h3 id="102-interpolation-upsampling">10.2 Interpolation (Upsampling)<a class="header-link" href="#102-interpolation-upsampling" title="Permanent link">&para;</a></h3>
<p>Increase sample rate by factor $L$:</p>
<p>$$w[n] = \begin{cases} x[n/L] & n = 0, \pm L, \pm 2L, \ldots \\ 0 & \text{otherwise} \end{cases}$$</p>
<p>followed by a lowpass (anti-imaging) filter.</p>
<h3 id="103-sample-rate-conversion">10.3 Sample Rate Conversion<a class="header-link" href="#103-sample-rate-conversion" title="Permanent link">&para;</a></h3>
<p>Rational rate change by factor $L/M$:</p>
<p>$$\text{Upsample by } L \;\rightarrow\; \text{Filter} \;\rightarrow\; \text{Downsample by } M$$</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_decimation_interpolation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show basic multirate operations: decimation and interpolation.&quot;&quot;&quot;</span>
    <span class="c1"># Original signal</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">120</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="c1"># Decimation by M=4</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="c1"># Anti-aliasing filter before decimation</span>
    <span class="n">b_dec</span><span class="p">,</span> <span class="n">a_dec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">M</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
    <span class="n">x_filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b_dec</span><span class="p">,</span> <span class="n">a_dec</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">x_dec</span> <span class="o">=</span> <span class="n">x_filtered</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>
    <span class="n">t_dec</span> <span class="o">=</span> <span class="n">t</span><span class="p">[::</span><span class="n">M</span><span class="p">]</span>

    <span class="c1"># Interpolation by L=4</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_dec</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>
    <span class="n">x_up</span><span class="p">[::</span><span class="n">L</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_dec</span>
    <span class="c1"># Anti-imaging filter after upsampling</span>
    <span class="n">b_int</span><span class="p">,</span> <span class="n">a_int</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">L</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
    <span class="n">x_interp</span> <span class="o">=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b_int</span><span class="p">,</span> <span class="n">a_int</span><span class="p">,</span> <span class="n">x_up</span><span class="p">)</span>
    <span class="n">t_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_interp</span><span class="p">))</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Original Signal (fs = </span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1"> samples)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t_dec</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x_dec</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span>
                 <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Decimated by M=</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s1"> (fs = </span><span class="si">{</span><span class="n">fs</span><span class="o">//</span><span class="n">M</span><span class="si">}</span><span class="s1"> Hz, &#39;</span>
                      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x_dec</span><span class="p">)</span><span class="si">}</span><span class="s1"> samples)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_interp</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x_interp</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolated&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x_interp</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x_interp</span><span class="p">)],</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span>
                 <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Interpolated back to fs = </span><span class="si">{</span><span class="n">fs</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;multirate.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">demonstrate_decimation_interpolation</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="11-summary">11. Summary<a class="header-link" href="#11-summary" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
<span class="err">‚îÇ</span><span class="w">                  </span><span class="n">Sampling</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">Reconstruction</span><span class="w">                       </span><span class="err">‚îÇ</span>
<span class="err">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="nl">Sampling</span><span class="p">:</span><span class="w">                                                       </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">nTs</span><span class="p">)</span><span class="w">                                                </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">Spectrum</span><span class="p">:</span><span class="w"> </span><span class="n">Xs</span><span class="p">(</span><span class="n">jŒ©</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Ts</span><span class="p">)</span><span class="w"> </span><span class="n">Œ£</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">j</span><span class="p">(</span><span class="n">Œ©</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kŒ©s</span><span class="p">))</span><span class="w">                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">Nyquist</span><span class="o">-</span><span class="n">Shannon</span><span class="w"> </span><span class="nl">Theorem</span><span class="p">:</span><span class="w">                                        </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">fs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="n">B</span><span class="w">  </span><span class="err">‚Üí</span><span class="w">  </span><span class="n">perfect</span><span class="w"> </span><span class="n">reconstruction</span><span class="w"> </span><span class="n">possible</span><span class="w">                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">fs</span><span class="w"> </span><span class="err">‚â§</span><span class="w"> </span><span class="mi">2</span><span class="n">B</span><span class="w">  </span><span class="err">‚Üí</span><span class="w">  </span><span class="n">aliasing</span><span class="w"> </span><span class="p">(</span><span class="n">irreversible</span><span class="w"> </span><span class="n">distortion</span><span class="p">)</span><span class="w">               </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">Anti</span><span class="o">-</span><span class="nl">Aliasing</span><span class="p">:</span><span class="w">                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">Analog</span><span class="w"> </span><span class="n">LPF</span><span class="w"> </span><span class="k">before</span><span class="w"> </span><span class="n">sampling</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="w">                </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">Practical</span><span class="p">:</span><span class="w"> </span><span class="n">guard</span><span class="w"> </span><span class="n">band</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">filter</span><span class="w"> </span><span class="n">roll</span><span class="o">-</span><span class="k">off</span><span class="w">                      </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">Reconstruction</span><span class="w"> </span><span class="nl">Methods</span><span class="p">:</span><span class="w">                                         </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">Ideal</span><span class="p">:</span><span class="w"> </span><span class="n">sinc</span><span class="w"> </span><span class="n">interpolation</span><span class="w"> </span><span class="p">(</span><span class="n">impractical</span><span class="p">)</span><span class="w">                      </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">ZOH</span><span class="p">:</span><span class="w">   </span><span class="n">staircase</span><span class="p">,</span><span class="w"> </span><span class="n">sinc</span><span class="w"> </span><span class="n">distortion</span><span class="w"> </span><span class="p">(</span><span class="n">simple</span><span class="p">)</span><span class="w">                   </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">FOH</span><span class="p">:</span><span class="w">   </span><span class="n">linear</span><span class="w"> </span><span class="n">interpolation</span><span class="w"> </span><span class="p">(</span><span class="n">better</span><span class="p">)</span><span class="w">                         </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">Post</span><span class="o">-</span><span class="k">filter</span><span class="err">:</span><span class="w"> </span><span class="n">smooth</span><span class="w"> </span><span class="n">staircase</span><span class="w"> </span><span class="k">output</span><span class="w">                         </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">Oversampling</span><span class="w"> </span><span class="p">(</span><span class="n">fs</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="n">B</span><span class="p">)</span><span class="err">:</span><span class="w">                                        </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Relaxes</span><span class="w"> </span><span class="n">anti</span><span class="o">-</span><span class="n">aliasing</span><span class="w"> </span><span class="k">filter</span><span class="w"> </span><span class="n">requirements</span><span class="w">                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">SNR</span><span class="w"> </span><span class="nl">gain</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nf">log10</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="n">dB</span><span class="w">                                   </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Enables</span><span class="w"> </span><span class="n">Sigma</span><span class="o">-</span><span class="n">Delta</span><span class="w"> </span><span class="n">ADC</span><span class="w"> </span><span class="n">architecture</span><span class="w">                       </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">Practical</span><span class="w"> </span><span class="n">ADC</span><span class="o">/</span><span class="nl">DAC</span><span class="p">:</span><span class="w">                                              </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">ADC</span><span class="p">:</span><span class="w"> </span><span class="n">anti</span><span class="o">-</span><span class="k">alias</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">sample</span><span class="o">-</span><span class="k">hold</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">quantize</span><span class="w">                     </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">DAC</span><span class="p">:</span><span class="w"> </span><span class="n">D</span><span class="o">/</span><span class="n">A</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">ZOH</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">reconstruction</span><span class="w"> </span><span class="k">filter</span><span class="w">                      </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">SQNR</span><span class="w"> </span><span class="err">‚âà</span><span class="w"> </span><span class="mf">6.02</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.76</span><span class="w"> </span><span class="n">dB</span><span class="w">                                      </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</code></pre></div>

<hr />
<h2 id="12-exercises">12. Exercises<a class="header-link" href="#12-exercises" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-sampling-rate-determination">Exercise 1: Sampling Rate Determination<a class="header-link" href="#exercise-1-sampling-rate-determination" title="Permanent link">&para;</a></h3>
<p>A signal contains components at 100 Hz, 250 Hz, and 500 Hz.</p>
<p><strong>(a)</strong> What is the minimum sampling rate to avoid aliasing?</p>
<p><strong>(b)</strong> If the signal is sampled at 800 Hz, which components will alias, and to what frequencies?</p>
<p><strong>(c)</strong> What sampling rate would you recommend in practice, and why?</p>
<h3 id="exercise-2-aliasing-analysis">Exercise 2: Aliasing Analysis<a class="header-link" href="#exercise-2-aliasing-analysis" title="Permanent link">&para;</a></h3>
<p>A 1 kHz sinusoidal signal is sampled at 1.5 kHz.</p>
<p><strong>(a)</strong> At what frequency does the alias appear?</p>
<p><strong>(b)</strong> Write Python code to demonstrate this aliasing visually with a plot showing both the original and aliased signals.</p>
<p><strong>(c)</strong> Design an anti-aliasing filter (specify type, order, and cutoff) that would prevent this problem if the desired bandwidth is 600 Hz.</p>
<h3 id="exercise-3-sinc-interpolation-implementation">Exercise 3: Sinc Interpolation Implementation<a class="header-link" href="#exercise-3-sinc-interpolation-implementation" title="Permanent link">&para;</a></h3>
<p>Implement a complete sinc interpolation function:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sinc_reconstruct</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="n">t_recon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reconstruct a continuous-time signal from samples using sinc interpolation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        samples: array of sample values x[n]</span>
<span class="sd">        Ts: sampling period</span>
<span class="sd">        t_recon: array of time points for reconstruction</span>

<span class="sd">    Returns:</span>
<span class="sd">        x_recon: reconstructed signal values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Your implementation here</span>
    <span class="k">pass</span>
</code></pre></div>

<p><strong>(a)</strong> Test your function with a known bandlimited signal and verify perfect reconstruction.</p>
<p><strong>(b)</strong> Measure the reconstruction error as a function of the number of sinc terms used (truncation).</p>
<p><strong>(c)</strong> Compare computation time vs. accuracy for different truncation lengths.</p>
<h3 id="exercise-4-quantization-noise-analysis">Exercise 4: Quantization Noise Analysis<a class="header-link" href="#exercise-4-quantization-noise-analysis" title="Permanent link">&para;</a></h3>
<p><strong>(a)</strong> Derive the SQNR formula $\text{SQNR} = 6.02N + 1.76$ dB for a uniform quantizer with $N$ bits and a full-scale sinusoidal input.</p>
<p><strong>(b)</strong> Write Python code to verify this formula empirically for $N = 4, 8, 12, 16$ bits.</p>
<p><strong>(c)</strong> How does the SQNR change if the signal only uses half the quantizer range?</p>
<h3 id="exercise-5-zoh-frequency-response">Exercise 5: ZOH Frequency Response<a class="header-link" href="#exercise-5-zoh-frequency-response" title="Permanent link">&para;</a></h3>
<p><strong>(a)</strong> Plot the magnitude and phase response of the ZOH reconstruction for $f_s = 8000$ Hz.</p>
<p><strong>(b)</strong> Calculate the attenuation at $f = 3000$ Hz due to the sinc roll-off.</p>
<p><strong>(c)</strong> Design a digital sinc compensation filter (provide FIR coefficients for 31 taps) and show that it corrects the passband droop.</p>
<h3 id="exercise-6-oversampling-vs-bit-depth-trade-off">Exercise 6: Oversampling vs. Bit Depth Trade-off<a class="header-link" href="#exercise-6-oversampling-vs-bit-depth-trade-off" title="Permanent link">&para;</a></h3>
<p>An audio application requires an effective resolution of 16 bits (SQNR $\approx$ 98 dB).</p>
<p><strong>(a)</strong> If using a 12-bit ADC with oversampling (no noise shaping), what oversampling ratio $M$ is needed?</p>
<p><strong>(b)</strong> With first-order noise shaping ($\Sigma\Delta$), what oversampling ratio suffices?</p>
<p><strong>(c)</strong> Write Python code to simulate a first-order $\Sigma\Delta$ modulator and verify the noise shaping behavior by plotting the output spectrum.</p>
<h3 id="exercise-7-complete-adcdac-pipeline">Exercise 7: Complete ADC/DAC Pipeline<a class="header-link" href="#exercise-7-complete-adcdac-pipeline" title="Permanent link">&para;</a></h3>
<p>Build a complete sampling-reconstruction pipeline in Python:</p>
<ol>
<li>Generate a test signal (sum of sinusoids)</li>
<li>Apply an anti-aliasing filter</li>
<li>Sample at a specified rate</li>
<li>Quantize to $N$ bits</li>
<li>Reconstruct using (a) ZOH, (b) linear interpolation, (c) sinc interpolation</li>
<li>Apply a reconstruction lowpass filter</li>
<li>Compare all three methods: RMSE, SNR, visual quality</li>
</ol>
<hr />
<h2 id="13-further-reading">13. Further Reading<a class="header-link" href="#13-further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li>Oppenheim, Willsky, Nawab. <em>Signals and Systems</em>, 2nd ed. Chapter 7.</li>
<li>Oppenheim, Schafer. <em>Discrete-Time Signal Processing</em>, 3rd ed. Chapters 4-5.</li>
<li>Proakis, Manolakis. <em>Digital Signal Processing</em>, 4th ed. Chapter 6.</li>
<li>Lyons, R. G. <em>Understanding Digital Signal Processing</em>, 3rd ed. Chapters 2-3.</li>
<li>Smith, S. W. <em>The Scientist and Engineer's Guide to Digital Signal Processing</em>, Chapters 3-4. (Free online: dspguide.com)</li>
</ul>
<hr />
<p><strong>Previous</strong>: <a href="04_Fourier_Transform.md">04. Fourier Transform and Frequency Domain</a> | <strong>Next</strong>: <a href="06_Discrete_Fourier_Transform.md">06. Discrete Fourier Transform</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/04_Continuous_Fourier_Transform.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Continuous Fourier Transform</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/06_Discrete_Fourier_Transform.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Discrete Fourier Transform</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}