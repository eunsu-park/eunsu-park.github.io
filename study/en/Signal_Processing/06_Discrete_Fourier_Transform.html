{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discrete Fourier Transform - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">üíª</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        ÌïúÍµ≠Ïñ¥
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">‚òÄÔ∏è</span>
                    <span class="theme-icon dark">üåô</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">Discrete Fourier Transform</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Discrete Fourier Transform</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/05_Sampling_and_Reconstruction.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Sampling and Reconstruction</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/07_Z_Transform.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Z-Transform</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#1-from-dtft-to-dft">1. From DTFT to DFT</a><ul>
<li><a href="#11-discrete-time-fourier-transform-dtft-review">1.1 Discrete-Time Fourier Transform (DTFT) Review</a></li>
<li><a href="#12-the-problem-dtft-is-continuous">1.2 The Problem: DTFT is Continuous</a></li>
<li><a href="#13-dft-as-sampling-of-the-dtft">1.3 DFT as Sampling of the DTFT</a></li>
</ul>
</li>
<li><a href="#2-dft-definition-and-inverse-dft">2. DFT Definition and Inverse DFT</a><ul>
<li><a href="#21-forward-dft">2.1 Forward DFT</a></li>
<li><a href="#22-inverse-dft-idft">2.2 Inverse DFT (IDFT)</a></li>
<li><a href="#23-matrix-form">2.3 Matrix Form</a></li>
<li><a href="#24-physical-interpretation-of-dft-bins">2.4 Physical Interpretation of DFT Bins</a></li>
</ul>
</li>
<li><a href="#3-dft-properties">3. DFT Properties</a><ul>
<li><a href="#31-linearity">3.1 Linearity</a></li>
<li><a href="#32-circular-cyclic-shift">3.2 Circular (Cyclic) Shift</a></li>
<li><a href="#33-circular-convolution">3.3 Circular Convolution</a></li>
<li><a href="#34-parsevals-theorem-energy-conservation">3.4 Parseval's Theorem (Energy Conservation)</a></li>
<li><a href="#35-summary-of-dft-properties">3.5 Summary of DFT Properties</a></li>
</ul>
</li>
<li><a href="#4-zero-padding-and-frequency-resolution">4. Zero-Padding and Frequency Resolution</a><ul>
<li><a href="#41-frequency-resolution">4.1 Frequency Resolution</a></li>
<li><a href="#42-zero-padding-demonstration">4.2 Zero-Padding Demonstration</a></li>
<li><a href="#43-true-resolution-vs-zero-padding">4.3 True Resolution vs. Zero-Padding</a></li>
</ul>
</li>
<li><a href="#5-spectral-leakage-and-windowing">5. Spectral Leakage and Windowing</a><ul>
<li><a href="#51-the-leakage-problem">5.1 The Leakage Problem</a></li>
<li><a href="#52-window-functions">5.2 Window Functions</a></li>
<li><a href="#53-window-comparison">5.3 Window Comparison</a></li>
<li><a href="#54-spectral-leakage-in-action">5.4 Spectral Leakage in Action</a></li>
</ul>
</li>
<li><a href="#6-fast-fourier-transform-fft">6. Fast Fourier Transform (FFT)</a><ul>
<li><a href="#61-the-computational-problem">6.1 The Computational Problem</a></li>
<li><a href="#62-the-cooley-tukey-algorithm">6.2 The Cooley-Tukey Algorithm</a></li>
<li><a href="#63-butterfly-diagram">6.3 Butterfly Diagram</a></li>
<li><a href="#64-radix-2-dit-implementation">6.4 Radix-2 DIT Implementation</a></li>
<li><a href="#65-radix-2-decimation-in-frequency-dif">6.5 Radix-2 Decimation-in-Frequency (DIF)</a></li>
<li><a href="#66-fft-complexity-comparison">6.6 FFT Complexity Comparison</a></li>
</ul>
</li>
<li><a href="#7-practical-fft-usage">7. Practical FFT Usage</a><ul>
<li><a href="#71-using-numpyfft">7.1 Using numpy.fft</a></li>
<li><a href="#72-important-fft-functions-in-numpy">7.2 Important FFT Functions in NumPy</a></li>
<li><a href="#73-common-pitfalls">7.3 Common Pitfalls</a></li>
</ul>
</li>
<li><a href="#8-spectral-analysis-applications">8. Spectral Analysis Applications</a><ul>
<li><a href="#81-analyzing-a-musical-chord">8.1 Analyzing a Musical Chord</a></li>
<li><a href="#82-short-time-fourier-transform-stft-spectrogram">8.2 Short-Time Fourier Transform (STFT) / Spectrogram</a></li>
<li><a href="#83-fft-based-filtering-overlap-add-method">8.3 FFT-Based Filtering (Overlap-Add Method)</a></li>
</ul>
</li>
<li><a href="#9-two-dimensional-dft">9. Two-Dimensional DFT</a><ul>
<li><a href="#91-definition">9.1 Definition</a></li>
</ul>
</li>
<li><a href="#10-summary">10. Summary</a></li>
<li><a href="#11-exercises">11. Exercises</a><ul>
<li><a href="#exercise-1-dft-by-hand">Exercise 1: DFT by Hand</a></li>
<li><a href="#exercise-2-circular-convolution">Exercise 2: Circular Convolution</a></li>
<li><a href="#exercise-3-frequency-resolution-challenge">Exercise 3: Frequency Resolution Challenge</a></li>
<li><a href="#exercise-4-implement-the-cooley-tukey-fft">Exercise 4: Implement the Cooley-Tukey FFT</a></li>
<li><a href="#exercise-5-spectral-analysis-of-real-audio">Exercise 5: Spectral Analysis of Real Audio</a></li>
<li><a href="#exercise-6-windowing-experiment">Exercise 6: Windowing Experiment</a></li>
<li><a href="#exercise-7-2d-fft-application">Exercise 7: 2D FFT Application</a></li>
</ul>
</li>
<li><a href="#12-further-reading">12. Further Reading</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="discrete-fourier-transform">Discrete Fourier Transform<a class="header-link" href="#discrete-fourier-transform" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>The Discrete Fourier Transform (DFT) is the computational workhorse of digital signal processing. It converts a finite-length sequence of samples into a finite-length sequence of frequency components. Coupled with the Fast Fourier Transform (FFT) algorithm, the DFT enables efficient spectral analysis, filtering, correlation, and countless other applications. This lesson covers DFT theory, properties, the FFT algorithm, and practical usage.</p>
<p><strong>Learning Objectives:</strong>
- Understand the relationship between DTFT, DFT, and FFT
- Apply DFT properties including circular convolution and Parseval's theorem
- Explain spectral leakage and windowing strategies
- Implement and use FFT for spectral analysis of real-world signals
- Understand the Cooley-Tukey algorithm and its computational advantages</p>
<p><strong>Prerequisites:</strong> <a href="05_Sampling_and_Reconstruction.md">05. Sampling and Reconstruction</a></p>
<hr />
<h2 id="1-from-dtft-to-dft">1. From DTFT to DFT<a class="header-link" href="#1-from-dtft-to-dft" title="Permanent link">&para;</a></h2>
<h3 id="11-discrete-time-fourier-transform-dtft-review">1.1 Discrete-Time Fourier Transform (DTFT) Review<a class="header-link" href="#11-discrete-time-fourier-transform-dtft-review" title="Permanent link">&para;</a></h3>
<p>For a discrete-time signal $x[n]$, the DTFT is:</p>
<p>$$X(e^{j\omega}) = \sum_{n=-\infty}^{\infty} x[n] \, e^{-j\omega n}$$</p>
<p>Key properties of the DTFT:
- <strong>Input</strong>: infinite-length discrete sequence
- <strong>Output</strong>: continuous, periodic function of $\omega$ (period $2\pi$)
- <strong>Existence</strong>: requires absolute summability or finite energy
- <strong>Inverse</strong>: $x[n] = \frac{1}{2\pi} \int_{-\pi}^{\pi} X(e^{j\omega}) \, e^{j\omega n} \, d\omega$</p>
<h3 id="12-the-problem-dtft-is-continuous">1.2 The Problem: DTFT is Continuous<a class="header-link" href="#12-the-problem-dtft-is-continuous" title="Permanent link">&para;</a></h3>
<p>Computers cannot store or compute with continuous functions. We need a <strong>discrete</strong> frequency representation. The DFT solves this by sampling the DTFT at $N$ equally spaced frequencies.</p>
<h3 id="13-dft-as-sampling-of-the-dtft">1.3 DFT as Sampling of the DTFT<a class="header-link" href="#13-dft-as-sampling-of-the-dtft" title="Permanent link">&para;</a></h3>
<p>For a finite-length signal $x[n]$ of length $N$, the DFT samples the DTFT at:</p>
<p>$$\omega_k = \frac{2\pi k}{N}, \quad k = 0, 1, \ldots, N-1$$</p>
<p>$$X[k] = X(e^{j\omega})\bigg|_{\omega = 2\pi k/N} = \sum_{n=0}^{N-1} x[n] \, e^{-j2\pi kn/N}$$</p>
<p>This means:
- The DFT provides $N$ frequency samples of the DTFT
- Each DFT bin $k$ corresponds to frequency $f_k = k \cdot f_s / N$
- The frequency resolution is $\Delta f = f_s / N$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dtft_vs_dft</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare DTFT (dense sampling) with DFT (N-point sampling).&quot;&quot;&quot;</span>
    <span class="c1"># Signal: finite-length sequence</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Rectangular pulse</span>

    <span class="c1"># &quot;DTFT&quot; (computed at many points)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
    <span class="n">X_dtft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">omega</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">X_dtft</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># DFT (N points)</span>
    <span class="n">X_dft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">omega_dft</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Magnitude</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_dtft</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;|DTFT| (continuous)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">omega_dft</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_dft</span><span class="p">),</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span>
                 <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;|DFT| (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1"> points)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Frequency ($\omega/\pi$)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;DTFT vs DFT: Magnitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Phase</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">X_dtft</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Phase of DTFT&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">omega_dft</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">X_dft</span><span class="p">),</span> <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span>
                 <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Phase of DFT&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Frequency ($\omega/\pi$)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (radians)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;DTFT vs DFT: Phase&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dtft_vs_dft.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">dtft_vs_dft</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="2-dft-definition-and-inverse-dft">2. DFT Definition and Inverse DFT<a class="header-link" href="#2-dft-definition-and-inverse-dft" title="Permanent link">&para;</a></h2>
<h3 id="21-forward-dft">2.1 Forward DFT<a class="header-link" href="#21-forward-dft" title="Permanent link">&para;</a></h3>
<p>The $N$-point DFT of a sequence $x[n]$, $n = 0, 1, \ldots, N-1$:</p>
<p>$$\boxed{X[k] = \sum_{n=0}^{N-1} x[n] \, W_N^{kn}, \quad k = 0, 1, \ldots, N-1}$$</p>
<p>where $W_N = e^{-j2\pi/N}$ is the <strong>twiddle factor</strong> (the $N$-th root of unity).</p>
<h3 id="22-inverse-dft-idft">2.2 Inverse DFT (IDFT)<a class="header-link" href="#22-inverse-dft-idft" title="Permanent link">&para;</a></h3>
<p>$$\boxed{x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] \, W_N^{-kn}, \quad n = 0, 1, \ldots, N-1}$$</p>
<h3 id="23-matrix-form">2.3 Matrix Form<a class="header-link" href="#23-matrix-form" title="Permanent link">&para;</a></h3>
<p>The DFT can be written as a matrix-vector product:</p>
<p>$$\mathbf{X} = \mathbf{W}_N \mathbf{x}$$</p>
<p>where the DFT matrix is:</p>
<p>$$[\mathbf{W}_N]_{k,n} = W_N^{kn} = e^{-j2\pi kn/N}$$</p>
<p>For $N = 4$:</p>
<p>$$\mathbf{W}_4 = \begin{bmatrix} 1 & 1 & 1 & 1 \\ 1 & -j & -1 & j \\ 1 & -1 & 1 & -1 \\ 1 & j & -1 & -j \end{bmatrix}$$</p>
<p>The DFT matrix is <strong>unitary</strong> (up to scaling): $\mathbf{W}_N^{-1} = \frac{1}{N}\mathbf{W}_N^*$.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dft_matrix_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the DFT as a matrix operation.&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="c1"># Build DFT matrix</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># Test signal</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="c1"># DFT via matrix multiplication</span>
    <span class="n">X_matrix</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">x</span>

    <span class="c1"># DFT via numpy.fft</span>
    <span class="n">X_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Verify they match</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DFT Matrix Computation&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x = </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">X (matrix) = </span><span class="si">{</span><span class="n">X_matrix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X (FFT)    = </span><span class="si">{</span><span class="n">X_fft</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Max difference: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_matrix</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X_fft</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Verify unitarity</span>
    <span class="n">W_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">x_recovered</span> <span class="o">=</span> <span class="n">W_inv</span> <span class="o">@</span> <span class="n">X_matrix</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Recovered x: </span><span class="si">{</span><span class="n">x_recovered</span><span class="o">.</span><span class="n">real</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recovery error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x_recovered</span><span class="o">.</span><span class="n">real</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Visualize the DFT matrix</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">im0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Re(W_</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n (time index)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;k (frequency index)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">im1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Im(W_</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n (time index)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;k (frequency index)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dft_matrix.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">dft_matrix_demo</span><span class="p">()</span>
</code></pre></div>

<h3 id="24-physical-interpretation-of-dft-bins">2.4 Physical Interpretation of DFT Bins<a class="header-link" href="#24-physical-interpretation-of-dft-bins" title="Permanent link">&para;</a></h3>
<p>For a signal sampled at rate $f_s$, the $k$-th DFT bin corresponds to:</p>
<table>
<thead>
<tr>
<th>Quantity</th>
<th>Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td>Frequency (Hz)</td>
<td>$f_k = k \cdot f_s / N$</td>
</tr>
<tr>
<td>Angular frequency</td>
<td>$\omega_k = 2\pi k / N$</td>
</tr>
<tr>
<td>Frequency resolution</td>
<td>$\Delta f = f_s / N$</td>
</tr>
<tr>
<td>Highest frequency (bin $N/2$)</td>
<td>$f_s / 2$ (Nyquist)</td>
</tr>
</tbody>
</table>
<p>For real signals, $X[k]$ and $X[N-k]$ are complex conjugates, so bins $k > N/2$ represent negative frequencies. The magnitude spectrum is symmetric about $N/2$.</p>
<hr />
<h2 id="3-dft-properties">3. DFT Properties<a class="header-link" href="#3-dft-properties" title="Permanent link">&para;</a></h2>
<h3 id="31-linearity">3.1 Linearity<a class="header-link" href="#31-linearity" title="Permanent link">&para;</a></h3>
<p>$$\text{DFT}\{a \cdot x_1[n] + b \cdot x_2[n]\} = a \cdot X_1[k] + b \cdot X_2[k]$$</p>
<h3 id="32-circular-cyclic-shift">3.2 Circular (Cyclic) Shift<a class="header-link" href="#32-circular-cyclic-shift" title="Permanent link">&para;</a></h3>
<p>A circular shift by $m$ in time corresponds to a phase rotation in frequency:</p>
<p>$$x[(n-m) \bmod N] \quad \xleftrightarrow{\text{DFT}} \quad X[k] \cdot W_N^{mk} = X[k] \cdot e^{-j2\pi mk/N}$$</p>
<blockquote>
<p>Note: This is a <strong>circular</strong> shift, not a linear shift. The signal wraps around modulo $N$.</p>
</blockquote>
<h3 id="33-circular-convolution">3.3 Circular Convolution<a class="header-link" href="#33-circular-convolution" title="Permanent link">&para;</a></h3>
<p>Linear convolution and circular convolution are fundamentally different.</p>
<p><strong>Circular convolution</strong> of two $N$-point sequences:</p>
<p>$$(x_1 \circledast x_2)[n] = \sum_{m=0}^{N-1} x_1[m] \, x_2[(n-m) \bmod N]$$</p>
<p>The DFT multiplication property:</p>
<p>$$\boxed{x_1[n] \circledast x_2[n] \quad \xleftrightarrow{\text{DFT}} \quad X_1[k] \cdot X_2[k]}$$</p>
<p>To compute <strong>linear</strong> convolution using circular convolution (needed for overlap-add, filtering):
- Zero-pad both sequences to length $\geq N_1 + N_2 - 1$
- Compute circular convolution of the zero-padded sequences
- The result equals the linear convolution</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">circular_vs_linear_convolution</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate circular vs. linear convolution.&quot;&quot;&quot;</span>
    <span class="c1"># Two short sequences</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>

    <span class="c1"># Linear convolution (length N1+N2-1 = 6)</span>
    <span class="n">y_linear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>

    <span class="c1"># Circular convolution (length = max(N1, N2) = 4)</span>
    <span class="n">N_circ</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="p">)</span>
    <span class="n">x2_padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_circ</span><span class="p">)</span>
    <span class="n">x2_padded</span><span class="p">[:</span><span class="n">N2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x2</span>
    <span class="n">X1_circ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">N_circ</span><span class="p">)</span>
    <span class="n">X2_circ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x2_padded</span><span class="p">,</span> <span class="n">N_circ</span><span class="p">)</span>
    <span class="n">y_circular</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X1_circ</span> <span class="o">*</span> <span class="n">X2_circ</span><span class="p">))</span>

    <span class="c1"># Linear convolution via DFT (zero-pad to N1+N2-1)</span>
    <span class="n">N_linear</span> <span class="o">=</span> <span class="n">N1</span> <span class="o">+</span> <span class="n">N2</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">X1_lin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">N_linear</span><span class="p">)</span>
    <span class="n">X2_lin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">N_linear</span><span class="p">)</span>
    <span class="n">y_fft_linear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X1_lin</span> <span class="o">*</span> <span class="n">X2_lin</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circular vs. Linear Convolution&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x1 = </span><span class="si">{</span><span class="n">x1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x2 = </span><span class="si">{</span><span class="n">x2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Linear convolution (np.convolve): </span><span class="si">{</span><span class="n">y_linear</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Circular convolution (N=</span><span class="si">{</span><span class="n">N_circ</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">y_circular</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear conv via FFT (N=</span><span class="si">{</span><span class="n">N_linear</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_fft_linear</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Circular != Linear (aliasing in circular)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FFT linear matches np.convolve: &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y_linear</span><span class="p">,</span><span class="w"> </span><span class="n">y_fft_linear</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">circular_vs_linear_convolution</span><span class="p">()</span>
</code></pre></div>

<p>Output:</p>
<div class="highlight"><pre><span></span><code>Circular vs. Linear Convolution
============================================================
x1 = [1 2 3 4]
x2 = [1 0 -1]

Linear convolution (np.convolve): [ 1  2  2  2 -3 -4]
Circular convolution (N=4): [-3.  2.  2.  2.]
Linear conv via FFT (N=6): [ 1.  2.  2.  2. -3. -4.]

Circular != Linear (aliasing in circular)
FFT linear matches np.convolve: True
</code></pre></div>

<h3 id="34-parsevals-theorem-energy-conservation">3.4 Parseval's Theorem (Energy Conservation)<a class="header-link" href="#34-parsevals-theorem-energy-conservation" title="Permanent link">&para;</a></h3>
<p>$$\boxed{\sum_{n=0}^{N-1} |x[n]|^2 = \frac{1}{N} \sum_{k=0}^{N-1} |X[k]|^2}$$</p>
<p>The total energy is preserved between time and frequency domains (up to the $1/N$ factor).</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">verify_parseval</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify Parseval&#39;s theorem numerically.&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">energy_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">energy_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parseval&#39;s Theorem Verification&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time domain energy:  </span><span class="si">{</span><span class="n">energy_time</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Freq domain energy:  </span><span class="si">{</span><span class="n">energy_freq</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference:          </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">energy_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">energy_freq</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">verify_parseval</span><span class="p">()</span>
</code></pre></div>

<h3 id="35-summary-of-dft-properties">3.5 Summary of DFT Properties<a class="header-link" href="#35-summary-of-dft-properties" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Time Domain</th>
<th>Frequency Domain</th>
</tr>
</thead>
<tbody>
<tr>
<td>Linearity</td>
<td>$ax_1[n] + bx_2[n]$</td>
<td>$aX_1[k] + bX_2[k]$</td>
</tr>
<tr>
<td>Circular shift</td>
<td>$x[(n-m) \bmod N]$</td>
<td>$W_N^{mk} X[k]$</td>
</tr>
<tr>
<td>Modulation</td>
<td>$W_N^{-ln} x[n]$</td>
<td>$X[(k-l) \bmod N]$</td>
</tr>
<tr>
<td>Circular convolution</td>
<td>$x_1 \circledast x_2$</td>
<td>$X_1[k] \cdot X_2[k]$</td>
</tr>
<tr>
<td>Multiplication</td>
<td>$x_1[n] \cdot x_2[n]$</td>
<td>$\frac{1}{N} X_1 \circledast X_2$</td>
</tr>
<tr>
<td>Conjugation</td>
<td>$x^*[n]$</td>
<td>$X^*[(-k) \bmod N]$</td>
</tr>
<tr>
<td>Time reversal</td>
<td>$x[(-n) \bmod N]$</td>
<td>$X[(-k) \bmod N]$</td>
</tr>
<tr>
<td>Parseval's</td>
<td>$\sum |x[n]|^2$</td>
<td>$\frac{1}{N}\sum |X[k]|^2$</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-zero-padding-and-frequency-resolution">4. Zero-Padding and Frequency Resolution<a class="header-link" href="#4-zero-padding-and-frequency-resolution" title="Permanent link">&para;</a></h2>
<h3 id="41-frequency-resolution">4.1 Frequency Resolution<a class="header-link" href="#41-frequency-resolution" title="Permanent link">&para;</a></h3>
<p>The DFT provides $N$ frequency samples spaced $\Delta f = f_s / N$ apart. To increase the density of frequency samples (interpolate the DTFT), we can <strong>zero-pad</strong> the signal.</p>
<blockquote>
<p><strong>Important:</strong> Zero-padding increases the number of DFT points (finer frequency grid) but does <strong>not</strong> increase the true spectral resolution. True resolution is determined by the signal duration $T = N \cdot T_s$.</p>
</blockquote>
<h3 id="42-zero-padding-demonstration">4.2 Zero-Padding Demonstration<a class="header-link" href="#42-zero-padding-demonstration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">zero_padding_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the effect of zero-padding on frequency resolution.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Hz</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span>   <span class="c1"># 0.5 seconds of data</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>  <span class="c1"># 50 samples</span>

    <span class="c1"># Two closely-spaced sinusoids</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span>  <span class="c1"># Hz (2 Hz apart)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span>

    <span class="c1"># DFT with different amounts of zero-padding</span>
    <span class="n">nfft_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">N</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nfft_values</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">nfft</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">nfft_values</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">nfft</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

        <span class="c1"># Plot only positive frequencies</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">freqs</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="o">/</span> <span class="n">N</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span>
                <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;f1=</span><span class="si">{</span><span class="n">f1</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;f2=</span><span class="si">{</span><span class="n">f2</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">nfft</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;NFFT = </span><span class="si">{</span><span class="n">nfft</span><span class="si">}</span><span class="s1"> (zero-padded from </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">) | &#39;</span>
                     <span class="sa">f</span><span class="s1">&#39;Frequency spacing = </span><span class="si">{</span><span class="n">delta_f</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;zero_padding.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">zero_padding_demo</span><span class="p">()</span>
</code></pre></div>

<h3 id="43-true-resolution-vs-zero-padding">4.3 True Resolution vs. Zero-Padding<a class="header-link" href="#43-true-resolution-vs-zero-padding" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Determined by</th>
<th>Effect of zero-padding</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Frequency resolution</strong> ($\Delta f$)</td>
<td>Signal duration $T$</td>
<td>No change</td>
</tr>
<tr>
<td><strong>DFT bin spacing</strong></td>
<td>NFFT = $N$ + zero-padding</td>
<td>Decreases (finer grid)</td>
</tr>
<tr>
<td><strong>Ability to resolve two tones</strong></td>
<td>$\Delta f \approx 1/T$</td>
<td>Does not improve</td>
</tr>
<tr>
<td><strong>Visual appearance</strong></td>
<td>Both</td>
<td>Smoother spectrum</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5-spectral-leakage-and-windowing">5. Spectral Leakage and Windowing<a class="header-link" href="#5-spectral-leakage-and-windowing" title="Permanent link">&para;</a></h2>
<h3 id="51-the-leakage-problem">5.1 The Leakage Problem<a class="header-link" href="#51-the-leakage-problem" title="Permanent link">&para;</a></h3>
<p>When we compute the DFT of a finite-length signal, we implicitly assume the signal is periodic with period $N$. If the signal frequency does not fall exactly on a DFT bin, the energy "leaks" into adjacent bins.</p>
<p><strong>Cause:</strong> Truncating an infinite signal to $N$ samples is equivalent to multiplying by a rectangular window. In the frequency domain, this convolves the true spectrum with the sinc-like Fourier transform of the rectangular window.</p>
<h3 id="52-window-functions">5.2 Window Functions<a class="header-link" href="#52-window-functions" title="Permanent link">&para;</a></h3>
<p>To reduce spectral leakage, we multiply the signal by a <strong>window function</strong> $w[n]$ before computing the DFT:</p>
<p>$$y[n] = x[n] \cdot w[n]$$</p>
<p>Common window functions:</p>
<table>
<thead>
<tr>
<th>Window</th>
<th>Main Lobe Width</th>
<th>Side Lobe Level</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>Rectangular</td>
<td>Narrowest ($2\pi/N$)</td>
<td>-13 dB</td>
<td>Maximum resolution</td>
</tr>
<tr>
<td>Hann (Hanning)</td>
<td>$4\pi/N$</td>
<td>-31 dB</td>
<td>General purpose</td>
</tr>
<tr>
<td>Hamming</td>
<td>$4\pi/N$</td>
<td>-42 dB</td>
<td>Speech processing</td>
</tr>
<tr>
<td>Blackman</td>
<td>$6\pi/N$</td>
<td>-58 dB</td>
<td>High dynamic range</td>
</tr>
<tr>
<td>Kaiser ($\beta$)</td>
<td>Variable</td>
<td>Variable</td>
<td>Adjustable trade-off</td>
</tr>
<tr>
<td>Flat-top</td>
<td>Wide</td>
<td>Very low</td>
<td>Amplitude accuracy</td>
</tr>
</tbody>
</table>
<p><strong>Trade-off:</strong> Wider main lobe = worse frequency resolution, but lower side lobes = less leakage.</p>
<h3 id="53-window-comparison">5.3 Window Comparison<a class="header-link" href="#53-window-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_windows</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare different window functions and their spectral properties.&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="n">windows</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Rectangular&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
        <span class="s1">&#39;Hann&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
        <span class="s1">&#39;Hamming&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
        <span class="s1">&#39;Blackman&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
        <span class="s1">&#39;Kaiser (beta=8)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="s1">&#39;Kaiser (beta=14)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">nfft</span> <span class="o">=</span> <span class="mi">4096</span>  <span class="c1"># Large FFT for smooth spectrum</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">windows</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Time domain</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># Frequency domain (log magnitude)</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">nfft</span><span class="p">)</span>
        <span class="n">W_shifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nfft</span><span class="p">)</span> <span class="o">-</span> <span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">W_shifted</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">W_shifted</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">[:</span><span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">nfft</span><span class="p">,</span> <span class="n">mag_db</span><span class="p">[:</span><span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span><span class="p">],</span>
                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Window Functions (Time Domain)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample index n&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;w[n]&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Window Functions (Frequency Domain)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Normalized frequency ($\omega$)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;windows.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">compare_windows</span><span class="p">()</span>
</code></pre></div>

<h3 id="54-spectral-leakage-in-action">5.4 Spectral Leakage in Action<a class="header-link" href="#54-spectral-leakage-in-action" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_leakage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show spectral leakage and how windowing helps.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Hz</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Case 1: frequency on a DFT bin (no leakage)</span>
    <span class="n">f_on_bin</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">/</span> <span class="n">N</span>  <span class="c1"># Exactly bin 10</span>
    <span class="n">x_on</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_on_bin</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="c1"># Case 2: frequency between bins (leakage)</span>
    <span class="n">f_off_bin</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">*</span> <span class="mf">10.5</span> <span class="o">/</span> <span class="n">N</span>  <span class="c1"># Between bins 10 and 11</span>
    <span class="n">x_off</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_off_bin</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="c1"># Case 3: off-bin with Hann window</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">x_off_windowed</span> <span class="o">=</span> <span class="n">x_off</span> <span class="o">*</span> <span class="n">w</span>

    <span class="n">nfft</span> <span class="o">=</span> <span class="mi">512</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">nfft</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)[:</span><span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>

    <span class="n">cases</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;On-bin: f = </span><span class="si">{</span><span class="n">f_on_bin</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz (Rectangular)&#39;</span><span class="p">,</span> <span class="n">x_on</span><span class="p">),</span>
        <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Off-bin: f = </span><span class="si">{</span><span class="n">f_off_bin</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz (Rectangular)&#39;</span><span class="p">,</span> <span class="n">x_off</span><span class="p">),</span>
        <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Off-bin: f = </span><span class="si">{</span><span class="n">f_off_bin</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz (Hann window)&#39;</span><span class="p">,</span> <span class="n">x_off_windowed</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">cases</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">nfft</span><span class="p">)</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>
        <span class="n">mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mag</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mag</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">mag_db</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;spectral_leakage.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">demonstrate_leakage</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6-fast-fourier-transform-fft">6. Fast Fourier Transform (FFT)<a class="header-link" href="#6-fast-fourier-transform-fft" title="Permanent link">&para;</a></h2>
<h3 id="61-the-computational-problem">6.1 The Computational Problem<a class="header-link" href="#61-the-computational-problem" title="Permanent link">&para;</a></h3>
<p>Direct computation of the DFT requires:
- $N$ complex multiplications and $N-1$ complex additions for each of $N$ output values
- Total: $O(N^2)$ operations</p>
<p>For $N = 10^6$: $\sim 10^{12}$ operations (impractical for real-time processing).</p>
<h3 id="62-the-cooley-tukey-algorithm">6.2 The Cooley-Tukey Algorithm<a class="header-link" href="#62-the-cooley-tukey-algorithm" title="Permanent link">&para;</a></h3>
<p>The FFT exploits the symmetry and periodicity of the twiddle factors $W_N^{kn}$.</p>
<p><strong>Key observations:</strong>
1. $W_N^{k+N} = W_N^k$ (periodicity)
2. $W_N^{k+N/2} = -W_N^k$ (symmetry / half-period negation)
3. $W_N^{2kn} = W_{N/2}^{kn}$ (reduction)</p>
<p><strong>Radix-2 Decimation-in-Time (DIT):</strong></p>
<p>Split $x[n]$ into even-indexed and odd-indexed subsequences:</p>
<p>$$X[k] = \underbrace{\sum_{r=0}^{N/2-1} x[2r] \, W_{N/2}^{kr}}_{G[k] \text{ (even terms)}} + W_N^k \underbrace{\sum_{r=0}^{N/2-1} x[2r+1] \, W_{N/2}^{kr}}_{H[k] \text{ (odd terms)}}$$</p>
<p>This gives the <strong>butterfly</strong> computation:</p>
<p>$$X[k] = G[k] + W_N^k \cdot H[k]$$
$$X[k + N/2] = G[k] - W_N^k \cdot H[k]$$</p>
<p>for $k = 0, 1, \ldots, N/2 - 1$.</p>
<p>Each stage halves the problem size, giving $\log_2 N$ stages of $N/2$ butterflies each.</p>
<p><strong>Complexity:</strong> $O(N \log_2 N)$</p>
<table>
<thead>
<tr>
<th>$N$</th>
<th>DFT ($N^2$)</th>
<th>FFT ($N \log_2 N$)</th>
<th>Speedup</th>
</tr>
</thead>
<tbody>
<tr>
<td>64</td>
<td>4,096</td>
<td>384</td>
<td>10.7x</td>
</tr>
<tr>
<td>256</td>
<td>65,536</td>
<td>2,048</td>
<td>32x</td>
</tr>
<tr>
<td>1,024</td>
<td>1,048,576</td>
<td>10,240</td>
<td>102x</td>
</tr>
<tr>
<td>65,536</td>
<td>$4.3 \times 10^9$</td>
<td>$1.0 \times 10^6$</td>
<td>4,096x</td>
</tr>
<tr>
<td>1,048,576</td>
<td>$1.1 \times 10^{12}$</td>
<td>$2.1 \times 10^7$</td>
<td>52,429x</td>
</tr>
</tbody>
</table>
<h3 id="63-butterfly-diagram">6.3 Butterfly Diagram<a class="header-link" href="#63-butterfly-diagram" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Stage 0 (N=2 DFTs):     Stage 1 (N=4 DFTs):     Stage 2 (N=8 DFT):

x[0] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ X[0]
           ‚îÇ‚ï≤            ‚îÇ‚ï≤                        ‚îÇ‚ï≤
x[4] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ  ‚ï≤                      ‚îÇ  ‚ï≤
                  W‚Å∞    ‚îÇ   ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ   ‚óè‚îÄ‚îÄ X[1]
x[2] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè  ‚ï±           W‚Å∞        ‚îÇ  ‚ï±
           ‚îÇ‚ï≤            ‚îÇ‚ï±                        ‚îÇ‚ï±
x[6] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ X[2]
                                W¬≤                ‚îÇ
x[1] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ X[3]
           ‚îÇ‚ï≤            ‚îÇ‚ï≤                        ‚îÇ
x[5] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ  ‚ï≤                      ‚îÇ
                  W‚Å∞    ‚îÇ   ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ X[4]
x[3] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè  ‚ï±           W¬π
           ‚îÇ‚ï≤            ‚îÇ‚ï±
x[7] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ...
</code></pre></div>

<h3 id="64-radix-2-dit-implementation">6.4 Radix-2 DIT Implementation<a class="header-link" href="#64-radix-2-dit-implementation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fft_dit</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Radix-2 Decimation-in-Time FFT (recursive implementation).&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Base case</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Check power of 2</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length must be a power of 2&quot;</span><span class="p">)</span>

    <span class="c1"># Split into even and odd</span>
    <span class="n">x_even</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x_odd</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Recursive FFT</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">fft_dit</span><span class="p">(</span><span class="n">x_even</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">fft_dit</span><span class="p">(</span><span class="n">x_odd</span><span class="p">)</span>

    <span class="c1"># Twiddle factors</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># Butterfly</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">X</span><span class="p">[:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span> <span class="o">+</span> <span class="n">W</span> <span class="o">*</span> <span class="n">H</span>
    <span class="n">X</span><span class="p">[</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">G</span> <span class="o">-</span> <span class="n">W</span> <span class="o">*</span> <span class="n">H</span>

    <span class="k">return</span> <span class="n">X</span>


<span class="k">def</span><span class="w"> </span><span class="nf">fft_dit_iterative</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterative in-place radix-2 DIT FFT.&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">stages</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="c1"># Bit-reversal permutation</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">stages</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
            <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Butterfly stages</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">stages</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">s</span>
        <span class="n">wm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">m</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span> <span class="o">+</span> <span class="n">t</span>
                <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">m</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span> <span class="o">-</span> <span class="n">t</span>
                <span class="n">w</span> <span class="o">*=</span> <span class="n">wm</span>

    <span class="k">return</span> <span class="n">X</span>


<span class="k">def</span><span class="w"> </span><span class="nf">verify_fft_implementations</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify custom FFT implementations against numpy.&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="n">X_numpy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">X_recursive</span> <span class="o">=</span> <span class="n">fft_dit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">X_iterative</span> <span class="o">=</span> <span class="n">fft_dit_iterative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FFT Implementation Verification&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max error (recursive):  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_recursive</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X_numpy</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max error (iterative):  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_iterative</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X_numpy</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">verify_fft_implementations</span><span class="p">()</span>
</code></pre></div>

<h3 id="65-radix-2-decimation-in-frequency-dif">6.5 Radix-2 Decimation-in-Frequency (DIF)<a class="header-link" href="#65-radix-2-decimation-in-frequency-dif" title="Permanent link">&para;</a></h3>
<p>The DIF variant splits the output rather than the input:</p>
<p>$$X[2r] = \sum_{n=0}^{N/2-1} (x[n] + x[n + N/2]) \, W_{N/2}^{rn}$$</p>
<p>$$X[2r+1] = \sum_{n=0}^{N/2-1} (x[n] - x[n + N/2]) \, W_N^n \, W_{N/2}^{rn}$$</p>
<p>DIF butterflies subtract first, then multiply by twiddle factors (opposite order to DIT).</p>
<h3 id="66-fft-complexity-comparison">6.6 FFT Complexity Comparison<a class="header-link" href="#66-fft-complexity-comparison" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">def</span><span class="w"> </span><span class="nf">benchmark_dft_vs_fft</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Benchmark direct DFT vs FFT for various sizes.&quot;&quot;&quot;</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">)]</span>  <span class="c1"># 16 to 16384</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1"># Direct DFT (only for small N)</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">4096</span><span class="p">:</span>
            <span class="n">n_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">W_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">n_arr</span><span class="p">,</span> <span class="n">n_arr</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">X_direct</span> <span class="o">=</span> <span class="n">W_matrix</span> <span class="o">@</span> <span class="n">x</span>
            <span class="n">t_direct</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t_direct</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># FFT</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
            <span class="n">X_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">t_fft</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">t_direct</span><span class="p">,</span> <span class="n">t_fft</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DFT vs FFT Benchmark&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;N&#39;</span><span class="si">:</span><span class="s2">&gt;8s</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;DFT (ms)&#39;</span><span class="si">:</span><span class="s2">&gt;12s</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;FFT (ms)&#39;</span><span class="si">:</span><span class="s2">&gt;12s</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Speedup&#39;</span><span class="si">:</span><span class="s2">&gt;10s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">N</span><span class="p">,</span> <span class="n">t_d</span><span class="p">,</span> <span class="n">t_f</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">t_d_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t_d</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">t_d</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
        <span class="n">speedup</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t_d</span><span class="o">/</span><span class="n">t_f</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span> <span class="k">if</span> <span class="n">t_d</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">N</span><span class="si">:</span><span class="s2">8d</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">t_d_str</span><span class="si">:</span><span class="s2">&gt;12s</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">t_f</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">speedup</span><span class="si">:</span><span class="s2">&gt;10s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">benchmark_dft_vs_fft</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7-practical-fft-usage">7. Practical FFT Usage<a class="header-link" href="#7-practical-fft-usage" title="Permanent link">&para;</a></h2>
<h3 id="71-using-numpyfft">7.1 Using numpy.fft<a class="header-link" href="#71-using-numpyfft" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">practical_fft_guide</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Comprehensive guide to using numpy.fft for spectral analysis.&quot;&quot;&quot;</span>
    <span class="c1"># Generate a test signal</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling rate</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>    <span class="c1"># Duration</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Signal: three sinusoids + noise</span>
    <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span>  <span class="c1"># Hz</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span>  <span class="c1"># Amplitudes</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="n">a2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="n">a3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f3</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>  <span class="c1"># Noise</span>

    <span class="c1"># Compute FFT</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># For real signals, use rfft (returns only positive frequencies)</span>
    <span class="n">X_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">freqs_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># Magnitude spectrum</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_r</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">N</span>  <span class="c1"># Scale for single-sided spectrum</span>
    <span class="n">mag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>  <span class="c1"># DC component (no doubling)</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">mag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>  <span class="c1"># Nyquist component</span>

    <span class="c1"># Power spectral density (PSD)</span>
    <span class="n">psd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_r</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">psd</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="c1"># Double non-DC, non-Nyquist bins</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

    <span class="c1"># Time domain</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Domain Signal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Magnitude spectrum (linear)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_r</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Single-Sided Magnitude Spectrum&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Magnitude spectrum (dB)</span>
    <span class="n">mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mag</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_r</span><span class="p">,</span> <span class="n">mag_db</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnitude Spectrum (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># PSD</span>
    <span class="n">psd_db</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">psd</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_r</span><span class="p">,</span> <span class="n">psd_db</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PSD (dB/Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;practical_fft.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Print detected peaks</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_peaks</span>
    <span class="n">peaks</span><span class="p">,</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Detected Frequency Peaks:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="si">:</span><span class="s2">&gt;15s</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Amplitude&#39;</span><span class="si">:</span><span class="s2">&gt;10s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">freqs_r</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="si">:</span><span class="s2">15.1f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">mag</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="si">:</span><span class="s2">10.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">practical_fft_guide</span><span class="p">()</span>
</code></pre></div>

<h3 id="72-important-fft-functions-in-numpy">7.2 Important FFT Functions in NumPy<a class="header-link" href="#72-important-fft-functions-in-numpy" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>np.fft.fft(x, n)</code></td>
<td>N-point FFT of complex/real signal</td>
</tr>
<tr>
<td><code>np.fft.ifft(X, n)</code></td>
<td>Inverse FFT</td>
</tr>
<tr>
<td><code>np.fft.rfft(x, n)</code></td>
<td>FFT for real input (positive freqs only)</td>
</tr>
<tr>
<td><code>np.fft.irfft(X, n)</code></td>
<td>Inverse FFT for real output</td>
</tr>
<tr>
<td><code>np.fft.fftfreq(n, d)</code></td>
<td>Frequency array for <code>fft</code> output</td>
</tr>
<tr>
<td><code>np.fft.rfftfreq(n, d)</code></td>
<td>Frequency array for <code>rfft</code> output</td>
</tr>
<tr>
<td><code>np.fft.fftshift(X)</code></td>
<td>Shift zero-frequency to center</td>
</tr>
<tr>
<td><code>np.fft.ifftshift(X)</code></td>
<td>Undo <code>fftshift</code></td>
</tr>
</tbody>
</table>
<h3 id="73-common-pitfalls">7.3 Common Pitfalls<a class="header-link" href="#73-common-pitfalls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fft_pitfalls</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate common FFT mistakes and correct usage.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># 100 Hz sine</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Common FFT Pitfalls&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="c1"># Pitfall 1: Wrong frequency axis</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">freqs_wrong</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># WRONG: just bin indices</span>
    <span class="n">freqs_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>  <span class="c1"># RIGHT: Hz</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Frequency axis:&quot;</span><span class="p">)</span>
    <span class="n">peak_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Peak at bin </span><span class="si">{</span><span class="n">peak_bin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Wrong freq: </span><span class="si">{</span><span class="n">freqs_wrong</span><span class="p">[</span><span class="n">peak_bin</span><span class="p">]</span><span class="si">}</span><span class="s2"> (meaningless)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Right freq: </span><span class="si">{</span><span class="n">freqs_right</span><span class="p">[</span><span class="n">peak_bin</span><span class="p">]</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

    <span class="c1"># Pitfall 2: Forgetting to scale amplitude</span>
    <span class="n">X_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Amplitude scaling:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Raw |X[peak]| = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_r</span><span class="p">[</span><span class="n">peak_bin</span><span class="p">])</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Scaled 2*|X|/N = </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_r</span><span class="p">[</span><span class="n">peak_bin</span><span class="p">])</span><span class="o">/</span><span class="n">N</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (correct)&quot;</span><span class="p">)</span>

    <span class="c1"># Pitfall 3: Aliasing due to non-power-of-2 length</span>
    <span class="c1"># numpy.fft handles any length, but power-of-2 is fastest</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">1023</span><span class="p">]:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. FFT of length </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s for 1000 runs&quot;</span><span class="p">)</span>

<span class="n">fft_pitfalls</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="8-spectral-analysis-applications">8. Spectral Analysis Applications<a class="header-link" href="#8-spectral-analysis-applications" title="Permanent link">&para;</a></h2>
<h3 id="81-analyzing-a-musical-chord">8.1 Analyzing a Musical Chord<a class="header-link" href="#81-analyzing-a-musical-chord" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze_chord</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Spectral analysis of a musical chord (C major).&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c1"># Hz</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># C major chord: C4=261.63, E4=329.63, G4=392.00 Hz</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;C4&#39;</span><span class="p">:</span> <span class="mf">261.63</span><span class="p">,</span>
        <span class="s1">&#39;E4&#39;</span><span class="p">:</span> <span class="mf">329.63</span><span class="p">,</span>
        <span class="s1">&#39;G4&#39;</span><span class="p">:</span> <span class="mf">392.00</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Generate chord with harmonics</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">f0</span> <span class="ow">in</span> <span class="n">notes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">harmonic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">harmonic</span>  <span class="c1"># Harmonic series decay</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">harmonic</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># Normalize</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># Add slight noise</span>

    <span class="c1"># Windowed FFT</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">window</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">mag_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Time domain (first 50 ms)</span>
    <span class="n">samples_50ms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">samples_50ms</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">x</span><span class="p">[:</span><span class="n">samples_50ms</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;C Major Chord (Time Domain)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Frequency domain</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">mag_db</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">f0</span> <span class="ow">in</span> <span class="n">notes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">f0</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                         <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrum of C Major Chord&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;chord_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">analyze_chord</span><span class="p">()</span>
</code></pre></div>

<h3 id="82-short-time-fourier-transform-stft-spectrogram">8.2 Short-Time Fourier Transform (STFT) / Spectrogram<a class="header-link" href="#82-short-time-fourier-transform-stft-spectrogram" title="Permanent link">&para;</a></h3>
<p>For non-stationary signals, the STFT divides the signal into overlapping segments, windows each, and computes the FFT:</p>
<p>$$\text{STFT}\{x[n]\}(m, k) = \sum_{n=0}^{L-1} x[n + mH] \, w[n] \, e^{-j2\pi kn/N_{\text{FFT}}}$$</p>
<p>where $L$ is window length, $H$ is hop size, and $N_{\text{FFT}}$ is the FFT size.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">spectrogram_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a spectrogram of a chirp signal.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">8000</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Linear chirp from 100 Hz to 3000 Hz</span>
    <span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3000</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Time domain</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Linear Chirp Signal (100 Hz to 3000 Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Spectrogram</span>
    <span class="n">nfft</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="n">noverlap</span> <span class="o">=</span> <span class="n">nfft</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">specgram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="n">nfft</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">noverlap</span><span class="p">,</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrogram&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;spectrogram.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">spectrogram_demo</span><span class="p">()</span>
</code></pre></div>

<h3 id="83-fft-based-filtering-overlap-add-method">8.3 FFT-Based Filtering (Overlap-Add Method)<a class="header-link" href="#83-fft-based-filtering-overlap-add-method" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fft_filtering</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate frequency-domain filtering using overlap-add.&quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>

    <span class="c1"># Signal: 50 Hz + 200 Hz + noise</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span>
         <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

    <span class="c1"># Design a lowpass FIR filter (keep &lt; 100 Hz)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">101</span>  <span class="c1"># Filter length</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># Method 1: Time-domain convolution</span>
    <span class="n">y_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

    <span class="c1"># Method 2: FFT-based (overlap-add)</span>
    <span class="n">nfft</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nfft</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">nfft</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">H</span>
    <span class="n">y_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Y</span><span class="p">))[:</span><span class="n">N</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Signal (50 Hz + 200 Hz + Noise)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_time</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time-domain&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_fft</span><span class="p">[:</span><span class="n">N</span><span class="p">],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FFT-based&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filtered Signal (Lowpass &lt; 100 Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Compare spectra</span>
    <span class="n">f_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">X_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">X_filt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">y_fft</span><span class="p">[:</span><span class="n">N</span><span class="p">]))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_orig</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X_orig</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X_orig</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span>
                 <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_orig</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">X_filt</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X_filt</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span>
                 <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Filtered&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spectrum Comparison&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fft_filtering.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">fft_filtering</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="9-two-dimensional-dft">9. Two-Dimensional DFT<a class="header-link" href="#9-two-dimensional-dft" title="Permanent link">&para;</a></h2>
<h3 id="91-definition">9.1 Definition<a class="header-link" href="#91-definition" title="Permanent link">&para;</a></h3>
<p>The 2D DFT extends naturally to images and spatial data:</p>
<p>$$X[k_1, k_2] = \sum_{n_1=0}^{N_1-1} \sum_{n_2=0}^{N_2-1} x[n_1, n_2] \, e^{-j2\pi(k_1 n_1/N_1 + k_2 n_2/N_2)}$$</p>
<p>The 2D FFT can be computed as 1D FFTs along each dimension (separability).</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fft_2d_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate 2D FFT on a simple image pattern.&quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">256</span>

    <span class="c1"># Create a test image with known spatial frequencies</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># Two spatial frequencies</span>
    <span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">X</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">+</span>
           <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">+</span>
           <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">15</span> <span class="o">*</span> <span class="n">X</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">Y</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">))</span>

    <span class="c1"># 2D FFT</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">F_shifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_shifted</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spatial Domain (Image)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;2D FFT Magnitude (log scale)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;kx&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ky&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fft_2d.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">fft_2d_demo</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="10-summary">10. Summary<a class="header-link" href="#10-summary" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="err">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
<span class="err">‚îÇ</span><span class="w">               </span><span class="n">Discrete</span><span class="w"> </span><span class="n">Fourier</span><span class="w"> </span><span class="n">Transform</span><span class="w"> </span><span class="p">(</span><span class="n">DFT</span><span class="p">)</span><span class="w">                   </span><span class="err">‚îÇ</span>
<span class="err">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">DTFT</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="nl">DFT</span><span class="p">:</span><span class="w">                                                    </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">DFT</span><span class="w"> </span><span class="n">samples</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">DTFT</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="n">equally</span><span class="w"> </span><span class="n">spaced</span><span class="w"> </span><span class="n">frequencies</span><span class="w">         </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">X</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Œ£</span><span class="w"> </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="n">W_N</span><span class="o">^</span><span class="p">(</span><span class="n">kn</span><span class="p">),</span><span class="w">  </span><span class="n">W_N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">j2œÄ</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="w">                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="k">Key</span><span class="w"> </span><span class="nl">Properties</span><span class="p">:</span><span class="w">                                                 </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Circular</span><span class="w"> </span><span class="n">convolution</span><span class="w"> </span><span class="err">‚Üî</span><span class="w"> </span><span class="n">Pointwise</span><span class="w"> </span><span class="n">multiplication</span><span class="w">            </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">Parseval</span><span class="p">:</span><span class="w"> </span><span class="n">Œ£</span><span class="o">|</span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]|</span><span class="n">¬≤</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="n">Œ£</span><span class="o">|</span><span class="n">X</span><span class="o">[</span><span class="n">k</span><span class="o">]|</span><span class="n">¬≤</span><span class="w">                       </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Circular</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="err">‚Üî</span><span class="w"> </span><span class="n">Phase</span><span class="w"> </span><span class="n">rotation</span><span class="w">                            </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="nl">Resolution</span><span class="p">:</span><span class="w">                                                     </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">Œîf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fs</span><span class="o">/</span><span class="n">N</span><span class="w">  </span><span class="p">(</span><span class="n">determined</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">duration</span><span class="p">)</span><span class="w">                   </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">Zero</span><span class="o">-</span><span class="nl">padding</span><span class="p">:</span><span class="w"> </span><span class="n">finer</span><span class="w"> </span><span class="n">grid</span><span class="p">,</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="n">finer</span><span class="w"> </span><span class="n">resolution</span><span class="w">               </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">Spectral</span><span class="w"> </span><span class="nl">Leakage</span><span class="p">:</span><span class="w">                                               </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">Cause</span><span class="p">:</span><span class="w"> </span><span class="n">finite</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">rectangular</span><span class="w"> </span><span class="k">window</span><span class="p">)</span><span class="w">             </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">Fix</span><span class="p">:</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="k">window</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">Hann</span><span class="p">,</span><span class="w"> </span><span class="n">Hamming</span><span class="p">,</span><span class="w"> </span><span class="n">Blackman</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="p">.)</span><span class="w">   </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">Trade</span><span class="o">-</span><span class="k">off</span><span class="err">:</span><span class="w"> </span><span class="n">wider</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">lobe</span><span class="w"> </span><span class="n">vs</span><span class="p">.</span><span class="w"> </span><span class="nf">lower</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">lobes</span><span class="w">              </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">FFT</span><span class="w"> </span><span class="p">(</span><span class="n">Cooley</span><span class="o">-</span><span class="n">Tukey</span><span class="p">)</span><span class="err">:</span><span class="w">                                             </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="n">Reduces</span><span class="w"> </span><span class="n">O</span><span class="p">(</span><span class="n">N¬≤</span><span class="p">)</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">O</span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w">                                   </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">DIT</span><span class="p">:</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">even</span><span class="o">/</span><span class="n">odd</span><span class="w"> </span><span class="err">‚Üí</span><span class="w"> </span><span class="n">butterfly</span><span class="w"> </span><span class="n">computation</span><span class="w">                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="nl">Practical</span><span class="p">:</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">numpy</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="n">fft</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">rfft</span><span class="w">                          </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">  </span><span class="n">Practical</span><span class="w"> </span><span class="nl">Tips</span><span class="p">:</span><span class="w">                                                 </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="n">rfft</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">real</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="n">x</span><span class="w"> </span><span class="n">efficiency</span><span class="p">)</span><span class="w">                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">Scale</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="o">|</span><span class="n">X</span><span class="o">[</span><span class="n">k</span><span class="o">]|/</span><span class="n">N</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="n">sided</span><span class="w"> </span><span class="n">amplitude</span><span class="w">               </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="k">Window</span><span class="w"> </span><span class="k">before</span><span class="w"> </span><span class="n">FFT</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="n">leakage</span><span class="w">                        </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Zero</span><span class="o">-</span><span class="k">pad</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">FFT</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">linear</span><span class="w"> </span><span class="n">convolution</span><span class="w">                  </span><span class="err">‚îÇ</span>
<span class="err">‚îÇ</span><span class="w">                                                                  </span><span class="err">‚îÇ</span>
<span class="err">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
</code></pre></div>

<hr />
<h2 id="11-exercises">11. Exercises<a class="header-link" href="#11-exercises" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-dft-by-hand">Exercise 1: DFT by Hand<a class="header-link" href="#exercise-1-dft-by-hand" title="Permanent link">&para;</a></h3>
<p>Compute the 4-point DFT of $x[n] = \{1, 0, -1, 0\}$ by hand using the definition.</p>
<p><strong>(a)</strong> Write out all four summations for $X[0], X[1], X[2], X[3]$.</p>
<p><strong>(b)</strong> Verify your answer using <code>np.fft.fft</code>.</p>
<p><strong>(c)</strong> Apply the inverse DFT to recover $x[n]$ and verify.</p>
<h3 id="exercise-2-circular-convolution">Exercise 2: Circular Convolution<a class="header-link" href="#exercise-2-circular-convolution" title="Permanent link">&para;</a></h3>
<p>Given $x_1 = \{1, 2, 3, 4\}$ and $x_2 = \{1, 0, 1, 0\}$:</p>
<p><strong>(a)</strong> Compute the 4-point circular convolution by hand.</p>
<p><strong>(b)</strong> Verify using the DFT multiplication property: $\text{IDFT}\{X_1[k] \cdot X_2[k]\}$.</p>
<p><strong>(c)</strong> Compare with linear convolution. How long must the zero-padded sequences be for the circular convolution to equal the linear convolution?</p>
<h3 id="exercise-3-frequency-resolution-challenge">Exercise 3: Frequency Resolution Challenge<a class="header-link" href="#exercise-3-frequency-resolution-challenge" title="Permanent link">&para;</a></h3>
<p>Two sinusoids at frequencies $f_1 = 100$ Hz and $f_2 = 103$ Hz are sampled at $f_s = 1000$ Hz.</p>
<p><strong>(a)</strong> What is the minimum number of samples $N$ needed to resolve these two frequencies (i.e., $\Delta f \leq 3$ Hz)?</p>
<p><strong>(b)</strong> Generate the signal, apply an FFT, and show that you can resolve the two peaks. Try both $N = 256$ and $N = 512$ samples.</p>
<p><strong>(c)</strong> Apply a Hann window and repeat. Does windowing help or hurt the ability to resolve the two tones? Why?</p>
<h3 id="exercise-4-implement-the-cooley-tukey-fft">Exercise 4: Implement the Cooley-Tukey FFT<a class="header-link" href="#exercise-4-implement-the-cooley-tukey-fft" title="Permanent link">&para;</a></h3>
<p><strong>(a)</strong> Implement a radix-2 DIF FFT (complement the DIT implementation shown in this lesson).</p>
<p><strong>(b)</strong> Add support for arbitrary lengths using the Bluestein algorithm or zero-padding to the next power of 2.</p>
<p><strong>(c)</strong> Benchmark your implementation against <code>np.fft.fft</code> for $N = 2^{10}$ through $2^{20}$.</p>
<h3 id="exercise-5-spectral-analysis-of-real-audio">Exercise 5: Spectral Analysis of Real Audio<a class="header-link" href="#exercise-5-spectral-analysis-of-real-audio" title="Permanent link">&para;</a></h3>
<p>Record or obtain a short audio clip (WAV file). Using Python:</p>
<p><strong>(a)</strong> Load the audio and plot its waveform.</p>
<p><strong>(b)</strong> Compute and plot the magnitude spectrum using a Hann window.</p>
<p><strong>(c)</strong> Create a spectrogram with overlapping windows. Identify the dominant frequency components over time.</p>
<p><strong>(d)</strong> Implement frequency-domain filtering to remove a specific frequency band and listen to the result.</p>
<h3 id="exercise-6-windowing-experiment">Exercise 6: Windowing Experiment<a class="header-link" href="#exercise-6-windowing-experiment" title="Permanent link">&para;</a></h3>
<p>Generate a signal with two sinusoids: $x[n] = \sin(2\pi \cdot 100n / f_s) + 0.01 \sin(2\pi \cdot 150n / f_s)$ where $f_s = 1000$ Hz, $N = 256$.</p>
<p><strong>(a)</strong> With no window (rectangular), can you see the weak 150 Hz component? What is the peak level of the leakage side lobes?</p>
<p><strong>(b)</strong> Apply Hann, Hamming, Blackman, and Kaiser ($\beta = 12$) windows. Which window reveals the weak component best?</p>
<p><strong>(c)</strong> Plot the dynamic range (ability to detect weak signals near strong ones) as a function of window type.</p>
<h3 id="exercise-7-2d-fft-application">Exercise 7: 2D FFT Application<a class="header-link" href="#exercise-7-2d-fft-application" title="Permanent link">&para;</a></h3>
<p><strong>(a)</strong> Load a grayscale image and compute its 2D FFT.</p>
<p><strong>(b)</strong> Display the magnitude spectrum (log-scaled, centered).</p>
<p><strong>(c)</strong> Implement frequency-domain lowpass filtering by zeroing out high-frequency components and inverting the FFT. Show the blurred result for different cutoff radii.</p>
<p><strong>(d)</strong> Implement highpass filtering (edge detection) in the frequency domain.</p>
<hr />
<h2 id="12-further-reading">12. Further Reading<a class="header-link" href="#12-further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li>Oppenheim, Schafer. <em>Discrete-Time Signal Processing</em>, 3rd ed. Chapters 5, 8, 9.</li>
<li>Proakis, Manolakis. <em>Digital Signal Processing</em>, 4th ed. Chapters 5, 7.</li>
<li>Cooley, Tukey. "An Algorithm for the Machine Calculation of Complex Fourier Series," <em>Math. of Computation</em>, 1965.</li>
<li>Smith, S. W. <em>The Scientist and Engineer's Guide to DSP</em>, Chapters 8-12.</li>
<li>Lyons, R. G. <em>Understanding Digital Signal Processing</em>, 3rd ed. Chapters 3-4.</li>
</ul>
<hr />
<p><strong>Previous</strong>: <a href="05_Sampling_and_Reconstruction.md">05. Sampling and Reconstruction</a> | <strong>Next</strong>: <a href="07_Z_Transform.md">07. Z-Transform</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/05_Sampling_and_Reconstruction.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Sampling and Reconstruction</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">üîó</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">üìã</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/07_Z_Transform.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Z-Transform</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">‚Üë</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}