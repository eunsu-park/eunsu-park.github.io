{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14. Time-Frequency Analysis - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/Signal_Processing/">Signal Processing</a>
    <span class="separator">/</span>
    <span class="current">14. Time-Frequency Analysis</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>14. Time-Frequency Analysis</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/13_Adaptive_Filters.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. Adaptive Filters</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/15_Image_Signal_Processing.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. Image Signal Processing</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-limitations-of-the-fourier-transform">1. Limitations of the Fourier Transform</a><ul>
<li><a href="#11-the-problem-with-global-frequency-analysis">1.1 The Problem with Global Frequency Analysis</a></li>
<li><a href="#12-non-stationary-signals">1.2 Non-Stationary Signals</a></li>
<li><a href="#13-the-instantaneous-frequency-concept">1.3 The Instantaneous Frequency Concept</a></li>
</ul>
</li>
<li><a href="#2-short-time-fourier-transform-stft">2. Short-Time Fourier Transform (STFT)</a><ul>
<li><a href="#21-definition">2.1 Definition</a></li>
<li><a href="#22-discrete-stft">2.2 Discrete STFT</a></li>
<li><a href="#23-interpretation">2.3 Interpretation</a></li>
<li><a href="#24-overlap-and-hop-size">2.4 Overlap and Hop Size</a></li>
</ul>
</li>
<li><a href="#3-time-frequency-resolution-and-the-uncertainty-principle">3. Time-Frequency Resolution and the Uncertainty Principle</a><ul>
<li><a href="#31-time-and-frequency-resolution">3.1 Time and Frequency Resolution</a></li>
<li><a href="#32-the-heisenberg-gabor-uncertainty-principle">3.2 The Heisenberg-Gabor Uncertainty Principle</a></li>
<li><a href="#33-tiles-in-the-time-frequency-plane">3.3 Tiles in the Time-Frequency Plane</a></li>
</ul>
</li>
<li><a href="#4-the-spectrogram">4. The Spectrogram</a><ul>
<li><a href="#41-definition">4.1 Definition</a></li>
<li><a href="#42-properties">4.2 Properties</a></li>
<li><a href="#43-spectrogram-as-a-smoothed-wigner-ville-distribution">4.3 Spectrogram as a Smoothed Wigner-Ville Distribution</a></li>
</ul>
</li>
<li><a href="#5-window-selection-for-stft">5. Window Selection for STFT</a><ul>
<li><a href="#51-window-properties">5.1 Window Properties</a></li>
<li><a href="#52-practical-guidelines">5.2 Practical Guidelines</a></li>
<li><a href="#53-zero-padding">5.3 Zero-Padding</a></li>
</ul>
</li>
<li><a href="#6-wigner-ville-distribution">6. Wigner-Ville Distribution</a><ul>
<li><a href="#61-definition">6.1 Definition</a></li>
<li><a href="#62-properties">6.2 Properties</a></li>
<li><a href="#63-the-cross-term-problem">6.3 The Cross-Term Problem</a></li>
<li><a href="#64-cohens-class">6.4 Cohen's Class</a></li>
</ul>
</li>
<li><a href="#7-introduction-to-wavelet-analysis">7. Introduction to Wavelet Analysis</a><ul>
<li><a href="#71-motivation-variable-resolution">7.1 Motivation: Variable Resolution</a></li>
<li><a href="#72-from-stft-to-wavelets">7.2 From STFT to Wavelets</a></li>
<li><a href="#73-wavelet-tiling">7.3 Wavelet Tiling</a></li>
</ul>
</li>
<li><a href="#8-continuous-wavelet-transform-cwt">8. Continuous Wavelet Transform (CWT)</a><ul>
<li><a href="#81-definition">8.1 Definition</a></li>
<li><a href="#82-relationship-between-scale-and-frequency">8.2 Relationship Between Scale and Frequency</a></li>
<li><a href="#83-admissibility-condition">8.3 Admissibility Condition</a></li>
<li><a href="#84-inverse-cwt">8.4 Inverse CWT</a></li>
<li><a href="#85-scalogram">8.5 Scalogram</a></li>
</ul>
</li>
<li><a href="#9-mother-wavelets">9. Mother Wavelets</a><ul>
<li><a href="#91-haar-wavelet">9.1 Haar Wavelet</a></li>
<li><a href="#92-morlet-wavelet">9.2 Morlet Wavelet</a></li>
<li><a href="#93-mexican-hat-wavelet-ricker-wavelet">9.3 Mexican Hat Wavelet (Ricker Wavelet)</a></li>
<li><a href="#94-daubechies-wavelets">9.4 Daubechies Wavelets</a></li>
<li><a href="#95-other-important-wavelets">9.5 Other Important Wavelets</a></li>
</ul>
</li>
<li><a href="#10-multiresolution-analysis-mra">10. Multiresolution Analysis (MRA)</a><ul>
<li><a href="#101-concept">10.1 Concept</a></li>
<li><a href="#102-nested-approximation-spaces">10.2 Nested Approximation Spaces</a></li>
<li><a href="#103-scaling-function-and-wavelet-function">10.3 Scaling Function and Wavelet Function</a></li>
<li><a href="#104-detail-spaces">10.4 Detail Spaces</a></li>
</ul>
</li>
<li><a href="#11-discrete-wavelet-transform-dwt">11. Discrete Wavelet Transform (DWT)</a><ul>
<li><a href="#111-dyadic-sampling">11.1 Dyadic Sampling</a></li>
<li><a href="#112-connection-to-filter-banks">11.2 Connection to Filter Banks</a></li>
<li><a href="#113-analysis-and-synthesis">11.3 Analysis and Synthesis</a></li>
</ul>
</li>
<li><a href="#12-mallats-algorithm">12. Mallat's Algorithm</a><ul>
<li><a href="#121-the-fast-wavelet-transform">12.1 The Fast Wavelet Transform</a></li>
<li><a href="#122-reconstruction-synthesis">12.2 Reconstruction (Synthesis)</a></li>
<li><a href="#123-computational-complexity">12.3 Computational Complexity</a></li>
</ul>
</li>
<li><a href="#13-wavelet-decomposition-and-reconstruction">13. Wavelet Decomposition and Reconstruction</a><ul>
<li><a href="#131-multi-level-decomposition">13.1 Multi-Level Decomposition</a></li>
<li><a href="#132-wavelet-denoising-thresholding">13.2 Wavelet Denoising (Thresholding)</a></li>
<li><a href="#133-choosing-the-number-of-levels">13.3 Choosing the Number of Levels</a></li>
</ul>
</li>
<li><a href="#14-stft-vs-wavelet-transform">14. STFT vs Wavelet Transform</a><ul>
<li><a href="#141-resolution-comparison">14.1 Resolution Comparison</a></li>
<li><a href="#142-when-to-use-what">14.2 When to Use What</a></li>
<li><a href="#143-comparison-for-a-chirp-signal">14.3 Comparison for a Chirp Signal</a></li>
</ul>
</li>
<li><a href="#15-applications">15. Applications</a><ul>
<li><a href="#151-music-and-audio-analysis">15.1 Music and Audio Analysis</a></li>
<li><a href="#152-biomedical-signal-processing">15.2 Biomedical Signal Processing</a></li>
<li><a href="#153-vibration-analysis-and-fault-detection">15.3 Vibration Analysis and Fault Detection</a></li>
<li><a href="#154-geophysics-and-seismology">15.4 Geophysics and Seismology</a></li>
<li><a href="#155-image-processing">15.5 Image Processing</a></li>
</ul>
</li>
<li><a href="#16-python-implementation">16. Python Implementation</a><ul>
<li><a href="#161-stft-and-spectrogram">16.1 STFT and Spectrogram</a></li>
<li><a href="#162-wavelet-analysis-with-pywavelets">16.2 Wavelet Analysis with PyWavelets</a></li>
<li><a href="#163-discrete-wavelet-transform-dwt-and-denoising">16.3 Discrete Wavelet Transform (DWT) and Denoising</a></li>
<li><a href="#164-dwt-decomposition-visualization">16.4 DWT Decomposition Visualization</a></li>
<li><a href="#165-manual-cwt-implementation">16.5 Manual CWT Implementation</a></li>
</ul>
</li>
<li><a href="#17-exercises">17. Exercises</a><ul>
<li><a href="#exercise-1-stft-resolution-tradeoff">Exercise 1: STFT Resolution Tradeoff</a></li>
<li><a href="#exercise-2-window-comparison">Exercise 2: Window Comparison</a></li>
<li><a href="#exercise-3-wavelet-families">Exercise 3: Wavelet Families</a></li>
<li><a href="#exercise-4-wavelet-denoising">Exercise 4: Wavelet Denoising</a></li>
<li><a href="#exercise-5-cwt-vs-dwt">Exercise 5: CWT vs DWT</a></li>
<li><a href="#exercise-6-music-analysis">Exercise 6: Music Analysis</a></li>
<li><a href="#exercise-7-wigner-ville-distribution">Exercise 7: Wigner-Ville Distribution</a></li>
</ul>
</li>
<li><a href="#18-summary">18. Summary</a></li>
<li><a href="#19-references">19. References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="14-time-frequency-analysis">14. Time-Frequency Analysis<a class="header-link" href="#14-time-frequency-analysis" title="Permanent link">&para;</a></h1>
<p><strong>Previous</strong>: <a href="./13_Adaptive_Filters.md">13. Adaptive Filters</a> | <strong>Next</strong>: <a href="./15_Image_Signal_Processing.md">15. Image Signal Processing</a></p>
<hr />
<p>The Fourier transform reveals what frequencies are present in a signal, but not when they occur. For non-stationary signals -- music, speech, seismic events, biological rhythms -- we need tools that describe how spectral content evolves over time. This lesson develops the two principal frameworks for time-frequency analysis: the Short-Time Fourier Transform (STFT) and the Wavelet Transform, each with fundamentally different approaches to resolving the tension between time and frequency localization.</p>
<p><strong>Difficulty</strong>: â­â­â­â­</p>
<p><strong>Prerequisites</strong>: DFT/FFT, windowing, convolution, basic linear algebra</p>
<p><strong>Learning Objectives</strong>:
- Explain why the Fourier transform is inadequate for non-stationary signals
- Derive and compute the STFT and understand the time-frequency resolution tradeoff
- State and interpret the Heisenberg uncertainty principle for signals
- Compute and interpret spectrograms
- Understand the Wigner-Ville distribution and its properties
- Define and compute the Continuous Wavelet Transform (CWT) using standard mother wavelets
- Explain multiresolution analysis and implement the Discrete Wavelet Transform (DWT)
- Apply Mallat's algorithm for wavelet decomposition and reconstruction
- Compare STFT and wavelet approaches for real-world signal analysis</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-limitations-of-the-fourier-transform">Limitations of the Fourier Transform</a></li>
<li><a href="#2-short-time-fourier-transform-stft">Short-Time Fourier Transform (STFT)</a></li>
<li><a href="#3-time-frequency-resolution-and-the-uncertainty-principle">Time-Frequency Resolution and the Uncertainty Principle</a></li>
<li><a href="#4-the-spectrogram">The Spectrogram</a></li>
<li><a href="#5-window-selection-for-stft">Window Selection for STFT</a></li>
<li><a href="#6-wigner-ville-distribution">Wigner-Ville Distribution</a></li>
<li><a href="#7-introduction-to-wavelet-analysis">Introduction to Wavelet Analysis</a></li>
<li><a href="#8-continuous-wavelet-transform-cwt">Continuous Wavelet Transform (CWT)</a></li>
<li><a href="#9-mother-wavelets">Mother Wavelets</a></li>
<li><a href="#10-multiresolution-analysis-mra">Multiresolution Analysis (MRA)</a></li>
<li><a href="#11-discrete-wavelet-transform-dwt">Discrete Wavelet Transform (DWT)</a></li>
<li><a href="#12-mallats-algorithm">Mallat's Algorithm</a></li>
<li><a href="#13-wavelet-decomposition-and-reconstruction">Wavelet Decomposition and Reconstruction</a></li>
<li><a href="#14-stft-vs-wavelet-transform">STFT vs Wavelet Transform</a></li>
<li><a href="#15-applications">Applications</a></li>
<li><a href="#16-python-implementation">Python Implementation</a></li>
<li><a href="#17-exercises">Exercises</a></li>
<li><a href="#18-summary">Summary</a></li>
<li><a href="#19-references">References</a></li>
</ol>
<hr />
<h2 id="1-limitations-of-the-fourier-transform">1. Limitations of the Fourier Transform<a class="header-link" href="#1-limitations-of-the-fourier-transform" title="Permanent link">&para;</a></h2>
<h3 id="11-the-problem-with-global-frequency-analysis">1.1 The Problem with Global Frequency Analysis<a class="header-link" href="#11-the-problem-with-global-frequency-analysis" title="Permanent link">&para;</a></h3>
<p>The Fourier transform computes frequency content over the entire duration of a signal:</p>
<p>$$X(f) = \int_{-\infty}^{\infty} x(t) \, e^{-j2\pi ft} \, dt$$</p>
<p>Consider two signals:
1. A constant 440 Hz tone for 2 seconds
2. A signal that plays 220 Hz for the first second, then 440 Hz for the next second</p>
<p>Both signals have the same Fourier magnitude spectrum (they contain the same frequencies for the same total duration), but they are perceptually and physically very different. The Fourier transform discards all temporal information about <strong>when</strong> each frequency occurs.</p>
<h3 id="12-non-stationary-signals">1.2 Non-Stationary Signals<a class="header-link" href="#12-non-stationary-signals" title="Permanent link">&para;</a></h3>
<p>A signal is <strong>stationary</strong> if its statistical properties do not change over time. Most real-world signals are non-stationary:</p>
<ul>
<li><strong>Speech</strong>: Phonemes change rapidly (10-50 ms segments)</li>
<li><strong>Music</strong>: Notes, chords, and dynamics evolve continuously</li>
<li><strong>Seismic signals</strong>: P-waves, S-waves, and surface waves arrive at different times with different frequency content</li>
<li><strong>Biomedical</strong>: Heart rhythms, brain waves, and muscle signals vary with physiological state</li>
<li><strong>Radar/Sonar</strong>: Chirp signals have instantaneous frequency that changes with time</li>
</ul>
<p>For these signals, we need a <strong>joint time-frequency representation</strong>.</p>
<h3 id="13-the-instantaneous-frequency-concept">1.3 The Instantaneous Frequency Concept<a class="header-link" href="#13-the-instantaneous-frequency-concept" title="Permanent link">&para;</a></h3>
<p>For a signal of the form $x(t) = A(t)\cos(\phi(t))$, the <strong>instantaneous frequency</strong> is:</p>
<p>$$f_i(t) = \frac{1}{2\pi}\frac{d\phi(t)}{dt}$$</p>
<p>For a linear chirp $x(t) = \cos(2\pi(f_0 t + \frac{1}{2}\beta t^2))$, the instantaneous frequency is $f_i(t) = f_0 + \beta t$. The Fourier transform cannot capture this time-varying nature.</p>
<hr />
<h2 id="2-short-time-fourier-transform-stft">2. Short-Time Fourier Transform (STFT)<a class="header-link" href="#2-short-time-fourier-transform-stft" title="Permanent link">&para;</a></h2>
<h3 id="21-definition">2.1 Definition<a class="header-link" href="#21-definition" title="Permanent link">&para;</a></h3>
<p>The STFT localizes the Fourier analysis in time by applying a window function $w(t)$ centered at time $\tau$:</p>
<p>$$\boxed{X_{STFT}(\tau, f) = \int_{-\infty}^{\infty} x(t) \, w(t - \tau) \, e^{-j2\pi ft} \, dt}$$</p>
<p>The idea is simple: multiply the signal by a short window centered at $\tau$ to extract a local segment, then take its Fourier transform. By sliding $\tau$ across the signal, we get a sequence of local spectra.</p>
<h3 id="22-discrete-stft">2.2 Discrete STFT<a class="header-link" href="#22-discrete-stft" title="Permanent link">&para;</a></h3>
<p>For a discrete-time signal $x[n]$ with window $w[n]$ of length $L$:</p>
<p>$$X_{STFT}[m, k] = \sum_{n=0}^{L-1} x[n + mH] \, w[n] \, e^{-j2\pi kn/N}$$</p>
<p>where:
- $m$ is the time frame index
- $k$ is the frequency bin index
- $H$ is the hop size (stride between successive windows)
- $N$ is the FFT size (zero-padded if $N > L$)</p>
<h3 id="23-interpretation">2.3 Interpretation<a class="header-link" href="#23-interpretation" title="Permanent link">&para;</a></h3>
<p>The STFT maps a 1D signal into a 2D time-frequency plane. At each time instant $\tau$, we get a full spectrum. The STFT is a function of two variables: time $\tau$ and frequency $f$.</p>
<div class="highlight"><pre><span></span><code>Frequency â–²
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”
           â”‚  â”‚      â”‚   (high frequency events)
           â”‚  â”‚      â”‚
           â”‚  â””â”€â”€â”€â”€â”€â”€â”˜
           â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚           â”‚              â”‚  (mid frequency events)
           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  â”‚          â”‚               (low frequency events)
           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Time
</code></pre></div>

<h3 id="24-overlap-and-hop-size">2.4 Overlap and Hop Size<a class="header-link" href="#24-overlap-and-hop-size" title="Permanent link">&para;</a></h3>
<p>Common choices for the hop size $H$ relative to window length $L$:
- <strong>$H = L$</strong>: No overlap, may miss events at window boundaries
- <strong>$H = L/2$</strong>: 50% overlap, good tradeoff (most common)
- <strong>$H = L/4$</strong>: 75% overlap, smoother time evolution, more computation</p>
<p>For perfect reconstruction (important in synthesis applications), the window and hop size must satisfy the <strong>constant overlap-add (COLA) condition</strong>:</p>
<p>$$\sum_m w[n - mH] = \text{constant} \quad \forall n$$</p>
<hr />
<h2 id="3-time-frequency-resolution-and-the-uncertainty-principle">3. Time-Frequency Resolution and the Uncertainty Principle<a class="header-link" href="#3-time-frequency-resolution-and-the-uncertainty-principle" title="Permanent link">&para;</a></h2>
<h3 id="31-time-and-frequency-resolution">3.1 Time and Frequency Resolution<a class="header-link" href="#31-time-and-frequency-resolution" title="Permanent link">&para;</a></h3>
<p>The STFT's time and frequency resolution are determined by the window:</p>
<ul>
<li><strong>Time resolution</strong>: $\Delta t \approx$ effective width of $w(t)$</li>
<li><strong>Frequency resolution</strong>: $\Delta f \approx$ effective bandwidth of $W(f)$ (the Fourier transform of the window)</li>
</ul>
<p>A short window gives good time resolution but poor frequency resolution. A long window gives good frequency resolution but poor time resolution.</p>
<h3 id="32-the-heisenberg-gabor-uncertainty-principle">3.2 The Heisenberg-Gabor Uncertainty Principle<a class="header-link" href="#32-the-heisenberg-gabor-uncertainty-principle" title="Permanent link">&para;</a></h3>
<p>For any window function $w(t)$, the time-bandwidth product satisfies:</p>
<p>$$\boxed{\Delta t \cdot \Delta f \geq \frac{1}{4\pi}}$$</p>
<p>where the spreads are defined as:</p>
<p>$$\Delta t^2 = \frac{\int (t - \bar{t})^2 |w(t)|^2 \, dt}{\int |w(t)|^2 \, dt}, \qquad \Delta f^2 = \frac{\int (f - \bar{f})^2 |W(f)|^2 \, df}{\int |W(f)|^2 \, df}$$</p>
<p>This is a fundamental limit: <strong>no window can achieve arbitrary precision in both time and frequency simultaneously.</strong></p>
<p>The <strong>Gaussian window</strong> $w(t) = e^{-\alpha t^2}$ achieves equality (minimum uncertainty). The resulting STFT is called the <strong>Gabor transform</strong>.</p>
<h3 id="33-tiles-in-the-time-frequency-plane">3.3 Tiles in the Time-Frequency Plane<a class="header-link" href="#33-tiles-in-the-time-frequency-plane" title="Permanent link">&para;</a></h3>
<p>The STFT partitions the time-frequency plane into <strong>tiles</strong> of fixed size $\Delta t \times \Delta f$:</p>
<div class="highlight"><pre><span></span><code>STFT Tiling (fixed resolution):

Frequency â–²
           â”‚ â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
           â”‚ â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚
           â”‚ â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤  â† Same Î”t Ã— Î”f everywhere
           â”‚ â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚
           â”‚ â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
           â”‚ â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚
           â”‚ â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
           â”‚ â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚
           â”‚ â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Time
</code></pre></div>

<p>This fixed tiling is the fundamental limitation of the STFT: the resolution is the same everywhere. For many signals, we want better time resolution at high frequencies and better frequency resolution at low frequencies -- this is exactly what wavelets provide.</p>
<hr />
<h2 id="4-the-spectrogram">4. The Spectrogram<a class="header-link" href="#4-the-spectrogram" title="Permanent link">&para;</a></h2>
<h3 id="41-definition">4.1 Definition<a class="header-link" href="#41-definition" title="Permanent link">&para;</a></h3>
<p>The <strong>spectrogram</strong> is the squared magnitude of the STFT:</p>
<p>$$S(\tau, f) = |X_{STFT}(\tau, f)|^2$$</p>
<p>It represents the <strong>power spectral density</strong> localized in time. The spectrogram is always real and non-negative.</p>
<h3 id="42-properties">4.2 Properties<a class="header-link" href="#42-properties" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Energy conservation</strong> (Moyal's formula):
$$\int\int |X_{STFT}(\tau,f)|^2 \, d\tau \, df = \int |x(t)|^2 \, dt$$</p>
</li>
<li>
<p><strong>Time marginal</strong>: $\int S(\tau,f)\,df$ gives the local energy around time $\tau$ (depends on window)</p>
</li>
<li>
<p><strong>Frequency marginal</strong>: $\int S(\tau,f)\,d\tau$ gives the energy spectral density (smeared by window)</p>
</li>
</ol>
<h3 id="43-spectrogram-as-a-smoothed-wigner-ville-distribution">4.3 Spectrogram as a Smoothed Wigner-Ville Distribution<a class="header-link" href="#43-spectrogram-as-a-smoothed-wigner-ville-distribution" title="Permanent link">&para;</a></h3>
<p>The spectrogram can be shown to be a 2D smoothing of the Wigner-Ville distribution (Section 6):</p>
<p>$$S_x(\tau, f) = \iint W_x(t, \nu) \, W_w(\tau - t, f - \nu) \, dt \, d\nu$$</p>
<p>where $W_x$ is the Wigner-Ville distribution of $x$ and $W_w$ is the Wigner-Ville distribution of the window. The window acts as a 2D smoothing kernel, reducing cross-term interference at the cost of resolution.</p>
<hr />
<h2 id="5-window-selection-for-stft">5. Window Selection for STFT<a class="header-link" href="#5-window-selection-for-stft" title="Permanent link">&para;</a></h2>
<h3 id="51-window-properties">5.1 Window Properties<a class="header-link" href="#51-window-properties" title="Permanent link">&para;</a></h3>
<p>The choice of window affects both resolution and spectral leakage:</p>
<table>
<thead>
<tr>
<th>Window</th>
<th>Mainlobe Width (-3dB)</th>
<th>Sidelobe Level</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr>
<td>Rectangular</td>
<td>$0.89/L$</td>
<td>-13 dB</td>
<td>Maximum frequency resolution</td>
</tr>
<tr>
<td>Hann</td>
<td>$1.44/L$</td>
<td>-31 dB</td>
<td>General purpose</td>
</tr>
<tr>
<td>Hamming</td>
<td>$1.33/L$</td>
<td>-43 dB</td>
<td>Spectral analysis</td>
</tr>
<tr>
<td>Blackman</td>
<td>$1.68/L$</td>
<td>-58 dB</td>
<td>Low sidelobe requirements</td>
</tr>
<tr>
<td>Gaussian</td>
<td>$\sim 1.2/L$</td>
<td>varies with $\sigma$</td>
<td>Optimal time-frequency product</td>
</tr>
<tr>
<td>Kaiser</td>
<td>adjustable</td>
<td>adjustable</td>
<td>Flexible design</td>
</tr>
</tbody>
</table>
<h3 id="52-practical-guidelines">5.2 Practical Guidelines<a class="header-link" href="#52-practical-guidelines" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Speech</strong>: Window length 20-40 ms (captures pitch periods), Hamming window, 50% overlap</li>
<li><strong>Music</strong>: Window length 50-100 ms (better frequency resolution for musical notes), Hann window</li>
<li><strong>Transient detection</strong>: Short windows (1-5 ms) for better time resolution</li>
<li><strong>General rule</strong>: Match the window length to the time scale of the features you want to resolve</li>
</ul>
<h3 id="53-zero-padding">5.3 Zero-Padding<a class="header-link" href="#53-zero-padding" title="Permanent link">&para;</a></h3>
<p>Zero-padding the windowed segment before the FFT (using $N > L$) does <strong>not</strong> improve frequency resolution but does provide interpolation in the frequency domain, making the spectrogram appear smoother. The true frequency resolution is always determined by the window length $L$.</p>
<hr />
<h2 id="6-wigner-ville-distribution">6. Wigner-Ville Distribution<a class="header-link" href="#6-wigner-ville-distribution" title="Permanent link">&para;</a></h2>
<h3 id="61-definition">6.1 Definition<a class="header-link" href="#61-definition" title="Permanent link">&para;</a></h3>
<p>The <strong>Wigner-Ville distribution (WVD)</strong> is a quadratic time-frequency distribution:</p>
<p>$$W_x(t, f) = \int_{-\infty}^{\infty} x\!\left(t + \frac{\tau}{2}\right) x^*\!\left(t - \frac{\tau}{2}\right) e^{-j2\pi f\tau} \, d\tau$$</p>
<h3 id="62-properties">6.2 Properties<a class="header-link" href="#62-properties" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Excellent resolution</strong>: The WVD achieves the best possible time-frequency concentration</li>
<li><strong>Correct marginals</strong>:</li>
<li>$\int W_x(t,f)\,df = |x(t)|^2$ (instantaneous power)</li>
<li>$\int W_x(t,f)\,dt = |X(f)|^2$ (power spectral density)</li>
<li><strong>Instantaneous frequency</strong>: For a mono-component signal, the first moment in frequency gives the instantaneous frequency</li>
</ol>
<h3 id="63-the-cross-term-problem">6.3 The Cross-Term Problem<a class="header-link" href="#63-the-cross-term-problem" title="Permanent link">&para;</a></h3>
<p>The WVD is a <strong>bilinear</strong> (quadratic) representation. For a signal with two components $x = x_1 + x_2$:</p>
<p>$$W_x = W_{x_1} + W_{x_2} + 2\Re\{W_{x_1,x_2}\}$$</p>
<p>The cross-term $W_{x_1,x_2}$ creates <strong>oscillating interference patterns</strong> between the true signal components. For $N$ components, there are $N(N-1)/2$ cross-terms, which can overwhelm the true signal content.</p>
<h3 id="64-cohens-class">6.4 Cohen's Class<a class="header-link" href="#64-cohens-class" title="Permanent link">&para;</a></h3>
<p>The <strong>Cohen's class</strong> of distributions provides a general framework for time-frequency representations that satisfy the correct marginal properties:</p>
<p>$$C_x(t, f) = \iiint e^{-j2\pi(\theta\tau + f\nu - \theta u)} \Phi(\theta, \tau) x\!\left(u+\frac{\tau}{2}\right) x^*\!\left(u-\frac{\tau}{2}\right) du \, d\tau \, d\theta$$</p>
<p>where $\Phi(\theta, \tau)$ is the <strong>kernel function</strong>. Different kernels yield different distributions:
- $\Phi = 1$: Wigner-Ville distribution
- $\Phi = $ Gaussian: Smoothed pseudo-Wigner-Ville (reduces cross-terms)
- $\Phi = e^{-\sigma^2 \theta^2 \tau^2}$: Choi-Williams distribution</p>
<hr />
<h2 id="7-introduction-to-wavelet-analysis">7. Introduction to Wavelet Analysis<a class="header-link" href="#7-introduction-to-wavelet-analysis" title="Permanent link">&para;</a></h2>
<h3 id="71-motivation-variable-resolution">7.1 Motivation: Variable Resolution<a class="header-link" href="#71-motivation-variable-resolution" title="Permanent link">&para;</a></h3>
<p>The STFT uses a fixed window, giving the same resolution at all frequencies. But many signals have:
- <strong>High-frequency events</strong> that are short in time (transients, clicks, edges)
- <strong>Low-frequency events</strong> that are long in time (trends, fundamental tones)</p>
<p>We want:
- <strong>Short windows</strong> (good time resolution) at <strong>high frequencies</strong>
- <strong>Long windows</strong> (good frequency resolution) at <strong>low frequencies</strong></p>
<p>This is exactly what the wavelet transform provides.</p>
<h3 id="72-from-stft-to-wavelets">7.2 From STFT to Wavelets<a class="header-link" href="#72-from-stft-to-wavelets" title="Permanent link">&para;</a></h3>
<p>In the STFT, we modulate a fixed window to different frequencies:</p>
<p>$$\text{STFT}: \quad g_{\tau,f}(t) = w(t-\tau) \, e^{j2\pi ft}$$</p>
<p>In the wavelet transform, we <strong>scale</strong> and <strong>translate</strong> a single prototype function (the mother wavelet):</p>
<p>$$\text{CWT}: \quad \psi_{a,b}(t) = \frac{1}{\sqrt{|a|}} \psi\!\left(\frac{t-b}{a}\right)$$</p>
<ul>
<li><strong>Translation</strong> $b$: localizes in time</li>
<li><strong>Scale</strong> $a$: controls the time-frequency resolution</li>
<li>Small $a$: compressed wavelet (short in time, captures high frequencies)</li>
<li>Large $a$: stretched wavelet (long in time, captures low frequencies)</li>
</ul>
<h3 id="73-wavelet-tiling">7.3 Wavelet Tiling<a class="header-link" href="#73-wavelet-tiling" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Wavelet</span><span class="w"> </span><span class="n">Tiling</span><span class="w"> </span><span class="p">(</span><span class="n">variable</span><span class="w"> </span><span class="n">resolution</span><span class="p">):</span>

<span class="n">Frequency</span><span class="w"> </span><span class="err">â–²</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”Œâ”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”œâ”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”´â”¬â”˜</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">High</span><span class="w"> </span><span class="n">freq</span><span class="p">:</span><span class="w"> </span><span class="n">narrow</span><span class="w"> </span><span class="err">Î”</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">wide</span><span class="w"> </span><span class="err">Î”</span><span class="n">f</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¤</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â†</span><span class="w"> </span><span class="n">Mid</span><span class="w"> </span><span class="n">freq</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¤</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â†</span><span class="w"> </span><span class="n">Low</span><span class="w"> </span><span class="n">freq</span><span class="p">:</span><span class="w"> </span><span class="n">wide</span><span class="w"> </span><span class="err">Î”</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">narrow</span><span class="w"> </span><span class="err">Î”</span><span class="n">f</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span><span class="w">        </span><span class="err">â”‚</span>
<span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="w">           </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶</span><span class="w"> </span><span class="n">Time</span>
</code></pre></div>

<p>Each tile has the same area $\Delta t \cdot \Delta f = \text{const}$, but the aspect ratio varies: tall and narrow at high frequencies, short and wide at low frequencies.</p>
<hr />
<h2 id="8-continuous-wavelet-transform-cwt">8. Continuous Wavelet Transform (CWT)<a class="header-link" href="#8-continuous-wavelet-transform-cwt" title="Permanent link">&para;</a></h2>
<h3 id="81-definition">8.1 Definition<a class="header-link" href="#81-definition" title="Permanent link">&para;</a></h3>
<p>The <strong>Continuous Wavelet Transform</strong> of $x(t)$ with mother wavelet $\psi(t)$ is:</p>
<p>$$\boxed{W_x(a, b) = \frac{1}{\sqrt{|a|}} \int_{-\infty}^{\infty} x(t) \, \psi^*\!\left(\frac{t-b}{a}\right) dt}$$</p>
<p>where:
- $a > 0$ is the <strong>scale</strong> parameter (inversely related to frequency)
- $b$ is the <strong>translation</strong> (time shift) parameter
- $\psi^*$ is the complex conjugate of the mother wavelet
- $1/\sqrt{|a|}$ normalizes the energy across scales</p>
<h3 id="82-relationship-between-scale-and-frequency">8.2 Relationship Between Scale and Frequency<a class="header-link" href="#82-relationship-between-scale-and-frequency" title="Permanent link">&para;</a></h3>
<p>For a mother wavelet with center frequency $f_c$, the pseudo-frequency at scale $a$ is:</p>
<p>$$f_a = \frac{f_c}{a}$$</p>
<p>So <strong>large scale</strong> corresponds to <strong>low frequency</strong> and <strong>small scale</strong> to <strong>high frequency</strong>.</p>
<h3 id="83-admissibility-condition">8.3 Admissibility Condition<a class="header-link" href="#83-admissibility-condition" title="Permanent link">&para;</a></h3>
<p>For the CWT to be invertible, the mother wavelet must satisfy the <strong>admissibility condition</strong>:</p>
<p>$$C_\psi = \int_0^{\infty} \frac{|\hat{\Psi}(f)|^2}{f} \, df < \infty$$</p>
<p>where $\hat{\Psi}(f)$ is the Fourier transform of $\psi(t)$. This requires $\hat{\Psi}(0) = 0$, meaning the wavelet must have <strong>zero mean</strong>:</p>
<p>$$\int_{-\infty}^{\infty} \psi(t) \, dt = 0$$</p>
<h3 id="84-inverse-cwt">8.4 Inverse CWT<a class="header-link" href="#84-inverse-cwt" title="Permanent link">&para;</a></h3>
<p>The signal can be reconstructed from its CWT:</p>
<p>$$x(t) = \frac{1}{C_\psi} \int_0^{\infty} \int_{-\infty}^{\infty} W_x(a,b) \, \frac{1}{\sqrt{a}} \psi\!\left(\frac{t-b}{a}\right) \frac{db \, da}{a^2}$$</p>
<h3 id="85-scalogram">8.5 Scalogram<a class="header-link" href="#85-scalogram" title="Permanent link">&para;</a></h3>
<p>The <strong>scalogram</strong> is the wavelet analogue of the spectrogram:</p>
<p>$$\text{Scalogram}(a, b) = |W_x(a, b)|^2$$</p>
<hr />
<h2 id="9-mother-wavelets">9. Mother Wavelets<a class="header-link" href="#9-mother-wavelets" title="Permanent link">&para;</a></h2>
<h3 id="91-haar-wavelet">9.1 Haar Wavelet<a class="header-link" href="#91-haar-wavelet" title="Permanent link">&para;</a></h3>
<p>The simplest wavelet, proposed by Alfred Haar in 1909:</p>
<p>$$\psi_{Haar}(t) = \begin{cases} 1 & 0 \leq t < 1/2 \\ -1 & 1/2 \leq t < 1 \\ 0 & \text{otherwise} \end{cases}$$</p>
<p><strong>Properties</strong>:
- Compact support (finite duration)
- Discontinuous (poor frequency localization)
- One vanishing moment: $\int t^0 \psi(t)\,dt = 0$
- Good for detecting sharp transitions and edges</p>
<h3 id="92-morlet-wavelet">9.2 Morlet Wavelet<a class="header-link" href="#92-morlet-wavelet" title="Permanent link">&para;</a></h3>
<p>A complex wavelet consisting of a complex exponential modulated by a Gaussian:</p>
<p>$$\psi_{Morlet}(t) = C_\sigma \, \pi^{-1/4} \, e^{j\omega_0 t} \, e^{-t^2/2}$$</p>
<p>where $\omega_0$ (typically $\omega_0 \approx 5$ or $2\pi$) is the center frequency and $C_\sigma$ is a normalization constant.</p>
<p><strong>Properties</strong>:
- Complex-valued (provides both amplitude and phase)
- Infinite support (but effectively finite due to Gaussian decay)
- Excellent time-frequency localization (Gaussian envelope)
- No compact support, no orthogonality
- Most commonly used for continuous wavelet analysis</p>
<h3 id="93-mexican-hat-wavelet-ricker-wavelet">9.3 Mexican Hat Wavelet (Ricker Wavelet)<a class="header-link" href="#93-mexican-hat-wavelet-ricker-wavelet" title="Permanent link">&para;</a></h3>
<p>The negative normalized second derivative of a Gaussian:</p>
<p>$$\psi_{mhat}(t) = \frac{2}{\sqrt{3}\pi^{1/4}} (1 - t^2) \, e^{-t^2/2}$$</p>
<p><strong>Properties</strong>:
- Real-valued, symmetric
- Two vanishing moments: $\int t^k \psi(t)\,dt = 0$ for $k = 0, 1$
- Related to the Laplacian of Gaussian (LoG) used in image processing
- Good for detecting peaks and valleys</p>
<h3 id="94-daubechies-wavelets">9.4 Daubechies Wavelets<a class="header-link" href="#94-daubechies-wavelets" title="Permanent link">&para;</a></h3>
<p>Ingrid Daubechies (1988) constructed a family of wavelets $\psi_{Db-N}$ with $N$ vanishing moments and compact support of length $2N - 1$:</p>
<ul>
<li><strong>Db1</strong> = Haar wavelet</li>
<li><strong>Db2</strong>: Support length 3, 2 vanishing moments</li>
<li><strong>Db4</strong>: Support length 7, 4 vanishing moments (commonly used)</li>
<li><strong>Db10</strong>: Support length 19, 10 vanishing moments</li>
</ul>
<p><strong>Properties</strong>:
- Orthogonal and compactly supported
- No closed-form expression (defined by filter coefficients)
- Higher $N$: smoother wavelet, longer support, better frequency localization
- The only orthogonal wavelets with compact support and maximum vanishing moments</p>
<h3 id="95-other-important-wavelets">9.5 Other Important Wavelets<a class="header-link" href="#95-other-important-wavelets" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Wavelet</th>
<th>Type</th>
<th>Key Feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>Symlets (sym$N$)</td>
<td>Orthogonal</td>
<td>Near-symmetric version of Daubechies</td>
</tr>
<tr>
<td>Coiflets (coif$N$)</td>
<td>Orthogonal</td>
<td>Near-symmetric, vanishing moments in both $\psi$ and $\phi$</td>
</tr>
<tr>
<td>Meyer</td>
<td>Orthogonal</td>
<td>Defined in frequency domain, infinitely smooth</td>
</tr>
<tr>
<td>Shannon</td>
<td>Orthogonal</td>
<td>Ideal bandpass, sinc-based</td>
</tr>
<tr>
<td>Gabor</td>
<td>Non-orthogonal</td>
<td>Gaussian-modulated sinusoid</td>
</tr>
<tr>
<td>Paul</td>
<td>Complex</td>
<td>Analytic, good time localization</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="10-multiresolution-analysis-mra">10. Multiresolution Analysis (MRA)<a class="header-link" href="#10-multiresolution-analysis-mra" title="Permanent link">&para;</a></h2>
<h3 id="101-concept">10.1 Concept<a class="header-link" href="#101-concept" title="Permanent link">&para;</a></h3>
<p>Multiresolution analysis, introduced by Mallat (1989) and Meyer, provides the mathematical framework for the DWT. The idea is to decompose a signal into successive <strong>approximations</strong> at different resolutions, with <strong>detail</strong> captured at each level.</p>
<p>Think of looking at a landscape:
- <strong>Coarse resolution</strong>: See mountains and valleys
- <strong>Medium resolution</strong>: See individual trees and buildings
- <strong>Fine resolution</strong>: See leaves and bricks</p>
<h3 id="102-nested-approximation-spaces">10.2 Nested Approximation Spaces<a class="header-link" href="#102-nested-approximation-spaces" title="Permanent link">&para;</a></h3>
<p>An MRA consists of a nested sequence of closed subspaces of $L^2(\mathbb{R})$:</p>
<p>$$\cdots \subset V_{-2} \subset V_{-1} \subset V_0 \subset V_1 \subset V_2 \subset \cdots$$</p>
<p>satisfying:
1. <strong>Nesting</strong>: $V_j \subset V_{j+1}$
2. <strong>Density</strong>: $\overline{\bigcup_j V_j} = L^2(\mathbb{R})$
3. <strong>Separation</strong>: $\bigcap_j V_j = \{0\}$
4. <strong>Scaling</strong>: $f(t) \in V_j \Leftrightarrow f(2t) \in V_{j+1}$
5. <strong>Shift invariance</strong>: $f(t) \in V_0 \Leftrightarrow f(t-k) \in V_0$ for all $k \in \mathbb{Z}$
6. <strong>Riesz basis</strong>: There exists a <strong>scaling function</strong> $\phi(t)$ such that $\{\phi(t-k)\}_{k \in \mathbb{Z}}$ forms a Riesz basis for $V_0$</p>
<h3 id="103-scaling-function-and-wavelet-function">10.3 Scaling Function and Wavelet Function<a class="header-link" href="#103-scaling-function-and-wavelet-function" title="Permanent link">&para;</a></h3>
<p>The <strong>scaling function</strong> (father wavelet) $\phi(t)$ satisfies the <strong>refinement equation</strong> (dilation equation):</p>
<p>$$\phi(t) = \sqrt{2} \sum_k h[k] \, \phi(2t - k)$$</p>
<p>where $h[k]$ are the <strong>scaling coefficients</strong> (lowpass filter).</p>
<p>The <strong>wavelet function</strong> $\psi(t)$ is defined by:</p>
<p>$$\psi(t) = \sqrt{2} \sum_k g[k] \, \phi(2t - k)$$</p>
<p>where $g[k] = (-1)^k h[1-k]$ are the <strong>wavelet coefficients</strong> (highpass filter, related to $h$ by the quadrature mirror relationship).</p>
<h3 id="104-detail-spaces">10.4 Detail Spaces<a class="header-link" href="#104-detail-spaces" title="Permanent link">&para;</a></h3>
<p>The <strong>detail space</strong> $W_j$ is the orthogonal complement of $V_j$ in $V_{j+1}$:</p>
<p>$$V_{j+1} = V_j \oplus W_j$$</p>
<p>The wavelets at scale $j$ span $W_j$:</p>
<p>$$W_j = \text{span}\{\psi_{j,k}(t) = 2^{j/2}\psi(2^j t - k)\}_{k \in \mathbb{Z}}$$</p>
<p>Signal decomposition:</p>
<p>$$V_J = V_0 \oplus W_0 \oplus W_1 \oplus \cdots \oplus W_{J-1}$$</p>
<p>$$f(t) = \sum_k c_{0,k}\phi_{0,k}(t) + \sum_{j=0}^{J-1}\sum_k d_{j,k}\psi_{j,k}(t)$$</p>
<p>where $c_{j,k}$ are <strong>approximation coefficients</strong> and $d_{j,k}$ are <strong>detail coefficients</strong>.</p>
<hr />
<h2 id="11-discrete-wavelet-transform-dwt">11. Discrete Wavelet Transform (DWT)<a class="header-link" href="#11-discrete-wavelet-transform-dwt" title="Permanent link">&para;</a></h2>
<h3 id="111-dyadic-sampling">11.1 Dyadic Sampling<a class="header-link" href="#111-dyadic-sampling" title="Permanent link">&para;</a></h3>
<p>The CWT is highly redundant: it computes coefficients at all scales $a$ and translations $b$. The DWT samples on a <strong>dyadic grid</strong>:</p>
<p>$$a = 2^j, \quad b = k \cdot 2^j$$</p>
<p>giving:</p>
<p>$$W_x(j, k) = 2^{-j/2} \int x(t) \, \psi(2^{-j}t - k) \, dt$$</p>
<h3 id="112-connection-to-filter-banks">11.2 Connection to Filter Banks<a class="header-link" href="#112-connection-to-filter-banks" title="Permanent link">&para;</a></h3>
<p>The DWT can be computed efficiently using a pair of filters:
- <strong>Lowpass filter</strong> $h[n]$: associated with the scaling function $\phi$
- <strong>Highpass filter</strong> $g[n]$: associated with the wavelet $\psi$</p>
<p>These form a <strong>quadrature mirror filter (QMF)</strong> bank:</p>
<p>$$g[n] = (-1)^n h[1-n]$$</p>
<p><strong>Perfect reconstruction</strong> conditions:
$$H(z)H(z^{-1}) + H(-z)H(-z^{-1}) = 2$$</p>
<h3 id="113-analysis-and-synthesis">11.3 Analysis and Synthesis<a class="header-link" href="#113-analysis-and-synthesis" title="Permanent link">&para;</a></h3>
<p><strong>Analysis</strong> (decomposition):
- Approximation coefficients: $c_{j+1}[k] = \sum_n h[n-2k] \, c_j[n]$ (lowpass filter + downsample by 2)
- Detail coefficients: $d_{j+1}[k] = \sum_n g[n-2k] \, c_j[n]$ (highpass filter + downsample by 2)</p>
<p><strong>Synthesis</strong> (reconstruction):
- $c_j[n] = \sum_k c_{j+1}[k] \, h[n-2k] + \sum_k d_{j+1}[k] \, g[n-2k]$ (upsample by 2 + filter + sum)</p>
<hr />
<h2 id="12-mallats-algorithm">12. Mallat's Algorithm<a class="header-link" href="#12-mallats-algorithm" title="Permanent link">&para;</a></h2>
<h3 id="121-the-fast-wavelet-transform">12.1 The Fast Wavelet Transform<a class="header-link" href="#121-the-fast-wavelet-transform" title="Permanent link">&para;</a></h3>
<p>Mallat's algorithm computes the DWT using iterated filter banks, analogous to how the FFT computes the DFT. The computational cost is $O(N)$ -- even faster than the FFT!</p>
<div class="highlight"><pre><span></span><code><span class="n">Mallat</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="p">(</span><span class="n">Analysis</span><span class="o">/</span><span class="n">Decomposition</span><span class="p">)</span><span class="err">:</span>

<span class="k">Level</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w">  </span><span class="n">câ‚€</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">original</span><span class="w"> </span><span class="n">signal</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="n">samples</span><span class="p">)</span>
<span class="w">              </span><span class="err">â”‚</span>
<span class="w">              </span><span class="err">â”œâ”€â”€â”€â”€</span><span class="w"> </span><span class="n">h</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">câ‚</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">approximation</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">samples</span><span class="p">)</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”œâ”€â”€â”€â”€</span><span class="w"> </span><span class="n">h</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">câ‚‚</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”œâ”€â”€â”€â”€</span><span class="w"> </span><span class="n">h</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="err">â”€â”€â–¶â†“</span><span class="mi">2</span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">câ‚ƒ</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â””â”€â”€â”€â”€</span><span class="w"> </span><span class="n">g</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="err">â”€â”€â–¶â†“</span><span class="mi">2</span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">dâ‚ƒ</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="w">              </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â””â”€â”€â”€â”€</span><span class="w"> </span><span class="n">g</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">dâ‚‚</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">detail</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="w">              </span><span class="err">â”‚</span>
<span class="w">              </span><span class="err">â””â”€â”€â”€â”€</span><span class="w"> </span><span class="n">g</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†“</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">dâ‚</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">detail</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">samples</span><span class="p">)</span>
</code></pre></div>

<h3 id="122-reconstruction-synthesis">12.2 Reconstruction (Synthesis)<a class="header-link" href="#122-reconstruction-synthesis" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Mallat</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="p">(</span><span class="n">Synthesis</span><span class="o">/</span><span class="n">Reconstruction</span><span class="p">)</span><span class="err">:</span>

<span class="n">câ‚ƒ</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">h</span><span class="err">Ìƒ</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â”</span>
<span class="w">                         </span><span class="err">â”œâ”€â”€â–¶</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">câ‚‚</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">h</span><span class="err">Ìƒ</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â”</span>
<span class="n">dâ‚ƒ</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">g</span><span class="err">Ìƒ</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â”˜</span><span class="w">                                     </span><span class="err">â”œâ”€â”€â–¶</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">câ‚</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="p">...</span>
<span class="w">                                   </span><span class="n">dâ‚‚</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="err">â†‘</span><span class="mi">2</span><span class="w"> </span><span class="err">â”€â”€â–¶</span><span class="w"> </span><span class="n">g</span><span class="err">Ìƒ</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="err">â”€â”€â”˜</span>
</code></pre></div>

<h3 id="123-computational-complexity">12.3 Computational Complexity<a class="header-link" href="#123-computational-complexity" title="Permanent link">&para;</a></h3>
<p>For a signal of length $N$ and $J$ decomposition levels:
- Each level: $O(N/2^j)$ operations (filter + downsample)
- Total: $O(N) + O(N/2) + O(N/4) + \cdots = O(2N) = O(N)$</p>
<p>Compare with:
- FFT: $O(N \log N)$
- STFT: $O(N \cdot L \cdot \log L)$ where $L$ is the window length</p>
<hr />
<h2 id="13-wavelet-decomposition-and-reconstruction">13. Wavelet Decomposition and Reconstruction<a class="header-link" href="#13-wavelet-decomposition-and-reconstruction" title="Permanent link">&para;</a></h2>
<h3 id="131-multi-level-decomposition">13.1 Multi-Level Decomposition<a class="header-link" href="#131-multi-level-decomposition" title="Permanent link">&para;</a></h3>
<p>At decomposition level $J$, the signal is represented as:</p>
<p>$$x[n] = \underbrace{c_J[k]}_{\text{coarse approx.}} + \underbrace{d_J[k]}_{\text{finest detail lost}} + d_{J-1}[k] + \cdots + d_1[k]$$</p>
<p>Each level of detail coefficients captures a specific frequency band:
- $d_1$: highest frequencies ($f_s/4$ to $f_s/2$)
- $d_2$: next band ($f_s/8$ to $f_s/4$)
- $d_j$: band ($f_s/2^{j+1}$ to $f_s/2^j$)
- $c_J$: lowest frequencies (0 to $f_s/2^{J+1}$)</p>
<h3 id="132-wavelet-denoising-thresholding">13.2 Wavelet Denoising (Thresholding)<a class="header-link" href="#132-wavelet-denoising-thresholding" title="Permanent link">&para;</a></h3>
<p>One of the most powerful applications of the DWT is <strong>denoising by thresholding</strong>:</p>
<ol>
<li>Compute the DWT of the noisy signal</li>
<li>Apply a threshold to the detail coefficients</li>
<li>Reconstruct using the inverse DWT</li>
</ol>
<p><strong>Hard thresholding</strong>:
$$\hat{d}[k] = \begin{cases} d[k] & |d[k]| \geq \lambda \\ 0 & |d[k]| < \lambda \end{cases}$$</p>
<p><strong>Soft thresholding</strong> (shrinkage):
$$\hat{d}[k] = \text{sgn}(d[k]) \max(|d[k]| - \lambda, 0)$$</p>
<p><strong>Universal threshold</strong> (Donoho and Johnstone, 1994):
$$\lambda = \sigma \sqrt{2 \ln N}$$</p>
<p>where $\sigma$ is the noise standard deviation, estimated from the finest detail level:
$$\hat{\sigma} = \frac{\text{median}(|d_1|)}{0.6745}$$</p>
<h3 id="133-choosing-the-number-of-levels">13.3 Choosing the Number of Levels<a class="header-link" href="#133-choosing-the-number-of-levels" title="Permanent link">&para;</a></h3>
<p>The maximum number of decomposition levels for a signal of length $N$ with filter length $L$ is:</p>
<p>$$J_{max} = \lfloor \log_2(N / (L-1)) \rfloor$$</p>
<p>In practice, 3-6 levels suffice for most applications.</p>
<hr />
<h2 id="14-stft-vs-wavelet-transform">14. STFT vs Wavelet Transform<a class="header-link" href="#14-stft-vs-wavelet-transform" title="Permanent link">&para;</a></h2>
<h3 id="141-resolution-comparison">14.1 Resolution Comparison<a class="header-link" href="#141-resolution-comparison" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>STFT</th>
<th>Wavelet Transform</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time-frequency tiling</td>
<td>Uniform rectangles</td>
<td>Variable (dyadic)</td>
</tr>
<tr>
<td>Low-frequency resolution</td>
<td>Same as high freq</td>
<td>Better frequency resolution</td>
</tr>
<tr>
<td>High-frequency resolution</td>
<td>Same as low freq</td>
<td>Better time resolution</td>
</tr>
<tr>
<td>Basis functions</td>
<td>Modulated windows</td>
<td>Scaled/translated wavelets</td>
</tr>
<tr>
<td>Computation (discrete)</td>
<td>$O(N \log N)$ per frame</td>
<td>$O(N)$ total</td>
</tr>
<tr>
<td>Redundancy (continuous)</td>
<td>High (depends on overlap)</td>
<td>High (CWT) or critical (DWT)</td>
</tr>
<tr>
<td>Phase information</td>
<td>Yes (complex STFT)</td>
<td>Depends on wavelet</td>
</tr>
<tr>
<td>Invertibility</td>
<td>Yes (COLA condition)</td>
<td>Yes (admissibility)</td>
</tr>
</tbody>
</table>
<h3 id="142-when-to-use-what">14.2 When to Use What<a class="header-link" href="#142-when-to-use-what" title="Permanent link">&para;</a></h3>
<p><strong>Use STFT/Spectrogram when:</strong>
- The signal has relatively uniform time-frequency characteristics
- You need constant frequency resolution across all frequencies
- Musical pitch analysis (equal frequency bins match musical perception)
- The signal is well-described by sinusoidal components</p>
<p><strong>Use Wavelet Transform when:</strong>
- The signal has both transient and slowly-varying components
- Different frequency bands require different time resolutions
- You need to detect singularities or sharp transitions
- Denoising is the primary goal
- Multi-scale analysis is needed (fractals, turbulence)</p>
<h3 id="143-comparison-for-a-chirp-signal">14.3 Comparison for a Chirp Signal<a class="header-link" href="#143-comparison-for-a-chirp-signal" title="Permanent link">&para;</a></h3>
<p>For a linear chirp $x(t) = \cos(2\pi(f_0 t + \frac{\beta}{2}t^2))$:</p>
<ul>
<li><strong>STFT</strong>: Shows a straight line in the time-frequency plane, but the line width is constant (determined by the window)</li>
<li><strong>Wavelet</strong>: Shows a curve (since scale $\neq$ frequency linearly), but with better time resolution at high frequencies and better frequency resolution at low frequencies</li>
</ul>
<hr />
<h2 id="15-applications">15. Applications<a class="header-link" href="#15-applications" title="Permanent link">&para;</a></h2>
<h3 id="151-music-and-audio-analysis">15.1 Music and Audio Analysis<a class="header-link" href="#151-music-and-audio-analysis" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Spectrogram</strong>: Fundamental tool for music information retrieval, showing melody, harmonics, and rhythm</li>
<li><strong>Constant-Q Transform</strong> (CQT): Wavelet-like transform with logarithmic frequency spacing matching musical scales</li>
<li><strong>Onset detection</strong>: Wavelet analysis detects note onsets (transients) with good time precision</li>
<li><strong>Pitch tracking</strong>: STFT with harmonic analysis</li>
</ul>
<h3 id="152-biomedical-signal-processing">15.2 Biomedical Signal Processing<a class="header-link" href="#152-biomedical-signal-processing" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ECG analysis</strong>: Wavelet decomposition separates QRS complex (high freq) from baseline wander (low freq)</li>
<li><strong>EEG spectral analysis</strong>: STFT reveals alpha (8-12 Hz), beta (12-30 Hz), and gamma (&gt;30 Hz) rhythms over time</li>
<li><strong>EMG processing</strong>: Time-frequency analysis of muscle activation patterns</li>
</ul>
<h3 id="153-vibration-analysis-and-fault-detection">15.3 Vibration Analysis and Fault Detection<a class="header-link" href="#153-vibration-analysis-and-fault-detection" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Bearing fault detection</strong>: Wavelet decomposition reveals periodic impulses hidden in noise</li>
<li><strong>Rotating machinery</strong>: Order tracking with time-frequency analysis</li>
<li><strong>Structural health monitoring</strong>: Wavelet-based damage detection in bridges and buildings</li>
</ul>
<h3 id="154-geophysics-and-seismology">15.4 Geophysics and Seismology<a class="header-link" href="#154-geophysics-and-seismology" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Seismic event detection</strong>: Multi-scale wavelet analysis separates local and teleseismic events</li>
<li><strong>Dispersion analysis</strong>: Group velocity measurement using wavelet transforms</li>
<li><strong>Time-frequency filtering</strong>: Remove specific time-frequency regions of interference</li>
</ul>
<h3 id="155-image-processing">15.5 Image Processing<a class="header-link" href="#155-image-processing" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Wavelet compression</strong>: JPEG2000 uses the DWT (Daubechies 9/7 or Le Gall 5/3 wavelets)</li>
<li><strong>Edge detection</strong>: Wavelet maxima correspond to edges at different scales</li>
<li><strong>Texture analysis</strong>: Wavelet energy in different sub-bands characterizes textures</li>
</ul>
<hr />
<h2 id="16-python-implementation">16. Python Implementation<a class="header-link" href="#16-python-implementation" title="Permanent link">&para;</a></h2>
<h3 id="161-stft-and-spectrogram">16.1 STFT and Spectrogram<a class="header-link" href="#161-stft-and-spectrogram" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span> <span class="k">as</span> <span class="n">sig</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_stft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">window_length</span><span class="p">,</span> <span class="n">hop_size</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the Short-Time Fourier Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        Input signal</span>
<span class="sd">    fs : float</span>
<span class="sd">        Sampling frequency</span>
<span class="sd">    window_length : int</span>
<span class="sd">        Window length in samples</span>
<span class="sd">    hop_size : int</span>
<span class="sd">        Hop size in samples</span>
<span class="sd">    nfft : int</span>
<span class="sd">        FFT size (zero-padded if &gt; window_length)</span>
<span class="sd">    window : str</span>
<span class="sd">        Window type</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    t : ndarray</span>
<span class="sd">        Time axis</span>
<span class="sd">    f : ndarray</span>
<span class="sd">        Frequency axis</span>
<span class="sd">    Zxx : ndarray</span>
<span class="sd">        STFT matrix (frequency x time)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">nfft</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nfft</span> <span class="o">=</span> <span class="n">window_length</span>

    <span class="c1"># Create window</span>
    <span class="n">win</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">get_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">window_length</span><span class="p">)</span>

    <span class="c1"># Number of frames</span>
    <span class="n">n_frames</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_length</span><span class="p">)</span> <span class="o">//</span> <span class="n">hop_size</span>

    <span class="c1"># STFT matrix</span>
    <span class="n">Zxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">hop_size</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">start</span> <span class="o">+</span> <span class="n">window_length</span><span class="p">]</span> <span class="o">*</span> <span class="n">win</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span>
        <span class="n">Zxx</span><span class="p">[:,</span> <span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">spectrum</span>

    <span class="c1"># Time and frequency axes</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span> <span class="o">*</span> <span class="n">hop_size</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">nfft</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Zxx</span>


<span class="c1"># Generate test signal: chirp + impulse</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Linear chirp from 50 Hz to 400 Hz</span>
<span class="n">chirp</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">f1</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="c1"># Add impulses at specific times</span>
<span class="n">impulse_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t_imp</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]:</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_imp</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">impulse_signal</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Combined signal</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">chirp</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">impulse_signal</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># Compute spectrograms with different window lengths</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Time-domain signal</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Signal: Chirp + Impulses&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Short window (good time resolution)</span>
<span class="n">window_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Short Window (32 samples)&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium Window (128 samples)&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Long Window (512 samples)&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">window_lengths</span><span class="p">,</span> <span class="n">titles</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">f_stft</span><span class="p">,</span> <span class="n">t_stft</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">wl</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_stft</span><span class="p">,</span> <span class="n">f_stft</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">),</span>
                  <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Spectrogram: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;stft_resolution_tradeoff.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="162-wavelet-analysis-with-pywavelets">16.2 Wavelet Analysis with PyWavelets<a class="header-link" href="#162-wavelet-analysis-with-pywavelets" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pywt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="c1"># Generate a non-stationary signal</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Signal with time-varying frequency content</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x</span><span class="p">[:</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">t</span><span class="p">[:</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">])</span>           <span class="c1"># 10 Hz</span>
<span class="n">x</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>   <span class="c1"># 50 Hz</span>
<span class="n">x</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># 100 Hz</span>
<span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">//</span><span class="mi">4</span><span class="p">:])</span>      <span class="c1"># 200 Hz</span>

<span class="c1"># Add some noise</span>
<span class="n">x</span> <span class="o">+=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># --- Continuous Wavelet Transform (CWT) ---</span>
<span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">wavelet</span> <span class="o">=</span> <span class="s1">&#39;cmor1.5-1.0&#39;</span>  <span class="c1"># Complex Morlet wavelet</span>
<span class="n">coefficients</span><span class="p">,</span> <span class="n">frequencies</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">cwt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">sampling_period</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Time domain</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Non-stationary Signal (10â†’50â†’100â†’200 Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># CWT scalogram</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coefficients</span><span class="p">),</span>
                         <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;CWT Scalogram (Morlet Wavelet)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;|CWT|&#39;</span><span class="p">)</span>

<span class="c1"># Compare with STFT spectrogram</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span> <span class="k">as</span> <span class="n">sig</span>
<span class="n">f_stft</span><span class="p">,</span> <span class="n">t_stft</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_stft</span><span class="p">,</span> <span class="n">f_stft</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">),</span>
                   <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;STFT Spectrogram (128-sample Hann window)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cwt_vs_stft.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="163-discrete-wavelet-transform-dwt-and-denoising">16.3 Discrete Wavelet Transform (DWT) and Denoising<a class="header-link" href="#163-discrete-wavelet-transform-dwt-and-denoising" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pywt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="c1"># Create a clean signal</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">clean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">50</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Add noise</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">noisy</span> <span class="o">=</span> <span class="n">clean</span> <span class="o">+</span> <span class="n">noise_level</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="c1"># DWT decomposition</span>
<span class="n">wavelet</span> <span class="o">=</span> <span class="s1">&#39;db4&#39;</span>
<span class="n">level</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">wavedec</span><span class="p">(</span><span class="n">noisy</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>

<span class="c1"># Estimate noise level from finest detail coefficients</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">/</span> <span class="mf">0.6745</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated noise std: </span><span class="si">{</span><span class="n">sigma</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (true: </span><span class="si">{</span><span class="n">noise_level</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Apply soft thresholding</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">noisy</span><span class="p">)))</span>  <span class="c1"># Universal threshold</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Threshold: </span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">coeffs_thresh</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Keep approximation coefficients</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)):</span>
    <span class="n">coeffs_thresh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pywt</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">))</span>

<span class="c1"># Reconstruct</span>
<span class="n">denoised</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">waverec</span><span class="p">(</span><span class="n">coeffs_thresh</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">)</span>
<span class="n">denoised</span> <span class="o">=</span> <span class="n">denoised</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>  <span class="c1"># Trim to original length</span>

<span class="c1"># Plot results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">clean</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Clean Signal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">noisy</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Noisy Signal (SNR = </span><span class="si">{</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span><span class="o">/</span><span class="n">noise_level</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> dB)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">denoised</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Denoised Signal (Wavelet Soft Thresholding, db4)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">clean</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Clean&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">denoised</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Denoised&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparison: Clean vs Denoised&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wavelet_denoising.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Compute SNR improvement</span>
<span class="n">snr_noisy</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">clean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">noisy</span> <span class="o">-</span> <span class="n">clean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">snr_denoised</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">clean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">denoised</span> <span class="o">-</span> <span class="n">clean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SNR (noisy):    </span><span class="si">{</span><span class="n">snr_noisy</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SNR (denoised): </span><span class="si">{</span><span class="n">snr_denoised</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SNR improvement: </span><span class="si">{</span><span class="n">snr_denoised</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">snr_noisy</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dB&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="164-dwt-decomposition-visualization">16.4 DWT Decomposition Visualization<a class="header-link" href="#164-dwt-decomposition-visualization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pywt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="c1"># Generate signal with multi-scale features</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Low frequency trend + medium frequency oscillation + high frequency bursts</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>                      <span class="c1"># 2 Hz trend</span>
     <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">30</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>                           <span class="c1"># 30 Hz oscillation</span>
     <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">150</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># 150 Hz burst</span>
     <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>                      <span class="c1"># noise</span>

<span class="c1"># Multi-level DWT decomposition</span>
<span class="n">wavelet</span> <span class="o">=</span> <span class="s1">&#39;db4&#39;</span>
<span class="n">level</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">wavedec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>

<span class="c1"># Reconstruct individual components</span>
<span class="n">details</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Zero out all coefficients except the i-th detail</span>
    <span class="n">c_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
    <span class="n">c_temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">detail_i</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">waverec</span><span class="p">(</span><span class="n">c_temp</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">)[:</span><span class="n">N</span><span class="p">]</span>
    <span class="n">details</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">detail_i</span><span class="p">)</span>

<span class="c1"># Approximation</span>
<span class="n">c_approx</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
<span class="n">approx</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">waverec</span><span class="p">(</span><span class="n">c_approx</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">)[:</span><span class="n">N</span><span class="p">]</span>

<span class="c1"># Plot decomposition</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">level</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DWT Decomposition (</span><span class="si">{</span><span class="n">wavelet</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s1"> levels)&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">freq_band</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;0-</span><span class="si">{</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">level</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_band</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span>
                 <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">detail</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">details</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">detail</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;orange&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">level_idx</span> <span class="o">=</span> <span class="n">level</span> <span class="o">-</span> <span class="n">i</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;D</span><span class="si">{</span><span class="n">level_idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">low_f</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">level_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">high_f</span> <span class="o">=</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="n">level_idx</span>
    <span class="n">freq_band</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">low_f</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">high_f</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_band</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dwt_decomposition.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="165-manual-cwt-implementation">16.5 Manual CWT Implementation<a class="header-link" href="#165-manual-cwt-implementation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="k">def</span><span class="w"> </span><span class="nf">morlet_wavelet</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Morlet wavelet (simplified, without correction term).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">manual_cwt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manual CWT implementation using convolution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        Input signal</span>
<span class="sd">    scales : ndarray</span>
<span class="sd">        Array of scales</span>
<span class="sd">    dt : float</span>
<span class="sd">        Sampling period</span>
<span class="sd">    omega0 : float</span>
<span class="sd">        Center frequency of Morlet wavelet</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    W : ndarray</span>
<span class="sd">        CWT coefficient matrix (n_scales x N)</span>
<span class="sd">    freqs : ndarray</span>
<span class="sd">        Pseudo-frequencies corresponding to each scale</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n_scales</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_scales</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">scale</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scales</span><span class="p">):</span>
        <span class="c1"># Create wavelet at this scale</span>
        <span class="c1"># Wavelet support: we need enough points to capture the wavelet</span>
        <span class="n">M</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">scale</span> <span class="o">/</span> <span class="n">dt</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">t_wav</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">wavelet</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span> <span class="o">*</span> <span class="n">morlet_wavelet</span><span class="p">(</span><span class="n">t_wav</span> <span class="o">/</span> <span class="n">scale</span><span class="p">,</span> <span class="n">omega0</span><span class="p">)</span>
        <span class="n">wavelet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>  <span class="c1"># Conjugate for cross-correlation</span>

        <span class="c1"># Convolve (cross-correlate)</span>
        <span class="n">conv_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">conv_result</span>

    <span class="c1"># Pseudo-frequencies</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">omega0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">scales</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">W</span><span class="p">,</span> <span class="n">freqs</span>


<span class="c1"># Test with a chirp signal</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="c1"># Chirp from 5 Hz to 100 Hz</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mf">47.5</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

<span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">W</span><span class="p">,</span> <span class="n">freqs</span> <span class="o">=</span> <span class="n">manual_cwt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chirp Signal (5 Hz to 100 Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Manual CWT Scalogram (Morlet)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;|W(a,b)|&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;manual_cwt.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="17-exercises">17. Exercises<a class="header-link" href="#17-exercises" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-stft-resolution-tradeoff">Exercise 1: STFT Resolution Tradeoff<a class="header-link" href="#exercise-1-stft-resolution-tradeoff" title="Permanent link">&para;</a></h3>
<p>Generate a signal consisting of two simultaneous sinusoids at 100 Hz and 105 Hz (very close in frequency) that each last for 0.5 seconds, followed by 0.5 seconds of silence.</p>
<p>(a) Compute and display the spectrogram with window lengths of 32, 64, 128, 256, and 512 samples ($f_s = 1000$ Hz).</p>
<p>(b) For each window length, determine whether the two frequencies are resolved (i.e., show as separate peaks). What is the minimum window length needed?</p>
<p>(c) Add a sharp click at $t = 0.3$ s. For which window lengths can you identify both the click's timing and the two frequencies?</p>
<p>(d) Verify the uncertainty principle: compute $\Delta t$ and $\Delta f$ for each window and check that $\Delta t \cdot \Delta f \geq 1/(4\pi)$.</p>
<h3 id="exercise-2-window-comparison">Exercise 2: Window Comparison<a class="header-link" href="#exercise-2-window-comparison" title="Permanent link">&para;</a></h3>
<p>Using a signal with a known chirp (50 to 200 Hz over 1 second, $f_s = 1000$ Hz):</p>
<p>(a) Compute spectrograms using Rectangular, Hann, Hamming, Blackman, and Gaussian windows (all length 128).</p>
<p>(b) Compare the spectral leakage visible in each spectrogram. Which window produces the cleanest chirp trajectory?</p>
<p>(c) For each window, measure the -3 dB mainlobe width and the highest sidelobe level.</p>
<h3 id="exercise-3-wavelet-families">Exercise 3: Wavelet Families<a class="header-link" href="#exercise-3-wavelet-families" title="Permanent link">&para;</a></h3>
<p>(a) Plot the scaling function $\phi(t)$ and wavelet function $\psi(t)$ for Haar, db4, db8, sym4, and coif2 wavelets (use <code>pywt.Wavelet(...).wavefun(level=8)</code>).</p>
<p>(b) Compute and plot the frequency response of the associated decomposition filters $h[n]$ and $g[n]$.</p>
<p>(c) For each wavelet, decompose the test signal from Exercise 1 and compare the time-frequency resolution.</p>
<p>(d) Which wavelet best resolves the two close sinusoids? Which best localizes the click?</p>
<h3 id="exercise-4-wavelet-denoising">Exercise 4: Wavelet Denoising<a class="header-link" href="#exercise-4-wavelet-denoising" title="Permanent link">&para;</a></h3>
<p>Generate a signal $x(t) = \text{sign}(\sin(2\pi \cdot 3 \cdot t))$ (square wave at 3 Hz) corrupted by Gaussian noise at SNR = 5 dB.</p>
<p>(a) Apply wavelet denoising with hard and soft thresholding using the universal threshold. Compare the results.</p>
<p>(b) Try different wavelets (Haar, db4, sym8) and compare the denoising quality (SNR).</p>
<p>(c) Vary the number of decomposition levels from 1 to 8. Plot the output SNR vs level number.</p>
<p>(d) Compare with a simple lowpass filter. Under what conditions does wavelet denoising outperform frequency-domain filtering?</p>
<h3 id="exercise-5-cwt-vs-dwt">Exercise 5: CWT vs DWT<a class="header-link" href="#exercise-5-cwt-vs-dwt" title="Permanent link">&para;</a></h3>
<p>For a signal composed of:
- A 5 Hz sinusoid for the full duration
- A 50 Hz burst from $t = 0.3$ to $t = 0.5$ s
- A 200 Hz burst from $t = 0.7$ to $t = 0.72$ s (very short)</p>
<p>(a) Compute the CWT using the Morlet wavelet and display the scalogram.</p>
<p>(b) Compute a 6-level DWT using db4 and display the decomposition.</p>
<p>(c) Which representation better localizes the 200 Hz burst in time? Why?</p>
<p>(d) Which representation better separates the 5 Hz and 50 Hz components in frequency? Why?</p>
<h3 id="exercise-6-music-analysis">Exercise 6: Music Analysis<a class="header-link" href="#exercise-6-music-analysis" title="Permanent link">&para;</a></h3>
<p>Load or synthesize a short musical passage (e.g., a piano scale: C4, D4, E4, F4, G4, A4, B4, C5, each note lasting 0.25 seconds).</p>
<p>(a) Compute and display the spectrogram. Can you identify each note and its harmonics?</p>
<p>(b) Compute the CWT and display the scalogram. Compare with the spectrogram.</p>
<p>(c) Implement a simple note detector by finding the fundamental frequency in each time frame.</p>
<p>(d) Compute the constant-Q transform (CQT) using logarithmically spaced frequency bins. How does it compare with the linear-frequency spectrogram for music analysis?</p>
<h3 id="exercise-7-wigner-ville-distribution">Exercise 7: Wigner-Ville Distribution<a class="header-link" href="#exercise-7-wigner-ville-distribution" title="Permanent link">&para;</a></h3>
<p>(a) Implement the discrete Wigner-Ville distribution for a single-component linear chirp. Verify that the WVD shows a clean, narrow line.</p>
<p>(b) Now compute the WVD for the sum of two linear chirps (one increasing, one decreasing in frequency). Identify the cross-terms. Where do they appear in the time-frequency plane?</p>
<p>(c) Apply a smoothing kernel to the WVD (smoothed pseudo-Wigner-Ville) and show that the cross-terms are reduced but the resolution degrades.</p>
<hr />
<h2 id="18-summary">18. Summary<a class="header-link" href="#18-summary" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Key Formula / Idea</th>
</tr>
</thead>
<tbody>
<tr>
<td>STFT</td>
<td>$X(\tau,f) = \int x(t)w(t-\tau)e^{-j2\pi ft}dt$</td>
</tr>
<tr>
<td>Spectrogram</td>
<td>$S(\tau,f) = |X_{STFT}(\tau,f)|^2$</td>
</tr>
<tr>
<td>Uncertainty principle</td>
<td>$\Delta t \cdot \Delta f \geq 1/(4\pi)$</td>
</tr>
<tr>
<td>CWT</td>
<td>$W(a,b) = \frac{1}{\sqrt{a}}\int x(t)\psi^*(\frac{t-b}{a})dt$</td>
</tr>
<tr>
<td>Scale-frequency relation</td>
<td>$f_a = f_c / a$</td>
</tr>
<tr>
<td>Admissibility</td>
<td>$\int\psi(t)dt = 0$ (zero mean)</td>
</tr>
<tr>
<td>Refinement equation</td>
<td>$\phi(t) = \sqrt{2}\sum_k h[k]\phi(2t-k)$</td>
</tr>
<tr>
<td>QMF relation</td>
<td>$g[n] = (-1)^n h[1-n]$</td>
</tr>
<tr>
<td>DWT computation</td>
<td>Mallat's algorithm: $O(N)$</td>
</tr>
<tr>
<td>Denoising threshold</td>
<td>$\lambda = \sigma\sqrt{2\ln N}$ (universal)</td>
</tr>
<tr>
<td>Noise estimation</td>
<td>$\hat{\sigma} = \text{median}(|d_1|)/0.6745$</td>
</tr>
</tbody>
</table>
<p><strong>Key takeaways</strong>:
1. The Fourier transform gives global frequency information; STFT and wavelets add temporal localization.
2. The uncertainty principle sets a fundamental limit on joint time-frequency resolution.
3. The STFT uses a fixed window, giving uniform resolution -- good for signals with consistent characteristics.
4. Wavelets use variable resolution: narrow windows at high frequencies, wide at low frequencies.
5. The DWT via Mallat's algorithm is computationally efficient ($O(N)$) and produces a non-redundant representation.
6. Wavelet denoising by thresholding is a powerful, principled approach to noise removal.
7. The choice between STFT and wavelets depends on the signal structure and the analysis goal.</p>
<hr />
<h2 id="19-references">19. References<a class="header-link" href="#19-references" title="Permanent link">&para;</a></h2>
<ol>
<li>S. Mallat, <em>A Wavelet Tour of Signal Processing</em>, 3rd ed., Academic Press, 2009.</li>
<li>I. Daubechies, <em>Ten Lectures on Wavelets</em>, SIAM, 1992.</li>
<li>L. Cohen, <em>Time-Frequency Analysis</em>, Prentice Hall, 1995.</li>
<li>C.K. Chui, <em>An Introduction to Wavelets</em>, Academic Press, 1992.</li>
<li>D.L. Donoho and I.M. Johnstone, "Ideal spatial adaptation by wavelet shrinkage," <em>Biometrika</em>, vol. 81, pp. 425-455, 1994.</li>
<li>A. Boggess and F.J. Narcowich, <em>A First Course in Wavelets with Fourier Analysis</em>, 2nd ed., Wiley, 2009.</li>
<li>M. Vetterli and J. Kovacevic, <em>Wavelets and Subband Coding</em>, Prentice Hall, 1995.</li>
</ol>
<hr />
<p><strong>Previous</strong>: <a href="./13_Adaptive_Filters.md">13. Adaptive Filters</a> | <strong>Next</strong>: <a href="./15_Image_Signal_Processing.md">15. Image Signal Processing</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/Signal_Processing/13_Adaptive_Filters.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. Adaptive Filters</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/Signal_Processing/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/Signal_Processing/15_Image_Signal_Processing.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. Image Signal Processing</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}