{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distributed Systems Concepts - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/System_Design/">System Design</a>
    <span class="separator">/</span>
    <span class="current">Distributed Systems Concepts</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Distributed Systems Concepts</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/System_Design/14_Microservices_Patterns.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Microservices Patterns</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/System_Design/16_Consensus_Algorithms.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Consensus Algorithms</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-the-8-fallacies-of-distributed-computing">1. The 8 Fallacies of Distributed Computing</a><ul>
<li><a href="#fallacies-of-distributed-computing">Fallacies of Distributed Computing</a></li>
</ul>
</li>
<li><a href="#2-time-and-ordering">2. Time and Ordering</a><ul>
<li><a href="#problems-with-physical-clocks">Problems with Physical Clocks</a></li>
<li><a href="#happens-before-relationship">Happens-Before Relationship</a></li>
</ul>
</li>
<li><a href="#3-logical-clocks">3. Logical Clocks</a><ul>
<li><a href="#lamport-clock">Lamport Clock</a></li>
<li><a href="#vector-clock">Vector Clock</a></li>
<li><a href="#logical-clock-comparison">Logical Clock Comparison</a></li>
<li><a href="#practical-usage-example">Practical Usage Example</a></li>
</ul>
</li>
<li><a href="#4-leader-election">4. Leader Election</a><ul>
<li><a href="#why-is-leader-election-needed">Why Is Leader Election Needed?</a></li>
<li><a href="#bully-algorithm">Bully Algorithm</a></li>
<li><a href="#ring-algorithm">Ring Algorithm</a></li>
<li><a href="#modern-leader-election">Modern Leader Election</a></li>
</ul>
</li>
<li><a href="#5-distributed-systems-challenges">5. Distributed Systems Challenges</a><ul>
<li><a href="#network-partition">Network Partition</a></li>
<li><a href="#partial-failure">Partial Failure</a></li>
<li><a href="#byzantine-failure">Byzantine Failure</a></li>
</ul>
</li>
<li><a href="#6-practice-problems">6. Practice Problems</a><ul>
<li><a href="#exercise-1-lamport-clock-calculation">Exercise 1: Lamport Clock Calculation</a></li>
<li><a href="#exercise-2-vector-clock-analysis">Exercise 2: Vector Clock Analysis</a></li>
<li><a href="#exercise-3-leader-election-design">Exercise 3: Leader Election Design</a></li>
</ul>
</li>
<li><a href="#next-steps">Next Steps</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="distributed-systems-concepts">Distributed Systems Concepts<a class="header-link" href="#distributed-systems-concepts" title="Permanent link">&para;</a></h1>
<p>Difficulty: â­â­â­â­</p>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>A distributed system is multiple computers connected via a network that cooperate to function as a single system. In this chapter, we'll learn about the fundamental challenges of distributed systems, the concept of time, and leader election algorithms.</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-the-8-fallacies-of-distributed-computing">The 8 Fallacies of Distributed Computing</a></li>
<li><a href="#2-time-and-ordering">Time and Ordering</a></li>
<li><a href="#3-logical-clocks">Logical Clocks</a></li>
<li><a href="#4-leader-election">Leader Election</a></li>
<li><a href="#5-distributed-systems-challenges">Distributed Systems Challenges</a></li>
<li><a href="#6-practice-problems">Practice Problems</a></li>
</ol>
<hr />
<h2 id="1-the-8-fallacies-of-distributed-computing">1. The 8 Fallacies of Distributed Computing<a class="header-link" href="#1-the-8-fallacies-of-distributed-computing" title="Permanent link">&para;</a></h2>
<h3 id="fallacies-of-distributed-computing">Fallacies of Distributed Computing<a class="header-link" href="#fallacies-of-distributed-computing" title="Permanent link">&para;</a></h3>
<p>These are common false assumptions that distributed system beginners often make.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">              </span><span class="n">The</span><span class="w"> </span><span class="mh">8</span><span class="w"> </span><span class="n">Fallacies</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Distributed</span><span class="w"> </span><span class="n">Computing</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reliable</span><span class="w">                                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Reality:</span><span class="w">                                                       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Packet</span><span class="w"> </span><span class="n">loss</span><span class="w">                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Network</span><span class="w"> </span><span class="n">partitions</span><span class="w">                                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Switch</span><span class="o">/</span><span class="n">router</span><span class="w"> </span><span class="n">failures</span><span class="w">                                       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Node</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">â”€â”€â”€</span><span class="n">X</span><span class="err">â”€â”€â”€â–º</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="n">B</span><span class="w">                                         </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">         </span><span class="n">Packet</span><span class="w"> </span><span class="n">loss</span><span class="w">                                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Mitigation:</span><span class="w"> </span><span class="n">Retries</span><span class="p">,</span><span class="w"> </span><span class="n">timeouts</span><span class="p">,</span><span class="w"> </span><span class="n">idempotency</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">Latency</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">zero</span><span class="w">                                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Reality:</span><span class="w">                                                       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="nl">call:</span><span class="w"> </span><span class="o">~</span><span class="mh">10</span><span class="w"> </span><span class="n">ns</span><span class="w">                                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Same</span><span class="w"> </span><span class="nl">DC:</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="n">ms</span><span class="w">                                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Cross</span><span class="o">-</span><span class="nl">continent:</span><span class="w"> </span><span class="mh">100</span><span class="o">+</span><span class="w"> </span><span class="n">ms</span><span class="w">                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Seoul</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w"> </span><span class="n">US</span><span class="w"> </span><span class="n">West</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">         </span><span class="o">~</span><span class="mh">150</span><span class="n">ms</span><span class="w"> </span><span class="n">RTT</span><span class="w">                                               </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Mitigation:</span><span class="w"> </span><span class="n">Caching</span><span class="p">,</span><span class="w"> </span><span class="n">async</span><span class="w"> </span><span class="n">processing</span><span class="p">,</span><span class="w"> </span><span class="n">regional</span><span class="w"> </span><span class="n">distribution</span><span class="w">   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">Bandwidth</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">infinite</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Reality:</span><span class="w">                                                       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Network</span><span class="w"> </span><span class="n">congestion</span><span class="w">                                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Bandwidth</span><span class="w"> </span><span class="n">limits</span><span class="w">                                             </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Cost</span><span class="w">                                                         </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Mitigation:</span><span class="w"> </span><span class="n">Compression</span><span class="p">,</span><span class="w"> </span><span class="n">pagination</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">locality</span><span class="w">             </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">secure</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Reality:</span><span class="w">                                                       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Man</span><span class="o">-</span><span class="n">in</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">middle</span><span class="w"> </span><span class="n">attacks</span><span class="w">                                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Packet</span><span class="w"> </span><span class="n">sniffing</span><span class="w">                                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">Malicious</span><span class="w"> </span><span class="n">nodes</span><span class="w">                                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nl">Mitigation:</span><span class="w"> </span><span class="n">TLS</span><span class="p">,</span><span class="w"> </span><span class="n">authentication</span><span class="p">,</span><span class="w"> </span><span class="n">encryption</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              The 8 Fallacies of Distributed Computing (cont.)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  5. Topology doesn&#39;t change                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Reality:                                                       â”‚   â”‚
â”‚  â”‚  - Server additions/removals                                    â”‚   â”‚
â”‚  â”‚  - Failure recovery                                             â”‚   â”‚
â”‚  â”‚  - Scaling                                                      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Mitigation: Service discovery, dynamic configuration          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  6. There is one administrator                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Reality:                                                       â”‚   â”‚
â”‚  â”‚  - Multiple teams, multiple organizations                       â”‚   â”‚
â”‚  â”‚  - Different policies                                           â”‚   â”‚
â”‚  â”‚  - Cloud + on-premises                                          â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Mitigation: Standardization, automation, governance            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  7. Transport cost is zero                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Reality:                                                       â”‚   â”‚
â”‚  â”‚  - Cloud egress costs                                           â”‚   â”‚
â”‚  â”‚  - Serialization/deserialization overhead                       â”‚   â”‚
â”‚  â”‚  - Network equipment costs                                      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Mitigation: Data locality, efficient protocols                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  8. The network is homogeneous                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Reality:                                                       â”‚   â”‚
â”‚  â”‚  - Various hardware                                             â”‚   â”‚
â”‚  â”‚  - Various protocols                                            â”‚   â”‚
â”‚  â”‚  - Legacy systems                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Mitigation: Standard protocols, abstraction layers             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-time-and-ordering">2. Time and Ordering<a class="header-link" href="#2-time-and-ordering" title="Permanent link">&para;</a></h2>
<h3 id="problems-with-physical-clocks">Problems with Physical Clocks<a class="header-link" href="#problems-with-physical-clocks" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Physical Clocks                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Problem 1: Clock Drift                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Time â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º     â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Real time: â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Node A:    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚   â”‚
â”‚  â”‚              (slightly fast)                                     â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Node B:    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚   â”‚
â”‚  â”‚              (slightly slow)                                     â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Typical drift: 10-100 microseconds per second                  â”‚   â”‚
â”‚  â”‚  â†’ Difference of several seconds per day!                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  Problem 2: NTP Synchronization Limitations                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  - Typical accuracy: tens of milliseconds                       â”‚   â”‚
â”‚  â”‚  - Internet environment: 100ms+ error possible                  â”‚   â”‚
â”‚  â”‚  - Time jumps possible (forward/backward)                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  NTP Server â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Node                                   â”‚   â”‚
â”‚  â”‚              Network delay                                       â”‚   â”‚
â”‚  â”‚              causes error                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  Problem 3: Dangers of Timestamp-Based Ordering                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Node A (clock fast):  Write X=1 at T=100                       â”‚   â”‚
â”‚  â”‚  Node B (clock slow):  Write X=2 at T=99                        â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Sorted by timestamp: X=2 (T=99) â†’ X=1 (T=100)                  â”‚   â”‚
â”‚  â”‚  Actual order: X=1 first â†’ X=2 later                            â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â†’ Wrong order! Possible data loss!                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="happens-before-relationship">Happens-Before Relationship<a class="header-link" href="#happens-before-relationship" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                     </span><span class="nv">Happens</span><span class="o">-</span><span class="nv">Before</span><span class="w"> </span><span class="nv">Relationship</span><span class="w">                         </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                                         </span>â”‚
â”‚<span class="w">  </span><span class="nv">Definition</span>:<span class="w"> </span><span class="nv">a</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="ss">(</span><span class="nv">a</span><span class="w"> </span><span class="nv">happens</span><span class="o">-</span><span class="nv">before</span><span class="w"> </span><span class="nv">b</span><span class="ss">)</span><span class="w">                                </span>â”‚
â”‚<span class="w">                                                                         </span>â”‚
â”‚<span class="w">  </span><span class="mi">1</span>.<span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">occurs</span><span class="w"> </span><span class="nv">before</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">same</span><span class="w"> </span><span class="nv">process</span><span class="w">                           </span>â”‚
â”‚<span class="w">  </span><span class="mi">2</span>.<span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="k">send</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">message</span><span class="err">&#39;s receipt             â”‚</span>
<span class="err">â”‚  3. Transitivity: a â†’ b âˆ§ b â†’ c âŸ¹ a â†’ c                                â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  Process P1:  â”€â”€â”€â”€â”€â—aâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—câ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º      â”‚   â”‚</span>
<span class="err">â”‚  â”‚                    â”‚              â–²                              â”‚   â”‚</span>
<span class="err">â”‚  â”‚                    â”‚              â”‚                              â”‚   â”‚</span>
<span class="err">â”‚  â”‚                    â–¼ (message)    â”‚ (message)                    â”‚   â”‚</span>
<span class="err">â”‚  â”‚                    â”‚              â”‚                              â”‚   â”‚</span>
<span class="err">â”‚  â”‚  Process P2:  â”€â”€â”€â”€â”€â”€â”€â”€â”€â—bâ”€â”€â”€â”€â”€â”€â”€â”€â”€â—dâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º      â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  Relationships:                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - a â†’ b (message send)                                          â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - b â†’ d (same process)                                          â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - a â†’ c (same process)                                          â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - d â†’ c (message send)                                          â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - a â†’ d (transitivity: a â†’ b â†’ d)                               â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â”‚  Concurrency:                                                          â”‚</span>
<span class="err">â”‚  If neither a â†’ b nor b â†’ a, then a and b are concurrent              â”‚</span>
<span class="err">â”‚  Denoted as a âˆ¥ b                                                      â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚</span>
<span class="err">â”‚  â”‚  P1:  â”€â”€â”€â”€â”€â—aâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º          â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  P2:  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—bâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º          â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  a and b have no causal relationship â†’ undefined order           â”‚   â”‚</span>
<span class="err">â”‚  â”‚  â†’ concurrent (a âˆ¥ b)                                            â”‚   â”‚</span>
<span class="err">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="3-logical-clocks">3. Logical Clocks<a class="header-link" href="#3-logical-clocks" title="Permanent link">&para;</a></h2>
<h3 id="lamport-clock">Lamport Clock<a class="header-link" href="#lamport-clock" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="nx">Lamport</span><span class="w"> </span><span class="nx">Clock</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Rules</span><span class="p">:</span><span class="w">                                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Each</span><span class="w"> </span><span class="nx">process</span><span class="w"> </span><span class="nx">maintains</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">counter</span><span class="w"> </span><span class="nx">C</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">On</span><span class="w"> </span><span class="nx">event</span><span class="p">:</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">On</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="nx">send</span><span class="p">:</span><span class="w"> </span><span class="nx">include</span><span class="w"> </span><span class="nx">current</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">message</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="nx">On</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="nx">receive</span><span class="p">:</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">max</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">C</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">Process</span><span class="w"> </span><span class="nx">A</span><span class="p">:</span><span class="w">  </span><span class="err">â”€â—â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w">          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="w">          </span><span class="mi">1</span><span class="w">       </span><span class="mi">2</span><span class="w">               </span><span class="mi">5</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â–²</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">msg</span><span class="p">(</span><span class="nx">C</span><span class="p">=</span><span class="mi">2</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">msg</span><span class="p">(</span><span class="nx">C</span><span class="p">=</span><span class="mi">4</span><span class="p">)</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â–¼</span><span class="w">               </span><span class="err">â”‚</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">Process</span><span class="w"> </span><span class="nx">B</span><span class="p">:</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w">          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="p">(</span><span class="nx">C</span><span class="p">)</span><span class="w">                  </span><span class="mi">3</span><span class="w">       </span><span class="mi">4</span><span class="w">       </span><span class="mi">5</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â–²</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">B</span><span class="w"> </span><span class="nx">receives</span><span class="w"> </span><span class="nx">msg</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">A</span><span class="p">:</span><span class="w">      </span><span class="nx">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">B</span><span class="w"> </span><span class="nx">local</span><span class="w"> </span><span class="nx">event</span><span class="p">:</span><span class="w">              </span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">B</span><span class="w"> </span><span class="nx">sends</span><span class="w"> </span><span class="nx">msg</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">A</span><span class="p">:</span><span class="w">           </span><span class="mi">4</span><span class="w"> </span><span class="p">(</span><span class="k">in</span><span class="w"> </span><span class="nx">message</span><span class="p">)</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="nx">A</span><span class="w"> </span><span class="nx">receives</span><span class="w"> </span><span class="nx">msg</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">B</span><span class="p">:</span><span class="w">      </span><span class="nx">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Properties</span><span class="p">:</span><span class="w">                                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="err">âŸ¹</span><span class="w"> </span><span class="nx">C</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">C</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="w">    </span><span class="p">(</span><span class="nx">causality</span><span class="w"> </span><span class="nx">implies</span><span class="w"> </span><span class="nx">clock</span><span class="w"> </span><span class="nx">order</span><span class="p">)</span><span class="w">           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">âœ—</span><span class="w"> </span><span class="nx">C</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">C</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="err">âŸ¹</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">b</span><span class="w">    </span><span class="p">(</span><span class="nx">converse</span><span class="w"> </span><span class="nx">doesn</span><span class="err">&#39;</span><span class="nx">t</span><span class="w"> </span><span class="nx">hold</span><span class="p">!)</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nx">Limitations</span><span class="p">:</span><span class="w">                                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Cannot</span><span class="w"> </span><span class="nx">distinguish</span><span class="w"> </span><span class="nx">concurrent</span><span class="w"> </span><span class="nx">events</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nx">Same</span><span class="w"> </span><span class="nx">counter</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">possible</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="vector-clock">Vector Clock<a class="header-link" href="#vector-clock" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="n">Vector</span><span class="w"> </span><span class="n">Clock</span><span class="w">                                        </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Rules</span><span class="p">:</span><span class="w">                                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">Each</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">maintains</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">V</span><span class="o">[</span><span class="n">1..N</span><span class="o">]</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">processes</span><span class="p">)</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="nl">event</span><span class="p">:</span><span class="w"> </span><span class="n">V</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">V</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="nl">send</span><span class="p">:</span><span class="w"> </span><span class="k">include</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">V</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="nl">receive</span><span class="p">:</span><span class="w"> </span><span class="n">V</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">V</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">V</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="o">[</span><span class="n">i</span><span class="o">]++</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Process</span><span class="w"> </span><span class="nl">A</span><span class="p">:</span><span class="w">  </span><span class="err">â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w">          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">V</span><span class="w">           </span><span class="o">[</span><span class="n">1,0,0</span><span class="o">]</span><span class="w">  </span><span class="o">[</span><span class="n">2,0,0</span><span class="o">]</span><span class="w">           </span><span class="o">[</span><span class="n">3,2,1</span><span class="o">]</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">                   </span><span class="err">â–²</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">                   </span><span class="err">â”‚</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">[</span><span class="n">2,2,1</span><span class="o">]</span><span class="w">         </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â–¼</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Process</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w">          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">V</span><span class="w">                  </span><span class="o">[</span><span class="n">2,1,0</span><span class="o">]</span><span class="w">   </span><span class="o">[</span><span class="n">2,2,0</span><span class="o">]</span><span class="w">   </span><span class="o">[</span><span class="n">2,2,1</span><span class="o">]</span><span class="w">                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â–²</span><span class="w">         </span><span class="err">â”‚</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">[</span><span class="n">2,2,0</span><span class="o">]</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">         </span><span class="err">â–¼</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Process</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="w">  </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w">          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">V</span><span class="w">                  </span><span class="o">[</span><span class="n">0,0,1</span><span class="o">]</span><span class="w">   </span><span class="o">[</span><span class="n">2,2,1</span><span class="o">]</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Comparison</span><span class="w"> </span><span class="nl">Rules</span><span class="p">:</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">V1</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="nl">V2</span><span class="p">:</span><span class="w"> </span><span class="n">V1</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="n">V2</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">i</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">V1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nl">V2</span><span class="p">:</span><span class="w"> </span><span class="n">V1</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="n">V2</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">V1</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="n">V2</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">V1</span><span class="w"> </span><span class="err">âˆ¥</span><span class="w"> </span><span class="nl">V2</span><span class="p">:</span><span class="w"> </span><span class="n">neither</span><span class="w"> </span><span class="n">V1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">V2</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">V2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">V1</span><span class="w"> </span><span class="p">(</span><span class="n">concurrent</span><span class="p">)</span><span class="w">                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Examples</span><span class="p">:</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">[</span><span class="n">2,0,0</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">[</span><span class="n">2,2,0</span><span class="o">]</span><span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="p">(</span><span class="n">happens</span><span class="o">-</span><span class="k">before</span><span class="p">)</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">[</span><span class="n">2,1,0</span><span class="o">]</span><span class="w"> </span><span class="err">âˆ¥</span><span class="w"> </span><span class="o">[</span><span class="n">0,0,1</span><span class="o">]</span><span class="w">  </span><span class="err">âœ“</span><span class="w"> </span><span class="p">(</span><span class="n">concurrent</span><span class="p">)</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Pros</span><span class="p">:</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="n">detect</span><span class="w"> </span><span class="n">concurrent</span><span class="w"> </span><span class="n">events</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Cons</span><span class="p">:</span><span class="w"> </span><span class="n">Vector</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="p">(</span><span class="n">scalability</span><span class="w"> </span><span class="n">issue</span><span class="p">)</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="logical-clock-comparison">Logical Clock Comparison<a class="header-link" href="#logical-clock-comparison" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Lamport Clock</th>
<th>Vector Clock</th>
</tr>
</thead>
<tbody>
<tr>
<td>Size</td>
<td>1 integer</td>
<td>N integers</td>
</tr>
<tr>
<td>Causality detection</td>
<td>Partial</td>
<td>Complete</td>
</tr>
<tr>
<td>Concurrency detection</td>
<td>Not possible</td>
<td>Possible</td>
</tr>
<tr>
<td>Scalability</td>
<td>Excellent</td>
<td>Limited</td>
</tr>
<tr>
<td>Implementation complexity</td>
<td>Simple</td>
<td>Medium</td>
</tr>
</tbody>
</table>
<h3 id="practical-usage-example">Practical Usage Example<a class="header-link" href="#practical-usage-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="n">Vector</span><span class="w"> </span><span class="n">Clock</span><span class="w"> </span><span class="k">Usage</span><span class="w"> </span><span class="nl">Example</span><span class="p">:</span><span class="w"> </span><span class="n">DynamoDB</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Conflict</span><span class="w"> </span><span class="n">Detection</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nl">Resolution</span><span class="p">:</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Initial</span><span class="w"> </span><span class="k">state</span><span class="err">:</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">1,0</span><span class="o">]</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Replica</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">  </span><span class="k">Write</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;B&quot;</span><span class="w">  </span><span class="err">â†’</span><span class="w">  </span><span class="n">V</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">2,0</span><span class="o">]</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Replica</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">  </span><span class="k">Write</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;C&quot;</span><span class="w">  </span><span class="err">â†’</span><span class="w">  </span><span class="n">V</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">1,1</span><span class="o">]</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="k">At</span><span class="w"> </span><span class="nl">synchronization</span><span class="p">:</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="o">[</span><span class="n">2,0</span><span class="o">]</span><span class="w"> </span><span class="err">âˆ¥</span><span class="w"> </span><span class="o">[</span><span class="n">1,1</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">concurrent</span><span class="w"> </span><span class="n">writes</span><span class="err">!</span><span class="p">)</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Resolution</span><span class="w"> </span><span class="nl">methods</span><span class="p">:</span><span class="w">                                            </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="k">Last</span><span class="o">-</span><span class="k">Write</span><span class="o">-</span><span class="n">Wins</span><span class="w"> </span><span class="p">(</span><span class="nc">timestamp</span><span class="p">)</span><span class="w">                                 </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="k">Return</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">resolution</span><span class="w">                             </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="n">Application</span><span class="o">-</span><span class="n">defined</span><span class="w"> </span><span class="k">merge</span><span class="w">                                   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Example</span><span class="p">:</span><span class="w"> </span><span class="n">Shopping</span><span class="w"> </span><span class="n">cart</span><span class="w"> </span><span class="k">merge</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Client</span><span class="w"> </span><span class="k">reads</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">item1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">item2</span><span class="o">]</span><span class="w">  </span><span class="p">(</span><span class="n">two</span><span class="w"> </span><span class="n">versions</span><span class="p">)</span><span class="w">                 </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Client</span><span class="w"> </span><span class="nl">merges</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">item1, item2</span><span class="o">]</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">Client</span><span class="w"> </span><span class="nl">writes</span><span class="p">:</span><span class="w"> </span><span class="n">merged</span><span class="w"> </span><span class="k">result</span><span class="w">                                   </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="4-leader-election">4. Leader Election<a class="header-link" href="#4-leader-election" title="Permanent link">&para;</a></h2>
<h3 id="why-is-leader-election-needed">Why Is Leader Election Needed?<a class="header-link" href="#why-is-leader-election-needed" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Leader Election                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Why is it needed?                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Cases where a coordinator role is needed in distributed systems:â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  - Distributed lock management                                  â”‚   â”‚
â”‚  â”‚  - Proposer in consensus algorithms                             â”‚   â”‚
â”‚  â”‚  - Database primary node                                        â”‚   â”‚
â”‚  â”‚  - Distributed job scheduling                                   â”‚   â”‚
â”‚  â”‚  - Message ordering                                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚   â”‚
â”‚  â”‚  â”‚ Node 1  â”‚  â”‚ Node 2  â”‚  â”‚ Node 3  â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚(Leader) â”‚  â”‚(Followerâ”‚  â”‚(Followerâ”‚                          â”‚   â”‚
â”‚  â”‚  â”‚    â˜…    â”‚  â”‚         â”‚  â”‚         â”‚                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â”‚       â”‚            â”‚            â”‚                                â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚   â”‚
â”‚  â”‚                    â”‚                                             â”‚   â”‚
â”‚  â”‚               Coordination/Sync                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  Requirements:                                                         â”‚
â”‚  1. Safety: At most 1 leader at any time                              â”‚
â”‚  2. Liveness: Eventually a leader is elected                          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="bully-algorithm">Bully Algorithm<a class="header-link" href="#bully-algorithm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                     </span><span class="nv">Bully</span><span class="w"> </span><span class="nv">Algorithm</span><span class="w">                                     </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                                         </span>â”‚
â”‚<span class="w">  </span><span class="nv">Rule</span>:<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">node</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">highest</span><span class="w"> </span><span class="nv">ID</span><span class="w"> </span><span class="nv">becomes</span><span class="w"> </span><span class="nv">leader</span><span class="w">                     </span>â”‚
â”‚<span class="w">                                                                         </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Initial</span><span class="w"> </span><span class="nv">state</span>:<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">leader</span><span class="w">                                </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">3</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">4</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="ss">(</span><span class="nv">Leader</span><span class="ss">)</span><span class="w">            </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">    </span>â”‚<span class="w">        </span>â”‚<span class="w">        </span>â”‚<span class="w">        </span>â”‚<span class="w">         </span>âœ—<span class="w"> </span><span class="ss">(</span><span class="nv">failure</span><span class="ss">)</span><span class="w">             </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">    </span>â”‚<span class="w">        </span>â”‚<span class="w">        </span>â”‚<span class="w">        </span>â”‚<span class="w">                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Step</span><span class="w"> </span><span class="mi">1</span>:<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">detects</span><span class="w"> </span><span class="nv">leader</span><span class="w"> </span><span class="nv">failure</span><span class="w">                          </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">                                   </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span>â†’<span class="w"> </span><span class="s2">&quot;ELECTION&quot;</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span>,<span class="w"> </span><span class="mi">5</span><span class="w">                             </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Step</span><span class="w"> </span><span class="mi">2</span>:<span class="w"> </span><span class="nv">Higher</span><span class="w"> </span><span class="nv">IDs</span><span class="w"> </span><span class="nv">respond</span><span class="w">                                     </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">                                   </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span>â†’<span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="ss">(</span><span class="nv">higher</span><span class="w"> </span><span class="nv">ID</span><span class="w"> </span><span class="nv">exists</span><span class="ss">)</span><span class="w">                     </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span>â†’<span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">2</span><span class="w">                                         </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span>â†’<span class="w"> </span><span class="ss">(</span><span class="nv">no</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="w">                                         </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Step</span><span class="w"> </span><span class="mi">3</span>:<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">also</span><span class="w"> </span><span class="nv">start</span><span class="w"> </span><span class="nv">elections</span><span class="w">                         </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">                                   </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span>â†’<span class="w"> </span><span class="s2">&quot;ELECTION&quot;</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">4</span>,<span class="w"> </span><span class="mi">5</span><span class="w">                                </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span>â†’<span class="w"> </span><span class="s2">&quot;ELECTION&quot;</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">5</span><span class="w">                                   </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Step</span><span class="w"> </span><span class="mi">4</span>:<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">becomes</span><span class="w"> </span><span class="nv">winner</span><span class="w">                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="w">                                   </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span>â†’<span class="w"> </span><span class="s2">&quot;COORDINATOR&quot;</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">All</span><span class="w">                                   </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">  </span><span class="nv">Node</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">3</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="ss">(</span><span class="nv">Leader</span><span class="ss">)</span><span class="w">   </span><span class="nv">Node</span><span class="w"> </span><span class="mi">5</span><span class="w">            </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                               </span>â˜…<span class="w">                  </span>âœ—<span class="w">              </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w">                                                                  </span>â”‚<span class="w">   </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">   </span>â”‚
â”‚<span class="w">                                                                         </span>â”‚
â”‚<span class="w">  </span><span class="nv">Complexity</span>:<span class="w"> </span><span class="nv">O</span><span class="ss">(</span><span class="nv">n</span>Â²<span class="ss">)</span><span class="w"> </span><span class="nv">messages</span><span class="w">                                            </span>â”‚
â”‚<span class="w">                                                                         </span>â”‚
â”‚<span class="w">  </span><span class="nv">Problems</span>:<span class="w">                                                             </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Split</span><span class="o">-</span><span class="nv">Brain</span><span class="w"> </span><span class="nv">possible</span><span class="w"> </span><span class="nv">during</span><span class="w"> </span><span class="nv">network</span><span class="w"> </span><span class="nv">partition</span><span class="w">                       </span>â”‚
â”‚<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nv">Repeated</span><span class="w"> </span><span class="nv">elections</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">highest</span><span class="w"> </span><span class="nv">ID</span><span class="w"> </span><span class="nv">node</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">unstable</span><span class="w">                  </span>â”‚
â”‚<span class="w">                                                                         </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="ring-algorithm">Ring Algorithm<a class="header-link" href="#ring-algorithm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                     </span><span class="n">Ring</span><span class="w"> </span><span class="n">Algorithm</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">Structure</span><span class="err">:</span><span class="w"> </span><span class="n">Nodes</span><span class="w"> </span><span class="n">arranged</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">logical</span><span class="w"> </span><span class="n">ring</span><span class="w">                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â”‚</span><span class="n">Node</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                    </span><span class="err">â””â”€â”€â”€â”¬â”€â”€â”€â”˜</span><span class="w">                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w"> </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â–¼</span><span class="w">                   </span><span class="err">â–¼</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">           </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="n">Node</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚</span><span class="n">Node</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â””â”€â”€â”€â”¬â”€â”€â”€â”˜</span><span class="w">           </span><span class="err">â””â”€â”€â”€â”¬â”€â”€â”€â”˜</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â”‚</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">               </span><span class="err">â–¼</span><span class="w">                   </span><span class="err">â–¼</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">           </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â”‚</span><span class="n">Node</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚</span><span class="n">Node</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">â”‚</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">           </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">           </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Election</span><span class="w"> </span><span class="nl">Process</span><span class="p">:</span><span class="w">                                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="n">leader</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="n">detection</span><span class="p">,</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">election</span><span class="w"> </span><span class="nl">message</span><span class="p">:</span><span class="w">       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">[</span><span class="n">initiator_id</span><span class="o">]</span><span class="w">                                              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">Forward</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="nl">ID</span><span class="p">:</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Node</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">3</span><span class="o">]</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="mi">3</span><span class="w">                                        </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Node</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">3, 4</span><span class="o">]</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="mi">4</span><span class="w">                                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Node</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">3, 4, 5</span><span class="o">]</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="mi">5</span><span class="w">                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Node</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">3, 4, 5, 1</span><span class="o">]</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="mi">1</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="n">Node</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">3, 4, 5, 1, 2</span><span class="o">]</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="mi">2</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mf">3.</span><span class="w"> </span><span class="k">When</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="nl">point</span><span class="p">:</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="k">Select</span><span class="w"> </span><span class="n">highest</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="nl">list</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="n">Propagate</span><span class="w"> </span><span class="n">COORDINATOR</span><span class="w"> </span><span class="nl">message</span><span class="p">:</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">leader</span><span class="w">           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">                                                                  </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Complexity</span><span class="p">:</span><span class="w"> </span><span class="n">O</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="n">messages</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Pros</span><span class="p">:</span><span class="w"> </span><span class="n">Fewer</span><span class="w"> </span><span class="n">messages</span><span class="w">                                                  </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="nl">Cons</span><span class="p">:</span><span class="w"> </span><span class="n">Ring</span><span class="w"> </span><span class="n">maintenance</span><span class="w"> </span><span class="n">required</span><span class="p">,</span><span class="w"> </span><span class="n">slower</span><span class="w"> </span><span class="n">election</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                         </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="modern-leader-election">Modern Leader Election<a class="header-link" href="#modern-leader-election" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Modern Leader Election Approaches                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  1. Consensus-based                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  - Using consensus algorithms like Raft, Paxos                  â”‚   â”‚
â”‚  â”‚  - Utilizing distributed lock services (ZooKeeper, etcd, Consul)â”‚   â”‚
â”‚  â”‚  - Split-Brain prevention                                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Example: Raft leader election                                  â”‚   â”‚
â”‚  â”‚  - Transition to Candidate after timeout                        â”‚   â”‚
â”‚  â”‚  - Leader elected by majority vote                              â”‚   â”‚
â”‚  â”‚  - Term-based leadership management                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  2. Using External Services                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                   ZooKeeper / etcd                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  /leader-election/                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚    â””â”€ lock (ephemeral node)                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚        owner: node-1                                     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚            â”‚           â”‚           â”‚                            â”‚   â”‚
â”‚  â”‚            â–¼           â–¼           â–¼                            â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚  â”‚       â”‚Node 1  â”‚  â”‚Node 2  â”‚  â”‚Node 3  â”‚                       â”‚   â”‚
â”‚  â”‚       â”‚(Leader)â”‚  â”‚(Watch) â”‚  â”‚(Watch) â”‚                       â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  - Attempt to create ephemeral node                             â”‚   â”‚
â”‚  â”‚  - First creator becomes leader                                 â”‚   â”‚
â”‚  â”‚  - On leader failure, node auto-deleted â†’ re-election           â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="5-distributed-systems-challenges">5. Distributed Systems Challenges<a class="header-link" href="#5-distributed-systems-challenges" title="Permanent link">&para;</a></h2>
<h3 id="network-partition">Network Partition<a class="header-link" href="#network-partition" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Network Partition                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Partition Occurrence:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   Partition A              âœ—              Partition B           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Network severed    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚             â”‚    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚             â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  Node 1     â”‚                       â”‚  Node 3     â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  Node 2     â”‚                       â”‚  Node 4     â”‚          â”‚   â”‚
â”‚  â”‚  â”‚             â”‚                       â”‚  Node 5     â”‚          â”‚   â”‚
â”‚  â”‚  â”‚             â”‚                       â”‚             â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Each partition perceives the other as &quot;failed&quot;                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  Split-Brain Problem:                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Partition A:             Partition B:                          â”‚   â”‚
â”‚  â”‚  &quot;Node 3,4,5 failed!&quot;     &quot;Node 1,2 failed!&quot;                    â”‚   â”‚
â”‚  â”‚  â†’ Node 1 becomes leader  â†’ Node 5 becomes leader               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Two leaders! â†’ Data inconsistency, conflicts                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  Solution: Quorum                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Must communicate with majority (N/2 + 1) nodes to be leader    â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Out of 5 nodes:                                                â”‚   â”‚
â”‚  â”‚  - Partition A (2 nodes): 2 &lt; 3 â†’ Cannot be leader              â”‚   â”‚
â”‚  â”‚  - Partition B (3 nodes): 3 â‰¥ 3 â†’ Can be leader                 â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â†’ Only one leader exists!                                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="partial-failure">Partial Failure<a class="header-link" href="#partial-failure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Partial Failure                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Inherent characteristic of distributed systems: Only parts can fail   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Ambiguous situation:                                           â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Node A â”€â”€Requestâ”€â”€â–º Node B                                     â”‚   â”‚
â”‚  â”‚         â—„â”€â”€â”€?â”€â”€â”€â”€                                               â”‚   â”‚
â”‚  â”‚         Timeout!                                                 â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Possible causes:                                               â”‚   â”‚
â”‚  â”‚  1. Request was lost                                            â”‚   â”‚
â”‚  â”‚  2. Node B failed                                               â”‚   â”‚
â”‚  â”‚  3. Request processed but response lost                         â”‚   â”‚
â”‚  â”‚  4. Node B is slow (response may come later)                    â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â†’ Retry? Don&#39;t retry? No way to know the right decision!       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  Mitigation Strategies:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. Idempotent design: Safe to retry                            â”‚   â”‚
â”‚  â”‚  2. Timeout tuning: Not too short, not too long                 â”‚   â”‚
â”‚  â”‚  3. Health checks: Periodic node status checks                  â”‚   â”‚
â”‚  â”‚  4. Circuit breaker: Fast failure on repeated failures          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="byzantine-failure">Byzantine Failure<a class="header-link" href="#byzantine-failure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">                     </span><span class="nv">Byzantine</span><span class="w"> </span><span class="nv">Failure</span><span class="w">                                   </span>â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span class="w">                                                                         </span>â”‚
â”‚<span class="w">  </span><span class="nv">Normal</span><span class="w"> </span><span class="nv">failure</span>:<span class="w"> </span><span class="nv">Node</span><span class="w"> </span><span class="nv">stops</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">doesn</span><span class="err">&#39;t respond (Crash Failure)         â”‚</span>
<span class="err">â”‚  Byzantine failure: Node behaves incorrectly/maliciously               â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  Normal node:                    Byzantine node:                 â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - Follows protocol              - Lies                         â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - Accurate information          - Different messages to        â”‚   â”‚</span>
<span class="err">â”‚  â”‚  - Consistent behavior             different nodes              â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                   - Random behavior              â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”    &quot;value is 5&quot;  â”Œâ”€â”€â”€â”€â”€â”                               â”‚   â”‚</span>
<span class="err">â”‚  â”‚  â”‚  A  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  B  â”‚                               â”‚   â”‚</span>
<span class="err">â”‚  â”‚  â”‚(bad)â”‚                  â””â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚</span>
<span class="err">â”‚  â”‚  â”‚     â”‚    &quot;value is 7&quot;  â”Œâ”€â”€â”€â”€â”€â”                               â”‚   â”‚</span>
<span class="err">â”‚  â”‚  â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  C  â”‚                               â”‚   â”‚</span>
<span class="err">â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â”‚  B and C receive different values â†’ Cannot reach consensus!     â”‚   â”‚</span>
<span class="err">â”‚  â”‚                                                                  â”‚   â”‚</span>
<span class="err">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â”‚  Countermeasures:                                                      â”‚</span>
<span class="err">â”‚  - Byzantine Fault Tolerant (BFT) algorithms                           â”‚</span>
<span class="err">â”‚  - 3f + 1 nodes tolerate f Byzantine failures                          â”‚</span>
<span class="err">â”‚  - Mainly used in blockchain (PBFT, Tendermint)                        â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â”‚  In typical systems:                                                   â”‚</span>
<span class="err">â”‚  - Internal nodes assumed trusted (Crash Failure model)               â”‚</span>
<span class="err">â”‚  - Only validate external input                                        â”‚</span>
<span class="err">â”‚                                                                         â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="6-practice-problems">6. Practice Problems<a class="header-link" href="#6-practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-lamport-clock-calculation">Exercise 1: Lamport Clock Calculation<a class="header-link" href="#exercise-1-lamport-clock-calculation" title="Permanent link">&para;</a></h3>
<p>Calculate the Lamport timestamp for each event in the following sequence:</p>
<div class="highlight"><pre><span></span><code><span class="n">P1</span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w"> </span><span class="n">c</span>
<span class="w">         </span><span class="err">â”‚</span><span class="w">                       </span><span class="err">â–²</span>
<span class="w">         </span><span class="err">â–¼</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="n">P2</span><span class="o">:</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€</span><span class="n">d</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="n">f</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â–º</span>
</code></pre></div>

<h3 id="exercise-2-vector-clock-analysis">Exercise 2: Vector Clock Analysis<a class="header-link" href="#exercise-2-vector-clock-analysis" title="Permanent link">&para;</a></h3>
<p>Determine the relationship (happens-before, concurrent) for the following Vector Clock values:
- V1 = [2, 1, 0]
- V2 = [1, 2, 0]
- V3 = [2, 2, 1]
- V4 = [3, 1, 0]</p>
<h3 id="exercise-3-leader-election-design">Exercise 3: Leader Election Design<a class="header-link" href="#exercise-3-leader-election-design" title="Permanent link">&para;</a></h3>
<p>Design a leader election mechanism for a distributed database with 5 nodes:
- Handle network partitions
- Prevent Split-Brain
- Auto-recovery on leader failure</p>
<hr />
<h2 id="next-steps">Next Steps<a class="header-link" href="#next-steps" title="Permanent link">&para;</a></h2>
<p>In <a href="./16_Consensus_Algorithms.md">16_Consensus_Algorithms.md</a>, let's learn about distributed consensus algorithms like Paxos and Raft!</p>
<hr />
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>"Distributed Systems" - Maarten van Steen, Andrew Tanenbaum</li>
<li>"Designing Data-Intensive Applications" - Martin Kleppmann</li>
<li>"Time, Clocks, and the Ordering of Events in a Distributed System" - Leslie Lamport</li>
<li>"The Fallacies of Distributed Computing" - L Peter Deutsch</li>
<li>Raft Consensus Algorithm - raft.github.io</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/System_Design/14_Microservices_Patterns.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Microservices Patterns</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/System_Design/16_Consensus_Algorithms.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Consensus Algorithms</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}