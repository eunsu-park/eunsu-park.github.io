{% raw %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>19. Observability and Monitoring - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/en/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/en/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/en/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" selected>
                        English
                    </option>
                    
                    <option value="ko" >
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/en/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/en/System_Design/">System Design</a>
    <span class="separator">/</span>
    <span class="current">19. Observability and Monitoring</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>19. Observability and Monitoring</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/System_Design/18_Design_Example_2.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Practical Design Examples 2</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/System_Design/20_Search_Systems.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">20. Search Systems</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#1-observability-fundamentals">1. Observability Fundamentals</a><ul>
<li><a href="#11-three-pillars-of-observability">1.1 Three Pillars of Observability</a></li>
<li><a href="#12-monitoring-vs-observability">1.2 Monitoring vs Observability</a></li>
</ul>
</li>
<li><a href="#2-metrics-and-time-series-data">2. Metrics and Time-Series Data</a><ul>
<li><a href="#21-metric-types">2.1 Metric Types</a></li>
<li><a href="#22-prometheus-architecture">2.2 Prometheus Architecture</a></li>
<li><a href="#23-prometheus-metric-types">2.3 Prometheus Metric Types</a></li>
<li><a href="#24-promql-queries">2.4 PromQL Queries</a></li>
</ul>
</li>
<li><a href="#3-logging-at-scale">3. Logging at Scale</a><ul>
<li><a href="#31-structured-logging">3.1 Structured Logging</a></li>
<li><a href="#32-elk-stack-architecture">3.2 ELK Stack Architecture</a></li>
<li><a href="#33-grafana-loki-lightweight-alternative">3.3 Grafana Loki (Lightweight Alternative)</a></li>
<li><a href="#34-log-levels-and-best-practices">3.4 Log Levels and Best Practices</a></li>
</ul>
</li>
<li><a href="#4-distributed-tracing">4. Distributed Tracing</a><ul>
<li><a href="#41-trace-anatomy">4.1 Trace Anatomy</a></li>
<li><a href="#42-tracing-systems">4.2 Tracing Systems</a></li>
<li><a href="#43-context-propagation">4.3 Context Propagation</a></li>
<li><a href="#44-sampling-strategies">4.4 Sampling Strategies</a></li>
</ul>
</li>
<li><a href="#5-alerting-and-slos">5. Alerting and SLOs</a><ul>
<li><a href="#51-sli-slo-sla">5.1 SLI / SLO / SLA</a></li>
<li><a href="#52-error-budgets">5.2 Error Budgets</a></li>
<li><a href="#53-alerting-best-practices">5.3 Alerting Best Practices</a></li>
</ul>
</li>
<li><a href="#6-opentelemetry">6. OpenTelemetry</a><ul>
<li><a href="#61-opentelemetry-architecture">6.1 OpenTelemetry Architecture</a></li>
<li><a href="#62-otel-collector-configuration">6.2 OTel Collector Configuration</a></li>
<li><a href="#63-instrumentation-example-python">6.3 Instrumentation Example (Python)</a></li>
</ul>
</li>
<li><a href="#7-practice-problems">7. Practice Problems</a><ul>
<li><a href="#problem-1-design-monitoring-for-a-microservices-platform">Problem 1: Design Monitoring for a Microservices Platform</a></li>
<li><a href="#problem-2-alert-design">Problem 2: Alert Design</a></li>
<li><a href="#problem-3-observability-cost-optimization">Problem 3: Observability Cost Optimization</a></li>
</ul>
</li>
<li><a href="#next-steps">Next Steps</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="19-observability-and-monitoring">19. Observability and Monitoring<a class="header-link" href="#19-observability-and-monitoring" title="Permanent link">&para;</a></h1>
<p>Difficulty: â­â­â­â­</p>
<h2 id="overview">Overview<a class="header-link" href="#overview" title="Permanent link">&para;</a></h2>
<p>Observability is the ability to understand a system's internal state from its external outputs. In this lesson, we cover the three pillars of observability â€” metrics, logs, and traces â€” along with practical tools and frameworks for monitoring distributed systems at scale.</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-observability-fundamentals">Observability Fundamentals</a></li>
<li><a href="#2-metrics-and-time-series-data">Metrics and Time-Series Data</a></li>
<li><a href="#3-logging-at-scale">Logging at Scale</a></li>
<li><a href="#4-distributed-tracing">Distributed Tracing</a></li>
<li><a href="#5-alerting-and-slos">Alerting and SLOs</a></li>
<li><a href="#6-opentelemetry">OpenTelemetry</a></li>
<li><a href="#7-practice-problems">Practice Problems</a></li>
</ol>
<hr />
<h2 id="1-observability-fundamentals">1. Observability Fundamentals<a class="header-link" href="#1-observability-fundamentals" title="Permanent link">&para;</a></h2>
<h3 id="11-three-pillars-of-observability">1.1 Three Pillars of Observability<a class="header-link" href="#11-three-pillars-of-observability" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">              </span><span class="n">Three</span><span class="w"> </span><span class="n">Pillars</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Observability</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Metrics</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="n">Logs</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="n">Traces</span><span class="w">     </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="s2">&quot;What is     â”‚  â”‚ &quot;</span><span class="n">What</span><span class="w">       </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="s2">&quot;What path   â”‚          â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">happening</span><span class="err">?</span><span class="s2">&quot; â”‚  â”‚  happened?&quot;</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">did</span><span class="w"> </span><span class="n">it</span><span class="w">      </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="n">take</span><span class="err">?</span><span class="s2">&quot;      â”‚          â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Numeric</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Structured</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Request</span><span class="o">-</span><span class="w">     </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">time</span><span class="o">-</span><span class="n">series</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">with</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">scoped</span><span class="w">       </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">data</span><span class="w">         </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">context</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">causality</span><span class="w">    </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Low</span><span class="w"> </span><span class="n">cost</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Medium</span><span class="w"> </span><span class="n">cost</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Higher</span><span class="w"> </span><span class="n">cost</span><span class="w">  </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="k">signal</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="k">signal</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="k">signal</span><span class="w">   </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">  </span><span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Prometheus</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">ELK</span><span class="w"> </span><span class="n">Stack</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Jaeger</span><span class="w">       </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Grafana</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Loki</span><span class="w">         </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Zipkin</span><span class="w">       </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Datadog</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Fluentd</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Tempo</span><span class="w">        </span><span class="err">â”‚</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">             </span><span class="n">Correlation</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">Trace</span><span class="w"> </span><span class="n">IDs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Labels</span><span class="w">                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="12-monitoring-vs-observability">1.2 Monitoring vs Observability<a class="header-link" href="#12-monitoring-vs-observability" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Monitoring</span><span class="w">                  </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Observability</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Known</span><span class="w"> </span><span class="nx">unknowns</span><span class="w">              </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">unknowns</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="s">&quot;Is CPU &gt; 90%?&quot;</span><span class="w">             </span><span class="err">â”‚</span><span class="w"> </span><span class="s">&quot;Why is latency high?&quot;</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Dashboard</span><span class="o">-</span><span class="nx">driven</span><span class="w">            </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Exploration</span><span class="o">-</span><span class="nx">driven</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Predefined</span><span class="w"> </span><span class="nx">alerts</span><span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Ad</span><span class="o">-</span><span class="nx">hoc</span><span class="w"> </span><span class="nx">investigation</span><span class="w">               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Reactive</span><span class="w">                    </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Proactive</span><span class="w">                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="nx">Works</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">systems</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="nx">Essential</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">distributed</span><span class="w"> </span><span class="nx">systems</span><span class="w">  </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="2-metrics-and-time-series-data">2. Metrics and Time-Series Data<a class="header-link" href="#2-metrics-and-time-series-data" title="Permanent link">&para;</a></h2>
<h3 id="21-metric-types">2.1 Metric Types<a class="header-link" href="#21-metric-types" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">              </span><span class="nv">Four</span><span class="w"> </span><span class="nv">Golden</span><span class="w"> </span><span class="nv">Signals</span><span class="w"> </span><span class="ss">(</span><span class="nv">Google</span><span class="w"> </span><span class="nv">SRE</span><span class="ss">)</span><span class="w">                    </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="mi">1</span>.<span class="w"> </span><span class="nv">Latency</span><span class="w">     </span>â€”<span class="w"> </span><span class="nv">Time</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">serve</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">request</span><span class="w">                       </span>â”‚
â”‚<span class="w">  </span><span class="mi">2</span>.<span class="w"> </span><span class="nv">Traffic</span><span class="w">     </span>â€”<span class="w"> </span><span class="nv">Demand</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="ss">(</span><span class="nv">RPS</span><span class="ss">)</span><span class="w">                    </span>â”‚
â”‚<span class="w">  </span><span class="mi">3</span>.<span class="w"> </span><span class="nv">Errors</span><span class="w">      </span>â€”<span class="w"> </span><span class="nv">Rate</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">failed</span><span class="w"> </span><span class="nv">requests</span><span class="w">                       </span>â”‚
â”‚<span class="w">  </span><span class="mi">4</span>.<span class="w"> </span><span class="nv">Saturation</span><span class="w">  </span>â€”<span class="w"> </span><span class="nv">How</span><span class="w"> </span><span class="s2">&quot;full&quot;</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="nv">is</span><span class="w">                      </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">              </span><span class="nv">RED</span><span class="w"> </span><span class="nv">Method</span><span class="w"> </span><span class="ss">(</span><span class="k">for</span><span class="w"> </span><span class="nv">microservices</span><span class="ss">)</span><span class="w">                      </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="mi">1</span>.<span class="w"> </span><span class="nv">Rate</span><span class="w">     </span>â€”<span class="w"> </span><span class="nv">Requests</span><span class="w"> </span><span class="nv">per</span><span class="w"> </span><span class="nv">second</span><span class="w">                              </span>â”‚
â”‚<span class="w">  </span><span class="mi">2</span>.<span class="w"> </span><span class="nv">Errors</span><span class="w">   </span>â€”<span class="w"> </span><span class="nv">Failed</span><span class="w"> </span><span class="nv">requests</span><span class="w"> </span><span class="nv">per</span><span class="w"> </span><span class="nv">second</span><span class="w">                       </span>â”‚
â”‚<span class="w">  </span><span class="mi">3</span>.<span class="w"> </span><span class="nv">Duration</span><span class="w"> </span>â€”<span class="w"> </span><span class="nv">Distribution</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">request</span><span class="w"> </span><span class="nv">latencies</span><span class="w">                </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">              </span><span class="nv">USE</span><span class="w"> </span><span class="nv">Method</span><span class="w"> </span><span class="ss">(</span><span class="k">for</span><span class="w"> </span><span class="nv">infrastructure</span><span class="ss">)</span><span class="w">                     </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="mi">1</span>.<span class="w"> </span><span class="nv">Utilization</span><span class="w">  </span>â€”<span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">busy</span><span class="w">                           </span>â”‚
â”‚<span class="w">  </span><span class="mi">2</span>.<span class="w"> </span><span class="nv">Saturation</span><span class="w">   </span>â€”<span class="w"> </span><span class="nv">Queue</span><span class="w"> </span><span class="nv">depth</span>,<span class="w"> </span><span class="nv">pending</span><span class="w"> </span><span class="nv">work</span><span class="w">                    </span>â”‚
â”‚<span class="w">  </span><span class="mi">3</span>.<span class="w"> </span><span class="nv">Errors</span><span class="w">       </span>â€”<span class="w"> </span><span class="nv">Error</span><span class="w"> </span><span class="nv">count</span><span class="w">                                  </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="22-prometheus-architecture">2.2 Prometheus Architecture<a class="header-link" href="#22-prometheus-architecture" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Prometheus Ecosystem                                â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Application â”‚     â”‚ Application â”‚     â”‚   Node      â”‚       â”‚
â”‚  â”‚  /metrics   â”‚     â”‚  /metrics   â”‚     â”‚  Exporter   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                   â”‚                   â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                     â”‚  scrape (pull)                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚              â”‚  Prometheus  â”‚                                    â”‚
â”‚              â”‚   Server     â”‚â”€â”€â”€â”€â”€â”€â–¶ AlertManager â”€â”€â–¶ PagerDuty â”‚
â”‚              â”‚  (TSDB)      â”‚               â”‚        Slack      â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜               â”‚        Email      â”‚
â”‚                     â”‚                                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚              â”‚   Grafana    â”‚                                    â”‚
â”‚              â”‚ (Dashboard)  â”‚                                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="23-prometheus-metric-types">2.3 Prometheus Metric Types<a class="header-link" href="#23-prometheus-metric-types" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Counter â€” monotonically increasing (requests, errors)</span>
<span class="l l-Scalar l-Scalar-Plain">http_requests_total{method=&quot;GET&quot;, path=&quot;/api/users&quot;, status=&quot;200&quot;} 12345</span>

<span class="l l-Scalar l-Scalar-Plain"># Gauge â€” goes up and down (temperature, queue size)</span>
<span class="l l-Scalar l-Scalar-Plain">process_memory_bytes 1073741824</span>

<span class="l l-Scalar l-Scalar-Plain"># Histogram â€” samples in configurable buckets</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds_bucket{le=&quot;0.1&quot;} 1000</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds_bucket{le=&quot;0.5&quot;} 1200</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds_bucket{le=&quot;1.0&quot;} 1250</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds_count 1280</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds_sum 320.5</span>

<span class="l l-Scalar l-Scalar-Plain"># Summary â€” similar to histogram with quantiles</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds{quantile=&quot;0.5&quot;} 0.042</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds{quantile=&quot;0.9&quot;} 0.087</span>
<span class="l l-Scalar l-Scalar-Plain">http_request_duration_seconds{quantile=&quot;0.99&quot;} 0.235</span>
</code></pre></div>

<h3 id="24-promql-queries">2.4 PromQL Queries<a class="header-link" href="#24-promql-queries" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Request rate over 5 minutes</span>
<span class="kr">rate</span><span class="o">(</span><span class="nv">http_requests_total</span><span class="p">[</span><span class="s">5m</span><span class="p">]</span><span class="o">)</span>

<span class="c1"># Error rate percentage</span>
<span class="k">sum</span><span class="o">(</span><span class="kr">rate</span><span class="o">(</span><span class="nv">http_requests_total</span><span class="p">{</span><span class="nl">status</span><span class="o">=~</span><span class="p">&quot;</span><span class="s">5..</span><span class="p">&quot;}[</span><span class="s">5m</span><span class="p">]</span><span class="o">))</span><span class="w"> </span><span class="o">/</span>
<span class="k">sum</span><span class="o">(</span><span class="kr">rate</span><span class="o">(</span><span class="nv">http_requests_total</span><span class="p">[</span><span class="s">5m</span><span class="p">]</span><span class="o">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span>

<span class="c1"># 95th percentile latency</span>
<span class="kr">histogram_quantile</span><span class="o">(</span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="kr">rate</span><span class="o">(</span><span class="nv">http_request_duration_seconds_bucket</span><span class="p">[</span><span class="s">5m</span><span class="p">]</span><span class="o">))</span>

<span class="c1"># Top 5 endpoints by request rate</span>
<span class="k">topk</span><span class="o">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="nv">path</span><span class="o">)(</span><span class="kr">rate</span><span class="o">(</span><span class="nv">http_requests_total</span><span class="p">[</span><span class="s">5m</span><span class="p">]</span><span class="o">)))</span>

<span class="c1"># Memory usage percentage</span>
<span class="o">(</span><span class="nv">node_memory_MemTotal_bytes</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">node_memory_MemAvailable_bytes</span><span class="o">)</span>
<span class="o">/</span><span class="w"> </span><span class="nv">node_memory_MemTotal_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span>

<span class="c1"># Predict disk full in 4 hours</span>
<span class="kr">predict_linear</span><span class="o">(</span><span class="nv">node_filesystem_free_bytes</span><span class="p">[</span><span class="s">1h</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="mi">3600</span><span class="o">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>

<hr />
<h2 id="3-logging-at-scale">3. Logging at Scale<a class="header-link" href="#3-logging-at-scale" title="Permanent link">&para;</a></h2>
<h3 id="31-structured-logging">3.1 Structured Logging<a class="header-link" href="#31-structured-logging" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-02-15T10:30:00Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ERROR&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;service&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;order-service&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;trace_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;abc123def456&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;span_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;789ghi&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u-42&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Failed to process order&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PaymentDeclined&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ord-789&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">129.99</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;duration_ms&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1250</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="32-elk-stack-architecture">3.2 ELK Stack Architecture<a class="header-link" href="#32-elk-stack-architecture" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ELK Stack (Elastic Stack)                           â”‚
â”‚                                                                 â”‚
â”‚  Applications                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚                           â”‚
â”‚  â”‚    A     â”‚ â”‚    B     â”‚ â”‚    C     â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚       â”‚            â”‚            â”‚                               â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                    â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚     Filebeat / Fluentd           â”‚  Log Shippers             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                 â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚        Logstash / Kafka          â”‚  Processing / Buffer      â”‚
â”‚  â”‚   (parse, filter, enrich)        â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                 â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚       Elasticsearch              â”‚  Storage &amp; Search         â”‚
â”‚  â”‚   (index, full-text search)      â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                 â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚          Kibana                  â”‚  Visualization            â”‚
â”‚  â”‚   (dashboards, queries)          â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="33-grafana-loki-lightweight-alternative">3.3 Grafana Loki (Lightweight Alternative)<a class="header-link" href="#33-grafana-loki-lightweight-alternative" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">              </span><span class="nv">Grafana</span><span class="w"> </span><span class="nv">Loki</span><span class="w"> </span><span class="nv">Stack</span><span class="w">                                  </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">Does</span><span class="w"> </span><span class="nv">NOT</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">log</span><span class="w"> </span><span class="nv">content</span><span class="w"> </span><span class="ss">(</span><span class="nv">only</span><span class="w"> </span><span class="nv">labels</span><span class="ss">)</span><span class="w">                     </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">Much</span><span class="w"> </span><span class="nv">cheaper</span><span class="w"> </span><span class="nv">storage</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="nv">Elasticsearch</span><span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">LogQL</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="nv">language</span><span class="w"> </span><span class="ss">(</span><span class="nv">similar</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">PromQL</span><span class="ss">)</span><span class="w">                     </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">Ideal</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">Kubernetes</span><span class="w"> </span><span class="nv">environments</span><span class="w">                            </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">Promtail</span><span class="w"> </span>â”€â”€â–¶<span class="w"> </span><span class="nv">Loki</span><span class="w"> </span>â”€â”€â–¶<span class="w"> </span><span class="nv">Grafana</span><span class="w">                                  </span>â”‚
â”‚<span class="w">  </span><span class="ss">(</span><span class="nv">agent</span><span class="ss">)</span><span class="w">      </span><span class="ss">(</span><span class="nv">store</span><span class="ss">)</span><span class="w">   </span><span class="ss">(</span><span class="nv">query</span><span class="o">/</span><span class="nv">visualize</span><span class="ss">)</span><span class="w">                       </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="x"># LogQL examples</span>
<span class="x">{service=&quot;order-service&quot;} |= &quot;error&quot;                # contains &quot;error&quot;</span>
<span class="x">{service=&quot;order-service&quot;} | json | status &gt;= 500     # JSON parsing + filter</span>
<span class="x">{service=&quot;order-service&quot;} | json | line_format &quot;</span><span class="cp">{{</span><span class="nv">.message</span><span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">rate({service=&quot;order-service&quot;} |= &quot;error&quot; [5m])      # error rate</span>
</code></pre></div>

<h3 id="34-log-levels-and-best-practices">3.4 Log Levels and Best Practices<a class="header-link" href="#34-log-levels-and-best-practices" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">Level</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">When</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">Use</span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="nv">TRACE</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Very</span><span class="w"> </span><span class="nv">fine</span><span class="o">-</span><span class="nv">grained</span><span class="w"> </span><span class="ss">(</span><span class="nv">usually</span><span class="w"> </span><span class="nv">disabled</span><span class="ss">)</span>
<span class="nv">DEBUG</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Development</span><span class="w"> </span><span class="nv">troubleshooting</span>
<span class="nv">INFO</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Normal</span><span class="w"> </span><span class="nv">operations</span>,<span class="w"> </span><span class="nv">business</span><span class="w"> </span><span class="nv">events</span>
<span class="nv">WARN</span><span class="w">     </span>â”‚<span class="w"> </span><span class="nv">Recoverable</span><span class="w"> </span><span class="nv">issues</span>,<span class="w"> </span><span class="nv">degraded</span><span class="w"> </span><span class="nv">service</span>
<span class="nv">ERROR</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Failures</span><span class="w"> </span><span class="nv">requiring</span><span class="w"> </span><span class="nv">attention</span>
<span class="nv">FATAL</span><span class="w">    </span>â”‚<span class="w"> </span><span class="nv">Application</span><span class="w"> </span><span class="nv">cannot</span><span class="w"> </span><span class="k">continue</span>
</code></pre></div>

<p><strong>Best Practices:</strong>
- Use structured logging (JSON) over plain text
- Include correlation IDs (trace_id) in every log
- Log at appropriate levels (no INFO spam in production)
- Set retention policies (7d hot, 30d warm, 90d cold)
- Avoid logging sensitive data (PII, credentials)</p>
<hr />
<h2 id="4-distributed-tracing">4. Distributed Tracing<a class="header-link" href="#4-distributed-tracing" title="Permanent link">&para;</a></h2>
<h3 id="41-trace-anatomy">4.1 Trace Anatomy<a class="header-link" href="#41-trace-anatomy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Distributed Trace Example                           â”‚
â”‚                                                                 â”‚
â”‚  Trace ID: abc-123-def                                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Span A: API Gateway (200ms)                        â”‚         â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚         â”‚
â”‚  â”‚  â”‚ Span B: Auth (30ms)     â”‚                       â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚         â”‚
â”‚  â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚         â”‚
â”‚  â”‚         â”‚ Span C: Order Service (120ms)â”‚            â”‚         â”‚
â”‚  â”‚         â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚            â”‚         â”‚
â”‚  â”‚         â”‚  â”‚ Span D: DB   â”‚           â”‚            â”‚         â”‚
â”‚  â”‚         â”‚  â”‚ Query (15ms) â”‚           â”‚            â”‚         â”‚
â”‚  â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚            â”‚         â”‚
â”‚  â”‚         â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚            â”‚         â”‚
â”‚  â”‚         â”‚       â”‚ Span E:     â”‚       â”‚            â”‚         â”‚
â”‚  â”‚         â”‚       â”‚ Payment     â”‚       â”‚            â”‚         â”‚
â”‚  â”‚         â”‚       â”‚ (80ms)      â”‚       â”‚            â”‚         â”‚
â”‚  â”‚         â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚            â”‚         â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  0ms            100ms           200ms                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="42-tracing-systems">4.2 Tracing Systems<a class="header-link" href="#42-tracing-systems" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Tool</span><span class="w">           </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Description</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Jaeger</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Open</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Uber</span><span class="o">-</span><span class="n">originated</span><span class="p">,</span><span class="w"> </span><span class="n">CNCF</span><span class="w"> </span><span class="n">project</span><span class="w">       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Zipkin</span><span class="w">         </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Open</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Twitter</span><span class="o">-</span><span class="n">originated</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Grafana</span><span class="w"> </span><span class="n">Tempo</span><span class="w">  </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Cost</span><span class="o">-</span><span class="n">efficient</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">stores</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="n">IDs</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">AWS</span><span class="w"> </span><span class="n">X</span><span class="o">-</span><span class="n">Ray</span><span class="w">      </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Managed</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">AWS</span><span class="w"> </span><span class="n">workloads</span><span class="w">                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w"> </span><span class="n">Datadog</span><span class="w"> </span><span class="n">APM</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Commercial</span><span class="p">,</span><span class="w"> </span><span class="n">integrated</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">metrics</span><span class="o">/</span><span class="n">logs</span><span class="w">          </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="43-context-propagation">4.3 Context Propagation<a class="header-link" href="#43-context-propagation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              W3C Trace Context Headers                           â”‚
â”‚                                                                 â”‚
â”‚  HTTP Request:                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ traceparent: 00-{trace-id}-{span-id}-{flags}       â”‚        â”‚
â”‚  â”‚ tracestate: vendor1=value1,vendor2=value2            â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                 â”‚
â”‚  Example:                                                       â”‚
â”‚  traceparent: 00-abc123def456-789ghi012-01                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ ver  â”‚  trace-id    â”‚  span-id   â”‚flags â”‚                    â”‚
â”‚  â”‚ 00   â”‚ abc123def456 â”‚ 789ghi012  â”‚ 01   â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                 â”‚
â”‚  Service A â”€â”€(traceparent)â”€â”€â–¶ Service B â”€â”€(traceparent)â”€â”€â–¶ C    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="44-sampling-strategies">4.4 Sampling Strategies<a class="header-link" href="#44-sampling-strategies" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">              </span><span class="nx">Sampling</span><span class="w"> </span><span class="nx">Strategies</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Head</span><span class="o">-</span><span class="nx">based</span><span class="w"> </span><span class="nx">sampling</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nx">Decision</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">trace</span><span class="w"> </span><span class="nx">start</span><span class="p">:</span><span class="w"> </span><span class="nx">sample</span><span class="w"> </span><span class="mi">10</span><span class="o">%</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">requests</span><span class="w">         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="nx">Simple</span><span class="p">,</span><span class="w"> </span><span class="nx">low</span><span class="w"> </span><span class="nx">overhead</span><span class="w">                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">âˆ’</span><span class="w"> </span><span class="nx">May</span><span class="w"> </span><span class="nx">miss</span><span class="w"> </span><span class="nx">important</span><span class="w"> </span><span class="nx">traces</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Tail</span><span class="o">-</span><span class="nx">based</span><span class="w"> </span><span class="nx">sampling</span><span class="w">                                         </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nx">Decision</span><span class="w"> </span><span class="nx">after</span><span class="w"> </span><span class="nx">trace</span><span class="w"> </span><span class="nx">completes</span><span class="p">:</span><span class="w"> </span><span class="nx">keep</span><span class="w"> </span><span class="nx">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">slow</span><span class="w"> </span><span class="nx">traces</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="nx">Captures</span><span class="w"> </span><span class="nx">interesting</span><span class="w"> </span><span class="nx">traces</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">âˆ’</span><span class="w"> </span><span class="nx">Higher</span><span class="w"> </span><span class="nx">memory</span><span class="w"> </span><span class="nx">usage</span><span class="w"> </span><span class="p">(</span><span class="nx">buffer</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">spans</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Rate</span><span class="o">-</span><span class="nx">limited</span><span class="w"> </span><span class="nx">sampling</span><span class="w">                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="nx">Keep</span><span class="w"> </span><span class="nx">N</span><span class="w"> </span><span class="nx">traces</span><span class="w"> </span><span class="nx">per</span><span class="w"> </span><span class="nx">second</span><span class="w"> </span><span class="nx">per</span><span class="w"> </span><span class="nx">service</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="nx">Predictable</span><span class="w"> </span><span class="nx">cost</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">âˆ’</span><span class="w"> </span><span class="nx">May</span><span class="w"> </span><span class="nx">miss</span><span class="w"> </span><span class="nx">bursts</span><span class="w">                                           </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                 </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<hr />
<h2 id="5-alerting-and-slos">5. Alerting and SLOs<a class="header-link" href="#5-alerting-and-slos" title="Permanent link">&para;</a></h2>
<h3 id="51-sli-slo-sla">5.1 SLI / SLO / SLA<a class="header-link" href="#51-sli-slo-sla" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">              </span><span class="nv">SLI</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">SLO</span><span class="w"> </span>â†’<span class="w"> </span><span class="nv">SLA</span><span class="w">                                    </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">SLI</span><span class="w"> </span><span class="ss">(</span><span class="nv">Service</span><span class="w"> </span><span class="nv">Level</span><span class="w"> </span><span class="nv">Indicator</span><span class="ss">)</span><span class="w">                                  </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">What</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">measure</span><span class="w">                                           </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="s2">&quot;Proportion of requests &lt; 200ms&quot;</span><span class="w">                           </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="s2">&quot;Proportion of requests returning 2xx&quot;</span><span class="w">                     </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">SLO</span><span class="w"> </span><span class="ss">(</span><span class="nv">Service</span><span class="w"> </span><span class="nv">Level</span><span class="w"> </span><span class="nv">Objective</span><span class="ss">)</span><span class="w">                                  </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">Internal</span><span class="w"> </span><span class="nv">target</span><span class="w">                                            </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="s2">&quot;99.9% of requests &lt; 200ms over 30 days&quot;</span><span class="w">                  </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="s2">&quot;99.95% availability per month&quot;</span><span class="w">                            </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">SLA</span><span class="w"> </span><span class="ss">(</span><span class="nv">Service</span><span class="w"> </span><span class="nv">Level</span><span class="w"> </span><span class="nv">Agreement</span><span class="ss">)</span><span class="w">                                  </span>â”‚
â”‚<span class="w">  </span>â”œâ”€â”€<span class="w"> </span><span class="nv">External</span><span class="w"> </span><span class="nv">contract</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">consequences</span><span class="w">                        </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€<span class="w"> </span><span class="s2">&quot;99.9% uptime or service credits issued&quot;</span><span class="w">                  </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">Rule</span>:<span class="w"> </span><span class="nv">SLO</span><span class="w"> </span><span class="nv">should</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">stricter</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="nv">SLA</span><span class="w">                          </span>â”‚
â”‚<span class="w">        </span><span class="ss">(</span><span class="nv">e</span>.<span class="nv">g</span>.,<span class="w"> </span><span class="nv">SLO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span>.<span class="mi">95</span><span class="o">%</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">SLA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span>.<span class="mi">9</span><span class="o">%</span><span class="ss">)</span><span class="w">                  </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="52-error-budgets">5.2 Error Budgets<a class="header-link" href="#52-error-budgets" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span class="w">              </span><span class="nv">Error</span><span class="w"> </span><span class="nv">Budget</span><span class="w"> </span><span class="nv">Concept</span><span class="w">                                </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">SLO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span>.<span class="mi">9</span><span class="o">%</span><span class="w"> </span><span class="nv">availability</span><span class="w">                                      </span>â”‚
â”‚<span class="w">  </span><span class="nv">Error</span><span class="w"> </span><span class="nv">Budget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="o">%</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">99</span>.<span class="mi">9</span><span class="o">%</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>.<span class="mi">1</span><span class="o">%</span><span class="w">                            </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">Per</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="nv">days</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">1</span><span class="o">%</span><span class="w"> </span>Ã—<span class="w"> </span><span class="mi">30</span><span class="w"> </span>Ã—<span class="w"> </span><span class="mi">24</span><span class="w"> </span>Ã—<span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">43</span>.<span class="mi">2</span><span class="w"> </span><span class="nv">minutes</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">downtime</span><span class="w"> </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">Error</span><span class="w"> </span><span class="nv">Budget</span><span class="w"> </span><span class="nv">Remaining</span>:<span class="w">                                        </span>â”‚
â”‚<span class="w">  </span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<span class="w">         </span>â”‚
â”‚<span class="w">  </span>â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚<span class="w">         </span>â”‚
â”‚<span class="w">  </span>â”‚<span class="w"> </span><span class="mi">70</span><span class="o">%</span><span class="w"> </span><span class="nv">remaining</span><span class="w">              </span><span class="mi">30</span><span class="o">%</span><span class="w"> </span><span class="nv">consumed</span><span class="w">           </span>â”‚<span class="w">         </span>â”‚
â”‚<span class="w">  </span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span class="w">         </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â”‚<span class="w">  </span><span class="nv">Policy</span>:<span class="w">                                                        </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">Budget</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span><span class="o">%</span>:<span class="w"> </span><span class="nv">Deploy</span><span class="w"> </span><span class="nv">freely</span>,<span class="w"> </span><span class="nv">experiment</span><span class="w">                      </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">Budget</span><span class="w"> </span><span class="mi">20</span><span class="o">-</span><span class="mi">50</span><span class="o">%</span>:<span class="w"> </span><span class="nv">Careful</span><span class="w"> </span><span class="nv">deployments</span>,<span class="w"> </span><span class="nv">extra</span><span class="w"> </span><span class="nv">testing</span><span class="w">            </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">Budget</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="o">%</span>:<span class="w"> </span><span class="nv">Freeze</span><span class="w"> </span><span class="nv">features</span>,<span class="w"> </span><span class="nv">focus</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">reliability</span><span class="w">          </span>â”‚
â”‚<span class="w">  </span>â€¢<span class="w"> </span><span class="nv">Budget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">%</span>:<span class="w"> </span><span class="nv">Emergency</span><span class="w"> </span><span class="nv">freeze</span><span class="w"> </span><span class="k">until</span><span class="w"> </span><span class="nv">budget</span><span class="w"> </span><span class="nv">replenishes</span><span class="w">       </span>â”‚
â”‚<span class="w">                                                                 </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="53-alerting-best-practices">5.3 Alerting Best Practices<a class="header-link" href="#53-alerting-best-practices" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Prometheus alerting rules example</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slo-alerts</span>
<span class="w">    </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Multi-window, multi-burn-rate alert</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HighErrorRate</span>
<span class="w">        </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">(</span>
<span class="w">            </span><span class="no">sum(rate(http_requests_total{status=~&quot;5..&quot;}[5m]))</span>
<span class="w">            </span><span class="no">/ sum(rate(http_requests_total[5m]))</span>
<span class="w">          </span><span class="no">) &gt; 14.4 * 0.001  # 14.4x burn rate for 5m window</span>
<span class="w">          </span><span class="no">AND</span>
<span class="w">          </span><span class="no">(</span>
<span class="w">            </span><span class="no">sum(rate(http_requests_total{status=~&quot;5..&quot;}[1h]))</span>
<span class="w">            </span><span class="no">/ sum(rate(http_requests_total[1h]))</span>
<span class="w">          </span><span class="no">) &gt; 14.4 * 0.001</span>
<span class="w">        </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2m</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical</span>
<span class="w">        </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Error</span><span class="nv"> </span><span class="s">rate</span><span class="nv"> </span><span class="s">exceeds</span><span class="nv"> </span><span class="s">SLO</span><span class="nv"> </span><span class="s">burn</span><span class="nv"> </span><span class="s">rate&quot;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HighLatency</span>
<span class="w">        </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m])) &gt; 1.0</span>
<span class="w">        </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">warning</span>
<span class="w">        </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;P99</span><span class="nv"> </span><span class="s">latency</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">1s&quot;</span>
</code></pre></div>

<p><strong>Alerting Anti-Patterns:</strong>
- Alert fatigue: too many non-actionable alerts
- Missing runbooks: alerts without remediation steps
- No owner: alerts routed to "everyone"
- Threshold-only: static thresholds without trend analysis</p>
<hr />
<h2 id="6-opentelemetry">6. OpenTelemetry<a class="header-link" href="#6-opentelemetry" title="Permanent link">&para;</a></h2>
<h3 id="61-opentelemetry-architecture">6.1 OpenTelemetry Architecture<a class="header-link" href="#61-opentelemetry-architecture" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              OpenTelemetry (OTel) Architecture                   â”‚
â”‚                                                                 â”‚
â”‚  Application                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  OTel SDK                                       â”‚            â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚            â”‚
â”‚  â”‚  â”‚ Traces   â”‚ â”‚ Metrics  â”‚ â”‚  Logs    â”‚        â”‚            â”‚
â”‚  â”‚  â”‚ API      â”‚ â”‚ API      â”‚ â”‚ API      â”‚        â”‚            â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚            â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚            â”‚
â”‚  â”‚                     â–¼                           â”‚            â”‚
â”‚  â”‚              OTLP Exporter                      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                        â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚           OTel Collector                        â”‚            â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚            â”‚
â”‚  â”‚  â”‚Receiversâ”‚  â”‚ Processors â”‚  â”‚ Exportersâ”‚      â”‚            â”‚
â”‚  â”‚  â”‚ OTLP   â”‚â†’â”‚ Batch      â”‚â†’â”‚ Jaeger   â”‚      â”‚            â”‚
â”‚  â”‚  â”‚ Zipkin â”‚  â”‚ Filter     â”‚  â”‚ Prometheusâ”‚      â”‚            â”‚
â”‚  â”‚  â”‚ Kafka  â”‚  â”‚ Tail-sampleâ”‚  â”‚ Loki     â”‚      â”‚            â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="62-otel-collector-configuration">6.2 OTel Collector Configuration<a class="header-link" href="#62-otel-collector-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># otel-collector-config.yaml</span>
<span class="nt">receivers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">otlp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">protocols</span><span class="p">:</span>
<span class="w">      </span><span class="nt">grpc</span><span class="p">:</span>
<span class="w">        </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0:4317</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0:4318</span>

<span class="nt">processors</span><span class="p">:</span>
<span class="w">  </span><span class="nt">batch</span><span class="p">:</span>
<span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5s</span>
<span class="w">    </span><span class="nt">send_batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">memory_limiter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">check_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1s</span>
<span class="w">    </span><span class="nt">limit_mib</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512</span>

<span class="nt">exporters</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prometheus</span><span class="p">:</span>
<span class="w">    </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0:8889</span>
<span class="w">  </span><span class="nt">jaeger</span><span class="p">:</span>
<span class="w">    </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jaeger:14250</span>
<span class="w">    </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">      </span><span class="nt">insecure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">loki</span><span class="p">:</span>
<span class="w">    </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://loki:3100/loki/api/v1/push</span>

<span class="nt">service</span><span class="p">:</span>
<span class="w">  </span><span class="nt">pipelines</span><span class="p">:</span>
<span class="w">    </span><span class="nt">traces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">receivers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">otlp</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">processors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">memory_limiter</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">batch</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">exporters</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">jaeger</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">      </span><span class="nt">receivers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">otlp</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">processors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">memory_limiter</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">batch</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">exporters</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">prometheus</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">logs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">receivers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">otlp</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">processors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">memory_limiter</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">batch</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">exporters</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">loki</span><span class="p p-Indicator">]</span>
</code></pre></div>

<h3 id="63-instrumentation-example-python">6.3 Instrumentation Example (Python)<a class="header-link" href="#63-instrumentation-example-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">opentelemetry</span><span class="w"> </span><span class="kn">import</span> <span class="n">trace</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">opentelemetry.sdk.trace</span><span class="w"> </span><span class="kn">import</span> <span class="n">TracerProvider</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">opentelemetry.sdk.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MeterProvider</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">opentelemetry.exporter.otlp.proto.grpc.trace_exporter</span><span class="w"> </span><span class="kn">import</span> <span class="n">OTLPSpanExporter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">opentelemetry.sdk.trace.export</span><span class="w"> </span><span class="kn">import</span> <span class="n">BatchSpanProcessor</span>

<span class="c1"># Setup tracing</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">TracerProvider</span><span class="p">()</span>
<span class="n">provider</span><span class="o">.</span><span class="n">add_span_processor</span><span class="p">(</span>
    <span class="n">BatchSpanProcessor</span><span class="p">(</span><span class="n">OTLPSpanExporter</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="s2">&quot;localhost:4317&quot;</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">trace</span><span class="o">.</span><span class="n">set_tracer_provider</span><span class="p">(</span><span class="n">provider</span><span class="p">)</span>
<span class="n">tracer</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">get_tracer</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Setup metrics</span>
<span class="n">meter</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get_meter</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">request_counter</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="n">create_counter</span><span class="p">(</span>
    <span class="s2">&quot;http.requests&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total HTTP requests&quot;</span>
<span class="p">)</span>
<span class="n">request_duration</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="n">create_histogram</span><span class="p">(</span>
    <span class="s2">&quot;http.request.duration&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Request duration in ms&quot;</span>
<span class="p">)</span>

<span class="c1"># Usage</span>
<span class="nd">@tracer</span><span class="o">.</span><span class="n">start_as_current_span</span><span class="p">(</span><span class="s2">&quot;process_order&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
    <span class="n">request_counter</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;/orders&quot;</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">})</span>

    <span class="k">with</span> <span class="n">tracer</span><span class="o">.</span><span class="n">start_as_current_span</span><span class="p">(</span><span class="s2">&quot;validate_order&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">span</span><span class="p">:</span>
        <span class="n">span</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;order.id&quot;</span><span class="p">,</span> <span class="n">order_id</span><span class="p">)</span>
        <span class="n">validate</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">tracer</span><span class="o">.</span><span class="n">start_as_current_span</span><span class="p">(</span><span class="s2">&quot;charge_payment&quot;</span><span class="p">):</span>
        <span class="n">charge</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7-practice-problems">7. Practice Problems<a class="header-link" href="#7-practice-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-design-monitoring-for-a-microservices-platform">Problem 1: Design Monitoring for a Microservices Platform<a class="header-link" href="#problem-1-design-monitoring-for-a-microservices-platform" title="Permanent link">&para;</a></h3>
<p>You are designing the observability stack for an e-commerce platform with 20 microservices.</p>
<p><strong>Key considerations:</strong>
- What metrics would you collect from each service?
- How would you correlate logs across services?
- What sampling strategy for traces?
- Define SLOs for the checkout service.</p>
<div class="highlight"><pre><span></span><code>Example approach:

Metrics (RED for each service):
<span class="k">-</span> Rate: http_requests_total by service, method, status
<span class="k">-</span> Errors: http_requests_total{status=~&quot;5..&quot;} / total
<span class="k">-</span> Duration: http_request_duration_seconds histogram

Logging:
<span class="k">-</span> Structured JSON with trace_id in every log
<span class="k">-</span> Centralized via Loki or Elasticsearch
<span class="k">-</span> Retention: 7d hot, 30d warm, 90d archive

Tracing:
<span class="k">-</span> Tail-based sampling: keep all errors + p99 latencies
<span class="k">-</span> Head-based: 10% sample for normal traffic
<span class="k">-</span> Jaeger or Tempo as backend

Checkout SLOs:
<span class="k">-</span> Availability: 99.95% success rate (30-day window)
<span class="k">-</span> Latency: p99 &lt; 2s, p50 &lt; 500ms
<span class="k">-</span> Error budget: ~21.6 min/month
</code></pre></div>

<h3 id="problem-2-alert-design">Problem 2: Alert Design<a class="header-link" href="#problem-2-alert-design" title="Permanent link">&para;</a></h3>
<p>Design an alerting strategy that avoids alert fatigue.</p>
<div class="highlight"><pre><span></span><code>Example answer:

Multi-burn-rate alerting:
- 2% budget consumed in 1 hour  â†’ page (critical)
- 5% budget consumed in 6 hours â†’ page (warning)
- 10% budget consumed in 3 days â†’ ticket (low)

Routing:
- Critical â†’ PagerDuty â†’ on-call engineer
- Warning  â†’ Slack #alerts â†’ team lead
- Low      â†’ Jira ticket â†’ backlog

Every alert must have:
- Runbook link
- Dashboard link
- Expected impact
- Suggested remediation
</code></pre></div>

<h3 id="problem-3-observability-cost-optimization">Problem 3: Observability Cost Optimization<a class="header-link" href="#problem-3-observability-cost-optimization" title="Permanent link">&para;</a></h3>
<p>Your team spends $50K/month on observability. Reduce costs by 40%.</p>
<div class="highlight"><pre><span></span><code><span class="nx">Example</span><span class="w"> </span><span class="nx">answer</span><span class="p">:</span>

<span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Metrics</span><span class="p">:</span><span class="w"> </span><span class="nx">Drop</span><span class="w"> </span><span class="nx">unused</span><span class="w"> </span><span class="nx">metrics</span><span class="w"> </span><span class="p">(</span><span class="nx">audit</span><span class="w"> </span><span class="nx">dashboards</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Reduce</span><span class="w"> </span><span class="nx">cardinality</span><span class="w"> </span><span class="p">(</span><span class="nx">fewer</span><span class="w"> </span><span class="nx">label</span><span class="w"> </span><span class="nx">values</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Increase</span><span class="w"> </span><span class="nx">scrape</span><span class="w"> </span><span class="nx">intervals</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">non</span><span class="o">-</span><span class="nx">critical</span><span class="w"> </span><span class="nx">services</span><span class="w"> </span><span class="p">(</span><span class="mi">15</span><span class="nx">s</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">60</span><span class="nx">s</span><span class="p">)</span>

<span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Logs</span><span class="p">:</span><span class="w"> </span><span class="nx">Switch</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">ELK</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">Loki</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Stop</span><span class="w"> </span><span class="nx">indexing</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">log</span><span class="w"> </span><span class="nx">content</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Reduce</span><span class="w"> </span><span class="nx">log</span><span class="w"> </span><span class="nx">verbosity</span><span class="w"> </span><span class="p">(</span><span class="nx">DEBUG</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="nx">INFO</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">production</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Shorter</span><span class="w"> </span><span class="nx">retention</span><span class="w"> </span><span class="p">(</span><span class="mi">90</span><span class="nx">d</span><span class="w"> </span><span class="err">â†’</span><span class="w"> </span><span class="mi">30</span><span class="nx">d</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">non</span><span class="o">-</span><span class="nx">regulated</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>

<span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Traces</span><span class="p">:</span><span class="w"> </span><span class="nx">Implement</span><span class="w"> </span><span class="nx">tail</span><span class="o">-</span><span class="nx">based</span><span class="w"> </span><span class="nx">sampling</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Keep</span><span class="w"> </span><span class="mi">100</span><span class="o">%</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">errors</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">slow</span><span class="w"> </span><span class="nx">traces</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Sample</span><span class="w"> </span><span class="mi">1</span><span class="o">%</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">successful</span><span class="w"> </span><span class="nx">traces</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Use</span><span class="w"> </span><span class="nx">Grafana</span><span class="w"> </span><span class="nx">Tempo</span><span class="w"> </span><span class="p">(</span><span class="nx">cheaper</span><span class="w"> </span><span class="nx">than</span><span class="w"> </span><span class="nx">Jaeger</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">scale</span><span class="p">)</span>

<span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="nx">Architecture</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="k">Self</span><span class="o">-</span><span class="nx">host</span><span class="w"> </span><span class="nx">OpenTelemetry</span><span class="w"> </span><span class="nx">Collector</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Use</span><span class="w"> </span><span class="nx">object</span><span class="w"> </span><span class="nx">storage</span><span class="w"> </span><span class="p">(</span><span class="nx">S3</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">cold</span><span class="w"> </span><span class="nx">data</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nx">Aggregate</span><span class="w"> </span><span class="nx">metrics</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">collector</span><span class="w"> </span><span class="nx">level</span>
</code></pre></div>

<hr />
<h2 id="next-steps">Next Steps<a class="header-link" href="#next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./20_Search_Systems.md">20. Search Systems</a></li>
<li><a href="./13_Microservices_Basics.md">13. Microservices Basics</a></li>
</ul>
<h2 id="references">References<a class="header-link" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://sre.google/sre-book/monitoring-distributed-systems/">Google SRE Book: Monitoring</a></li>
<li><a href="https://opentelemetry.io/docs/">OpenTelemetry Documentation</a></li>
<li><a href="https://prometheus.io/docs/">Prometheus Documentation</a></li>
<li><a href="https://grafana.com/oss/loki/">Grafana Loki</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/en/System_Design/18_Design_Example_2.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Practical Design Examples 2</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/en/System_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/en/System_Design/20_Search_Systems.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">20. Search Systems</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'en';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}