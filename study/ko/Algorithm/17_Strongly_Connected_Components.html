{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>24. ê°•í•œ ì—°ê²° ìš”ì†Œ (Strongly Connected Components) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Algorithm/">Algorithm</a>
    <span class="separator">/</span>
    <span class="current">24. ê°•í•œ ì—°ê²° ìš”ì†Œ (Strongly Connected Components)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>24. ê°•í•œ ì—°ê²° ìš”ì†Œ (Strongly Connected Components)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Algorithm/16_LCA_and_Tree_Queries.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">26. LCAì™€ íŠ¸ë¦¬ì¿¼ë¦¬ (LCA and Tree Queries)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Algorithm/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Algorithm/18_Dynamic_Programming.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë™ì  í”„ë¡œê·¸ë˜ë° (Dynamic Programming)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ê°•í•œ ì—°ê²° ìš”ì†Œë€?</a><ul>
<li><a href="#_2">ì •ì˜</a></li>
<li><a href="#_3">íŠ¹ì„±</a></li>
<li><a href="#scc">SCCì˜ í™œìš©</a></li>
</ul>
</li>
<li><a href="#2-kosaraju">2. Kosaraju ì•Œê³ ë¦¬ì¦˜</a><ul>
<li><a href="#_4">í•µì‹¬ ì•„ì´ë””ì–´</a></li>
<li><a href="#_5">ë™ì‘ ì›ë¦¬</a></li>
<li><a href="#_6">êµ¬í˜„</a></li>
<li><a href="#c">C++ êµ¬í˜„</a></li>
<li><a href="#_7">ì‹œê°„ ë³µì¡ë„</a></li>
</ul>
</li>
<li><a href="#3-tarjan">3. Tarjan ì•Œê³ ë¦¬ì¦˜</a><ul>
<li><a href="#_8">í•µì‹¬ ì•„ì´ë””ì–´</a></li>
<li><a href="#_9">ë™ì‘ ì›ë¦¬</a></li>
<li><a href="#_10">ì‹œê°í™”</a></li>
<li><a href="#_11">êµ¬í˜„</a></li>
<li><a href="#c_1">C++ êµ¬í˜„</a></li>
<li><a href="#kosaraju-vs-tarjan">Kosaraju vs Tarjan ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#4-condensation-graph">4. ì‘ì¶• ê·¸ë˜í”„ (Condensation Graph)</a><ul>
<li><a href="#_12">ê°œë…</a></li>
<li><a href="#_13">êµ¬í˜„</a></li>
<li><a href="#_14">ì‘ì¶• ê·¸ë˜í”„ í™œìš©</a></li>
</ul>
</li>
<li><a href="#5-2-sat">5. 2-SAT ë¬¸ì œ</a><ul>
<li><a href="#_15">ê°œë…</a></li>
<li><a href="#_16">ê·¸ë˜í”„ ë³€í™˜</a></li>
<li><a href="#_17">ë§Œì¡± ê°€ëŠ¥ì„± íŒë³„</a></li>
<li><a href="#_18">êµ¬í˜„</a></li>
<li><a href="#2-sat">2-SAT ì‘ìš© ë¬¸ì œ</a></li>
</ul>
</li>
<li><a href="#6">6. ì‹¤ì „ ë¬¸ì œ íŒ¨í„´</a><ul>
<li><a href="#1-scc">íŒ¨í„´ 1: SCC ê°œìˆ˜ ì„¸ê¸°</a></li>
<li><a href="#2">íŒ¨í„´ 2: ëª¨ë“  ë…¸ë“œ ë„ë‹¬ ê°€ëŠ¥í•œ ì‹œì‘ì </a></li>
<li><a href="#3">íŒ¨í„´ 3: ìµœì†Œ ê°„ì„  ì¶”ê°€ë¡œ ê°•í•œ ì—°ê²°</a></li>
<li><a href="#4">íŒ¨í„´ 4: ë°©í–¥ ê·¸ë˜í”„ì—ì„œ ì‚¬ì´í´ ë…¸ë“œ</a></li>
</ul>
</li>
<li><a href="#7">7. ì‹œê°„ ë³µì¡ë„ ì •ë¦¬</a></li>
<li><a href="#8">8. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜</a><ul>
<li><a href="#1-on_stack">ì‹¤ìˆ˜ 1: on_stack ì²´í¬ ëˆ„ë½</a></li>
<li><a href="#2-2-sat">ì‹¤ìˆ˜ 2: 2-SAT ë…¸ë“œ ë²ˆí˜¸ ê³„ì‚° ì˜¤ë¥˜</a></li>
<li><a href="#3_1">ì‹¤ìˆ˜ 3: ì‘ì¶• ê·¸ë˜í”„ ì¤‘ë³µ ê°„ì„ </a></li>
</ul>
</li>
<li><a href="#9">9. ì—°ìŠµ ë¬¸ì œ</a></li>
<li><a href="#_19">ë‹¤ìŒ ë‹¨ê³„</a></li>
<li><a href="#_20">í•™ìŠµ ì ê²€</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="24-strongly-connected-components">24. ê°•í•œ ì—°ê²° ìš”ì†Œ (Strongly Connected Components)<a class="header-link" href="#24-strongly-connected-components" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ê°•í•œ ì—°ê²° ìš”ì†Œ(SCC)ì˜ ê°œë… ì´í•´</li>
<li>Tarjan ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„</li>
<li>Kosaraju ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„</li>
<li>2-SAT ë¬¸ì œ í•´ê²°</li>
<li>ì‘ì¶• ê·¸ë˜í”„(DAG) í™œìš©</li>
</ul>
<h2 id="1">1. ê°•í•œ ì—°ê²° ìš”ì†Œë€?<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="_2">ì •ì˜<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<p><strong>ë°©í–¥ ê·¸ë˜í”„</strong>ì—ì„œ <strong>ê°•í•œ ì—°ê²° ìš”ì†Œ(SCC)</strong>ë€ ëª¨ë“  ì •ì  ìŒ (u, v)ì— ëŒ€í•´ uâ†’v, vâ†’u ê²½ë¡œê°€ ëª¨ë‘ ì¡´ì¬í•˜ëŠ” <strong>ìµœëŒ€</strong> ë¶€ë¶„ ê·¸ë˜í”„ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  SCC 1    â”‚
    â”‚  â”Œâ†’1â†’â”€â”   â”‚
    â”‚  â”‚    â†“   â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”
    â”‚  4â†â”€â”€2    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ SCC 2 â”‚
    â”‚      â†“    â”‚         â”‚  5â†’6  â”‚
    â”‚      3â†â”€â”€â”€â”‚         â”‚  â†‘ â†“  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  8â†7  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="_3">íŠ¹ì„±<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ìµœëŒ€ì„±</strong>: SCCì— ì •ì ì„ ì¶”ê°€í•˜ë©´ ë” ì´ìƒ ê°•í•˜ê²Œ ì—°ê²°ë˜ì§€ ì•ŠìŒ</li>
<li><strong>ë¶„í• ì„±</strong>: ëª¨ë“  ì •ì ì€ ì •í™•íˆ í•˜ë‚˜ì˜ SCCì— ì†í•¨</li>
<li><strong>DAG êµ¬ì¡°</strong>: SCCë“¤ì„ í•˜ë‚˜ì˜ ë…¸ë“œë¡œ ë³´ë©´ DAG(ë¹„ìˆœí™˜ ë°©í–¥ ê·¸ë˜í”„)ê°€ ë¨</li>
</ol>
<h3 id="scc">SCCì˜ í™œìš©<a class="header-link" href="#scc" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SCC í™œìš© ë¶„ì•¼                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ 2-SAT ë¬¸ì œ í•´ê²°                               â”‚
â”‚  â€¢ ë°ë“œë½ ê°ì§€                                   â”‚
â”‚  â€¢ ì†Œì…œ ë„¤íŠ¸ì›Œí¬ ë¶„ì„ (ì»¤ë®¤ë‹ˆí‹° íƒì§€)              â”‚
â”‚  â€¢ ì›¹ í˜ì´ì§€ í´ëŸ¬ìŠ¤í„°ë§                          â”‚
â”‚  â€¢ ì»´íŒŒì¼ëŸ¬ ìµœì í™” (ìˆœí™˜ ì˜ì¡´ì„± ë¶„ì„)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-kosaraju">2. Kosaraju ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#2-kosaraju" title="Permanent link">&para;</a></h2>
<h3 id="_4">í•µì‹¬ ì•„ì´ë””ì–´<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li>ì›ë³¸ ê·¸ë˜í”„ì—ì„œ DFSë¡œ ì¢…ë£Œ ìˆœì„œ ê¸°ë¡</li>
<li>ì—­ë°©í–¥ ê·¸ë˜í”„ì—ì„œ ì¢…ë£Œ ìˆœì„œì˜ ì—­ìˆœìœ¼ë¡œ DFS</li>
<li>ê° DFS íŠ¸ë¦¬ê°€ í•˜ë‚˜ì˜ SCC</li>
</ol>
<h3 id="_5">ë™ì‘ ì›ë¦¬<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Step 1: ì›ë³¸ ê·¸ë˜í”„ DFS (ì¢…ë£Œ ìˆœì„œ ê¸°ë¡)
        1 â†’ 2 â†’ 3
        â†‘       â†“
        â””â”€â”€â”€â”€â”€â”€â”€â”˜

        ì¢…ë£Œ ìˆœì„œ: [3, 2, 1]

Step 2: ê·¸ë˜í”„ ì—­ë°©í–¥ ë³€í™˜
        1 â† 2 â† 3
        â†“       â†‘
        â””â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: ì—­ìˆœìœ¼ë¡œ DFS (1ë¶€í„° ì‹œì‘)
        1 â†’ 3 â†’ 2 â†’ (1ë¡œ ëŒì•„ì˜´)

        SCC: {1, 2, 3}
</code></pre></div>

<h3 id="_6">êµ¬í˜„<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KosarajuSCC</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reverse_graph</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reverse_graph</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_sccs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Step 1: ì›ë³¸ ê·¸ë˜í”„ì—ì„œ DFS, ì¢…ë£Œ ìˆœì„œ ê¸°ë¡</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">finish_order</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">dfs1</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="n">visited</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]:</span>
                    <span class="n">dfs1</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
            <span class="n">finish_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">dfs1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># Step 2: ì—­ë°©í–¥ ê·¸ë˜í”„ì—ì„œ ì—­ìˆœìœ¼ë¡œ DFS</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">sccs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">dfs2</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">component</span><span class="p">):</span>
            <span class="n">visited</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">component</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse_graph</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]:</span>
                    <span class="n">dfs2</span><span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>

        <span class="c1"># ì¢…ë£Œ ìˆœì„œì˜ ì—­ìˆœìœ¼ë¡œ ì²˜ë¦¬</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">finish_order</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">dfs2</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
                <span class="n">sccs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sccs</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="n">scc</span> <span class="o">=</span> <span class="n">KosarajuSCC</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="n">scc</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">scc</span><span class="o">.</span><span class="n">find_sccs</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SCCs:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="c1"># SCCs: [[7], [4, 6, 5], [3], [0, 2, 1]]</span>
</code></pre></div>

<h3 id="c">C++ êµ¬í˜„<a class="header-link" href="#c" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KosarajuSCC</span><span class="w"> </span><span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">graph</span><span class="p">,</span><span class="w"> </span><span class="n">reverseGraph</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">visited</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">finishOrder</span><span class="p">;</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">visited</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visited</span><span class="p">[</span><span class="n">next</span><span class="p">])</span><span class="w"> </span><span class="n">dfs1</span><span class="p">(</span><span class="n">next</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">finishOrder</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">dfs2</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">component</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">visited</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">component</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">reverseGraph</span><span class="p">[</span><span class="n">node</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visited</span><span class="p">[</span><span class="n">next</span><span class="p">])</span><span class="w"> </span><span class="n">dfs2</span><span class="p">(</span><span class="n">next</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">KosarajuSCC</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">graph</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">reverseGraph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">addEdge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="n">reverseGraph</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">findSCCs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Step 1</span>
<span class="w">        </span><span class="n">visited</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="n">dfs1</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Step 2</span>
<span class="w">        </span><span class="n">visited</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="w">        </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">sccs</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finishOrder</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visited</span><span class="p">[</span><span class="n">node</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">component</span><span class="p">;</span>
<span class="w">                </span><span class="n">dfs2</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">component</span><span class="p">);</span>
<span class="w">                </span><span class="n">sccs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">component</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sccs</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</code></pre></div>

<h3 id="_7">ì‹œê°„ ë³µì¡ë„<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ì‹œê°„</strong>: O(V + E) - DFS 2ë²ˆ</li>
<li><strong>ê³µê°„</strong>: O(V + E) - ì—­ë°©í–¥ ê·¸ë˜í”„ ì €ì¥</li>
</ul>
<hr />
<h2 id="3-tarjan">3. Tarjan ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#3-tarjan" title="Permanent link">&para;</a></h2>
<h3 id="_8">í•µì‹¬ ì•„ì´ë””ì–´<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<p>ë‹¨ì¼ DFSë¡œ SCCë¥¼ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜. <strong>ë°œê²¬ ì‹œê°„</strong>ê³¼ <strong>low-link ê°’</strong>ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<ul>
<li><strong>ë°œê²¬ ì‹œê°„ (disc)</strong>: ë…¸ë“œë¥¼ ì²˜ìŒ ë°©ë¬¸í•œ ì‹œì </li>
<li><strong>Low-link (low)</strong>: í•´ë‹¹ ë…¸ë“œì—ì„œ ë„ë‹¬ ê°€ëŠ¥í•œ ê°€ì¥ ì‘ì€ ë°œê²¬ ì‹œê°„</li>
</ul>
<h3 id="_9">ë™ì‘ ì›ë¦¬<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">ë…¸ë“œ</span><span class="w"> </span><span class="n">ë°©ë¬¸</span><span class="w"> </span><span class="nl">ì‹œ</span><span class="p">:</span>
<span class="mf">1.</span><span class="w"> </span><span class="n">disc</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">í˜„ì¬</span><span class="w"> </span><span class="n">ì‹œê°„</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">ìŠ¤íƒì—</span><span class="w"> </span><span class="n">push</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">ì´ì›ƒ</span><span class="w"> </span><span class="nl">íƒìƒ‰</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="nl">ë¯¸ë°©ë¬¸</span><span class="p">:</span><span class="w"> </span><span class="n">ì¬ê·€</span><span class="w"> </span><span class="n">í˜¸ì¶œ</span><span class="w"> </span><span class="n">í›„</span><span class="w"> </span><span class="n">low</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">low</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="o">[</span><span class="n">neighbor</span><span class="o">]</span><span class="p">)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">ìŠ¤íƒì—</span><span class="w"> </span><span class="nl">ìˆìŒ</span><span class="p">:</span><span class="w"> </span><span class="n">low</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">low</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">disc</span><span class="o">[</span><span class="n">neighbor</span><span class="o">]</span><span class="p">)</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">disc</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">low</span><span class="o">[</span><span class="n">node</span><span class="o">]</span><span class="n">ì´ë©´</span><span class="w"> </span><span class="n">SCCì˜</span><span class="w"> </span><span class="n">ë£¨íŠ¸</span>
<span class="w">   </span><span class="err">â†’</span><span class="w"> </span><span class="n">ìŠ¤íƒì—ì„œ</span><span class="w"> </span><span class="n">nodeê¹Œì§€</span><span class="w"> </span><span class="n">popí•˜ì—¬</span><span class="w"> </span><span class="n">SCC</span><span class="w"> </span><span class="n">êµ¬ì„±</span>
</code></pre></div>

<h3 id="_10">ì‹œê°í™”<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>DFS ì§„í–‰:
ë…¸ë“œ:  1 â†’ 2 â†’ 3 â†’ 1(back edge)
disc: [1,  2,  3]
low:  [1,  1,  1]  â† 3ì—ì„œ 1ë¡œ ê°€ëŠ” back edgeë¡œ ì¸í•´ ì—…ë°ì´íŠ¸

ë…¸ë“œ 1ì—ì„œ: disc[1] == low[1] = 1
â†’ SCC ë°œê²¬: {1, 2, 3}
</code></pre></div>

<h3 id="_11">êµ¬í˜„<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TarjanSCC</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disc</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>      <span class="c1"># ë°œê²¬ ì‹œê°„</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>       <span class="c1"># low-link ê°’</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_stack</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sccs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_stack</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1"># ë¯¸ë°©ë¬¸ ë…¸ë“œ</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="n">neighbor</span><span class="p">])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_stack</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]:</span>
                <span class="c1"># ìŠ¤íƒì— ìˆëŠ” ë…¸ë“œ (back edge)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">])</span>

        <span class="c1"># SCCì˜ ë£¨íŠ¸ì¸ ê²½ìš°</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="n">component</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_stack</span><span class="p">[</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">component</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">top</span> <span class="o">==</span> <span class="n">node</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sccs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_sccs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sccs</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="n">tarjan</span> <span class="o">=</span> <span class="n">TarjanSCC</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="n">tarjan</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">tarjan</span><span class="o">.</span><span class="n">find_sccs</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SCCs:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="c1"># SCCs: [[2, 1, 0], [6, 5, 4], [3], [7]]</span>
</code></pre></div>

<h3 id="c_1">C++ êµ¬í˜„<a class="header-link" href="#c_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TarjanSCC</span><span class="w"> </span><span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">graph</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">disc</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onStack</span><span class="p">;</span>
<span class="w">    </span><span class="n">stack</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">st</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">sccs</span><span class="p">;</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">disc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timer</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="w">        </span><span class="n">onStack</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">disc</span><span class="p">[</span><span class="n">next</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">dfs</span><span class="p">(</span><span class="n">next</span><span class="p">);</span>
<span class="w">                </span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">next</span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">onStack</span><span class="p">[</span><span class="n">next</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span><span class="w"> </span><span class="n">disc</span><span class="p">[</span><span class="n">next</span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">disc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">component</span><span class="p">;</span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">                </span><span class="n">onStack</span><span class="p">[</span><span class="n">top</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">                </span><span class="n">component</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">top</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">top</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">sccs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">component</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">TarjanSCC</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">graph</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">disc</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">),</span><span class="w"> </span><span class="n">low</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">),</span><span class="w"> </span><span class="n">onStack</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">addEdge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">findSCCs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">disc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sccs</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</code></pre></div>

<h3 id="kosaraju-vs-tarjan">Kosaraju vs Tarjan ë¹„êµ<a class="header-link" href="#kosaraju-vs-tarjan" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>íŠ¹ì„±</th>
<th>Kosaraju</th>
<th>Tarjan</th>
</tr>
</thead>
<tbody>
<tr>
<td>DFS íšŸìˆ˜</td>
<td>2ë²ˆ</td>
<td>1ë²ˆ</td>
</tr>
<tr>
<td>ì¶”ê°€ ê³µê°„</td>
<td>ì—­ë°©í–¥ ê·¸ë˜í”„ O(V+E)</td>
<td>ìŠ¤íƒ O(V)</td>
</tr>
<tr>
<td>êµ¬í˜„ ë³µì¡ë„</td>
<td>ì§ê´€ì </td>
<td>ì•½ê°„ ë³µì¡</td>
</tr>
<tr>
<td>ì˜¨ë¼ì¸ ì²˜ë¦¬</td>
<td>ë¶ˆê°€ëŠ¥</td>
<td>ê°€ëŠ¥</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-condensation-graph">4. ì‘ì¶• ê·¸ë˜í”„ (Condensation Graph)<a class="header-link" href="#4-condensation-graph" title="Permanent link">&para;</a></h2>
<h3 id="_12">ê°œë…<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<p>ê° SCCë¥¼ í•˜ë‚˜ì˜ ë…¸ë“œë¡œ <strong>ì••ì¶•</strong>í•˜ë©´ <strong>DAG</strong>ê°€ ë©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>ì›ë³¸ ê·¸ë˜í”„:                    ì‘ì¶• ê·¸ë˜í”„ (DAG):
    1 â†â†’ 2                         SCC0
    â†“     â†“                          â†“
    4 â†â†’ 3 â†’ 5 â†’ 6                 SCC1 â†’ SCC2
              â†‘   â†“
              8 â† 7

SCC0 = {1,2,3,4}
SCC1 = {5,6,7,8}  â†’ í•˜ë‚˜ì˜ ìˆœí™˜
SCC2 = ... (ë§Œì•½ ìˆë‹¤ë©´)
</code></pre></div>

<h3 id="_13">êµ¬í˜„<a class="header-link" href="#_13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_condensation_graph</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
    <span class="c1"># 1. SCC ì°¾ê¸°</span>
    <span class="n">tarjan</span> <span class="o">=</span> <span class="n">TarjanSCC</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">tarjan</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">sccs</span> <span class="o">=</span> <span class="n">tarjan</span><span class="o">.</span><span class="n">find_sccs</span><span class="p">()</span>

    <span class="c1"># 2. ê° ë…¸ë“œê°€ ì†í•œ SCC ë²ˆí˜¸ ë§¤í•‘</span>
    <span class="n">scc_id</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sccs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">component</span><span class="p">:</span>
            <span class="n">scc_id</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

    <span class="c1"># 3. ì‘ì¶• ê·¸ë˜í”„ êµ¬ì„±</span>
    <span class="n">num_sccs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sccs</span><span class="p">)</span>
    <span class="n">condensed</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">su</span><span class="p">,</span> <span class="n">sv</span> <span class="o">=</span> <span class="n">scc_id</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">scc_id</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">su</span> <span class="o">!=</span> <span class="n">sv</span><span class="p">:</span>
            <span class="n">condensed</span><span class="p">[</span><span class="n">su</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sv</span><span class="p">)</span>

    <span class="c1"># setì„ listë¡œ ë³€í™˜</span>
    <span class="n">condensed</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">neighbors</span><span class="p">)</span> <span class="k">for</span> <span class="n">neighbors</span> <span class="ow">in</span> <span class="n">condensed</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">sccs</span><span class="p">,</span> <span class="n">scc_id</span><span class="p">,</span> <span class="n">condensed</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)]</span>
<span class="n">sccs</span><span class="p">,</span> <span class="n">scc_id</span><span class="p">,</span> <span class="n">dag</span> <span class="o">=</span> <span class="n">build_condensation_graph</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SCCs:&quot;</span><span class="p">,</span> <span class="n">sccs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DAG edges:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">neighbors</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dag</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SCC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> â†’ SCC</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_14">ì‘ì¶• ê·¸ë˜í”„ í™œìš©<a class="header-link" href="#_14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">count_reachable_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ê° ë…¸ë“œì—ì„œ ë„ë‹¬ ê°€ëŠ¥í•œ ë…¸ë“œ ìˆ˜ ê³„ì‚°</span>
<span class="sd">    ì‘ì¶• ê·¸ë˜í”„ì—ì„œ DAG DPë¡œ íš¨ìœ¨ì  ê³„ì‚°</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sccs</span><span class="p">,</span> <span class="n">scc_id</span><span class="p">,</span> <span class="n">dag</span> <span class="o">=</span> <span class="n">build_condensation_graph</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
    <span class="n">num_sccs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sccs</span><span class="p">)</span>

    <span class="c1"># ìœ„ìƒ ì •ë ¬ ìˆœì„œë¡œ ì²˜ë¦¬</span>
    <span class="n">in_degree</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_sccs</span>
    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dag</span><span class="p">[</span><span class="n">u</span><span class="p">]:</span>
            <span class="n">in_degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># ê° SCCì—ì„œ ë„ë‹¬ ê°€ëŠ¥í•œ ë…¸ë“œ ì§‘í•©</span>
    <span class="n">reachable</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">sccs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">)]</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">)</span> <span class="k">if</span> <span class="n">in_degree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="n">order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">next_node</span> <span class="ow">in</span> <span class="n">dag</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="n">in_degree</span><span class="p">[</span><span class="n">next_node</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">in_degree</span><span class="p">[</span><span class="n">next_node</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_node</span><span class="p">)</span>

    <span class="c1"># ì—­ìˆœìœ¼ë¡œ ë„ë‹¬ ê°€ëŠ¥ ë…¸ë“œ ì§‘í•© ì „íŒŒ</span>
    <span class="k">for</span> <span class="n">scc</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">next_scc</span> <span class="ow">in</span> <span class="n">dag</span><span class="p">[</span><span class="n">scc</span><span class="p">]:</span>
            <span class="n">reachable</span><span class="p">[</span><span class="n">scc</span><span class="p">]</span> <span class="o">|=</span> <span class="n">reachable</span><span class="p">[</span><span class="n">next_scc</span><span class="p">]</span>

    <span class="c1"># ê° ì›ë³¸ ë…¸ë“œì˜ ë„ë‹¬ ê°€ëŠ¥ ë…¸ë“œ ìˆ˜</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reachable</span><span class="p">[</span><span class="n">scc_id</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>

<hr />
<h2 id="5-2-sat">5. 2-SAT ë¬¸ì œ<a class="header-link" href="#5-2-sat" title="Permanent link">&para;</a></h2>
<h3 id="_15">ê°œë…<a class="header-link" href="#_15" title="Permanent link">&para;</a></h3>
<p>2-SATì€ ê° ì ˆ(clause)ì— <strong>ì •í™•íˆ 2ê°œì˜ ë¦¬í„°ëŸ´</strong>ì´ ìˆëŠ” ë…¼ë¦¬ì‹ì˜ ë§Œì¡± ê°€ëŠ¥ì„±ì„ íŒë³„í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>ì˜ˆ: (xâ‚ âˆ¨ xâ‚‚) âˆ§ (Â¬xâ‚ âˆ¨ xâ‚ƒ) âˆ§ (Â¬xâ‚‚ âˆ¨ Â¬xâ‚ƒ)

ë¦¬í„°ëŸ´: xâ‚, Â¬xâ‚, xâ‚‚, Â¬xâ‚‚, xâ‚ƒ, Â¬xâ‚ƒ
ì ˆ: (a âˆ¨ b) í˜•íƒœ
</code></pre></div>

<h3 id="_16">ê·¸ë˜í”„ ë³€í™˜<a class="header-link" href="#_16" title="Permanent link">&para;</a></h3>
<p><strong>í•µì‹¬</strong>: (a âˆ¨ b) = (Â¬a â†’ b) âˆ§ (Â¬b â†’ a)</p>
<div class="highlight"><pre><span></span><code>ì ˆ (xâ‚ âˆ¨ xâ‚‚):
  Â¬xâ‚ â†’ xâ‚‚  (xâ‚ì´ ê±°ì§“ì´ë©´ xâ‚‚ëŠ” ì°¸)
  Â¬xâ‚‚ â†’ xâ‚  (xâ‚‚ê°€ ê±°ì§“ì´ë©´ xâ‚ì€ ì°¸)

ë³€ìˆ˜ xiì— ëŒ€í•´:
  ë…¸ë“œ 2i: xi
  ë…¸ë“œ 2i+1: Â¬xi
</code></pre></div>

<h3 id="_17">ë§Œì¡± ê°€ëŠ¥ì„± íŒë³„<a class="header-link" href="#_17" title="Permanent link">&para;</a></h3>
<p><strong>ì •ë¦¬</strong>: 2-SAT ì‹ì´ ë§Œì¡± ê°€ëŠ¥ âŸº ì–´ë–¤ ë³€ìˆ˜ xì— ëŒ€í•´ì„œë„ xì™€ Â¬xê°€ ê°™ì€ SCCì— ì†í•˜ì§€ ì•ŠìŒ</p>
<h3 id="_18">êµ¬í˜„<a class="header-link" href="#_18" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TwoSAT</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;nê°œì˜ ë³€ìˆ˜ (0 ~ n-1)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_clause</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">neg_a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">neg_b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        (a âˆ¨ b) ì ˆ ì¶”ê°€</span>
<span class="sd">        a, b: ë³€ìˆ˜ ì¸ë±ìŠ¤ (0 ~ n-1)</span>
<span class="sd">        neg_a, neg_b: Trueë©´ ë¶€ì •</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># ë¦¬í„°ëŸ´ â†’ ë…¸ë“œ ë²ˆí˜¸</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">to_node</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">negated</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">var</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">negated</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">node_a</span> <span class="o">=</span> <span class="n">to_node</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">neg_a</span><span class="p">)</span>
        <span class="n">node_b</span> <span class="o">=</span> <span class="n">to_node</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">neg_b</span><span class="p">)</span>
        <span class="n">not_a</span> <span class="o">=</span> <span class="n">to_node</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="ow">not</span> <span class="n">neg_a</span><span class="p">)</span>
        <span class="n">not_b</span> <span class="o">=</span> <span class="n">to_node</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="ow">not</span> <span class="n">neg_b</span><span class="p">)</span>

        <span class="c1"># Â¬a â†’ b, Â¬b â†’ a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">not_a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">not_b</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_a</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;(a âˆ¨ b) - ë‘˜ ì¤‘ í•˜ë‚˜ëŠ” ì°¸&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_implies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;a â†’ b (aì´ë©´ b)&quot;&quot;&quot;</span>
        <span class="c1"># a â†’ b = Â¬a âˆ¨ b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_xor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;a XOR b (ì •í™•íˆ í•˜ë‚˜ë§Œ ì°¸)&quot;&quot;&quot;</span>
        <span class="c1"># (a âˆ¨ b) âˆ§ (Â¬a âˆ¨ Â¬b)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;a = b (ë‘˜ ë‹¤ ê°™ì€ ê°’)&quot;&quot;&quot;</span>
        <span class="c1"># (a â†’ b) âˆ§ (b â†’ a)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_implies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_implies</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë³€ìˆ˜ aë¥¼ ë°˜ë“œì‹œ ì°¸ìœ¼ë¡œ&quot;&quot;&quot;</span>
        <span class="c1"># a âˆ¨ a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_false</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë³€ìˆ˜ aë¥¼ ë°˜ë“œì‹œ ê±°ì§“ìœ¼ë¡œ&quot;&quot;&quot;</span>
        <span class="c1"># Â¬a âˆ¨ Â¬a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ë§Œì¡± ê°€ëŠ¥í•˜ë©´ ê° ë³€ìˆ˜ì˜ ê°’ ë°˜í™˜, ë¶ˆê°€ëŠ¥í•˜ë©´ None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Tarjanìœ¼ë¡œ SCC ì°¾ê¸°</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">disc</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">low</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">on_stack</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">scc_id</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">scc_count</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="n">disc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">timer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">timer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">on_stack</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">dfs</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
                    <span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">low</span><span class="p">[</span><span class="n">neighbor</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">on_stack</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]:</span>
                    <span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">disc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">on_stack</span><span class="p">[</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">scc_id</span><span class="p">[</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">scc_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">top</span> <span class="o">==</span> <span class="n">node</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="n">scc_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">disc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># ë§Œì¡± ê°€ëŠ¥ì„± í™•ì¸</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">scc_id</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">scc_id</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># xì™€ Â¬xê°€ ê°™ì€ SCC</span>

        <span class="c1"># ê°’ ê²°ì •: SCC ë²ˆí˜¸ê°€ ë” í° ìª½ì´ ì°¸</span>
        <span class="c1"># (Tarjanì€ ì—­ìœ„ìƒ ìˆœì„œë¡œ SCC ë²ˆí˜¸ ë¶€ì—¬)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
            <span class="c1"># xì˜ SCC ë²ˆí˜¸ &gt; Â¬xì˜ SCC ë²ˆí˜¸ë©´ x = True</span>
            <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">scc_id</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">scc_id</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="n">sat</span> <span class="o">=</span> <span class="n">TwoSAT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># ë³€ìˆ˜: x0, x1, x2</span>

<span class="c1"># (x0 âˆ¨ x1) âˆ§ (Â¬x0 âˆ¨ x2) âˆ§ (Â¬x1 âˆ¨ Â¬x2)</span>
<span class="n">sat</span><span class="o">.</span><span class="n">add_or</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>                    <span class="c1"># x0 âˆ¨ x1</span>
<span class="n">sat</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>   <span class="c1"># Â¬x0 âˆ¨ x2</span>
<span class="n">sat</span><span class="o">.</span><span class="n">add_clause</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>    <span class="c1"># Â¬x1 âˆ¨ Â¬x2</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sat</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë§Œì¡± ê°€ëŠ¥:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="c1"># ê²€ì¦</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">result</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x0=</span><span class="si">{</span><span class="n">x0</span><span class="si">}</span><span class="s2">, x1=</span><span class="si">{</span><span class="n">x1</span><span class="si">}</span><span class="s2">, x2=</span><span class="si">{</span><span class="n">x2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">clause1</span> <span class="o">=</span> <span class="n">x0</span> <span class="ow">or</span> <span class="n">x1</span>
    <span class="n">clause2</span> <span class="o">=</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">x2</span>
    <span class="n">clause3</span> <span class="o">=</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²€ì¦: </span><span class="si">{</span><span class="n">clause1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">clause2</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">clause3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë§Œì¡± ë¶ˆê°€ëŠ¥&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-sat">2-SAT ì‘ìš© ë¬¸ì œ<a class="header-link" href="#2-sat" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">team_assignment</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">conflicts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    nëª…ì„ 2ê°œ íŒ€ìœ¼ë¡œ ë‚˜ëˆ„ê¸°</span>
<span class="sd">    conflicts[i] = (a, b): aì™€ bëŠ” ê°™ì€ íŒ€ ë¶ˆê°€</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="n">TwoSAT</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">conflicts</span><span class="p">:</span>
        <span class="c1"># aì™€ bê°€ ë‹¤ë¥¸ íŒ€</span>
        <span class="c1"># team[a] XOR team[b] = True</span>
        <span class="n">sat</span><span class="o">.</span><span class="n">add_xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">sat</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">team1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">team2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">team1</span><span class="p">,</span> <span class="n">team2</span>

<span class="c1"># ì˜ˆ: 0-1 ì¶©ëŒ, 1-2 ì¶©ëŒ</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">team_assignment</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># ([0, 2], [1]) ë˜ëŠ” ([1], [0, 2])</span>
</code></pre></div>

<hr />
<h2 id="6">6. ì‹¤ì „ ë¬¸ì œ íŒ¨í„´<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="1-scc">íŒ¨í„´ 1: SCC ê°œìˆ˜ ì„¸ê¸°<a class="header-link" href="#1-scc" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">count_sccs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
    <span class="n">tarjan</span> <span class="o">=</span> <span class="n">TarjanSCC</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">tarjan</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">tarjan</span><span class="o">.</span><span class="n">find_sccs</span><span class="p">())</span>
</code></pre></div>

<h3 id="2">íŒ¨í„´ 2: ëª¨ë“  ë…¸ë“œ ë„ë‹¬ ê°€ëŠ¥í•œ ì‹œì‘ì <a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_universal_source</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ëª¨ë“  ë…¸ë“œì— ë„ë‹¬ ê°€ëŠ¥í•œ ì‹œì‘ì ì´ ìˆëŠ”ê°€?</span>
<span class="sd">    ì‘ì¶• ê·¸ë˜í”„ì—ì„œ ì§„ì… ì°¨ìˆ˜ê°€ 0ì¸ SCCê°€ 1ê°œë©´ ê°€ëŠ¥</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sccs</span><span class="p">,</span> <span class="n">scc_id</span><span class="p">,</span> <span class="n">dag</span> <span class="o">=</span> <span class="n">build_condensation_graph</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
    <span class="n">num_sccs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sccs</span><span class="p">)</span>

    <span class="n">in_degree</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_sccs</span>
    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dag</span><span class="p">[</span><span class="n">u</span><span class="p">]:</span>
            <span class="n">in_degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">)</span> <span class="k">if</span> <span class="n">in_degree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># í•´ë‹¹ SCCì˜ ì•„ë¬´ ë…¸ë“œë‚˜ ë°˜í™˜</span>
        <span class="k">return</span> <span class="n">sccs</span><span class="p">[</span><span class="n">sources</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div>

<h3 id="3">íŒ¨í„´ 3: ìµœì†Œ ê°„ì„  ì¶”ê°€ë¡œ ê°•í•œ ì—°ê²°<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">min_edges_to_strongly_connect</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì „ì²´ ê·¸ë˜í”„ë¥¼ í•˜ë‚˜ì˜ SCCë¡œ ë§Œë“¤ê¸° ìœ„í•´ ì¶”ê°€í•  ìµœì†Œ ê°„ì„  ìˆ˜</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="n">sccs</span><span class="p">,</span> <span class="n">scc_id</span><span class="p">,</span> <span class="n">dag</span> <span class="o">=</span> <span class="n">build_condensation_graph</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
    <span class="n">num_sccs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sccs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">num_sccs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="n">in_degree</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_sccs</span>
    <span class="n">out_degree</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_sccs</span>

    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dag</span><span class="p">[</span><span class="n">u</span><span class="p">]:</span>
            <span class="n">out_degree</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">in_degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">sources</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">in_degree</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># ì§„ì… ì°¨ìˆ˜ 0</span>
    <span class="n">sinks</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">out_degree</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># ì§„ì¶œ ì°¨ìˆ˜ 0</span>

    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">sinks</span><span class="p">)</span>
</code></pre></div>

<h3 id="4">íŒ¨í„´ 4: ë°©í–¥ ê·¸ë˜í”„ì—ì„œ ì‚¬ì´í´ ë…¸ë“œ<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nodes_in_cycles</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì‚¬ì´í´ì— í¬í•¨ëœ ëª¨ë“  ë…¸ë“œ ì°¾ê¸°&quot;&quot;&quot;</span>
    <span class="n">tarjan</span> <span class="o">=</span> <span class="n">TarjanSCC</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">tarjan</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="n">sccs</span> <span class="o">=</span> <span class="n">tarjan</span><span class="o">.</span><span class="n">find_sccs</span><span class="p">()</span>

    <span class="c1"># í¬ê¸°ê°€ 2 ì´ìƒì¸ SCCì˜ ë…¸ë“œë“¤</span>
    <span class="n">cycle_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">sccs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">component</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cycle_nodes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

    <span class="c1"># í¬ê¸° 1ì¸ SCCë„ ìê¸° ìì‹ ìœ¼ë¡œ ê°€ëŠ” ê°„ì„ ì´ ìˆìœ¼ë©´ ì‚¬ì´í´</span>
    <span class="n">edge_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">sccs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">component</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">component</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="ow">in</span> <span class="n">edge_set</span><span class="p">:</span>
                <span class="n">cycle_nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cycle_nodes</span>
</code></pre></div>

<hr />
<h2 id="7">7. ì‹œê°„ ë³µì¡ë„ ì •ë¦¬<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ì—°ì‚°</th>
<th>Kosaraju</th>
<th>Tarjan</th>
</tr>
</thead>
<tbody>
<tr>
<td>SCC ì°¾ê¸°</td>
<td>O(V + E)</td>
<td>O(V + E)</td>
</tr>
<tr>
<td>ì‘ì¶• ê·¸ë˜í”„</td>
<td>O(V + E)</td>
<td>O(V + E)</td>
</tr>
<tr>
<td>2-SAT</td>
<td>-</td>
<td>O(V + E)</td>
</tr>
<tr>
<td>ê³µê°„</td>
<td>O(V + E) Ã— 2</td>
<td>O(V + E)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="8">8. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="1-on_stack">ì‹¤ìˆ˜ 1: on_stack ì²´í¬ ëˆ„ë½<a class="header-link" href="#1-on_stack" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì˜ëª»ëœ ì½”ë“œ</span>
<span class="k">if</span> <span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">])</span>

<span class="c1"># ì˜¬ë°”ë¥¸ ì½”ë“œ</span>
<span class="k">if</span> <span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">on_stack</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]:</span>
    <span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">disc</span><span class="p">[</span><span class="n">neighbor</span><span class="p">])</span>
</code></pre></div>

<h3 id="2-2-sat">ì‹¤ìˆ˜ 2: 2-SAT ë…¸ë“œ ë²ˆí˜¸ ê³„ì‚° ì˜¤ë¥˜<a class="header-link" href="#2-2-sat" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë³€ìˆ˜ iì— ëŒ€í•´:</span>
<span class="c1"># - i ìì²´: 2*i</span>
<span class="c1"># - Â¬i: 2*i + 1</span>

<span class="c1"># ì˜ëª»ëœ ë¶€ì •</span>
<span class="k">def</span><span class="w"> </span><span class="nf">negate</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">node</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># í‹€ë¦¼!</span>

<span class="c1"># ì˜¬ë°”ë¥¸ ë¶€ì •</span>
<span class="k">def</span><span class="w"> </span><span class="nf">negate</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">node</span> <span class="o">^</span> <span class="mi">1</span>  <span class="c1"># XORë¡œ 0â†”1 ì „í™˜</span>
</code></pre></div>

<h3 id="3_1">ì‹¤ìˆ˜ 3: ì‘ì¶• ê·¸ë˜í”„ ì¤‘ë³µ ê°„ì„ <a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì¤‘ë³µ ê°„ì„  ë°œìƒ ê°€ëŠ¥</span>
<span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">scc_id</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="n">scc_id</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
        <span class="n">condensed</span><span class="p">[</span><span class="n">scc_id</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scc_id</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>  <span class="c1"># ì¤‘ë³µ!</span>

<span class="c1"># setìœ¼ë¡œ í•´ê²°</span>
<span class="n">condensed</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sccs</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">scc_id</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="n">scc_id</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
        <span class="n">condensed</span><span class="p">[</span><span class="n">scc_id</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">scc_id</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ë‚œì´ë„</th>
<th>ë¬¸ì œ ìœ í˜•</th>
<th>í•µì‹¬ ê°œë…</th>
</tr>
</thead>
<tbody>
<tr>
<td>â˜…â˜…â˜†</td>
<td>SCC ê°œìˆ˜ ì„¸ê¸°</td>
<td>ê¸°ë³¸ Tarjan/Kosaraju</td>
</tr>
<tr>
<td>â˜…â˜…â˜†</td>
<td>ë„ë¯¸ë…¸</td>
<td>SCC + DAG ë¶„ì„</td>
</tr>
<tr>
<td>â˜…â˜…â˜…</td>
<td>2-SAT ê¸°ë³¸</td>
<td>ê·¸ë˜í”„ ë³€í™˜ + SCC</td>
</tr>
<tr>
<td>â˜…â˜…â˜…</td>
<td>íŒ€ ë°°ì •</td>
<td>2-SAT ì‘ìš©</td>
</tr>
<tr>
<td>â˜…â˜…â˜…â˜…</td>
<td>ìµœì†Œ ê°„ì„  ì¶”ê°€</td>
<td>ì‘ì¶• ê·¸ë˜í”„ í™œìš©</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_19">ë‹¤ìŒ ë‹¨ê³„<a class="header-link" href="#_19" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./18_Dynamic_Programming.md">18_Dynamic_Programming.md</a> - DP, ë©”ëª¨ì´ì œì´ì…˜</li>
</ul>
<hr />
<h2 id="_20">í•™ìŠµ ì ê²€<a class="header-link" href="#_20" title="Permanent link">&para;</a></h2>
<ol>
<li>Tarjan ì•Œê³ ë¦¬ì¦˜ì—ì„œ low-link ê°’ì˜ ì˜ë¯¸ëŠ”?</li>
<li>2-SATì—ì„œ (a âˆ¨ b)ë¥¼ ì–´ë–»ê²Œ ê·¸ë˜í”„ë¡œ ë³€í™˜í•˜ëŠ”ê°€?</li>
<li>ì‘ì¶• ê·¸ë˜í”„ê°€ í•­ìƒ DAGì¸ ì´ìœ ëŠ”?</li>
<li>Kosarajuê°€ ì—­ë°©í–¥ ê·¸ë˜í”„ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”?</li>
</ol>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Algorithm/16_LCA_and_Tree_Queries.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">26. LCAì™€ íŠ¸ë¦¬ì¿¼ë¦¬ (LCA and Tree Queries)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Algorithm/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Algorithm/18_Dynamic_Programming.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë™ì  í”„ë¡œê·¸ë˜ë° (Dynamic Programming)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}