{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>27. ê¸°í•˜ ì•Œê³ ë¦¬ì¦˜ (Computational Geometry) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Algorithm/">Algorithm</a>
    <span class="separator">/</span>
    <span class="current">27. ê¸°í•˜ ì•Œê³ ë¦¬ì¦˜ (Computational Geometry)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>27. ê¸°í•˜ ì•Œê³ ë¦¬ì¦˜ (Computational Geometry)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Algorithm/25_Network_Flow.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">25. ë„¤íŠ¸ì›Œí¬ í”Œë¡œìš° (Network Flow)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Algorithm/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Algorithm/27_Game_Theory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">28. ê²Œì„ ì´ë¡  (Game Theory)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ê¸°ë³¸ ê°œë…</a><ul>
<li><a href="#_2">ì ê³¼ ë²¡í„°</a></li>
<li><a href="#_3">ê¸°ë³¸ ì—°ì‚°</a></li>
</ul>
</li>
<li><a href="#2-ccw-counter-clockwise">2. CCW (Counter Clockwise)</a><ul>
<li><a href="#_4">ê°œë…</a></li>
<li><a href="#_5">êµ¬í˜„</a></li>
<li><a href="#ccw">CCW í™œìš©</a></li>
</ul>
</li>
<li><a href="#3">3. ì„ ë¶„ êµì°¨ íŒì •</a><ul>
<li><a href="#_6">ì•Œê³ ë¦¬ì¦˜</a></li>
<li><a href="#_7">êµ¬í˜„</a></li>
<li><a href="#_8">êµì°¨ì  ê³„ì‚°</a></li>
</ul>
</li>
<li><a href="#4-convex-hull">4. ë³¼ë¡ ê»ì§ˆ (Convex Hull)</a><ul>
<li><a href="#_9">ê°œë…</a></li>
<li><a href="#graham-scan">Graham Scan ì•Œê³ ë¦¬ì¦˜</a></li>
<li><a href="#andrews-monotone-chain">Andrew's Monotone Chain</a></li>
<li><a href="#c">C++ êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#5">5. ë‹¤ê°í˜• ë„“ì´</a><ul>
<li><a href="#shoelace">Shoelace ê³µì‹</a></li>
<li><a href="#_10">ì‚¼ê°í˜• ë„“ì´</a></li>
</ul>
</li>
<li><a href="#6">6. ì ê³¼ ë‹¤ê°í˜•</a><ul>
<li><a href="#_11">ì ì´ ë‹¤ê°í˜• ë‚´ë¶€ì— ìˆëŠ”ì§€</a></li>
</ul>
</li>
<li><a href="#7">7. ê°€ì¥ ê°€ê¹Œìš´ ë‘ ì </a><ul>
<li><a href="#_12">ë¶„í•  ì •ë³µ</a></li>
</ul>
</li>
<li><a href="#8">8. íšŒì „í•˜ëŠ” ìº˜ë¦¬í¼ìŠ¤</a><ul>
<li><a href="#rotating-calipers">ê°€ì¥ ë¨¼ ë‘ ì  (Rotating Calipers)</a></li>
</ul>
</li>
<li><a href="#9">9. ì‹¤ì „ ë¬¸ì œ íŒ¨í„´</a><ul>
<li><a href="#1_1">íŒ¨í„´ 1: ì§ì„  ìœ„ ì  íŒë³„</a></li>
<li><a href="#2">íŒ¨í„´ 2: ì ê³¼ ì§ì„  ì‚¬ì´ ê±°ë¦¬</a></li>
<li><a href="#3_1">íŒ¨í„´ 3: ë‹¤ê°í˜• ì¤‘ì‹¬</a></li>
<li><a href="#4">íŒ¨í„´ 4: ë³¼ë¡ ë‹¤ê°í˜• ë„“ì´</a></li>
</ul>
</li>
<li><a href="#10">10. ì‹œê°„ ë³µì¡ë„ ì •ë¦¬</a></li>
<li><a href="#11">11. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜</a><ul>
<li><a href="#1_2">ì‹¤ìˆ˜ 1: ë¶€ë™ì†Œìˆ˜ì  ë¹„êµ</a></li>
<li><a href="#2_1">ì‹¤ìˆ˜ 2: ì •ìˆ˜ ì˜¤ë²„í”Œë¡œ</a></li>
<li><a href="#3_2">ì‹¤ìˆ˜ 3: ë³¼ë¡ ê»ì§ˆ ê²½ê³„ ì¼€ì´ìŠ¤</a></li>
</ul>
</li>
<li><a href="#12">12. ì—°ìŠµ ë¬¸ì œ</a></li>
<li><a href="#_13">ë‹¤ìŒ ë‹¨ê³„</a></li>
<li><a href="#_14">í•™ìŠµ ì ê²€</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="27-computational-geometry">27. ê¸°í•˜ ì•Œê³ ë¦¬ì¦˜ (Computational Geometry)<a class="header-link" href="#27-computational-geometry" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>CCW(Counter Clockwise) ì•Œê³ ë¦¬ì¦˜ ì´í•´</li>
<li>ì„ ë¶„ êµì°¨ íŒì • êµ¬í˜„</li>
<li>ë³¼ë¡ ê»ì§ˆ(Convex Hull) ì•Œê³ ë¦¬ì¦˜</li>
<li>ë‹¤ê°í˜• ë„“ì´ ê³„ì‚°</li>
<li>ê°€ì¥ ê°€ê¹Œìš´ ë‘ ì  ë¬¸ì œ</li>
</ul>
<h2 id="1">1. ê¸°ë³¸ ê°œë…<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="_2">ì ê³¼ ë²¡í„°<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">scalar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">scalar</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë‚´ì  (Dot Product)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cross</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì™¸ì  (Cross Product) - 2Dì—ì„œëŠ” ìŠ¤ì¹¼ë¼&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë²¡í„°ì˜ í¬ê¸°&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë‹¨ìœ„ ë²¡í„°&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>

<h3 id="_3">ê¸°ë³¸ ì—°ì‚°<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ë‚´ì  (Dot Product):
A Â· B = |A||B|cos(Î¸)
      = Ax*Bx + Ay*By

<span class="k">-</span> &gt; 0: ì˜ˆê°
<span class="k">-</span> = 0: ì§ê°
<span class="k">-</span> &lt; 0: ë‘”ê°

ì™¸ì  (Cross Product):
A Ã— B = |A||B|sin(Î¸)
      = Ax*By - Ay*Bx

<span class="k">-</span> &gt; 0: Bê°€ Aì˜ ë°˜ì‹œê³„ ë°©í–¥
<span class="k">-</span> = 0: í‰í–‰ (ì¼ì§ì„ )
<span class="k">-</span> &lt; 0: Bê°€ Aì˜ ì‹œê³„ ë°©í–¥
</code></pre></div>

<hr />
<h2 id="2-ccw-counter-clockwise">2. CCW (Counter Clockwise)<a class="header-link" href="#2-ccw-counter-clockwise" title="Permanent link">&para;</a></h2>
<h3 id="_4">ê°œë…<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<p>ì„¸ ì  A, B, Cì˜ ë°©í–¥ ê´€ê³„ íŒë³„</p>
<div class="highlight"><pre><span></span><code><span class="w">      </span><span class="n">C</span><span class="w">                    </span><span class="n">C</span>
<span class="w">     </span><span class="o">/</span><span class="w">                      </span><span class="err">\</span>
<span class="w">    </span><span class="o">/</span><span class="w">                        </span><span class="err">\</span>
<span class="w">   </span><span class="n">A</span><span class="w"> </span><span class="o">-----&gt;</span><span class="w"> </span><span class="n">B</span><span class="w">          </span><span class="n">A</span><span class="w"> </span><span class="o">-----&gt;</span><span class="w"> </span><span class="n">B</span>

<span class="w">  </span><span class="n">CCW</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="err">ë°˜ì‹œê³„</span><span class="p">)</span><span class="w">    </span><span class="n">CCW</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="err">ì‹œê³„</span><span class="p">)</span>

<span class="w">       </span><span class="n">C</span>
<span class="w">       </span><span class="o">|</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="o">---+---</span><span class="w"> </span><span class="n">B</span>

<span class="w">  </span><span class="n">CCW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="err">ì¼ì§ì„ </span><span class="p">)</span>
</code></pre></div>

<h3 id="_5">êµ¬í˜„<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì„¸ ì ì˜ ë°©í–¥ íŒë³„</span>
<span class="sd">    Returns:</span>
<span class="sd">        &gt; 0: ë°˜ì‹œê³„ ë°©í–¥</span>
<span class="sd">        = 0: ì¼ì§ì„ </span>
<span class="sd">        &lt; 0: ì‹œê³„ ë°©í–¥</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ccw_sign</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CCWì˜ ë¶€í˜¸ë§Œ ë°˜í™˜ (-1, 0, 1)&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="c1"># íŠœí”Œ ë²„ì „</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ccw_tuple</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ay</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">bx</span> <span class="o">-</span> <span class="n">ax</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">ay</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">by</span> <span class="o">-</span> <span class="n">ay</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">ax</span><span class="p">)</span>
</code></pre></div>

<h3 id="ccw">CCW í™œìš©<a class="header-link" href="#ccw" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_left_turn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Aâ†’Bâ†’Cê°€ ì¢ŒíšŒì „ì¸ê°€?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_collinear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì„¸ ì ì´ ì¼ì§ì„ ìƒì— ìˆëŠ”ê°€?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">angle_direction</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;originì—ì„œ ë³¼ ë•Œ p1â†’p2 ë°©í–¥&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ccw_sign</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3">3. ì„ ë¶„ êµì°¨ íŒì •<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="_6">ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<p>ë‘ ì„ ë¶„ ABì™€ CDê°€ êµì°¨í•˜ëŠ”ì§€ íŒë³„</p>
<div class="highlight"><pre><span></span><code>êµì°¨ ì¡°ê±´:
1. CCW(A,B,C) <span class="gs">* CCW(A,B,D) &lt; 0  (Cì™€ Dê°€ AB ê¸°ì¤€ ë°˜ëŒ€í¸)</span>
<span class="gs">2. CCW(C,D,A) *</span> CCW(C,D,B) &lt; 0  (Aì™€ Bê°€ CD ê¸°ì¤€ ë°˜ëŒ€í¸)

ì˜ˆì™¸: ì¼ì§ì„ ìƒì¼ ë•Œ (CCW = 0)
</code></pre></div>

<h3 id="_7">êµ¬í˜„<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">segments_intersect</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì„ ë¶„ ABì™€ ì„ ë¶„ CDê°€ êµì°¨í•˜ëŠ”ì§€ íŒë³„</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">ccw_sign</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">ccw_sign</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    <span class="n">d3</span> <span class="o">=</span> <span class="n">ccw_sign</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">d4</span> <span class="o">=</span> <span class="n">ccw_sign</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="c1"># ì¼ë°˜ì ì¸ êµì°¨</span>
    <span class="k">if</span> <span class="n">d1</span> <span class="o">*</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">d3</span> <span class="o">*</span> <span class="n">d4</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># ì¼ì§ì„ ìƒì— ìˆëŠ” ê²½ìš°</span>
    <span class="k">if</span> <span class="n">d1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">d2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">d3</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">d4</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">on_segment</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">on_segment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì  Pê°€ ì„ ë¶„ AB ìœ„ì— ìˆëŠ”ì§€ (ì¼ì§ì„  ê°€ì •)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span>
            <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</code></pre></div>

<h3 id="_8">êµì°¨ì  ê³„ì‚°<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">intersection_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì„ ë¶„ ABì™€ CDì˜ êµì°¨ì  ê³„ì‚°</span>
<span class="sd">    êµì°¨í•˜ì§€ ì•Šìœ¼ë©´ None ë°˜í™˜</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>  <span class="c1"># í‰í–‰</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">t</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<hr />
<h2 id="4-convex-hull">4. ë³¼ë¡ ê»ì§ˆ (Convex Hull)<a class="header-link" href="#4-convex-hull" title="Permanent link">&para;</a></h2>
<h3 id="_9">ê°œë…<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<p>ì£¼ì–´ì§„ ì ë“¤ì„ ëª¨ë‘ í¬í•¨í•˜ëŠ” ê°€ì¥ ì‘ì€ ë³¼ë¡ ë‹¤ê°í˜•</p>
<div class="highlight"><pre><span></span><code>    <span class="k">*</span>           *
      <span class="k">*</span>       *
    <span class="k">*</span>   HULL    *
      <span class="k">*</span>       *
    <span class="k">*</span>           *

ì ë“¤ì„ ê°ì‹¸ëŠ” ê³ ë¬´ì¤„ì„ ìƒê°í•˜ë©´ ë¨
</code></pre></div>

<h3 id="graham-scan">Graham Scan ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#graham-scan" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convex_hull_graham</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Graham Scan: O(n log n)</span>
<span class="sd">    ì ë“¤ì˜ ë³¼ë¡ ê»ì§ˆì„ ë°˜ì‹œê³„ ë°©í–¥ìœ¼ë¡œ ë°˜í™˜</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">points</span><span class="p">[:]</span>

    <span class="c1"># ê°€ì¥ ì•„ë˜ ì™¼ìª½ ì  ì°¾ê¸°</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

    <span class="c1"># ê°ë„ ê¸°ì¤€ ì •ë ¬</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">polar_angle</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dist_sq</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">sorted_points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">polar_angle</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">dist_sq</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

    <span class="c1"># ìŠ¤íƒìœ¼ë¡œ ë³¼ë¡ ê»ì§ˆ êµ¬ì„±</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_points</span><span class="p">:</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ccw</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]],</span> <span class="n">points</span><span class="p">[</span><span class="n">hull</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hull</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">hull</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">hull</span><span class="p">]</span>
</code></pre></div>

<h3 id="andrews-monotone-chain">Andrew's Monotone Chain<a class="header-link" href="#andrews-monotone-chain" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convex_hull_andrew</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Andrew&#39;s Monotone Chain: O(n log n)</span>
<span class="sd">    ë” ê°„ë‹¨í•˜ê³  ì•ˆì •ì </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">points</span><span class="p">[:]</span>

    <span class="c1"># ì•„ë˜ ê»ì§ˆ (Lower Hull)</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ccw</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lower</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># ìœ„ ê»ì§ˆ (Upper Hull)</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ccw</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">upper</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># í•©ì¹˜ê¸° (ì‹œì‘ì ê³¼ ëì ì€ ì¤‘ë³µ)</span>
    <span class="k">return</span> <span class="n">lower</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">upper</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>

<h3 id="c">C++ êµ¬í˜„<a class="header-link" href="#c" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">typedef</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">ll</span><span class="p">;</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Point</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ll</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Point</span><span class="o">&amp;</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tie</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">tie</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="n">ll</span><span class="w"> </span><span class="nf">ccw</span><span class="p">(</span><span class="n">Point</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Point</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Point</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span><span class="w"> </span><span class="n">convexHull</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sort</span><span class="p">(</span><span class="n">pts</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">pts</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hull</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Lower hull</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">hull</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">hull</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="mi">-2</span><span class="p">],</span><span class="w"> </span><span class="n">hull</span><span class="p">[</span><span class="n">hull</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="mi">-1</span><span class="p">],</span><span class="w"> </span><span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="n">hull</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
<span class="w">        </span><span class="n">hull</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Upper hull</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lower_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hull</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">hull</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">lower_size</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">hull</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="mi">-2</span><span class="p">],</span><span class="w"> </span><span class="n">hull</span><span class="p">[</span><span class="n">hull</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="mi">-1</span><span class="p">],</span><span class="w"> </span><span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="n">hull</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
<span class="w">        </span><span class="n">hull</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">hull</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hull</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="5">5. ë‹¤ê°í˜• ë„“ì´<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="shoelace">Shoelace ê³µì‹<a class="header-link" href="#shoelace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">polygon_area</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ë‹¤ê°í˜• ë„“ì´ (Shoelace Formula)</span>
<span class="sd">    ì ë“¤ì€ ìˆœì„œëŒ€ë¡œ (ì‹œê³„/ë°˜ì‹œê³„) ì£¼ì–´ì ¸ì•¼ í•¨</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
        <span class="n">area</span> <span class="o">+=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
        <span class="n">area</span> <span class="o">-=</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>

    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">polygon_area_signed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ë¶€í˜¸ ìˆëŠ” ë„“ì´</span>
<span class="sd">    &gt; 0: ë°˜ì‹œê³„ ë°©í–¥</span>
<span class="sd">    &lt; 0: ì‹œê³„ ë°©í–¥</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
        <span class="n">area</span> <span class="o">+=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
        <span class="n">area</span> <span class="o">-=</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>

    <span class="k">return</span> <span class="n">area</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div>

<h3 id="_10">ì‚¼ê°í˜• ë„“ì´<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">triangle_area</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CCWë¥¼ ì´ìš©í•œ ì‚¼ê°í˜• ë„“ì´&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div>

<hr />
<h2 id="6">6. ì ê³¼ ë‹¤ê°í˜•<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="_11">ì ì´ ë‹¤ê°í˜• ë‚´ë¶€ì— ìˆëŠ”ì§€<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">point_in_polygon</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ray Casting Algorithm</span>
<span class="sd">    O(n)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
        <span class="n">pi</span><span class="p">,</span> <span class="n">pj</span> <span class="o">=</span> <span class="n">polygon</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

        <span class="c1"># ì ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ìœ ë°˜ì§ì„ ì´ ë³€ê³¼ êµì°¨í•˜ëŠ”ì§€</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">pj</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">pj</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">pi</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
            <span class="c1"># êµì°¨ì ì˜ xì¢Œí‘œ</span>
            <span class="n">x_intersect</span> <span class="o">=</span> <span class="p">(</span><span class="n">pj</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">pi</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pi</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pj</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pi</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">pi</span><span class="o">.</span><span class="n">x</span>
            <span class="k">if</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x_intersect</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>  <span class="c1"># í™€ìˆ˜ë©´ ë‚´ë¶€</span>

<span class="k">def</span><span class="w"> </span><span class="nf">point_in_convex_polygon</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">polygon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ë³¼ë¡ ë‹¤ê°í˜•ì—ì„œ ì  í¬í•¨ ì—¬ë¶€ (O(log n))</span>
<span class="sd">    polygonì€ ë°˜ì‹œê³„ ë°©í–¥ìœ¼ë¡œ ì •ë ¬ë˜ì–´ ìˆì–´ì•¼ í•¨</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>

    <span class="c1"># ì²« ë²ˆì§¸ ì  ê¸°ì¤€ìœ¼ë¡œ ëª¨ë“  ì ì´ ê°™ì€ ë°©í–¥ì´ì–´ì•¼ í•¨</span>
    <span class="k">if</span> <span class="n">ccw</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">ccw</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># ì´ì§„ íƒìƒ‰</span>
    <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">lo</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">hi</span><span class="p">:</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">ccw</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="n">mid</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lo</span> <span class="o">=</span> <span class="n">mid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="n">mid</span>

    <span class="k">return</span> <span class="n">ccw</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="n">lo</span><span class="p">],</span> <span class="n">polygon</span><span class="p">[</span><span class="n">hi</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</code></pre></div>

<hr />
<h2 id="7">7. ê°€ì¥ ê°€ê¹Œìš´ ë‘ ì <a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="_12">ë¶„í•  ì •ë³µ<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">closest_pair</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ê°€ì¥ ê°€ê¹Œìš´ ë‘ ì  ì°¾ê¸°: O(n log n)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">points_sorted_x</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
    <span class="n">points_sorted_y</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">closest_util</span><span class="p">(</span><span class="n">pts_x</span><span class="p">,</span> <span class="n">pts_y</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pts_x</span><span class="p">)</span>

        <span class="c1"># ê¸°ì € ì‚¬ë¡€</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">min_dist</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">pts_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pts_x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">min_dist</span><span class="p">:</span>
                        <span class="n">min_dist</span> <span class="o">=</span> <span class="n">d</span>
                        <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">pts_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pts_x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">pair</span>

        <span class="c1"># ë¶„í• </span>
        <span class="n">mid</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">mid_point</span> <span class="o">=</span> <span class="n">pts_x</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span>

        <span class="c1"># y ê¸°ì¤€ ì •ë ¬ëœ ì ë“¤ë„ ë¶„í• </span>
        <span class="n">left_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts_y</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">mid_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">mid_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">mid_point</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>
        <span class="n">right_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts_y</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">mid_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">mid_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">mid_point</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>

        <span class="c1"># ì¬ê·€</span>
        <span class="n">dl</span><span class="p">,</span> <span class="n">pair_l</span> <span class="o">=</span> <span class="n">closest_util</span><span class="p">(</span><span class="n">pts_x</span><span class="p">[:</span><span class="n">mid</span><span class="p">],</span> <span class="n">left_y</span><span class="p">)</span>
        <span class="n">dr</span><span class="p">,</span> <span class="n">pair_r</span> <span class="o">=</span> <span class="n">closest_util</span><span class="p">(</span><span class="n">pts_x</span><span class="p">[</span><span class="n">mid</span><span class="p">:],</span> <span class="n">right_y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dl</span> <span class="o">&lt;=</span> <span class="n">dr</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dl</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="n">pair_l</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dr</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="n">pair_r</span>

        <span class="c1"># ì¤‘ì•™ ë ì—ì„œ í™•ì¸</span>
        <span class="n">strip</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts_y</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">mid_point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">strip</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">strip</span><span class="p">))):</span>  <span class="c1"># ìµœëŒ€ 6ê°œë§Œ í™•ì¸</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">strip</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">strip</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span>
                    <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">strip</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">strip</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">d</span><span class="p">,</span> <span class="n">pair</span>

    <span class="k">return</span> <span class="n">closest_util</span><span class="p">(</span><span class="n">points_sorted_x</span><span class="p">,</span> <span class="n">points_sorted_y</span><span class="p">)</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
          <span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="n">dist</span><span class="p">,</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="o">=</span> <span class="n">closest_pair</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìµœì†Œ ê±°ë¦¬: </span><span class="si">{</span><span class="n">dist</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì : </span><span class="si">{</span><span class="n">p1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">p2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. íšŒì „í•˜ëŠ” ìº˜ë¦¬í¼ìŠ¤<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="rotating-calipers">ê°€ì¥ ë¨¼ ë‘ ì  (Rotating Calipers)<a class="header-link" href="#rotating-calipers" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">farthest_pair</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ê°€ì¥ ë¨¼ ë‘ ì  (ë³¼ë¡ ê»ì§ˆì—ì„œë§Œ ê°€ëŠ¥): O(n log n)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="n">convex_hull_andrew</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">hull</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">hull</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">hull</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dist_sq</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># ìº˜ë¦¬í¼ìŠ¤ íšŒì „</span>
    <span class="n">max_dist</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># jë¥¼ ë°˜ì‹œê³„ ë°©í–¥ìœ¼ë¡œ íšŒì „</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">next_j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
            <span class="c1"># ë²¡í„° ë¹„êµë¡œ íšŒì „ ë°©í–¥ ê²°ì •</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">hull</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">hull</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">next_j</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">hull</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">hull</span><span class="p">[</span><span class="n">next_j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">hull</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">next_j</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">dist_sq</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">max_dist</span><span class="p">:</span>
            <span class="n">max_dist</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="c1"># ë‹¤ìŒ ì ë„ í™•ì¸</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">dist_sq</span><span class="p">(</span><span class="n">hull</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">max_dist</span><span class="p">:</span>
            <span class="n">max_dist</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">hull</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">max_dist</span><span class="p">),</span> <span class="n">pair</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì‹¤ì „ ë¬¸ì œ íŒ¨í„´<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="1_1">íŒ¨í„´ 1: ì§ì„  ìœ„ ì  íŒë³„<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_on_line</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì  Pê°€ ì§ì„  AB ìœ„ì— ìˆëŠ”ì§€&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-9</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_on_segment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì  Pê°€ ì„ ë¶„ AB ìœ„ì— ìˆëŠ”ì§€&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">is_on_line</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">and</span>
            <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span>
            <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</code></pre></div>

<h3 id="2">íŒ¨í„´ 2: ì ê³¼ ì§ì„  ì‚¬ì´ ê±°ë¦¬<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">point_to_line_dist</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì  Pì—ì„œ ì§ì„  ABê¹Œì§€ì˜ ê±°ë¦¬&quot;&quot;&quot;</span>
    <span class="c1"># |AP Ã— AB| / |AB|</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">ab</span><span class="p">))</span> <span class="o">/</span> <span class="n">ab</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">point_to_segment_dist</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì  Pì—ì„œ ì„ ë¶„ ABê¹Œì§€ì˜ ê±°ë¦¬&quot;&quot;&quot;</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ap</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="n">bp</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># íˆ¬ì˜ì´ ì„ ë¶„ ë°–ì— ìˆëŠ” ê²½ìš°</span>
    <span class="k">if</span> <span class="n">ab</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ap</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ab</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bp</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>

    <span class="c1"># íˆ¬ì˜ì´ ì„ ë¶„ ìœ„ì— ìˆëŠ” ê²½ìš°</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">ab</span><span class="p">))</span> <span class="o">/</span> <span class="n">ab</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</code></pre></div>

<h3 id="3_1">íŒ¨í„´ 3: ë‹¤ê°í˜• ì¤‘ì‹¬<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">polygon_centroid</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë‹¤ê°í˜• ë¬´ê²Œì¤‘ì‹¬&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
        <span class="n">cross</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
        <span class="n">cx</span> <span class="o">+=</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">cross</span>
        <span class="n">cy</span> <span class="o">+=</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">cross</span>
        <span class="n">area</span> <span class="o">+=</span> <span class="n">cross</span>

    <span class="n">area</span> <span class="o">/=</span> <span class="mi">2</span>
    <span class="n">cx</span> <span class="o">/=</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">area</span><span class="p">)</span>
    <span class="n">cy</span> <span class="o">/=</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">area</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">)</span>
</code></pre></div>

<h3 id="4">íŒ¨í„´ 4: ë³¼ë¡ ë‹¤ê°í˜• ë„“ì´<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convex_hull_area</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì ë“¤ì˜ ë³¼ë¡ ê»ì§ˆ ë„“ì´&quot;&quot;&quot;</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="n">convex_hull_andrew</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">polygon_area</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="10">10. ì‹œê°„ ë³µì¡ë„ ì •ë¦¬<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ì•Œê³ ë¦¬ì¦˜</th>
<th>ì‹œê°„ ë³µì¡ë„</th>
</tr>
</thead>
<tbody>
<tr>
<td>CCW</td>
<td>O(1)</td>
</tr>
<tr>
<td>ì„ ë¶„ êµì°¨</td>
<td>O(1)</td>
</tr>
<tr>
<td>Graham Scan</td>
<td>O(n log n)</td>
</tr>
<tr>
<td>Andrew's Monotone Chain</td>
<td>O(n log n)</td>
</tr>
<tr>
<td>ë‹¤ê°í˜• ë„“ì´</td>
<td>O(n)</td>
</tr>
<tr>
<td>ì  in ë‹¤ê°í˜•</td>
<td>O(n) / O(log n) (ë³¼ë¡)</td>
</tr>
<tr>
<td>ê°€ì¥ ê°€ê¹Œìš´ ë‘ ì </td>
<td>O(n log n)</td>
</tr>
<tr>
<td>ê°€ì¥ ë¨¼ ë‘ ì </td>
<td>O(n log n)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="11">11. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜<a class="header-link" href="#11" title="Permanent link">&para;</a></h2>
<h3 id="1_2">ì‹¤ìˆ˜ 1: ë¶€ë™ì†Œìˆ˜ì  ë¹„êµ<a class="header-link" href="#1_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì˜ëª»ë¨</span>
<span class="k">if</span> <span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># ë¶€ë™ì†Œìˆ˜ì  ì˜¤ì°¨!</span>

<span class="c1"># ì˜¬ë°”ë¦„</span>
<span class="n">EPS</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">EPS</span><span class="p">:</span>
</code></pre></div>

<h3 id="2_1">ì‹¤ìˆ˜ 2: ì •ìˆ˜ ì˜¤ë²„í”Œë¡œ<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// ì¢Œí‘œê°€ 10^6ì¼ ë•Œ</span>
<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">ccw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
<span class="w">              </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
</code></pre></div>

<h3 id="3_2">ì‹¤ìˆ˜ 3: ë³¼ë¡ ê»ì§ˆ ê²½ê³„ ì¼€ì´ìŠ¤<a class="header-link" href="#3_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì ì´ 2ê°œ ì´í•˜ì¼ ë•Œ</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">points</span><span class="p">[:]</span>  <span class="c1"># ê»ì§ˆ ë¶ˆê°€</span>
</code></pre></div>

<hr />
<h2 id="12">12. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#12" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ë‚œì´ë„</th>
<th>ë¬¸ì œ ìœ í˜•</th>
<th>í•µì‹¬ ê°œë…</th>
</tr>
</thead>
<tbody>
<tr>
<td>â˜…â˜…â˜†</td>
<td>CCW ê¸°ë³¸</td>
<td>ì„¸ ì  ë°©í–¥ íŒë³„</td>
</tr>
<tr>
<td>â˜…â˜…â˜†</td>
<td>ì„ ë¶„ êµì°¨</td>
<td>CCW í™œìš©</td>
</tr>
<tr>
<td>â˜…â˜…â˜…</td>
<td>ë³¼ë¡ ê»ì§ˆ</td>
<td>Graham/Andrew</td>
</tr>
<tr>
<td>â˜…â˜…â˜…</td>
<td>ë‹¤ê°í˜• ë„“ì´</td>
<td>Shoelace</td>
</tr>
<tr>
<td>â˜…â˜…â˜…â˜…</td>
<td>ê°€ì¥ ê°€ê¹Œìš´ ë‘ ì </td>
<td>ë¶„í•  ì •ë³µ</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_13">ë‹¤ìŒ ë‹¨ê³„<a class="header-link" href="#_13" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./27_Game_Theory.md">27_Game_Theory.md</a> - ê²Œì„ ì´ë¡ </li>
</ul>
<hr />
<h2 id="_14">í•™ìŠµ ì ê²€<a class="header-link" href="#_14" title="Permanent link">&para;</a></h2>
<ol>
<li>CCWê°€ 0ì¸ ê²½ìš°ì˜ ì˜ë¯¸ëŠ”?</li>
<li>ë³¼ë¡ ê»ì§ˆì—ì„œ ì ì„ ìŠ¤íƒì—ì„œ popí•˜ëŠ” ì¡°ê±´ì€?</li>
<li>ì„ ë¶„ êµì°¨ íŒì •ì—ì„œ CCWë§Œìœ¼ë¡œ ë¶€ì¡±í•œ ê²½ìš°ëŠ”?</li>
<li>Shoelace ê³µì‹ì´ ì‘ë™í•˜ëŠ” ì›ë¦¬ëŠ”?</li>
</ol>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Algorithm/25_Network_Flow.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">25. ë„¤íŠ¸ì›Œí¬ í”Œë¡œìš° (Network Flow)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Algorithm/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Algorithm/27_Game_Theory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">28. ê²Œì„ ì´ë¡  (Game Theory)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}