{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë ˆìŠ¨ 2: ì–´íœ˜ ë¶„ì„(Lexical Analysis) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Compiler_Design/">Compiler Design</a>
    <span class="separator">/</span>
    <span class="current">ë ˆìŠ¨ 2: ì–´íœ˜ ë¶„ì„(Lexical Analysis)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ë ˆìŠ¨ 2: ì–´íœ˜ ë¶„ì„(Lexical Analysis)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Compiler_Design/01_Introduction_to_Compilers.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë ˆìŠ¨ 1: ì»´íŒŒì¼ëŸ¬ ì…ë¬¸(Introduction to Compilers)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Compiler_Design/03_Finite_Automata.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë ˆìŠ¨ 3: ìœ í•œ ì˜¤í† ë§ˆí†¤(Finite Automata)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1-lexer">1. ë ‰ì„œ(Lexer)ì˜ ì—­í• </a><ul>
<li><a href="#_2">ì–´íœ˜ ë¶„ì„ì„ ë³„ë„ ë‹¨ê³„ë¡œ ë¶„ë¦¬í•˜ëŠ” ì´ìœ </a></li>
<li><a href="#_3">ë ‰ì„œê°€ í•˜ëŠ” ì¼</a></li>
<li><a href="#_4">ë ‰ì„œê°€ í•˜ì§€ ì•ŠëŠ” ì¼</a></li>
</ul>
</li>
<li><a href="#2-token-lexeme-pattern">2. í† í°(Token), ì–´íœ˜ì†Œ(Lexeme), íŒ¨í„´(Pattern)</a><ul>
<li><a href="#token">í† í°(Token)</a></li>
<li><a href="#lexeme">ì–´íœ˜ì†Œ(Lexeme)</a></li>
<li><a href="#pattern">íŒ¨í„´(Pattern)</a></li>
<li><a href="#_5">ì˜ˆì‹œ</a></li>
<li><a href="#_6">í† í° ìë£Œ êµ¬ì¡°</a></li>
</ul>
</li>
<li><a href="#3-regular-expressions">3. ì •ê·œ í‘œí˜„ì‹(Regular Expressions) â€” í˜•ì‹ì  ì •ì˜</a><ul>
<li><a href="#alphabet-string">ì•ŒíŒŒë²³(Alphabet)ê³¼ ë¬¸ìì—´(String)</a></li>
<li><a href="#language">ì–¸ì–´(Language)</a></li>
<li><a href="#_7">ì •ê·œ í‘œí˜„ì‹ì˜ ì •ì˜</a></li>
<li><a href="#_8">ì˜ˆì‹œ</a></li>
<li><a href="#shorthands">í¸ì˜ í‘œê¸°(Shorthands)</a></li>
<li><a href="#_9">ì •ê·œ í‘œí˜„ì‹ìœ¼ë¡œ í‘œí˜„í•œ í† í° íŒ¨í„´</a></li>
<li><a href="#_10">ì •ê·œ í‘œí˜„ì‹ì˜ ëŒ€ìˆ˜ ë²•ì¹™</a></li>
</ul>
</li>
<li><a href="#4-nfa-thompsons-construction">4. ì •ê·œ í‘œí˜„ì‹ì—ì„œ NFAë¡œ: í†°ìŠ¨ êµ¬ì„±ë²•(Thompson's Construction)</a><ul>
<li><a href="#nfa">NFA ì •ì˜ (ê°„ëµ)</a></li>
<li><a href="#_11">êµ¬ì„± ê·œì¹™</a></li>
<li><a href="#_12">í†°ìŠ¨ êµ¬ì„±ë²•ì˜ íŠ¹ì„±</a></li>
<li><a href="#python">Python êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#5-nfa-dfa-subset-construction">5. NFAì—ì„œ DFAë¡œ: ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•(Subset Construction)</a><ul>
<li><a href="#_13">ì•Œê³ ë¦¬ì¦˜</a></li>
<li><a href="#_14">ë³µì¡ë„</a></li>
<li><a href="#python_1">Python êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#6-dfa-dfa-minimization-hopcrofts-algorithm">6. DFA ìµœì†Œí™”(DFA Minimization): í™‰í¬ë¡œí”„íŠ¸ ì•Œê³ ë¦¬ì¦˜(Hopcroft's Algorithm)</a><ul>
<li><a href="#equivalent-states">ë™ì¹˜ ìƒíƒœ(Equivalent States)</a></li>
<li><a href="#partition-refinement">í™‰í¬ë¡œí”„íŠ¸ ì•Œê³ ë¦¬ì¦˜ (ë¶„í•  ì •ì œ, Partition Refinement)</a></li>
<li><a href="#python_2">Python êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#7-token-recognition">7. í† í° ì¸ì‹(Token Recognition)</a><ul>
<li><a href="#longest-match-rule">ìµœì¥ ì¼ì¹˜ ê·œì¹™(Longest Match Rule)</a></li>
<li><a href="#priority-rule">ìš°ì„ ìˆœìœ„ ê·œì¹™(Priority Rule)</a></li>
<li><a href="#dfa-combined-dfa-approach">ê²°í•© DFA ë°©ì‹(Combined DFA Approach)</a></li>
<li><a href="#_15">ìµœì¥ ì¼ì¹˜ êµ¬í˜„</a></li>
<li><a href="#error-recovery">ë ‰ì„œì˜ ì˜¤ë¥˜ ë³µêµ¬(Error Recovery)</a></li>
</ul>
</li>
<li><a href="#8">8. ì™„ì „í•œ ë ‰ì„œ êµ¬í˜„</a></li>
<li><a href="#9-lexer-generator">9. ë ‰ì„œ ìƒì„±ê¸°(Lexer Generator) ëª…ì„¸</a><ul>
<li><a href="#lexflex">Lex/Flex ëª…ì„¸ í˜•ì‹</a></li>
<li><a href="#ply-python-lex-yacc">PLY (Python Lex-Yacc) ëª…ì„¸</a></li>
</ul>
</li>
<li><a href="#10">10. íŠ¹ìˆ˜ ì‚¬ë¡€ ì²˜ë¦¬</a><ul>
<li><a href="#_16">ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ê°€ í¬í•¨ëœ ë¬¸ìì—´ ë¦¬í„°ëŸ´</a></li>
<li><a href="#multi-line-strings">ì—¬ëŸ¬ ì¤„ ë¬¸ìì—´(Multi-Line Strings)</a></li>
<li><a href="#nested-comments">ì¤‘ì²© ì£¼ì„(Nested Comments)</a></li>
<li><a href="#python_3">ì˜ë¯¸ ìˆëŠ” ê³µë°± (Python ìŠ¤íƒ€ì¼ ë“¤ì—¬ì“°ê¸°)</a></li>
</ul>
</li>
<li><a href="#11">11. ì„±ëŠ¥ ê³ ë ¤ ì‚¬í•­</a><ul>
<li><a href="#table-driven-vs-direct-coded">í…Œì´ë¸” êµ¬ë™(Table-Driven) vs. ì§ì ‘ ì½”ë”©(Direct-Coded) ë ‰ì„œ</a></li>
<li><a href="#buffer-management">ë²„í¼ ê´€ë¦¬(Buffer Management)</a></li>
</ul>
</li>
<li><a href="#_17">ìš”ì•½</a></li>
<li><a href="#_18">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1">ì—°ìŠµ 1: ì •ê·œ í‘œí˜„ì‹</a></li>
<li><a href="#2">ì—°ìŠµ 2: í†°ìŠ¨ êµ¬ì„±ë²•</a></li>
<li><a href="#3">ì—°ìŠµ 3: ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•</a></li>
<li><a href="#4">ì—°ìŠµ 4: ë ‰ì„œ í™•ì¥</a></li>
<li><a href="#5">ì—°ìŠµ 5: ì˜¤ë¥˜ ë³µêµ¬</a></li>
<li><a href="#6">ì—°ìŠµ 6: ì„±ëŠ¥ ë¹„êµ</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="2-lexical-analysis">ë ˆìŠ¨ 2: ì–´íœ˜ ë¶„ì„(Lexical Analysis)<a class="header-link" href="#2-lexical-analysis" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>ì´ ë ˆìŠ¨ì„ ì™„ë£Œí•˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<ol>
<li>ì»´íŒŒì¼ íŒŒì´í”„ë¼ì¸ì—ì„œ ë ‰ì„œ(Lexer, ìŠ¤ìºë„ˆ)ì˜ ì—­í• ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</li>
<li>í† í°(Token), ì–´íœ˜ì†Œ(Lexeme), íŒ¨í„´(Pattern)ì˜ ì°¨ì´ë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤</li>
<li>ì •ê·œ í‘œí˜„ì‹(Regular Expression)ì„ í˜•ì‹ì ìœ¼ë¡œ ì •ì˜í•˜ê³  í† í° íŒ¨í„´ ëª…ì„¸ì— í™œìš©í•  ìˆ˜ ìˆë‹¤</li>
<li>í†°ìŠ¨ êµ¬ì„±ë²•(Thompson's Construction)ì„ ì ìš©í•˜ì—¬ ì •ê·œ í‘œí˜„ì‹ì„ NFAë¡œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤</li>
<li>ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•(Subset Construction)ì„ ì ìš©í•˜ì—¬ NFAë¥¼ DFAë¡œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤</li>
<li>í™‰í¬ë¡œí”„íŠ¸ ì•Œê³ ë¦¬ì¦˜(Hopcroft's Algorithm)ì„ ì ìš©í•˜ì—¬ DFAë¥¼ ìµœì†Œí™”í•  ìˆ˜ ìˆë‹¤</li>
<li>ìµœì¥ ì¼ì¹˜ ê·œì¹™(Longest Match Rule)ì„ êµ¬í˜„í•˜ê³  í† í° ìš°ì„ ìˆœìœ„ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤</li>
<li>ê°„ë‹¨í•œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ìš© ì™„ì „í•œ ë ‰ì„œë¥¼ Pythonìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤</li>
</ol>
<hr />
<h2 id="1-lexer">1. ë ‰ì„œ(Lexer)ì˜ ì—­í• <a class="header-link" href="#1-lexer" title="Permanent link">&para;</a></h2>
<p><strong>ë ‰ì„œ(Lexer)</strong>ëŠ” <strong>ìŠ¤ìºë„ˆ(Scanner)</strong> ë˜ëŠ” <strong>í† í¬ë‚˜ì´ì €(Tokenizer)</strong>ë¼ê³ ë„ ë¶ˆë¦¬ë©°, ì»´íŒŒì¼ëŸ¬ì˜ ì²« ë²ˆì§¸ ë‹¨ê³„ì…ë‹ˆë‹¤. ì†ŒìŠ¤ í”„ë¡œê·¸ë¨ì„ ë¬¸ì ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì½ì–´ <strong>í† í°(Token)</strong>ì´ë¼ ë¶ˆë¦¬ëŠ” ì˜ë¯¸ ìˆëŠ” ë‹¨ìœ„ë¡œ ë¬¶ì–´ ì¤ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="nt">ì†ŒìŠ¤</span><span class="w"> </span><span class="nt">ë¬¸ì</span><span class="o">:</span><span class="w">          </span><span class="s2">&quot;if (x &gt;= 42) return y + 1;&quot;</span>
<span class="w">                            </span><span class="o">|</span>
<span class="w">                    </span><span class="cp">[</span><span class="nx">Lexer</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">Scanner</span><span class="cp">]</span>
<span class="w">                            </span><span class="o">|</span>
<span class="w">                            </span><span class="nt">v</span>
<span class="nt">í† í°</span><span class="w"> </span><span class="nt">ìŠ¤íŠ¸ë¦¼</span><span class="o">:</span><span class="w">         </span><span class="nt">KW_IF</span><span class="w">  </span><span class="nt">LPAREN</span><span class="w">  </span><span class="nt">ID</span><span class="o">(</span><span class="nt">x</span><span class="o">)</span><span class="w">  </span><span class="nt">GEQ</span><span class="w">  </span><span class="nt">INT</span><span class="o">(</span><span class="nt">42</span><span class="o">)</span><span class="w">  </span><span class="nt">RPAREN</span>
<span class="w">                    </span><span class="nt">KW_RETURN</span><span class="w">  </span><span class="nt">ID</span><span class="o">(</span><span class="nt">y</span><span class="o">)</span><span class="w">  </span><span class="nt">PLUS</span><span class="w">  </span><span class="nt">INT</span><span class="o">(</span><span class="nt">1</span><span class="o">)</span><span class="w">  </span><span class="nt">SEMI</span>
</code></pre></div>

<h3 id="_2">ì–´íœ˜ ë¶„ì„ì„ ë³„ë„ ë‹¨ê³„ë¡œ ë¶„ë¦¬í•˜ëŠ” ì´ìœ <a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>ë‹¨ìˆœì„±</strong>: íŒŒì„œëŠ” ì›ì‹œ ë¬¸ìê°€ ì•„ë‹Œ í† í°(ìœ í•œí•˜ê³  êµ¬ì¡°í™”ëœ ì•ŒíŒŒë²³)ì„ ëŒ€ìƒìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë¬¸ë²•ì´ ëŒ€í­ ë‹¨ìˆœí™”ë©ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>íš¨ìœ¨ì„±</strong>: ì‹ë³„ì, ìˆ«ì, ë¬¸ìì—´ ê°™ì€ ì–´íœ˜ íŒ¨í„´ì€ ì •ê·œì (Regular)ì´ë¯€ë¡œ ìœ í•œ ì˜¤í† ë§ˆí†¤(Finite Automaton)ìœ¼ë¡œ ì¸ì‹í•  ìˆ˜ ìˆì–´ ë¬¸ë§¥ ììœ  íŒŒì‹±(Context-Free Parsing)ë³´ë‹¤ í›¨ì”¬ ë¹ ë¦…ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>ì´ì‹ì„±</strong>: ë¬¸ì ì§‘í•© ê´€ë ¨ ë¬¸ì œ(ASCII, UTF-8, ì¤„ë°”ê¿ˆ ë°©ì‹ ë“±)ê°€ ë ‰ì„œ ë‚´ë¶€ì—ë§Œ êµ­í•œë©ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>ëª¨ë“ˆì„±</strong>: ë ‰ì„œì™€ íŒŒì„œë¥¼ ë…ë¦½ì ìœ¼ë¡œ ê°œë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì†ŒìŠ¤ ì¸ì½”ë”©ì„ ì§€ì›í•  ë•Œ ë ‰ì„œë§Œ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤.</p>
</li>
</ol>
<h3 id="_3">ë ‰ì„œê°€ í•˜ëŠ” ì¼<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<ul>
<li>ë¬¸ìë¥¼ í† í°ìœ¼ë¡œ ë¬¶ìŒ</li>
<li>ê³µë°±(Whitespace)ê³¼ ì£¼ì„(Comment) ì œê±°</li>
<li>ì¤„ ë²ˆí˜¸ ì¶”ì (ì˜¤ë¥˜ ë©”ì‹œì§€ìš©)</li>
<li>í‚¤ì›Œë“œ(Keyword)ì™€ ì‹ë³„ì(Identifier) êµ¬ë¶„</li>
<li>ë¬¸ìì—´ ë° ë¬¸ì ë¦¬í„°ëŸ´ì˜ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬</li>
<li>ì–´íœ˜ ì˜¤ë¥˜(ë¶ˆë²• ë¬¸ì, ëë‚˜ì§€ ì•Šì€ ë¬¸ìì—´ ë“±) ë³´ê³ </li>
</ul>
<h3 id="_4">ë ‰ì„œê°€ í•˜ì§€ ì•ŠëŠ” ì¼<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ul>
<li>êµ¬ë¬¸(Syntax) ê²€ì‚¬ â†’ íŒŒì„œì˜ ì—­í• </li>
<li>íƒ€ì…(Type) ê²€ì‚¬ â†’ ì˜ë¯¸ ë¶„ì„ê¸°(Semantic Analyzer)ì˜ ì—­í• </li>
<li>ì—°ì‚°ì ìš°ì„ ìˆœìœ„(Operator Precedence) ì²˜ë¦¬ â†’ íŒŒì„œì˜ ì—­í• </li>
</ul>
<hr />
<h2 id="2-token-lexeme-pattern">2. í† í°(Token), ì–´íœ˜ì†Œ(Lexeme), íŒ¨í„´(Pattern)<a class="header-link" href="#2-token-lexeme-pattern" title="Permanent link">&para;</a></h2>
<p>ì„œë¡œ ì—°ê´€ë˜ì–´ ìˆì§€ë§Œ êµ¬ë³„ë˜ëŠ” ì„¸ ê°€ì§€ ê°œë…ì…ë‹ˆë‹¤:</p>
<h3 id="token">í† í°(Token)<a class="header-link" href="#token" title="Permanent link">&para;</a></h3>
<p><strong>í† í°</strong>ì€ ì–´íœ˜ ë‹¨ìœ„ì˜ í•œ ì¢…ë¥˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¶”ìƒ ê¸°í˜¸ì…ë‹ˆë‹¤. ë ‰ì„œì˜ ì¶œë ¥ì´ì íŒŒì„œì˜ ì…ë ¥ì…ë‹ˆë‹¤.</p>
<p>í† í°ì€ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒ ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:
- <strong>í† í° íƒ€ì…</strong>(ë˜ëŠ” í† í° ì´ë¦„): <code>ID</code>, <code>INT</code>, <code>PLUS</code>, <code>KW_IF</code> ë“±
- ì„ íƒì  <strong>ì†ì„± ê°’(Attribute Value)</strong>: ì‹¤ì œ í…ìŠ¤íŠ¸, ìˆ«ì ê°’, ë˜ëŠ” ì‹¬ë³¼ í…Œì´ë¸” í¬ì¸í„°</p>
<h3 id="lexeme">ì–´íœ˜ì†Œ(Lexeme)<a class="header-link" href="#lexeme" title="Permanent link">&para;</a></h3>
<p><strong>ì–´íœ˜ì†Œ</strong>ëŠ” í† í° íŒ¨í„´ê³¼ ì¼ì¹˜í•˜ëŠ” ì†ŒìŠ¤ í”„ë¡œê·¸ë¨ì˜ ì‹¤ì œ ë¶€ë¶„ ë¬¸ìì—´ì…ë‹ˆë‹¤.</p>
<h3 id="pattern">íŒ¨í„´(Pattern)<a class="header-link" href="#pattern" title="Permanent link">&para;</a></h3>
<p><strong>íŒ¨í„´</strong>ì€ í† í° íƒ€ì…ì— ì†í•˜ëŠ” ì–´íœ˜ì†Œë“¤ì˜ ì§‘í•©ì„ ê¸°ìˆ í•˜ëŠ” ê·œì¹™(ì¼ë°˜ì ìœ¼ë¡œ ì •ê·œ í‘œí˜„ì‹)ì…ë‹ˆë‹¤.</p>
<h3 id="_5">ì˜ˆì‹œ<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>í† í° íƒ€ì…</th>
<th>íŒ¨í„´ (ë¹„í˜•ì‹ì )</th>
<th>ì–´íœ˜ì†Œ ì˜ˆì‹œ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ID</code></td>
<td>ë¬¸ìë¡œ ì‹œì‘í•˜ê³  ë¬¸ì/ìˆ«ìê°€ ì´ì–´ì§€ëŠ” ê²ƒ</td>
<td><code>x</code>, <code>count</code>, <code>myVar</code></td>
</tr>
<tr>
<td><code>INT</code></td>
<td>í•˜ë‚˜ ì´ìƒì˜ ìˆ«ì</td>
<td><code>0</code>, <code>42</code>, <code>1000</code></td>
</tr>
<tr>
<td><code>FLOAT</code></td>
<td>ìˆ«ì, ì , ìˆ«ì</td>
<td><code>3.14</code>, <code>0.001</code></td>
</tr>
<tr>
<td><code>STRING</code></td>
<td><code>"</code> ... <code>"</code></td>
<td><code>"hello"</code>, <code>""</code></td>
</tr>
<tr>
<td><code>KW_IF</code></td>
<td><code>if</code></td>
<td><code>if</code></td>
</tr>
<tr>
<td><code>KW_WHILE</code></td>
<td><code>while</code></td>
<td><code>while</code></td>
</tr>
<tr>
<td><code>PLUS</code></td>
<td><code>+</code></td>
<td><code>+</code></td>
</tr>
<tr>
<td><code>GEQ</code></td>
<td><code>&gt;=</code></td>
<td><code>&gt;=</code></td>
</tr>
<tr>
<td><code>ASSIGN</code></td>
<td><code>=</code></td>
<td><code>=</code></td>
</tr>
<tr>
<td><code>LPAREN</code></td>
<td><code>(</code></td>
<td><code>(</code></td>
</tr>
<tr>
<td><code>SEMI</code></td>
<td><code>;</code></td>
<td><code>;</code></td>
</tr>
</tbody>
</table>
<h3 id="_6">í† í° ìë£Œ êµ¬ì¡°<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TokenType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="c1"># Literals</span>
    <span class="n">INT_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">FLOAT_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">STRING_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">CHAR_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1"># Identifiers</span>
    <span class="n">IDENTIFIER</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1"># Keywords</span>
    <span class="n">KW_IF</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_ELSE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_WHILE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_FOR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_RETURN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_INT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_FLOAT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_VOID</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1"># Operators</span>
    <span class="n">PLUS</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>       <span class="c1"># +</span>
    <span class="n">MINUS</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>      <span class="c1"># -</span>
    <span class="n">STAR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>       <span class="c1"># *</span>
    <span class="n">SLASH</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>      <span class="c1"># /</span>
    <span class="n">ASSIGN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># =</span>
    <span class="n">EQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># ==</span>
    <span class="n">NEQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># !=</span>
    <span class="n">LT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># &lt;</span>
    <span class="n">GT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># &gt;</span>
    <span class="n">LEQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># &lt;=</span>
    <span class="n">GEQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># &gt;=</span>
    <span class="n">AND</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># &amp;&amp;</span>
    <span class="n">OR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># ||</span>
    <span class="n">NOT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># !</span>

    <span class="c1"># Delimiters</span>
    <span class="n">LPAREN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># (</span>
    <span class="n">RPAREN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># )</span>
    <span class="n">LBRACE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># {</span>
    <span class="n">RBRACE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># }</span>
    <span class="n">LBRACKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>   <span class="c1"># [</span>
    <span class="n">RBRACKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>   <span class="c1"># ]</span>
    <span class="n">COMMA</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>      <span class="c1"># ,</span>
    <span class="n">SEMI</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>       <span class="c1"># ;</span>

    <span class="c1"># Special</span>
    <span class="n">EOF</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Token</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">TokenType</span>
    <span class="n">lexeme</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1"># Computed value (e.g., int 42, not string &quot;42&quot;)</span>
    <span class="n">line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Token(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lexeme</span><span class="si">!r}</span><span class="s2">, value=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Token(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lexeme</span><span class="si">!r}</span><span class="s2">)&quot;</span>
</code></pre></div>

<hr />
<h2 id="3-regular-expressions">3. ì •ê·œ í‘œí˜„ì‹(Regular Expressions) â€” í˜•ì‹ì  ì •ì˜<a class="header-link" href="#3-regular-expressions" title="Permanent link">&para;</a></h2>
<p>í† í° íŒ¨í„´ì€ <strong>ì •ê·œ í‘œí˜„ì‹(Regular Expression, regex)</strong>ì„ ì‚¬ìš©í•˜ì—¬ ëª…ì„¸í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ì»´íŒŒì¼ëŸ¬ ì´ë¡ ì—ì„œ ì‚¬ìš©í•˜ëŠ” í˜•ì‹ ì •ì˜ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. Pythonì˜ <code>re</code> ëª¨ë“ˆì²˜ëŸ¼ í™•ì¥ëœ ì •ê·œ í‘œí˜„ì‹ ë¬¸ë²•ê³¼ëŠ” ë‹¤ë¦…ë‹ˆë‹¤.</p>
<h3 id="alphabet-string">ì•ŒíŒŒë²³(Alphabet)ê³¼ ë¬¸ìì—´(String)<a class="header-link" href="#alphabet-string" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ì•ŒíŒŒë²³</strong> $\Sigma$ëŠ” ê¸°í˜¸(ë¬¸ì)ì˜ ìœ í•œí•˜ê³  ë¹„ì–´ ìˆì§€ ì•Šì€ ì§‘í•©ì…ë‹ˆë‹¤.</li>
<li>$\Sigma$ <strong>ìœ„ì˜ ë¬¸ìì—´</strong>ì€ $\Sigma$ì—ì„œ ì˜¨ ê¸°í˜¸ë“¤ì˜ ìœ í•œ ìˆ˜ì—´ì…ë‹ˆë‹¤.</li>
<li><strong>ë¹ˆ ë¬¸ìì—´</strong>ì€ $\epsilon$ (ì—¡ì‹¤ë¡ )ìœ¼ë¡œ í‘œê¸°í•©ë‹ˆë‹¤.</li>
<li>ë¬¸ìì—´ $w$ì˜ <strong>ê¸¸ì´</strong>ëŠ” $|w|$ì´ë©°, $|\epsilon| = 0$ì…ë‹ˆë‹¤.</li>
<li>$\Sigma^*$ëŠ” $\Sigma$ ìœ„ì˜ ëª¨ë“  ë¬¸ìì—´ì˜ ì§‘í•©($\epsilon$ í¬í•¨)ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
<li>$\Sigma^+ = \Sigma^* \setminus \{\epsilon\}$ì€ ëª¨ë“  ë¹„ì–´ ìˆì§€ ì•Šì€ ë¬¸ìì—´ì˜ ì§‘í•©ì…ë‹ˆë‹¤.</li>
</ul>
<h3 id="language">ì–¸ì–´(Language)<a class="header-link" href="#language" title="Permanent link">&para;</a></h3>
<p>$\Sigma$ <strong>ìœ„ì˜ ì–¸ì–´</strong> $L$ì€ $\Sigma^*$ì˜ ì„ì˜ì˜ ë¶€ë¶„ì§‘í•©, ì¦‰ ì„ì˜ì˜ ë¬¸ìì—´ ì§‘í•©ì…ë‹ˆë‹¤.</p>
<h3 id="_7">ì •ê·œ í‘œí˜„ì‹ì˜ ì •ì˜<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<p>ì•ŒíŒŒë²³ $\Sigma$ ìœ„ì˜ ì •ê·œ í‘œí˜„ì‹ $r$ì€ ê·€ë‚©ì ìœ¼ë¡œ ì •ì˜ë©ë‹ˆë‹¤:</p>
<p><strong>ê¸°ì € ì‚¬ë¡€(Base Cases):</strong></p>
<ol>
<li>$\epsilon$ì€ ì–¸ì–´ $\{\epsilon\}$ì„ ë‚˜íƒ€ë‚´ëŠ” ì •ê·œ í‘œí˜„ì‹ì…ë‹ˆë‹¤.</li>
<li>ê° $a \in \Sigma$ì— ëŒ€í•´, ê¸°í˜¸ $a$ëŠ” $\{a\}$ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ê·œ í‘œí˜„ì‹ì…ë‹ˆë‹¤.</li>
</ol>
<p><strong>ê·€ë‚©ì  ì‚¬ë¡€ ($r$ê³¼ $s$ê°€ ê°ê° $L(r)$ê³¼ $L(s)$ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ê·œ í‘œí˜„ì‹ì¼ ë•Œ):</strong></p>
<ol>
<li><strong>í•©ì§‘í•©(Union, êµëŒ€)</strong>: $r \mid s$ëŠ” $L(r) \cup L(s)$ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
<li><strong>ì—°ì ‘(Concatenation)</strong>: $r \cdot s$ (ë˜ëŠ” ê°„ëµíˆ $rs$)ëŠ” $L(r) \cdot L(s) = \{xy \mid x \in L(r), y \in L(s)\}$ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
<li><strong>í´ë¦¬ë‹ˆ ìŠ¤íƒ€(Kleene Star, íì‡„)</strong>: $r^*$ëŠ” $L(r)^* = \bigcup_{i=0}^{\infty} L(r)^i$ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
</ol>
<p>ì—¬ê¸°ì„œ $L^0 = \{\epsilon\}$ì´ê³  $L^{i+1} = L^i \cdot L$ì…ë‹ˆë‹¤.</p>
<p><strong>ì—°ì‚°ì ìš°ì„ ìˆœìœ„</strong> (ë†’ì€ ê²ƒë¶€í„° ë‚®ì€ ê²ƒ ìˆœ):
1. í´ë¦¬ë‹ˆ ìŠ¤íƒ€ $*$ (í›„ìœ„, ê°€ì¥ ê°•í•˜ê²Œ ê²°í•©)
2. ì—°ì ‘ (ë¬µì‹œì , ë‚˜ë€íˆ ì“°ê¸°)
3. í•©ì§‘í•© $\mid$ (ê°€ì¥ ì•½í•˜ê²Œ ê²°í•©)</p>
<p>ëª¨ë“  ì—°ì‚°ìëŠ” ì¢Œê²°í•©ì (Left-Associative)ì…ë‹ˆë‹¤.</p>
<h3 id="_8">ì˜ˆì‹œ<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì •ê·œ í‘œí˜„ì‹</th>
<th>ì–¸ì–´</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td>$a$</td>
<td>$\{a\}$</td>
<td>ë¬¸ìì—´ "a"ë§Œ</td>
</tr>
<tr>
<td>$a \mid b$</td>
<td>$\{a, b\}$</td>
<td>"a" ë˜ëŠ” "b"</td>
</tr>
<tr>
<td>$ab$</td>
<td>$\{ab\}$</td>
<td>ë¬¸ìì—´ "ab"</td>
</tr>
<tr>
<td>$a^*$</td>
<td>$\{\epsilon, a, aa, aaa, \ldots\}$</td>
<td>aê°€ 0ê°œ ì´ìƒ</td>
</tr>
<tr>
<td>$(a \mid b)^*$</td>
<td>$\{a, b\}$ ìœ„ì˜ ëª¨ë“  ë¬¸ìì—´</td>
<td>aì™€ bì˜ ì„ì˜ ì¡°í•©</td>
</tr>
<tr>
<td>$a(a \mid b)^*$</td>
<td>aë¡œ ì‹œì‘í•˜ëŠ” $\{a,b\}$ ìœ„ì˜ ë¬¸ìì—´</td>
<td>aë¡œ ì‹œì‘</td>
</tr>
<tr>
<td>$(0 \mid 1)^* 0$</td>
<td>0ìœ¼ë¡œ ëë‚˜ëŠ” ì´ì§„ ë¬¸ìì—´</td>
<td>ì§ìˆ˜ ì´ì§„ìˆ˜</td>
</tr>
</tbody>
</table>
<h3 id="shorthands">í¸ì˜ í‘œê¸°(Shorthands)<a class="header-link" href="#shorthands" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì€ í˜•ì‹ì  ì •ì˜ì˜ ì¼ë¶€ëŠ” ì•„ë‹ˆì§€ë§Œ ìì£¼ ì‚¬ìš©ë˜ëŠ” í‘œê¸°ì…ë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>í‘œê¸°</th>
<th>ì˜ë¯¸</th>
<th>í˜•ì‹ì  ë™ì¹˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>$r^+$</td>
<td>í•˜ë‚˜ ì´ìƒ</td>
<td>$rr^*$</td>
</tr>
<tr>
<td>$r?$</td>
<td>0ê°œ ë˜ëŠ” 1ê°œ</td>
<td>$r \mid \epsilon$</td>
</tr>
<tr>
<td>$[a\text{-}z]$</td>
<td>ë¬¸ì í´ë˜ìŠ¤</td>
<td>$a \mid b \mid \cdots \mid z$</td>
</tr>
<tr>
<td>$[0\text{-}9]$</td>
<td>ìˆ«ì</td>
<td>$0 \mid 1 \mid \cdots \mid 9$</td>
</tr>
<tr>
<td>$.$</td>
<td>ì„ì˜ ë¬¸ì</td>
<td>$\Sigma$ (ì „ì²´ í•©ì§‘í•©)</td>
</tr>
<tr>
<td>$r\{n\}$</td>
<td>ì •í™•íˆ $n$ë²ˆ ë°˜ë³µ</td>
<td>$\underbrace{rr\cdots r}_{n}$</td>
</tr>
</tbody>
</table>
<h3 id="_9">ì •ê·œ í‘œí˜„ì‹ìœ¼ë¡œ í‘œí˜„í•œ í† í° íŒ¨í„´<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nl">Identifier</span><span class="p">:</span><span class="w">  </span><span class="o">[</span><span class="n">a-zA-Z_</span><span class="o">][</span><span class="n">a-zA-Z0-9_</span><span class="o">]*</span>
<span class="k">Integer</span><span class="err">:</span><span class="w">     </span><span class="o">[</span><span class="n">0-9</span><span class="o">]+</span>
<span class="nc">Float</span><span class="err">:</span><span class="w">       </span><span class="o">[</span><span class="n">0-9</span><span class="o">]+</span><span class="err">\</span><span class="p">.</span><span class="o">[</span><span class="n">0-9</span><span class="o">]+</span><span class="p">(</span><span class="o">[</span><span class="n">eE</span><span class="o">][</span><span class="n">+-</span><span class="o">]</span><span class="vm">?</span><span class="o">[</span><span class="n">0-9</span><span class="o">]+</span><span class="p">)</span><span class="vm">?</span>
<span class="nl">String</span><span class="p">:</span><span class="w">      </span><span class="ss">&quot;[^&quot;</span><span class="err">\\]</span><span class="o">*</span><span class="p">(</span><span class="err">\\</span><span class="p">.</span><span class="o">[</span><span class="n">^&quot;\\</span><span class="o">]*</span><span class="p">)</span><span class="o">*</span><span class="err">&quot;</span>
<span class="nl">Comment</span><span class="p">:</span><span class="w">     </span><span class="o">//[</span><span class="n">^\n</span><span class="o">]*</span>
<span class="nl">Whitespace</span><span class="p">:</span><span class="w">  </span><span class="o">[</span><span class="n"> \t\n\r</span><span class="o">]+</span>
</code></pre></div>

<h3 id="_10">ì •ê·œ í‘œí˜„ì‹ì˜ ëŒ€ìˆ˜ ë²•ì¹™<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<p>ì •ê·œ í‘œí˜„ì‹ì€ ë‹¤ìŒ í•­ë“±ì‹ì„ ë”°ë¦…ë‹ˆë‹¤(ë‹¨ìˆœí™”ì— ìœ ìš©):</p>
<table>
<thead>
<tr>
<th>ë²•ì¹™</th>
<th>ë‚´ìš©</th>
</tr>
</thead>
<tbody>
<tr>
<td>í•©ì§‘í•©ì˜ êµí™˜ë²•ì¹™</td>
<td>$r \mid s = s \mid r$</td>
</tr>
<tr>
<td>í•©ì§‘í•©ì˜ ê²°í•©ë²•ì¹™</td>
<td>$(r \mid s) \mid t = r \mid (s \mid t)$</td>
</tr>
<tr>
<td>ì—°ì ‘ì˜ ê²°í•©ë²•ì¹™</td>
<td>$(rs)t = r(st)$</td>
</tr>
<tr>
<td>ì—°ì ‘ì˜ í•©ì§‘í•© ë¶„ë°°ë²•ì¹™</td>
<td>$r(s \mid t) = rs \mid rt$</td>
</tr>
<tr>
<td>$\epsilon$ì€ ì—°ì ‘ì˜ í•­ë“±ì›</td>
<td>$\epsilon r = r\epsilon = r$</td>
</tr>
<tr>
<td>$\emptyset$ì€ í•©ì§‘í•©ì˜ í•­ë“±ì›</td>
<td>$r \mid \emptyset = r$</td>
</tr>
<tr>
<td>$\emptyset$ì€ ì—°ì ‘ì˜ ì˜ì›(Zero)</td>
<td>$\emptyset r = r\emptyset = \emptyset$</td>
</tr>
<tr>
<td>ìŠ¤íƒ€ì˜ ë©±ë“±ì„±</td>
<td>$(r^*)^* = r^*$</td>
</tr>
<tr>
<td>ì—¡ì‹¤ë¡ ì˜ ìŠ¤íƒ€</td>
<td>$\epsilon^* = \epsilon$</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-nfa-thompsons-construction">4. ì •ê·œ í‘œí˜„ì‹ì—ì„œ NFAë¡œ: í†°ìŠ¨ êµ¬ì„±ë²•(Thompson's Construction)<a class="header-link" href="#4-nfa-thompsons-construction" title="Permanent link">&para;</a></h2>
<p><strong>í†°ìŠ¨ êµ¬ì„±ë²•</strong>(Ken Thompson, 1968)ì€ ì •ê·œ í‘œí˜„ì‹ì„ $\epsilon$-ì „ì´(epsilon-transition)ë¥¼ í¬í•¨í•˜ëŠ” ë™ì¹˜ NFA(ë¹„ê²°ì •ì  ìœ í•œ ì˜¤í† ë§ˆí†¤, Nondeterministic Finite Automaton)ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
<h3 id="nfa">NFA ì •ì˜ (ê°„ëµ)<a class="header-link" href="#nfa" title="Permanent link">&para;</a></h3>
<p>NFAëŠ” 5-íŠœí”Œ $(Q, \Sigma, \delta, q_0, F)$ì´ë©°:
- $Q$: ìœ í•œ ìƒíƒœ ì§‘í•©
- $\Sigma$: ì…ë ¥ ì•ŒíŒŒë²³
- $\delta: Q \times (\Sigma \cup \{\epsilon\}) \rightarrow \mathcal{P}(Q)$: ì „ì´ í•¨ìˆ˜
- $q_0 \in Q$: ì‹œì‘ ìƒíƒœ
- $F \subseteq Q$: ìˆ˜ë½ ìƒíƒœ ì§‘í•©</p>
<h3 id="_11">êµ¬ì„± ê·œì¹™<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<p>ê° ê·œì¹™ì€ <strong>ì‹œì‘ ìƒíƒœ í•˜ë‚˜</strong>ì™€ <strong>ìˆ˜ë½ ìƒíƒœ í•˜ë‚˜</strong>ë¥¼ ê°€ì§„ NFAë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì‹œì‘ ìƒíƒœë¡œ ë“¤ì–´ì˜¤ëŠ” ì „ì´ë‚˜ ìˆ˜ë½ ìƒíƒœì—ì„œ ë‚˜ê°€ëŠ” ì „ì´ëŠ” ì—†ìŠµë‹ˆë‹¤.</p>
<p><strong>ê¸°ì € ì‚¬ë¡€ 1: ë¹ˆ ë¬¸ìì—´ $\epsilon$</strong></p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="o">--&gt;</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span><span class="o">---</span><span class="err">Îµ</span><span class="o">---&gt;</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="w">     </span><span class="n">start</span><span class="w">       </span><span class="n">accept</span>
</code></pre></div>

<p><strong>ê¸°ì € ì‚¬ë¡€ 2: ë‹¨ì¼ ê¸°í˜¸ $a$</strong></p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="o">--&gt;</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span><span class="o">---</span><span class="n">a</span><span class="o">---&gt;</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="w">     </span><span class="n">start</span><span class="w">       </span><span class="n">accept</span>
</code></pre></div>

<p><strong>ê·€ë‚©ì  ì‚¬ë¡€ 1: í•©ì§‘í•© $r \mid s$</strong></p>
<p>ìƒíƒœ $(r_0, r_f)$ë¥¼ ê°€ì§„ NFA $N(r)$ê³¼ ìƒíƒœ $(s_0, s_f)$ë¥¼ ê°€ì§„ NFA $N(s)$ì— ëŒ€í•´:</p>
<div class="highlight"><pre><span></span><code><span class="w">              </span><span class="err">Îµ</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span><span class="w"> </span><span class="o">---</span><span class="err">Îµ</span><span class="o">---&gt;</span>
<span class="w">            </span><span class="o">/</span><span class="w">                        </span><span class="err">\</span>
<span class="w">  </span><span class="o">--&gt;</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span><span class="w">                              </span><span class="p">(</span><span class="n">q_f</span><span class="p">)</span>
<span class="w">            </span><span class="err">\</span><span class="w">                        </span><span class="o">/</span>
<span class="w">              </span><span class="err">Îµ</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span><span class="w"> </span><span class="o">---</span><span class="err">Îµ</span><span class="o">---&gt;</span>
<span class="w">     </span><span class="n">start</span><span class="w">                          </span><span class="n">accept</span>
</code></pre></div>

<p><strong>ê·€ë‚©ì  ì‚¬ë¡€ 2: ì—°ì ‘ $rs$</strong></p>
<p>$N(r)$ì˜ ìˆ˜ë½ ìƒíƒœì™€ $N(s)$ì˜ ì‹œì‘ ìƒíƒœë¥¼ í•©ì¹©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="o">--&gt;</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span><span class="o">---</span><span class="p">[</span><span class="n">N</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span><span class="o">---&gt;</span><span class="p">(</span><span class="n">r_f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s_0</span><span class="p">)</span><span class="o">---</span><span class="p">[</span><span class="n">N</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span><span class="o">---&gt;</span><span class="p">(</span><span class="n">s_f</span><span class="p">)</span>
<span class="w">     </span><span class="n">start</span><span class="w">                                     </span><span class="n">accept</span>
</code></pre></div>

<p><strong>ê·€ë‚©ì  ì‚¬ë¡€ 3: í´ë¦¬ë‹ˆ ìŠ¤íƒ€ $r^*$</strong></p>
<div class="highlight"><pre><span></span><code><span class="w">              </span><span class="err">Îµ</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">N</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span><span class="w"> </span><span class="o">---</span><span class="err">Îµ</span><span class="o">---&gt;</span>
<span class="w">            </span><span class="o">/</span><span class="w">           </span><span class="o">|</span><span class="w">            </span><span class="err">\</span>
<span class="w">  </span><span class="o">--&gt;</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span><span class="w">     </span><span class="o">&lt;---</span><span class="err">Îµ</span><span class="o">-----+</span><span class="w">             </span><span class="p">(</span><span class="n">q_f</span><span class="p">)</span>
<span class="w">            </span><span class="err">\</span><span class="w">                        </span><span class="o">/</span>
<span class="w">              </span><span class="o">----------</span><span class="err">Îµ</span><span class="o">----------&gt;</span>
<span class="w">     </span><span class="n">start</span><span class="w">                          </span><span class="n">accept</span>
</code></pre></div>

<h3 id="_12">í†°ìŠ¨ êµ¬ì„±ë²•ì˜ íŠ¹ì„±<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<ol>
<li>ê¸¸ì´ $n$ì˜ ì •ê·œ í‘œí˜„ì‹ì— ëŒ€í•´ NFAê°€ ìµœëŒ€ $2n$ê°œì˜ ìƒíƒœë¥¼ ê°€ì§‘ë‹ˆë‹¤.</li>
<li>ê° ìƒíƒœëŠ” ìµœëŒ€ ë‘ ê°œì˜ ë‚˜ê°€ëŠ” ì „ì´ë¥¼ ê°€ì§‘ë‹ˆë‹¤.</li>
<li>NFAëŠ” ì •í™•íˆ í•˜ë‚˜ì˜ ì‹œì‘ ìƒíƒœì™€ í•˜ë‚˜ì˜ ìˆ˜ë½ ìƒíƒœë¥¼ ê°€ì§‘ë‹ˆë‹¤.</li>
<li>êµ¬ì„± ê³¼ì •ì€ ì •ê·œ í‘œí˜„ì‹ í¬ê¸°ì— ì„ í˜•ì : $O(n)$</li>
</ol>
<h3 id="python">Python êµ¬í˜„<a class="header-link" href="#python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NFAState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A state in an NFA.&quot;&quot;&quot;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">is_accept</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">transitions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="s1">&#39;NFAState&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="s1">&#39;NFAState&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a transition on symbol (use &#39;Îµ&#39; for epsilon).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">NFAState</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot; (accept)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_accept</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;q</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">NFA</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Nondeterministic Finite Automaton.&quot;&quot;&quot;</span>

    <span class="n">_state_counter</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="n">NFAState</span><span class="p">,</span> <span class="n">accept</span><span class="p">:</span> <span class="n">NFAState</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span> <span class="o">=</span> <span class="n">accept</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_new_state</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">is_accept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NFAState</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">NFAState</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_state_counter</span><span class="p">,</span> <span class="n">is_accept</span><span class="o">=</span><span class="n">is_accept</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_state_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_counter</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_state_counter</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_epsilon</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NFA&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thompson&#39;s construction: epsilon.&quot;&quot;&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">()</span>
        <span class="n">accept</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">(</span><span class="n">is_accept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">start</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_symbol</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NFA&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thompson&#39;s construction: single symbol.&quot;&quot;&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">()</span>
        <span class="n">accept</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">(</span><span class="n">is_accept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">start</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">union</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">nfa1</span><span class="p">:</span> <span class="s1">&#39;NFA&#39;</span><span class="p">,</span> <span class="n">nfa2</span><span class="p">:</span> <span class="s1">&#39;NFA&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NFA&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thompson&#39;s construction: r | s.&quot;&quot;&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">()</span>
        <span class="n">accept</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">(</span><span class="n">is_accept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">start</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">nfa1</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="n">start</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">nfa2</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>

        <span class="n">nfa1</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">is_accept</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">nfa1</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>

        <span class="n">nfa2</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">is_accept</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">nfa2</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">concatenation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">nfa1</span><span class="p">:</span> <span class="s1">&#39;NFA&#39;</span><span class="p">,</span> <span class="n">nfa2</span><span class="p">:</span> <span class="s1">&#39;NFA&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NFA&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thompson&#39;s construction: r s.&quot;&quot;&quot;</span>
        <span class="n">nfa1</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">is_accept</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">nfa1</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">nfa2</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">nfa1</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">nfa2</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">kleene_star</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">nfa1</span><span class="p">:</span> <span class="s1">&#39;NFA&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NFA&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thompson&#39;s construction: r*.&quot;&quot;&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">()</span>
        <span class="n">accept</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_new_state</span><span class="p">(</span><span class="n">is_accept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">start</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">nfa1</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="n">start</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>

        <span class="n">nfa1</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">is_accept</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">nfa1</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">nfa1</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="n">nfa1</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">accept</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">regex_to_nfa</span><span class="p">(</span><span class="n">regex</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NFA</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a simple regex to NFA using Thompson&#39;s construction.</span>

<span class="sd">    Supported operators: | (union), * (star), concatenation (implicit),</span>
<span class="sd">                         ( ) (grouping)</span>

<span class="sd">    This parser handles operator precedence correctly:</span>
<span class="sd">      * &gt; concatenation &gt; |</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">NFA</span><span class="o">.</span><span class="n">reset_counter</span><span class="p">()</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">peek</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">pos</span>
        <span class="k">return</span> <span class="n">regex</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">consume</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">pos</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">regex</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
        <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ch</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_expr</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NFA</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;expr = term (&#39;|&#39; term)*&quot;&quot;&quot;</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">parse_term</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;|&#39;</span><span class="p">:</span>
            <span class="n">consume</span><span class="p">()</span>  <span class="c1"># eat &#39;|&#39;</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">parse_term</span><span class="p">()</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">NFA</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">left</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_term</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NFA</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;term = factor+&quot;&quot;&quot;</span>
        <span class="c1"># A term is one or more concatenated factors</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">parse_factor</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">peek</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">peek</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">):</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">parse_factor</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">NFA</span><span class="o">.</span><span class="n">concatenation</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_factor</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NFA</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;factor = base (&#39;*&#39;)?&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">parse_base</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
            <span class="n">consume</span><span class="p">()</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">NFA</span><span class="o">.</span><span class="n">kleene_star</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_base</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NFA</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;base = &#39;(&#39; expr &#39;)&#39; | symbol&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
            <span class="n">consume</span><span class="p">()</span>  <span class="c1"># eat &#39;(&#39;</span>
            <span class="n">nfa</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">peek</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Expected &#39;)&#39;&quot;</span><span class="p">)</span>
            <span class="n">consume</span><span class="p">()</span>  <span class="c1"># eat &#39;)&#39;</span>
            <span class="k">return</span> <span class="n">nfa</span>
        <span class="k">elif</span> <span class="n">peek</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">peek</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">):</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="n">consume</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">NFA</span><span class="o">.</span><span class="n">from_symbol</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Empty: return epsilon NFA</span>
            <span class="k">return</span> <span class="n">NFA</span><span class="o">.</span><span class="n">from_epsilon</span><span class="p">()</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">regex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected character at position </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">regex</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span><span class="w"> </span><span class="nf">epsilon_closure</span><span class="p">(</span><span class="n">states</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">NFAState</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">NFAState</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the epsilon-closure of a set of NFA states.&quot;&quot;&quot;</span>
    <span class="n">closure</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Îµ&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="k">if</span> <span class="n">target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">closure</span><span class="p">:</span>
                <span class="n">closure</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">closure</span>


<span class="k">def</span><span class="w"> </span><span class="nf">nfa_simulate</span><span class="p">(</span><span class="n">nfa</span><span class="p">:</span> <span class="n">NFA</span><span class="p">,</span> <span class="n">input_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate an NFA on an input string.&quot;&quot;&quot;</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">epsilon_closure</span><span class="p">({</span><span class="n">nfa</span><span class="o">.</span><span class="n">start</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">input_string</span><span class="p">:</span>
        <span class="n">next_states</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">current</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="n">next_states</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">epsilon_closure</span><span class="p">(</span><span class="n">next_states</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">is_accept</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">current</span><span class="p">)</span>


<span class="c1"># Example usage</span>
<span class="n">nfa</span> <span class="o">=</span> <span class="n">regex_to_nfa</span><span class="p">(</span><span class="s2">&quot;(a|b)*abb&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NFA for (a|b)*abb&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;abb&#39;:   </span><span class="si">{</span><span class="n">nfa_simulate</span><span class="p">(</span><span class="n">nfa</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;abb&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>      <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;aabb&#39;:  </span><span class="si">{</span><span class="n">nfa_simulate</span><span class="p">(</span><span class="n">nfa</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;aabb&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>     <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;babb&#39;:  </span><span class="si">{</span><span class="n">nfa_simulate</span><span class="p">(</span><span class="n">nfa</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;babb&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>     <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;ab&#39;:    </span><span class="si">{</span><span class="n">nfa_simulate</span><span class="p">(</span><span class="n">nfa</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>       <span class="c1"># False</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;abab&#39;:  </span><span class="si">{</span><span class="n">nfa_simulate</span><span class="p">(</span><span class="n">nfa</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;abab&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>     <span class="c1"># False</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;&#39;:      </span><span class="si">{</span><span class="n">nfa_simulate</span><span class="p">(</span><span class="n">nfa</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>          <span class="c1"># False</span>
</code></pre></div>

<hr />
<h2 id="5-nfa-dfa-subset-construction">5. NFAì—ì„œ DFAë¡œ: ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•(Subset Construction)<a class="header-link" href="#5-nfa-dfa-subset-construction" title="Permanent link">&para;</a></h2>
<p>NFAëŠ” ì •ê·œ í‘œí˜„ì‹ì—ì„œ ë§Œë“¤ê¸°ëŠ” ì‰½ì§€ë§Œ ë¹„ê²°ì •ì ì…ë‹ˆë‹¤. ì¦‰, ê°™ì€ ê¸°í˜¸ì— ëŒ€í•´ í•˜ë‚˜ì˜ ìƒíƒœì—ì„œ ì—¬ëŸ¬ ì „ì´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. <strong>DFA</strong>(ê²°ì •ì  ìœ í•œ ì˜¤í† ë§ˆí†¤, Deterministic Finite Automaton)ëŠ” ê° ìƒíƒœê°€ ê¸°í˜¸ë‹¹ ì •í™•íˆ í•˜ë‚˜ì˜ ì „ì´ë§Œ ê°€ì§€ë¯€ë¡œ ì‹œë®¬ë ˆì´ì…˜ íš¨ìœ¨ì´ ë” ë†’ìŠµë‹ˆë‹¤.</p>
<p><strong>ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•</strong>(ë˜ëŠ” <strong>ë©±ì§‘í•© êµ¬ì„±ë²•</strong>, Powerset Construction)ì€ NFAë¥¼ ë™ì¹˜ DFAë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
<h3 id="_13">ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#_13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">Input</span><span class="err">:</span><span class="w">  </span><span class="n">NFA</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Q_N</span><span class="p">,</span><span class="w"> </span><span class="n">Î£</span><span class="p">,</span><span class="w"> </span><span class="n">Î´_N</span><span class="p">,</span><span class="w"> </span><span class="n">q_0</span><span class="p">,</span><span class="w"> </span><span class="n">F_N</span><span class="p">)</span>
<span class="k">Output</span><span class="err">:</span><span class="w"> </span><span class="n">DFA</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Q_D</span><span class="p">,</span><span class="w"> </span><span class="n">Î£</span><span class="p">,</span><span class="w"> </span><span class="n">Î´_D</span><span class="p">,</span><span class="w"> </span><span class="n">d_0</span><span class="p">,</span><span class="w"> </span><span class="n">F_D</span><span class="p">)</span>

<span class="mf">1.</span><span class="w"> </span><span class="n">d_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Îµ</span><span class="o">-</span><span class="n">closure</span><span class="p">(</span><span class="err">{</span><span class="n">q_0</span><span class="err">}</span><span class="p">)</span><span class="w">                  </span><span class="o">//</span><span class="w"> </span><span class="n">DFAì˜</span><span class="w"> </span><span class="n">ì‹œì‘</span><span class="w"> </span><span class="n">ìƒíƒœ</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">Q_D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="n">d_0</span><span class="err">}</span><span class="w">                              </span><span class="o">//</span><span class="w"> </span><span class="n">DFA</span><span class="w"> </span><span class="n">ìƒíƒœ</span><span class="w"> </span><span class="n">ì§‘í•©</span><span class="w"> </span><span class="p">(</span><span class="n">ê°</span><span class="w"> </span><span class="n">ì›ì†ŒëŠ”</span><span class="w"> </span><span class="n">NFA</span><span class="w"> </span><span class="n">ìƒíƒœ</span><span class="w"> </span><span class="n">ì§‘í•©</span><span class="p">)</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">worklist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">d_0</span><span class="o">]</span><span class="w">                         </span><span class="o">//</span><span class="w"> </span><span class="n">ì²˜ë¦¬í• </span><span class="w"> </span><span class="n">ìƒíƒœ</span>
<span class="mf">4.</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">worklist</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">empty</span><span class="p">:</span>
<span class="mf">5.</span><span class="w">     </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">worklist</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
<span class="mf">6.</span><span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">Î£</span><span class="p">:</span>
<span class="mf">7.</span><span class="w">         </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Îµ</span><span class="o">-</span><span class="n">closure</span><span class="p">(</span><span class="n">move</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">))</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">move</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sì—</span><span class="w"> </span><span class="n">ì†í•œ</span><span class="w"> </span><span class="n">ëª¨ë“ </span><span class="w"> </span><span class="n">sì—</span><span class="w"> </span><span class="n">ëŒ€í•œ</span><span class="w"> </span><span class="n">Î´_N</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="n">ì˜</span><span class="w"> </span><span class="n">í•©ì§‘í•©</span>
<span class="mf">8.</span><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">empty</span><span class="p">:</span>
<span class="mf">9.</span><span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">Q_D</span><span class="p">:</span>
<span class="mf">10.</span><span class="w">                </span><span class="n">Q_D</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="mf">11.</span><span class="w">                </span><span class="n">worklist</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="mf">12.</span><span class="w">            </span><span class="n">Î´_D</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span>
<span class="mf">13.</span><span class="w"> </span><span class="n">F_D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="n">S</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Q_D</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="err">âˆ©</span><span class="w"> </span><span class="n">F_N</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="err">âˆ…}</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">NFA</span><span class="w"> </span><span class="n">ìˆ˜ë½</span><span class="w"> </span><span class="n">ìƒíƒœë¥¼</span><span class="w"> </span><span class="n">í¬í•¨í•˜ëŠ”</span><span class="w"> </span><span class="n">DFA</span><span class="w"> </span><span class="n">ìƒíƒœê°€</span><span class="w"> </span><span class="n">ìˆ˜ë½</span><span class="w"> </span><span class="n">ìƒíƒœ</span>
</code></pre></div>

<h3 id="_14">ë³µì¡ë„<a class="header-link" href="#_14" title="Permanent link">&para;</a></h3>
<p>ìµœì•…ì˜ ê²½ìš°, ìƒíƒœ ìˆ˜ $n$ì¸ NFAì—ì„œ $2^n$ê°œì˜ ìƒíƒœë¥¼ ê°€ì§„ DFAê°€ ìƒì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ë”°ë¼ì„œ "ë©±ì§‘í•©" êµ¬ì„±ë²•ì´ë¼ ë¶ˆë¦½ë‹ˆë‹¤). ì‹¤ì œë¡œëŠ” ë„ë‹¬ ê°€ëŠ¥í•œ ìƒíƒœì˜ ìˆ˜ê°€ í›¨ì”¬ ì ìŠµë‹ˆë‹¤.</p>
<h3 id="python_1">Python êµ¬í˜„<a class="header-link" href="#python_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrozenSet</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DFAState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A state in a DFA, corresponding to a set of NFA states.&quot;&quot;&quot;</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">nfa_states</span><span class="p">:</span> <span class="n">FrozenSet</span><span class="p">[</span><span class="n">NFAState</span><span class="p">]</span>
    <span class="n">is_accept</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">transitions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;DFAState&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">nfa_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfa_states</span><span class="p">)</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot; (accept)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_accept</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;D</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="se">{{</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">nfa_ids</span><span class="p">))</span><span class="si">}</span><span class="se">}}</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DFA</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deterministic Finite Automaton.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="n">DFAState</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DFAState</span><span class="p">],</span> <span class="n">alphabet</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="n">states</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_nfa</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">nfa</span><span class="p">:</span> <span class="n">NFA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DFA&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert NFA to DFA using subset construction.&quot;&quot;&quot;</span>

        <span class="c1"># Collect alphabet (all symbols except epsilon)</span>
        <span class="n">alphabet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">visited_nfa</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">nfa</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">visited_nfa</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">visited_nfa</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">targets</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">symbol</span> <span class="o">!=</span> <span class="s1">&#39;Îµ&#39;</span><span class="p">:</span>
                    <span class="n">alphabet</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="c1"># Subset construction</span>
        <span class="n">dfa_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">start_nfa_states</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">epsilon_closure</span><span class="p">({</span><span class="n">nfa</span><span class="o">.</span><span class="n">start</span><span class="p">}))</span>
        <span class="n">start_is_accept</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">is_accept</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">start_nfa_states</span><span class="p">)</span>
        <span class="n">start_dfa</span> <span class="o">=</span> <span class="n">DFAState</span><span class="p">(</span><span class="n">dfa_id</span><span class="p">,</span> <span class="n">start_nfa_states</span><span class="p">,</span> <span class="n">start_is_accept</span><span class="p">)</span>
        <span class="n">dfa_id</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Map from frozenset of NFA states -&gt; DFA state</span>
        <span class="n">state_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">start_nfa_states</span><span class="p">:</span> <span class="n">start_dfa</span><span class="p">}</span>
        <span class="n">dfa_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_dfa</span><span class="p">]</span>
        <span class="n">worklist</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_dfa</span><span class="p">]</span>

        <span class="k">while</span> <span class="n">worklist</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">worklist</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">alphabet</span><span class="p">):</span>
                <span class="c1"># Compute move(current.nfa_states, symbol)</span>
                <span class="n">move_result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">nfa_state</span> <span class="ow">in</span> <span class="n">current</span><span class="o">.</span><span class="n">nfa_states</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">nfa_state</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="p">[]):</span>
                        <span class="n">move_result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">move_result</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># Compute epsilon-closure of the move result</span>
                <span class="n">closure</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">epsilon_closure</span><span class="p">(</span><span class="n">move_result</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">closure</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state_map</span><span class="p">:</span>
                    <span class="n">is_accept</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">is_accept</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">closure</span><span class="p">)</span>
                    <span class="n">new_state</span> <span class="o">=</span> <span class="n">DFAState</span><span class="p">(</span><span class="n">dfa_id</span><span class="p">,</span> <span class="n">closure</span><span class="p">,</span> <span class="n">is_accept</span><span class="p">)</span>
                    <span class="n">dfa_id</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">state_map</span><span class="p">[</span><span class="n">closure</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_state</span>
                    <span class="n">dfa_states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
                    <span class="n">worklist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>

                <span class="n">current</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="n">state_map</span><span class="p">[</span><span class="n">closure</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start_dfa</span><span class="p">,</span> <span class="n">dfa_states</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate the DFA on an input string.&quot;&quot;&quot;</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">input_string</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">current</span><span class="o">.</span><span class="n">is_accept</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the DFA transition table.&quot;&quot;&quot;</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;State&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Accept&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> | &quot;</span> <span class="o">+</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;D&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;yes&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">state</span><span class="o">.</span><span class="n">is_accept</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;no&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> | &quot;</span>
            <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
                    <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;D&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;--&#39;</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>


<span class="c1"># Example: Convert NFA for (a|b)*abb to DFA</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== NFA to DFA: (a|b)*abb ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">nfa</span> <span class="o">=</span> <span class="n">regex_to_nfa</span><span class="p">(</span><span class="s2">&quot;(a|b)*abb&quot;</span><span class="p">)</span>
<span class="n">dfa</span> <span class="o">=</span> <span class="n">DFA</span><span class="o">.</span><span class="n">from_nfa</span><span class="p">(</span><span class="n">nfa</span><span class="p">)</span>
<span class="n">dfa</span><span class="o">.</span><span class="n">print_table</span><span class="p">()</span>

<span class="nb">print</span><span class="p">()</span>
<span class="n">test_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;abb&quot;</span><span class="p">,</span> <span class="s2">&quot;aabb&quot;</span><span class="p">,</span> <span class="s2">&quot;babb&quot;</span><span class="p">,</span> <span class="s2">&quot;ababb&quot;</span><span class="p">,</span> <span class="s2">&quot;ab&quot;</span><span class="p">,</span> <span class="s2">&quot;ba&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">test_strings</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">dfa</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="s1">&#39;accepted&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;rejected&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-dfa-dfa-minimization-hopcrofts-algorithm">6. DFA ìµœì†Œí™”(DFA Minimization): í™‰í¬ë¡œí”„íŠ¸ ì•Œê³ ë¦¬ì¦˜(Hopcroft's Algorithm)<a class="header-link" href="#6-dfa-dfa-minimization-hopcrofts-algorithm" title="Permanent link">&para;</a></h2>
<p>ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•ìœ¼ë¡œ ìƒì„±ëœ DFAëŠ” ë¶ˆí•„ìš”í•˜ê²Œ ë§ì€ ìƒíƒœë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <strong>DFA ìµœì†Œí™”</strong>ëŠ” ë™ì¼í•œ ì–¸ì–´ë¥¼ ì¸ì‹í•˜ëŠ” ê°€ì¥ ì‘ì€ DFAë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<h3 id="equivalent-states">ë™ì¹˜ ìƒíƒœ(Equivalent States)<a class="header-link" href="#equivalent-states" title="Permanent link">&para;</a></h3>
<p>ë‘ ìƒíƒœ $p$ì™€ $q$ê°€ <strong>ë™ì¹˜</strong>(êµ¬ë³„ ë¶ˆê°€ëŠ¥)ì¸ ê²ƒì€ ëª¨ë“  ë¬¸ìì—´ $w$ì— ëŒ€í•´:</p>
<p>$$\hat{\delta}(p, w) \in F \iff \hat{\delta}(q, w) \in F$$</p>
<p>ì¦‰, $p$ë‚˜ $q$ì—ì„œ ì¶œë°œí•˜ë”ë¼ë„ DFAê°€ ì •í™•íˆ ê°™ì€ ë¬¸ìì—´ ì§‘í•©ì„ ìˆ˜ë½í•©ë‹ˆë‹¤.</p>
<h3 id="partition-refinement">í™‰í¬ë¡œí”„íŠ¸ ì•Œê³ ë¦¬ì¦˜ (ë¶„í•  ì •ì œ, Partition Refinement)<a class="header-link" href="#partition-refinement" title="Permanent link">&para;</a></h3>
<p>ì•Œê³ ë¦¬ì¦˜ì€ ê±°ì¹œ ë¶„í• ë¡œ ì‹œì‘í•˜ì—¬ ì ì°¨ ì„¸ë°€í•˜ê²Œ ì •ì œí•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="n">Input</span><span class="o">:</span><span class="w">  </span><span class="n">DFA</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="n">Q</span><span class="o">,</span><span class="w"> </span><span class="err">Î£</span><span class="o">,</span><span class="w"> </span><span class="err">Î´</span><span class="o">,</span><span class="w"> </span><span class="n">q_0</span><span class="o">,</span><span class="w"> </span><span class="n">F</span><span class="o">)</span>
<span class="n">Output</span><span class="o">:</span><span class="w"> </span><span class="n">Minimized</span><span class="w"> </span><span class="n">DFA</span><span class="w"> </span><span class="n">D</span><span class="err">&#39;</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">states</span><span class="w"> </span><span class="n">merged</span>

<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Initial</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">F</span><span class="o">,</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">\</span><span class="w"> </span><span class="n">F</span><span class="o">}</span><span class="w">     </span><span class="c1">// ìˆ˜ë½ ìƒíƒœì™€ ë¹„ìˆ˜ë½ ìƒíƒœ</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">worklist</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">F</span><span class="o">}</span><span class="w">                      </span><span class="c1">// (ë˜ëŠ” F, Q\F ì¤‘ ë” ì‘ì€ ê²ƒ)</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">empty</span><span class="o">:</span>
<span class="mi">4</span><span class="o">.</span><span class="w">     </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="o">.</span><span class="na">pop</span><span class="o">()</span>
<span class="mi">5</span><span class="o">.</span><span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">Î£</span><span class="o">:</span>
<span class="mi">6</span><span class="o">.</span><span class="w">         </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">q</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">Î´</span><span class="o">(</span><span class="n">q</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">A</span><span class="o">}</span><span class="w">  </span><span class="c1">// cë¡œ Aì— ì „ì´í•˜ëŠ” ìƒíƒœë“¤</span>
<span class="mi">7</span><span class="o">.</span><span class="w">         </span><span class="k">for</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">P</span><span class="o">:</span>
<span class="mi">8</span><span class="o">.</span><span class="w">             </span><span class="n">Y1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="err">âˆ©</span><span class="w"> </span><span class="n">X</span><span class="w">                </span><span class="c1">// Aë¡œ ê°€ëŠ” Yì˜ ìƒíƒœë“¤</span>
<span class="mi">9</span><span class="o">.</span><span class="w">             </span><span class="n">Y2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">\</span><span class="w"> </span><span class="n">X</span><span class="w">               </span><span class="c1">// Aë¡œ ê°€ì§€ ì•ŠëŠ” Yì˜ ìƒíƒœë“¤</span>
<span class="mi">10</span><span class="o">.</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">Y1</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="err">âˆ…</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">Y2</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="err">âˆ…</span><span class="o">:</span><span class="w">    </span><span class="c1">// Yê°€ ë¶„í• ë¨</span>
<span class="mi">11</span><span class="o">.</span><span class="w">                </span><span class="n">Replace</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">Y1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">Y2</span>
<span class="mi">12</span><span class="o">.</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">W</span><span class="o">:</span>
<span class="mi">13</span><span class="o">.</span><span class="w">                    </span><span class="n">Replace</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">Y1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">Y2</span>
<span class="mi">14</span><span class="o">.</span><span class="w">                </span><span class="k">else</span><span class="o">:</span>
<span class="mi">15</span><span class="o">.</span><span class="w">                    </span><span class="n">Add</span><span class="w"> </span><span class="n">smaller</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Y1</span><span class="o">,</span><span class="w"> </span><span class="n">Y2</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">W</span>
<span class="mi">16</span><span class="o">.</span><span class="w"> </span><span class="n">Return</span><span class="w"> </span><span class="n">DFA</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">state</span>
</code></pre></div>

<p><strong>ì‹œê°„ ë³µì¡ë„</strong>: $O(n \log n)$, $n = |Q|$</p>
<h3 id="python_2">Python êµ¬í˜„<a class="header-link" href="#python_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">minimize_dfa</span><span class="p">(</span><span class="n">dfa</span><span class="p">:</span> <span class="n">DFA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DFA</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Minimize a DFA using Hopcroft&#39;s algorithm (partition refinement).</span>
<span class="sd">    Returns a new minimized DFA.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">dfa</span><span class="o">.</span><span class="n">states</span>
    <span class="n">alphabet</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dfa</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>

    <span class="c1"># Remove unreachable states</span>
    <span class="n">reachable</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">dfa</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">reachable</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">reachable</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">sym</span><span class="p">])</span>
    <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">reachable</span><span class="p">]</span>

    <span class="c1"># Add dead state if needed (for completeness)</span>
    <span class="n">dead_state</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sym</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dead_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">dead_state</span> <span class="o">=</span> <span class="n">DFAState</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">nfa_states</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">(),</span>
                        <span class="n">is_accept</span><span class="o">=</span><span class="kc">False</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
                        <span class="n">dead_state</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">dead_state</span>
                    <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dead_state</span><span class="p">)</span>
                <span class="n">s</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">=</span> <span class="n">dead_state</span>

    <span class="c1"># Initial partition: {accept states, non-accept states}</span>
    <span class="n">accept_group</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">is_accept</span><span class="p">)</span>
    <span class="n">non_accept_group</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">is_accept</span><span class="p">)</span>

    <span class="n">partition</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">accept_group</span><span class="p">:</span>
        <span class="n">partition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">accept_group</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">non_accept_group</span><span class="p">:</span>
        <span class="n">partition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">non_accept_group</span><span class="p">)</span>

    <span class="c1"># Worklist</span>
    <span class="n">worklist</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">accept_group</span> <span class="ow">and</span> <span class="n">non_accept_group</span><span class="p">:</span>
        <span class="c1"># Add the smaller group</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">accept_group</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_accept_group</span><span class="p">):</span>
            <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">accept_group</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">non_accept_group</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">accept_group</span><span class="p">:</span>
        <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">accept_group</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">non_accept_group</span><span class="p">:</span>
        <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">non_accept_group</span><span class="p">)</span>

    <span class="c1"># Refinement</span>
    <span class="k">while</span> <span class="n">worklist</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">worklist</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
            <span class="c1"># X = states that transition into A on symbol c</span>
            <span class="n">X</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
                <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">transitions</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="ow">in</span> <span class="n">A</span>
            <span class="p">)</span>

            <span class="n">new_partition</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">:</span>
                <span class="n">Y1</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">&amp;</span> <span class="n">X</span>
                <span class="n">Y2</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">-</span> <span class="n">X</span>

                <span class="k">if</span> <span class="n">Y1</span> <span class="ow">and</span> <span class="n">Y2</span><span class="p">:</span>
                    <span class="n">new_partition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span>
                    <span class="n">new_partition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Y2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">worklist</span><span class="p">:</span>
                        <span class="n">worklist</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
                        <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span>
                        <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Y2</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y2</span><span class="p">):</span>
                            <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">worklist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Y2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_partition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

            <span class="n">partition</span> <span class="o">=</span> <span class="n">new_partition</span>

    <span class="c1"># Build minimized DFA</span>
    <span class="c1"># Map each old state to its partition representative</span>
    <span class="n">state_to_group</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">:</span>
        <span class="n">representative</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
            <span class="n">state_to_group</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">representative</span>

    <span class="c1"># Create new DFA states</span>
    <span class="n">new_dfa_id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">group_to_new_state</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">:</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="n">dead_state</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># Skip the dead state</span>
        <span class="n">is_accept</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">is_accept</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">group</span><span class="p">)</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">DFAState</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">new_dfa_id</span><span class="p">,</span>
            <span class="n">nfa_states</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">nfa_states</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">group</span><span class="p">)),</span>
            <span class="n">is_accept</span><span class="o">=</span><span class="n">is_accept</span>
        <span class="p">)</span>
        <span class="n">group_to_new_state</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">group</span><span class="p">)]</span> <span class="o">=</span> <span class="n">new_state</span>
        <span class="n">new_dfa_id</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Add transitions</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">:</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="n">dead_state</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">group_to_new_state</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">group</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rep</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
                <span class="n">target</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                <span class="n">target_group</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                        <span class="n">target_group</span> <span class="o">=</span> <span class="n">g</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">target_group</span> <span class="ow">and</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">target_group</span><span class="p">)</span> <span class="ow">in</span> <span class="n">group_to_new_state</span><span class="p">:</span>
                    <span class="n">new_state</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_to_new_state</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">target_group</span><span class="p">)]</span>

    <span class="c1"># Find the new start state</span>
    <span class="n">start_group</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">partition</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dfa</span><span class="o">.</span><span class="n">start</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
            <span class="n">start_group</span> <span class="o">=</span> <span class="n">group</span>
            <span class="k">break</span>

    <span class="n">new_start</span> <span class="o">=</span> <span class="n">group_to_new_state</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">start_group</span><span class="p">)]</span>
    <span class="n">new_states</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">group_to_new_state</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">DFA</span><span class="p">(</span><span class="n">new_start</span><span class="p">,</span> <span class="n">new_states</span><span class="p">,</span> <span class="n">dfa</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>


<span class="c1"># Example</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== DFA Minimization ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before minimization:&quot;</span><span class="p">)</span>
<span class="n">dfa</span><span class="o">.</span><span class="n">print_table</span><span class="p">()</span>

<span class="n">min_dfa</span> <span class="o">=</span> <span class="n">minimize_dfa</span><span class="p">(</span><span class="n">dfa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After minimization (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">min_dfa</span><span class="o">.</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s2"> states):&quot;</span><span class="p">)</span>
<span class="n">min_dfa</span><span class="o">.</span><span class="n">print_table</span><span class="p">()</span>

<span class="c1"># Verify correctness</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Verification:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;abb&quot;</span><span class="p">,</span> <span class="s2">&quot;aabb&quot;</span><span class="p">,</span> <span class="s2">&quot;babb&quot;</span><span class="p">,</span> <span class="s2">&quot;ababb&quot;</span><span class="p">,</span> <span class="s2">&quot;ab&quot;</span><span class="p">,</span> <span class="s2">&quot;ba&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]:</span>
    <span class="n">orig</span> <span class="o">=</span> <span class="n">dfa</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">mini</span> <span class="o">=</span> <span class="n">min_dfa</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;OK&quot;</span> <span class="k">if</span> <span class="n">orig</span> <span class="o">==</span> <span class="n">mini</span> <span class="k">else</span> <span class="s2">&quot;MISMATCH!&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &#39;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&#39;: original=</span><span class="si">{</span><span class="n">orig</span><span class="si">}</span><span class="s2">, minimized=</span><span class="si">{</span><span class="n">mini</span><span class="si">}</span><span class="s2">  [</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7-token-recognition">7. í† í° ì¸ì‹(Token Recognition)<a class="header-link" href="#7-token-recognition" title="Permanent link">&para;</a></h2>
<p>ëª¨ë“  í† í° íŒ¨í„´ì— ëŒ€í•œ DFAê°€ ì¤€ë¹„ë˜ì—ˆì„ ë•Œ, ë ‰ì„œëŠ” ì–´ë–¤ í† í°ì„ ë°˜í™˜í• ì§€ë¥¼ ì–´ë–»ê²Œ ê²°ì •í• ê¹Œìš”?</p>
<h3 id="longest-match-rule">ìµœì¥ ì¼ì¹˜ ê·œì¹™(Longest Match Rule)<a class="header-link" href="#longest-match-rule" title="Permanent link">&para;</a></h3>
<p>ë ‰ì„œëŠ” í•­ìƒ í˜„ì¬ ìœ„ì¹˜ì—ì„œ <strong>ê°€ëŠ¥í•œ ê°€ì¥ ê¸´ í† í°</strong>ì„ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="nt">Input</span><span class="o">:</span><span class="w">  </span><span class="s2">&quot;iffy = 10;&quot;</span>

<span class="nt">ìµœì¥</span><span class="w"> </span><span class="nt">ì¼ì¹˜</span><span class="w"> </span><span class="nt">ì—†ì´</span><span class="o">:</span><span class="w">  </span><span class="nt">KW_IF</span><span class="o">(</span><span class="s2">&quot;if&quot;</span><span class="o">)</span><span class="w"> </span><span class="nt">ID</span><span class="o">(</span><span class="s2">&quot;fy&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">...</span><span class="w">   </span><span class="nt">ì˜ëª»ë¨</span><span class="o">!</span>
<span class="nt">ìµœì¥</span><span class="w"> </span><span class="nt">ì¼ì¹˜</span><span class="w"> </span><span class="nt">ì ìš©</span><span class="o">:</span><span class="w">  </span><span class="nt">ID</span><span class="o">(</span><span class="s2">&quot;iffy&quot;</span><span class="o">)</span><span class="w"> </span><span class="nt">ASSIGN</span><span class="o">(</span><span class="s2">&quot;=&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">...</span><span class="w">  </span><span class="nt">ì˜¬ë°”ë¦„</span><span class="o">!</span>
</code></pre></div>

<h3 id="priority-rule">ìš°ì„ ìˆœìœ„ ê·œì¹™(Priority Rule)<a class="header-link" href="#priority-rule" title="Permanent link">&para;</a></h3>
<p>ë‘ íŒ¨í„´ì´ ë™ì¼í•œ ìµœì¥ ì–´íœ˜ì†Œì™€ ì¼ì¹˜í•  ë•Œ, <strong>ë¨¼ì € ë‚˜ì—´ëœ</strong>(ìš°ì„ ìˆœìœ„ ë†’ì€) ê²ƒì´ ì„ íƒë©ë‹ˆë‹¤. í‚¤ì›Œë“œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì‹ë³„ìë³´ë‹¤ ë¨¼ì € ë‚˜ì—´ë©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>Input:  &quot;if&quot;

íŒ¨í„´ ìˆœì„œ:
  1. KW_IF:   &quot;if&quot;       &lt;--- ì´ê¸´ë‹¤ (ë†’ì€ ìš°ì„ ìˆœìœ„)
  2. ID:      [a-z]+     &lt;--- &quot;if&quot;ì™€ë„ ì¼ì¹˜
</code></pre></div>

<h3 id="dfa-combined-dfa-approach">ê²°í•© DFA ë°©ì‹(Combined DFA Approach)<a class="header-link" href="#dfa-combined-dfa-approach" title="Permanent link">&para;</a></h3>
<p>ì‹¤ì œë¡œëŠ” ëª¨ë“  í† í° íŒ¨í„´ DFAë¥¼ í•˜ë‚˜ì˜ DFAë¡œ ê²°í•©í•©ë‹ˆë‹¤:</p>
<ol>
<li>ê° í† í° íŒ¨í„´ì— ëŒ€í•´ NFAë¥¼ ë§Œë“¤ê³ , ìˆ˜ë½ ìƒíƒœì— í† í° íƒ€ì…ì„ í‘œì‹œí•©ë‹ˆë‹¤.</li>
<li>ìƒˆ ì‹œì‘ ìƒíƒœì™€ ê° íŒ¨í„´ NFAë¡œì˜ ì—¡ì‹¤ë¡  ì „ì´ë¥¼ ê°€ì§„ ê²°í•© NFAë¥¼ ë§Œë“­ë‹ˆë‹¤.</li>
<li>ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•ìœ¼ë¡œ DFAë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
<li>DFA ìƒíƒœê°€ ì—¬ëŸ¬ íŒ¨í„´ì˜ ìˆ˜ë½ ìƒíƒœë¥¼ í¬í•¨í•  ë•Œ, ê°€ì¥ ë†’ì€ ìš°ì„ ìˆœìœ„ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="w">            </span><span class="err">Îµ</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">NFA</span><span class="p">(</span><span class="n">KW_IF</span><span class="p">)</span>
<span class="w">           </span><span class="o">/</span>
<span class="w">  </span><span class="n">start</span><span class="w"> </span><span class="o">--</span><span class="err">Îµ</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">NFA</span><span class="p">(</span><span class="n">KW_WHILE</span><span class="p">)</span>
<span class="w">           </span><span class="err">\</span>
<span class="w">            </span><span class="err">Îµ</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">NFA</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<span class="w">                   </span><span class="p">...</span>
</code></pre></div>

<h3 id="_15">ìµœì¥ ì¼ì¹˜ êµ¬í˜„<a class="header-link" href="#_15" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">longest_match</span><span class="p">(</span><span class="n">dfa</span><span class="p">:</span> <span class="n">DFA</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the longest match starting at pos.</span>
<span class="sd">    Returns (token_type, length) or (None, 0) if no match.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">dfa</span><span class="o">.</span><span class="n">start</span>
    <span class="n">last_accept</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">last_accept_pos</span> <span class="o">=</span> <span class="n">pos</span>
    <span class="n">current_pos</span> <span class="o">=</span> <span class="n">pos</span>

    <span class="k">while</span> <span class="n">current_pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">current_pos</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span>
        <span class="n">current_pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">is_accept</span><span class="p">:</span>
            <span class="n">last_accept</span> <span class="o">=</span> <span class="n">state</span>  <span class="c1"># Remember this accept position</span>
            <span class="n">last_accept_pos</span> <span class="o">=</span> <span class="n">current_pos</span>

    <span class="k">if</span> <span class="n">last_accept</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">last_accept</span><span class="p">,</span> <span class="n">last_accept_pos</span> <span class="o">-</span> <span class="n">pos</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<h3 id="error-recovery">ë ‰ì„œì˜ ì˜¤ë¥˜ ë³µêµ¬(Error Recovery)<a class="header-link" href="#error-recovery" title="Permanent link">&para;</a></h3>
<p>ë ‰ì„œê°€ ì–´ë–¤ í† í° íŒ¨í„´ê³¼ë„ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë¬¸ìë¥¼ ë§Œë‚˜ë©´ ì—¬ëŸ¬ ì„ íƒì§€ê°€ ìˆìŠµë‹ˆë‹¤:</p>
<ol>
<li><strong>íŒ¨ë‹‰ ëª¨ë“œ(Panic Mode)</strong>: ë¬¸ì œê°€ ë˜ëŠ” ë¬¸ìë¥¼ ê±´ë„ˆë›°ê³  ì˜¤ë¥˜ë¥¼ ë³´ê³ </li>
<li><strong>ì‚½ì…(Insert)</strong>: ë¹ ì§„ ë¬¸ìë¥¼ ì‚½ì… (ë“œë¬¾)</li>
<li><strong>ì‚­ì œ(Delete)</strong>: ë¬¸ì œê°€ ë˜ëŠ” ë¬¸ìë¥¼ ì‚­ì œ</li>
<li><strong>êµì²´(Replace)</strong>: ë¬¸ì œê°€ ë˜ëŠ” ë¬¸ìë¥¼ ìœ íš¨í•œ ë¬¸ìë¡œ êµì²´</li>
</ol>
<p>ëŒ€ë¶€ë¶„ì˜ ì»´íŒŒì¼ëŸ¬ëŠ” íŒ¨ë‹‰ ëª¨ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤: ì˜¤ë¥˜ë¥¼ ë³´ê³ í•˜ê³  í•œ ë¬¸ìë¥¼ ê±´ë„ˆëœë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_with_recovery</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scan with panic-mode error recovery.&quot;&quot;&quot;</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">line</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="c1"># Skip whitespace</span>
        <span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\t\r</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">line</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="c1"># Try to match a token</span>
        <span class="n">best_match</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">best_type</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">token_type</span><span class="p">,</span> <span class="n">pattern_dfa</span> <span class="ow">in</span> <span class="n">token_patterns</span><span class="p">:</span>
            <span class="n">match_state</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">longest_match</span><span class="p">(</span><span class="n">pattern_dfa</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="n">best_length</span><span class="p">:</span>
                <span class="n">best_match</span> <span class="o">=</span> <span class="n">match_state</span>
                <span class="n">best_length</span> <span class="o">=</span> <span class="n">length</span>
                <span class="n">best_type</span> <span class="o">=</span> <span class="n">token_type</span>

        <span class="k">if</span> <span class="n">best_match</span><span class="p">:</span>
            <span class="n">lexeme</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span> <span class="o">+</span> <span class="n">best_length</span><span class="p">]</span>
            <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Token</span><span class="p">(</span><span class="n">best_type</span><span class="p">,</span> <span class="n">lexeme</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">))</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="n">best_length</span>
            <span class="n">col</span> <span class="o">+=</span> <span class="n">best_length</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Error recovery: skip one character</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lexical error at line </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">, col </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;unexpected character &#39;</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">tokens</span>
</code></pre></div>

<hr />
<h2 id="8">8. ì™„ì „í•œ ë ‰ì„œ êµ¬í˜„<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<p>ë‹¤ìŒì€ ì•ì„œ ë‹¤ë£¬ ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ì²˜ìŒë¶€í„° ë§Œë“  C ìœ ì‚¬ ì–¸ì–´(C-like Language)ìš© ì™„ì „í•œ ìì¡±í˜• ë ‰ì„œì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Complete lexer for a simple C-like language.</span>
<span class="sd">Uses a table-driven approach with longest-match and priority rules.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TT</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Token types.&quot;&quot;&quot;</span>
    <span class="c1"># Keywords (listed first for priority)</span>
    <span class="n">KW_IF</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_ELSE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_WHILE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_FOR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_RETURN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_INT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_FLOAT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_VOID</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_CHAR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_BREAK</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">KW_CONTINUE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1"># Literals</span>
    <span class="n">FLOAT_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">INT_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">STRING_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">CHAR_LIT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1"># Identifiers</span>
    <span class="n">IDENT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1"># Multi-character operators (before single-char ones for longest match)</span>
    <span class="n">LEQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># &lt;=</span>
    <span class="n">GEQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># &gt;=</span>
    <span class="n">EQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># ==</span>
    <span class="n">NEQ</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># !=</span>
    <span class="n">AND</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># &amp;&amp;</span>
    <span class="n">OR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># ||</span>
    <span class="n">ARROW</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>      <span class="c1"># -&gt;</span>
    <span class="n">INC</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># ++</span>
    <span class="n">DEC</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># --</span>
    <span class="n">PLUS_ASSIGN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>   <span class="c1"># +=</span>
    <span class="n">MINUS_ASSIGN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># -=</span>
    <span class="n">STAR_ASSIGN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>   <span class="c1"># *=</span>
    <span class="n">SLASH_ASSIGN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># /=</span>

    <span class="c1"># Single-character operators and delimiters</span>
    <span class="n">PLUS</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>       <span class="c1"># +</span>
    <span class="n">MINUS</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>      <span class="c1"># -</span>
    <span class="n">STAR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>       <span class="c1"># *</span>
    <span class="n">SLASH</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>      <span class="c1"># /</span>
    <span class="n">PERCENT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>    <span class="c1"># %</span>
    <span class="n">ASSIGN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># =</span>
    <span class="n">LT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># &lt;</span>
    <span class="n">GT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>         <span class="c1"># &gt;</span>
    <span class="n">NOT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># !</span>
    <span class="n">AMP</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># &amp;</span>
    <span class="n">PIPE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>       <span class="c1"># |</span>
    <span class="n">LPAREN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># (</span>
    <span class="n">RPAREN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># )</span>
    <span class="n">LBRACE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># {</span>
    <span class="n">RBRACE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>     <span class="c1"># }</span>
    <span class="n">LBRACKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>   <span class="c1"># [</span>
    <span class="n">RBRACKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>   <span class="c1"># ]</span>
    <span class="n">COMMA</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>      <span class="c1"># ,</span>
    <span class="n">SEMI</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>       <span class="c1"># ;</span>
    <span class="n">DOT</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>        <span class="c1"># .</span>

    <span class="c1"># Special</span>
    <span class="n">EOF</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Token</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">TT</span>
    <span class="n">lexeme</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;, value=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">!r}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Token(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lexeme</span><span class="si">!r}{</span><span class="n">val</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="si">}</span><span class="s2">)&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LexerError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column</span> <span class="o">=</span> <span class="n">column</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Lexer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A complete lexer for a C-like language.</span>

<span class="sd">    Uses a hand-written state machine approach for correctness</span>
<span class="sd">    and efficiency. Implements longest-match and keyword priority.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">KEYWORDS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;if&#39;</span><span class="p">:</span>       <span class="n">TT</span><span class="o">.</span><span class="n">KW_IF</span><span class="p">,</span>
        <span class="s1">&#39;else&#39;</span><span class="p">:</span>     <span class="n">TT</span><span class="o">.</span><span class="n">KW_ELSE</span><span class="p">,</span>
        <span class="s1">&#39;while&#39;</span><span class="p">:</span>    <span class="n">TT</span><span class="o">.</span><span class="n">KW_WHILE</span><span class="p">,</span>
        <span class="s1">&#39;for&#39;</span><span class="p">:</span>      <span class="n">TT</span><span class="o">.</span><span class="n">KW_FOR</span><span class="p">,</span>
        <span class="s1">&#39;return&#39;</span><span class="p">:</span>   <span class="n">TT</span><span class="o">.</span><span class="n">KW_RETURN</span><span class="p">,</span>
        <span class="s1">&#39;int&#39;</span><span class="p">:</span>      <span class="n">TT</span><span class="o">.</span><span class="n">KW_INT</span><span class="p">,</span>
        <span class="s1">&#39;float&#39;</span><span class="p">:</span>    <span class="n">TT</span><span class="o">.</span><span class="n">KW_FLOAT</span><span class="p">,</span>
        <span class="s1">&#39;void&#39;</span><span class="p">:</span>     <span class="n">TT</span><span class="o">.</span><span class="n">KW_VOID</span><span class="p">,</span>
        <span class="s1">&#39;char&#39;</span><span class="p">:</span>     <span class="n">TT</span><span class="o">.</span><span class="n">KW_CHAR</span><span class="p">,</span>
        <span class="s1">&#39;break&#39;</span><span class="p">:</span>    <span class="n">TT</span><span class="o">.</span><span class="n">KW_BREAK</span><span class="p">,</span>
        <span class="s1">&#39;continue&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">KW_CONTINUE</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">TWO_CHAR_OPS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;&lt;=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">LEQ</span><span class="p">,</span>
        <span class="s1">&#39;&gt;=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">GEQ</span><span class="p">,</span>
        <span class="s1">&#39;==&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">EQ</span><span class="p">,</span>
        <span class="s1">&#39;!=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">NEQ</span><span class="p">,</span>
        <span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">AND</span><span class="p">,</span>
        <span class="s1">&#39;||&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">OR</span><span class="p">,</span>
        <span class="s1">&#39;-&gt;&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">ARROW</span><span class="p">,</span>
        <span class="s1">&#39;++&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">INC</span><span class="p">,</span>
        <span class="s1">&#39;--&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">DEC</span><span class="p">,</span>
        <span class="s1">&#39;+=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">PLUS_ASSIGN</span><span class="p">,</span>
        <span class="s1">&#39;-=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">MINUS_ASSIGN</span><span class="p">,</span>
        <span class="s1">&#39;*=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">STAR_ASSIGN</span><span class="p">,</span>
        <span class="s1">&#39;/=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">SLASH_ASSIGN</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">SINGLE_CHAR_OPS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;+&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span>
        <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">MINUS</span><span class="p">,</span>
        <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">STAR</span><span class="p">,</span>
        <span class="s1">&#39;/&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">SLASH</span><span class="p">,</span>
        <span class="s1">&#39;%&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">PERCENT</span><span class="p">,</span>
        <span class="s1">&#39;=&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">ASSIGN</span><span class="p">,</span>
        <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">LT</span><span class="p">,</span>
        <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">GT</span><span class="p">,</span>
        <span class="s1">&#39;!&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">NOT</span><span class="p">,</span>
        <span class="s1">&#39;&amp;&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">AMP</span><span class="p">,</span>
        <span class="s1">&#39;|&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="s1">&#39;(&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">LPAREN</span><span class="p">,</span>
        <span class="s1">&#39;)&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">RPAREN</span><span class="p">,</span>
        <span class="s1">&#39;{&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">LBRACE</span><span class="p">,</span>
        <span class="s1">&#39;}&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">RBRACE</span><span class="p">,</span>
        <span class="s1">&#39;[&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">LBRACKET</span><span class="p">,</span>
        <span class="s1">&#39;]&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">RBRACKET</span><span class="p">,</span>
        <span class="s1">&#39;,&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">COMMA</span><span class="p">,</span>
        <span class="s1">&#39;;&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">SEMI</span><span class="p">,</span>
        <span class="s1">&#39;.&#39;</span><span class="p">:</span> <span class="n">TT</span><span class="o">.</span><span class="n">DOT</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&lt;input&gt;&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Look at the character at current position + offset.&quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">advance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Consume and return the current character.&quot;&quot;&quot;</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">column</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">column</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ch</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token_type</span><span class="p">:</span> <span class="n">TT</span><span class="p">,</span> <span class="n">lexeme</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                   <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">token_type</span><span class="p">,</span> <span class="n">lexeme</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">skip_whitespace_and_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Skip whitespace, single-line comments, and multi-line comments.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>

            <span class="c1"># Whitespace</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\t\r\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
                <span class="k">continue</span>

            <span class="c1"># Single-line comment: //</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip /</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip /</span>
                <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
                <span class="k">continue</span>

            <span class="c1"># Multi-line comment: /* ... */</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
                <span class="n">start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
                <span class="n">start_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip /</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip *</span>
                <span class="n">depth</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
                        <span class="n">depth</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
                        <span class="n">depth</span> <span class="o">-=</span> <span class="mi">1</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_col</span><span class="si">}</span><span class="s2">: &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;unterminated comment&quot;</span>
                    <span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">break</span>  <span class="c1"># Not whitespace or comment</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scan_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scan an integer or float literal.&quot;&quot;&quot;</span>
        <span class="n">start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="n">start_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span>
        <span class="n">start_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
        <span class="n">is_float</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Integer part</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>

        <span class="c1"># Fractional part</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="n">is_float</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip &#39;.&#39;</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>

        <span class="c1"># Exponent part</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span>
            <span class="n">is_float</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip &#39;e&#39;/&#39;E&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;expected digit in exponent&quot;</span>
                <span class="p">)</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>

        <span class="n">lexeme</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="n">start_pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">is_float</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">FLOAT_LIT</span><span class="p">,</span> <span class="n">lexeme</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">lexeme</span><span class="p">),</span>
                                   <span class="n">start_line</span><span class="p">,</span> <span class="n">start_col</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">INT_LIT</span><span class="p">,</span> <span class="n">lexeme</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">lexeme</span><span class="p">),</span>
                                   <span class="n">start_line</span><span class="p">,</span> <span class="n">start_col</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scan_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scan a string literal (double-quoted).&quot;&quot;&quot;</span>
        <span class="n">start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="n">start_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip opening &quot;</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;unterminated string literal&quot;</span>
                <span class="p">)</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip backslash</span>
                <span class="n">esc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                <span class="n">escape_map</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">escape_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">esc</span><span class="p">,</span> <span class="n">esc</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip closing &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_col</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;unterminated string literal&quot;</span>
            <span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
        <span class="n">lexeme</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span>
            <span class="p">(</span><span class="n">start_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_line</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">STRING_LIT</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
                               <span class="n">start_line</span><span class="p">,</span> <span class="n">start_col</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scan_char</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scan a character literal (single-quoted).&quot;&quot;&quot;</span>
        <span class="n">start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="n">start_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip opening &#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
            <span class="n">esc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">escape_map</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">escape_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">esc</span><span class="p">,</span> <span class="n">esc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_col</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;empty character literal&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>  <span class="c1"># skip closing &#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_col</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;unterminated character literal&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">CHAR_LIT</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
                               <span class="n">start_line</span><span class="p">,</span> <span class="n">start_col</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scan_identifier_or_keyword</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scan an identifier or keyword.&quot;&quot;&quot;</span>
        <span class="n">start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="n">start_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span>
        <span class="n">start_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>

        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span>
               <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>

        <span class="n">lexeme</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="n">start_pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>

        <span class="c1"># Check if it&#39;s a keyword</span>
        <span class="k">if</span> <span class="n">lexeme</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">KEYWORDS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KEYWORDS</span><span class="p">[</span><span class="n">lexeme</span><span class="p">],</span> <span class="n">lexeme</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="n">start_line</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">start_col</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">IDENT</span><span class="p">,</span> <span class="n">lexeme</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="n">start_line</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">start_col</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">next_token</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the next token from the source.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_whitespace_and_comments</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">EOF</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>

        <span class="n">start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="n">start_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>

        <span class="c1"># Numbers</span>
        <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_number</span><span class="p">()</span>

        <span class="c1"># Identifiers and keywords</span>
        <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">or</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_identifier_or_keyword</span><span class="p">()</span>

        <span class="c1"># String literals</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_string</span><span class="p">()</span>

        <span class="c1"># Character literals</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_char</span><span class="p">()</span>

        <span class="c1"># Two-character operators (check before single-char)</span>
        <span class="n">two_char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">two_char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TWO_CHAR_OPS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TWO_CHAR_OPS</span><span class="p">[</span><span class="n">two_char</span><span class="p">],</span> <span class="n">two_char</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="n">start_line</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">start_col</span><span class="p">)</span>

        <span class="c1"># Single-character operators and delimiters</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SINGLE_CHAR_OPS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SINGLE_CHAR_OPS</span><span class="p">[</span><span class="n">ch</span><span class="p">],</span> <span class="n">ch</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="n">start_line</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">start_col</span><span class="p">)</span>

        <span class="c1"># Error: unexpected character</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advance</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_line</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">start_col</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;unexpected character &#39;</span><span class="si">{</span><span class="n">ch</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">start_line</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">start_col</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tokenize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tokenize the entire source and return a list of tokens.&quot;&quot;&quot;</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">tok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_token</span><span class="p">()</span>
            <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tok</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">TT</span><span class="o">.</span><span class="n">EOF</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">tokens</span>


<span class="c1"># ============================================================</span>
<span class="c1"># Example usage</span>
<span class="c1"># ============================================================</span>

<span class="n">source_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">// Compute factorial iteratively</span>
<span class="s2">int factorial(int n) {</span>
<span class="s2">    int result = 1;</span>
<span class="s2">    for (int i = 2; i &lt;= n; i++) {</span>
<span class="s2">        result *= i;</span>
<span class="s2">    }</span>
<span class="s2">    return result;</span>
<span class="s2">}</span>

<span class="s2">/* Multi-line</span>
<span class="s2">   comment */</span>
<span class="s2">int main() {</span>
<span class="s2">    int x = factorial(10);</span>
<span class="s2">    float pi = 3.14159;</span>
<span class="s2">    char ch = &#39;A&#39;;</span>
<span class="s2">    char newline = &#39;</span><span class="se">\\</span><span class="s2">n&#39;;</span>

<span class="s2">    if (x &gt;= 3628800 &amp;&amp; pi != 0.0) {</span>
<span class="s2">        return 0;</span>
<span class="s2">    } else {</span>
<span class="s2">        return -1;</span>
<span class="s2">    }</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Complete Lexer Demo ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">lexer</span> <span class="o">=</span> <span class="n">Lexer</span><span class="p">(</span><span class="n">source_code</span><span class="p">,</span> <span class="s2">&quot;example.c&quot;</span><span class="p">)</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">lexer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">()</span>

<span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">tok</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">lexer</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Errors:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">lexer</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tokenization successful: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="si">}</span><span class="s2"> tokens, no errors.&quot;</span><span class="p">)</span>

<span class="c1"># Summary statistics</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="n">type_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">type</span> <span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Token type distribution:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tt</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">type_counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">tt</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s2">20s</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="9-lexer-generator">9. ë ‰ì„œ ìƒì„±ê¸°(Lexer Generator) ëª…ì„¸<a class="header-link" href="#9-lexer-generator" title="Permanent link">&para;</a></h2>
<p>ì§ì ‘ ì‘ì„±í•˜ëŠ” ë ‰ì„œëŠ” ìµœëŒ€í•œì˜ ì œì–´ë¥¼ ì œê³µí•˜ì§€ë§Œ, <strong>ë ‰ì„œ ìƒì„±ê¸°</strong>(Lex, Flex, PLY)ëŠ” í† í° íŒ¨í„´ ëª…ì„¸ë¥¼ ë°›ì•„ ìë™ìœ¼ë¡œ ë ‰ì„œ ì½”ë“œë¥¼ ìƒì„±í•˜ì—¬ ì‘ì—…ì„ ìë™í™”í•©ë‹ˆë‹¤.</p>
<h3 id="lexflex">Lex/Flex ëª…ì„¸ í˜•ì‹<a class="header-link" href="#lexflex" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cm">%{</span>
<span class="cm">/* C declarations */</span>
<span class="cm">#include &quot;parser.tab.h&quot;</span>
<span class="cm">%}</span>

<span class="o">/*</span><span class="w"> </span><span class="n">Definitions</span><span class="w"> </span><span class="o">*/</span>
<span class="n">DIGIT</span><span class="w">   </span><span class="s">[0-9]</span>
<span class="n">LETTER</span><span class="w">  </span><span class="s">[a-zA-Z_]</span>
<span class="n">ID</span><span class="w">      </span><span class="s">{LETTER}({LETTER}|{DIGIT})*</span>

<span class="c">%%</span>
<span class="o">/*</span><span class="w"> </span><span class="n">Rules</span><span class="p">:</span><span class="w"> </span><span class="nb">pattern</span><span class="w">    </span><span class="n">action</span><span class="w"> </span><span class="o">*/</span>
<span class="s">&quot;if&quot;</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">KW_IF</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;else&quot;</span><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">KW_ELSE</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;while&quot;</span><span class="w">         </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">KW_WHILE</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;return&quot;</span><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">KW_RETURN</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;int&quot;</span><span class="w">           </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">KW_INT</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;float&quot;</span><span class="w">         </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">KW_FLOAT</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="p">{</span><span class="n">DIGIT</span><span class="p">}</span><span class="o">+</span><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">yylval</span><span class="p">.</span><span class="n">ival</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">yytext</span><span class="p">);</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">INT_LIT</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="n">DIGIT</span><span class="p">}</span><span class="o">+</span><span class="s">&quot;.&quot;</span><span class="p">{</span><span class="n">DIGIT</span><span class="p">}</span><span class="o">+</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">yylval</span><span class="p">.</span><span class="n">fval</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">atof</span><span class="p">(</span><span class="n">yytext</span><span class="p">);</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">FLOAT_LIT</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="n">ID</span><span class="p">}</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="n">yylval</span><span class="p">.</span><span class="n">sval</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">strdup</span><span class="p">(</span><span class="n">yytext</span><span class="p">);</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">IDENT</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="s">&quot;&lt;=&quot;</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">LEQ</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;&gt;=&quot;</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">GEQ</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;==&quot;</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">EQ</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;!=&quot;</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">NEQ</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="s">&quot;+&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">PLUS</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;-&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">MINUS</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;*&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">STAR</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;/&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">SLASH</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;=&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ASSIGN</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="s">&quot;(&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">LPAREN</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;)&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RPAREN</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;{&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">LBRACE</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;}&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RBRACE</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;;&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">SEMI</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="s">&quot;,&quot;</span><span class="w">             </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">COMMA</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="s">&quot;//&quot;</span><span class="o">.*</span><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">skip</span><span class="w"> </span><span class="nb">single</span><span class="o">-</span><span class="nb">line</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="p">}</span>
<span class="p">[</span><span class="w"> </span><span class="o">\</span><span class="n">t</span><span class="o">\</span><span class="n">r</span><span class="p">]</span><span class="o">+</span><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">skip</span><span class="w"> </span><span class="n">whitespace</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="p">}</span>
<span class="o">\</span><span class="n">n</span><span class="w">              </span><span class="p">{</span><span class="w"> </span><span class="n">yylineno</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="p">.</span><span class="w">               </span><span class="p">{</span><span class="w"> </span><span class="nb">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unexpected: %s\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yytext</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="c">%%</span>
</code></pre></div>

<h3 id="ply-python-lex-yacc">PLY (Python Lex-Yacc) ëª…ì„¸<a class="header-link" href="#ply-python-lex-yacc" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Token specification using PLY (Python Lex-Yacc).</span>
<span class="sd">Install: pip install ply</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ply.lex</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lex</span>

<span class="c1"># List of token names (required by PLY)</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;IDENT&#39;</span><span class="p">,</span> <span class="s1">&#39;INT_LIT&#39;</span><span class="p">,</span> <span class="s1">&#39;FLOAT_LIT&#39;</span><span class="p">,</span> <span class="s1">&#39;STRING_LIT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PLUS&#39;</span><span class="p">,</span> <span class="s1">&#39;MINUS&#39;</span><span class="p">,</span> <span class="s1">&#39;STAR&#39;</span><span class="p">,</span> <span class="s1">&#39;SLASH&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ASSIGN&#39;</span><span class="p">,</span> <span class="s1">&#39;EQ&#39;</span><span class="p">,</span> <span class="s1">&#39;NEQ&#39;</span><span class="p">,</span> <span class="s1">&#39;LT&#39;</span><span class="p">,</span> <span class="s1">&#39;GT&#39;</span><span class="p">,</span> <span class="s1">&#39;LEQ&#39;</span><span class="p">,</span> <span class="s1">&#39;GEQ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LPAREN&#39;</span><span class="p">,</span> <span class="s1">&#39;RPAREN&#39;</span><span class="p">,</span> <span class="s1">&#39;LBRACE&#39;</span><span class="p">,</span> <span class="s1">&#39;RBRACE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SEMI&#39;</span><span class="p">,</span> <span class="s1">&#39;COMMA&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Reserved words</span>
<span class="n">reserved</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;if&#39;</span><span class="p">:</span>     <span class="s1">&#39;KW_IF&#39;</span><span class="p">,</span>
    <span class="s1">&#39;else&#39;</span><span class="p">:</span>   <span class="s1">&#39;KW_ELSE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;while&#39;</span><span class="p">:</span>  <span class="s1">&#39;KW_WHILE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;for&#39;</span><span class="p">:</span>    <span class="s1">&#39;KW_FOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;KW_RETURN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;int&#39;</span><span class="p">:</span>    <span class="s1">&#39;KW_INT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;float&#39;</span><span class="p">:</span>  <span class="s1">&#39;KW_FLOAT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;void&#39;</span><span class="p">:</span>   <span class="s1">&#39;KW_VOID&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">tokens</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reserved</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="c1"># Simple tokens (single characters)</span>
<span class="n">t_PLUS</span>    <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\+&#39;</span>
<span class="n">t_MINUS</span>   <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;-&#39;</span>
<span class="n">t_STAR</span>    <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\*&#39;</span>
<span class="n">t_SLASH</span>   <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/&#39;</span>
<span class="n">t_ASSIGN</span>  <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;=&#39;</span>
<span class="n">t_LPAREN</span>  <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\(&#39;</span>
<span class="n">t_RPAREN</span>  <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\)&#39;</span>
<span class="n">t_LBRACE</span>  <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\{&#39;</span>
<span class="n">t_RBRACE</span>  <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\}&#39;</span>
<span class="n">t_SEMI</span>    <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;;&#39;</span>
<span class="n">t_COMMA</span>   <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;,&#39;</span>

<span class="c1"># Multi-character operators (functions, checked before simple tokens)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_LEQ</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;&lt;=&#39;</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_GEQ</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;&gt;=&#39;</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_EQ</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;==&#39;</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_NEQ</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;!=&#39;</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_LT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;&lt;&#39;</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_GT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;&gt;&#39;</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="c1"># Float literal (must be before INT_LIT)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_FLOAT_LIT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;\d+\.\d+([eE][+-]?\d+)?&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="c1"># Integer literal</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_INT_LIT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;\d+&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="c1"># String literal</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_STRING_LIT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;&quot;[^&quot;</span><span class="se">\\</span><span class="s1">]*(</span><span class="se">\\</span><span class="s1">.[^&quot;</span><span class="se">\\</span><span class="s1">]*)*&quot;&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Strip quotes</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="c1"># Identifier (and keyword check)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_IDENT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;[a-zA-Z_][a-zA-Z0-9_]*&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">reserved</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;IDENT&#39;</span><span class="p">)</span>  <span class="c1"># Check for keywords</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="c1"># Track line numbers</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_newline</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;\n+&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">lexer</span><span class="o">.</span><span class="n">lineno</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># Ignored characters (whitespace)</span>
<span class="n">t_ignore</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="se">\t\r</span><span class="s1">&#39;</span>

<span class="c1"># Comments</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_COMMENT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;//[^\n]*&#39;</span>
    <span class="k">pass</span>  <span class="c1"># Discard</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_BLOCK_COMMENT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;/\*[\s\S]*?\*/&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">lexer</span><span class="o">.</span><span class="n">lineno</span> <span class="o">+=</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Error handling</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t_error</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Illegal character &#39;</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; at line </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">lexer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Build the lexer</span>
<span class="n">lexer</span> <span class="o">=</span> <span class="n">lex</span><span class="o">.</span><span class="n">lex</span><span class="p">()</span>

<span class="c1"># Test it</span>
<span class="n">lexer</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;int x = 42 + y * 3.14;&quot;</span><span class="p">)</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">tok</span> <span class="o">=</span> <span class="n">lexer</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tok</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="10">10. íŠ¹ìˆ˜ ì‚¬ë¡€ ì²˜ë¦¬<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="_16">ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ê°€ í¬í•¨ëœ ë¬¸ìì—´ ë¦¬í„°ëŸ´<a class="header-link" href="#_16" title="Permanent link">&para;</a></h3>
<p>ë¬¸ìì—´ ìŠ¤ìº”ì€ ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ ì²˜ë¦¬ê°€ í•„ìš”í•˜ì—¬ íŒ¨í„´ì´ ë¬¸ì ìˆ˜ì¤€ì—ì„œ ë¬¸ë§¥ ì˜ì¡´ì ì´ ë©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_string_literal</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scan a string literal starting at pos (which should be &#39;&quot;&#39;).</span>
<span class="sd">    Returns (raw_lexeme, processed_value, new_pos).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">pos</span>
    <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># skip opening quote</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">ESCAPE_MAP</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\a</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\f</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\v</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># skip closing quote</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">),</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">LexerError</span><span class="p">(</span><span class="s2">&quot;Unterminated escape in string&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">esc</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">esc</span> <span class="ow">in</span> <span class="n">ESCAPE_MAP</span><span class="p">:</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ESCAPE_MAP</span><span class="p">[</span><span class="n">esc</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">esc</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="c1"># Hex escape: \xNN</span>
                <span class="n">hex_str</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hex_str</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">esc</span> <span class="o">==</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span>
                <span class="c1"># Unicode escape: \uNNNN</span>
                <span class="n">hex_str</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hex_str</span><span class="p">,</span> <span class="mi">16</span><span class="p">)))</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">4</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esc</span><span class="p">)</span>  <span class="c1"># Unknown escape, keep literal</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LexerError</span><span class="p">(</span><span class="s2">&quot;Unterminated string (newline)&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">raise</span> <span class="n">LexerError</span><span class="p">(</span><span class="s2">&quot;Unterminated string (EOF)&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<h3 id="multi-line-strings">ì—¬ëŸ¬ ì¤„ ë¬¸ìì—´(Multi-Line Strings)<a class="header-link" href="#multi-line-strings" title="Permanent link">&para;</a></h3>
<p>ì¼ë¶€ ì–¸ì–´ëŠ” ì—¬ëŸ¬ ì¤„ ë¬¸ìì—´ì„ ì§€ì›í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_multiline_string</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scan a triple-quoted string (Python-style).&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&quot;&quot;&quot;&#39;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">pos</span>
    <span class="n">pos</span> <span class="o">+=</span> <span class="mi">3</span>  <span class="c1"># skip opening &quot;&quot;&quot;</span>

    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&quot;&quot;&quot;&#39;</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">3</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># strip quotes</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">raise</span> <span class="n">LexerError</span><span class="p">(</span><span class="s2">&quot;Unterminated multi-line string&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<h3 id="nested-comments">ì¤‘ì²© ì£¼ì„(Nested Comments)<a class="header-link" href="#nested-comments" title="Permanent link">&para;</a></h3>
<p>ì¼ë¶€ ì–¸ì–´(Haskell, Swift, Rust)ëŠ” ì¤‘ì²© ì£¼ì„ì„ ì§€ì›í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">skip_nested_comment</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Skip a nested block comment /* ... /* ... */ ... */&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;/*&#39;</span>
    <span class="n">pos</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;/*&#39;</span><span class="p">:</span>
            <span class="n">depth</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">source</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;*/&#39;</span><span class="p">:</span>
            <span class="n">depth</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">LexerError</span><span class="p">(</span><span class="s2">&quot;Unterminated nested comment&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pos</span>
</code></pre></div>

<h3 id="python_3">ì˜ë¯¸ ìˆëŠ” ê³µë°± (Python ìŠ¤íƒ€ì¼ ë“¤ì—¬ì“°ê¸°)<a class="header-link" href="#python_3" title="Permanent link">&para;</a></h3>
<p>Pythonì˜ ë ‰ì„œëŠ” ê³µë°± ë³€í™”ë¥¼ ê¸°ë°˜ìœ¼ë¡œ <code>INDENT</code>ì™€ <code>DEDENT</code> í† í°ì„ ìƒì„±í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tokenize_with_indentation</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tokenize with Python-style indentation handling.</span>
<span class="sd">    Generates INDENT and DEDENT tokens.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">indent_stack</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Stack of indentation levels</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">line_no</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Skip blank lines</span>
        <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stripped</span> <span class="ow">or</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="c1"># Calculate indentation level</span>
        <span class="n">indent</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripped</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">indent</span> <span class="o">&gt;</span> <span class="n">indent_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">indent_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indent</span><span class="p">)</span>
            <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">IDENT</span><span class="p">,</span> <span class="s2">&quot;&lt;INDENT&gt;&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line_no</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">indent</span> <span class="o">&lt;</span> <span class="n">indent_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">indent_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">IDENT</span><span class="p">,</span> <span class="s2">&quot;&lt;DEDENT&gt;&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line_no</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">indent</span> <span class="o">!=</span> <span class="n">indent_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="n">LexerError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Inconsistent indentation at line </span><span class="si">{</span><span class="n">line_no</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">line_no</span><span class="p">,</span> <span class="mi">1</span>
                <span class="p">)</span>

        <span class="c1"># Tokenize the rest of the line normally</span>
        <span class="c1"># (omitted for brevity -- use the main lexer)</span>

    <span class="c1"># Emit remaining DEDENTs</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">indent_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">indent_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Token</span><span class="p">(</span><span class="n">TT</span><span class="o">.</span><span class="n">IDENT</span><span class="p">,</span> <span class="s2">&quot;&lt;DEDENT&gt;&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">tokens</span>
</code></pre></div>

<hr />
<h2 id="11">11. ì„±ëŠ¥ ê³ ë ¤ ì‚¬í•­<a class="header-link" href="#11" title="Permanent link">&para;</a></h2>
<h3 id="table-driven-vs-direct-coded">í…Œì´ë¸” êµ¬ë™(Table-Driven) vs. ì§ì ‘ ì½”ë”©(Direct-Coded) ë ‰ì„œ<a class="header-link" href="#table-driven-vs-direct-coded" title="Permanent link">&para;</a></h3>
<p><strong>í…Œì´ë¸” êµ¬ë™</strong> (Lex/Flexë¡œ ìƒì„±):
- ì „ì´ í…Œì´ë¸”ì„ 2ì°¨ì› ë°°ì—´ë¡œ ì €ì¥: <code>next_state = table[state][char]</code>
- ê°„ê²°í•˜ê³  ìƒì„±í•˜ê¸° ì‰¬ì›€
- ë¬¸ìë§ˆë‹¤ ê°„ì ‘ ë©”ëª¨ë¦¬ ì ‘ê·¼ ë°œìƒ</p>
<p><strong>ì§ì ‘ ì½”ë”©</strong> (ìˆ˜ë™ ì‘ì„± ë˜ëŠ” re2c):
- ì „ì´ë¥¼ <code>switch</code> ë¬¸ ë˜ëŠ” <code>goto</code> ì²´ì¸ìœ¼ë¡œ ì¸ì½”ë”©
- ë” ë¹ ë¦„: ë¶„ê¸° ì˜ˆì¸¡ì´ ë” ì˜ ì‘ë™í•˜ê³ , í…Œì´ë¸” ì¡°íšŒ ì—†ìŒ
- ì½”ë“œ í¬ê¸°ê°€ ë” í¼</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Table-driven (simplified)</span>
<span class="kt">int</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">input</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">c</span><span class="p">];</span><span class="w">  </span><span class="c1">// indirect lookup</span>
<span class="p">}</span>

<span class="c1">// Direct-coded</span>
<span class="nl">s0</span><span class="p">:</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">input</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;z&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="n">s1</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;9&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="n">s2</span><span class="p">;</span>
<span class="w">    </span><span class="k">goto</span><span class="w"> </span><span class="n">error</span><span class="p">;</span>
<span class="nl">s1</span><span class="p">:</span>
<span class="w">    </span><span class="p">...</span>
</code></pre></div>

<p><strong>re2c</strong>ëŠ” ì§ì ‘ ì½”ë”© ë ‰ì„œë¥¼ ìƒì„±í•˜ë©°, ì¼ë°˜ì ìœ¼ë¡œ Flexë³´ë‹¤ 2~3ë°° ë¹ ë¦…ë‹ˆë‹¤.</p>
<h3 id="buffer-management">ë²„í¼ ê´€ë¦¬(Buffer Management)<a class="header-link" href="#buffer-management" title="Permanent link">&para;</a></h3>
<p>íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ë¬¸ìë¥¼ í•œ ë²ˆì— í•˜ë‚˜ì”© ì½ëŠ” ê²ƒì€ ëŠë¦½ë‹ˆë‹¤. ë ‰ì„œëŠ” <strong>ì´ì¤‘ ë²„í¼ë§(Double Buffering)</strong>ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="nb">+-----------------------------------+-----------------------------------+</span>
<span class="c">| Buffer 1 (4096 bytes)             | Buffer 2 (4096 bytes)             |</span>
<span class="nb">+-----------------------------------+-----------------------------------+</span>
<span class="c">                    ^                                    ^</span>
<span class="c">                lexeme_begin                          forward</span>

<span class="c">When forward reaches the end of Buffer 1</span><span class="nt">,</span><span class="c"> load next block into Buffer 2</span><span class="nt">.</span>
<span class="c">When forward reaches the end of Buffer 2</span><span class="nt">,</span><span class="c"> load next block into Buffer 1</span><span class="nt">.</span>
</code></pre></div>

<p>ì´ë¥¼ <strong>ì„¼í‹°ë„¬(Sentinel)</strong> ê¸°ë²•ì´ë¼ í•©ë‹ˆë‹¤: ê° ë²„í¼ ëì— íŠ¹ìˆ˜ EOF ë¬¸ìë¥¼ ë°°ì¹˜í•˜ì—¬ ë¬¸ìë§ˆë‹¤ ê²½ê³„ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.</p>
<hr />
<h2 id="_17">ìš”ì•½<a class="header-link" href="#_17" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>ë ‰ì„œ</strong>ëŠ” ì»´íŒŒì¼ì˜ ì²« ë²ˆì§¸ ë‹¨ê³„ë¡œ, ë¬¸ìë¥¼ í† í°ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
<li><strong>í† í°</strong>ì€ íƒ€ì…ê³¼ ì„ íƒì  ì†ì„± ê°’ì„ ê°€ì§€ë©°, <strong>ì–´íœ˜ì†Œ(Lexeme)</strong>ëŠ” ì‹¤ì œ í…ìŠ¤íŠ¸, <strong>íŒ¨í„´(Pattern)</strong>ì€ ê·œì¹™ì…ë‹ˆë‹¤.</li>
<li>í† í° íŒ¨í„´ì€ í•©ì§‘í•©, ì—°ì ‘, í´ë¦¬ë‹ˆ ìŠ¤íƒ€ë¥¼ ì§€ì›í•˜ëŠ” <strong>ì •ê·œ í‘œí˜„ì‹</strong>ìœ¼ë¡œ ëª…ì„¸ë©ë‹ˆë‹¤.</li>
<li><strong>í†°ìŠ¨ êµ¬ì„±ë²•</strong>ì€ ì •ê·œ í‘œí˜„ì‹ì„ $O(n)$ ì‹œê°„ê³¼ ê³µê°„ìœ¼ë¡œ NFAë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
<li><strong>ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•</strong>ì€ NFAë¥¼ DFAë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ìµœì•…ì˜ ê²½ìš° $2^n$ê°œì˜ ìƒíƒœì´ì§€ë§Œ ì‹¤ì œë¡œëŠ” í›¨ì”¬ ì ìŠµë‹ˆë‹¤.</li>
<li><strong>í™‰í¬ë¡œí”„íŠ¸ ì•Œê³ ë¦¬ì¦˜</strong>ì€ $O(n \log n)$ ì‹œê°„ìœ¼ë¡œ DFAë¥¼ ìµœì†Œí™”í•©ë‹ˆë‹¤.</li>
<li><strong>ìµœì¥ ì¼ì¹˜ ê·œì¹™</strong>ì€ ë ‰ì„œê°€ í•­ìƒ ê°€ëŠ¥í•œ ê°€ì¥ ê¸´ í† í°ì„ ë°˜í™˜í•˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.</li>
<li><strong>ìš°ì„ ìˆœìœ„ ê·œì¹™</strong>ì€ íŒ¨í„´ ê°„ì˜ ë™ì ì„ í•´ê²°í•©ë‹ˆë‹¤(í‚¤ì›Œë“œê°€ ì‹ë³„ìë³´ë‹¤ ìš°ì„ ).</li>
<li>ì§ì ‘ ì‘ì„±í•˜ëŠ” ë ‰ì„œëŠ” ìœ ì—°ì„±ì„ ì œê³µí•˜ê³ , ë ‰ì„œ ìƒì„±ê¸°(Lex, Flex, PLY)ëŠ” í¸ì˜ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.</li>
<li>íŠ¹ìˆ˜ ì‚¬ë¡€ë¡œëŠ” ë¬¸ìì—´ ì´ìŠ¤ì¼€ì´í”„, ì¤‘ì²© ì£¼ì„, ì˜ë¯¸ ìˆëŠ” ê³µë°±ì´ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<hr />
<h2 id="_18">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_18" title="Permanent link">&para;</a></h2>
<h3 id="1">ì—°ìŠµ 1: ì •ê·œ í‘œí˜„ì‹<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ê° í•­ëª©ì— ëŒ€í•œ ì •ê·œ í‘œí˜„ì‹ì„ ì‘ì„±í•˜ì„¸ìš”:</p>
<ol>
<li>0ì˜ ê°œìˆ˜ê°€ ì§ìˆ˜ì¸ ì´ì§„ ë¬¸ìì—´</li>
<li>ë°‘ì¤„(_)ë¡œ ì‹œì‘í•˜ëŠ” C ìŠ¤íƒ€ì¼ ì‹ë³„ì</li>
<li>ì´ë©”ì¼ ì£¼ì†Œ (ê°„ëµí™”: <code>name@domain.tld</code>)</li>
<li>ê³¼í•™ì  í‘œê¸°ë²•ì˜ ë¶€ë™ì†Œìˆ˜ì  ìˆ˜ (ì˜ˆ: <code>1.5e-3</code>, <code>-2.0E+10</code>)</li>
<li>C ìŠ¤íƒ€ì¼ ì£¼ì„: <code>/* ... */</code> (ë¹„ì¤‘ì²©)</li>
</ol>
<h3 id="2">ì—°ìŠµ 2: í†°ìŠ¨ êµ¬ì„±ë²•<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<p>ì •ê·œ í‘œí˜„ì‹ <code>a(b|c)*d</code>ì— í†°ìŠ¨ êµ¬ì„±ë²•ì„ ì ìš©í•˜ì„¸ìš”. NFAë¥¼ ê·¸ë¦¬ê³ (ëª¨ë“  ìƒíƒœì— ë ˆì´ë¸” í‘œì‹œ), ë‹¤ìŒ ì…ë ¥ì— ëŒ€í•´ NFAë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ì„¸ìš”:
- <code>"ad"</code> -- ìˆ˜ë½í•´ì•¼ í•˜ëŠ”ê°€?
- <code>"abcd"</code> -- ìˆ˜ë½í•´ì•¼ í•˜ëŠ”ê°€?
- <code>"abbd"</code> -- ìˆ˜ë½í•´ì•¼ í•˜ëŠ”ê°€?
- <code>"abc"</code> -- ìˆ˜ë½í•´ì•¼ í•˜ëŠ”ê°€?</p>
<h3 id="3">ì—°ìŠµ 3: ë¶€ë¶„ì§‘í•© êµ¬ì„±ë²•<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>ì—°ìŠµ 2ì˜ NFAì— ë¶€ë¶„ì§‘í•© êµ¬ì„± ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•˜ì„¸ìš”. DFA ì „ì´ í…Œì´ë¸”ì„ ì‘ì„±í•˜ê³ , ê²°ê³¼ DFAì˜ ìƒíƒœ ìˆ˜ëŠ” ëª‡ ê°œì¸ì§€ êµ¬í•˜ì„¸ìš”.</p>
<h3 id="4">ì—°ìŠµ 4: ë ‰ì„œ í™•ì¥<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>ì„¹ì…˜ 8ì˜ ì™„ì „í•œ ë ‰ì„œë¥¼ í™•ì¥í•˜ì—¬ ë‹¤ìŒì„ ì²˜ë¦¬í•˜ë„ë¡ ìˆ˜ì •í•˜ì„¸ìš”:
1. 16ì§„ìˆ˜ ì •ìˆ˜ ë¦¬í„°ëŸ´ (ì˜ˆ: <code>0xFF</code>, <code>0x1A3</code>)
2. 8ì§„ìˆ˜ ì •ìˆ˜ ë¦¬í„°ëŸ´ (ì˜ˆ: <code>0o77</code>, <code>0o12</code>)
3. 2ì§„ìˆ˜ ì •ìˆ˜ ë¦¬í„°ëŸ´ (ì˜ˆ: <code>0b1010</code>, <code>0b11001</code>)
4. ê°€ë…ì„±ì„ ìœ„í•œ ìˆ«ì êµ¬ë¶„ì (ì˜ˆ: <code>1_000_000</code>, <code>0xFF_FF</code>)</p>
<h3 id="5">ì—°ìŠµ 5: ì˜¤ë¥˜ ë³µêµ¬<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ê¸°ëŠ¥ì„ ê°–ì¶˜ ì˜¤ë¥˜ ë³µêµ¬ ì „ëµì„ ì„¤ê³„í•˜ê³  êµ¬í˜„í•˜ì„¸ìš”:
1. ë¬¸ìì—´ì´ ì‹œì‘ëœ ì¤„ ë²ˆí˜¸ì™€ í•¨ê»˜ ëë‚˜ì§€ ì•Šì€ ë¬¸ìì—´ ë¦¬í„°ëŸ´ì„ ë³´ê³ 
2. í”í•œ ì˜¤íƒ€ì— ëŒ€í•œ ìˆ˜ì • ì œì•ˆ (ì˜ˆ: <code>retrun</code> -&gt; <code>return</code>)
3. ì—°ì†ëœ ë¶ˆë²• ë¬¸ìë“¤ì„ ê°œë³„ì ìœ¼ë¡œ ë³´ê³ í•˜ì§€ ì•Šê³  í•˜ë‚˜ì˜ ì˜¤ë¥˜ ë©”ì‹œì§€ë¡œ ê·¸ë£¹í™”</p>
<h3 id="6">ì—°ìŠµ 6: ì„±ëŠ¥ ë¹„êµ<a class="header-link" href="#6" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì„ ìˆ˜í–‰í•˜ëŠ” ê°„ë‹¨í•œ ë²¤ì¹˜ë§ˆí¬ë¥¼ êµ¬í˜„í•˜ì„¸ìš”:
1. ë¬´ì‘ìœ„ í† í°ìœ¼ë¡œ ëŒ€ìš©ëŸ‰(1MB ì´ìƒ) ì†ŒìŠ¤ íŒŒì¼ ìƒì„±
2. ì„¹ì…˜ 8ì˜ ì§ì ‘ ì‘ì„± ë ‰ì„œë¡œ í† í°í™”
3. ê²°í•© ì •ê·œ í‘œí˜„ì‹ì„ ì‚¬ìš©í•œ Pythonì˜ <code>re</code> ëª¨ë“ˆë¡œ í† í°í™”
4. í† í°í™” ì‹œê°„ì„ ë¹„êµí•˜ê³  ë‘ ê²°ê³¼ê°€ ë™ì¼í•œ í† í°ì„ ìƒì„±í•˜ëŠ”ì§€ ê²€ì¦</p>
<hr />
<p><a href="./01_Introduction_to_Compilers.md">ì´ì „: ì»´íŒŒì¼ëŸ¬ ê°œë¡ </a> | <a href="./03_Finite_Automata.md">ë‹¤ìŒ: ìœ í•œ ì˜¤í† ë§ˆí†¤</a> | <a href="./00_Overview.md">ê°œìš”</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Compiler_Design/01_Introduction_to_Compilers.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë ˆìŠ¨ 1: ì»´íŒŒì¼ëŸ¬ ì…ë¬¸(Introduction to Compilers)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Compiler_Design/03_Finite_Automata.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë ˆìŠ¨ 3: ìœ í•œ ì˜¤í† ë§ˆí†¤(Finite Automata)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}