{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë ˆìŠ¨ 5: í•˜í–¥ì‹ íŒŒì‹±(Top-Down Parsing) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Compiler_Design/">Compiler Design</a>
    <span class="separator">/</span>
    <span class="current">ë ˆìŠ¨ 5: í•˜í–¥ì‹ íŒŒì‹±(Top-Down Parsing)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ë ˆìŠ¨ 5: í•˜í–¥ì‹ íŒŒì‹±(Top-Down Parsing)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Compiler_Design/04_Context_Free_Grammars.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë ˆìŠ¨ 4: ë¬¸ë§¥ ììœ  ë¬¸ë²•</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Compiler_Design/06_Bottom_Up_Parsing.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë ˆìŠ¨ 6: ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. í•˜í–¥ì‹ íŒŒì‹± ì†Œê°œ</a></li>
<li><a href="#2-recursive-descent-parsing">2. ì¬ê·€ í•˜ê°• íŒŒì‹±(Recursive Descent Parsing)</a><ul>
<li><a href="#21">2.1 ê¸°ë³¸ ê°œë…</a></li>
<li><a href="#22">2.2 êµ¬í˜„</a></li>
<li><a href="#23">2.3 ì¥ì ê³¼ í•œê³„</a></li>
</ul>
</li>
<li><a href="#3-first-follow">3. FIRST ì§‘í•©ê³¼ FOLLOW ì§‘í•©</a><ul>
<li><a href="#31-first">3.1 FIRST ì§‘í•©</a></li>
<li><a href="#32-follow">3.2 FOLLOW ì§‘í•©</a></li>
<li><a href="#42-python">4.2 Python êµ¬í˜„</a></li>
<li><a href="#43">4.3 í‘œí˜„ì‹ ë¬¸ë²• í…Œì´ë¸”</a></li>
</ul>
</li>
<li><a href="#5-ll1">5. í…Œì´ë¸” êµ¬ë™ LL(1) íŒŒì„œ</a><ul>
<li><a href="#51">5.1 íŒŒì‹± ì•Œê³ ë¦¬ì¦˜</a></li>
<li><a href="#52">5.2 ì™„ì „í•œ êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#6-left-recursion-elimination">6. ì¢Œì¬ê·€ ì œê±°(Left Recursion Elimination)</a><ul>
<li><a href="#61">6.1 ë¬¸ì œ</a></li>
<li><a href="#62">6.2 ì§ì ‘ ì¢Œì¬ê·€ ì œê±°</a></li>
<li><a href="#63">6.3 ê°„ì ‘ ì¢Œì¬ê·€ ì œê±°</a></li>
<li><a href="#64-python">6.4 Python êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#7-left-factoring">7. ì¢Œì¸ìˆ˜ë¶„í•´(Left Factoring)</a><ul>
<li><a href="#71">7.1 ë¬¸ì œ</a></li>
<li><a href="#72">7.2 ë³€í™˜</a></li>
<li><a href="#73">7.3 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#8-ll1">8. LL(1) ì¶©ëŒê³¼ í•´ì†Œ</a><ul>
<li><a href="#81">8.1 ì¶©ëŒ ìœ í˜•</a></li>
<li><a href="#82">8.2 í•´ì†Œ ì „ëµ</a></li>
<li><a href="#83-else">8.3 ê³ ì „ì ì¸ ë§¤ë‹¬ë¦° else ë¬¸ì œ</a></li>
</ul>
</li>
<li><a href="#9-error-recovery">9. ì˜¤ë¥˜ ë³µêµ¬(Error Recovery)</a><ul>
<li><a href="#91-panic-mode-recovery">9.1 íŒ¨ë‹‰ ëª¨ë“œ ë³µêµ¬(Panic Mode Recovery)</a></li>
<li><a href="#92-phrase-level-recovery">9.2 êµ¬ë¬¸ ìˆ˜ì¤€ ë³µêµ¬(Phrase-Level Recovery)</a></li>
<li><a href="#93-error-productions">9.3 ì˜¤ë¥˜ ìƒì„± ê·œì¹™(Error Productions)</a></li>
</ul>
</li>
<li><a href="#10-llk-all">10. LL(k)ì™€ ALL(*) íŒŒì‹±</a><ul>
<li><a href="#101-llk">10.1 LL(k) íŒŒì‹±</a></li>
<li><a href="#102-all">10.2 ALL(*) íŒŒì‹±</a></li>
<li><a href="#103">10.3 í•˜í–¥ì‹ íŒŒì‹± ì „ëµ ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#11">11. ëª¨ë‘ í•©ì¹˜ê¸°</a></li>
<li><a href="#12">12. ìš”ì•½</a></li>
<li><a href="#_2">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-first-follow">ì—°ìŠµ 1: FIRST ë° FOLLOW ì§‘í•© ê³„ì‚°</a></li>
<li><a href="#2-ll1">ì—°ìŠµ 2: LL(1) í…Œì´ë¸” êµ¬ì„±</a></li>
<li><a href="#3">ì—°ìŠµ 3: ì¢Œì¬ê·€ ì œê±°</a></li>
<li><a href="#4">ì—°ìŠµ 4: ì¬ê·€ í•˜ê°• íŒŒì„œ í™•ì¥</a></li>
<li><a href="#5">ì—°ìŠµ 5: ì˜¤ë¥˜ ë³µêµ¬</a></li>
<li><a href="#6">ì—°ìŠµ 6: ë¬¸ë²• ì„¤ê³„ ë„ì „</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="5-top-down-parsing">ë ˆìŠ¨ 5: í•˜í–¥ì‹ íŒŒì‹±(Top-Down Parsing)<a class="header-link" href="#5-top-down-parsing" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>ì´ ë ˆìŠ¨ì„ ì™„ë£Œí•˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<ol>
<li><strong>ì´í•´</strong>: í•˜í–¥ì‹ íŒŒì‹±ì˜ ì›ë¦¬ì™€ íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ ë£¨íŠ¸ì—ì„œ ì•„ë˜ë¡œ êµ¬ì„±í•˜ëŠ” ë°©ë²•</li>
<li><strong>ê³„ì‚°</strong>: ì„ì˜ì˜ ë¬¸ë§¥ ììœ  ë¬¸ë²•ì— ëŒ€í•œ FIRST ë° FOLLOW ì§‘í•© ê³„ì‚°</li>
<li><strong>êµ¬ì„±</strong>: LL(1) íŒŒì‹± í…Œì´ë¸”ì„ êµ¬ì„±í•˜ê³  LL(1) ë¬¸ë²• ì‹ë³„</li>
<li><strong>êµ¬í˜„</strong>: ì†Œê·œëª¨ ì–¸ì–´ì— ëŒ€í•œ ì¬ê·€ í•˜ê°• íŒŒì„œ(recursive descent parser) ì§ì ‘ êµ¬í˜„</li>
<li><strong>êµ¬í˜„</strong>: êµ¬ì„±ëœ íŒŒì‹± í…Œì´ë¸”ì—ì„œ í…Œì´ë¸” êµ¬ë™ LL(1) íŒŒì„œ êµ¬í˜„</li>
<li><strong>ì œê±°</strong>: ì¢Œì¬ê·€(left recursion)ë¥¼ ì œê±°í•˜ê³  ì¢Œì¸ìˆ˜ë¶„í•´(left factoring)ë¥¼ ì ìš©í•˜ì—¬ ë¬¸ë²•ì„ LL(1) í˜¸í™˜ìœ¼ë¡œ ë§Œë“¤ê¸°</li>
<li><strong>í•´ì†Œ</strong>: LL(1) ì¶©ëŒ í•´ì†Œ ë° ì˜¤ë¥˜ ë³µêµ¬ ì „ëµ ì ìš©</li>
<li><strong>ì„¤ëª…</strong>: LL(k)ì™€ ALL(*) íŒŒì‹±ì´ LL(1)ì„ ë„˜ì–´ ì œê³µí•˜ëŠ” í™•ì¥ ê¸°ëŠ¥ ì„¤ëª…</li>
</ol>
<hr />
<h2 id="1">1. í•˜í–¥ì‹ íŒŒì‹± ì†Œê°œ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<p>í•˜í–¥ì‹ íŒŒì‹±(top-down parsing)ì€ <strong>ë£¨íŠ¸</strong>(ì‹œì‘ ê¸°í˜¸)ì—ì„œ íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ êµ¬ì„±í•˜ì—¬ <strong>ì</strong>(ë‹¨ë§ ê¸°í˜¸) ë°©í–¥ìœ¼ë¡œ ë‚´ë ¤ê°€ëŠ” íŒŒì‹± ì „ëµì…ë‹ˆë‹¤. ê° ë‹¨ê³„ì—ì„œ íŒŒì„œëŠ” í˜„ì¬ ì…ë ¥ í† í°ì„ ê¸°ë°˜ìœ¼ë¡œ ì ìš©í•  ìƒì„± ê·œì¹™ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.</p>
<p>í•˜í–¥ì‹ íŒŒì‹±ì˜ í•µì‹¬ ì§ˆë¬¸:</p>
<blockquote>
<p>íŒŒì‹± ìŠ¤íƒ ë§¨ ìœ„ì— ë¹„ë‹¨ë§ $A$ê°€ ìˆê³  í˜„ì¬ ë£©ì–´í—¤ë“œ(lookahead) í† í°ì´ $a$ì¼ ë•Œ, íŒŒì„œëŠ” ì–´ë–¤ ìƒì„± ê·œì¹™ $A \to \alpha$ë¥¼ ì ìš©í•´ì•¼ í•˜ëŠ”ê°€?</p>
</blockquote>
<p>í•˜í–¥ì‹ íŒŒì„œëŠ” ë‘ ê°€ì§€ ì£¼ìš” í˜•íƒœë¡œ ë‚˜ë‰©ë‹ˆë‹¤:</p>
<ol>
<li><strong>ì¬ê·€ í•˜ê°• íŒŒì„œ(Recursive descent parser)</strong> -- ë¹„ë‹¨ë§ë‹¹ í•˜ë‚˜ì”©, ìƒí˜¸ ì¬ê·€ì ì¸ í”„ë¡œì‹œì €ë“¤ì˜ ëª¨ìŒ</li>
<li><strong>í…Œì´ë¸” êµ¬ë™ ì˜ˆì¸¡ íŒŒì„œ(Table-driven predictive parser)</strong> -- LL(1) íŒŒì‹± í…Œì´ë¸”ê³¼ ëª…ì‹œì  ìŠ¤íƒìœ¼ë¡œ êµ¬ë™</li>
</ol>
<p>ë‘ í˜•íƒœ ëª¨ë‘ ë¬¸ë²•ì´ <strong>LL(1)</strong> (ë˜ëŠ” ê·¸ì— ê°€ê¹ê²Œ)ì´ì–´ì•¼ í•©ë‹ˆë‹¤. LL(1)ì´ë¼ëŠ” ì´ë¦„ì€:</p>
<ul>
<li><strong>L</strong>: ì…ë ¥ì„ <strong>ì™¼ìª½(Left)</strong>ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ìŠ¤ìº”</li>
<li><strong>L</strong>: <strong>ìµœì¢Œë‹¨(Leftmost)</strong> ìœ ë„ ìƒì„±</li>
<li><strong>1</strong>: <strong>1</strong>ê°œì˜ í† í° ë£©ì–´í—¤ë“œ ì‚¬ìš©</li>
</ul>
<div class="highlight"><pre><span></span><code>Top-Down Parse Tree Construction (for input &quot;a + b * c&quot;):

Step 1:         E              Step 2:         E
               /|\                            /|\
              ? ? ?                          T  E&#39;
                                            /
                                           ?

Step 3:         E              Step 4:         E
               /|\                            /|\
              T  E&#39;                          T  E&#39;
             /   |                          /|  |\
            F    T&#39;                        F T&#39; + T E&#39;
            |                              |  |
            a    ...                       a  Îµ  ...
</code></pre></div>

<p>íŒŒì„œëŠ” <strong>ìµœì¢Œë‹¨ ìœ ë„(leftmost derivation)</strong> ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤: ë§¤ ë‹¨ê³„ë§ˆë‹¤ ê°€ì¥ ì™¼ìª½ì˜ ë¹„ë‹¨ë§ì„ ì „ê°œí•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="2-recursive-descent-parsing">2. ì¬ê·€ í•˜ê°• íŒŒì‹±(Recursive Descent Parsing)<a class="header-link" href="#2-recursive-descent-parsing" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ê¸°ë³¸ ê°œë…<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ì¬ê·€ í•˜ê°• íŒŒì„œì—ì„œ, ë¬¸ë²•ì˜ ê° ë¹„ë‹¨ë§ì€ í•˜ë‚˜ì˜ í•¨ìˆ˜ì— ëŒ€ì‘í•©ë‹ˆë‹¤. ë¹„ë‹¨ë§ $A$ì— ëŒ€í•œ í•¨ìˆ˜ëŠ” í˜„ì¬ ë£©ì–´í—¤ë“œ í† í°ì„ ê²€ì‚¬í•˜ì—¬ ì‚¬ìš©í•  ìƒì„± ê·œì¹™ì„ ê²°ì •í•œ ë‹¤ìŒ, ì„ íƒëœ ìƒì„± ê·œì¹™ ìš°ë³€ì˜ ê° ê¸°í˜¸ì— ëŒ€í•œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>
<p>ì¢Œì¬ê·€ ì œê±° í›„ì˜ ê³ ì „ì ì¸ í‘œí˜„ì‹ ë¬¸ë²•ì„ ê³ ë ¤í•©ë‹ˆë‹¤:</p>
<p>$$
\begin{aligned}
E &\to T \; E' \\
E' &\to + \; T \; E' \;\mid\; \varepsilon \\
T &\to F \; T' \\
T' &\to * \; F \; T' \;\mid\; \varepsilon \\
F &\to ( \; E \; ) \;\mid\; \textbf{id}
\end{aligned}
$$</p>
<h3 id="22">2.2 êµ¬í˜„<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>ì‚°ìˆ  í‘œí˜„ì‹ì„ ìœ„í•œ ì™„ì „í•œ ì¬ê·€ í•˜ê°• íŒŒì„œ:</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Recursive Descent Parser for Arithmetic Expressions</span>

<span class="sd">Grammar (LL(1)-compatible):</span>
<span class="sd">    E  -&gt; T E&#39;</span>
<span class="sd">    E&#39; -&gt; + T E&#39; | Îµ</span>
<span class="sd">    T  -&gt; F T&#39;</span>
<span class="sd">    T&#39; -&gt; * F T&#39; | Îµ</span>
<span class="sd">    F  -&gt; ( E ) | id | num</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>


<span class="c1"># â”€â”€â”€ Token Types â”€â”€â”€</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TokenType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">PLUS</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">STAR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">LPAREN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">RPAREN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">ID</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">NUM</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">EOF</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Token</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">TokenType</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># position in input for error reporting</span>


<span class="c1"># â”€â”€â”€ Lexer â”€â”€â”€</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Lexer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simple tokenizer for arithmetic expressions.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_skip_whitespace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">next_token</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_skip_whitespace</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">EOF</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>

        <span class="n">ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>

        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">STAR</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">LPAREN</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">RPAREN</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ch</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">NUM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">],</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ch</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">or</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">],</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected character &#39;</span><span class="si">{</span><span class="n">ch</span><span class="si">}</span><span class="s2">&#39; at position </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tokenize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">tok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_token</span><span class="p">()</span>
            <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tok</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">TokenType</span><span class="o">.</span><span class="n">EOF</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">tokens</span>


<span class="c1"># â”€â”€â”€ AST Nodes â”€â”€â”€</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ASTNode</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NumLit</span><span class="p">(</span><span class="n">ASTNode</span><span class="p">):</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">int</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Ident</span><span class="p">(</span><span class="n">ASTNode</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BinOp</span><span class="p">(</span><span class="n">ASTNode</span><span class="p">):</span>
    <span class="n">op</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">ASTNode</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">ASTNode</span>


<span class="c1"># â”€â”€â”€ Recursive Descent Parser â”€â”€â”€</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RecursiveDescentParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses arithmetic expressions using recursive descent.</span>

<span class="sd">    Each nonterminal in the grammar has a corresponding method:</span>
<span class="sd">        E  -&gt; T E&#39;        =&gt;  parse_E()</span>
<span class="sd">        E&#39; -&gt; + T E&#39; | Îµ  =&gt;  parse_E_prime(left)</span>
<span class="sd">        T  -&gt; F T&#39;        =&gt;  parse_T()</span>
<span class="sd">        T&#39; -&gt; * F T&#39; | Îµ  =&gt;  parse_T_prime(left)</span>
<span class="sd">        F  -&gt; ( E ) | id  =&gt;  parse_F()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Token</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">current</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="n">TokenType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Consume the current token if it matches the expected type.&quot;&quot;&quot;</span>
        <span class="n">tok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span>
        <span class="k">if</span> <span class="n">tok</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">expected</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">expected</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> but found </span><span class="si">{</span><span class="n">tok</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(&#39;</span><span class="si">{</span><span class="n">tok</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;) at position </span><span class="si">{</span><span class="n">tok</span><span class="o">.</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">tok</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ASTNode</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Entry point: parse the entire expression.&quot;&quot;&quot;</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_E</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">EOF</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_E</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ASTNode</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;E -&gt; T E&#39;&quot;&quot;&quot;</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_T</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_E_prime</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_E_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">:</span> <span class="n">ASTNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ASTNode</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;E&#39; -&gt; + T E&#39; | Îµ&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">TokenType</span><span class="o">.</span><span class="n">PLUS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">PLUS</span><span class="p">)</span>
            <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_T</span><span class="p">()</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">BinOp</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_E_prime</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>  <span class="c1"># left-associate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Îµ-production: return what we have</span>
            <span class="k">return</span> <span class="n">left</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_T</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ASTNode</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;T -&gt; F T&#39;&quot;&quot;&quot;</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_F</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_T_prime</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_T_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">:</span> <span class="n">ASTNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ASTNode</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;T&#39; -&gt; * F T&#39; | Îµ&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">TokenType</span><span class="o">.</span><span class="n">STAR</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">STAR</span><span class="p">)</span>
            <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_F</span><span class="p">()</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">BinOp</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_T_prime</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>  <span class="c1"># left-associate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">left</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_F</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ASTNode</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;F -&gt; ( E ) | id | num&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">TokenType</span><span class="o">.</span><span class="n">LPAREN</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">LPAREN</span><span class="p">)</span>
            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_E</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">RPAREN</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">node</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">TokenType</span><span class="o">.</span><span class="n">NUM</span><span class="p">:</span>
            <span class="n">tok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">NUM</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">NumLit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">TokenType</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span>
            <span class="n">tok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">(</span><span class="n">TokenType</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Ident</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">tok</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected token </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;) at position </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>


<span class="c1"># â”€â”€â”€ Pretty Printer â”€â”€â”€</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pretty_print</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">ASTNode</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produce a human-readable representation of the AST.&quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">indent</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">NumLit</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">NumLit(</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">Ident</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Ident(</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">BinOp</span><span class="p">):</span>
        <span class="n">left_str</span> <span class="o">=</span> <span class="n">pretty_print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">right_str</span> <span class="o">=</span> <span class="n">pretty_print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">BinOp(</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">op</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">left_str</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">right_str</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Unknown(</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">)&quot;</span>


<span class="c1"># â”€â”€â”€ Demo â”€â”€â”€</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">examples</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;3 + 4 * 5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;(a + b) * c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x + y + z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2 * (3 + 4)&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Input: </span><span class="si">{</span><span class="n">expr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">Lexer</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="n">tokenize</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tokens: </span><span class="si">{</span><span class="p">[(</span><span class="n">t</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tokens</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ast</span> <span class="o">=</span> <span class="n">RecursiveDescentParser</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AST:</span><span class="se">\n</span><span class="si">{</span><span class="n">pretty_print</span><span class="p">(</span><span class="n">ast</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>"3 + 4 * 5"ì— ëŒ€í•œ ì¶œë ¥:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">Input</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span>
<span class="n">Tokens</span><span class="o">:</span><span class="w"> </span><span class="o">[(</span><span class="s1">&#39;NUM&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="s1">&#39;PLUS&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;+&#39;</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="s1">&#39;NUM&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="s1">&#39;STAR&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="s1">&#39;NUM&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;5&#39;</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="s1">&#39;EOF&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="o">)]</span>
<span class="n">AST</span><span class="o">:</span>
<span class="n">BinOp</span><span class="o">(+)</span>
<span class="w">  </span><span class="n">NumLit</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
<span class="w">  </span><span class="n">BinOp</span><span class="o">(*)</span>
<span class="w">    </span><span class="n">NumLit</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>
<span class="w">    </span><span class="n">NumLit</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
</code></pre></div>

<h3 id="23">2.3 ì¥ì ê³¼ í•œê³„<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<p><strong>ì¥ì :</strong></p>
<ul>
<li>ì§ì ‘ ì´í•´í•˜ê³  êµ¬í˜„í•˜ê¸° ì‰¬ì›€</li>
<li>ìì—°ìŠ¤ëŸ¬ìš´ ì˜¤ë¥˜ ë©”ì‹œì§€(ê° í•¨ìˆ˜ê°€ ê¸°ëŒ€í•˜ëŠ” ê²ƒì„ ì•Œê³  ìˆìŒ)</li>
<li>ì˜ë¯¸ ë™ì‘(AST êµ¬ì„±, íƒ€ì… ê²€ì‚¬)ì„ ì‰½ê²Œ ì‚½ì… ê°€ëŠ¥</li>
<li>ìˆ˜ë™ ì—­ì¶”ì (backtracking)ìœ¼ë¡œ ì¼ë¶€ ë¹„LL(1) êµ¬ë¬¸ ì²˜ë¦¬ ê°€ëŠ¥</li>
</ul>
<p><strong>í•œê³„:</strong></p>
<ul>
<li>ë¬¸ë²•ì´ (ëŒ€ëµ) LL(1)ì´ì–´ì•¼ í•¨</li>
<li>ì¢Œì¬ê·€ ë¬¸ë²•ì„ ì§ì ‘ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŒ</li>
<li>ê³¼ë„í•œ ì—­ì¶”ì ìœ¼ë¡œ ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆìŒ</li>
<li>ëŒ€ê·œëª¨ íŒŒì„œë¥¼ ì§ì ‘ ìœ ì§€í•˜ëŠ” ê²ƒì€ ì˜¤ë¥˜ ê°€ëŠ¥ì„±ì´ ë†’ìŒ</li>
</ul>
<hr />
<h2 id="3-first-follow">3. FIRST ì§‘í•©ê³¼ FOLLOW ì§‘í•©<a class="header-link" href="#3-first-follow" title="Permanent link">&para;</a></h2>
<p>FIRST ì§‘í•©ê³¼ FOLLOW ì§‘í•©ì€ ì˜ˆì¸¡ íŒŒì‹±ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” í•µì‹¬ ìë£Œ êµ¬ì¡°ì…ë‹ˆë‹¤. ì´ë“¤ì€ ë‘ ê°€ì§€ ë³¸ì§ˆì ì¸ ì§ˆë¬¸ì— ë‹µí•©ë‹ˆë‹¤:</p>
<ul>
<li><strong>FIRST($\alpha$)</strong>: $\alpha$ì—ì„œ ìœ ë„ë˜ëŠ” ë¬¸ìì—´ì˜ ì²« ë²ˆì§¸ ê¸°í˜¸ë¡œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ë‹¨ë§ì€ ë¬´ì—‡ì¸ê°€?</li>
<li><strong>FOLLOW($A$)</strong>: ì–´ë–¤ ë¬¸ì¥ í˜•ì‹ì—ì„œ ë¹„ë‹¨ë§ $A$ ë°”ë¡œ ë‹¤ìŒì— ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ë‹¨ë§ì€ ë¬´ì—‡ì¸ê°€?</li>
</ul>
<h3 id="31-first">3.1 FIRST ì§‘í•©<a class="header-link" href="#31-first" title="Permanent link">&para;</a></h3>
<p><strong>ì •ì˜.</strong> ë¬¸ë²• ê¸°í˜¸ë“¤ì˜ ë¬¸ìì—´ $\alpha$ì— ëŒ€í•´, $\text{FIRST}(\alpha)$ëŠ” $\alpha$ì—ì„œ ìœ ë„ë˜ëŠ” ë¬¸ìì—´ì˜ ì‹œì‘ì´ ë  ìˆ˜ ìˆëŠ” ë‹¨ë§ë“¤ì˜ ì§‘í•©ì…ë‹ˆë‹¤. $\alpha \Rightarrow^* \varepsilon$ì´ë©´ $\varepsilon \in \text{FIRST}(\alpha)$ì…ë‹ˆë‹¤.</p>
<p><strong>FIRST ì§‘í•© ê³„ì‚° ì•Œê³ ë¦¬ì¦˜:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">Algorithm</span><span class="o">:</span><span class="w"> </span><span class="n">Compute</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">X</span><span class="o">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">grammar</span><span class="w"> </span><span class="n">symbols</span><span class="w"> </span><span class="n">X</span>

<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">terminal</span><span class="o">:</span>
<span class="w">       </span><span class="n">FIRST</span><span class="o">(</span><span class="n">X</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">X</span><span class="o">}</span>

<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">nonterminal</span><span class="o">:</span>
<span class="w">       </span><span class="n">For</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Y1</span><span class="w"> </span><span class="n">Y2</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="n">Yk</span><span class="o">:</span>
<span class="w">           </span><span class="n">Add</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">Y1</span><span class="o">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">{</span><span class="err">Îµ</span><span class="o">}</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">X</span><span class="o">)</span>
<span class="w">           </span><span class="n">If</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="err">âˆˆ</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">Y1</span><span class="o">):</span>
<span class="w">               </span><span class="n">Add</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">Y2</span><span class="o">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">{</span><span class="err">Îµ</span><span class="o">}</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">X</span><span class="o">)</span>
<span class="w">               </span><span class="n">If</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="err">âˆˆ</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">Y2</span><span class="o">):</span>
<span class="w">                   </span><span class="n">Add</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">Y3</span><span class="o">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">{</span><span class="err">Îµ</span><span class="o">}</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">X</span><span class="o">)</span>
<span class="w">                   </span><span class="o">...</span><span class="k">continue</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">Yi</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="err">âˆ‰</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">Yi</span><span class="o">)</span>
<span class="w">           </span><span class="n">If</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="err">âˆˆ</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">Yi</span><span class="o">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">k</span><span class="o">:</span>
<span class="w">               </span><span class="n">Add</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">X</span><span class="o">)</span>

<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">production</span><span class="o">:</span>
<span class="w">       </span><span class="n">Add</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">FIRST</span><span class="o">(</span><span class="n">X</span><span class="o">)</span>

<span class="n">Repeat</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="kd">set</span><span class="w"> </span><span class="n">changes</span><span class="o">.</span>
</code></pre></div>

<p><strong>ë¬¸ìì—´ì— ëŒ€í•œ FIRST í™•ì¥:</strong></p>
<p>ë¬¸ìì—´ $\alpha = X_1 X_2 \cdots X_n$ì— ëŒ€í•´:</p>
<p>$$
\text{FIRST}(X_1 X_2 \cdots X_n) = \begin{cases}
\text{FIRST}(X_1) & \text{if } \varepsilon \notin \text{FIRST}(X_1) \\
(\text{FIRST}(X_1) - \{\varepsilon\}) \cup \text{FIRST}(X_2 \cdots X_n) & \text{if } \varepsilon \in \text{FIRST}(X_1)
\end{cases}
$$</p>
<h3 id="32-follow">3.2 FOLLOW ì§‘í•©<a class="header-link" href="#32-follow" title="Permanent link">&para;</a></h3>
<p><strong>ì •ì˜.</strong> ë¹„ë‹¨ë§ $A$ì— ëŒ€í•´, $\text{FOLLOW}(A)$ëŠ” ì–´ë–¤ ë¬¸ì¥ í˜•ì‹ì—ì„œ $A$ ë°”ë¡œ ì˜¤ë¥¸ìª½ì— ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ë‹¨ë§ë“¤ì˜ ì§‘í•©ì…ë‹ˆë‹¤. ì…ë ¥ ë í‘œì‹œì $\ LATEX2 (ì—´)ë¡œ ì¸ë±ì‹±ëœ 2ì°¨ì› ë°°ì—´ì…ë‹ˆë‹¤. ê° í•­ëª© $M[A, a]$ëŠ” ì ìš©í•  ìƒì„± ê·œì¹™ì„ í¬í•¨í•©ë‹ˆë‹¤.</p>
<p><strong>ì•Œê³ ë¦¬ì¦˜: LL(1) í…Œì´ë¸” êµ¬ì„±</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">grammar</span><span class="o">:</span>
<span class="w">    </span><span class="mf">1.</span><span class="w"> </span><span class="n">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="kr">FIRST</span><span class="p">(</span><span class="err">Î±</span><span class="p">)</span><span class="o">:</span>
<span class="w">           </span><span class="n">Add</span><span class="w"> </span><span class="s">&quot;A -&gt; Î±&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">M</span><span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span>

<span class="w">    </span><span class="mf">2.</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="err">âˆˆ</span><span class="w"> </span><span class="kr">FIRST</span><span class="p">(</span><span class="err">Î±</span><span class="p">)</span><span class="o">:</span>
<span class="w">           </span><span class="n">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">FOLLOW</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">:</span>
<span class="w">               </span><span class="n">Add</span><span class="w"> </span><span class="s">&quot;A -&gt; Î±&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">M</span><span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span>
<span class="w">           </span><span class="nf">If</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="err">âˆˆ</span><span class="w"> </span><span class="n">FOLLOW</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">:</span>
<span class="w">               </span><span class="n">Add</span><span class="w"> </span><span class="s">&quot;A -&gt; Î±&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">M</span><span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">]</span>
</code></pre></div>

<p><strong>ì •ì˜.</strong> ë¬¸ë²•ì´ <strong>LL(1)</strong>ì´ë ¤ë©´ íŒŒì‹± í…Œì´ë¸” $M$ì˜ ëª¨ë“  í•­ëª©ì— ìƒì„± ê·œì¹™ì´ ìµœëŒ€ í•˜ë‚˜ë§Œ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>
<h3 id="42-python">4.2 Python êµ¬í˜„<a class="header-link" href="#42-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_ll1_table</span><span class="p">(</span>
    <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span>
    <span class="n">first</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">follow</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build the LL(1) parsing table.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (table, conflicts) where:</span>
<span class="sd">        - table: dict mapping (nonterminal, terminal) -&gt; production RHS</span>
<span class="sd">        - conflicts: list of conflict descriptions (empty if grammar is LL(1))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">conflicts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
            <span class="c1"># Compute FIRST of the RHS</span>
            <span class="n">rhs_first</span> <span class="o">=</span> <span class="n">first_of_string</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span>

            <span class="c1"># Rule 1: For each terminal a in FIRST(rhs)</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">rhs_first</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">EPSILON</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
                    <span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

            <span class="c1"># Rule 2: If Îµ in FIRST(rhs), for each b in FOLLOW(lhs)</span>
            <span class="k">if</span> <span class="n">EPSILON</span> <span class="ow">in</span> <span class="n">rhs_first</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">follow</span><span class="p">[</span><span class="n">lhs</span><span class="p">]:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
                        <span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

    <span class="c1"># Check for conflicts</span>
    <span class="n">final_table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">prods</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prods</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">conflict_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prods</span><span class="p">]</span>
            <span class="n">conflicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Conflict at M[</span><span class="si">{</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">]: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; vs &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conflict_strs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">final_table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">prods</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">final_table</span><span class="p">,</span> <span class="n">conflicts</span>


<span class="k">def</span><span class="w"> </span><span class="nf">print_ll1_table</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pretty-print the LL(1) parsing table.&quot;&quot;&quot;</span>
    <span class="n">terminals_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">EOF</span><span class="p">]</span>
    <span class="n">nonterminals_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">)</span>

    <span class="c1"># Compute column widths</span>
    <span class="n">col_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminals_list</span><span class="p">),</span>
        <span class="nb">max</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">nt</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="p">[])))</span>
            <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="n">nonterminals_list</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminals_list</span>
        <span class="p">),</span>
        <span class="mi">8</span>
    <span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="c1"># Header</span>
    <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">col_width</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminals_list</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>

    <span class="c1"># Rows</span>
    <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="n">nonterminals_list</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nt</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminals_list</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">nt</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">entry</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nt</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cell</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">col_width</span><span class="si">}}</span><span class="s2">&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">build_expression_grammar</span><span class="p">()</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">compute_first</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
    <span class="n">follow</span> <span class="o">=</span> <span class="n">compute_follow</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span>
    <span class="n">table</span><span class="p">,</span> <span class="n">conflicts</span> <span class="o">=</span> <span class="n">build_ll1_table</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">follow</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LL(1) conflicts found:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grammar is LL(1)!&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">LL(1) Parsing Table:&quot;</span><span class="p">)</span>
    <span class="n">print_ll1_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">grammar</span><span class="p">)</span>
</code></pre></div>

<h3 id="43">4.3 í‘œí˜„ì‹ ë¬¸ë²• í…Œì´ë¸”<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<p>í‘œí˜„ì‹ ë¬¸ë²•ì˜ LL(1) í…Œì´ë¸”:</p>
<div class="highlight"><pre><span></span><code><span class="w">             </span><span class="p">(</span><span class="w">          </span><span class="p">)</span><span class="w">          </span><span class="o">*</span><span class="w">          </span><span class="o">+</span><span class="w">         </span><span class="nv">id</span><span class="w">          </span><span class="p">$</span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="w">   </span><span class="nv">E</span><span class="w">     </span><span class="nv">E</span><span class="o">-&gt;</span><span class="nv">T</span><span class="w"> </span><span class="nv">E</span><span class="o">&#39;</span><span class="w">                                    </span><span class="nv">E</span><span class="o">-&gt;</span><span class="nv">T</span><span class="w"> </span><span class="nv">E</span><span class="o">&#39;</span>
<span class="w">   </span><span class="nv">E</span><span class="o">&#39;</span><span class="w">               </span><span class="nv">E</span><span class="o">&#39;-&gt;</span>Îµ<span class="w">                </span><span class="nv">E</span><span class="o">&#39;-&gt;+</span><span class="nv">T</span><span class="w"> </span><span class="nv">E</span><span class="o">&#39;</span><span class="w">              </span><span class="nv">E</span><span class="o">&#39;-&gt;</span>Îµ
<span class="w">   </span><span class="nv">F</span><span class="w">     </span><span class="nv">F</span><span class="o">-&gt;</span><span class="p">(</span><span class="nv">E</span><span class="p">)</span><span class="w">                                     </span><span class="nv">F</span><span class="o">-&gt;</span><span class="nv">id</span>
<span class="w">   </span><span class="nv">T</span><span class="w">     </span><span class="nv">T</span><span class="o">-&gt;</span><span class="nv">F</span><span class="w"> </span><span class="nv">T</span><span class="o">&#39;</span><span class="w">                                    </span><span class="nv">T</span><span class="o">-&gt;</span><span class="nv">F</span><span class="w"> </span><span class="nv">T</span><span class="o">&#39;</span>
<span class="w">   </span><span class="nv">T</span><span class="o">&#39;</span><span class="w">               </span><span class="nv">T</span><span class="o">&#39;-&gt;</span>Îµ<span class="w">     </span><span class="nv">T</span><span class="o">&#39;-&gt;*</span><span class="nv">F</span><span class="w"> </span><span class="nv">T</span><span class="o">&#39;</span><span class="w">   </span><span class="nv">T</span><span class="o">&#39;-&gt;</span>Îµ<span class="w">                 </span><span class="nv">T</span><span class="o">&#39;-&gt;</span>Îµ
</code></pre></div>

<p><strong>í…Œì´ë¸” ì½ëŠ” ë²•:</strong> íŒŒì„œì˜ ìŠ¤íƒ ë§¨ ìœ„ì— ë¹„ë‹¨ë§ $E$ê°€ ìˆê³  ë£©ì–´í—¤ë“œê°€ <code>id</code>ì´ë©´, ìƒì„± ê·œì¹™ $E \to T\ E'$ë¥¼ ì ìš©í•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="5-ll1">5. í…Œì´ë¸” êµ¬ë™ LL(1) íŒŒì„œ<a class="header-link" href="#5-ll1" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 íŒŒì‹± ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p>í…Œì´ë¸” êµ¬ë™ LL(1) íŒŒì„œëŠ” ëª…ì‹œì  ìŠ¤íƒê³¼ íŒŒì‹± í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìµœì¢Œë‹¨ ìœ ë„ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="n">Algorithm</span><span class="o">:</span><span class="w"> </span><span class="n">Table</span><span class="o">-</span><span class="n">Driven</span><span class="w"> </span><span class="n">LL</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="n">Parsing</span>

<span class="n">Input</span><span class="o">:</span><span class="w">  </span><span class="n">string</span><span class="w"> </span><span class="n">w$</span><span class="o">,</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">M</span>
<span class="n">Output</span><span class="o">:</span><span class="w"> </span><span class="n">leftmost</span><span class="w"> </span><span class="n">derivation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">error</span>

<span class="n">Initialize</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">S</span><span class="o">,</span><span class="w"> </span><span class="n">$</span><span class="o">]</span><span class="w">  </span><span class="o">(</span><span class="n">start</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">top</span><span class="o">)</span>
<span class="n">Set</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">w$</span>

<span class="n">repeat</span><span class="o">:</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stack</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">symbol</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">terminal</span><span class="o">:</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">a</span><span class="o">:</span>
<span class="w">            </span><span class="n">pop</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">stack</span>
<span class="w">            </span><span class="n">advance</span><span class="w"> </span><span class="n">ip</span><span class="w">          </span><span class="o">(</span><span class="s2">&quot;match&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="k">else</span><span class="o">:</span>
<span class="w">            </span><span class="n">error</span><span class="o">()</span>

<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">$</span><span class="o">:</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">$</span><span class="o">:</span>
<span class="w">            </span><span class="n">accept</span><span class="o">()</span><span class="w">            </span><span class="o">(</span><span class="s2">&quot;success&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="k">else</span><span class="o">:</span>
<span class="w">            </span><span class="n">error</span><span class="o">()</span>

<span class="w">    </span><span class="k">else</span><span class="o">:</span><span class="w">  </span><span class="o">(</span><span class="n">X</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">nonterminal</span><span class="o">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">M</span><span class="o">[</span><span class="n">X</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Y1</span><span class="w"> </span><span class="n">Y2</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="n">Yk</span><span class="o">:</span>
<span class="w">            </span><span class="n">pop</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">stack</span>
<span class="w">            </span><span class="n">push</span><span class="w"> </span><span class="n">Yk</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Y2</span><span class="o">,</span><span class="w"> </span><span class="n">Y1</span><span class="w"> </span><span class="n">onto</span><span class="w"> </span><span class="n">stack</span><span class="w">  </span><span class="o">(</span><span class="n">Y1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">top</span><span class="o">)</span>
<span class="w">            </span><span class="n">output</span><span class="w"> </span><span class="s2">&quot;X -&gt; Y1 Y2 ... Yk&quot;</span>
<span class="w">        </span><span class="k">else</span><span class="o">:</span>
<span class="w">            </span><span class="n">error</span><span class="o">()</span>
</code></pre></div>

<h3 id="52">5.2 ì™„ì „í•œ êµ¬í˜„<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Table-Driven LL(1) Parser</span>

<span class="sd">Implements a complete LL(1) parser using the parsing table constructed</span>
<span class="sd">from FIRST and FOLLOW sets.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LL1Parser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A table-driven LL(1) parser.</span>

<span class="sd">    Uses an explicit stack and a parsing table to parse input strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span>
        <span class="n">table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="n">grammar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a list of terminal symbols.</span>

<span class="sd">        Args:</span>
<span class="sd">            tokens: list of terminal symbols (without $)</span>
<span class="sd">            verbose: if True, print each step</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the input is accepted, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add end marker</span>
        <span class="n">input_symbols</span> <span class="o">=</span> <span class="n">tokens</span> <span class="o">+</span> <span class="p">[</span><span class="n">EOF</span><span class="p">]</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># input pointer</span>

        <span class="c1"># Initialize stack with $ and start symbol</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">EOF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>

        <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Step&#39;</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;Stack&#39;</span><span class="si">:</span><span class="s2">&lt;30</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Input&#39;</span><span class="si">:</span><span class="s2">&lt;30</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Action&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">90</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">input_symbols</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span>
            <span class="n">remaining</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_symbols</span><span class="p">[</span><span class="n">ip</span><span class="p">:])</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">stack_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">stack</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">step</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">stack_str</span><span class="si">:</span><span class="s2">&lt;30</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">remaining</span><span class="si">:</span><span class="s2">&lt;30</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Case 1: Top is $ (end marker)</span>
            <span class="k">if</span> <span class="n">top</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">current</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ACCEPT&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: unexpected input after stack empty&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># Case 2: Top is a terminal</span>
            <span class="k">if</span> <span class="n">top</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">top</span> <span class="o">==</span> <span class="n">current</span><span class="p">:</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">ip</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Match &#39;</span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;ERROR: expected &#39;</span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">&#39;, found &#39;</span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                        <span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># Case 3: Top is a nonterminal</span>
            <span class="k">elif</span> <span class="n">top</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
                    <span class="n">production</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

                    <span class="c1"># Push RHS in reverse order (so first symbol is on top)</span>
                    <span class="k">if</span> <span class="n">production</span> <span class="o">!=</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">production</span><span class="p">):</span>
                            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>

                    <span class="n">prod_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">production</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Apply </span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">prod_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;ERROR: no entry for M[</span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">]&quot;</span>
                        <span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: unknown symbol &#39;</span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Safety: prevent infinite loops</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: too many steps, possible infinite loop&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>


<span class="c1"># â”€â”€â”€ Demo â”€â”€â”€</span>

<span class="k">def</span><span class="w"> </span><span class="nf">demo_ll1_parser</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the LL(1) parser on the expression grammar.&quot;&quot;&quot;</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">build_expression_grammar</span><span class="p">()</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">compute_first</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
    <span class="n">follow</span> <span class="o">=</span> <span class="n">compute_follow</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span>
    <span class="n">table</span><span class="p">,</span> <span class="n">conflicts</span> <span class="o">=</span> <span class="n">build_ll1_table</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">follow</span><span class="p">)</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">LL1Parser</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

    <span class="c1"># Test inputs</span>
    <span class="n">tests</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">([</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">([</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">],</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="kc">False</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">90</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">90</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;ACCEPTED&quot;</span> <span class="k">if</span> <span class="n">result</span> <span class="k">else</span> <span class="s2">&quot;REJECTED&quot;</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Result: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demo_ll1_parser</span><span class="p">()</span>
</code></pre></div>

<p><strong>"id + id * id"ì— ëŒ€í•œ ì¶”ì  ì˜ˆì‹œ:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">Step</span><span class="w">  </span><span class="n">Stack</span><span class="w">                          </span><span class="n">Input</span><span class="w">                          </span><span class="n">Action</span>
<span class="o">------------------------------------------------------------------------------------------</span>
<span class="w">   </span><span class="mi">0</span><span class="w">  </span><span class="n">E</span><span class="w"> </span><span class="err">$</span><span class="w">                            </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                 </span><span class="kr">Apply</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">E</span><span class="s">&#39;</span>
<span class="s">   1  T E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                         </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                 </span><span class="kr">Apply</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">T</span><span class="s">&#39;</span>
<span class="s">   2  F T&#39;</span><span class="w"> </span><span class="n">E</span><span class="s">&#39; $                      id + id * id $                 Apply F -&gt; id</span>
<span class="s">   3  id T&#39;</span><span class="w"> </span><span class="n">E</span><span class="s">&#39; $                     id + id * id $                 Match &#39;</span><span class="n">id</span><span class="s">&#39;</span>
<span class="s">   4  T&#39;</span><span class="w"> </span><span class="n">E</span><span class="s">&#39; $                        + id * id $                    Apply T&#39;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Îµ</span>
<span class="w">   </span><span class="mi">5</span><span class="w">  </span><span class="n">E</span><span class="s">&#39; $                           + id * id $                    Apply E&#39;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">E</span><span class="s">&#39;</span>
<span class="s">   6  + T E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                       </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                    </span><span class="n">Match</span><span class="w"> </span><span class="s">&#39;+&#39;</span>
<span class="w">   </span><span class="mi">7</span><span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="n">E</span><span class="s">&#39; $                         id * id $                      Apply T -&gt; F T&#39;</span>
<span class="w">   </span><span class="mi">8</span><span class="w">  </span><span class="n">F</span><span class="w"> </span><span class="n">T</span><span class="s">&#39; E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                      </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                      </span><span class="kr">Apply</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span>
<span class="w">   </span><span class="mi">9</span><span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="n">T</span><span class="s">&#39; E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                     </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                      </span><span class="n">Match</span><span class="w"> </span><span class="s">&#39;id&#39;</span>
<span class="w">  </span><span class="mi">10</span><span class="w">  </span><span class="n">T</span><span class="s">&#39; E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                        </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                         </span><span class="kr">Apply</span><span class="w"> </span><span class="n">T</span><span class="s">&#39; -&gt; * F T&#39;</span>
<span class="w">  </span><span class="mi">11</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">T</span><span class="s">&#39; E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                    </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                         </span><span class="n">Match</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="w">  </span><span class="mi">12</span><span class="w">  </span><span class="n">F</span><span class="w"> </span><span class="n">T</span><span class="s">&#39; E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                      </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                           </span><span class="kr">Apply</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span>
<span class="w">  </span><span class="mi">13</span><span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="n">T</span><span class="s">&#39; E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                     </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                           </span><span class="n">Match</span><span class="w"> </span><span class="s">&#39;id&#39;</span>
<span class="w">  </span><span class="mi">14</span><span class="w">  </span><span class="n">T</span><span class="s">&#39; E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                        </span><span class="err">$</span><span class="w">                              </span><span class="kr">Apply</span><span class="w"> </span><span class="n">T</span><span class="s">&#39; -&gt; Îµ</span>
<span class="s">  15  E&#39;</span><span class="w"> </span><span class="err">$</span><span class="w">                           </span><span class="err">$</span><span class="w">                              </span><span class="kr">Apply</span><span class="w"> </span><span class="n">E</span><span class="s">&#39; -&gt; Îµ</span>
<span class="s">  16  $                              $                              ACCEPT</span>
</code></pre></div>

<hr />
<h2 id="6-left-recursion-elimination">6. ì¢Œì¬ê·€ ì œê±°(Left Recursion Elimination)<a class="header-link" href="#6-left-recursion-elimination" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ë¬¸ì œ<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>ë¬¸ë²•ì— $A \Rightarrow^+ A\alpha$ì¸ ì–´ë–¤ ë¬¸ìì—´ $\alpha$ì— ëŒ€í•œ ë¹„ë‹¨ë§ $A$ê°€ ì¡´ì¬í•˜ë©´ <strong>ì¢Œì¬ê·€(left-recursive)</strong>ì…ë‹ˆë‹¤. í•˜í–¥ì‹ íŒŒì„œëŠ” ì¢Œì¬ê·€ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. $A$ë¥¼ íŒŒì‹±í•˜ë©´ ì¦‰ì‹œ $A$ë¥¼ ë‹¤ì‹œ íŒŒì‹±í•´ì•¼ í•˜ë¯€ë¡œ ë¬´í•œ ì¬ê·€ê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>
<p><strong>ì§ì ‘ ì¢Œì¬ê·€(Immediate left recursion)</strong>ëŠ” ë‹¤ìŒ í˜•íƒœì…ë‹ˆë‹¤:</p>
<p>$$A \to A\alpha_1 \mid A\alpha_2 \mid \cdots \mid A\alpha_m \mid \beta_1 \mid \beta_2 \mid \cdots \mid \beta_n$$</p>
<p>ì—¬ê¸°ì„œ $\beta_i$ëŠ” $A$ë¡œ ì‹œì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
<h3 id="62">6.2 ì§ì ‘ ì¢Œì¬ê·€ ì œê±°<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p><strong>ë³€í™˜ ê·œì¹™:</strong></p>
<p>ë‹¤ìŒì„:
$$A \to A\alpha_1 \mid A\alpha_2 \mid \cdots \mid \beta_1 \mid \beta_2 \mid \cdots$$</p>
<p>ë‹¤ìŒìœ¼ë¡œ êµì²´í•©ë‹ˆë‹¤:
$$
\begin{aligned}
A &\to \beta_1 A' \mid \beta_2 A' \mid \cdots \\
A' &\to \alpha_1 A' \mid \alpha_2 A' \mid \cdots \mid \varepsilon
\end{aligned}
$$</p>
<p><strong>ì˜ˆì‹œ:</strong> ì¢Œì¬ê·€ í‘œí˜„ì‹ ë¬¸ë²•:</p>
<p>$$E \to E + T \mid T$$</p>
<p>ë‹¤ìŒì´ ë©ë‹ˆë‹¤:</p>
<p>$$
\begin{aligned}
E &\to T\ E' \\
E' &\to +\ T\ E' \mid \varepsilon
\end{aligned}
$$</p>
<h3 id="63">6.3 ê°„ì ‘ ì¢Œì¬ê·€ ì œê±°<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<p>ê°„ì ‘(ë˜ëŠ” ìˆ¨ê²¨ì§„) ì¢Œì¬ê·€ëŠ” ìˆœí™˜ì´ ì—¬ëŸ¬ ë¹„ë‹¨ë§ì„ í¬í•¨í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤:</p>
<p>$$
\begin{aligned}
A &\to B\alpha \\
B &\to A\beta
\end{aligned}
$$</p>
<p>ì—¬ê¸°ì„œ $A \Rightarrow B\alpha \Rightarrow A\beta\alpha$ì´ë¯€ë¡œ $A$ëŠ” ê°„ì ‘ì ìœ¼ë¡œ ì¢Œì¬ê·€ì ì…ë‹ˆë‹¤.</p>
<p><strong>ì•Œê³ ë¦¬ì¦˜: ëª¨ë“  ì¢Œì¬ê·€ ì œê±°</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">Input</span><span class="o">:</span><span class="w"> </span><span class="n">Grammar</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">cycles</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="err">Îµ</span><span class="o">-</span><span class="n">productions</span>
<span class="w">       </span><span class="o">(</span><span class="n">except</span><span class="w"> </span><span class="err">Îµ</span><span class="o">-</span><span class="n">productions</span><span class="w"> </span><span class="n">introduced</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="o">)</span>

<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Order</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">nonterminals</span><span class="o">:</span><span class="w"> </span><span class="n">A1</span><span class="o">,</span><span class="w"> </span><span class="n">A2</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">An</span>

<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">For</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">n</span><span class="o">:</span>
<span class="w">       </span><span class="n">For</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span>
<span class="w">           </span><span class="n">Replace</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">Ai</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Aj</span><span class="w"> </span><span class="err">Î³</span><span class="w"> </span><span class="k">with</span><span class="o">:</span>
<span class="w">               </span><span class="n">Ai</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î´</span><span class="mi">1</span><span class="w"> </span><span class="err">Î³</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">Î´</span><span class="mi">2</span><span class="w"> </span><span class="err">Î³</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">Î´</span><span class="n">k</span><span class="w"> </span><span class="err">Î³</span>
<span class="w">           </span><span class="n">where</span><span class="w"> </span><span class="n">Aj</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î´</span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">Î´</span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">Î´</span><span class="n">k</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">Aj</span><span class="o">-</span><span class="n">productions</span>

<span class="w">       </span><span class="n">Eliminate</span><span class="w"> </span><span class="n">immediate</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">recursion</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">Ai</span><span class="w"> </span><span class="n">productions</span>
</code></pre></div>

<h3 id="64-python">6.4 Python êµ¬í˜„<a class="header-link" href="#64-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">eliminate_immediate_left_recursion</span><span class="p">(</span>
    <span class="n">lhs</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">productions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Eliminate immediate left recursion from productions of a nonterminal.</span>

<span class="sd">    Args:</span>
<span class="sd">        lhs: the nonterminal</span>
<span class="sd">        productions: list of RHS alternatives</span>

<span class="sd">    Returns:</span>
<span class="sd">        (new_nonterminal, new_productions_for_lhs, productions_for_new)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">left_recursive</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">non_recursive</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">productions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">lhs</span><span class="p">:</span>
            <span class="c1"># A -&gt; A Î±  =&gt;  Î± part</span>
            <span class="n">left_recursive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rhs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">non_recursive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">left_recursive</span><span class="p">:</span>
        <span class="c1"># No left recursion to eliminate</span>
        <span class="k">return</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">productions</span><span class="p">,</span> <span class="p">[]</span>

    <span class="c1"># Create new nonterminal A&#39;</span>
    <span class="n">new_nt</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>

    <span class="c1"># A -&gt; Î²1 A&#39; | Î²2 A&#39; | ...</span>
    <span class="n">new_lhs_prods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">non_recursive</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">beta</span> <span class="o">==</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">]:</span>
            <span class="n">new_lhs_prods</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">new_nt</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_lhs_prods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_nt</span><span class="p">])</span>

    <span class="c1"># A&#39; -&gt; Î±1 A&#39; | Î±2 A&#39; | ... | Îµ</span>
    <span class="n">new_nt_prods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">left_recursive</span><span class="p">:</span>
        <span class="n">new_nt_prods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_nt</span><span class="p">])</span>
    <span class="n">new_nt_prods</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">EPSILON</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">new_nt</span><span class="p">,</span> <span class="n">new_lhs_prods</span><span class="p">,</span> <span class="n">new_nt_prods</span>


<span class="k">def</span><span class="w"> </span><span class="nf">eliminate_all_left_recursion</span><span class="p">(</span><span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Grammar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Eliminate all left recursion (immediate and indirect) from a grammar.</span>

<span class="sd">    Returns a new grammar with no left recursion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_grammar</span> <span class="o">=</span> <span class="n">Grammar</span><span class="p">()</span>
    <span class="n">nonterminals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">)</span>

    <span class="c1"># Working copy of productions</span>
    <span class="n">current_prods</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">nt</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">)</span> <span class="k">for</span> <span class="n">nt</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ai</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nonterminals</span><span class="p">):</span>
        <span class="c1"># Step 1: Replace Ai -&gt; Aj Î³ for j &lt; i</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="n">aj</span> <span class="o">=</span> <span class="n">nonterminals</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">new_prods</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">current_prods</span><span class="p">[</span><span class="n">ai</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">aj</span><span class="p">:</span>
                    <span class="c1"># Substitute: Ai -&gt; Aj Î³ becomes Ai -&gt; Î´k Î³</span>
                    <span class="n">gamma</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="n">current_prods</span><span class="p">[</span><span class="n">aj</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">delta</span> <span class="o">==</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">]:</span>
                            <span class="n">new_prods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gamma</span> <span class="k">if</span> <span class="n">gamma</span> <span class="k">else</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">new_prods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_prods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>
            <span class="n">current_prods</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_prods</span>

        <span class="c1"># Step 2: Eliminate immediate left recursion</span>
        <span class="n">new_nt</span><span class="p">,</span> <span class="n">lhs_prods</span><span class="p">,</span> <span class="n">nt_prods</span> <span class="o">=</span> <span class="n">eliminate_immediate_left_recursion</span><span class="p">(</span>
            <span class="n">ai</span><span class="p">,</span> <span class="n">current_prods</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">current_prods</span><span class="p">[</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="n">lhs_prods</span>
        <span class="k">if</span> <span class="n">nt_prods</span><span class="p">:</span>
            <span class="n">current_prods</span><span class="p">[</span><span class="n">new_nt</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt_prods</span>

    <span class="c1"># Build new grammar</span>
    <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="n">current_prods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
            <span class="n">new_grammar</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="n">new_grammar</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">start</span>
    <span class="n">new_grammar</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">new_grammar</span>


<span class="c1"># Example:</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">Grammar</span><span class="p">()</span>
    <span class="c1"># Left-recursive expression grammar</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original grammar:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="n">g2</span> <span class="o">=</span> <span class="n">eliminate_all_left_recursion</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After left-recursion elimination:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7-left-factoring">7. ì¢Œì¸ìˆ˜ë¶„í•´(Left Factoring)<a class="header-link" href="#7-left-factoring" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ë¬¸ì œ<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<p>ì¢Œì¸ìˆ˜ë¶„í•´ëŠ” ë™ì¼í•œ ë¹„ë‹¨ë§ì— ëŒ€í•œ ë‘ ê°œ ì´ìƒì˜ ìƒì„± ê·œì¹™ì´ ê³µí†µ ì ‘ë‘ì‚¬ë¥¼ ê³µìœ í•  ë•Œ í•„ìš”í•©ë‹ˆë‹¤. ì´ ê²½ìš° íŒŒì„œëŠ” ë‹¨ì¼ ë£©ì–´í—¤ë“œ í† í°ìœ¼ë¡œ ì–´ë–¤ ìƒì„± ê·œì¹™ì„ ì‚¬ìš©í• ì§€ ê²°ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
<p><strong>ì˜ˆì‹œ:</strong></p>
<p>$$
\text{Stmt} \to \textbf{if}\ E\ \textbf{then}\ S\ \textbf{else}\ S \mid \textbf{if}\ E\ \textbf{then}\ S
$$</p>
<p>ë‘ ëŒ€ì•ˆ ëª¨ë‘ <code>if E then S</code>ë¡œ ì‹œì‘í•˜ë¯€ë¡œ, ë‹¨ì¼ ë£©ì–´í—¤ë“œ í† í°ìœ¼ë¡œëŠ” íŒŒì„œê°€ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
<h3 id="72">7.2 ë³€í™˜<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<p>ìƒì„± ê·œì¹™ $A \to \alpha\beta_1 \mid \alpha\beta_2$ì— ëŒ€í•´, ë‹¤ìŒìœ¼ë¡œ êµì²´í•©ë‹ˆë‹¤:</p>
<p>$$
\begin{aligned}
A &\to \alpha\ A' \\
A' &\to \beta_1 \mid \beta_2
\end{aligned}
$$</p>
<p><strong>if-then-else ì¢Œì¸ìˆ˜ë¶„í•´ í›„:</strong></p>
<p>$$
\begin{aligned}
\text{Stmt} &\to \textbf{if}\ E\ \textbf{then}\ S\ \text{Stmt'} \\
\text{Stmt'} &\to \textbf{else}\ S \mid \varepsilon
\end{aligned}
$$</p>
<h3 id="73">7.3 êµ¬í˜„<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">left_factor</span><span class="p">(</span><span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Grammar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply left factoring to the grammar.</span>

<span class="sd">    Returns a new grammar with common prefixes factored out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_grammar</span> <span class="o">=</span> <span class="n">Grammar</span><span class="p">()</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">remaining</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">remaining</span><span class="p">:</span>
            <span class="c1"># Find the longest common prefix among remaining productions</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">new_grammar</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">remaining</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">remaining</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">continue</span>

            <span class="c1"># Group by first symbol</span>
            <span class="n">groups</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">remaining</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rhs</span> <span class="k">else</span> <span class="n">EPSILON</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                    <span class="n">groups</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">groups</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

            <span class="n">new_remaining</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">first_sym</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">new_grammar</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Find longest common prefix</span>
                    <span class="n">prefix</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                        <span class="n">new_prefix</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>
                                <span class="n">new_prefix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">break</span>
                        <span class="n">prefix</span> <span class="o">=</span> <span class="n">new_prefix</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">prefix</span><span class="p">:</span>
                        <span class="c1"># No common prefix; just add all</span>
                        <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
                            <span class="n">new_grammar</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Factor out the prefix</span>
                        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">new_nt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lhs</span><span class="si">}</span><span class="s2">_F</span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="n">new_grammar</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span>
                            <span class="n">lhs</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_nt</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
                            <span class="n">suffix</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):]</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">suffix</span><span class="p">:</span>
                                <span class="n">suffix</span> <span class="o">=</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">]</span>
                            <span class="n">new_grammar</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="n">new_nt</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>

            <span class="n">remaining</span> <span class="o">=</span> <span class="n">new_remaining</span>

    <span class="n">new_grammar</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">start</span>
    <span class="n">new_grammar</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">new_grammar</span>
</code></pre></div>

<hr />
<h2 id="8-ll1">8. LL(1) ì¶©ëŒê³¼ í•´ì†Œ<a class="header-link" href="#8-ll1" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ì¶©ëŒ ìœ í˜•<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>LL(1) ì¶©ëŒì€ íŒŒì‹± í…Œì´ë¸” í•­ëª© $M[A, a]$ì— ìƒì„± ê·œì¹™ì´ ì—¬ëŸ¬ ê°œ ìˆì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ëŠ” ë‘ ê°€ì§€ ì´ìœ ë¡œ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p><strong>FIRST-FIRST ì¶©ëŒ:</strong> $A$ì— ëŒ€í•œ ë‘ ìƒì„± ê·œì¹™ì´ ê²¹ì¹˜ëŠ” FIRST ì§‘í•©ì„ ê°€ì§‘ë‹ˆë‹¤.</p>
<p>$$A \to \alpha \mid \beta \quad \text{ì—¬ê¸°ì„œ } \text{FIRST}(\alpha) \cap \text{FIRST}(\beta) \neq \emptyset$$</p>
<p><strong>FIRST-FOLLOW ì¶©ëŒ:</strong> ë„ê°€ëŠ¥(nullable) ìƒì„± ê·œì¹™ì˜ FIRST ì§‘í•©ì´ ë¹„ë‹¨ë§ì˜ FOLLOW ì§‘í•©ê³¼ ê²¹ì¹©ë‹ˆë‹¤.</p>
<p>$$A \to \alpha \mid \varepsilon \quad \text{ì—¬ê¸°ì„œ } \text{FIRST}(\alpha) \cap \text{FOLLOW}(A) \neq \emptyset$$</p>
<h3 id="82">8.2 í•´ì†Œ ì „ëµ<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì¶©ëŒ ìœ í˜•</th>
<th>í•´ì†Œ ì „ëµ</th>
</tr>
</thead>
<tbody>
<tr>
<td>FIRST-FIRST</td>
<td>ì¢Œì¸ìˆ˜ë¶„í•´, ë¬¸ë²• ì¬ì‘ì„±</td>
</tr>
<tr>
<td>FIRST-FOLLOW</td>
<td>ë¬¸ë²• ì¬êµ¬ì„±, ë˜ëŠ” LL(k)/ALL(*) ì‚¬ìš©</td>
</tr>
<tr>
<td>ë§¤ë‹¬ë¦° else</td>
<td>ê´€ë¡€: ê°€ì¥ ê°€ê¹Œìš´ ë§¤ì¹­ë˜ì§€ ì•Šì€ <code>if</code>ì™€ ì—°ê²°</td>
</tr>
<tr>
<td>ë³¸ì§ˆì  ëª¨í˜¸ì„±</td>
<td>ëª¨í˜¸ì„±ì„ ì œê±°í•˜ê¸° ìœ„í•´ ë¬¸ë²• ì¬ì‘ì„±</td>
</tr>
</tbody>
</table>
<h3 id="83-else">8.3 ê³ ì „ì ì¸ ë§¤ë‹¬ë¦° else ë¬¸ì œ<a class="header-link" href="#83-else" title="Permanent link">&para;</a></h3>
<p>ë§¤ë‹¬ë¦° else ë¬¸ì œëŠ” ì•„ë§ˆë„ ê°€ì¥ ìœ ëª…í•œ LL(1) ì¶©ëŒì…ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="n">Stmt</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="n">Expr</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">Stmt</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="n">Stmt</span>
<span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="n">Expr</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">Stmt</span>
<span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">other</span>
</code></pre></div>

<p>ì¢Œì¸ìˆ˜ë¶„í•´ í›„:</p>
<div class="highlight"><pre><span></span><code><span class="n">Stmt</span><span class="w">  </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="n">Expr</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">Stmt</span><span class="w"> </span><span class="n">Else</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">other</span>
<span class="n">Else</span><span class="w">  </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="n">Stmt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">Îµ</span>
</code></pre></div>

<p>ë£©ì–´í—¤ë“œê°€ <code>else</code>ì¼ ë•Œ $\text{Else}$ì— ëŒ€í•œ FIRST-FOLLOW ì¶©ëŒì´ ì—¬ì „íˆ ìˆìŠµë‹ˆë‹¤: $\text{Else} \to \textbf{else}\ \text{Stmt}$ì™€ $\text{Else} \to \varepsilon$ ëª¨ë‘ ì ìš©ë©ë‹ˆë‹¤.</p>
<p><strong>í•´ì†Œ:</strong> ê´€ë¡€ì ìœ¼ë¡œ í•­ìƒ ë¹„ì—¡ì‹¤ë¡  ìƒì„± ê·œì¹™ì„ ì„ íƒí•©ë‹ˆë‹¤(<code>else</code>ë¥¼ ê°€ì¥ ê°€ê¹Œìš´ <code>if</code>ì™€ ì—°ê²°). íŒŒì‹± í…Œì´ë¸”ì—ì„œ ë‹¨ìˆœíˆ <code>else Stmt</code> ìƒì„± ê·œì¹™ì„ ìš°ì„ ì‹œí•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="9-error-recovery">9. ì˜¤ë¥˜ ë³µêµ¬(Error Recovery)<a class="header-link" href="#9-error-recovery" title="Permanent link">&para;</a></h2>
<p>íŒŒì„œê°€ ì˜¤ë¥˜(íŒŒì‹± í…Œì´ë¸”ì— í•­ëª© ì—†ìŒ, ë˜ëŠ” ë‹¨ë§ ë¶ˆì¼ì¹˜)ë¥¼ ë§Œë‚˜ë©´, ë‹¨ìˆœíˆ ì¤‘ë‹¨í•˜ëŠ” ëŒ€ì‹  ìš°ì•„í•˜ê²Œ ë³µêµ¬í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<h3 id="91-panic-mode-recovery">9.1 íŒ¨ë‹‰ ëª¨ë“œ ë³µêµ¬(Panic Mode Recovery)<a class="header-link" href="#91-panic-mode-recovery" title="Permanent link">&para;</a></h3>
<p>íŒ¨ë‹‰ ëª¨ë“œëŠ” ê°€ì¥ ë‹¨ìˆœí•˜ê³  ê°€ì¥ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì˜¤ë¥˜ ë³µêµ¬ ì „ëµì…ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ íŒŒì„œëŠ” <strong>ë™ê¸°í™” í† í°(synchronization token)</strong>ì„ ì°¾ì„ ë•Œê¹Œì§€ ì…ë ¥ ê¸°í˜¸ë¥¼ ë²„ë¦½ë‹ˆë‹¤. ë™ê¸°í™” í† í°ì€ ì¼ë°˜ì ìœ¼ë¡œ ì „ê°œ ì¤‘ì¸ ë¹„ë‹¨ë§ì˜ FOLLOW ì§‘í•©ì˜ ì›ì†Œì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">panic_mode_recovery</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nonterminal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">input_symbols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">ip</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">follow</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Panic mode error recovery.</span>

<span class="sd">    Skip input tokens until we find one in FOLLOW(nonterminal),</span>
<span class="sd">    then pop the nonterminal from the stack and continue.</span>

<span class="sd">    Returns the new input pointer position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sync_set</span> <span class="o">=</span> <span class="n">follow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nonterminal</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;  Error: skipping input, looking for sync tokens &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;in FOLLOW(</span><span class="si">{</span><span class="n">nonterminal</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">sync_set</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">while</span> <span class="n">ip</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_symbols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">input_symbols</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="ow">in</span> <span class="n">sync_set</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Synchronized on &#39;</span><span class="si">{</span><span class="n">input_symbols</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ip</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Skipping &#39;</span><span class="si">{</span><span class="n">input_symbols</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="n">ip</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">ip</span>
</code></pre></div>

<h3 id="92-phrase-level-recovery">9.2 êµ¬ë¬¸ ìˆ˜ì¤€ ë³µêµ¬(Phrase-Level Recovery)<a class="header-link" href="#92-phrase-level-recovery" title="Permanent link">&para;</a></h3>
<p>êµ¬ë¬¸ ìˆ˜ì¤€ ë³µêµ¬ëŠ” íŒŒì‹± í…Œì´ë¸”ì˜ ì˜¤ë¥˜ í•­ëª©ì— íŠ¹ì • ì˜¤ë¥˜ ì²˜ë¦¬ ë£¨í‹´ì„ ì±„ì›Œ ë„£ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:</p>
<table>
<thead>
<tr>
<th>ìƒí™©</th>
<th>ë³µêµ¬ ë™ì‘</th>
</tr>
</thead>
<tbody>
<tr>
<td>í”¼ì—°ì‚°ì ëˆ„ë½ (<code>+ * x</code>)</td>
<td>ë”ë¯¸ í”¼ì—°ì‚°ì ì‚½ì…</td>
</tr>
<tr>
<td>ì—°ì‚°ì ëˆ„ë½ (<code>x y</code>)</td>
<td>ë”ë¯¸ ì—°ì‚°ì ì‚½ì…</td>
</tr>
<tr>
<td>ê´„í˜¸ ë¶ˆê· í˜•</td>
<td>ëˆ„ë½ëœ <code>)</code> ì‚½ì… ë˜ëŠ” ì—¬ë¶„ì˜ <code>(</code> íê¸°</td>
</tr>
<tr>
<td>ì„¸ë¯¸ì½œë¡  ëˆ„ë½</td>
<td><code>;</code> ì‚½ì… í›„ ê³„ì†</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># Phrase-level error recovery entries for expression grammar</span>
<span class="n">ERROR_ACTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># M[E, +]: missing operand before +</span>
    <span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">):</span> <span class="p">(</span><span class="s2">&quot;insert_id&quot;</span><span class="p">,</span> <span class="s2">&quot;Missing operand before &#39;+&#39;&quot;</span><span class="p">),</span>
    <span class="c1"># M[F, +]: missing operand</span>
    <span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">):</span> <span class="p">(</span><span class="s2">&quot;insert_id&quot;</span><span class="p">,</span> <span class="s2">&quot;Missing operand&quot;</span><span class="p">),</span>
    <span class="c1"># M[F, *]: missing operand</span>
    <span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">):</span> <span class="p">(</span><span class="s2">&quot;insert_id&quot;</span><span class="p">,</span> <span class="s2">&quot;Missing operand&quot;</span><span class="p">),</span>
    <span class="c1"># M[E, )]: extra closing paren</span>
    <span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">):</span> <span class="p">(</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;Unexpected &#39;)&#39;&quot;</span><span class="p">),</span>
    <span class="c1"># M[F, )]: missing operand before )</span>
    <span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">):</span> <span class="p">(</span><span class="s2">&quot;insert_id&quot;</span><span class="p">,</span> <span class="s2">&quot;Missing operand before &#39;)&#39;&quot;</span><span class="p">),</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="93-error-productions">9.3 ì˜¤ë¥˜ ìƒì„± ê·œì¹™(Error Productions)<a class="header-link" href="#93-error-productions" title="Permanent link">&para;</a></h3>
<p>ì¼ë¶€ íŒŒì„œ ìƒì„±ê¸°ëŠ” ë¬¸ë²•ì— <strong>ì˜¤ë¥˜ ìƒì„± ê·œì¹™(error productions)</strong>ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="n">Stmt</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">error</span><span class="w"> </span><span class="p">;</span><span class="w">    </span><span class="c1">// skip everything until &#39;;&#39;</span>
</code></pre></div>

<p>íŒŒì„œê°€ ì–´ë–¤ ì •ìƒ ìƒì„± ê·œì¹™ë„ ì¼ì¹˜ì‹œí‚¬ ìˆ˜ ì—†ì„ ë•Œ, <code>error</code> í† í°ì´ ë™ê¸°í™” í† í°(ì´ ê²½ìš° <code>;</code>)ê¹Œì§€ ì…ë ¥ì„ ì†Œë¹„í•˜ë©° ë§¤ì¹­ë©ë‹ˆë‹¤.</p>
<hr />
<h2 id="10-llk-all">10. LL(k)ì™€ ALL(*) íŒŒì‹±<a class="header-link" href="#10-llk-all" title="Permanent link">&para;</a></h2>
<h3 id="101-llk">10.1 LL(k) íŒŒì‹±<a class="header-link" href="#101-llk" title="Permanent link">&para;</a></h3>
<p>LL(1)ì€ ë‹¨ì¼ ë£©ì–´í—¤ë“œ í† í°ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. <strong>LL(k)</strong>ëŠ” ì´ë¥¼ $k$ê°œì˜ í† í° ë£©ì–´í—¤ë“œë¡œ í™•ì¥í•©ë‹ˆë‹¤. íŒŒì‹± í…Œì´ë¸”ì€ ë¹„ë‹¨ë§ê³¼ ë‚¨ì€ ì…ë ¥ì˜ ê¸¸ì´ $k$ ì ‘ë‘ì‚¬ë¡œ ì¸ë±ì‹±ë©ë‹ˆë‹¤.</p>
<p><strong>ì •ì˜.</strong> ì„ì˜ì˜ ë‘ ìµœì¢Œë‹¨ ìœ ë„ì— ëŒ€í•´ ë¬¸ë²•ì´ LL(k)ì´ë ¤ë©´:</p>
<p>$$
\begin{aligned}
S &\Rightarrow^*_{lm} wA\alpha \Rightarrow_{lm} w\beta\alpha \Rightarrow^*_{lm} wx \\
S &\Rightarrow^*_{lm} wA\alpha \Rightarrow_{lm} w\gamma\alpha \Rightarrow^*_{lm} wy
\end{aligned}
$$</p>
<p>$\text{FIRST}_k(x) = \text{FIRST}_k(y)$ì´ë©´ $\beta = \gamma$ (ë™ì¼í•œ ìƒì„± ê·œì¹™ì´ ì‚¬ìš©ë¨)ì—¬ì•¼ í•©ë‹ˆë‹¤.</p>
<p><strong>ì‹¤ìš©ì  ì˜í–¥:</strong> $k$ê°€ ì¦ê°€í• ìˆ˜ë¡ íŒŒì‹± í…Œì´ë¸”ì€ ì§€ìˆ˜ì ìœ¼ë¡œ ì»¤ì§‘ë‹ˆë‹¤ ($O(|\Sigma|^k)$ê°œì˜ ì—´). ì‹¤ì œë¡œ ì†ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” LL íŒŒì„œì—ì„œëŠ” $k > 2$ëŠ” ë“œë­…ë‹ˆë‹¤.</p>
<h3 id="102-all">10.2 ALL(*) íŒŒì‹±<a class="header-link" href="#102-all" title="Permanent link">&para;</a></h3>
<p><strong>ALL(*)</strong> (Adaptive LL)ì€ ANTLR 4ê°€ ì‚¬ìš©í•˜ëŠ” íŒŒì‹± ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. ì§€ìˆ˜ì  í…Œì´ë¸” í¬ê¸° ì—†ì´ ë¬´ì œí•œ ë£©ì–´í—¤ë“œì˜ ëŠ¥ë ¥ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
<p><strong>í•µì‹¬ ì•„ì´ë””ì–´:</strong></p>
<ol>
<li><strong>ì„ì˜ ë£©ì–´í—¤ë“œ</strong>: ê³ ì •ëœ $k$ ëŒ€ì‹ , ALL(*)ëŠ” ì˜ˆì¸¡ì„ í•´ì†Œí•˜ëŠ” ë° í•„ìš”í•œ ë§Œí¼ í† í°ì„ ê²€ì‚¬í•©ë‹ˆë‹¤</li>
<li><strong>ì¦ê°• ì „ì´ ë„¤íŠ¸ì›Œí¬(Augmented Transition Networks, ATNs)</strong>: ë¬¸ë²•ì€ ì¬ê·€ì  ìƒíƒœ ê¸°ê³„ì˜ ì§‘í•©ìœ¼ë¡œ í‘œí˜„ë©ë‹ˆë‹¤</li>
<li><strong>ë™ì  ë¶„ì„</strong>: ëŸ°íƒ€ì„ì— ATN ì‹œë®¬ë ˆì´ì…˜ì´ ë” ë§ì€ ë¬¸ë§¥ì´ í•„ìš”í•œ ì˜ˆì¸¡ì„ ë§Œë‚˜ë©´, <strong>ë£©ì–´í—¤ë“œ DFA</strong> êµ¬ì„±ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤</li>
<li><strong>ìºì‹±</strong>: ì˜ˆì¸¡ì´ íŠ¹ì • ë£©ì–´í—¤ë“œ ë¬¸ë§¥ì— ëŒ€í•´ í•´ì†Œë˜ë©´, ê²°ê³¼ê°€ í–¥í›„ ì¬ì‚¬ìš©ì„ ìœ„í•´ DFAë¡œ ìºì‹±ë©ë‹ˆë‹¤</li>
</ol>
<div class="highlight"><pre><span></span><code>ALL(*) Decision Process:

    Regular LL(1)                     ALL(*) Adaptive
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Single  â”‚                       â”‚  ATN        â”‚
    â”‚ token   â”‚ â”€â”€resolveâ”€â”€â–¶ prod     â”‚  simulation â”‚
    â”‚ lookup  â”‚                       â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚ If ambig:   â”‚
                                      â”‚  build DFA  â”‚â”€â”€â–¶ prod
                                      â”‚  cache it   â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p><strong>ALL(*)ì˜ ì¥ì :</strong></p>
<ul>
<li>ì„ì˜ì˜ ê²°ì •ì  ë¬¸ë§¥ ììœ  ì–¸ì–´ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤</li>
<li>ìˆ˜ë™ ì¢Œì¸ìˆ˜ë¶„í•´ë‚˜ ì¢Œì¬ê·€ ì œê±°ê°€ í•„ìš” ì—†ìŠµë‹ˆë‹¤(ANTLR 4ëŠ” ì§ì ‘ ì¢Œì¬ê·€ë¥¼ ìë™ìœ¼ë¡œ ì²˜ë¦¬)</li>
<li>ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ë§¤ìš° ì •í™•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
<li>ì‹¤ìš©ì  ì„±ëŠ¥ì€ ì¢…ì¢… ì„ í˜•ì— ê°€ê¹ìŠµë‹ˆë‹¤</li>
</ul>
<p><strong>ANTLR 4 ì˜ˆì‹œ:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// ANTLR 4 grammar -- no left factoring needed</span>
<span class="n">expr</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="s">&#39;*&#39;</span><span class="w"> </span><span class="n">expr</span><span class="w">    </span><span class="c1">// direct left recursion is OK</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="s">&#39;+&#39;</span><span class="w"> </span><span class="n">expr</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="s">&#39;(&#39;</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="s">&#39;)&#39;</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">ID</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">NUM</span>
<span class="w">     </span><span class="p">;</span>
</code></pre></div>

<h3 id="103">10.3 í•˜í–¥ì‹ íŒŒì‹± ì „ëµ ë¹„êµ<a class="header-link" href="#103" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê¸°ëŠ¥</th>
<th>LL(1)</th>
<th>LL(k)</th>
<th>ALL(*)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ë£©ì–´í—¤ë“œ</td>
<td>1 í† í°</td>
<td>$k$ í† í°</td>
<td>ë¬´ì œí•œ</td>
</tr>
<tr>
<td>í…Œì´ë¸” í¬ê¸°</td>
<td>$O(|\Sigma|)$</td>
<td>$O(|\Sigma|^k)$</td>
<td>ë™ì  DFA</td>
</tr>
<tr>
<td>ì¢Œì¬ê·€</td>
<td>ì œê±° í•„ìš”</td>
<td>ì œê±° í•„ìš”</td>
<td>ì§ì ‘ LR ìë™ ì²˜ë¦¬</td>
</tr>
<tr>
<td>ì¢Œì¸ìˆ˜ë¶„í•´</td>
<td>í•„ìš”</td>
<td>ê²½ìš°ì— ë”°ë¼</td>
<td>ë¶ˆí•„ìš”</td>
</tr>
<tr>
<td>íŒŒì„œ ìƒì„±ê¸°</td>
<td>ì§ì ‘ ì‘ì„± / ë‹¨ìˆœ</td>
<td>ë“œë­„</td>
<td>ANTLR 4</td>
</tr>
<tr>
<td>ì˜¤ë¥˜ ë³µêµ¬</td>
<td>ìˆ˜ë™</td>
<td>ìˆ˜ë™</td>
<td>ìë™ (ANTLR)</td>
</tr>
<tr>
<td>ì„±ëŠ¥</td>
<td>$O(n)$</td>
<td>$O(n)$</td>
<td>ì¼ë°˜ì  $O(n)$, ìµœì•… $O(n^2)$</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="11">11. ëª¨ë‘ í•©ì¹˜ê¸°<a class="header-link" href="#11" title="Permanent link">&para;</a></h2>
<p>ì™„ì „í•œ íŒŒì´í”„ë¼ì¸ì„ ì‹œì—°í•˜ëŠ” ì™„ì „í•œ ë¯¸ë‹ˆ ì–¸ì–´ íŒŒì„œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Complete LL(1) Parser for a Mini-Language</span>

<span class="sd">Language syntax:</span>
<span class="sd">    Program   -&gt; StmtList</span>
<span class="sd">    StmtList  -&gt; Stmt StmtList | Îµ</span>
<span class="sd">    Stmt      -&gt; id = Expr ;</span>
<span class="sd">               | print ( Expr ) ;</span>
<span class="sd">    Expr      -&gt; Term Expr&#39;</span>
<span class="sd">    Expr&#39;     -&gt; + Term Expr&#39; | Îµ</span>
<span class="sd">    Term      -&gt; Factor Term&#39;</span>
<span class="sd">    Term&#39;     -&gt; * Factor Term&#39; | Îµ</span>
<span class="sd">    Factor    -&gt; ( Expr ) | id | num</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MiniLangParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;LL(1) parser for a mini-language with assignments and print.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="n">Grammar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_build_grammar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">compute_first</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">follow</span> <span class="o">=</span> <span class="n">compute_follow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">conflicts</span> <span class="o">=</span> <span class="n">build_ll1_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">follow</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grammar is not LL(1): </span><span class="si">{</span><span class="n">conflicts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_grammar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Program&quot;</span><span class="p">,</span>   <span class="p">[</span><span class="s2">&quot;StmtList&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;StmtList&quot;</span><span class="p">,</span>  <span class="p">[</span><span class="s2">&quot;Stmt&quot;</span><span class="p">,</span> <span class="s2">&quot;StmtList&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;StmtList&quot;</span><span class="p">,</span>  <span class="p">[</span><span class="n">EPSILON</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Stmt&quot;</span><span class="p">,</span>      <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;Expr&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Stmt&quot;</span><span class="p">,</span>      <span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;Expr&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Expr&quot;</span><span class="p">,</span>      <span class="p">[</span><span class="s2">&quot;Term&quot;</span><span class="p">,</span> <span class="s2">&quot;Expr&#39;&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Expr&#39;&quot;</span><span class="p">,</span>     <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;Term&quot;</span><span class="p">,</span> <span class="s2">&quot;Expr&#39;&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Expr&#39;&quot;</span><span class="p">,</span>     <span class="p">[</span><span class="n">EPSILON</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Term&quot;</span><span class="p">,</span>      <span class="p">[</span><span class="s2">&quot;Factor&quot;</span><span class="p">,</span> <span class="s2">&quot;Term&#39;&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Term&#39;&quot;</span><span class="p">,</span>     <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;Factor&quot;</span><span class="p">,</span> <span class="s2">&quot;Term&#39;&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Term&#39;&quot;</span><span class="p">,</span>     <span class="p">[</span><span class="n">EPSILON</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Factor&quot;</span><span class="p">,</span>    <span class="p">[</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;Expr&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Factor&quot;</span><span class="p">,</span>    <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;Factor&quot;</span><span class="p">,</span>    <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse input tokens and return the list of productions applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">LL1Parser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">mini</span> <span class="o">=</span> <span class="n">MiniLangParser</span><span class="p">()</span>

    <span class="c1"># Parse: x = 3 + 4 * 5 ; print ( x ) ;</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;print&quot;</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parsing: x = 3 + 4 * 5 ; print ( x ) ;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">90</span><span class="p">)</span>
    <span class="n">mini</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="12">12. ìš”ì•½<a class="header-link" href="#12" title="Permanent link">&para;</a></h2>
<p>í•˜í–¥ì‹ íŒŒì‹±ì€ ë£©ì–´í—¤ë“œ í† í°ê³¼ ì˜ˆì¸¡ í…Œì´ë¸”ì˜ ì•ˆë‚´ë¥¼ ë°›ì•„ ë£¨íŠ¸ì—ì„œ ì ë°©í–¥ìœ¼ë¡œ íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.</p>
<p><strong>í•µì‹¬ ê°œë…:</strong></p>
<table>
<thead>
<tr>
<th>ê°œë…</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ì¬ê·€ í•˜ê°•(Recursive descent)</strong></td>
<td>ë¹„ë‹¨ë§ë‹¹ í•˜ë‚˜ì˜ í•¨ìˆ˜; ê°€ì¥ ì§ê´€ì ì¸ íŒŒì‹± ë°©ë²•</td>
</tr>
<tr>
<td><strong>FIRST ì§‘í•©</strong></td>
<td>ë¬¸ë²• ê¸°í˜¸ì—ì„œ ìœ ë„ë˜ëŠ” ë¬¸ìì—´ì˜ ì‹œì‘ì´ ë  ìˆ˜ ìˆëŠ” ë‹¨ë§ë“¤</td>
</tr>
<tr>
<td><strong>FOLLOW ì§‘í•©</strong></td>
<td>ì„ì˜ì˜ ìœ ë„ì—ì„œ ë¹„ë‹¨ë§ ë’¤ì— ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ë‹¨ë§ë“¤</td>
</tr>
<tr>
<td><strong>LL(1) í…Œì´ë¸”</strong></td>
<td>(ë¹„ë‹¨ë§, ë‹¨ë§) ìŒì„ ìƒì„± ê·œì¹™ì— ë§¤í•‘</td>
</tr>
<tr>
<td><strong>ì¢Œì¬ê·€ ì œê±°</strong></td>
<td>í•˜í–¥ì‹ íŒŒì‹±ì— í•„ìš”; $A \to A\alpha$ íŒ¨í„´ ë³€í™˜</td>
</tr>
<tr>
<td><strong>ì¢Œì¸ìˆ˜ë¶„í•´</strong></td>
<td>ê³µí†µ ì ‘ë‘ì‚¬ë¥¼ ì¸ìˆ˜ë¶„í•´í•˜ì—¬ FIRST-FIRST ì¶©ëŒ í•´ì†Œ</td>
</tr>
<tr>
<td><strong>íŒ¨ë‹‰ ëª¨ë“œ</strong></td>
<td>ë™ê¸°í™” í† í°ê¹Œì§€ ê±´ë„ˆë›°ëŠ” ì˜¤ë¥˜ ë³µêµ¬</td>
</tr>
<tr>
<td><strong>ALL(*)</strong></td>
<td>ë¬´ì œí•œ ë£©ì–´í—¤ë“œë¥¼ ê°€ì§„ ì ì‘í˜• LL íŒŒì‹± (ANTLR 4)</td>
</tr>
</tbody>
</table>
<p><strong>í•˜í–¥ì‹ íŒŒì‹±ì„ ì‚¬ìš©í•´ì•¼ í•  ë•Œ:</strong></p>
<ul>
<li>ë¬¸ë²•ì´ ìì—°ìŠ¤ëŸ½ê²Œ LL(1)ì´ê±°ë‚˜ ê·¸ì— ê°€ê¹Œìš¸ ë•Œ</li>
<li>íŒŒì„œë¥¼ ì§ì ‘ ì‘ì„±í•˜ê³  ì‹¶ì„ ë•Œ (ì¬ê·€ í•˜ê°•)</li>
<li>ì˜¤ë¥˜ ë©”ì‹œì§€ì— ì„¸ë°€í•œ ì œì–´ê°€ í•„ìš”í•  ë•Œ</li>
<li>ANTLR 4ë¥¼ ì‚¬ìš©í•  ë•Œ (ë‚´ë¶€ì ìœ¼ë¡œ ALL(*)ë¥¼ ì‚¬ìš©)</li>
</ul>
<p><strong>í•˜í–¥ì‹ íŒŒì‹±ì„ ì‚¬ìš©í•˜ì§€ ë§ì•„ì•¼ í•  ë•Œ:</strong></p>
<ul>
<li>ì œê±°í•˜ê¸° ì–´ë ¤ìš´ ë³¸ì§ˆì  ì¢Œì¬ê·€ë¥¼ ê°€ì§„ ë¬¸ë²•</li>
<li>ìš°ì„ ìˆœìœ„ ìƒìŠ¹(precedence climbing)ì´ë‚˜ Pratt íŒŒì‹±ì´ ë” ê°„ë‹¨í•œ ì—°ì‚°ì ì¤‘ì‹¬ ì–¸ì–´</li>
<li>Yacc/Bison (LR ê¸°ë°˜) ê°™ì€ íŒŒì„œ ìƒì„±ê¸°ê°€ ì´ë¯¸ ë„êµ¬ ì²´ì¸ì— ìˆì„ ë•Œ</li>
</ul>
<hr />
<h2 id="_2">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1-first-follow">ì—°ìŠµ 1: FIRST ë° FOLLOW ì§‘í•© ê³„ì‚°<a class="header-link" href="#1-first-follow" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ë¬¸ë²•ì— ëŒ€í•œ FIRST ë° FOLLOW ì§‘í•©ì„ ê³„ì‚°í•˜ì„¸ìš”:</p>
<p>$$
\begin{aligned}
S &\to A\ B \\
A &\to a\ A \mid \varepsilon \\
B &\to b\ B \mid c
\end{aligned}
$$</p>
<p>ì œê³µëœ Python ì½”ë“œì— ë¬¸ë²•ì„ êµ¬í˜„í•˜ê³  ê³„ì‚°ì„ ì‹¤í–‰í•˜ì—¬ ë‹µì„ ê²€ì¦í•˜ì„¸ìš”.</p>
<h3 id="2-ll1">ì—°ìŠµ 2: LL(1) í…Œì´ë¸” êµ¬ì„±<a class="header-link" href="#2-ll1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ë¬¸ë²•ì´ ì£¼ì–´ì¡Œì„ ë•Œ:</p>
<p>$$
\begin{aligned}
S &\to i\ E\ t\ S\ S' \mid a \\
S' &\to e\ S \mid \varepsilon \\
E &\to b
\end{aligned}
$$</p>
<p>(ì—¬ê¸°ì„œ $i$ = <code>if</code>, $t$ = <code>then</code>, $e$ = <code>else</code>, $a$ = í• ë‹¹, $b$ = ë¶ˆë¦¬ì–¸ í‘œí˜„ì‹)</p>
<ol>
<li>FIRST ë° FOLLOW ì§‘í•©ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</li>
<li>LL(1) íŒŒì‹± í…Œì´ë¸”ì„ êµ¬ì„±í•©ë‹ˆë‹¤.</li>
<li>ì¶©ëŒì„ ì°¾ìŠµë‹ˆë‹¤. ë§¤ë‹¬ë¦° else ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ì†Œí•˜ê² ìŠµë‹ˆê¹Œ?</li>
</ol>
<h3 id="3">ì—°ìŠµ 3: ì¢Œì¬ê·€ ì œê±°<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ë¬¸ë²•ì—ì„œ ëª¨ë“  ì¢Œì¬ê·€ë¥¼ ì œê±°í•˜ì„¸ìš”:</p>
<p>$$
\begin{aligned}
S &\to A\ a \mid b \\
A &\to A\ c \mid S\ d \mid e
\end{aligned}
$$</p>
<p>$A \to S\ d$ê°€ ê°„ì ‘ ì¢Œì¬ê·€ë¥¼ ìƒì„±í•¨ì— ì£¼ëª©í•˜ì„¸ìš”. ì•Œê³ ë¦¬ì¦˜ì˜ ê° ë‹¨ê³„ë¥¼ ë³´ì´ì„¸ìš”.</p>
<h3 id="4">ì—°ìŠµ 4: ì¬ê·€ í•˜ê°• íŒŒì„œ í™•ì¥<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>2.2ì ˆì—ì„œ ì œê³µëœ ì¬ê·€ í•˜ê°• íŒŒì„œë¥¼ ë‹¤ìŒì„ ì§€ì›í•˜ë„ë¡ í™•ì¥í•˜ì„¸ìš”:</p>
<ol>
<li>ë§ì…ˆê³¼ ê°™ì€ ìš°ì„ ìˆœìœ„ì˜ ëº„ì…ˆ(<code>-</code>)</li>
<li>ê³±ì…ˆê³¼ ê°™ì€ ìš°ì„ ìˆœìœ„ì˜ ë‚˜ëˆ—ì…ˆ(<code>/</code>)</li>
<li>ë‹¨í•­ ë¶€ì •(<code>-x</code>)</li>
<li>ì •ìˆ˜ ë¦¬í„°ëŸ´ê³¼ ë³€ìˆ˜ ì´ë¦„</li>
</ol>
<p>ìˆ˜ì •ëœ ë¬¸ë²•ê³¼ í•´ë‹¹ Python ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”.</p>
<h3 id="5">ì—°ìŠµ 5: ì˜¤ë¥˜ ë³µêµ¬<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>í…Œì´ë¸” êµ¬ë™ LL(1) íŒŒì„œì— íŒ¨ë‹‰ ëª¨ë“œ ì˜¤ë¥˜ ë³µêµ¬ë¥¼ êµ¬í˜„í•˜ì„¸ìš”. êµ¬í˜„ì€ ë‹¤ìŒì„ í•´ì•¼ í•©ë‹ˆë‹¤:</p>
<ol>
<li>$M[A, a]$ê°€ ë¹„ì–´ìˆì„ ë•Œ, ìœ„ì¹˜ì™€ í•¨ê»˜ ì˜¤ë¥˜ë¥¼ ë³´ê³ í•©ë‹ˆë‹¤</li>
<li>$\text{FOLLOW}(A)$ì˜ ì›ì†Œë¥¼ ì°¾ì„ ë•Œê¹Œì§€ ì…ë ¥ í† í°ì„ ê±´ë„ˆëœë‹ˆë‹¤</li>
<li>ìŠ¤íƒì—ì„œ $A$ë¥¼ íŒí•˜ê³  íŒŒì‹±ì„ ê³„ì†í•©ë‹ˆë‹¤</li>
<li>(ì²« ë²ˆì§¸ ì˜¤ë¥˜ë§Œì´ ì•„ë‹Œ) ë°œê²¬ëœ ëª¨ë“  ì˜¤ë¥˜ë¥¼ ë³´ê³ í•©ë‹ˆë‹¤</li>
</ol>
<p>ì…ë ¥ <code>"id + * id"</code> (<code>+</code>ì™€ <code>*</code> ì‚¬ì´ì— í”¼ì—°ì‚°ì ëˆ„ë½)ë¡œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
<h3 id="6">ì—°ìŠµ 6: ë¬¸ë²• ì„¤ê³„ ë„ì „<a class="header-link" href="#6" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ì–¸ì–´ ê¸°ëŠ¥ì— ëŒ€í•œ LL(1) ë¬¸ë²•ì„ ì„¤ê³„í•˜ì„¸ìš”:</p>
<ul>
<li>ë³€ìˆ˜ ì„ ì–¸: <code>let x = expr;</code></li>
<li>í• ë‹¹: <code>x = expr;</code></li>
<li>if-else êµ¬ë¬¸: <code>if (expr) { stmts } else { stmts }</code></li>
<li>while ë£¨í”„: <code>while (expr) { stmts }</code></li>
<li>print êµ¬ë¬¸: <code>print(expr);</code></li>
<li>
<p><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>ë¥¼ ì‚¬ìš©í•œ ì‚°ìˆ  í‘œí˜„ì‹</p>
</li>
<li>
<p>ë¬¸ë²•ì„ ì‘ì„±í•©ë‹ˆë‹¤.</p>
</li>
<li>FIRST ë° FOLLOW ì§‘í•©ì„ ê³„ì‚°í•˜ì—¬ LL(1)ì¸ì§€ ê²€ì¦í•©ë‹ˆë‹¤.</li>
<li>LL(1)ì´ ì•„ë‹ˆë©´ ì¢Œì¸ìˆ˜ë¶„í•´ ë°/ë˜ëŠ” ì¢Œì¬ê·€ ì œê±°ë¥¼ ì ìš©í•©ë‹ˆë‹¤.</li>
</ul>
<hr />
<p><a href="./04_Context_Free_Grammars.md">Previous: 04_Context_Free_Grammars.md</a> | <a href="./06_Bottom_Up_Parsing.md">Next: 06_Bottom_Up_Parsing.md</a> | <a href="./00_Overview.md">Overview</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Compiler_Design/04_Context_Free_Grammars.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë ˆìŠ¨ 4: ë¬¸ë§¥ ììœ  ë¬¸ë²•</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Compiler_Design/06_Bottom_Up_Parsing.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë ˆìŠ¨ 6: ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}