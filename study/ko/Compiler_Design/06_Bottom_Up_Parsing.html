{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë ˆìŠ¨ 6: ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Compiler_Design/">Compiler Design</a>
    <span class="separator">/</span>
    <span class="current">ë ˆìŠ¨ 6: ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ë ˆìŠ¨ 6: ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Compiler_Design/05_Top_Down_Parsing.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë ˆìŠ¨ 5: í•˜í–¥ì‹ íŒŒì‹±(Top-Down Parsing)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Compiler_Design/07_Abstract_Syntax_Trees.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë ˆìŠ¨ 7: ì¶”ìƒ êµ¬ë¬¸ íŠ¸ë¦¬(Abstract Syntax Trees)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1-bottom-up-parsing">1. ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing) ì†Œê°œ</a><ul>
<li><a href="#11">1.1 ì™œ ìƒí–¥ì‹ì¸ê°€?</a></li>
</ul>
</li>
<li><a href="#2-shift-reduce-parsing">2. ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ íŒŒì‹±(Shift-Reduce Parsing)</a><ul>
<li><a href="#21">2.1 ë„¤ ê°€ì§€ ë™ì‘</a></li>
<li><a href="#22-handle">2.2 í•¸ë“¤(Handle)</a></li>
<li><a href="#23-viable-prefix">2.3 ë¹„ì–´ë¸” í”„ë¦¬í”½ìŠ¤(Viable Prefix)</a></li>
</ul>
</li>
<li><a href="#3-lr0-lr0">3. LR(0) ì•„ì´í…œê³¼ LR(0) ì˜¤í† ë§ˆí†¤</a><ul>
<li><a href="#31-lr0">3.1 LR(0) ì•„ì´í…œ</a></li>
<li><a href="#32-closure">3.2 í´ë¡œì €(Closure) ì—°ì‚°</a></li>
<li><a href="#33-goto">3.3 GOTO ì—°ì‚°</a></li>
<li><a href="#34-lr0">3.4 LR(0) ì˜¤í† ë§ˆí†¤ êµ¬ì„±</a></li>
<li><a href="#35-python">3.5 Python êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#4-slr1">4. SLR(1) íŒŒì‹±</a><ul>
<li><a href="#41-slr1">4.1 SLR(1) í…Œì´ë¸” êµ¬ì„±</a></li>
<li><a href="#42-slr1">4.2 SLR(1) íŒŒì„œ êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#5-lr1">5. ì •ê·œ LR(1) íŒŒì‹±</a><ul>
<li><a href="#51-lr1">5.1 LR(1) ì•„ì´í…œ</a></li>
<li><a href="#52-lr1">5.2 LR(1) í´ë¡œì €</a></li>
<li><a href="#53-lr1">5.3 LR(1) í…Œì´ë¸” êµ¬ì„±</a></li>
<li><a href="#54-lr1-vs-slr1">5.4 LR(1) vs SLR(1)</a></li>
<li><a href="#72-ply-python-lex-yacc">7.2 PLY (Python Lex-Yacc)</a></li>
<li><a href="#73">7.3 ê¸°íƒ€ íŒŒì„œ ìƒì„±ê¸° ë„êµ¬</a></li>
</ul>
</li>
<li><a href="#8">8. ì¶©ëŒ í•´ê²°</a><ul>
<li><a href="#81-">8.1 ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒ</a></li>
<li><a href="#82-">8.2 ë¦¬ë“€ìŠ¤-ë¦¬ë“€ìŠ¤ ì¶©ëŒ</a></li>
<li><a href="#83">8.3 ìš°ì„ ìˆœìœ„ì™€ ê²°í•©ì„± ì„ ì–¸</a></li>
<li><a href="#84-prec">8.4 %prec ì§€ì‹œì–´</a></li>
</ul>
</li>
<li><a href="#9-lr">9. LR íŒŒì„œì˜ ì˜¤ë¥˜ ë³µêµ¬</a><ul>
<li><a href="#91-panic-mode">9.1 íŒ¨ë‹‰ ëª¨ë“œ(Panic Mode)</a></li>
<li><a href="#92-error-productions">9.2 ì˜¤ë¥˜ ìƒì‚° ê·œì¹™(Error Productions)</a></li>
<li><a href="#93">9.3 êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#10">10. ê³ ê¸‰ ì£¼ì œ</a><ul>
<li><a href="#101-glr">10.1 GLR íŒŒì‹±</a></li>
<li><a href="#102-incremental-parsing">10.2 ì¦ë¶„ íŒŒì‹±(Incremental Parsing)</a></li>
<li><a href="#103-operator-precedence-parsing">10.3 ì—°ì‚°ì ìš°ì„ ìˆœìœ„ íŒŒì‹±(Operator Precedence Parsing)</a></li>
</ul>
</li>
<li><a href="#11_1">11. ìš”ì•½</a></li>
<li><a href="#_2">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-lr0">ì—°ìŠµ 1: LR(0) ì˜¤í† ë§ˆí†¤ êµ¬ì„±</a></li>
<li><a href="#2-slr1">ì—°ìŠµ 2: SLR(1) í…Œì´ë¸” êµ¬ì„±</a></li>
<li><a href="#3-slr-vs-lr1">ì—°ìŠµ 3: SLR vs LR(1)</a></li>
<li><a href="#4-ply">ì—°ìŠµ 4: PLY íŒŒì„œ</a></li>
<li><a href="#5">ì—°ìŠµ 5: ì¶©ëŒ ë¶„ì„</a></li>
<li><a href="#6">ì—°ìŠµ 6: ì˜¤ë¥˜ ë³µêµ¬</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="6-bottom-up-parsing">ë ˆìŠ¨ 6: ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing)<a class="header-link" href="#6-bottom-up-parsing" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>ì´ ë ˆìŠ¨ì„ ì™„ë£Œí•˜ë©´ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<ol>
<li><strong>ì´í•´</strong>: ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ íŒŒì‹±(Shift-Reduce Parsing)ì˜ ì›ë¦¬ì™€ ì(ë¦¬í”„)ì—ì„œ ìœ„ë¡œ íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ êµ¬ì„±í•˜ëŠ” ë°©ë²•</li>
<li><strong>ì •ì˜</strong>: í•¸ë“¤(Handle)ì´ ë¬´ì—‡ì¸ì§€ ì„¤ëª…í•˜ê³  ë¦¬ë“€ìŠ¤ ê²°ì •ì„ ìœ ë„í•˜ëŠ” ë°©ì‹ ì„¤ëª…</li>
<li><strong>êµ¬ì„±</strong>: LR(0) ì•„ì´í…œ ì§‘í•©ê³¼ í•´ë‹¹ ì˜¤í† ë§ˆí†¤(Automaton) êµ¬ì„±</li>
<li><strong>êµ¬ì¶•</strong>: SLR(1), ì •ê·œ LR(1), LALR(1) íŒŒì‹± í…Œì´ë¸” êµ¬ì¶•</li>
<li><strong>ë¹„êµ</strong>: ê° LR ë³€í˜•ì˜ ì¥ë‹¨ì  ë¹„êµ</li>
<li><strong>í™œìš©</strong>: íŒŒì„œ ìƒì„±ê¸° ë„êµ¬(Yacc, Bison, PLY) íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©</li>
<li><strong>í•´ê²°</strong>: ìš°ì„ ìˆœìœ„(Precedence)ì™€ ê²°í•©ì„±(Associativity)ì„ ì´ìš©í•œ ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤/ë¦¬ë“€ìŠ¤-ë¦¬ë“€ìŠ¤ ì¶©ëŒ í•´ê²°</li>
<li><strong>êµ¬í˜„</strong>: LR íŒŒì„œì—ì„œì˜ ì˜¤ë¥˜ ë³µêµ¬(Error Recovery) ì „ëµ êµ¬í˜„</li>
</ol>
<hr />
<h2 id="1-bottom-up-parsing">1. ìƒí–¥ì‹ íŒŒì‹±(Bottom-Up Parsing) ì†Œê°œ<a class="header-link" href="#1-bottom-up-parsing" title="Permanent link">&para;</a></h2>
<p>ìƒí–¥ì‹ íŒŒì‹±ì€ <strong>ì(ë¦¬í”„)</strong> (í„°ë¯¸ë„ ì‹¬ë³¼)ì—ì„œ <strong>ë£¨íŠ¸</strong>(ì‹œì‘ ì‹¬ë³¼)ê¹Œì§€ íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. ì„¼í…ì…œ í¼(Sentential Form)ì˜ ë¶€ë¶„ ë¬¸ìì—´ ì¤‘ ìƒì‚° ê·œì¹™ì˜ ìš°ë³€(Right-Hand Side)ê³¼ ì¼ì¹˜í•˜ëŠ” <strong>í•¸ë“¤(Handle)</strong>ì„ ë°˜ë³µì ìœ¼ë¡œ ì°¾ì•„ ë¦¬ë“€ìŠ¤(Reduce)í•©ë‹ˆë‹¤.</p>
<p>ìƒí–¥ì‹ íŒŒì‹±ì˜ ê°€ì¥ ì¼ë°˜ì ì¸ í˜•íƒœëŠ” <strong>LR íŒŒì‹±</strong>ì´ë©°, ë‹¤ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤:</p>
<ul>
<li><strong>L</strong>: ì…ë ¥ì„ <strong>L</strong>eft(ì™¼ìª½)ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ìŠ¤ìº”</li>
<li><strong>R</strong>: <strong>R</strong>ightmost(ìµœìš°ì¸¡) ìœ ë„ë¥¼ ì—­ìˆœìœ¼ë¡œ ìƒì„±</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="s">&quot;id + id * id&quot;</span><span class="err">ì—</span><span class="w"> </span><span class="err">ëŒ€í•œ</span><span class="w"> </span><span class="err">ìƒí–¥ì‹</span><span class="w"> </span><span class="err">íŒŒìŠ¤</span><span class="w"> </span><span class="err">êµ¬ì„±</span><span class="o">:</span>

<span class="n">Step</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">shift</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">F</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">T</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">F</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">shift</span><span class="w"> </span><span class="o">+</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">shift</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">F</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">F</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">9</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">shift</span><span class="w"> </span><span class="o">*</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">     </span><span class="p">(</span><span class="n">shift</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">F</span><span class="w">      </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">           </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">F</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">13</span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="w">               </span><span class="p">(</span><span class="n">reduce</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">14</span><span class="o">:</span><span class="w"> </span><span class="n">ACCEPT</span>
</code></pre></div>

<h3 id="11">1.1 ì™œ ìƒí–¥ì‹ì¸ê°€?<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ìƒí–¥ì‹ íŒŒì„œëŠ” í•˜í–¥ì‹ íŒŒì„œì— ë¹„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì¤‘ìš”í•œ ì¥ì ì´ ìˆìŠµë‹ˆë‹¤:</p>
<table>
<thead>
<tr>
<th>íŠ¹ì§•</th>
<th>í•˜í–¥ì‹(Top-Down, LL)</th>
<th>ìƒí–¥ì‹(Bottom-Up, LR)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ë¬¸ë²• í´ë˜ìŠ¤</td>
<td>LL(1) ë¶€ë¶„ì§‘í•©</td>
<td>ì‹¤ì§ˆì ìœ¼ë¡œ ëª¨ë“  CFG</td>
</tr>
<tr>
<td>ì¢Œì¬ê·€(Left Recursion)</td>
<td>ë°˜ë“œì‹œ ì œê±° í•„ìš”</td>
<td>ìì—°ìŠ¤ëŸ½ê²Œ ì²˜ë¦¬</td>
</tr>
<tr>
<td>ë£©ì–´í—¤ë“œ ê²°ì •</td>
<td>ì–´ëŠ ìƒì‚° ê·œì¹™ì„ ì˜ˆì¸¡</td>
<td>ì–¸ì œ ë¦¬ë“€ìŠ¤í• ì§€ ê²°ì •</td>
</tr>
<tr>
<td>ëª¨í˜¸ì„±(Ambiguity)</td>
<td>ì²˜ë¦¬ ì–´ë ¤ì›€</td>
<td>ìš°ì„ ìˆœìœ„ ê·œì¹™ìœ¼ë¡œ í•´ê²°</td>
</tr>
<tr>
<td>ë„êµ¬ ì§€ì›</td>
<td>ANTLR</td>
<td>Yacc, Bison, PLY, tree-sitter</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-shift-reduce-parsing">2. ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ íŒŒì‹±(Shift-Reduce Parsing)<a class="header-link" href="#2-shift-reduce-parsing" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ë„¤ ê°€ì§€ ë™ì‘<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ íŒŒì„œëŠ” ë¬¸ë²• ì‹¬ë³¼ì˜ <strong>ìŠ¤íƒ(Stack)</strong>ê³¼ <strong>ì…ë ¥ ë²„í¼(Input Buffer)</strong>ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤. ê° ë‹¨ê³„ì—ì„œ ë„¤ ê°€ì§€ ë™ì‘ ì¤‘ í•˜ë‚˜ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤:</p>
<ol>
<li><strong>ì‹œí”„íŠ¸(Shift)</strong>: ë‹¤ìŒ ì…ë ¥ ì‹¬ë³¼ì„ ìŠ¤íƒì— í‘¸ì‹œ</li>
<li><strong>ë¦¬ë“€ìŠ¤(Reduce)</strong>: ìŠ¤íƒì—ì„œ í•¸ë“¤ì„ íŒ(Pop)í•˜ê³  í•´ë‹¹ ë¹„í„°ë¯¸ë„(Nonterminal)ì„ í‘¸ì‹œ</li>
<li><strong>ìˆ˜ë½(Accept)</strong>: íŒŒì‹± ì™„ë£Œ -- ìŠ¤íƒì— ì‹œì‘ ì‹¬ë³¼ì´ ìˆê³  ì…ë ¥ì´ ë¹„ì–´ ìˆìŒ</li>
<li><strong>ì˜¤ë¥˜(Error)</strong>: ìœ íš¨í•œ ë™ì‘ ì—†ìŒ</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="err">ì‹œí”„íŠ¸</span><span class="o">-</span><span class="err">ë¦¬ë“€ìŠ¤</span><span class="w"> </span><span class="err">íŒŒì‹±</span><span class="w"> </span><span class="err">ì‹œê°í™”</span><span class="o">:</span>

<span class="w">    </span><span class="n">STACK</span><span class="w">                     </span><span class="n">INPUT</span><span class="w">                </span><span class="n">ACTION</span>
<span class="w">    </span><span class="err">â”€â”€â”€â”€â”€</span><span class="w">                     </span><span class="err">â”€â”€â”€â”€â”€</span><span class="w">                </span><span class="err">â”€â”€â”€â”€â”€â”€</span>
<span class="w">    </span><span class="err">$</span><span class="w">                         </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">       </span><span class="n">Shift</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">id</span><span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">          </span><span class="n">Reduce</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">F</span><span class="w">                       </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">          </span><span class="n">Reduce</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">F</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">T</span><span class="w">                       </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">          </span><span class="n">Reduce</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w">                       </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">          </span><span class="n">Shift</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w">                     </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">            </span><span class="n">Shift</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w">                  </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">               </span><span class="n">Reduce</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">F</span><span class="w">                   </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">               </span><span class="n">Reduce</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">F</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">                   </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">               </span><span class="n">Shift</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w">                 </span><span class="n">id</span><span class="w"> </span><span class="err">$</span><span class="w">                 </span><span class="n">Shift</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">id</span><span class="w">              </span><span class="err">$</span><span class="w">                    </span><span class="n">Reduce</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">id</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">F</span><span class="w">               </span><span class="err">$</span><span class="w">                    </span><span class="n">Reduce</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">F</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">                   </span><span class="err">$</span><span class="w">                    </span><span class="n">Reduce</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">E</span><span class="w">                       </span><span class="err">$</span><span class="w">                    </span><span class="n">Accept</span>
</code></pre></div>

<h3 id="22-handle">2.2 í•¸ë“¤(Handle)<a class="header-link" href="#22-handle" title="Permanent link">&para;</a></h3>
<p>ì˜¤ë¥¸ìª½ ì„¼í…ì…œ í¼(Right-Sentential Form) $\gamma$ì˜ <strong>í•¸ë“¤</strong>ì€ ìƒì‚° ê·œì¹™ $A \to \beta$ì™€ $\gamma$ ë‚´ì˜ ìœ„ì¹˜ë¡œì„œ, $\beta$ë¥¼ $A$ë¡œ ëŒ€ì²´í–ˆì„ ë•Œ ìµœìš°ì¸¡ ìœ ë„ì˜ ì´ì „ ì˜¤ë¥¸ìª½ ì„¼í…ì…œ í¼ì´ ìƒì„±ë©ë‹ˆë‹¤.</p>
<p><strong>í˜•ì‹ì ìœ¼ë¡œ:</strong> $S \Rightarrow^*_{rm} \alpha A w \Rightarrow_{rm} \alpha \beta w$ì´ë©´, $\alpha$ ë‹¤ìŒ ìœ„ì¹˜ì—ì„œì˜ $A \to \beta$ëŠ” $\alpha \beta w$ì˜ í•¸ë“¤ì…ë‹ˆë‹¤.</p>
<p><strong>í•µì‹¬ í†µì°°:</strong> í•¸ë“¤ì€ í•­ìƒ ìŠ¤íƒì˜ ë§¨ ìœ„ì— ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ ìƒí–¥ì‹ íŒŒì‹±ì´ ìŠ¤íƒê³¼ í•¨ê»˜ ë™ì‘í•˜ëŠ” ì´ìœ ì…ë‹ˆë‹¤ -- í•¸ë“¤ì„ ì°¾ê¸° ìœ„í•´ ìŠ¤íƒ ê¹Šìˆ™ì´ ë“¤ì—¬ë‹¤ë³¼ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
<h3 id="23-viable-prefix">2.3 ë¹„ì–´ë¸” í”„ë¦¬í”½ìŠ¤(Viable Prefix)<a class="header-link" href="#23-viable-prefix" title="Permanent link">&para;</a></h3>
<p><strong>ë¹„ì–´ë¸” í”„ë¦¬í”½ìŠ¤(Viable Prefix)</strong>ëŠ” íŒŒì‹± ìŠ¤íƒì— ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ì˜¤ë¥¸ìª½ ì„¼í…ì…œ í¼ì˜ ì„ì˜ ì ‘ë‘ì‚¬ì…ë‹ˆë‹¤. ë™ë“±í•˜ê²Œ, ìµœìš°ì¸¡ í•¸ë“¤ì˜ ì˜¤ë¥¸ìª½ ëì„ ë„˜ì–´ê°€ì§€ ì•ŠëŠ” ì ‘ë‘ì‚¬ì…ë‹ˆë‹¤.</p>
<p>ë¹„ì–´ë¸” í”„ë¦¬í”½ìŠ¤ì˜ ì§‘í•©ì€ ì •ê·œ ì–¸ì–´(Regular Language)ì´ë¯€ë¡œ ìœ í•œ ì˜¤í† ë§ˆí†¤(Finite Automaton)ìœ¼ë¡œ ì¸ì‹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì˜¤í† ë§ˆí†¤ì´ ë°”ë¡œ ë‹¤ìŒì— êµ¬ì„±í•  LR(0) ì˜¤í† ë§ˆí†¤ì…ë‹ˆë‹¤.</p>
<hr />
<h2 id="3-lr0-lr0">3. LR(0) ì•„ì´í…œê³¼ LR(0) ì˜¤í† ë§ˆí†¤<a class="header-link" href="#3-lr0-lr0" title="Permanent link">&para;</a></h2>
<h3 id="31-lr0">3.1 LR(0) ì•„ì´í…œ<a class="header-link" href="#31-lr0" title="Permanent link">&para;</a></h3>
<p><strong>LR(0) ì•„ì´í…œ</strong>(ë˜ëŠ” ê°„ë‹¨íˆ "ì•„ì´í…œ")ì€ ìš°ë³€ì˜ ì–´ëŠ ìœ„ì¹˜ì— ì (.)ì´ ìˆëŠ” ìƒì‚° ê·œì¹™ì…ë‹ˆë‹¤:</p>
<p>$$A \to \alpha \cdot \beta$$</p>
<p>ì ì€ ì§€ê¸ˆê¹Œì§€ ìƒì‚° ê·œì¹™ì˜ ì–¼ë§ˆë§Œí¼ì„ ì¸ì‹í–ˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤:</p>
<ul>
<li>$A \to \cdot \alpha\beta$: ì•„ì§ ì•„ë¬´ê²ƒë„ ë§¤ì¹­ë˜ì§€ ì•ŠìŒ</li>
<li>$A \to \alpha \cdot \beta$: $\alpha$ê°€ ë§¤ì¹­ë¨, $\beta$ê°€ ì˜ˆìƒë¨</li>
<li>$A \to \alpha\beta \cdot$: ìš°ë³€ ì „ì²´ê°€ ë§¤ì¹­ë¨ (ë¦¬ë“€ìŠ¤ ì¤€ë¹„ ì™„ë£Œ)</li>
</ul>
<p><strong>ì˜ˆì‹œ:</strong> ìƒì‚° ê·œì¹™ $E \to E + T$ëŠ” ë„¤ ê°€ì§€ ì•„ì´í…œì„ ìƒì„±í•©ë‹ˆë‹¤:</p>
<p>$$E \to \cdot E + T \qquad E \to E \cdot + T \qquad E \to E + \cdot T \qquad E \to E + T \cdot$$</p>
<h3 id="32-closure">3.2 í´ë¡œì €(Closure) ì—°ì‚°<a class="header-link" href="#32-closure" title="Permanent link">&para;</a></h3>
<p>ì•„ì´í…œ ì§‘í•©ì˜ <strong>í´ë¡œì €</strong>ëŠ” ë¹„í„°ë¯¸ë„ ì•ì— ì ì´ ìˆì„ ë•Œ ì•”ì‹œëœ ëª¨ë“  ì•„ì´í…œì„ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
<p><strong>ì•Œê³ ë¦¬ì¦˜:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">CLOSURE</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">:</span>
<span class="w">    </span><span class="kr">repeat</span><span class="o">:</span>
<span class="w">        </span><span class="n">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="p">[</span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">Î²</span><span class="p">]</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">I</span><span class="o">:</span>
<span class="w">            </span><span class="n">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î³</span><span class="o">:</span>
<span class="w">                </span><span class="n">add</span><span class="w"> </span><span class="p">[</span><span class="n">B</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="err">Î³</span><span class="p">]</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">I</span>
<span class="w">    </span><span class="n">until</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">added</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">I</span>
</code></pre></div>

<p><strong>ì§ê´€:</strong> ë‹¤ìŒì— $B$ê°€ ì˜¬ ê²ƒìœ¼ë¡œ ì˜ˆìƒí•œë‹¤ë©´(ì ì´ $B$ ì•ì— ìˆìŒ), $B$ê°€ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ê²ƒì— ëŒ€ë¹„í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<h3 id="33-goto">3.3 GOTO ì—°ì‚°<a class="header-link" href="#33-goto" title="Permanent link">&para;</a></h3>
<p><strong>GOTO</strong> í•¨ìˆ˜ëŠ” ì•„ì´í…œ ì§‘í•© ê°„ì˜ ì „ì´(Transition)ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.</p>
<p>$$\text{GOTO}(I, X) = \text{CLOSURE}(\{[A \to \alpha X \cdot \beta] \mid [A \to \alpha \cdot X \beta] \in I\})$$</p>
<p>ì¦‰, $I$ ë‚´ì˜ ëª¨ë“  ì•„ì´í…œ ì¤‘ ì ì´ ì‹¬ë³¼ $X$ ì•ì— ìˆëŠ” ê²ƒì„ ì°¾ì•„ ì ì„ $X$ ë’¤ë¡œ ì´ë™ì‹œí‚¨ í›„ í´ë¡œì €ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
<h3 id="34-lr0">3.4 LR(0) ì˜¤í† ë§ˆí†¤ êµ¬ì„±<a class="header-link" href="#34-lr0" title="Permanent link">&para;</a></h3>
<p>LR(0) ì•„ì´í…œ ì§‘í•©ì˜ ì •ê·œ ì»¬ë ‰ì…˜(Canonical Collection)ì€ ë¹„ì–´ë¸” í”„ë¦¬í”½ìŠ¤ë¥¼ ì¸ì‹í•˜ëŠ” ìœ í•œ ì˜¤í† ë§ˆí†¤ì˜ ìƒíƒœë¥¼ í˜•ì„±í•©ë‹ˆë‹¤.</p>
<p><strong>ì•Œê³ ë¦¬ì¦˜:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">ITEMS</span><span class="p">(</span><span class="n">G</span><span class="s">&#39;):</span>
<span class="s">    C = { CLOSURE({[S&#39;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">S</span><span class="p">]})</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="c1">// ì´ˆê¸° ìƒíƒœ</span>
<span class="w">    </span><span class="kr">repeat</span><span class="o">:</span>
<span class="w">        </span><span class="n">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="kt">set of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">C</span><span class="o">:</span>
<span class="w">            </span><span class="n">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">grammar</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">X</span><span class="o">:</span>
<span class="w">                </span><span class="nf">if</span><span class="w"> </span><span class="n">GOTO</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">C</span><span class="o">:</span>
<span class="w">                    </span><span class="n">add</span><span class="w"> </span><span class="n">GOTO</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">C</span>
<span class="w">    </span><span class="n">until</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">added</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">C</span>
</code></pre></div>

<h3 id="35-python">3.5 Python êµ¬í˜„<a class="header-link" href="#35-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">LR(0) Automaton Construction</span>

<span class="sd">Builds the canonical collection of LR(0) item sets, which forms</span>
<span class="sd">the basis for SLR, canonical LR, and LALR parsing table construction.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">FrozenSet</span>


<span class="n">EPSILON</span> <span class="o">=</span> <span class="s2">&quot;Îµ&quot;</span>
<span class="n">EOF</span> <span class="o">=</span> <span class="s2">&quot;$&quot;</span>
<span class="n">DOT</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>


<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Item</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An LR(0) item: a production with a dot position.</span>

<span class="sd">    Example: Item(&quot;E&quot;, (&quot;E&quot;, &quot;+&quot;, &quot;T&quot;), 1) represents E -&gt; E . + T</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lhs</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">dot</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">next_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Symbol immediately after the dot, or None if dot is at end.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">):</span>
            <span class="n">sym</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">]</span>
            <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">sym</span> <span class="o">==</span> <span class="n">EPSILON</span> <span class="k">else</span> <span class="n">sym</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if the dot is at the end (ready to reduce).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">EPSILON</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">advance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Item&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new item with the dot advanced by one position.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rhs_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rhs_list</span> <span class="o">==</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">]:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">DOT</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="n">rhs_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="n">DOT</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rhs_list</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LRAutomaton</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs the canonical collection of LR(0) item sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="s2">&quot;Grammar&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize with an augmented grammar.</span>

<span class="sd">        The grammar should already have an augmented start production</span>
<span class="sd">        S&#39; -&gt; S added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="n">grammar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">[</span><span class="n">Item</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_build</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_productions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonterminal</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all productions for a nonterminal as tuples.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nonterminal</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rhs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">closure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">Item</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">Item</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the closure of a set of items.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="n">worklist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">worklist</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">worklist</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">next_sym</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">next_symbol</span>

            <span class="k">if</span> <span class="n">next_sym</span> <span class="ow">and</span> <span class="n">next_sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_productions</span><span class="p">(</span><span class="n">next_sym</span><span class="p">):</span>
                    <span class="n">new_item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="n">next_sym</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">new_item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_item</span><span class="p">)</span>
                        <span class="n">worklist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_item</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">goto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">Item</span><span class="p">],</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">Item</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute GOTO(items, symbol).&quot;&quot;&quot;</span>
        <span class="n">moved</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">next_symbol</span> <span class="o">==</span> <span class="n">symbol</span><span class="p">:</span>
                <span class="n">moved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">advance</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">moved</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">frozenset</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">closure</span><span class="p">(</span><span class="n">moved</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build the canonical collection of LR(0) item sets.&quot;&quot;&quot;</span>
        <span class="c1"># Find the augmented start production S&#39; -&gt; S</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span>
        <span class="n">start_rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_productions</span><span class="p">(</span><span class="n">start</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">initial_item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start_rhs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">initial_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">closure</span><span class="p">({</span><span class="n">initial_item</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_state</span><span class="p">]</span>
        <span class="n">state_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">initial_state</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

        <span class="n">worklist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">all_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span>

        <span class="k">while</span> <span class="n">worklist</span><span class="p">:</span>
            <span class="n">state_idx</span> <span class="o">=</span> <span class="n">worklist</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">state_idx</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">all_symbols</span><span class="p">:</span>
                <span class="n">next_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">next_state</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">next_state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state_map</span><span class="p">:</span>
                    <span class="n">state_map</span><span class="p">[</span><span class="n">next_state</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span>
                    <span class="n">worklist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state_map</span><span class="p">[</span><span class="n">next_state</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="p">[(</span><span class="n">state_idx</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)]</span> <span class="o">=</span> <span class="n">state_map</span><span class="p">[</span><span class="n">next_state</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pretty-print all states of the automaton.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">State </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">repr</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_transitions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print all transitions.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Transitions:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">symbol</span><span class="p">),</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  State </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2"> --</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">--&gt; State </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># â”€â”€â”€ Grammar Helper â”€â”€â”€</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Grammar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Grammar representation (same as Lesson 5, augmented).&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminals</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_production</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">lhs</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">productions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">productions</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productions</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonterminals</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">lhs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_symbols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">rhs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sym</span> <span class="o">!=</span> <span class="n">EPSILON</span><span class="p">:</span>
                        <span class="n">all_symbols</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminals</span> <span class="o">=</span> <span class="n">all_symbols</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonterminals</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">augment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Grammar&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an augmented grammar with S&#39; -&gt; S.&quot;&quot;&quot;</span>
        <span class="n">aug</span> <span class="o">=</span> <span class="n">Grammar</span><span class="p">()</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="n">aug</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="n">new_start</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
                <span class="n">aug</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
        <span class="n">aug</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">aug</span>


<span class="c1"># â”€â”€â”€ Demo â”€â”€â”€</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_expression_grammar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Grammar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expression grammar:</span>
<span class="sd">        E -&gt; E + T | T</span>
<span class="sd">        T -&gt; T * F | F</span>
<span class="sd">        F -&gt; ( E ) | id</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">Grammar</span><span class="p">()</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_production</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
    <span class="n">g</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">g</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">build_expression_grammar</span><span class="p">()</span>
    <span class="n">augmented</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">augment</span><span class="p">()</span>
    <span class="n">automaton</span> <span class="o">=</span> <span class="n">LRAutomaton</span><span class="p">(</span><span class="n">augmented</span><span class="p">)</span>
    <span class="n">automaton</span><span class="o">.</span><span class="n">print_states</span><span class="p">()</span>
    <span class="n">automaton</span><span class="o">.</span><span class="n">print_transitions</span><span class="p">()</span>
</code></pre></div>

<p><strong>ì˜ˆì‹œ ì¶œë ¥ (ì¼ë¶€):</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">State</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span>
<span class="w">  </span><span class="p">[</span><span class="n">E</span><span class="s">&#39; -&gt; . E]</span>
<span class="s">  [E -&gt; . E + T]</span>
<span class="s">  [E -&gt; . T]</span>
<span class="s">  [F -&gt; . ( E )]</span>
<span class="s">  [F -&gt; . id]</span>
<span class="s">  [T -&gt; . F]</span>
<span class="s">  [T -&gt; . T * F]</span>

<span class="s">State 1:</span>
<span class="s">  [E&#39;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="p">.]</span>
<span class="w">  </span><span class="p">[</span><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">]</span>

<span class="n">State</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span>
<span class="w">  </span><span class="p">[</span><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">.]</span>
<span class="w">  </span><span class="p">[</span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">F</span><span class="p">]</span>

<span class="n">State</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span>
<span class="w">  </span><span class="p">[</span><span class="n">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="p">.]</span>

<span class="p">...</span>
</code></pre></div>

<hr />
<h2 id="4-slr1">4. SLR(1) íŒŒì‹±<a class="header-link" href="#4-slr1" title="Permanent link">&para;</a></h2>
<h3 id="41-slr1">4.1 SLR(1) í…Œì´ë¸” êµ¬ì„±<a class="header-link" href="#41-slr1" title="Permanent link">&para;</a></h3>
<p><strong>ë‹¨ìˆœ LR (SLR, Simple LR)</strong> íŒŒì‹±ì€ LR(0) ì˜¤í† ë§ˆí†¤ê³¼ FOLLOW ì§‘í•©ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì‹± í…Œì´ë¸”ì„ êµ¬ì„±í•©ë‹ˆë‹¤. ê°€ì¥ ê°„ë‹¨í•œ LR ë³€í˜•ì…ë‹ˆë‹¤.</p>
<p><strong>ì•Œê³ ë¦¬ì¦˜:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">SLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="err">í…Œì´ë¸”</span><span class="w"> </span><span class="err">êµ¬ì„±</span><span class="o">:</span>

<span class="err">ì •ê·œ</span><span class="w"> </span><span class="err">ì»¬ë ‰ì…˜ì˜</span><span class="w"> </span><span class="err">ê°</span><span class="w"> </span><span class="err">ìƒíƒœ</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ëŒ€í•´</span><span class="o">:</span>

<span class="w">  </span><span class="mf">1.</span><span class="w"> </span><span class="n">SHIFT</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">Î²</span><span class="p">]</span><span class="err">ê°€</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ìˆê³ </span><span class="w"> </span><span class="n">GOTO</span><span class="p">(</span><span class="n">I_i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I_jì´ë©´</span><span class="o">:</span>
<span class="w">       </span><span class="n">ACTION</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;shift j&quot;</span><span class="err">ë¡œ</span><span class="w"> </span><span class="err">ì„¤ì •</span>

<span class="w">  </span><span class="mf">2.</span><span class="w"> </span><span class="n">REDUCE</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="p">.]</span><span class="err">ê°€</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ìˆê³ </span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="n">S</span><span class="s">&#39;)ì´ë©´:</span>
<span class="s">       FOLLOW(A)ì˜ ê° í„°ë¯¸ë„ aì— ëŒ€í•´:</span>
<span class="s">           ACTION[i, a] = &quot;</span><span class="n">reduce</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="s">&quot;ë¡œ ì„¤ì •</span>

<span class="s">  3. ACCEPT: [S&#39;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">.]</span><span class="err">ê°€</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ìˆìœ¼ë©´</span><span class="o">:</span>
<span class="w">       </span><span class="n">ACTION</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;accept&quot;</span><span class="err">ë¡œ</span><span class="w"> </span><span class="err">ì„¤ì •</span>

<span class="w">  </span><span class="mf">4.</span><span class="w"> </span><span class="n">GOTO</span><span class="o">:</span><span class="w"> </span><span class="n">GOTO</span><span class="p">(</span><span class="n">I_i</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I_jì¸</span><span class="w"> </span><span class="err">ë¹„í„°ë¯¸ë„</span><span class="w"> </span><span class="n">Aì—</span><span class="w"> </span><span class="err">ëŒ€í•´</span><span class="o">:</span>
<span class="w">       </span><span class="n">GOTO</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jë¡œ</span><span class="w"> </span><span class="err">ì„¤ì •</span>

<span class="err">ì–´ë–¤</span><span class="w"> </span><span class="err">í•­ëª©ì´</span><span class="w"> </span><span class="err">ì¤‘ë³µ</span><span class="w"> </span><span class="err">ì •ì˜ë˜ë©´</span><span class="w"> </span><span class="err">í•´ë‹¹</span><span class="w"> </span><span class="err">ë¬¸ë²•ì€</span><span class="w"> </span><span class="n">SLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">ì´</span><span class="w"> </span><span class="err">ì•„ë‹™ë‹ˆë‹¤</span><span class="p">.</span>
</code></pre></div>

<h3 id="42-slr1">4.2 SLR(1) íŒŒì„œ êµ¬í˜„<a class="header-link" href="#42-slr1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">SLR(1) Parser Implementation</span>

<span class="sd">Constructs an SLR(1) parsing table from the LR(0) automaton</span>
<span class="sd">and FOLLOW sets, then uses it to parse input strings.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># Reuse FIRST/FOLLOW from Lesson 5 (imported or redefined)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_first</span><span class="p">(</span><span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute FIRST sets (same algorithm as Lesson 5).&quot;&quot;&quot;</span>
    <span class="n">first</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span><span class="p">:</span>
        <span class="n">first</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
        <span class="n">first</span><span class="p">[</span><span class="n">nt</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rhs</span> <span class="o">==</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">EPSILON</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">first</span><span class="p">[</span><span class="n">lhs</span><span class="p">]:</span>
                        <span class="n">first</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">EPSILON</span><span class="p">)</span>
                        <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">continue</span>
                <span class="n">all_eps</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">rhs</span><span class="p">:</span>
                    <span class="n">sf</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
                    <span class="n">additions</span> <span class="o">=</span> <span class="n">sf</span> <span class="o">-</span> <span class="p">{</span><span class="n">EPSILON</span><span class="p">}</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">additions</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">first</span><span class="p">[</span><span class="n">lhs</span><span class="p">]):</span>
                        <span class="n">first</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span> <span class="o">|=</span> <span class="n">additions</span>
                        <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">EPSILON</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sf</span><span class="p">:</span>
                        <span class="n">all_eps</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">all_eps</span> <span class="ow">and</span> <span class="n">EPSILON</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">first</span><span class="p">[</span><span class="n">lhs</span><span class="p">]:</span>
                    <span class="n">first</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">EPSILON</span><span class="p">)</span>
                    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">first</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_follow</span><span class="p">(</span>
    <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span> <span class="n">first</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute FOLLOW sets (same algorithm as Lesson 5).&quot;&quot;&quot;</span>
    <span class="n">follow</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">nt</span><span class="p">:</span> <span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">}</span>
    <span class="n">follow</span><span class="p">[</span><span class="n">grammar</span><span class="o">.</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">EOF</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">first_of_seq</span><span class="p">(</span><span class="n">symbols</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="n">sf</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">{</span><span class="n">s</span><span class="p">})</span>
            <span class="n">result</span> <span class="o">|=</span> <span class="p">(</span><span class="n">sf</span> <span class="o">-</span> <span class="p">{</span><span class="n">EPSILON</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">EPSILON</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sf</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span>
        <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">EPSILON</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rhs</span> <span class="o">==</span> <span class="p">[</span><span class="n">EPSILON</span><span class="p">]:</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sym</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rhs</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">sym</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">beta</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">if</span> <span class="n">beta</span><span class="p">:</span>
                        <span class="n">fb</span> <span class="o">=</span> <span class="n">first_of_seq</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
                        <span class="n">add</span> <span class="o">=</span> <span class="n">fb</span> <span class="o">-</span> <span class="p">{</span><span class="n">EPSILON</span><span class="p">}</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">add</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">follow</span><span class="p">[</span><span class="n">sym</span><span class="p">]):</span>
                            <span class="n">follow</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">|=</span> <span class="n">add</span>
                            <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="n">EPSILON</span> <span class="ow">in</span> <span class="n">fb</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">follow</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">follow</span><span class="p">[</span><span class="n">sym</span><span class="p">]):</span>
                                <span class="n">follow</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">|=</span> <span class="n">follow</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span>
                                <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">follow</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">follow</span><span class="p">[</span><span class="n">sym</span><span class="p">]):</span>
                            <span class="n">follow</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">|=</span> <span class="n">follow</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span>
                            <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">follow</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Action</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a parsing action.&quot;&quot;&quot;</span>
    <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span>          <span class="c1"># &quot;shift&quot;, &quot;reduce&quot;, &quot;accept&quot;</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>    <span class="c1"># target state for shift</span>
    <span class="n">lhs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>      <span class="c1"># LHS for reduce</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>    <span class="c1"># RHS for reduce</span>
    <span class="n">prod_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># production number for reduce</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;shift&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;s</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;reduce&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;r(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;accept&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;acc&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;?</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SLRParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Complete SLR(1) parser.</span>

<span class="sd">    Constructs the SLR(1) table from a grammar and uses it</span>
<span class="sd">    to parse input token streams.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original</span> <span class="o">=</span> <span class="n">grammar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">augmented</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">augment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">automaton</span> <span class="o">=</span> <span class="n">LRAutomaton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="p">)</span>

        <span class="c1"># Compute FIRST and FOLLOW on the augmented grammar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">compute_first</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">follow</span> <span class="o">=</span> <span class="n">compute_follow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>

        <span class="c1"># Number productions for reduce actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prod_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prod_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lhs</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span>

        <span class="c1"># Build the ACTION and GOTO tables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Action</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_build_tables</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_prod_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the production number for a given production.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prod_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">lhs</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">i</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set an action, detecting conflicts.&quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="p">:</span>
            <span class="n">existing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="n">existing</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
                <span class="n">conflict_type</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;shift-reduce&quot;</span>
                    <span class="k">if</span> <span class="p">{</span><span class="n">existing</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span><span class="p">}</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;shift&quot;</span><span class="p">,</span> <span class="s2">&quot;reduce&quot;</span><span class="p">}</span>
                    <span class="k">else</span> <span class="s2">&quot;reduce-reduce&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conflict_type</span><span class="si">}</span><span class="s2"> conflict in state </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;on &#39;</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">existing</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="c1"># Default resolution: prefer shift over reduce</span>
                <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;shift&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">action</span>
                <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">action</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build the SLR(1) ACTION and GOTO tables.&quot;&quot;&quot;</span>
        <span class="n">start_nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="o">.</span><span class="n">start</span>  <span class="c1"># S&#39;</span>
        <span class="n">original_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original</span><span class="o">.</span><span class="n">start</span>  <span class="c1"># S</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automaton</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
                <span class="n">next_sym</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">next_symbol</span>

                <span class="k">if</span> <span class="n">next_sym</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Dot is before a symbol</span>
                    <span class="k">if</span> <span class="n">next_sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="o">.</span><span class="n">terminals</span><span class="p">:</span>
                        <span class="c1"># SHIFT</span>
                        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">automaton</span><span class="o">.</span><span class="n">goto_table</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">next_sym</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_set_action</span><span class="p">(</span>
                                <span class="n">i</span><span class="p">,</span> <span class="n">next_sym</span><span class="p">,</span>
                                <span class="n">Action</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
                            <span class="p">)</span>
                    <span class="k">elif</span> <span class="n">next_sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
                        <span class="c1"># GOTO</span>
                        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">automaton</span><span class="o">.</span><span class="n">goto_table</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">next_sym</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">next_sym</span><span class="p">)]</span> <span class="o">=</span> <span class="n">target</span>

                <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">is_reduce</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">lhs</span> <span class="o">==</span> <span class="n">start_nt</span><span class="p">:</span>
                        <span class="c1"># ACCEPT: S&#39; -&gt; S .</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_set_action</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">EOF</span><span class="p">,</span> <span class="n">Action</span><span class="p">(</span><span class="s2">&quot;accept&quot;</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># REDUCE: A -&gt; Î± .</span>
                        <span class="n">prod_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_prod_num</span><span class="p">(</span>
                            <span class="n">item</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">rhs</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="n">terminal</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">follow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="nb">set</span><span class="p">()):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_set_action</span><span class="p">(</span>
                                <span class="n">i</span><span class="p">,</span> <span class="n">terminal</span><span class="p">,</span>
                                <span class="n">Action</span><span class="p">(</span>
                                    <span class="s2">&quot;reduce&quot;</span><span class="p">,</span>
                                    <span class="n">lhs</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span>
                                    <span class="n">rhs</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span>
                                    <span class="n">prod_num</span><span class="o">=</span><span class="n">prod_num</span><span class="p">,</span>
                                <span class="p">)</span>
                            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a list of terminal symbols.</span>

<span class="sd">        Args:</span>
<span class="sd">            tokens: list of terminal symbols (without $)</span>
<span class="sd">            verbose: if True, print each step</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if accepted, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_syms</span> <span class="o">=</span> <span class="n">tokens</span> <span class="o">+</span> <span class="p">[</span><span class="n">EOF</span><span class="p">]</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Stack holds alternating states and symbols:</span>
        <span class="c1"># [state0, sym1, state1, sym2, state2, ...]</span>
        <span class="c1"># We use a simpler model: stack of states, separate symbol stack</span>
        <span class="n">state_stack</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">symbol_stack</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Step&#39;</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="s1">&#39;Stack&#39;</span><span class="si">:</span><span class="s2">&lt;35</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Input&#39;</span><span class="si">:</span><span class="s2">&lt;25</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Action&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">95</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">state_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">input_syms</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">stack_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">symbol_stack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">symbol_stack</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state_stack</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">input_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_syms</span><span class="p">[</span><span class="n">ip</span><span class="p">:])</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">step</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">stack_str</span><span class="si">:</span><span class="s2">&lt;35</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">input_str</span><span class="si">:</span><span class="s2">&lt;25</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">state</span><span class="p">,</span> <span class="n">current</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: no action for state </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;shift&quot;</span><span class="p">:</span>
                <span class="n">symbol_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="n">state_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
                <span class="n">ip</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shift </span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;reduce&quot;</span><span class="p">:</span>
                <span class="n">rhs_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">rhs</span> <span class="o">==</span> <span class="p">(</span><span class="n">EPSILON</span><span class="p">,):</span>
                    <span class="n">rhs_len</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="c1"># Pop |rhs| symbols and states</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rhs_len</span><span class="p">):</span>
                    <span class="n">state_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">symbol_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

                <span class="c1"># Push LHS</span>
                <span class="n">symbol_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
                <span class="n">goto_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">state_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">action</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">goto_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;ERROR: no GOTO for state &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">lhs</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                        <span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="n">state_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goto_state</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Reduce </span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">lhs</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

            <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;accept&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ACCEPT&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: too many steps&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pretty-print the ACTION and GOTO tables.&quot;&quot;&quot;</span>
        <span class="n">terminals</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="o">.</span><span class="n">terminals</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">EOF</span><span class="p">]</span>
        <span class="n">nonterminals</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="o">.</span><span class="n">nonterminals</span> <span class="o">-</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">augmented</span><span class="o">.</span><span class="n">start</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="n">col_w</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;State&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">col_w</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminals</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot; |&quot;</span>
        <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nt</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">col_w</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="n">nonterminals</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automaton</span><span class="o">.</span><span class="n">states</span><span class="p">)):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminals</span><span class="p">:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="k">if</span> <span class="n">action</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cell</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">col_w</span><span class="si">}}</span><span class="s2">&quot;</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="s2">&quot; |&quot;</span>
            <span class="k">for</span> <span class="n">nt</span> <span class="ow">in</span> <span class="n">nonterminals</span><span class="p">:</span>
                <span class="n">goto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">nt</span><span class="p">))</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">goto</span><span class="p">)</span> <span class="k">if</span> <span class="n">goto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cell</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">col_w</span><span class="si">}}</span><span class="s2">&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>


<span class="c1"># â”€â”€â”€ Demo â”€â”€â”€</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="n">build_expression_grammar</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Grammar:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_list</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">productions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">rhs_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">lhs</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">SLRParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">parser</span><span class="o">.</span><span class="n">conflicts</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conflicts found:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">conflicts</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No conflicts -- grammar is SLR(1)!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SLR(1) Parsing Table:&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">print_tables</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Parse some inputs</span>
    <span class="n">test_cases</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">([</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">([</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">([</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">],</span> <span class="kc">False</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="n">test_cases</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">95</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">95</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;ACCEPTED&quot;</span> <span class="k">if</span> <span class="n">result</span> <span class="k">else</span> <span class="s2">&quot;REJECTED&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
</code></pre></div>

<hr />
<h2 id="5-lr1">5. ì •ê·œ LR(1) íŒŒì‹±<a class="header-link" href="#5-lr1" title="Permanent link">&para;</a></h2>
<h3 id="51-lr1">5.1 LR(1) ì•„ì´í…œ<a class="header-link" href="#51-lr1" title="Permanent link">&para;</a></h3>
<p><strong>LR(1) ì•„ì´í…œ</strong>ì€ LR(0) ì•„ì´í…œì— <strong>ë£©ì–´í—¤ë“œ(Lookahead)</strong> í„°ë¯¸ë„ì„ ì¶”ê°€í•œ ê²ƒì…ë‹ˆë‹¤:</p>
<p>$$[A \to \alpha \cdot \beta, a]$$</p>
<p>ì´ëŠ” "í˜„ì¬ $A \to \alpha\beta$ë¥¼ ì¸ì‹í•˜ëŠ” ì¤‘ì´ë©°, $\alpha$ë¥¼ ë§¤ì¹­í–ˆê³ , ë¦¬ë“€ìŠ¤ë¥¼ ì™„ë£Œí•˜ë©´ ë‹¤ìŒ ì…ë ¥ ì‹¬ë³¼ì´ $a$ì—¬ì•¼ í•œë‹¤"ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p>
<p>ë£©ì–´í—¤ë“œëŠ” ì ì´ ëì— ë„ë‹¬í–ˆì„ ë•Œ(ë¦¬ë“€ìŠ¤ ê²°ì •ì„ ìœ„í•´)ë§Œ ì‚¬ìš©ë˜ë©°, ì‹œí”„íŠ¸ ê²°ì •ì€ LR(0)ê³¼ ë™ì¼í•©ë‹ˆë‹¤.</p>
<h3 id="52-lr1">5.2 LR(1) í´ë¡œì €<a class="header-link" href="#52-lr1" title="Permanent link">&para;</a></h3>
<p>LR(1) í´ë¡œì €ëŠ” ë£©ì–´í—¤ë“œë¥¼ ì „íŒŒí•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="n">CLOSURE</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">:</span>
<span class="w">    </span><span class="kr">repeat</span><span class="o">:</span>
<span class="w">        </span><span class="n">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="p">[</span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">Î²</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">I</span><span class="o">:</span>
<span class="w">            </span><span class="n">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î³</span><span class="o">:</span>
<span class="w">                </span><span class="n">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="kr">FIRST</span><span class="p">(</span><span class="err">Î²</span><span class="n">a</span><span class="p">)</span><span class="o">:</span>
<span class="w">                    </span><span class="n">add</span><span class="w"> </span><span class="p">[</span><span class="n">B</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="err">Î³</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">I</span>
<span class="w">    </span><span class="n">until</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">added</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">I</span>
</code></pre></div>

<p>LR(0) í´ë¡œì €ì™€ì˜ í•µì‹¬ ì°¨ì´ëŠ” ë£©ì–´í—¤ë“œ ì§‘í•© $\text{FIRST}(\beta a)$ì˜ ê³„ì‚°ì…ë‹ˆë‹¤. ì´ê²ƒì´ íŒŒì„œë¥¼ í†µí•´ ë¬¸ë§¥ì´ í˜ëŸ¬ê°€ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.</p>
<h3 id="53-lr1">5.3 LR(1) í…Œì´ë¸” êµ¬ì„±<a class="header-link" href="#53-lr1" title="Permanent link">&para;</a></h3>
<p>í…Œì´ë¸” êµ¬ì„±ì€ SLR(1)ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ, ë¦¬ë“€ìŠ¤ ë™ì‘ì— FOLLOW ì§‘í•© ëŒ€ì‹  ì•„ì´í…œë³„ ë£©ì–´í—¤ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="err">ê°</span><span class="w"> </span><span class="err">ìƒíƒœ</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ëŒ€í•´</span><span class="o">:</span>
<span class="w">  </span><span class="n">SHIFT</span><span class="o">:</span><span class="w">  </span><span class="p">[</span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">Î²</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span><span class="err">ê°€</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ìˆê³ </span><span class="w"> </span><span class="n">GOTO</span><span class="p">(</span><span class="n">I_i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I_jì´ë©´</span><span class="o">:</span>
<span class="w">              </span><span class="n">ACTION</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;shift j&quot;</span>

<span class="w">  </span><span class="n">REDUCE</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="p">.,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="err">ê°€</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ìˆê³ </span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="err">â‰ </span><span class="w"> </span><span class="n">S</span><span class="s">&#39;)ì´ë©´:</span>
<span class="s">              ACTION[i, a] = &quot;</span><span class="n">reduce</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="s">&quot;</span>
<span class="s">              (FOLLOW(A) ì „ì²´ê°€ ì•„ë‹Œ ë£©ì–´í—¤ë“œ &#39;</span><span class="n">a</span><span class="s">&#39;ì—ë§Œ ì ìš©)</span>

<span class="s">  ACCEPT: [S&#39;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">.,</span><span class="w"> </span><span class="err">$</span><span class="p">]</span><span class="err">ê°€</span><span class="w"> </span><span class="n">I_iì—</span><span class="w"> </span><span class="err">ìˆìœ¼ë©´</span><span class="o">:</span>
<span class="w">              </span><span class="n">ACTION</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;accept&quot;</span>
</code></pre></div>

<h3 id="54-lr1-vs-slr1">5.4 LR(1) vs SLR(1)<a class="header-link" href="#54-lr1-vs-slr1" title="Permanent link">&para;</a></h3>
<p>LR(1)ì˜ í•µì‹¬ ì¥ì ì€ ë¦¬ë“€ìŠ¤ ë™ì‘ì˜ ì •ë°€ë„ì…ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="n">SLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="w">  </span><span class="n">FOLLOW</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="err">ì˜</span><span class="w"> </span><span class="err">ëª¨ë“ </span><span class="w"> </span><span class="err">í„°ë¯¸ë„ì—ì„œ</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="err">ë¦¬ë“€ìŠ¤</span>
<span class="n">LR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="w">   </span><span class="err">íŠ¹ì •</span><span class="w"> </span><span class="err">ë£©ì–´í—¤ë“œ</span><span class="w"> </span><span class="err">í„°ë¯¸ë„ì—ì„œë§Œ</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">Î±</span><span class="w"> </span><span class="err">ë¦¬ë“€ìŠ¤</span>

<span class="err">ì¦‰</span><span class="p">,</span><span class="w"> </span><span class="n">LR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">ì€</span><span class="w"> </span><span class="n">SLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">ì´</span><span class="w"> </span><span class="err">ì²˜ë¦¬í• </span><span class="w"> </span><span class="err">ìˆ˜</span><span class="w"> </span><span class="err">ì—†ëŠ”</span><span class="w"> </span><span class="err">ë¬¸ë²•ì„</span><span class="w"> </span><span class="err">ì²˜ë¦¬í• </span><span class="w"> </span><span class="err">ìˆ˜</span><span class="w"> </span><span class="err">ìˆìŠµë‹ˆë‹¤</span><span class="p">.</span>
</code></pre></div>

<p><strong>SLR(1)ì€ ì‹¤íŒ¨í•˜ì§€ë§Œ LR(1)ì€ ë™ì‘í•˜ëŠ” ì˜ˆì‹œ:</strong></p>
<p>$$
\begin{aligned}
S &\to L = R \mid R \\
L &\to * R \mid \textbf{id} \\
R &\to L
\end{aligned}
$$</p>
<p>SLR(1)ì—ì„œëŠ” $[R \to L \cdot]$ê³¼ $[S \to L \cdot = R]$ì„ í¬í•¨í•˜ëŠ” ìƒíƒœì—ì„œ ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒì´ ë°œìƒí•©ë‹ˆë‹¤. $=$ê°€ $\text{FOLLOW}(R)$ì— ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. LR(1)ì—ì„œëŠ” ì•„ì´í…œ $[R \to L \cdot, \$]$ì˜ ë£©ì–´í—¤ë“œê°€ $=$ê°€ ì•„ë‹Œ $\$$ì´ë¯€ë¡œ ì¶©ëŒì´ ì—†ìŠµë‹ˆë‹¤.

### 5.5 ì‹¤ìš©ì  ê³ ë ¤ì‚¬í•­: í…Œì´ë¸” í¬ê¸°

ì •ê·œ LR(1)ì˜ ì£¼ìš” ë‹¨ì ì€ ì˜¤í† ë§ˆí†¤ì˜ í¬ê¸°ì…ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ë£©ì–´í—¤ë“œë¥¼ ê°€ì§„ ì•„ì´í…œì´ ë¶„ë¦¬ë˜ì–´ ìœ ì§€ë˜ë¯€ë¡œ LR(1) ìƒíƒœì˜ ìˆ˜ê°€ LR(0) ìƒíƒœë³´ë‹¤ í›¨ì”¬ ë§ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ì¸ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ë¬¸ë²•ì˜ ê²½ìš° LR(1) í…Œì´ë¸”ì€ ìˆ˜ì²œ ê°œì˜ ìƒíƒœë¥¼ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ë°˜ë©´, LR(0)/SLRì€ ìˆ˜ë°± ê°œì…ë‹ˆë‹¤.

---

## 6. LALR(1) íŒŒì‹±

### 6.1 ë™ê¸°

**LALR(1)** (Look-Ahead LR)ì€ SLR(1)ê³¼ ì •ê·œ LR(1) ì‚¬ì´ì˜ ì‹¤ìš©ì ì¸ ì ˆì¶©ì•ˆì…ë‹ˆë‹¤:

- **SLR(1)ë³´ë‹¤ ê°•ë ¥**: ë¬¸ë§¥ ë¯¼ê° ë£©ì–´í—¤ë“œ ì‚¬ìš©
- **SLR(1)ê³¼ ë™ì¼í•œ ìƒíƒœ ìˆ˜**: ë™ì¼í•œ ì½”ì–´(Core)ë¥¼ ê°€ì§„ LR(1) ìƒíƒœ ë³‘í•©
- **LR(1)ì— ê±°ì˜ ê·¼ì ‘**: ì‹¤ìš©ì ì¸ ë¬¸ë²• ì¤‘ LR(1)ì´ì§€ë§Œ LALR(1)ì´ ì•„ë‹Œ ê²½ìš°ëŠ” ë§¤ìš° ë“œë­„

### 6.2 ë³‘í•©ì„ í†µí•œ êµ¬ì„±

LALR(1) ìƒíƒœëŠ” ë™ì¼í•œ **ì½”ì–´**(ë£©ì–´í—¤ë“œë¥¼ ë¬´ì‹œí•œ ë™ì¼í•œ LR(0) ì•„ì´í…œ ì§‘í•©)ë¥¼ ê°€ì§„ LR(1) ìƒíƒœë¥¼ ë³‘í•©í•˜ì—¬ ìƒì„±ë©ë‹ˆë‹¤. ë£©ì–´í—¤ë“œ ì§‘í•©ì€ í•©ì§‘í•©(Union)ìœ¼ë¡œ ë³‘í•©ë©ë‹ˆë‹¤.

 CODE11 

### 6.3 ìƒˆë¡œìš´ ì¶©ëŒ ê°€ëŠ¥ì„±

ë³‘í•©ì€ ì •ê·œ LR(1) í…Œì´ë¸”ì— ì—†ì—ˆë˜ **ë¦¬ë“€ìŠ¤-ë¦¬ë“€ìŠ¤ ì¶©ëŒ**ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì½”ì–´ê°€ ì‹œí”„íŠ¸ ë™ì‘ì„ ê²°ì •í•˜ë¯€ë¡œ ìƒˆë¡œìš´ ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒì€ **ë°œìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤**.

 CODE12 

ì‹¤ì œë¡œ ì´ ìƒí™©ì€ ì‹¤ì œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ë¬¸ë²•ì—ì„œ ë§¤ìš° ë“œë­…ë‹ˆë‹¤.

### 6.4 LR ë³€í˜• ë¹„êµ

 CODE13 

| ë³€í˜• | ë¦¬ë“€ìŠ¤ ê²°ì • | ìƒíƒœ ìˆ˜ | í‘œí˜„ë ¥ | ë„êµ¬ |
|------|------------|---------|--------|------|
| LR(0) | í•­ìƒ ë¦¬ë“€ìŠ¤ (ë£©ì–´í—¤ë“œ ì—†ìŒ) | ìµœì†Œ | ê°€ì¥ ì•½í•¨ | ì´ë¡ ì  |
| SLR(1) | FOLLOW ì§‘í•© | LR(0)ê³¼ ë™ì¼ | ì–‘í˜¸ | ê°„ë‹¨í•œ ìƒì„±ê¸° |
| LALR(1) | ë³‘í•©ëœ LR(1) ë£©ì–´í—¤ë“œ | LR(0)ê³¼ ë™ì¼ | ë§¤ìš° ì–‘í˜¸ | Yacc, Bison, PLY |
| LR(1) | ì •í™•í•œ LR(1) ë£©ì–´í—¤ë“œ | í›¨ì”¬ í´ ìˆ˜ ìˆìŒ | ìµœê³  | ì§ì ‘ ì‚¬ìš© ë“œë­„ |

---

## 7. íŒŒì„œ ìƒì„±ê¸° ë„êµ¬

### 7.1 Yaccì™€ Bison

**Yacc**(Yet Another Compiler Compiler)ëŠ” í´ë˜ì‹ ìœ ë‹‰ìŠ¤ íŒŒì„œ ìƒì„±ê¸°ì…ë‹ˆë‹¤. **Bison**ì€ GNU ë²„ì „ì…ë‹ˆë‹¤. ë‘˜ ë‹¤ ë¬¸ë²• ëª…ì„¸ì„œë¡œë¶€í„° LALR(1) íŒŒì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

**Yacc/Bison ë¬¸ë²• í˜•ì‹:**

 CODE14 

ì£¼ìš” ê¸°ëŠ¥:
- **`%left`, `%right`, `%nonassoc`**: ì—°ì‚°ì ìš°ì„ ìˆœìœ„(Precedence)ì™€ ê²°í•©ì„±(Associativity) ì„ ì–¸
- **`$$<code>**: LHS ì‹¬ë³¼ì˜ ê°’ (ê²°ê³¼)
- **</code>$1`, `$2<code>,</code>$3<code>, ...**: RHS ì‹¬ë³¼ë“¤ì˜ ê°’
- **</code>%prec`**: íŠ¹ì • ê·œì¹™ì˜ ê¸°ë³¸ ìš°ì„ ìˆœìœ„ ì¬ì •ì˜</p>
<h3 id="72-ply-python-lex-yacc">7.2 PLY (Python Lex-Yacc)<a class="header-link" href="#72-ply-python-lex-yacc" title="Permanent link">&para;</a></h3>
<p><strong>PLY</strong>ëŠ” Lexì™€ Yaccì˜ Python êµ¬í˜„ì²´ì…ë‹ˆë‹¤. LALR(1) íŒŒì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PLY Example: Expression Parser</span>

<span class="sd">PLY (Python Lex-Yacc) provides lex and yacc functionality for Python.</span>
<span class="sd">Install with: pip install ply</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># â”€â”€â”€ Lexer â”€â”€â”€</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ply.lex</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lex</span>

<span class="n">tokens</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NUM&#39;</span><span class="p">,</span> <span class="s1">&#39;PLUS&#39;</span><span class="p">,</span> <span class="s1">&#39;TIMES&#39;</span><span class="p">,</span> <span class="s1">&#39;LPAREN&#39;</span><span class="p">,</span> <span class="s1">&#39;RPAREN&#39;</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span><span class="p">)</span>

<span class="n">t_PLUS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\+&#39;</span>
<span class="n">t_TIMES</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\*&#39;</span>
<span class="n">t_LPAREN</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\(&#39;</span>
<span class="n">t_RPAREN</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\)&#39;</span>
<span class="n">t_ID</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[a-zA-Z_][a-zA-Z0-9_]*&#39;</span>
<span class="n">t_ignore</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_NUM</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sa">r</span><span class="s1">&#39;\d+&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span><span class="w"> </span><span class="nf">t_error</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Illegal character &#39;</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">lexer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">lexer</span> <span class="o">=</span> <span class="n">lex</span><span class="o">.</span><span class="n">lex</span><span class="p">()</span>


<span class="c1"># â”€â”€â”€ Parser â”€â”€â”€</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ply.yacc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yacc</span>

<span class="c1"># Precedence (lowest to highest)</span>
<span class="n">precedence</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;PLUS&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;TIMES&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">p_expr_binop</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;expr : expr PLUS expr</span>
<span class="sd">            | expr TIMES expr&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">p_expr_group</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;expr : LPAREN expr RPAREN&#39;&#39;&#39;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">p_expr_num</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;expr : NUM&#39;&#39;&#39;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">p_expr_id</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;expr : ID&#39;&#39;&#39;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">p_error</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Syntax error at &#39;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Syntax error at end of input&quot;</span><span class="p">)</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">yacc</span><span class="o">.</span><span class="n">yacc</span><span class="p">()</span>


<span class="c1"># â”€â”€â”€ Usage â”€â”€â”€</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_inputs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;3 + 4 * 5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;(a + b) * c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x + y + z&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">test_inputs</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">:</span><span class="s2">20s</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>ì¶œë ¥:</strong></p>
<div class="highlight"><pre><span></span><code><span class="mf">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">5</span><span class="w">            </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">add</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">num</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">mul</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">num</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">num</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">)))</span>
<span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w">          </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">mul</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">add</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">a</span><span class="err">&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">b</span><span class="err">&#39;</span><span class="p">)),</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">c</span><span class="err">&#39;</span><span class="p">))</span>
<span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w">            </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">add</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">add</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">x</span><span class="err">&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">y</span><span class="err">&#39;</span><span class="p">)),</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">z</span><span class="err">&#39;</span><span class="p">))</span>
</code></pre></div>

<h3 id="73">7.3 ê¸°íƒ€ íŒŒì„œ ìƒì„±ê¸° ë„êµ¬<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ë„êµ¬</th>
<th>ì–¸ì–´</th>
<th>íŒŒì„œ ìœ í˜•</th>
<th>ì£¼ìš” íŠ¹ì§•</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Yacc/Bison</strong></td>
<td>C/C++</td>
<td>LALR(1)</td>
<td>ì—…ê³„ í‘œì¤€</td>
</tr>
<tr>
<td><strong>PLY</strong></td>
<td>Python</td>
<td>LALR(1)</td>
<td>Pythonì‹ Yacc</td>
</tr>
<tr>
<td><strong>Lark</strong></td>
<td>Python</td>
<td>Earley/LALR</td>
<td>ìš°ì•„í•œ EBNF ë¬¸ë²•</td>
</tr>
<tr>
<td><strong>ANTLR</strong></td>
<td>Java/Python/...</td>
<td>ALL(*)</td>
<td>ê°€ì¥ ê°•ë ¥í•œ LL</td>
</tr>
<tr>
<td><strong>tree-sitter</strong></td>
<td>C (ë°”ì¸ë”© í¬í•¨)</td>
<td>GLR</td>
<td>ì¦ë¶„ì‹(Incremental), ì˜¤ë¥˜ í—ˆìš©</td>
</tr>
<tr>
<td><strong>Menhir</strong></td>
<td>OCaml</td>
<td>LR(1)</td>
<td>LALRì´ ì•„ë‹Œ ì™„ì „í•œ LR(1)</td>
</tr>
<tr>
<td><strong>Happy</strong></td>
<td>Haskell</td>
<td>LALR(1)</td>
<td>ëª¨ë‚˜ë”• íŒŒì„œ ë™ì‘</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="8">8. ì¶©ëŒ í•´ê²°<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81-">8.1 ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒ<a class="header-link" href="#81-" title="Permanent link">&para;</a></h3>
<p><strong>ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒ</strong>ì€ íŒŒì„œê°€ ë‹¤ìŒ ì…ë ¥ ì‹¬ë³¼ì„ ì‹œí”„íŠ¸í•˜ê±°ë‚˜ ìŠ¤íƒì˜ í•¸ë“¤ì„ ë¦¬ë“€ìŠ¤í•  ìˆ˜ ìˆì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤.</p>
<p><strong>ì „í˜•ì ì¸ ì˜ˆì‹œ: ëŒ•ê¸€ë§ else(Dangling Else).</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">stmt</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IF</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="n">THEN</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="n">ELSE</span><span class="w"> </span><span class="n">stmt</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">IF</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="n">THEN</span><span class="w"> </span><span class="n">stmt</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">other</span>
<span class="w">     </span><span class="o">;</span>
</code></pre></div>

<p>íŒŒì„œê°€ ë£©ì–´í—¤ë“œ <code>ELSE</code>ë¡œ <code>IF expr THEN stmt</code>ë¥¼ ì¸ì‹í•  ë•Œ:
- <strong>ì‹œí”„íŠ¸</strong> <code>ELSE</code> (ì´ <code>if</code>ì™€ <code>else</code> ì—°ê²°)
- <strong>ë¦¬ë“€ìŠ¤</strong> <code>stmt -&gt; IF expr THEN stmt</code> (ì™¸ë¶€ <code>if</code>ì™€ <code>else</code> ì—°ê²°)</p>
<p><strong>í•´ê²°:</strong> ëŒ€ë¶€ë¶„ì˜ íŒŒì„œ ìƒì„±ê¸°ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ <strong>ì‹œí”„íŠ¸</strong>ë¥¼ ì„ íƒí•©ë‹ˆë‹¤ (<code>else</code>ë¥¼ ê°€ì¥ ê°€ê¹Œìš´ <code>if</code>ì™€ ì—°ê²°). ì´ê²ƒì´ ì‚¬ì‹¤ìƒ ëª¨ë“  í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œ ì˜¬ë°”ë¥¸ ë™ì‘ì…ë‹ˆë‹¤.</p>
<h3 id="82-">8.2 ë¦¬ë“€ìŠ¤-ë¦¬ë“€ìŠ¤ ì¶©ëŒ<a class="header-link" href="#82-" title="Permanent link">&para;</a></h3>
<p><strong>ë¦¬ë“€ìŠ¤-ë¦¬ë“€ìŠ¤ ì¶©ëŒ</strong>ì€ íŒŒì„œê°€ ë‘ ê°€ì§€ ë‹¤ë¥¸ ìƒì‚° ê·œì¹™ìœ¼ë¡œ ë¦¬ë“€ìŠ¤í•  ìˆ˜ ìˆì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="n">stmt</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="s1">&#39;(&#39;</span><span class="w"> </span><span class="n">expr_list</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="w">    </span><span class="c1">// í•¨ìˆ˜ í˜¸ì¶œ</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="s1">&#39;(&#39;</span><span class="w"> </span><span class="n">expr_list</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="w">    </span><span class="c1">// ë°°ì—´ ì„œë¸ŒìŠ¤í¬ë¦½íŠ¸ (ê°€ìƒ)</span>
<span class="w">     </span><span class="o">;</span>
</code></pre></div>

<p><strong>í•´ê²° ì „ëµ:</strong>
- ëª¨í˜¸ì„±ì„ ì œê±°í•˜ë„ë¡ ë¬¸ë²• ì¬ì‘ì„±
- Yacc/Bisonì—ì„œëŠ” ë¨¼ì € ë‚˜ì—´ëœ ìƒì‚° ê·œì¹™ì´ ìš°ì„ 
- ì˜ë¯¸ ë¶„ì„(Semantic Analysis)ì„ í†µí•´ ê²½ìš°ë¥¼ êµ¬ë¶„ (íŒŒì‹± ìˆ˜ì¤€ì´ ì•„ë‹Œ)</p>
<h3 id="83">8.3 ìš°ì„ ìˆœìœ„ì™€ ê²°í•©ì„± ì„ ì–¸<a class="header-link" href="#83" title="Permanent link">&para;</a></h3>
<p>íŒŒì„œ ìƒì„±ê¸°ëŠ” í‘œí˜„ì‹ ë¬¸ë²•ì—ì„œ ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒì„ ì²´ê³„ì ìœ¼ë¡œ í•´ê²°í•˜ê¸° ìœ„í•´ <strong>ìš°ì„ ìˆœìœ„</strong>ì™€ <strong>ê²°í•©ì„±</strong> ì„ ì–¸ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* ìš°ì„ ìˆœìœ„: ë‚®ì€ ê²ƒë¶€í„° */</span>
<span class="nf">%right</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w">                  </span><span class="cm">/* ëŒ€ì…: ìš°ê²°í•© */</span>
<span class="nf">%left</span><span class="w"> </span><span class="n">OR</span><span class="w">                    </span><span class="cm">/* ë…¼ë¦¬ OR */</span>
<span class="nf">%left</span><span class="w"> </span><span class="n">AND</span><span class="w">                   </span><span class="cm">/* ë…¼ë¦¬ AND */</span>
<span class="nf">%left</span><span class="w"> </span><span class="n">EQ</span><span class="w"> </span><span class="n">NE</span><span class="w">                 </span><span class="cm">/* ë™ë“± ë¹„êµ */</span>
<span class="nf">%left</span><span class="w"> </span><span class="sc">&#39;&lt;&#39;</span><span class="w"> </span><span class="sc">&#39;&gt;&#39;</span><span class="w"> </span><span class="n">LE</span><span class="w"> </span><span class="n">GE</span><span class="w">         </span><span class="cm">/* í¬ê¸° ë¹„êµ */</span>
<span class="nf">%left</span><span class="w"> </span><span class="sc">&#39;+&#39;</span><span class="w"> </span><span class="sc">&#39;-&#39;</span><span class="w">               </span><span class="cm">/* ë§ì…ˆ */</span>
<span class="nf">%left</span><span class="w"> </span><span class="sc">&#39;*&#39;</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="w">           </span><span class="cm">/* ê³±ì…ˆ */</span>
<span class="nf">%right</span><span class="w"> </span><span class="n">UMINUS</span><span class="w">               </span><span class="cm">/* ë‹¨í•­ ë¹¼ê¸° (ê°€ìƒ í† í°) */</span>
</code></pre></div>

<p><strong>ì‘ë™ ë°©ì‹:</strong></p>
<ol>
<li>ê° í† í°ì€ (ì„ ì–¸ ìœ„ì¹˜ì— ë”°ë¥¸) <strong>ìš°ì„ ìˆœìœ„ ë ˆë²¨</strong>ì„ ê°€ì§</li>
<li>ê° ìƒì‚° ê·œì¹™ì€ <strong>ê°€ì¥ ì˜¤ë¥¸ìª½ í„°ë¯¸ë„</strong>ì˜ ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§</li>
<li>ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒì—ì„œ:</li>
<li>ì‹œí”„íŠ¸ í† í°ì˜ ìš°ì„ ìˆœìœ„ê°€ ë¦¬ë“€ìŠ¤ ìƒì‚° ê·œì¹™ë³´ë‹¤ ë†’ìœ¼ë©´: <strong>ì‹œí”„íŠ¸</strong></li>
<li>ë¦¬ë“€ìŠ¤ ìƒì‚° ê·œì¹™ì˜ ìš°ì„ ìˆœìœ„ê°€ ë” ë†’ìœ¼ë©´: <strong>ë¦¬ë“€ìŠ¤</strong></li>
<li>ë™ì¼í•œ ìš°ì„ ìˆœìœ„ì´ë©´: <strong>ê²°í•©ì„±</strong> ì‚¬ìš© (<code>%left</code> = ë¦¬ë“€ìŠ¤, <code>%right</code> = ì‹œí”„íŠ¸, <code>%nonassoc</code> = ì˜¤ë¥˜)</li>
</ol>
<p><strong>ì˜ˆì‹œ:</strong> ì…ë ¥ <code>3 + 4 * 5</code>ì—ì„œ:</p>
<div class="highlight"><pre><span></span><code><span class="n">Stack</span><span class="o">:</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="w">    </span><span class="n">Lookahead</span><span class="o">:</span><span class="w"> </span><span class="o">*</span>

<span class="n">Production</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reduce</span><span class="o">:</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expr</span><span class="w">  </span><span class="p">(</span><span class="n">precedence</span><span class="w"> </span><span class="kr">of</span><span class="w"> </span><span class="s">&#39;+&#39;</span><span class="p">)</span>
<span class="kt">Token</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">shift</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span><span class="w">                        </span><span class="p">(</span><span class="n">precedence</span><span class="w"> </span><span class="kr">of</span><span class="w"> </span><span class="s">&#39;*&#39;</span><span class="p">)</span>

<span class="n">Since</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">precedence</span><span class="o">:</span><span class="w"> </span><span class="n">SHIFT</span>

<span class="n">Result</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">  </span><span class="err">âœ“</span>
</code></pre></div>

<h3 id="84-prec">8.4 <code>%prec</code> ì§€ì‹œì–´<a class="header-link" href="#84-prec" title="Permanent link">&para;</a></h3>
<p>ë•Œë¡œëŠ” ìƒì‚° ê·œì¹™ì´ ê°€ì¥ ì˜¤ë¥¸ìª½ í„°ë¯¸ë„ì´ ì œì‹œí•˜ëŠ” ê²ƒê³¼ ë‹¤ë¥¸ ìš°ì„ ìˆœìœ„ê°€ í•„ìš”í•©ë‹ˆë‹¤. <code>%prec</code> ì§€ì‹œì–´ë¡œ ì´ë¥¼ ì¬ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code>expr<span class="w"> </span>:<span class="w"> </span>&#39;-&#39;<span class="w"> </span>expr<span class="w">  </span>%prec<span class="w"> </span>UMINUS<span class="w">    </span>/*<span class="w"> </span>ë‹¨í•­<span class="w"> </span>ë¹¼ê¸°<span class="w"> </span>*/
<span class="w">     </span>{
<span class="w">         </span>$$<span class="w"> </span>=<span class="w"> </span>-$<span class="m">2</span>;
<span class="w">     </span>}
<span class="w">     </span>;
</code></pre></div>

<p><code>%prec UMINUS</code> ì—†ì´ëŠ” ìƒì‚° ê·œì¹™ <code>expr -&gt; '-' expr</code>ê°€ <code>-</code>ì˜ ìš°ì„ ìˆœìœ„(ë§ì…ˆ ë ˆë²¨)ë¥¼ ê°€ì§‘ë‹ˆë‹¤. <code>%prec UMINUS</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ë” ë†’ì€ ë‹¨í•­ ë¹¼ê¸° ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§‘ë‹ˆë‹¤.</p>
<hr />
<h2 id="9-lr">9. LR íŒŒì„œì˜ ì˜¤ë¥˜ ë³µêµ¬<a class="header-link" href="#9-lr" title="Permanent link">&para;</a></h2>
<h3 id="91-panic-mode">9.1 íŒ¨ë‹‰ ëª¨ë“œ(Panic Mode)<a class="header-link" href="#91-panic-mode" title="Permanent link">&para;</a></h3>
<p>í•˜í–¥ì‹ íŒŒì‹±ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ, ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ í”„ë ˆì„ì›Œí¬ì— ë§ê²Œ ì¡°ì •ë©ë‹ˆë‹¤:</p>
<ol>
<li>ì˜¤ë¥˜ ë³µêµ¬ ë¹„í„°ë¯¸ë„ $A$ì— ëŒ€í•´ GOTO($s$, $A$)ê°€ ì •ì˜ëœ ìƒíƒœ $s$ë¥¼ ì°¾ì„ ë•Œê¹Œì§€ ìŠ¤íƒì—ì„œ ìƒíƒœë¥¼ íŒ</li>
<li>$A$ì™€ GOTO ìƒíƒœë¥¼ ìŠ¤íƒì— í‘¸ì‹œ</li>
<li>íŒŒì„œê°€ ê³„ì†í•  ìˆ˜ ìˆëŠ” ì…ë ¥ ì‹¬ë³¼ì„ ì°¾ì„ ë•Œê¹Œì§€ ì…ë ¥ ì‹¬ë³¼ ë²„ë¦¼</li>
</ol>
<h3 id="92-error-productions">9.2 ì˜¤ë¥˜ ìƒì‚° ê·œì¹™(Error Productions)<a class="header-link" href="#92-error-productions" title="Permanent link">&para;</a></h3>
<p>Yacc/Bisonì€ ì˜¤ë¥˜ ë³µêµ¬ë¥¼ ìœ„í•´ íŠ¹ë³„í•œ <code>error</code> í† í°ì„ ì œê³µí•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="n">stmt</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="s1">&#39;;&#39;</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="s1">&#39;;&#39;</span><span class="w">      </span><span class="cm">/* ì˜¤ë¥˜ ì‹œ ë‹¤ìŒ ì„¸ë¯¸ì½œë¡ ê¹Œì§€ ê±´ë„ˆëœ€ */</span>
<span class="w">     </span><span class="o">{</span>
<span class="w">         </span><span class="n">yyerrok</span><span class="o">;</span><span class="w">      </span><span class="cm">/* ì˜¤ë¥˜ ìƒíƒœ ì´ˆê¸°í™” */</span>
<span class="w">         </span><span class="n">printf</span><span class="o">(</span><span class="s2">&quot;Recovered from error\n&quot;</span><span class="o">);</span>
<span class="w">     </span><span class="o">}</span>
<span class="w">     </span><span class="o">;</span>

<span class="n">block</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{&#39;</span><span class="w"> </span><span class="n">stmt_list</span><span class="w"> </span><span class="s1">&#39;}&#39;</span>
<span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;{&#39;</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="s1">&#39;}&#39;</span><span class="w">    </span><span class="cm">/* ì˜¤ë¥˜ ì‹œ ë§¤ì¹­ë˜ëŠ” ì¤‘ê´„í˜¸ê¹Œì§€ ê±´ë„ˆëœ€ */</span>
<span class="w">      </span><span class="o">;</span>
</code></pre></div>

<p><strong><code>error</code> ë™ì‘ ë°©ì‹:</strong></p>
<ol>
<li>êµ¬ë¬¸ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ íŒŒì„œëŠ” <code>error</code>ë¥¼ ì‹œí”„íŠ¸í•  ìˆ˜ ìˆëŠ” ìƒíƒœë¥¼ ì°¾ì„ ë•Œê¹Œì§€ ìƒíƒœë¥¼ íŒ</li>
<li><code>error</code> í† í°ì„ ì‹œí”„íŠ¸</li>
<li>ì˜¤ë¥˜ ìƒì‚° ê·œì¹™ ì´í›„ ì„±ê³µì ìœ¼ë¡œ ì‹œí”„íŠ¸í•  ìˆ˜ ìˆì„ ë•Œê¹Œì§€ ì…ë ¥ í† í° ë²„ë¦¼</li>
<li><code>yyerrok</code>ì€ íŒŒì„œì—ê²Œ ì •ìƒ ì˜¤ë¥˜ ë³´ê³ ë¥¼ ì¬ê°œí•˜ë„ë¡ ì§€ì‹œ (ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ëª‡ ê°œì˜ í† í° ë™ì•ˆ ì˜¤ë¥˜ë¥¼ ì–µì œ)</li>
</ol>
<h3 id="93">9.3 êµ¬í˜„<a class="header-link" href="#93" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SLRParserWithRecovery</span><span class="p">(</span><span class="n">SLRParser</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SLR parser with error recovery support.</span>

<span class="sd">    Uses a synchronization-based strategy:</span>
<span class="sd">    when an error occurs, pop states until we find one that</span>
<span class="sd">    can handle a synchronizing token.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span> <span class="n">sync_tokens</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sync_tokens</span> <span class="o">=</span> <span class="n">sync_tokens</span> <span class="ow">or</span> <span class="p">{</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;}&quot;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_with_recovery</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse with error recovery.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (success, errors) where success is True if parsing completed</span>
<span class="sd">            and errors is a list of error messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">input_syms</span> <span class="o">=</span> <span class="n">tokens</span> <span class="o">+</span> <span class="p">[</span><span class="n">EOF</span><span class="p">]</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">state_stack</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">symbol_stack</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">state_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">input_syms</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span>

            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">state</span><span class="p">,</span> <span class="n">current</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># ERROR</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Syntax error at position </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;unexpected &#39;</span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">&#39; in state </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ERROR: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Recovery: skip input until sync token</span>
                <span class="n">recovered</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">while</span> <span class="n">ip</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_syms</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Don&#39;t skip $</span>
                    <span class="k">if</span> <span class="n">input_syms</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sync_tokens</span><span class="p">:</span>
                        <span class="c1"># Try to find a state that can handle this</span>
                        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">state_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">test_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_table</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                <span class="p">(</span><span class="n">state_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">input_syms</span><span class="p">[</span><span class="n">ip</span><span class="p">])</span>
                            <span class="p">)</span>
                            <span class="k">if</span> <span class="n">test_action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">recovered</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                            <span class="n">state_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                            <span class="k">if</span> <span class="n">symbol_stack</span><span class="p">:</span>
                                <span class="n">symbol_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

                        <span class="k">if</span> <span class="n">recovered</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span>
                                    <span class="sa">f</span><span class="s2">&quot;  Recovered at &#39;</span><span class="si">{</span><span class="n">input_syms</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                                    <span class="sa">f</span><span class="s2">&quot;in state </span><span class="si">{</span><span class="n">state_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                                <span class="p">)</span>
                            <span class="k">break</span>
                    <span class="n">ip</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">recovered</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;shift&quot;</span><span class="p">:</span>
                <span class="n">symbol_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="n">state_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
                <span class="n">ip</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;reduce&quot;</span><span class="p">:</span>
                <span class="n">rhs_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">rhs</span> <span class="o">==</span> <span class="p">(</span><span class="n">EPSILON</span><span class="p">,):</span>
                    <span class="n">rhs_len</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rhs_len</span><span class="p">):</span>
                    <span class="n">state_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">symbol_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">symbol_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
                <span class="n">goto_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">goto_table</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">state_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">action</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">goto_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span>
                <span class="n">state_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goto_state</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;accept&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span>
</code></pre></div>

<hr />
<h2 id="10">10. ê³ ê¸‰ ì£¼ì œ<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101-glr">10.1 GLR íŒŒì‹±<a class="header-link" href="#101-glr" title="Permanent link">&para;</a></h3>
<p><strong>ì¼ë°˜í™” LR (GLR, Generalized LR)</strong> íŒŒì‹±ì€ ì¶©ëŒì´ ë°œìƒí•  ë•Œ ì—¬ëŸ¬ íŒŒì„œ ìŠ¤íƒì„ ë™ì‹œì— ìœ ì§€í•˜ì—¬ ëª¨í˜¸í•˜ê³  ë¹„ê²°ì •ë¡ ì ì¸ ë¬¸ë²•ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì¶©ëŒì´ ë°œìƒí•˜ë©´ íŒŒì„œê°€ ì—¬ëŸ¬ ê°œì˜ ë³‘ë ¬ íŒŒì„œë¡œ <strong>ë¶„ê¸°(Fork)</strong>ë©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>GLR íŒŒì‹±: ì¶©ëŒ ì‹œ ë¶„ê¸°

    ì¶©ëŒ ì „:         ë¶„ê¸° í›„:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Stack A â”‚         â”‚ Stack A â”‚ â”€â”€shiftâ”€â”€â–¶  Stack A&#39;
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚         â”‚ â”€â”€reduceâ”€â”€â–¶ Stack A&#39;&#39;
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ë‘ ìŠ¤íƒì´ ë…ë¦½ì ìœ¼ë¡œ ê³„ì†ë¨.
    ìœ íš¨í•˜ì§€ ì•Šì€ íŒŒìŠ¤ëŠ” ì‚¬ë¼ì§€ê³ , ìœ íš¨í•œ ê²ƒë“¤ì´ ìˆ˜ë ´í•¨.
</code></pre></div>

<p><strong>ì‚¬ìš©ì²˜:</strong> tree-sitter (ì—ë””í„°ì—ì„œì˜ ì¦ë¶„ íŒŒì‹±), Elkhound, Bisonì˜ <code>%glr-parser</code> ëª¨ë“œ.</p>
<h3 id="102-incremental-parsing">10.2 ì¦ë¶„ íŒŒì‹±(Incremental Parsing)<a class="header-link" href="#102-incremental-parsing" title="Permanent link">&para;</a></h3>
<p>í˜„ëŒ€ ì—ë””í„°(VS Code, Neovim)ëŠ” ë§¤ í‚¤ ì…ë ¥ë§ˆë‹¤ íŒŒì¼ì„ ë‹¤ì‹œ íŒŒì‹±í•´ì•¼ í•©ë‹ˆë‹¤. <strong>ì¦ë¶„ íŒŒì‹±(Incremental Parsing)</strong>ì€ íŒŒì¼ì˜ ë³€ê²½ë˜ì§€ ì•Šì€ ë¶€ë¶„ì— ëŒ€í•´ ì´ì „ íŒŒìŠ¤ ê²°ê³¼ë¥¼ ì¬ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<p><strong>tree-sitter</strong>ëŠ” ê°€ì¥ ìœ ëª…í•œ ì¦ë¶„ íŒŒì„œì…ë‹ˆë‹¤:</p>
<ol>
<li>ì´ì „ í¸ì§‘ìœ¼ë¡œë¶€í„° íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ ìœ ì§€</li>
<li>ì‚¬ìš©ìê°€ íƒ€ì´í•‘í•  ë•Œ ì˜í–¥ë°›ì€ íŠ¸ë¦¬ ë…¸ë“œë§Œ ë‹¤ì‹œ íŒŒì‹±</li>
<li>ë¬¸ë²•ì ìœ¼ë¡œ ì˜ëª»ëœ ì½”ë“œì— ëŒ€í•œ ê°•ì¸ì„±ì„ ìœ„í•´ GLR ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©</li>
<li>ì¼ë°˜ì ì¸ í¸ì§‘ì— ëŒ€í•´ ë°€ë¦¬ì´ˆ ë¯¸ë§Œì˜ íŒŒì‹± ì‹œê°„ ë‹¬ì„±</li>
</ol>
<h3 id="103-operator-precedence-parsing">10.3 ì—°ì‚°ì ìš°ì„ ìˆœìœ„ íŒŒì‹±(Operator Precedence Parsing)<a class="header-link" href="#103-operator-precedence-parsing" title="Permanent link">&para;</a></h3>
<p>í‘œí˜„ì‹ì´ ë§ì€ ì–¸ì–´ì˜ ê²½ìš°, <strong>ì—°ì‚°ì ìš°ì„ ìˆœìœ„ íŒŒì‹±</strong> (ë˜ëŠ” <strong>í”„ë« íŒŒì‹±(Pratt Parsing)</strong>)ì´ ì™„ì „í•œ LR íŒŒì‹±ì˜ ë” ê°„ë‹¨í•œ ëŒ€ì•ˆì„ ì œê³µí•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pratt_parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">min_precedence</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pratt parser / precedence climbing for expressions.</span>

<span class="sd">    A simple, elegant alternative to LR for expression parsing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">parse_atom</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>

    <span class="k">while</span> <span class="p">(</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">get_precedence</span><span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">peek</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="n">min_precedence</span>
    <span class="p">):</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="n">prec</span> <span class="o">=</span> <span class="n">get_precedence</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
        <span class="n">assoc</span> <span class="o">=</span> <span class="n">get_associativity</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>

        <span class="c1"># For left-associative: next_min = prec + 1</span>
        <span class="c1"># For right-associative: next_min = prec</span>
        <span class="n">next_min</span> <span class="o">=</span> <span class="n">prec</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">assoc</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span> <span class="k">else</span> <span class="n">prec</span>

        <span class="n">right</span> <span class="o">=</span> <span class="n">pratt_parse</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">next_min</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">BinOp</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">left</span>
</code></pre></div>

<hr />
<h2 id="11_1">11. ìš”ì•½<a class="header-link" href="#11_1" title="Permanent link">&para;</a></h2>
<p>ìƒí–¥ì‹ íŒŒì‹±ì€ í”„ë¡œë•ì…˜ ì»´íŒŒì¼ëŸ¬ì™€ íŒŒì„œ ìƒì„±ê¸°ì—ì„œ ì§€ë°°ì ì¸ ì „ëµì…ë‹ˆë‹¤. ì¢Œì¬ê·€ ë¬¸ë²•ì„ ì²˜ë¦¬í•˜ëŠ” ëŠ¥ë ¥ê³¼ ëª¨í˜¸ì„± í•´ê²°ì— ëŒ€í•œ ì²´ê³„ì ì¸ ì ‘ê·¼ ë°©ì‹ì´ ë§¤ìš° ì‹¤ìš©ì ì…ë‹ˆë‹¤.</p>
<p><strong>í•µì‹¬ ê°œë…:</strong></p>
<table>
<thead>
<tr>
<th>ê°œë…</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤</strong></td>
<td>ê¸°ë³¸ ë™ì‘: ì…ë ¥ì„ ìŠ¤íƒì— ì‹œí”„íŠ¸í•˜ê±°ë‚˜ í•¸ë“¤ì„ ë¦¬ë“€ìŠ¤</td>
</tr>
<tr>
<td><strong>í•¸ë“¤</strong></td>
<td>ê° ë‹¨ê³„ì—ì„œ ë¦¬ë“€ìŠ¤í•´ì•¼ í•  RHS (í•­ìƒ ìŠ¤íƒ ë§¨ ìœ„ì— ìˆìŒ)</td>
</tr>
<tr>
<td><strong>LR(0) ì•„ì´í…œ</strong></td>
<td>íŒŒìŠ¤ ì§„í–‰ ìƒí™©ì„ í‘œì‹œí•˜ëŠ” ì ì´ ìˆëŠ” ìƒì‚° ê·œì¹™</td>
</tr>
<tr>
<td><strong>í´ë¡œì €</strong></td>
<td>ë¹„í„°ë¯¸ë„ ì•ì— ì ì´ ìˆì„ ë•Œ ì•”ì‹œëœ ì•„ì´í…œ ì¶”ê°€</td>
</tr>
<tr>
<td><strong>GOTO</strong></td>
<td>ì ì„ ì´ë™ì‹œì¼œ ì•„ì´í…œ ì§‘í•© ê°„ ì „ì´</td>
</tr>
<tr>
<td><strong>SLR(1)</strong></td>
<td>LR(0) ì˜¤í† ë§ˆí†¤ + ë¦¬ë“€ìŠ¤ ê²°ì •ì„ ìœ„í•œ FOLLOW ì§‘í•©</td>
</tr>
<tr>
<td><strong>LR(1)</strong></td>
<td>ì•„ì´í…œì´ íŠ¹ì • ë£©ì–´í—¤ë“œë¥¼ ê°€ì§; ê°€ì¥ ì •ë°€</td>
</tr>
<tr>
<td><strong>LALR(1)</strong></td>
<td>ë³‘í•©ëœ LR(1) ìƒíƒœ; ì‹¤ìš©ì  ìµœì ì  (Yacc, Bison)</td>
</tr>
<tr>
<td><strong>ìš°ì„ ìˆœìœ„</strong></td>
<td>ì—°ì‚°ì ë¬¸ë²•ì„ ìœ„í•œ ì²´ê³„ì ì¸ ì¶©ëŒ í•´ê²°</td>
</tr>
</tbody>
</table>
<p><strong>ì–´ë–¤ LR ë³€í˜•ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ê°€?</strong></p>
<ul>
<li><strong>SLR(1)</strong>: ê°„ë‹¨í•œ ë¬¸ë²•ê³¼ êµìœ¡ ëª©ì </li>
<li><strong>LALR(1)</strong>: ëŒ€ë¶€ë¶„ì˜ ì‹¤ìš©ì ì¸ íŒŒì„œ ìƒì„±ê¸° (Yacc, Bison, PLY)</li>
<li><strong>LR(1)</strong>: LALR(1)ì— ê°€ì§œ ë¦¬ë“€ìŠ¤-ë¦¬ë“€ìŠ¤ ì¶©ëŒì´ ìˆì„ ë•Œ</li>
<li><strong>GLR</strong>: ëª¨í˜¸í•œ ë¬¸ë²•ì´ë‚˜ ìµœëŒ€í•œì˜ ìœ ì—°ì„±ì´ í•„ìš”í•  ë•Œ</li>
</ul>
<hr />
<h2 id="_2">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1-lr0">ì—°ìŠµ 1: LR(0) ì˜¤í† ë§ˆí†¤ êµ¬ì„±<a class="header-link" href="#1-lr0" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ë¬¸ë²•ì— ëŒ€í•œ ì™„ì „í•œ LR(0) ì˜¤í† ë§ˆí†¤ì„ êµ¬ì„±í•˜ì„¸ìš”:</p>
<p>$$
\begin{aligned}
S' &\to S \\
S &\to A\ B \\
A &\to a \\
B &\to b
\end{aligned}
$$</p>
<p>ëª¨ë“  ìƒíƒœë¥¼ ì•„ì´í…œ ì§‘í•©ê³¼ í•¨ê»˜ ê·¸ë¦¬ê³  ëª¨ë“  ì „ì´ì— ë ˆì´ë¸”ì„ ë¶™ì´ì„¸ìš”. ì˜¤í† ë§ˆí†¤ì€ ëª‡ ê°œì˜ ìƒíƒœë¥¼ ê°€ì§‘ë‹ˆê¹Œ?</p>
<h3 id="2-slr1">ì—°ìŠµ 2: SLR(1) í…Œì´ë¸” êµ¬ì„±<a class="header-link" href="#2-slr1" title="Permanent link">&para;</a></h3>
<p>ì¦ê°• ë¬¸ë²•ì— ëŒ€í•´:</p>
<p>$$
\begin{aligned}
S' &\to S \\
S &\to C\ C \\
C &\to c\ C \mid d
\end{aligned}
$$</p>
<ol>
<li>LR(0) ì˜¤í† ë§ˆí†¤ì„ êµ¬ì„±í•˜ì„¸ìš”.</li>
<li>FIRSTì™€ FOLLOW ì§‘í•©ì„ ê³„ì‚°í•˜ì„¸ìš”.</li>
<li>SLR(1) íŒŒì‹± í…Œì´ë¸”ì„ êµ¬ì¶•í•˜ì„¸ìš”.</li>
<li>ì…ë ¥ ë¬¸ìì—´ <code>c d c d</code>ì˜ íŒŒìŠ¤ë¥¼ ì¶”ì í•˜ì„¸ìš”.</li>
</ol>
<h3 id="3-slr-vs-lr1">ì—°ìŠµ 3: SLR vs LR(1)<a class="header-link" href="#3-slr-vs-lr1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ë¬¸ë²•ì„ ê³ ë ¤í•˜ì„¸ìš”:</p>
<p>$$
\begin{aligned}
S &\to L = R \mid R \\
L &\to * R \mid \textbf{id} \\
R &\to L
\end{aligned}
$$</p>
<ol>
<li>SLR í…Œì´ë¸”ì„ êµ¬ì„±í•˜ê³  ì¶©ëŒì„ ì‹ë³„í•˜ì—¬ ì´ ë¬¸ë²•ì´ <strong>SLR(1)ì´ ì•„ë‹˜</strong>ì„ ë³´ì´ì„¸ìš”.</li>
<li>ì´ ë¬¸ë²•ì´ <strong>LR(1)ì„</strong>ì„ ì„¤ëª…í•˜ì„¸ìš” (ì „ì²´ ì˜¤í† ë§ˆí†¤ì„ êµ¬ì¶•í•˜ì§€ ì•Šê³  ê´€ë ¨ LR(1) ì•„ì´í…œì„ ì„¤ëª…í•´ë„ ë©ë‹ˆë‹¤).</li>
</ol>
<h3 id="4-ply">ì—°ìŠµ 4: PLY íŒŒì„œ<a class="header-link" href="#4-ply" title="Permanent link">&para;</a></h3>
<p>PLYë¥¼ ì‚¬ìš©í•˜ì—¬ (ë˜ëŠ” ë™ë“±í•œ LALR íŒŒì„œë¥¼ ì§ì ‘ ì‘ì„±í•˜ì—¬) ë‹¤ìŒì„ ì§€ì›í•˜ëŠ” ê°„ë‹¨í•œ ê³„ì‚°ê¸° ì–¸ì–´ì˜ íŒŒì„œë¥¼ êµ¬í˜„í•˜ì„¸ìš”:</p>
<ul>
<li>ì •ìˆ˜ì™€ ë¶€ë™ì†Œìˆ˜ì  ìˆ«ì</li>
<li>ì‚°ìˆ  ì—°ì‚°ì: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>**</code> (ê±°ë“­ì œê³±)</li>
<li>ë‹¨í•­ ë¶€ì •: <code>-x</code></li>
<li>ê´„í˜¸ í‘œí˜„ì‹</li>
<li>ë³€ìˆ˜ ëŒ€ì…: <code>x = expr</code></li>
<li>ì¶œë ¥: <code>print expr</code></li>
</ul>
<p>ëª¨ë“  ì—°ì‚°ìì— ì ì ˆí•œ ìš°ì„ ìˆœìœ„ì™€ ê²°í•©ì„±ì„ ì •ì˜í•˜ì„¸ìš”. <code>x = 2 + 3 * 4</code>ì™€ <code>print x ** 2</code> ê°™ì€ ì…ë ¥ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
<h3 id="5">ì—°ìŠµ 5: ì¶©ëŒ ë¶„ì„<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ë¬¸ë²•ì— ëŒ€í•´:</p>
<div class="highlight"><pre><span></span><code><span class="n">stmt</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IF</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="n">THEN</span><span class="w"> </span><span class="n">stmt</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">IF</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="n">THEN</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="n">ELSE</span><span class="w"> </span><span class="n">stmt</span>
<span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">OTHER</span>
<span class="w">     </span><span class="o">;</span>
</code></pre></div>

<ol>
<li>ì‹œí”„íŠ¸-ë¦¬ë“€ìŠ¤ ì¶©ëŒì„ ì‹ë³„í•˜ê¸°ì— ì¶©ë¶„í•œ LALR(1) ì˜¤í† ë§ˆí†¤ì„ êµ¬ì„±í•˜ì„¸ìš”.</li>
<li><code>ELSE</code>ì— <code>%left</code> ë˜ëŠ” <code>%nonassoc</code> ì„ ì–¸ì„ ì ìš©í•˜ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì„¤ëª…í•˜ì„¸ìš”.</li>
<li>ëŒ•ê¸€ë§ elseì—ì„œ "ì¶©ëŒ ì‹œ ì‹œí”„íŠ¸"ê°€ ì˜¬ë°”ë¥¸ ê¸°ë³¸ê°’ì¸ ì´ìœ ë¥¼ ì„¤ëª…í•˜ì„¸ìš”.</li>
</ol>
<h3 id="6">ì—°ìŠµ 6: ì˜¤ë¥˜ ë³µêµ¬<a class="header-link" href="#6" title="Permanent link">&para;</a></h3>
<p>4.2ì ˆì˜ SLR íŒŒì„œ êµ¬í˜„ì„ í™•ì¥í•˜ì—¬ ì˜¤ë¥˜ ìƒì‚° ê·œì¹™ì„ ì‚¬ìš©í•œ ì˜¤ë¥˜ ë³µêµ¬ë¥¼ ì§€ì›í•˜ì„¸ìš”. í‘œí˜„ì‹ ë¬¸ë²•ì— ë‹¤ìŒ ì˜¤ë¥˜ ê·œì¹™ì„ ì¶”ê°€í•˜ì„¸ìš”:</p>
<div class="highlight"><pre><span></span><code><span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">error</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="w">     </span><span class="c1">// ì˜ëª»ëœ ì¢Œì¸¡ í”¼ì—°ì‚°ìì—ì„œ ë³µêµ¬</span>
<span class="n">E</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">error</span><span class="w">     </span><span class="c1">// ì˜ëª»ëœ ìš°ì¸¡ í”¼ì—°ì‚°ìì—ì„œ ë³µêµ¬</span>
<span class="n">F</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nf">error</span><span class="w"> </span><span class="p">)</span><span class="w">     </span><span class="c1">// ì˜ëª»ëœ ê´„í˜¸ í‘œí˜„ì‹ì—ì„œ ë³µêµ¬</span>
</code></pre></div>

<p>ì…ë ¥ <code>+ id * id</code>, <code>id + * id</code>, <code>( + ) * id</code>ë¡œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
<hr />
<p><a href="./05_Top_Down_Parsing.md">ì´ì „: 05_Top_Down_Parsing.md</a> | <a href="./07_Abstract_Syntax_Trees.md">ë‹¤ìŒ: 07_Abstract_Syntax_Trees.md</a> | <a href="./00_Overview.md">ê°œìš”</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Compiler_Design/05_Top_Down_Parsing.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ë ˆìŠ¨ 5: í•˜í–¥ì‹ íŒŒì‹±(Top-Down Parsing)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Compiler_Design/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Compiler_Design/07_Abstract_Syntax_Trees.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë ˆìŠ¨ 7: ì¶”ìƒ êµ¬ë¬¸ íŠ¸ë¦¬(Abstract Syntax Trees)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}