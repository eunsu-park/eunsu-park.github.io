{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>캐시 메모리 - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Computer_Architecture/">Computer Architecture</a>
    <span class="separator">/</span>
    <span class="current">캐시 메모리</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>캐시 메모리</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Computer_Architecture/14_Memory_Hierarchy.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">메모리 계층 구조</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Computer_Architecture/16_Virtual_Memory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">가상 메모리</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">개요</a></li>
<li><a href="#_3">목차</a></li>
<li><a href="#1">1. 캐시의 개념과 동작</a><ul>
<li><a href="#11">1.1 캐시란?</a></li>
<li><a href="#12">1.2 캐시 구조 기초</a></li>
<li><a href="#13">1.3 주소 분해</a></li>
<li><a href="#14">1.4 캐시 동작 흐름</a></li>
</ul>
</li>
<li><a href="#2">2. 캐시 사상 방식</a><ul>
<li><a href="#21-direct-mapped">2.1 직접 사상 (Direct Mapped)</a></li>
<li><a href="#22-fully-associative">2.2 완전 연관 사상 (Fully Associative)</a></li>
<li><a href="#23-set-associative">2.3 집합 연관 사상 (Set Associative)</a></li>
<li><a href="#24">2.4 사상 방식 비교</a></li>
</ul>
</li>
<li><a href="#3">3. 캐시 교체 정책</a><ul>
<li><a href="#31">3.1 교체 정책의 필요성</a></li>
<li><a href="#32-lru-least-recently-used">3.2 LRU (Least Recently Used)</a></li>
<li><a href="#33-pseudo-lru-tree-based">3.3 Pseudo-LRU (Tree-based)</a></li>
<li><a href="#34-fifo-first-in-first-out">3.4 FIFO (First In, First Out)</a></li>
<li><a href="#35-random">3.5 Random 교체</a></li>
<li><a href="#36">3.6 교체 정책 비교</a></li>
</ul>
</li>
<li><a href="#4">4. 캐시 쓰기 정책</a><ul>
<li><a href="#41-write-through">4.1 Write-Through</a></li>
<li><a href="#42-write-back">4.2 Write-Back</a></li>
<li><a href="#43-write-allocate-vs-no-write-allocate">4.3 Write Allocate vs No-Write Allocate</a></li>
<li><a href="#44">4.4 쓰기 정책 비교</a></li>
</ul>
</li>
<li><a href="#5">5. 캐시 미스의 종류</a><ul>
<li><a href="#51-3c">5.1 3C 분류</a></li>
<li><a href="#52-cold-miss-compulsory-miss">5.2 Cold Miss (Compulsory Miss)</a></li>
<li><a href="#53-capacity-miss">5.3 Capacity Miss</a></li>
<li><a href="#54-conflict-miss">5.4 Conflict Miss</a></li>
<li><a href="#55-3c">5.5 3C 미스 비율</a></li>
</ul>
</li>
<li><a href="#6">6. 다중 레벨 캐시</a><ul>
<li><a href="#61">6.1 다중 레벨 캐시의 필요성</a></li>
<li><a href="#62-inclusive-vs-exclusive">6.2 Inclusive vs Exclusive 캐시</a></li>
<li><a href="#63-vs">6.3 전용 캐시 vs 공유 캐시</a></li>
<li><a href="#64-local-vs-global">6.4 Local vs Global 미스율</a></li>
</ul>
</li>
<li><a href="#7">7. 캐시 최적화 기법</a><ul>
<li><a href="#71-victim-cache">7.1 Victim Cache</a></li>
<li><a href="#72-prefetching">7.2 프리페칭 (Prefetching)</a></li>
<li><a href="#73">7.3 컴파일러 최적화</a></li>
</ul>
</li>
<li><a href="#8">8. 연습 문제</a><ul>
<li><a href="#_4">기초 문제</a></li>
<li><a href="#_5">중급 문제</a></li>
<li><a href="#_6">심화 문제</a></li>
</ul>
</li>
<li><a href="#_7">다음 단계</a></li>
<li><a href="#_8">참고 자료</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">캐시 메모리<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">개요<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>캐시(Cache) 메모리는 CPU와 메인 메모리 사이의 속도 격차를 해소하기 위한 고속 버퍼 메모리입니다. 캐시의 설계는 컴퓨터 성능에 직접적인 영향을 미치며, 사상 방식, 교체 정책, 쓰기 정책 등 다양한 설계 결정이 필요합니다. 이 레슨에서는 캐시의 동작 원리와 다양한 설계 기법을 학습합니다.</p>
<p><strong>난이도</strong>: ⭐⭐⭐</p>
<p><strong>선수 지식</strong>: 메모리 계층 구조, 지역성 원리</p>
<hr />
<h2 id="_3">목차<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-캐시의-개념과-동작">캐시의 개념과 동작</a></li>
<li><a href="#2-캐시-사상-방식">캐시 사상 방식</a></li>
<li><a href="#3-캐시-교체-정책">캐시 교체 정책</a></li>
<li><a href="#4-캐시-쓰기-정책">캐시 쓰기 정책</a></li>
<li><a href="#5-캐시-미스의-종류">캐시 미스의 종류</a></li>
<li><a href="#6-다중-레벨-캐시">다중 레벨 캐시</a></li>
<li><a href="#7-캐시-최적화-기법">캐시 최적화 기법</a></li>
<li><a href="#8-연습-문제">연습 문제</a></li>
</ol>
<hr />
<h2 id="1">1. 캐시의 개념과 동작<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 캐시란?<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>캐시(Cache)의 어원: 프랑스어 &quot;cacher&quot; (숨기다)

정의: CPU와 메인 메모리 사이에 위치한 소용량 고속 메모리
목적: 자주 사용되는 데이터를 빠르게 접근할 수 있도록 유지

┌─────────────────────────────────────────────────────────────┐
│                     캐시의 역할                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│      CPU                   캐시                메인 메모리   │
│   ┌───────┐           ┌───────────┐          ┌───────────┐  │
│   │       │  빠른 접근 │           │  느린 접근 │           │  │
│   │       │◀────────▶│           │◀────────▶│           │  │
│   │       │  (~4 ns)  │           │ (~60 ns)  │           │  │
│   └───────┘           └───────────┘          └───────────┘  │
│                                                             │
│   자주 사용하는 데이터를 캐시에 유지하여 평균 접근 시간 단축     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="12">1.2 캐시 구조 기초<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>캐시 라인 (Cache Line) / 블록 (Block):
- 캐시와 메모리 간 데이터 전송의 기본 단위
- 일반적으로 64바이트 (현대 프로세서)

┌─────────────────────────────────────────────────────────────┐
│                      Cache Line (64 bytes)                   │
├─────────┬─────────────────────────────────────────────────┬──┤
│  Valid  │                     Tag                          │  │
│   (1b)  │                   (주소 상위)                     │  │
├─────────┴─────────────────────────────────────────────────┴──┤
│  ┌────────────────────────────────────────────────────────┐  │
│  │                    Data (64 bytes)                     │  │
│  │  0x00 0x01 0x02 ... 0x3E 0x3F                         │  │
│  └────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘

캐시 용어:
- 히트(Hit): 요청 데이터가 캐시에 있음
- 미스(Miss): 요청 데이터가 캐시에 없음
- 히트율(Hit Rate): 히트 수 / 총 접근 수
- 미스율(Miss Rate): 1 - 히트율
</code></pre></div>

<h3 id="13">1.3 주소 분해<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>메모리 주소를 캐시 접근에 사용하기 위해 분해:

32비트 주소 예시 (4KB 캐시, 64B 라인, 직접 사상):
┌─────────────────────────────────────────────────────────────┐
│ 31                    12 11          6 5               0    │
│ ├─────────────────────────┼─────────────┼────────────────┤  │
│ │         Tag (20b)       │ Index (6b)  │ Offset (6b)    │  │
│ └─────────────────────────┴─────────────┴────────────────┘  │
└─────────────────────────────────────────────────────────────┘

Offset (6비트):
- 캐시 라인 내 위치
- 64바이트 = 2^6, 따라서 6비트

Index (6비트):
- 캐시 라인 선택
- 4KB / 64B = 64 라인 = 2^6, 따라서 6비트

Tag (20비트):
- 같은 인덱스의 다른 주소 구분
- 나머지 비트 = 32 - 6 - 6 = 20비트
</code></pre></div>

<h3 id="14">1.4 캐시 동작 흐름<a class="header-link" href="#14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>캐시 읽기 동작:

┌─────────────────────────────────────────────────────────────┐
│                      CPU 주소 요청                          │
│                           │                                 │
│                           ▼                                 │
│              ┌────────────────────────┐                     │
│              │   Index로 캐시 라인 선택 │                     │
│              └────────────┬───────────┘                     │
│                           │                                 │
│                           ▼                                 │
│              ┌────────────────────────┐                     │
│              │  Tag 비교 &amp; Valid 확인  │                     │
│              └────────────┬───────────┘                     │
│                           │                                 │
│              ┌────────────┴────────────┐                    │
│              │                         │                    │
│         Tag 일치 &amp;              Tag 불일치 or                │
│         Valid = 1               Valid = 0                   │
│              │                         │                    │
│              ▼                         ▼                    │
│    ┌─────────────────┐      ┌─────────────────────┐        │
│    │   Cache Hit!    │      │    Cache Miss!      │        │
│    │ Offset로 데이터  │      │ 메모리에서 블록 로드 │        │
│    │    선택/반환    │      │ 캐시에 저장 후 반환  │        │
│    └─────────────────┘      └─────────────────────┘        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="2">2. 캐시 사상 방식<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-direct-mapped">2.1 직접 사상 (Direct Mapped)<a class="header-link" href="#21-direct-mapped" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">특징</span><span class="o">:</span><span class="w"> </span><span class="err">각</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">블록은</span><span class="w"> </span><span class="err">캐시의</span><span class="w"> </span><span class="err">한</span><span class="w"> </span><span class="err">위치에만</span><span class="w"> </span><span class="err">저장</span><span class="w"> </span><span class="err">가능</span>

<span class="err">계산</span><span class="o">:</span>
<span class="n">Cache</span><span class="w"> </span><span class="n">Index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="n">Memory</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">Address</span><span class="o">)</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="o">(</span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">Lines</span><span class="o">)</span>

<span class="err">예시</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span><span class="err">라인</span><span class="w"> </span><span class="err">캐시</span>

<span class="err">메모리</span><span class="w"> </span><span class="err">블록</span><span class="w">    </span><span class="err">캐시</span><span class="w"> </span><span class="err">인덱스</span>
<span class="w">   </span><span class="mi">0</span><span class="w">      </span><span class="err">→</span><span class="w">      </span><span class="mi">0</span>
<span class="w">   </span><span class="mi">1</span><span class="w">      </span><span class="err">→</span><span class="w">      </span><span class="mi">1</span>
<span class="w">   </span><span class="mi">2</span><span class="w">      </span><span class="err">→</span><span class="w">      </span><span class="mi">2</span>
<span class="w">   </span><span class="o">...</span>
<span class="w">   </span><span class="mi">7</span><span class="w">      </span><span class="err">→</span><span class="w">      </span><span class="mi">7</span>
<span class="w">   </span><span class="mi">8</span><span class="w">      </span><span class="err">→</span><span class="w">      </span><span class="mi">0</span><span class="w">  </span><span class="o">(</span><span class="err">충돌</span><span class="o">!)</span>
<span class="w">   </span><span class="mi">9</span><span class="w">      </span><span class="err">→</span><span class="w">      </span><span class="mi">1</span>
<span class="w">   </span><span class="o">...</span>
<span class="w">   </span><span class="mi">16</span><span class="w">     </span><span class="err">→</span><span class="w">      </span><span class="mi">0</span><span class="w">  </span><span class="o">(</span><span class="err">충돌</span><span class="o">!)</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                     </span><span class="err">직접</span><span class="w"> </span><span class="err">사상</span><span class="w"> </span><span class="err">캐시</span><span class="w">                           </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">Index</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Valid</span><span class="w"> </span><span class="err">│</span><span class="w">    </span><span class="n">Tag</span><span class="w">    </span><span class="err">│</span><span class="w">         </span><span class="n">Data</span><span class="w"> </span><span class="o">(</span><span class="mi">64</span><span class="n">B</span><span class="o">)</span><span class="w">            </span><span class="err">│</span>
<span class="err">├────────┼───────┼───────────┼───────────────────────────────┤</span>
<span class="err">│</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mh">0x100</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">[</span><span class="n">block</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="mi">16</span><span class="o">...]</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mh">0x101</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">[</span><span class="n">block</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="mi">17</span><span class="o">...]</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="err">│</span><span class="w">     </span><span class="o">-</span><span class="w">     </span><span class="err">│</span><span class="w">           </span><span class="o">-</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mh">0x102</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">[</span><span class="n">block</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="mi">11</span><span class="o">...]</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mh">0x103</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">[...]</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="err">│</span><span class="w">     </span><span class="o">-</span><span class="w">     </span><span class="err">│</span><span class="w">           </span><span class="o">-</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">6</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mh">0x100</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">[...]</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">7</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mh">0x101</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="o">[...]</span><span class="w">                        </span><span class="err">│</span>
<span class="err">└────────┴───────┴───────────┴───────────────────────────────┘</span>

<span class="err">장점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">간단한</span><span class="w"> </span><span class="err">하드웨어</span>
<span class="o">-</span><span class="w"> </span><span class="err">빠른</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="o">(</span><span class="err">병렬</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="err">비교</span><span class="w"> </span><span class="err">불필요</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">결정적</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="o">(</span><span class="err">교체</span><span class="w"> </span><span class="err">정책</span><span class="w"> </span><span class="err">불필요</span><span class="o">)</span>

<span class="err">단점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">충돌</span><span class="w"> </span><span class="err">미스</span><span class="w"> </span><span class="err">많음</span>
<span class="o">-</span><span class="w"> </span><span class="err">같은</span><span class="w"> </span><span class="err">인덱스를</span><span class="w"> </span><span class="err">사용하는</span><span class="w"> </span><span class="err">블록들이</span><span class="w"> </span><span class="err">경쟁</span>
</code></pre></div>

<h3 id="22-fully-associative">2.2 완전 연관 사상 (Fully Associative)<a class="header-link" href="#22-fully-associative" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nl">특징</span><span class="p">:</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">블록은</span><span class="w"> </span><span class="n">캐시의</span><span class="w"> </span><span class="n">어떤</span><span class="w"> </span><span class="n">위치에든</span><span class="w"> </span><span class="n">저장</span><span class="w"> </span><span class="n">가능</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                   </span><span class="n">완전</span><span class="w"> </span><span class="n">연관</span><span class="w"> </span><span class="n">사상</span><span class="w"> </span><span class="n">캐시</span><span class="w">                         </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Valid</span><span class="w"> </span><span class="err">│</span><span class="w">    </span><span class="n">Tag</span><span class="w">       </span><span class="err">│</span><span class="w">         </span><span class="n">Data</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="n">B</span><span class="p">)</span><span class="w">         </span><span class="err">│</span>
<span class="err">├────────┼───────┼──────────────┼────────────────────────────┤</span>
<span class="err">│</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0001000</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0002008</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0001008</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0003010</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="err">│</span><span class="w">      </span><span class="o">-</span><span class="w">       </span><span class="err">│</span><span class="w">      </span><span class="o">-</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0002000</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">6</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0004020</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">7</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0001020</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="p">[</span><span class="n">any</span><span class="w"> </span><span class="n">block</span><span class="p">]</span><span class="w">               </span><span class="err">│</span>
<span class="err">└────────┴───────┴──────────────┴────────────────────────────┘</span>

<span class="n">검색</span><span class="w"> </span><span class="n">과정</span><span class="o">:</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="n">요청</span><span class="w"> </span><span class="n">주소의</span><span class="w"> </span><span class="n">Tag를</span><span class="w"> </span><span class="n">모든</span><span class="w"> </span><span class="n">엔트리의</span><span class="w"> </span><span class="n">Tag와</span><span class="w"> </span><span class="n">동시</span><span class="w"> </span><span class="n">비교</span><span class="w"> </span><span class="p">(</span><span class="n">병렬</span><span class="w"> </span><span class="n">비교</span><span class="p">)</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Request</span><span class="w"> </span><span class="n">Tag</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0001000</span><span class="w"> </span><span class="err">≠</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0002008</span><span class="w"> </span><span class="err">≠</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Hit</span><span class="o">!</span><span class="w">  </span><span class="err">←</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0003010</span><span class="w"> </span><span class="err">≠</span><span class="w"> </span><span class="mh">0x0001008</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="p">...</span><span class="w">                                                        </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="nl">장점</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">충돌</span><span class="w"> </span><span class="n">미스</span><span class="w"> </span><span class="n">없음</span>
<span class="o">-</span><span class="w"> </span><span class="n">최대</span><span class="w"> </span><span class="n">유연성</span>

<span class="nl">단점</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">복잡한</span><span class="w"> </span><span class="n">하드웨어</span><span class="w"> </span><span class="p">(</span><span class="n">모든</span><span class="w"> </span><span class="n">태그</span><span class="w"> </span><span class="n">병렬</span><span class="w"> </span><span class="n">비교</span><span class="w"> </span><span class="n">필요</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">느린</span><span class="w"> </span><span class="n">접근</span><span class="w"> </span><span class="p">(</span><span class="n">CAM</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Content</span><span class="w"> </span><span class="n">Addressable</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="n">필요</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">비싼</span><span class="w"> </span><span class="n">구현</span><span class="w"> </span><span class="n">비용</span>
<span class="o">-</span><span class="w"> </span><span class="n">실제로는</span><span class="w"> </span><span class="n">TLB</span><span class="w"> </span><span class="n">같은</span><span class="w"> </span><span class="n">작은</span><span class="w"> </span><span class="n">구조에만</span><span class="w"> </span><span class="n">사용</span>
</code></pre></div>

<h3 id="23-set-associative">2.3 집합 연관 사상 (Set Associative)<a class="header-link" href="#23-set-associative" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">특징</span><span class="o">:</span><span class="w"> </span><span class="err">직접</span><span class="w"> </span><span class="err">사상과</span><span class="w"> </span><span class="err">완전</span><span class="w"> </span><span class="err">연관의</span><span class="w"> </span><span class="err">절충</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시를</span><span class="w"> </span><span class="err">여러</span><span class="w"> </span><span class="err">집합</span><span class="o">(</span><span class="n">Set</span><span class="o">)</span><span class="err">으로</span><span class="w"> </span><span class="err">나눔</span>
<span class="o">-</span><span class="w"> </span><span class="err">각</span><span class="w"> </span><span class="err">집합</span><span class="w"> </span><span class="err">내에서는</span><span class="w"> </span><span class="err">완전</span><span class="w"> </span><span class="err">연관</span>

<span class="n">N</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">Associative</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">각</span><span class="w"> </span><span class="err">집합에</span><span class="w"> </span><span class="n">N개의</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">라인</span><span class="w"> </span><span class="o">(</span><span class="n">Way</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">블록은</span><span class="w"> </span><span class="err">하나의</span><span class="w"> </span><span class="err">집합에만</span><span class="w"> </span><span class="err">배치</span><span class="w"> </span><span class="err">가능</span>
<span class="o">-</span><span class="w"> </span><span class="err">집합</span><span class="w"> </span><span class="err">내에서는</span><span class="w"> </span><span class="err">어떤</span><span class="w"> </span><span class="n">Way에든</span><span class="w"> </span><span class="err">배치</span><span class="w"> </span><span class="err">가능</span>

<span class="err">예시</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">Associative</span><span class="w"> </span><span class="o">(</span><span class="mi">32</span><span class="err">라인</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="err">집합</span><span class="o">)</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                  </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">Associative</span><span class="w"> </span><span class="err">캐시</span><span class="w">                  </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="n">Way</span><span class="w"> </span><span class="mi">3</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Set</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">V</span><span class="err">│</span><span class="n">Tag</span><span class="err">│</span><span class="n">Data</span><span class="err">│</span><span class="w"> </span><span class="n">V</span><span class="err">│</span><span class="n">Tag</span><span class="err">│</span><span class="n">Data</span><span class="err">│</span><span class="w"> </span><span class="n">V</span><span class="err">│</span><span class="n">Tag</span><span class="err">│</span><span class="n">Data</span><span class="err">│</span><span class="w"> </span><span class="n">V</span><span class="err">│</span><span class="n">Tag</span><span class="err">│</span><span class="n">Data</span><span class="w">   </span><span class="err">│</span>
<span class="err">├────────┼───────────┼───────────┼───────────┼──────────────┤</span>
<span class="err">│</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">100</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">108</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">110</span><span class="err">│</span><span class="o">...</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">101</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">109</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">111</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">102</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">10</span><span class="n">A</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">112</span><span class="err">│</span><span class="o">...</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">103</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">10</span><span class="n">B</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">113</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">11</span><span class="n">B</span><span class="err">│</span><span class="o">...</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">10</span><span class="n">C</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">114</span><span class="err">│</span><span class="o">...</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">105</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">10</span><span class="n">D</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">115</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">6</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">106</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">0</span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">10</span><span class="n">E</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">116</span><span class="err">│</span><span class="o">...</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="mi">7</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">107</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">10</span><span class="n">F</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">117</span><span class="err">│</span><span class="o">...</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="err">│</span><span class="mi">11</span><span class="n">F</span><span class="err">│</span><span class="o">...</span><span class="w">    </span><span class="err">│</span>
<span class="err">└────────┴───────────┴───────────┴───────────┴──────────────┘</span>

<span class="err">주소</span><span class="w"> </span><span class="err">분해</span><span class="w"> </span><span class="o">(</span><span class="mi">32</span><span class="err">비트</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="err">집합</span><span class="o">,</span><span class="w"> </span><span class="mi">64</span><span class="n">B</span><span class="w"> </span><span class="err">라인</span><span class="o">):</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w"> </span><span class="mi">31</span><span class="w">                   </span><span class="mi">9</span><span class="w">  </span><span class="mi">8</span><span class="w">         </span><span class="mi">6</span><span class="w">  </span><span class="mi">5</span><span class="w">                 </span><span class="mi">0</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="err">├───────────────────────┼───────────┼──────────────────┤</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="w">     </span><span class="n">Tag</span><span class="w"> </span><span class="o">(</span><span class="mi">23</span><span class="err">비트</span><span class="o">)</span><span class="w">       </span><span class="err">│</span><span class="n">Set</span><span class="w"> </span><span class="n">Index</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="n">Block</span><span class="w"> </span><span class="n">Offset</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="w">                       </span><span class="err">│</span><span class="w">  </span><span class="o">(</span><span class="mi">3</span><span class="err">비트</span><span class="o">)</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="o">(</span><span class="mi">6</span><span class="err">비트</span><span class="o">)</span><span class="w">       </span><span class="err">│</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="err">└───────────────────────┴───────────┴──────────────────┘</span><span class="w">    </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="24">2.4 사상 방식 비교<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────┬─────────────┬──────────────┬──────────────┐
│      특성        │  직접 사상   │  집합 연관    │  완전 연관   │
├─────────────────┼─────────────┼──────────────┼──────────────┤
│ 유연성          │    낮음      │    중간       │    높음      │
├─────────────────┼─────────────┼──────────────┼──────────────┤
│ 하드웨어 복잡도  │    낮음      │    중간       │    높음      │
├─────────────────┼─────────────┼──────────────┼──────────────┤
│ 접근 속도       │    빠름      │    중간       │    느림      │
├─────────────────┼─────────────┼──────────────┼──────────────┤
│ 충돌 미스       │    많음      │    적음       │    없음      │
├─────────────────┼─────────────┼──────────────┼──────────────┤
│ 비교기 수       │     1개      │   N개(N-way) │   전체 라인   │
├─────────────────┼─────────────┼──────────────┼──────────────┤
│ 실제 사용       │   초기 캐시   │  대부분 캐시  │    TLB      │
└─────────────────┴─────────────┴──────────────┴──────────────┘

일반적인 구성 (현대 프로세서):
- L1 캐시: 8-way set associative
- L2 캐시: 4-8 way set associative
- L3 캐시: 16-way set associative
- TLB: 완전 연관 또는 높은 연관도
</code></pre></div>

<hr />
<h2 id="3">3. 캐시 교체 정책<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 교체 정책의 필요성<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>집합 연관 또는 완전 연관 캐시에서:
- 캐시 미스 시 새 블록을 로드해야 함
- 집합(또는 전체 캐시)이 가득 찬 경우
- 어떤 블록을 교체할지 결정 필요

목표: 미래에 사용되지 않을 블록 교체 → 미스율 최소화
문제: 미래를 예측할 수 없음 → 휴리스틱 사용
</code></pre></div>

<h3 id="32-lru-least-recently-used">3.2 LRU (Least Recently Used)<a class="header-link" href="#32-lru-least-recently-used" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">오래</span><span class="w"> </span><span class="err">전에</span><span class="w"> </span><span class="err">사용된</span><span class="w"> </span><span class="err">블록</span><span class="w"> </span><span class="err">교체</span>
<span class="err">근거</span><span class="o">:</span><span class="w"> </span><span class="err">최근에</span><span class="w"> </span><span class="err">사용된</span><span class="w"> </span><span class="err">블록은</span><span class="w"> </span><span class="err">곧</span><span class="w"> </span><span class="err">다시</span><span class="w"> </span><span class="err">사용될</span><span class="w"> </span><span class="err">가능성</span><span class="w"> </span><span class="err">높음</span><span class="w"> </span><span class="o">(</span><span class="err">시간적</span><span class="w"> </span><span class="err">지역성</span><span class="o">)</span>

<span class="err">예시</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="err">캐시</span><span class="o">,</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">순서</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">F</span>

<span class="err">초기</span><span class="w"> </span><span class="err">상태</span><span class="w"> </span><span class="o">(</span><span class="err">빈</span><span class="w"> </span><span class="err">캐시</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="o">-</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">접근</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">A</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">접근</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">접근</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">접근</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">접근</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">오래됨</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">접근</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">교체</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">접근</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="err">교체</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="n">LRU</span><span class="w"> </span><span class="err">구현</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">정확한</span><span class="w"> </span><span class="n">LRU</span><span class="o">:</span><span class="w"> </span><span class="n">N</span><span class="o">!</span><span class="w"> </span><span class="err">상태</span><span class="w"> </span><span class="err">필요</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">하드웨어</span><span class="w"> </span><span class="err">비용</span><span class="w"> </span><span class="err">높음</span>
<span class="o">-</span><span class="w"> </span><span class="err">근사</span><span class="w"> </span><span class="n">LRU</span><span class="o">:</span><span class="w"> </span><span class="err">비트</span><span class="w"> </span><span class="err">행렬</span><span class="o">,</span><span class="w"> </span><span class="err">트리</span><span class="w"> </span><span class="err">기반</span><span class="w"> </span><span class="err">등으로</span><span class="w"> </span><span class="err">근사</span>
</code></pre></div>

<h3 id="33-pseudo-lru-tree-based">3.3 Pseudo-LRU (Tree-based)<a class="header-link" href="#33-pseudo-lru-tree-based" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>트리 기반 근사 LRU (4-way 예시):

          ┌───┐
          │ 0 │  ← 루트: 0이면 왼쪽, 1이면 오른쪽이 더 최근
          └─┬─┘
        ┌───┴───┐
      ┌─┴─┐   ┌─┴─┐
      │ 0 │   │ 1 │  ← 내부 노드
      └─┬─┘   └─┬─┘
     ┌──┴──┐ ┌──┴──┐
     │     │ │     │
    Way0  Way1 Way2 Way3

교체할 Way 찾기:
1. 루트에서 시작
2. 비트가 0이면 왼쪽, 1이면 오른쪽으로 이동
3. 리프에 도달하면 해당 Way 교체

접근 시 비트 갱신:
- 접근한 Way로 가는 경로의 비트들을 반대 방향으로 설정
- 다음 교체 시 해당 Way를 피하도록 유도

장점: log2(N) 비트만 필요 (4-way: 3비트 vs 정확한 LRU: 더 많음)
단점: 정확한 LRU 순서를 보장하지 않음
</code></pre></div>

<h3 id="34-fifo-first-in-first-out">3.4 FIFO (First In, First Out)<a class="header-link" href="#34-fifo-first-in-first-out" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">먼저</span><span class="w"> </span><span class="err">들어온</span><span class="w"> </span><span class="err">블록</span><span class="w"> </span><span class="err">교체</span>

<span class="err">예시</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="err">캐시</span><span class="o">,</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">순서</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span>

<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">0</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="o">(</span><span class="n">A가</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">먼저</span><span class="o">)</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="n">E</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">교체</span><span class="o">):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="o">(</span><span class="n">B가</span><span class="w"> </span><span class="err">다음</span><span class="o">)</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A를</span><span class="w"> </span><span class="err">최근에</span><span class="w"> </span><span class="err">접근했어도</span><span class="o">!):</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Head</span><span class="o">=</span><span class="mi">2</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">장점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">매우</span><span class="w"> </span><span class="err">간단한</span><span class="w"> </span><span class="err">구현</span><span class="w"> </span><span class="o">(</span><span class="err">포인터</span><span class="w"> </span><span class="err">하나</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">공정한</span><span class="w"> </span><span class="err">교체</span>

<span class="err">단점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">패턴</span><span class="w"> </span><span class="err">무시</span>
<span class="o">-</span><span class="w"> </span><span class="n">Belady</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">anomaly</span><span class="o">:</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">크기</span><span class="w"> </span><span class="err">증가</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">미스율</span><span class="w"> </span><span class="err">증가</span><span class="w"> </span><span class="err">가능</span>
</code></pre></div>

<h3 id="35-random">3.5 Random 교체<a class="header-link" href="#35-random" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">무작위로</span><span class="w"> </span><span class="err">블록</span><span class="w"> </span><span class="err">선택하여</span><span class="w"> </span><span class="err">교체</span>

<span class="err">구현</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">난수</span><span class="w"> </span><span class="err">생성기</span><span class="w"> </span><span class="err">사용</span>
<span class="o">-</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="err">간단한</span><span class="w"> </span><span class="err">카운터</span>

<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">C</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="n">E</span><span class="w"> </span><span class="err">삽입</span><span class="o">,</span><span class="w"> </span><span class="err">무작위</span><span class="w"> </span><span class="err">선택</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Way</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span>
<span class="err">┌────┬────┬────┬────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">B</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">E</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">D</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="err">교체됨</span>
<span class="err">└────┴────┴────┴────┘</span>

<span class="err">장점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">매우</span><span class="w"> </span><span class="err">간단한</span><span class="w"> </span><span class="err">구현</span>
<span class="o">-</span><span class="w"> </span><span class="err">병적인</span><span class="o">(</span><span class="n">pathological</span><span class="o">)</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">패턴에</span><span class="w"> </span><span class="err">강함</span>
<span class="o">-</span><span class="w"> </span><span class="n">Belady</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">anomaly</span><span class="w"> </span><span class="err">없음</span>

<span class="err">단점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">평균적으로</span><span class="w"> </span><span class="n">LRU보다</span><span class="w"> </span><span class="err">성능</span><span class="w"> </span><span class="err">낮음</span>
<span class="o">-</span><span class="w"> </span><span class="err">최근</span><span class="w"> </span><span class="err">사용</span><span class="w"> </span><span class="err">블록도</span><span class="w"> </span><span class="err">교체될</span><span class="w"> </span><span class="err">수</span><span class="w"> </span><span class="err">있음</span>

<span class="err">실제</span><span class="w"> </span><span class="err">사용</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">ARM</span><span class="w"> </span><span class="err">프로세서의</span><span class="w"> </span><span class="err">일부</span><span class="w"> </span><span class="err">캐시</span>
<span class="o">-</span><span class="w"> </span><span class="n">L2</span><span class="o">/</span><span class="n">L3</span><span class="w"> </span><span class="err">캐시에서</span><span class="w"> </span><span class="err">랜덤</span><span class="o">+</span><span class="n">LRU</span><span class="w"> </span><span class="err">혼합</span><span class="w"> </span><span class="err">사용</span>
</code></pre></div>

<h3 id="36">3.6 교체 정책 비교<a class="header-link" href="#36" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>미스율<span class="w"> </span>비교<span class="w"> </span><span class="ss">(</span>일반적인<span class="w"> </span>워크로드<span class="ss">)</span>:

┌────────────────┬───────────────┬───────────────────────────┐
│<span class="w">   </span>정책<span class="w">          </span>│<span class="w">  </span>상대<span class="w"> </span>미스율<span class="w">  </span>│<span class="w">          </span>특징<span class="w">              </span>│
├────────────────┼───────────────┼───────────────────────────┤
│<span class="w"> </span><span class="nv">Optimal</span><span class="w"> </span><span class="ss">(</span><span class="nv">OPT</span><span class="ss">)</span><span class="w">  </span>│<span class="w">    </span><span class="mi">1</span>.<span class="mi">00</span><span class="nv">x</span><span class="w">     </span>│<span class="w"> </span>이론적<span class="w"> </span>최적<span class="w"> </span><span class="ss">(</span>미래<span class="w"> </span>예측<span class="ss">)</span><span class="w">     </span>│
├────────────────┼───────────────┼───────────────────────────┤
│<span class="w"> </span><span class="nv">LRU</span><span class="w">            </span>│<span class="w">    </span><span class="mi">1</span>.<span class="mi">05</span><span class="nv">x</span><span class="w">     </span>│<span class="w"> </span>매우<span class="w"> </span>좋음,<span class="w"> </span>구현<span class="w"> </span>복잡<span class="w">        </span>│
├────────────────┼───────────────┼───────────────────────────┤
│<span class="w"> </span><span class="nv">Pseudo</span><span class="o">-</span><span class="nv">LRU</span><span class="w">     </span>│<span class="w">    </span><span class="mi">1</span>.<span class="mi">08</span><span class="nv">x</span><span class="w">     </span>│<span class="w"> </span><span class="nv">LRU</span><span class="w"> </span>근사,<span class="w"> </span>효율적<span class="w"> </span>구현<span class="w">      </span>│
├────────────────┼───────────────┼───────────────────────────┤
│<span class="w"> </span><span class="k">Random</span><span class="w">         </span>│<span class="w">    </span><span class="mi">1</span>.<span class="mi">15</span><span class="nv">x</span><span class="w">     </span>│<span class="w"> </span>간단함,<span class="w"> </span>합리적<span class="w"> </span>성능<span class="w">        </span>│
├────────────────┼───────────────┼───────────────────────────┤
│<span class="w"> </span><span class="nv">FIFO</span><span class="w">           </span>│<span class="w">    </span><span class="mi">1</span>.<span class="mi">20</span><span class="nv">x</span><span class="w">     </span>│<span class="w"> </span>가장<span class="w"> </span>간단,<span class="w"> </span>낮은<span class="w"> </span>성능<span class="w">       </span>│
└────────────────┴───────────────┴───────────────────────────┘
</code></pre></div>

<hr />
<h2 id="4">4. 캐시 쓰기 정책<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-write-through">4.1 Write-Through<a class="header-link" href="#41-write-through" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">쓰기</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">캐시와</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">모두</span><span class="w"> </span><span class="err">갱신</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">Write</span><span class="o">-</span><span class="n">Through</span><span class="w"> </span><span class="err">동작</span><span class="w">                        </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">         </span><span class="n">CPU</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">▼</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">┌─────────┐</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">  </span><span class="n">Cache</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">───────────────────────┐</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">│</span><span class="w">                        </span><span class="err">│</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">└─────────┘</span><span class="w">                        </span><span class="err">▼</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                  </span><span class="err">┌──────────┐</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                  </span><span class="err">│</span><span class="w">  </span><span class="n">Memory</span><span class="w">  </span><span class="err">│</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                  </span><span class="err">│</span><span class="w">  </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">│</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                  </span><span class="err">└──────────┘</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">캐시와</span><span class="w"> </span><span class="err">메모리가</span><span class="w"> </span><span class="err">항상</span><span class="w"> </span><span class="err">일치</span><span class="w"> </span><span class="o">(</span><span class="n">Consistent</span><span class="o">)</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">장점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시와</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">항상</span><span class="w"> </span><span class="err">일치</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="n">Write</span><span class="o">-</span><span class="n">back</span><span class="w"> </span><span class="err">불필요</span>
<span class="o">-</span><span class="w"> </span><span class="err">단순한</span><span class="w"> </span><span class="err">구현</span>
<span class="o">-</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">복구</span><span class="w"> </span><span class="err">용이</span><span class="w"> </span><span class="o">(</span><span class="err">정전</span><span class="w"> </span><span class="err">등</span><span class="o">)</span>

<span class="err">단점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">매</span><span class="w"> </span><span class="err">쓰기마다</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">느림</span>
<span class="o">-</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">대역폭</span><span class="w"> </span><span class="err">소모</span>

<span class="err">완화책</span><span class="o">:</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">Buffer</span>
<span class="err">┌──────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">     </span><span class="n">CPU</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">Buffer</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Memory</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                     </span><span class="err">↑</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">            </span><span class="err">버퍼가</span><span class="w"> </span><span class="err">다</span><span class="w"> </span><span class="err">찰</span><span class="w"> </span><span class="err">때까지</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="err">계속</span><span class="w"> </span><span class="err">진행</span><span class="w">    </span><span class="err">│</span>
<span class="err">└──────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="42-write-back">4.2 Write-Back<a class="header-link" href="#42-write-back" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">쓰기</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">캐시만</span><span class="w"> </span><span class="err">갱신</span><span class="o">,</span><span class="w"> </span><span class="err">메모리는</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">갱신</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                     </span><span class="n">Write</span><span class="o">-</span><span class="n">Back</span><span class="w"> </span><span class="err">동작</span><span class="w">                          </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="err">쓰기</span><span class="w"> </span><span class="err">발생</span><span class="w">                                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">         </span><span class="n">CPU</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="n">Write</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">▼</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">┌─────────┐</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">  </span><span class="n">Cache</span><span class="w">  </span><span class="err">│</span><span class="w">       </span><span class="err">메모리</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">없음</span><span class="o">!</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">│◄──</span><span class="w"> </span><span class="n">Dirty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">└─────────┘</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="err">시</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">┌─────────┐</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">  </span><span class="n">Cache</span><span class="w">  </span><span class="err">│</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">───</span><span class="w"> </span><span class="n">Dirty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">이면</span><span class="w"> </span><span class="err">메모리에</span><span class="w"> </span><span class="err">기록</span><span class="w"> </span><span class="err">───┐</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">└─────────┘</span><span class="w">                                    </span><span class="err">▼</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                             </span><span class="err">┌──────────┐</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                             </span><span class="err">│</span><span class="w">  </span><span class="n">Memory</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                             </span><span class="err">│</span><span class="w">  </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                             </span><span class="err">└──────────┘</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="n">Dirty</span><span class="w"> </span><span class="n">Bit</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">라인이</span><span class="w"> </span><span class="err">수정되었는지</span><span class="w"> </span><span class="err">표시</span>
<span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="err">수정됨</span><span class="w"> </span><span class="o">(</span><span class="err">메모리와</span><span class="w"> </span><span class="err">불일치</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="err">수정</span><span class="w"> </span><span class="err">안</span><span class="w"> </span><span class="err">됨</span><span class="w"> </span><span class="o">(</span><span class="err">메모리와</span><span class="w"> </span><span class="err">일치</span><span class="o">)</span>

<span class="err">장점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">쓰기</span><span class="w"> </span><span class="err">성능</span><span class="w"> </span><span class="err">향상</span><span class="w"> </span><span class="o">(</span><span class="err">메모리</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">감소</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">같은</span><span class="w"> </span><span class="err">주소</span><span class="w"> </span><span class="err">반복</span><span class="w"> </span><span class="err">쓰기에</span><span class="w"> </span><span class="err">효율적</span>
<span class="o">-</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">대역폭</span><span class="w"> </span><span class="err">절약</span>

<span class="err">단점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">구현</span><span class="w"> </span><span class="err">복잡</span><span class="w"> </span><span class="o">(</span><span class="n">Dirty</span><span class="w"> </span><span class="n">bit</span><span class="o">,</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="n">write</span><span class="o">-</span><span class="n">back</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시</span><span class="o">-</span><span class="err">메모리</span><span class="w"> </span><span class="err">불일치</span><span class="w"> </span><span class="err">가능</span>
<span class="o">-</span><span class="w"> </span><span class="err">교체</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">지연</span><span class="w"> </span><span class="err">발생</span>
</code></pre></div>

<h3 id="43-write-allocate-vs-no-write-allocate">4.3 Write Allocate vs No-Write Allocate<a class="header-link" href="#43-write-allocate-vs-no-write-allocate" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>쓰기 미스 시 처리 방식:

Write Allocate (Fetch on Write):
┌─────────────────────────────────────────────────────────────┐
│  쓰기 미스 발생                                              │
│       ↓                                                     │
│  블록을 메모리에서 캐시로 로드                                │
│       ↓                                                     │
│  캐시에서 쓰기 수행                                          │
│                                                             │
│  주로 Write-Back과 함께 사용                                 │
│  공간적 지역성 활용: 인접 데이터도 캐시에 로드                 │
└─────────────────────────────────────────────────────────────┘

No-Write Allocate (Write Around):
┌─────────────────────────────────────────────────────────────┐
│  쓰기 미스 발생                                              │
│       ↓                                                     │
│  메모리에 직접 쓰기 (캐시 로드 안 함)                         │
│                                                             │
│  주로 Write-Through와 함께 사용                              │
│  한 번만 쓰고 안 읽는 데이터에 효율적                         │
└─────────────────────────────────────────────────────────────┘

일반적인 조합:
┌──────────────────┬─────────────────┐
│  쓰기 정책        │  할당 정책       │
├──────────────────┼─────────────────┤
│  Write-Back     │  Write Allocate │
│  Write-Through  │  No-Write Alloc │
└──────────────────┴─────────────────┘
</code></pre></div>

<h3 id="44">4.4 쓰기 정책 비교<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────┬────────────────────┬────────────────────┐
│      특성        │   Write-Through   │    Write-Back     │
├─────────────────┼────────────────────┼────────────────────┤
│ 쓰기 지연       │     높음 (메모리)   │    낮음 (캐시)     │
├─────────────────┼────────────────────┼────────────────────┤
│ 구현 복잡도     │        낮음        │       높음         │
├─────────────────┼────────────────────┼────────────────────┤
│ 메모리 트래픽   │        높음        │       낮음         │
├─────────────────┼────────────────────┼────────────────────┤
│ 데이터 일관성   │        보장        │    관리 필요       │
├─────────────────┼────────────────────┼────────────────────┤
│ 교체 시 오버헤드│        없음        │   Dirty면 있음     │
├─────────────────┼────────────────────┼────────────────────┤
│ 실제 사용       │   L1 (일부), 임베디드│  L1, L2, L3      │
└─────────────────┴────────────────────┴────────────────────┘
</code></pre></div>

<hr />
<h2 id="5">5. 캐시 미스의 종류<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-3c">5.1 3C 분류<a class="header-link" href="#51-3c" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>캐시 미스의 세 가지 원인 (3C Model):

1. Cold Miss (Compulsory Miss) - 필수 미스
2. Capacity Miss - 용량 미스
3. Conflict Miss - 충돌 미스
</code></pre></div>

<h3 id="52-cold-miss-compulsory-miss">5.2 Cold Miss (Compulsory Miss)<a class="header-link" href="#52-cold-miss-compulsory-miss" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">정의</span><span class="o">:</span><span class="w"> </span><span class="err">처음</span><span class="w"> </span><span class="err">접근하는</span><span class="w"> </span><span class="err">블록에</span><span class="w"> </span><span class="err">대한</span><span class="w"> </span><span class="err">미스</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시가</span><span class="w"> </span><span class="err">비어있을</span><span class="w"> </span><span class="err">때</span><span class="w"> </span><span class="err">발생</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">크기와</span><span class="w"> </span><span class="err">무관하게</span><span class="w"> </span><span class="err">발생</span>
<span class="o">-</span><span class="w"> </span><span class="err">피할</span><span class="w"> </span><span class="err">수</span><span class="w"> </span><span class="err">없음</span><span class="w"> </span><span class="o">(</span><span class="err">프리페치로</span><span class="w"> </span><span class="err">완화</span><span class="w"> </span><span class="err">가능</span><span class="o">)</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="err">프로그램</span><span class="w"> </span><span class="err">시작</span><span class="w"> </span><span class="err">시</span><span class="o">:</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="o">(</span><span class="n">A</span><span class="w"> </span><span class="err">첫</span><span class="w"> </span><span class="err">접근</span><span class="o">)</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="o">(</span><span class="n">B</span><span class="w"> </span><span class="err">첫</span><span class="w"> </span><span class="err">접근</span><span class="o">)</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Hit</span><span class="w">  </span><span class="o">(</span><span class="err">이미</span><span class="w"> </span><span class="err">캐시에</span><span class="w"> </span><span class="err">있음</span><span class="o">)</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="o">(</span><span class="n">C</span><span class="w"> </span><span class="err">첫</span><span class="w"> </span><span class="err">접근</span><span class="o">)</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">처음</span><span class="w"> </span><span class="mi">3</span><span class="err">번의</span><span class="w"> </span><span class="err">미스는</span><span class="w"> </span><span class="n">Cold</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">완화</span><span class="w"> </span><span class="err">방법</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">프리페칭</span><span class="w"> </span><span class="o">(</span><span class="n">Prefetching</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">더</span><span class="w"> </span><span class="err">큰</span><span class="w"> </span><span class="err">블록</span><span class="w"> </span><span class="err">크기</span><span class="w"> </span><span class="o">(</span><span class="err">공간적</span><span class="w"> </span><span class="err">지역성</span><span class="w"> </span><span class="err">활용</span><span class="o">)</span>
</code></pre></div>

<h3 id="53-capacity-miss">5.3 Capacity Miss<a class="header-link" href="#53-capacity-miss" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">정의</span><span class="o">:</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">용량</span><span class="w"> </span><span class="err">부족으로</span><span class="w"> </span><span class="err">인한</span><span class="w"> </span><span class="err">미스</span>
<span class="o">-</span><span class="w"> </span><span class="n">Working</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">크기일</span><span class="w"> </span><span class="err">때</span><span class="w"> </span><span class="err">발생</span>
<span class="o">-</span><span class="w"> </span><span class="err">이전에</span><span class="w"> </span><span class="err">있던</span><span class="w"> </span><span class="err">블록이</span><span class="w"> </span><span class="err">용량</span><span class="w"> </span><span class="err">부족으로</span><span class="w"> </span><span class="err">교체된</span><span class="w"> </span><span class="err">후</span><span class="w"> </span><span class="err">재접근</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="mi">4</span><span class="o">-</span><span class="err">블록</span><span class="w"> </span><span class="err">캐시</span><span class="o">,</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="err">캐시</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="o">-,</span><span class="w"> </span><span class="o">-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="err">캐시</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="o">-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="err">캐시</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="o">-]</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="err">캐시</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">]</span><span class="w">  </span><span class="err">←</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">가득</span><span class="w"> </span><span class="err">참</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="o">,</span><span class="w"> </span><span class="err">캐시</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">B</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">]</span><span class="w">  </span><span class="err">←</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">교체됨</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="o">!</span><span class="w">                     </span><span class="err">←</span><span class="w"> </span><span class="n">Capacity</span><span class="w"> </span><span class="n">Miss</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">캐시</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">C</span><span class="o">,</span><span class="w"> </span><span class="n">D</span><span class="o">]</span><span class="w">        </span><span class="o">(</span><span class="n">A가</span><span class="w"> </span><span class="err">용량</span><span class="w"> </span><span class="err">부족으로</span><span class="w"> </span><span class="err">밀림</span><span class="o">)</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">완화</span><span class="w"> </span><span class="err">방법</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">크기</span><span class="w"> </span><span class="err">증가</span>
<span class="o">-</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">구조</span><span class="w"> </span><span class="err">최적화</span><span class="w"> </span><span class="o">(</span><span class="n">Working</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="err">감소</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">루프</span><span class="w"> </span><span class="err">타일링</span><span class="w"> </span><span class="err">등</span><span class="w"> </span><span class="err">알고리즘</span><span class="w"> </span><span class="err">최적화</span>
</code></pre></div>

<h3 id="54-conflict-miss">5.4 Conflict Miss<a class="header-link" href="#54-conflict-miss" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">정의</span><span class="o">:</span><span class="w"> </span><span class="err">같은</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">위치를</span><span class="w"> </span><span class="err">경쟁하는</span><span class="w"> </span><span class="err">블록들로</span><span class="w"> </span><span class="err">인한</span><span class="w"> </span><span class="err">미스</span>
<span class="o">-</span><span class="w"> </span><span class="err">직접</span><span class="w"> </span><span class="err">사상</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="err">집합</span><span class="w"> </span><span class="err">연관</span><span class="w"> </span><span class="err">캐시에서</span><span class="w"> </span><span class="err">발생</span>
<span class="o">-</span><span class="w"> </span><span class="err">캐시에</span><span class="w"> </span><span class="err">공간이</span><span class="w"> </span><span class="err">있어도</span><span class="w"> </span><span class="err">특정</span><span class="w"> </span><span class="err">위치</span><span class="w"> </span><span class="err">경쟁으로</span><span class="w"> </span><span class="err">미스</span>
<span class="o">-</span><span class="w"> </span><span class="err">완전</span><span class="w"> </span><span class="err">연관</span><span class="w"> </span><span class="err">캐시에서는</span><span class="w"> </span><span class="err">발생하지</span><span class="w"> </span><span class="err">않음</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="mi">2</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="err">캐시</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">집합</span><span class="o">,</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">순서</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">(</span><span class="err">모두</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="err">에</span><span class="w"> </span><span class="err">매핑</span><span class="o">)</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">초기</span><span class="o">:</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="o">-],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">A</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">  </span><span class="err">←</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">가득</span><span class="w"> </span><span class="err">참</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">I</span><span class="o">,</span><span class="w"> </span><span class="n">E</span><span class="o">],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">  </span><span class="err">←</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">교체</span><span class="o">,</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="err">은</span><span class="w"> </span><span class="err">비어있음</span><span class="o">!</span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Miss</span><span class="o">!</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="n">Conflict</span><span class="w"> </span><span class="n">Miss</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">Set</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="o">[</span><span class="n">I</span><span class="o">,</span><span class="w"> </span><span class="n">A</span><span class="o">],</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">[-,</span><span class="w"> </span><span class="o">-]</span><span class="w">  </span><span class="o">(</span><span class="n">Set</span><span class="w"> </span><span class="mi">1</span><span class="err">은</span><span class="w"> </span><span class="err">여전히</span><span class="w"> </span><span class="err">비어있음</span><span class="o">)</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">캐시의</span><span class="w"> </span><span class="mi">50</span><span class="o">%</span><span class="err">가</span><span class="w"> </span><span class="err">비어있는데도</span><span class="w"> </span><span class="err">미스</span><span class="w"> </span><span class="err">발생</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Conflict</span><span class="w"> </span><span class="n">Miss</span><span class="w">          </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">완화</span><span class="w"> </span><span class="err">방법</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">연관도</span><span class="w"> </span><span class="err">증가</span><span class="w"> </span><span class="o">(</span><span class="n">N</span><span class="o">-</span><span class="n">way</span><span class="w"> </span><span class="err">증가</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">스큐드</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="o">(</span><span class="n">Skewed</span><span class="w"> </span><span class="n">Cache</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">빅팀</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="o">(</span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span><span class="o">)</span>
</code></pre></div>

<h3 id="55-3c">5.5 3C 미스 비율<a class="header-link" href="#55-3c" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>일반적인 프로그램의 미스 비율:

┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  │ 100%│ ████████████████████████████████████████          │
│  │     │ █      Compulsory (Cold)     █                    │
│  │     │ █████████████████████████████                     │
│  │  50%│ █     Capacity              █                     │
│  │     │ █████████████████████████████████████████         │
│  │     │ █           Conflict         █                    │
│  │   0%│                                                   │
│  └─────┴─────────────────────────────────────────          │
│        작은 캐시  ────────────────▶  큰 캐시               │
│                                                             │
│  - 캐시 크기 증가: Capacity Miss 감소                        │
│  - 연관도 증가: Conflict Miss 감소                          │
│  - Cold Miss: 캐시 크기와 거의 무관                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="6">6. 다중 레벨 캐시<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 다중 레벨 캐시의 필요성<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">문제</span><span class="o">:</span><span class="w"> </span><span class="n">L1</span><span class="w"> </span><span class="err">캐시</span><span class="w"> </span><span class="err">최적화의</span><span class="w"> </span><span class="err">딜레마</span>
<span class="o">-</span><span class="w"> </span><span class="err">히트</span><span class="w"> </span><span class="err">시간</span><span class="w"> </span><span class="err">최적화</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">작은</span><span class="w"> </span><span class="err">캐시</span><span class="o">,</span><span class="w"> </span><span class="err">낮은</span><span class="w"> </span><span class="err">연관도</span>
<span class="o">-</span><span class="w"> </span><span class="err">미스율</span><span class="w"> </span><span class="err">최적화</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">큰</span><span class="w"> </span><span class="err">캐시</span><span class="o">,</span><span class="w"> </span><span class="err">높은</span><span class="w"> </span><span class="err">연관도</span>

<span class="err">해결</span><span class="o">:</span><span class="w"> </span><span class="err">다중</span><span class="w"> </span><span class="err">레벨</span><span class="w"> </span><span class="err">캐시</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">        </span><span class="n">CPU</span><span class="w">  </span><span class="err">←</span><span class="w"> </span><span class="err">빠른</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">필요</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">         </span><span class="err">│</span><span class="w">                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">┌────┴────┐</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">L1</span><span class="w"> </span><span class="err">캐시</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">작고</span><span class="w"> </span><span class="err">빠름</span><span class="w"> </span><span class="o">(</span><span class="err">히트</span><span class="w"> </span><span class="err">시간</span><span class="w"> </span><span class="err">최적화</span><span class="o">)</span><span class="w">                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="mi">32</span><span class="n">KB</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="err">사이클</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">└────┬────┘</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">         </span><span class="err">│</span><span class="w">                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">┌────┴────┐</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">L2</span><span class="w"> </span><span class="err">캐시</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">중간</span><span class="w"> </span><span class="o">(</span><span class="err">균형</span><span class="o">)</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="mi">256</span><span class="n">KB</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mi">12</span><span class="w"> </span><span class="err">사이클</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">└────┬────┘</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">         </span><span class="err">│</span><span class="w">                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">┌────┴────┐</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">L3</span><span class="w"> </span><span class="err">캐시</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="err">크고</span><span class="w"> </span><span class="err">공유</span><span class="w"> </span><span class="o">(</span><span class="err">미스율</span><span class="w"> </span><span class="err">최적화</span><span class="o">)</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="mi">8</span><span class="o">-</span><span class="mi">32</span><span class="n">MB</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="mi">40</span><span class="w"> </span><span class="err">사이클</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">└────┬────┘</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">         </span><span class="err">│</span><span class="w">                                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">┌────┴────┐</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="err">메모리</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mi">100</span><span class="o">+</span><span class="w"> </span><span class="err">사이클</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">└─────────┘</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="62-inclusive-vs-exclusive">6.2 Inclusive vs Exclusive 캐시<a class="header-link" href="#62-inclusive-vs-exclusive" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Inclusive Cache:
- 하위 레벨이 상위 레벨의 데이터를 포함
- L1의 모든 데이터가 L2에도 있음
- L2의 모든 데이터가 L3에도 있음

┌─────────────────────────────────────────────────────────────┐
│  L1: [A, B, C, D]                                           │
│  L2: [A, B, C, D, E, F, G, H, ...]                          │
│  L3: [A, B, C, D, E, F, G, H, ..., X, Y, Z]                 │
│                                                             │
│  장점:                                                      │
│  - 캐시 일관성 유지 쉬움                                     │
│  - 스누핑 시 L3만 확인하면 됨                                │
│                                                             │
│  단점:                                                      │
│  - 유효 용량 감소 (중복 저장)                                │
│  - L3 교체 시 L1/L2도 무효화 필요                            │
└─────────────────────────────────────────────────────────────┘

Exclusive Cache:
- 각 레벨이 서로 다른 데이터 저장
- 한 블록은 한 레벨에만 존재

┌─────────────────────────────────────────────────────────────┐
│  L1: [A, B, C, D]                                           │
│  L2: [E, F, G, H]  (L1에 없는 데이터)                        │
│  L3: [I, J, K, L]  (L1, L2에 없는 데이터)                    │
│                                                             │
│  장점:                                                      │
│  - 전체 유효 용량 = L1 + L2 + L3                            │
│                                                             │
│  단점:                                                      │
│  - 캐시 간 데이터 이동 복잡                                  │
│  - L1 미스 시 L2, L3 순차 검색 필요                          │
└─────────────────────────────────────────────────────────────┘

NINE (Non-Inclusive, Non-Exclusive):
- 일관성 보장 없이 자유롭게 배치
- 구현 복잡하지만 유연
</code></pre></div>

<h3 id="63-vs">6.3 전용 캐시 vs 공유 캐시<a class="header-link" href="#63-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>현대 멀티코어 프로세서 구조:

┌─────────────────────────────────────────────────────────────┐
│                                                             │
│     Core 0          Core 1          Core 2          Core 3  │
│    ┌──────┐        ┌──────┐        ┌──────┐        ┌──────┐│
│    │ L1-I │        │ L1-I │        │ L1-I │        │ L1-I ││
│    │ L1-D │        │ L1-D │        │ L1-D │        │ L1-D ││
│    └──┬───┘        └──┬───┘        └──┬───┘        └──┬───┘│
│       │               │               │               │    │
│    ┌──┴───┐        ┌──┴───┐        ┌──┴───┐        ┌──┴───┐│
│    │  L2  │        │  L2  │        │  L2  │        │  L2  ││
│    │(전용)│        │(전용)│        │(전용)│        │(전용)││
│    └──┬───┘        └──┬───┘        └──┬───┘        └──┬───┘│
│       │               │               │               │    │
│       └───────────────┴───────┬───────┴───────────────┘    │
│                               │                             │
│                      ┌────────┴────────┐                    │
│                      │       L3        │                    │
│                      │     (공유)       │                    │
│                      │    8-32MB       │                    │
│                      └────────┬────────┘                    │
│                               │                             │
│                      ┌────────┴────────┐                    │
│                      │    Main Memory   │                    │
│                      └─────────────────┘                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘

전용 캐시 (L1, L2):
- 각 코어 전용
- 접근 지연 최소화
- 코어 간 간섭 없음

공유 캐시 (L3):
- 모든 코어가 공유
- 코어 간 데이터 공유 효율적
- 동적 용량 할당 (바쁜 코어에 더 많은 공간)
- 일관성 유지 필요
</code></pre></div>

<h3 id="64-local-vs-global">6.4 Local vs Global 미스율<a class="header-link" href="#64-local-vs-global" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Local Miss Rate:
해당 레벨에서의 미스율

Global Miss Rate:
전체 접근 중 해당 레벨까지 도달하는 비율

예시:
- L1 미스율: 5%
- L2 미스율 (Local): 20%
- L3 미스율 (Local): 30%

Global 미스율 계산:
- L2 Global Miss Rate = L1 Miss Rate × L2 Local Miss Rate
                      = 0.05 × 0.20 = 1%
                      (전체 접근의 1%가 L3에 도달)

- L3 Global Miss Rate = L2 Global × L3 Local
                      = 0.01 × 0.30 = 0.3%
                      (전체 접근의 0.3%가 메모리에 도달)

┌─────────────────────────────────────────────────────────────┐
│          Local vs Global Miss Rate                          │
├─────────────────────────────────────────────────────────────┤
│  Level  │  Local Miss Rate  │  Global Miss Rate            │
├─────────┼───────────────────┼─────────────────────────────-┤
│   L1    │       5%          │       5%                     │
│   L2    │      20%          │       1% (0.05 × 0.20)      │
│   L3    │      30%          │      0.3% (0.01 × 0.30)     │
└─────────┴───────────────────┴──────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="7">7. 캐시 최적화 기법<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-victim-cache">7.1 Victim Cache<a class="header-link" href="#71-victim-cache" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">목적</span><span class="o">:</span><span class="w"> </span><span class="n">Conflict</span><span class="w"> </span><span class="n">Miss</span><span class="w"> </span><span class="err">감소</span>

<span class="err">구조</span><span class="o">:</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">┌─────────────────────────────────────┐</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">        </span><span class="n">Main</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="o">(</span><span class="n">Direct</span><span class="w"> </span><span class="n">Mapped</span><span class="o">)</span><span class="w">   </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">└──────────────────┬──────────────────┘</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                    </span><span class="err">교체된</span><span class="w"> </span><span class="err">블록</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">▼</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">┌─────────────────────────────────────┐</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="o">(</span><span class="n">Fully</span><span class="w"> </span><span class="n">Associative</span><span class="o">)</span><span class="w"> </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w">         </span><span class="mi">4</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">entries</span><span class="w">                 </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="err">└─────────────────────────────────────┘</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">동작</span><span class="o">:</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="err">미스</span><span class="w"> </span><span class="err">발생</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="err">검색</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache에</span><span class="w"> </span><span class="err">있으면</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">스왑하여</span><span class="w"> </span><span class="err">히트</span>
<span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="err">없으면</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">메모리에서</span><span class="w"> </span><span class="err">로드</span><span class="o">,</span><span class="w"> </span><span class="err">교체된</span><span class="w"> </span><span class="err">블록은</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache로</span>

<span class="err">효과</span><span class="o">:</span><span class="w"> </span><span class="err">충돌</span><span class="w"> </span><span class="err">미스를</span><span class="w"> </span><span class="n">Victim</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="err">크기만큼</span><span class="w"> </span><span class="err">흡수</span>
</code></pre></div>

<h3 id="72-prefetching">7.2 프리페칭 (Prefetching)<a class="header-link" href="#72-prefetching" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">하드웨어</span><span class="w"> </span><span class="nl">프리페치</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">CPU가</span><span class="w"> </span><span class="n">접근</span><span class="w"> </span><span class="n">패턴</span><span class="w"> </span><span class="n">감지</span>
<span class="o">-</span><span class="w"> </span><span class="n">다음에</span><span class="w"> </span><span class="n">필요할</span><span class="w"> </span><span class="n">블록을</span><span class="w"> </span><span class="n">미리</span><span class="w"> </span><span class="n">로드</span>

<span class="n">소프트웨어</span><span class="w"> </span><span class="nl">프리페치</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">프로그래머</span><span class="o">/</span><span class="n">컴파일러가</span><span class="w"> </span><span class="n">프리페치</span><span class="w"> </span><span class="n">명령</span><span class="w"> </span><span class="n">삽입</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">소프트웨어</span><span class="w"> </span><span class="n">프리페치</span><span class="w"> </span><span class="n">예시</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="n">__builtin_prefetch</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="o">[</span><span class="n">i + 16</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="mi">16</span><span class="n">개</span><span class="w"> </span><span class="n">앞</span><span class="w"> </span><span class="n">프리페치</span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="nf">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">}</span><span class="w">                                                          </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="n">프리페치</span><span class="w"> </span><span class="nl">효과</span><span class="p">:</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="k">Without</span><span class="w"> </span><span class="nl">Prefetch</span><span class="p">:</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">요청</span><span class="w"> </span><span class="err">─────┬─────</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">지연</span><span class="w"> </span><span class="err">─────┬─────</span><span class="w"> </span><span class="n">처리</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="k">With</span><span class="w"> </span><span class="nl">Prefetch</span><span class="p">:</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">프리페치</span><span class="w"> </span><span class="err">────┬─────</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">지연</span><span class="w"> </span><span class="err">─────┬</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">                       </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="n">요청</span><span class="w"> </span><span class="err">─────┼─────</span><span class="w"> </span><span class="n">데이터</span><span class="w"> </span><span class="n">도착</span><span class="err">!</span><span class="w"> </span><span class="err">────┼─────</span><span class="w"> </span><span class="n">처리</span><span class="w"> </span><span class="p">(</span><span class="n">빠름</span><span class="p">)</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">프리페치가</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">지연을</span><span class="w"> </span><span class="n">숨김</span><span class="w">                               </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="73">7.3 컴파일러 최적화<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">루프</span><span class="w"> </span><span class="n">교환</span><span class="w"> </span><span class="p">(</span><span class="n">Loop</span><span class="w"> </span><span class="n">Interchange</span><span class="p">)</span><span class="err">:</span>
<span class="o">//</span><span class="w"> </span><span class="k">Before</span><span class="err">:</span><span class="w"> </span><span class="n">열</span><span class="w"> </span><span class="n">우선</span><span class="w"> </span><span class="p">(</span><span class="n">나쁜</span><span class="w"> </span><span class="n">지역성</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="err">:</span><span class="w"> </span><span class="n">행</span><span class="w"> </span><span class="n">우선</span><span class="w"> </span><span class="p">(</span><span class="n">좋은</span><span class="w"> </span><span class="n">지역성</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>


<span class="n">루프</span><span class="w"> </span><span class="n">융합</span><span class="w"> </span><span class="p">(</span><span class="n">Loop</span><span class="w"> </span><span class="k">Fusion</span><span class="p">)</span><span class="err">:</span>
<span class="o">//</span><span class="w"> </span><span class="k">Before</span><span class="err">:</span><span class="w"> </span><span class="n">두</span><span class="w"> </span><span class="n">개의</span><span class="w"> </span><span class="n">루프</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="err">:</span><span class="w"> </span><span class="n">하나의</span><span class="w"> </span><span class="n">루프</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="n">가</span><span class="w"> </span><span class="n">캐시에</span><span class="w"> </span><span class="n">있을</span><span class="w"> </span><span class="n">때</span><span class="w"> </span><span class="n">바로</span><span class="w"> </span><span class="n">사용</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">c</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="err">}</span>


<span class="n">루프</span><span class="w"> </span><span class="n">타일링</span><span class="w"> </span><span class="p">(</span><span class="n">Loop</span><span class="w"> </span><span class="n">Tiling</span><span class="p">)</span><span class="err">:</span>
<span class="o">//</span><span class="w"> </span><span class="k">Before</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="w">            </span><span class="n">C</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="o">[</span><span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">After</span><span class="w"> </span><span class="p">(</span><span class="n">블록</span><span class="w"> </span><span class="n">단위</span><span class="w"> </span><span class="n">처리로</span><span class="w"> </span><span class="n">캐시</span><span class="w"> </span><span class="n">재사용</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">BLOCK</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ii</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ii</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jj</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">jj</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kk</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">kk</span><span class="o">+</span><span class="n">BLOCK</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="w">                        </span><span class="n">C</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">k</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="o">[</span><span class="n">k</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>
</code></pre></div>

<hr />
<h2 id="8">8. 연습 문제<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="_4">기초 문제<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>32KB 직접 사상 캐시, 64바이트 블록일 때 캐시 라인 수는?</p>
</li>
<li>
<p>4-way 집합 연관 캐시에서 특정 메모리 블록이 저장될 수 있는 위치는 몇 개인가?</p>
</li>
<li>
<p>Write-Through와 Write-Back의 차이를 설명하시오.</p>
</li>
</ol>
<h3 id="_5">중급 문제<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<ol>
<li>다음 주소에서 Tag, Index, Offset을 구하시오:</li>
<li>주소: 0x12345678</li>
<li>
<p>캐시: 16KB, 2-way 집합 연관, 64바이트 라인</p>
</li>
<li>
<p>다음 접근 패턴에서 캐시 미스의 종류를 분류하시오:
   (4-라인 직접 사상 캐시, 블록 A~D는 같은 인덱스에 매핑)
   <code>A, B, C, D, A, E, A</code></p>
</li>
<li>
<p>L1 캐시: 히트시간 2사이클, 미스율 10%
   L2 캐시: 히트시간 10사이클, 미스율 5%
   메모리: 접근시간 100사이클
   AMAT를 구하시오.</p>
</li>
</ol>
<h3 id="_6">심화 문제<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>다음 코드의 캐시 성능을 분석하시오 (64바이트 캐시 라인, 4바이트 int):
   <code>c
   int a[1024], b[1024], c[1024];
   for (int i = 0; i &lt; 1024; i++)
       c[i] = a[i] + b[i];</code></p>
</li>
<li>
<p>8-way 집합 연관 캐시에서 LRU 정책을 정확히 구현하려면 각 집합당 몇 비트가 필요한가?</p>
</li>
<li>
<p>Victim Cache가 Conflict Miss를 줄이는 원리를 설명하시오.</p>
</li>
</ol>
<details>
<summary>정답</summary>

1. 캐시 라인 수 = 32KB / 64B = 512 라인

2. 4개 (4-way = 각 집합에 4개 위치)

3. Write-Through: 캐시와 메모리 동시 갱신, 일관성 보장
   Write-Back: 캐시만 갱신, 교체 시 메모리 갱신, 성능 우수

4. 주소 분해:
   - 16KB, 2-way → 128 집합 (16KB / 64B / 2 = 128)
   - Offset: 6비트 (64B = 2^6)
   - Index: 7비트 (128 = 2^7)
   - Tag: 32 - 6 - 7 = 19비트

   0x12345678 = 0001 0010 0011 0100 0101 0110 0111 1000
   - Offset: 111000 (0x38)
   - Index: 1011001 (0x59)
   - Tag: 0001 0010 0011 0100 0101 (0x12345)

5. 미스 분류:
   - A: Cold Miss (첫 접근)
   - B: Cold Miss
   - C: Cold Miss
   - D: Cold Miss
   - A: Conflict Miss (D에 의해 교체됨)
   - E: Conflict Miss + Cold Miss
   - A: Conflict Miss (E에 의해 교체됨)

6. AMAT = 2 + 0.10 × (10 + 0.05 × 100)
        = 2 + 0.10 × 15
        = 2 + 1.5
        = 3.5 사이클

7. 캐시 분석:
   - 64바이트 라인 = 16개 int
   - 각 배열 1024개 int = 64 캐시 라인
   - 순차 접근 → 16번 접근당 1번 미스
   - Cold Miss: 64 × 3 = 192번 (a, b, c 각각)
   - 히트: (1024 - 64) × 3 = 2880번
   - 히트율: 2880 / 3072 = 93.75%

8. 정확한 LRU 구현:
   - 8개 Way의 순서 표현: 8! = 40320 상태
   - 필요 비트: log2(40320) ≈ 16비트
   (실제로는 근사 LRU 사용)

9. Victim Cache 원리:
   - Main Cache에서 교체된 블록을 Victim Cache에 보관
   - Conflict로 교체된 블록이 다시 필요할 때 Victim Cache에서 빠르게 찾음
   - 작은 완전 연관 캐시로 충돌 미스 흡수

</details>

<hr />
<h2 id="_7">다음 단계<a class="header-link" href="#_7" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./16_Virtual_Memory.md">16_Virtual_Memory.md</a> - 가상 주소 공간, 페이지 테이블, TLB</li>
</ul>
<hr />
<h2 id="_8">참고 자료<a class="header-link" href="#_8" title="Permanent link">&para;</a></h2>
<ul>
<li>Computer Architecture: A Quantitative Approach (Hennessy &amp; Patterson)</li>
<li><a href="https://www.ecs.umass.edu/ece/koren/architecture/Cache/frame1.htm">Cache Memory Visualization</a></li>
<li><a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel Optimization Manual - Cache</a></li>
<li>What Every Programmer Should Know About Memory (Ulrich Drepper)</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Computer_Architecture/14_Memory_Hierarchy.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">메모리 계층 구조</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Computer_Architecture/16_Virtual_Memory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">가상 메모리</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}