{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가상 메모리 - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Computer_Architecture/">Computer Architecture</a>
    <span class="separator">/</span>
    <span class="current">가상 메모리</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>가상 메모리</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Computer_Architecture/15_Cache_Memory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">캐시 메모리</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Computer_Architecture/17_IO_Systems.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">입출력 시스템</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">개요</a></li>
<li><a href="#_3">목차</a></li>
<li><a href="#1">1. 가상 메모리의 필요성</a><ul>
<li><a href="#11">1.1 가상 메모리 이전의 문제점</a></li>
<li><a href="#12">1.2 가상 메모리의 해결책</a></li>
</ul>
</li>
<li><a href="#2">2. 주소 공간</a><ul>
<li><a href="#21-vs">2.1 가상 주소 vs 물리 주소</a></li>
<li><a href="#22">2.2 주소 공간 크기</a></li>
</ul>
</li>
<li><a href="#3">3. 페이지와 페이지 프레임</a><ul>
<li><a href="#31">3.1 페이징 개념</a></li>
<li><a href="#32">3.2 페이지 크기</a></li>
<li><a href="#33">3.3 가상 주소 분해</a></li>
</ul>
</li>
<li><a href="#4">4. 페이지 테이블</a><ul>
<li><a href="#41">4.1 단일 레벨 페이지 테이블</a></li>
<li><a href="#42">4.2 다단계 페이지 테이블</a></li>
<li><a href="#43-4-x86-64">4.3 4단계 페이지 테이블 (x86-64)</a></li>
<li><a href="#44-inverted-page-table">4.4 역 페이지 테이블 (Inverted Page Table)</a></li>
</ul>
</li>
<li><a href="#5-tlb-translation-lookaside-buffer">5. TLB (Translation Lookaside Buffer)</a><ul>
<li><a href="#51-tlb">5.1 TLB의 필요성</a></li>
<li><a href="#52-tlb">5.2 TLB 구조</a></li>
<li><a href="#53-tlb">5.3 TLB 동작</a></li>
<li><a href="#54-tlb">5.4 TLB 성능</a></li>
</ul>
</li>
<li><a href="#6">6. 페이지 폴트와 페이지 교체</a><ul>
<li><a href="#61">6.1 페이지 폴트</a></li>
<li><a href="#62">6.2 페이지 폴트 비용</a></li>
<li><a href="#63-demand-paging-vs-prepaging">6.3 Demand Paging vs Prepaging</a></li>
</ul>
</li>
<li><a href="#7">7. 페이지 교체 알고리즘</a><ul>
<li><a href="#71-fifo-first-in-first-out">7.1 FIFO (First-In, First-Out)</a></li>
<li><a href="#72-optimal-opt">7.2 Optimal (OPT)</a></li>
<li><a href="#73-lru-least-recently-used">7.3 LRU (Least Recently Used)</a></li>
<li><a href="#74-clock-algorithm-second-chance">7.4 Clock Algorithm (Second Chance)</a></li>
<li><a href="#75">7.5 알고리즘 비교</a></li>
</ul>
</li>
<li><a href="#8">8. 고급 주제</a><ul>
<li><a href="#81-copy-on-write-cow">8.1 Copy-on-Write (COW)</a></li>
<li><a href="#82-mmap">8.2 메모리 맵 파일 (mmap)</a></li>
<li><a href="#83-huge-pages">8.3 Huge Pages</a></li>
</ul>
</li>
<li><a href="#9">9. 연습 문제</a><ul>
<li><a href="#_4">기초 문제</a></li>
<li><a href="#_5">중급 문제</a></li>
<li><a href="#_6">심화 문제</a></li>
</ul>
</li>
<li><a href="#_7">다음 단계</a></li>
<li><a href="#_8">참고 자료</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">가상 메모리<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">개요<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>가상 메모리(Virtual Memory)는 프로그램에게 연속적이고 독립적인 주소 공간을 제공하며, 물리 메모리보다 큰 프로그램도 실행할 수 있게 해주는 핵심 기술입니다. 이 레슨에서는 가상 메모리의 개념, 페이지 테이블, TLB, 페이지 폴트 처리 등을 학습합니다.</p>
<p><strong>난이도</strong>: ⭐⭐⭐⭐</p>
<p><strong>선수 지식</strong>: 메모리 계층 구조, 캐시 메모리</p>
<hr />
<h2 id="_3">목차<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-가상-메모리의-필요성">가상 메모리의 필요성</a></li>
<li><a href="#2-주소-공간">주소 공간</a></li>
<li><a href="#3-페이지와-페이지-프레임">페이지와 페이지 프레임</a></li>
<li><a href="#4-페이지-테이블">페이지 테이블</a></li>
<li><a href="#5-tlb-translation-lookaside-buffer">TLB (Translation Lookaside Buffer)</a></li>
<li><a href="#6-페이지-폴트와-페이지-교체">페이지 폴트와 페이지 교체</a></li>
<li><a href="#7-페이지-교체-알고리즘">페이지 교체 알고리즘</a></li>
<li><a href="#8-고급-주제">고급 주제</a></li>
<li><a href="#9-연습-문제">연습 문제</a></li>
</ol>
<hr />
<h2 id="1">1. 가상 메모리의 필요성<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 가상 메모리 이전의 문제점<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>문제 1: 메모리 용량 제한
┌─────────────────────────────────────────────────────────────┐
│  프로그램 A: 2GB 필요                                        │
│  물리 메모리: 1GB                                           │
│                                                             │
│  → 프로그램 A를 실행할 수 없음!                              │
└─────────────────────────────────────────────────────────────┘

문제 2: 메모리 단편화
┌─────────────────────────────────────────────────────────────┐
│  물리 메모리 상태:                                           │
│  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐        │
│  │ 사용 │ 빈틈 │ 사용 │ 빈틈 │ 사용 │ 빈틈 │ 사용 │        │
│  │ 100M │ 50M  │ 200M │ 30M  │ 100M │ 70M  │ 150M │        │
│  └──────┴──────┴──────┴──────┴──────┴──────┴──────┘        │
│                                                             │
│  총 빈 공간: 150MB, 하지만 100MB 연속 공간 없음              │
│  → 100MB 프로그램 로드 불가 (외부 단편화)                    │
└─────────────────────────────────────────────────────────────┘

문제 3: 메모리 보호 부재
┌─────────────────────────────────────────────────────────────┐
│  프로그램 A가 프로그램 B의 메모리 영역 접근 가능              │
│  → 보안 취약점, 시스템 불안정                                │
└─────────────────────────────────────────────────────────────┘

문제 4: 재배치 문제
┌─────────────────────────────────────────────────────────────┐
│  프로그램이 특정 주소에서 실행되도록 컴파일됨                 │
│  → 해당 주소가 사용 중이면 실행 불가                         │
│  → 프로그램마다 다른 주소로 재컴파일 필요                     │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="12">1.2 가상 메모리의 해결책<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    가상 메모리 시스템                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  프로그램 A        프로그램 B        프로그램 C              │
│  ┌─────────┐      ┌─────────┐      ┌─────────┐             │
│  │ Virtual │      │ Virtual │      │ Virtual │             │
│  │ Address │      │ Address │      │ Address │             │
│  │  Space  │      │  Space  │      │  Space  │             │
│  │  0~4GB  │      │  0~4GB  │      │  0~4GB  │             │
│  └────┬────┘      └────┬────┘      └────┬────┘             │
│       │                │                │                   │
│       └────────────────┼────────────────┘                   │
│                        │                                    │
│              ┌─────────┴─────────┐                          │
│              │    MMU (Memory     │                          │
│              │ Management Unit)   │                          │
│              │   가상→물리 변환    │                          │
│              └─────────┬─────────┘                          │
│                        │                                    │
│              ┌─────────┴─────────┐                          │
│              │   Physical Memory  │                          │
│              │      (1GB 등)      │                          │
│              └─────────┬─────────┘                          │
│                        │                                    │
│              ┌─────────┴─────────┐                          │
│              │    Disk (Swap)    │                          │
│              │   (수백 GB)        │                          │
│              └───────────────────┘                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘

가상 메모리의 장점:
1. 용량 확장: 디스크를 메모리 확장으로 사용
2. 메모리 보호: 각 프로세스가 독립된 주소 공간
3. 메모리 공유: 여러 프로세스가 같은 물리 페이지 공유 가능
4. 단편화 해결: 비연속적 물리 메모리를 연속적으로 보이게
5. 재배치 투명성: 모든 프로그램이 같은 가상 주소에서 시작
</code></pre></div>

<hr />
<h2 id="2">2. 주소 공간<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-vs">2.1 가상 주소 vs 물리 주소<a class="header-link" href="#21-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>가상 주소 (Virtual Address):
- 프로그램이 사용하는 주소
- CPU가 생성하는 주소
- 프로세스마다 독립적인 공간

물리 주소 (Physical Address):
- 실제 메모리 하드웨어의 주소
- DRAM 칩에 접근하는 주소
- 시스템 전체에서 유일

┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   프로세스 A          프로세스 B          물리 메모리        │
│   가상 주소 공간      가상 주소 공간                         │
│                                                             │
│   0x00000000         0x00000000         0x00000000         │
│   ┌───────────┐      ┌───────────┐      ┌───────────┐      │
│   │   Code    │─────▶│   Code    │──┐   │  Frame 0  │      │
│   ├───────────┤      ├───────────┤  │   ├───────────┤      │
│   │   Data    │───┐  │   Data    │──┼──▶│  Frame 1  │      │
│   ├───────────┤   │  ├───────────┤  │   ├───────────┤      │
│   │   Heap    │   └─▶│   Heap    │──┼──▶│  Frame 2  │      │
│   ├───────────┤      ├───────────┤  │   ├───────────┤      │
│   │     ↓     │      │     ↓     │  └──▶│  Frame 3  │      │
│   │           │      │           │      ├───────────┤      │
│   │     ↑     │      │     ↑     │      │  Frame 4  │      │
│   ├───────────┤      ├───────────┤      ├───────────┤      │
│   │   Stack   │──────│   Stack   │─────▶│  Frame 5  │      │
│   └───────────┘      └───────────┘      └───────────┘      │
│   0xFFFFFFFF         0xFFFFFFFF         (실제 크기)        │
│                                                             │
│   같은 가상 주소 0x1000이 다른 물리 주소로 매핑될 수 있음     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="22">2.2 주소 공간 크기<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">32</span><span class="n">비트</span><span class="w"> </span><span class="n">시스템</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="n">공간</span><span class="p">:</span><span class="w"> </span><span class="mf">2</span><span class="o">^</span><span class="mf">32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4</span><span class="n">GB</span>
<span class="o">-</span><span class="w"> </span><span class="n">물리</span><span class="w"> </span><span class="n">메모리</span><span class="p">:</span><span class="w"> </span><span class="n">실제</span><span class="w"> </span><span class="n">장착된</span><span class="w"> </span><span class="n">용량</span><span class="w"> </span><span class="p">(</span><span class="n">예</span><span class="p">:</span><span class="w"> </span><span class="mf">4</span><span class="n">GB</span><span class="p">)</span>

<span class="mf">64</span><span class="n">비트</span><span class="w"> </span><span class="n">시스템</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">이론적</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">공간</span><span class="p">:</span><span class="w"> </span><span class="mf">2</span><span class="o">^</span><span class="mf">64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">16</span><span class="w"> </span><span class="n">엑사바이트</span>
<span class="o">-</span><span class="w"> </span><span class="n">실제</span><span class="w"> </span><span class="n">구현</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="o">-</span><span class="mf">64</span><span class="p">):</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mf">48</span><span class="n">비트</span><span class="w"> </span><span class="n">사용</span><span class="p">:</span><span class="w"> </span><span class="mf">256</span><span class="n">TB</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">공간</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">물리</span><span class="w"> </span><span class="n">주소</span><span class="p">:</span><span class="w"> </span><span class="mf">52</span><span class="n">비트까지</span><span class="w"> </span><span class="n">지원</span><span class="w"> </span><span class="p">(</span><span class="mf">4</span><span class="n">PB</span><span class="p">)</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">        </span><span class="n">x86</span><span class="o">-</span><span class="mf">64</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="n">공간</span><span class="w"> </span><span class="n">레이아웃</span><span class="w"> </span><span class="p">(</span><span class="mf">48</span><span class="n">비트</span><span class="p">)</span><span class="w">               </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">0</span><span class="n">xFFFF_FFFF_FFFF_FFFF</span><span class="w">  </span><span class="err">┌───────────────────┐</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">   </span><span class="n">Kernel</span><span class="w"> </span><span class="n">Space</span><span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">   </span><span class="p">(</span><span class="n">상위</span><span class="w"> </span><span class="n">절반</span><span class="p">)</span><span class="w">       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">0</span><span class="n">xFFFF_8000_0000_0000</span><span class="w">  </span><span class="err">├───────────────────┤</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">   </span><span class="n">Non</span><span class="o">-</span><span class="n">Canonical</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="n">사용</span><span class="w"> </span><span class="n">불가</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">    </span><span class="p">(</span><span class="n">hole</span><span class="p">)</span><span class="w">         </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">0</span><span class="n">x0000_7FFF_FFFF_FFFF</span><span class="w">  </span><span class="err">├───────────────────┤</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">   </span><span class="n">User</span><span class="w"> </span><span class="n">Space</span><span class="w">      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">   </span><span class="p">(</span><span class="n">하위</span><span class="w"> </span><span class="n">절반</span><span class="p">)</span><span class="w">       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mf">0</span><span class="n">x0000_0000_0000_0000</span><span class="w">  </span><span class="err">└───────────────────┘</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">각각</span><span class="w"> </span><span class="mf">128</span><span class="n">TB씩</span><span class="w"> </span><span class="n">사용</span><span class="w"> </span><span class="n">가능</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<hr />
<h2 id="3">3. 페이지와 페이지 프레임<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 페이징 개념<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>페이지 (Page):
- 가상 주소 공간을 고정 크기로 나눈 단위
- 일반적으로 4KB (4096 bytes)
- 가상 메모리의 관리 단위

페이지 프레임 (Frame):
- 물리 메모리를 같은 크기로 나눈 단위
- 페이지와 동일한 크기
- 물리 메모리의 관리 단위

┌─────────────────────────────────────────────────────────────┐
│                                                             │
│      가상 주소 공간              물리 메모리                 │
│                                                             │
│    ┌─────────────┐           ┌─────────────┐               │
│    │   Page 0    │──────────▶│  Frame 3    │               │
│    ├─────────────┤           ├─────────────┤               │
│    │   Page 1    │──────┐    │  Frame 0    │               │
│    ├─────────────┤      │    ├─────────────┤               │
│    │   Page 2    │      └───▶│  Frame 1    │               │
│    ├─────────────┤           ├─────────────┤               │
│    │   Page 3    │──────────▶│  Frame 4    │               │
│    ├─────────────┤           ├─────────────┤               │
│    │   Page 4    │─ (Disk)   │  Frame 2    │◀─ 다른 프로세스│
│    ├─────────────┤           ├─────────────┤               │
│    │   Page 5    │──────────▶│  Frame 5    │               │
│    └─────────────┘           └─────────────┘               │
│                                                             │
│    - Page와 Frame 크기 동일 (4KB)                           │
│    - 매핑은 임의적 (비연속 가능)                             │
│    - 일부 페이지는 디스크에 있을 수 있음                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="32">3.2 페이지 크기<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>일반적인 페이지 크기:
- 4KB (2^12): 가장 일반적
- 2MB (2^21): Large Page (Huge Page)
- 1GB (2^30): Gigantic Page

┌─────────────────────────────────────────────────────────────┐
│              페이지 크기 트레이드오프                         │
├────────────────┬───────────────────┬────────────────────────┤
│                │   작은 페이지 (4KB)│   큰 페이지 (2MB)      │
├────────────────┼───────────────────┼────────────────────────┤
│ 내부 단편화    │      적음         │       많음             │
├────────────────┼───────────────────┼────────────────────────┤
│ 페이지 테이블  │      큼           │       작음             │
├────────────────┼───────────────────┼────────────────────────┤
│ TLB 커버리지   │      작음         │       큼               │
├────────────────┼───────────────────┼────────────────────────┤
│ 디스크 전송    │     비효율적      │      효율적            │
├────────────────┼───────────────────┼────────────────────────┤
│ 적합한 경우    │   일반 프로그램   │   대용량 메모리 앱     │
└────────────────┴───────────────────┴────────────────────────┘

내부 단편화 예시:
- 프로세스가 4097 바이트 필요
- 4KB 페이지: 2페이지 필요 (8KB), 낭비 약 4KB
- 2MB 페이지: 1페이지 필요 (2MB), 낭비 약 2MB
</code></pre></div>

<h3 id="33">3.3 가상 주소 분해<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mi">4</span><span class="n">KB</span><span class="w"> </span><span class="n">페이지</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="n">비트</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">주소</span><span class="o">:</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="mi">31</span><span class="w">                              </span><span class="mi">12</span><span class="w">  </span><span class="mi">11</span><span class="w">                   </span><span class="mi">0</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">├────────────────────────────────┼────────────────────────┤│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="n">Virtual</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="n">Number</span><span class="w"> </span><span class="p">(</span><span class="n">VPN</span><span class="p">)</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="n">Page</span><span class="w"> </span><span class="n">Offset</span><span class="w">         </span><span class="err">││</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">         </span><span class="p">(</span><span class="mi">20</span><span class="w"> </span><span class="n">bits</span><span class="p">)</span><span class="w">              </span><span class="err">│</span><span class="w">     </span><span class="p">(</span><span class="mi">12</span><span class="w"> </span><span class="n">bits</span><span class="p">)</span><span class="w">          </span><span class="err">││</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────┴────────────────────────┘│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="n">Page</span><span class="w"> </span><span class="n">Offset</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="n">비트</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="n">KB</span><span class="w"> </span><span class="n">페이지</span><span class="w"> </span><span class="n">내</span><span class="w"> </span><span class="n">위치</span><span class="w"> </span><span class="p">(</span><span class="mi">0-4095</span><span class="p">)</span>
<span class="nl">VPN</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="n">비트</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">약</span><span class="w"> </span><span class="mi">100</span><span class="n">만</span><span class="w"> </span><span class="n">개의</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">페이지</span>

<span class="nl">예시</span><span class="p">:</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="mh">0x12345678</span>
<span class="o">-</span><span class="w"> </span><span class="n">VPN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x12345</span><span class="w"> </span><span class="p">(</span><span class="n">상위</span><span class="w"> </span><span class="mi">20</span><span class="n">비트</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">Offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x678</span><span class="w"> </span><span class="p">(</span><span class="n">하위</span><span class="w"> </span><span class="mi">12</span><span class="n">비트</span><span class="p">)</span>

<span class="n">변환</span><span class="w"> </span><span class="n">후</span><span class="w"> </span><span class="n">물리</span><span class="w"> </span><span class="n">주소</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">페이지</span><span class="w"> </span><span class="n">테이블에서</span><span class="w"> </span><span class="n">VPN</span><span class="w"> </span><span class="mh">0x12345</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">PFN</span><span class="w"> </span><span class="mh">0x00ABC</span>
<span class="o">-</span><span class="w"> </span><span class="n">물리</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00ABC000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x678</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00ABC678</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">가상</span><span class="w"> </span><span class="n">주소</span><span class="o">:</span><span class="w">  </span><span class="mh">0x12345</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mh">0x678</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">              </span><span class="p">(</span><span class="n">VPN</span><span class="p">)</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Offset</span><span class="p">)</span><span class="w">                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                </span><span class="err">↓</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">         </span><span class="p">[</span><span class="n">Page</span><span class="w"> </span><span class="n">Table</span><span class="p">]</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                </span><span class="err">↓</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">물리</span><span class="w"> </span><span class="n">주소</span><span class="o">:</span><span class="w">  </span><span class="mh">0x00ABC</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mh">0x678</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">              </span><span class="p">(</span><span class="n">PFN</span><span class="p">)</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Offset</span><span class="p">)</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="n">그대로</span><span class="w"> </span><span class="n">복사</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<hr />
<h2 id="4">4. 페이지 테이블<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 단일 레벨 페이지 테이블<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>구조:
┌─────────────────────────────────────────────────────────────┐
│                    Page Table                                │
├──────┬───────┬───────┬───────┬──────────────────────────────┤
│Index │ Valid │ PFN   │ Prot  │ Other Flags                  │
├──────┼───────┼───────┼───────┼──────────────────────────────┤
│  0   │   1   │ 0x003 │  RW   │ Present, Dirty               │
│  1   │   1   │ 0x001 │  R    │ Present                      │
│  2   │   0   │   -   │   -   │ Not Present (Disk)           │
│  3   │   1   │ 0x004 │  RW   │ Present                      │
│  4   │   1   │ 0x002 │  RWX  │ Present                      │
│ ...  │  ...  │  ...  │  ...  │ ...                          │
└──────┴───────┴───────┴───────┴──────────────────────────────┘

Page Table Entry (PTE) 구조 (x86, 32비트):
┌─────────────────────────────────────────────────────────────┐
│  31              12  11    9    8   7   6   5   4   3  2  1  0│
│  ├────────────────┼────────┼────┼───┼───┼───┼───┼───┼──┼──┼──┤│
│  │  Page Frame    │Reserved│ G  │PAT│ D │ A │PCD│PWT│U │W │P ││
│  │   Number       │        │    │   │   │   │   │   │/S│/R│  ││
│  └────────────────┴────────┴────┴───┴───┴───┴───┴───┴──┴──┴──┘│
└─────────────────────────────────────────────────────────────┘

P (Present): 페이지가 물리 메모리에 있음
W/R: 쓰기 가능 (1) / 읽기 전용 (0)
U/S: 사용자 접근 가능 (1) / 커널만 (0)
A (Accessed): 접근됨 (읽기 또는 쓰기)
D (Dirty): 수정됨 (쓰기)

문제점: 메모리 낭비
- 32비트 주소, 4KB 페이지: 2^20 = 1M 엔트리
- 엔트리당 4바이트: 4MB 페이지 테이블/프로세스
- 대부분의 공간이 사용되지 않아도 전체 테이블 필요
</code></pre></div>

<h3 id="42">4.2 다단계 페이지 테이블<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">2</span><span class="n">단계</span><span class="w"> </span><span class="n">페이지</span><span class="w"> </span><span class="n">테이블</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="n">비트</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="n">KB</span><span class="w"> </span><span class="n">페이지</span><span class="p">):</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="mf">31</span><span class="w">                </span><span class="mf">22</span><span class="w">  </span><span class="mf">21</span><span class="w">              </span><span class="mf">12</span><span class="w">  </span><span class="mf">11</span><span class="w">             </span><span class="mf">0</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">├──────────────────┼──────────────────┼──────────────────┤</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Page</span><span class="w"> </span><span class="n">Dir</span><span class="w"> </span><span class="n">Index</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="n">Page</span><span class="w"> </span><span class="nb">Tab</span><span class="n">le</span><span class="w"> </span><span class="n">Index</span><span class="w"> </span><span class="err">│</span><span class="w">   </span><span class="n">Page</span><span class="w"> </span><span class="n">Offset</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="p">(</span><span class="mf">10</span><span class="w"> </span><span class="n">bits</span><span class="p">)</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="p">(</span><span class="mf">10</span><span class="w"> </span><span class="n">bits</span><span class="p">)</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="p">(</span><span class="mf">12</span><span class="w"> </span><span class="n">bits</span><span class="p">)</span><span class="w">     </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└──────────────────┴──────────────────┴──────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="n">변환</span><span class="w"> </span><span class="n">과정</span><span class="p">:</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">Virtual</span><span class="w"> </span><span class="n">Address</span><span class="p">:</span><span class="w"> </span><span class="err">[</span><span class="n">Dir</span><span class="w"> </span><span class="n">Index</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="nb">Tab</span><span class="n">le</span><span class="w"> </span><span class="n">Index</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="n">Offset</span><span class="err">]</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                         </span><span class="err">▼</span><span class="w">            </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌─────────────────────────────┐</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="n">Page</span><span class="w"> </span><span class="n">Directory</span><span class="w"> </span><span class="p">(</span><span class="mf">4</span><span class="n">KB</span><span class="p">)</span><span class="w">     </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="mf">1024</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mf">4</span><span class="n">B</span><span class="w">        </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">┌─────────────────────┐</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">PT0</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">PT1</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">null</span><span class="w">     </span><span class="err">│←──</span><span class="w"> </span><span class="n">미사용</span><span class="w"> </span><span class="n">영역은</span><span class="w"> </span><span class="n">테이블</span><span class="w"> </span><span class="n">없음</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mf">...</span><span class="w">                </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">PTN</span><span class="w">      </span><span class="err">│────┼───┘</span><span class="w">           </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">└─────────────────────┘</span><span class="w">    </span><span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└─────────────────────────────┘</span><span class="w">               </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w">                              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                  </span><span class="err">▼</span><span class="w">                              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌─────────────────────────────┐</span><span class="w">              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="n">Page</span><span class="w"> </span><span class="nb">Tab</span><span class="n">le</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">(</span><span class="mf">4</span><span class="n">KB</span><span class="p">)</span><span class="w">       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="mf">1024</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mf">4</span><span class="n">B</span><span class="w">        </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">┌─────────────────────┐</span><span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="n">X</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="n">Y</span><span class="w">  </span><span class="err">│────┼──────────────┘</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="mf">...</span><span class="w">                </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">└─────────────────────┘</span><span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└─────────────────────────────┘</span><span class="w">              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                  </span><span class="err">│</span><span class="w">                              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                  </span><span class="err">▼</span><span class="w">                              </span><span class="err">│</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">        </span><span class="n">Physical</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Physical</span><span class="w"> </span><span class="n">Address</span><span class="w">        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="n">장점</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">사용하지</span><span class="w"> </span><span class="n">않는</span><span class="w"> </span><span class="n">영역은</span><span class="w"> </span><span class="n">페이지</span><span class="w"> </span><span class="n">테이블</span><span class="w"> </span><span class="n">할당</span><span class="w"> </span><span class="n">안</span><span class="w"> </span><span class="n">함</span>
<span class="o">-</span><span class="w"> </span><span class="n">대부분의</span><span class="w"> </span><span class="n">가상</span><span class="w"> </span><span class="n">공간이</span><span class="w"> </span><span class="n">비어있으면</span><span class="w"> </span><span class="n">큰</span><span class="w"> </span><span class="n">절약</span>
</code></pre></div>

<h3 id="43-4-x86-64">4.3 4단계 페이지 테이블 (x86-64)<a class="header-link" href="#43-4-x86-64" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">64</span><span class="n">비트</span><span class="w"> </span><span class="n">시스템의</span><span class="w"> </span><span class="mf">4</span><span class="n">단계</span><span class="w"> </span><span class="n">페이지</span><span class="w"> </span><span class="n">테이블</span><span class="p">:</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="mf">63</span><span class="w">    </span><span class="mf">48</span><span class="w"> </span><span class="mf">47</span><span class="w">    </span><span class="mf">39</span><span class="w"> </span><span class="mf">38</span><span class="w">    </span><span class="mf">30</span><span class="w"> </span><span class="mf">29</span><span class="w">    </span><span class="mf">21</span><span class="w"> </span><span class="mf">20</span><span class="w">    </span><span class="mf">12</span><span class="w"> </span><span class="mf">11</span><span class="w">         </span><span class="mf">0</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">├──────┼────────┼────────┼────────┼────────┼────────────┤</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">Sign</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="n">PML4</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="n">PDPT</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="n">PD</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="n">PT</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="n">Offset</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">Ext</span><span class="w">  </span><span class="err">│</span><span class="p">(</span><span class="mf">9</span><span class="n">bits</span><span class="p">)</span><span class="w"> </span><span class="err">│</span><span class="p">(</span><span class="mf">9</span><span class="n">bits</span><span class="p">)</span><span class="w"> </span><span class="err">│</span><span class="p">(</span><span class="mf">9</span><span class="n">bits</span><span class="p">)</span><span class="w"> </span><span class="err">│</span><span class="p">(</span><span class="mf">9</span><span class="n">bits</span><span class="p">)</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="p">(</span><span class="mf">12</span><span class="n">bits</span><span class="p">)</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└──────┴────────┴────────┴────────┴────────┴────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="n">PML4</span><span class="p">:</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="n">Map</span><span class="w"> </span><span class="n">Level</span><span class="w"> </span><span class="mf">4</span>
<span class="n">PDPT</span><span class="p">:</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="n">Directory</span><span class="w"> </span><span class="n">Pointer</span><span class="w"> </span><span class="nb">Tab</span><span class="n">le</span>
<span class="n">PD</span><span class="p">:</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="n">Directory</span>
<span class="n">PT</span><span class="p">:</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="nb">Tab</span><span class="n">le</span>

<span class="n">변환</span><span class="w"> </span><span class="n">과정</span><span class="p">:</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">CR3</span><span class="w"> </span><span class="n">Register</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">                                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">        </span><span class="err">▼</span><span class="w">                                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌─────────┐</span><span class="w">      </span><span class="err">┌─────────┐</span><span class="w">      </span><span class="err">┌─────────┐</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">PML4</span><span class="w">   </span><span class="err">│─────▶│</span><span class="w">  </span><span class="n">PDPT</span><span class="w">   </span><span class="err">│─────▶│</span><span class="w">   </span><span class="n">PD</span><span class="w">    </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="mf">512</span><span class="n">E</span><span class="p">)</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="mf">512</span><span class="n">E</span><span class="p">)</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="mf">512</span><span class="n">E</span><span class="p">)</span><span class="w">  </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└─────────┘</span><span class="w">      </span><span class="err">└─────────┘</span><span class="w">      </span><span class="err">└─────────┘</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                          </span><span class="err">│</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                          </span><span class="err">▼</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                    </span><span class="err">┌─────────┐</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                    </span><span class="err">│</span><span class="w">   </span><span class="n">PT</span><span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                    </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="mf">512</span><span class="n">E</span><span class="p">)</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                    </span><span class="err">└────┬────┘</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                         </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                         </span><span class="err">▼</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                              </span><span class="err">┌─────────────────┐</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                              </span><span class="err">│</span><span class="w">  </span><span class="n">Physical</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="err">│</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                              </span><span class="err">│</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">Offset</span><span class="w">      </span><span class="err">│</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                              </span><span class="err">└─────────────────┘</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">각</span><span class="w"> </span><span class="n">레벨</span><span class="p">:</span><span class="w"> </span><span class="mf">512</span><span class="w"> </span><span class="n">엔트리</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mf">8</span><span class="n">바이트</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4</span><span class="n">KB</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">최대</span><span class="w"> </span><span class="mf">4</span><span class="n">번의</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">접근</span><span class="w"> </span><span class="p">(</span><span class="n">TLB</span><span class="w"> </span><span class="n">미스</span><span class="w"> </span><span class="n">시</span><span class="p">)</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="44-inverted-page-table">4.4 역 페이지 테이블 (Inverted Page Table)<a class="header-link" href="#44-inverted-page-table" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>기존 페이지 테이블:
- 가상 페이지 수만큼 엔트리 필요
- 프로세스마다 별도 테이블

역 페이지 테이블:
- 물리 프레임 수만큼 엔트리
- 시스템에 하나만 존재

┌─────────────────────────────────────────────────────────────┐
│              Inverted Page Table                             │
├───────┬────────┬──────────────┬─────────────────────────────┤
│ Frame │  PID   │     VPN      │         Chain               │
├───────┼────────┼──────────────┼─────────────────────────────┤
│   0   │   42   │   0x12345    │         null                │
│   1   │   17   │   0x00ABC    │         → 5                 │
│   2   │   42   │   0x67890    │         null                │
│   3   │   25   │   0x11111    │         null                │
│   4   │   17   │   0x00DEF    │         null                │
│   5   │   33   │   0x00ABC    │         null (hash chain)   │
│  ...  │  ...   │     ...      │         ...                 │
└───────┴────────┴──────────────┴─────────────────────────────┘

검색: (PID, VPN) 해시하여 테이블 검색
- 해시 충돌 시 체인 따라감
- 장점: 메모리 절약 (물리 메모리 비례)
- 단점: 검색 시간 (해시 + 체인)
</code></pre></div>

<hr />
<h2 id="5-tlb-translation-lookaside-buffer">5. TLB (Translation Lookaside Buffer)<a class="header-link" href="#5-tlb-translation-lookaside-buffer" title="Permanent link">&para;</a></h2>
<h3 id="51-tlb">5.1 TLB의 필요성<a class="header-link" href="#51-tlb" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>페이지 테이블 접근 오버헤드:
- 4단계 페이지 테이블: 4번의 추가 메모리 접근
- 실제 데이터 접근 전에 4번의 테이블 조회

┌─────────────────────────────────────────────────────────────┐
│  TLB 없이 메모리 접근:                                       │
│                                                             │
│  1. PML4 접근 (메모리)                                      │
│  2. PDPT 접근 (메모리)                                      │
│  3. PD 접근 (메모리)                                        │
│  4. PT 접근 (메모리)                                        │
│  5. 실제 데이터 접근 (메모리)                                │
│                                                             │
│  총 5번의 메모리 접근! (400+ 사이클)                         │
│                                                             │
│  TLB 히트 시:                                               │
│  1. TLB 조회 (~1 사이클)                                    │
│  2. 실제 데이터 접근 (메모리)                                │
│                                                             │
│  총 ~100 사이클 (TLB 조회 + 메모리)                         │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="52-tlb">5.2 TLB 구조<a class="header-link" href="#52-tlb" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>TLB (Translation Lookaside Buffer):
- 최근 변환 결과를 캐싱
- 완전 연관 또는 집합 연관 구조
- 매우 작음 (32-1024 엔트리)
- 매우 빠름 (~1 사이클)

┌─────────────────────────────────────────────────────────────┐
│                         TLB                                  │
├──────┬───────┬──────────┬──────────┬────────────────────────┤
│ ASID │ Valid │   VPN    │   PFN    │    Permissions         │
├──────┼───────┼──────────┼──────────┼────────────────────────┤
│  42  │   1   │ 0x12345  │ 0x00ABC  │    R/W, User           │
│  42  │   1   │ 0x12346  │ 0x00ABD  │    R/W, User           │
│  17  │   1   │ 0x00100  │ 0x00300  │    R, User             │
│  42  │   1   │ 0x7FFFF  │ 0x00123  │    R/W, User           │
│  17  │   1   │ 0x00200  │ 0x00400  │    R/W/X, User         │
│ ...  │  ...  │   ...    │   ...    │    ...                 │
└──────┴───────┴──────────┴──────────┴────────────────────────┘

ASID (Address Space ID):
- 프로세스 구분
- 컨텍스트 스위치 시 TLB 플러시 방지
</code></pre></div>

<h3 id="53-tlb">5.3 TLB 동작<a class="header-link" href="#53-tlb" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>주소 변환 과정:

┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  CPU가 가상 주소 생성                                        │
│           │                                                 │
│           ▼                                                 │
│  ┌─────────────────┐                                        │
│  │  TLB 조회       │ ← 병렬로 수행 (VPN 추출 &amp; TLB 검색)     │
│  └────────┬────────┘                                        │
│           │                                                 │
│     ┌─────┴─────┐                                          │
│     │           │                                          │
│   Hit?        Miss                                         │
│     │           │                                          │
│     ▼           ▼                                          │
│  ┌──────┐   ┌─────────────────────────────────────┐        │
│  │ PFN  │   │  Page Table Walk                     │        │
│  │ 획득 │   │  (HW 또는 SW로 수행)                  │        │
│  └──┬───┘   │  1. PML4 접근                        │        │
│     │       │  2. PDPT 접근                        │        │
│     │       │  3. PD 접근                          │        │
│     │       │  4. PT 접근                          │        │
│     │       │  5. TLB에 결과 저장                  │        │
│     │       └───────────────┬─────────────────────┘        │
│     │                       │                              │
│     └───────────┬───────────┘                              │
│                 │                                          │
│                 ▼                                          │
│     물리 주소 = PFN + Offset                                │
│                 │                                          │
│                 ▼                                          │
│     캐시/메모리 접근                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="54-tlb">5.4 TLB 성능<a class="header-link" href="#54-tlb" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>TLB 히트율과 AMAT:

일반적인 TLB 히트율: 99% 이상

AMAT 계산:
AMAT = TLB_Hit_Rate × (TLB_Time + Mem_Time) +
       TLB_Miss_Rate × (TLB_Time + Walk_Time + Mem_Time)

예시:
<span class="k">-</span> TLB 접근: 1 사이클
<span class="k">-</span> 페이지 워크: 100 사이클 (4번 메모리 접근)
<span class="k">-</span> 메모리 접근: 100 사이클
<span class="k">-</span> TLB 히트율: 99%

TLB 히트: 1 + 100 = 101 사이클
TLB 미스: 1 + 100 + 100 = 201 사이클

AMAT = 0.99 × 101 + 0.01 × 201
     = 99.99 + 2.01
     = 102 사이클

TLB 없이: 500 사이클 (5번 메모리 접근)
→ TLB로 약 5배 성능 향상

TLB 커버리지:
<span class="k">-</span> 64 엔트리 TLB, 4KB 페이지: 256KB
<span class="k">-</span> 64 엔트리 TLB, 2MB 페이지: 128MB
<span class="k">-</span> 큰 페이지 사용 시 TLB 효율 증가
</code></pre></div>

<hr />
<h2 id="6">6. 페이지 폴트와 페이지 교체<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 페이지 폴트<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">정의</span><span class="o">:</span><span class="w"> </span><span class="err">접근하려는</span><span class="w"> </span><span class="err">페이지가</span><span class="w"> </span><span class="err">물리</span><span class="w"> </span><span class="err">메모리에</span><span class="w"> </span><span class="err">없는</span><span class="w"> </span><span class="err">상황</span>

<span class="err">페이지</span><span class="w"> </span><span class="err">폴트</span><span class="w"> </span><span class="err">원인</span><span class="o">:</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="err">페이지가</span><span class="w"> </span><span class="err">디스크에</span><span class="w"> </span><span class="err">있음</span><span class="w"> </span><span class="o">(</span><span class="err">스왑</span><span class="w"> </span><span class="err">아웃됨</span><span class="o">)</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="err">아직</span><span class="w"> </span><span class="err">할당되지</span><span class="w"> </span><span class="err">않은</span><span class="w"> </span><span class="err">주소</span><span class="w"> </span><span class="err">접근</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="err">권한</span><span class="w"> </span><span class="err">위반</span><span class="w"> </span><span class="o">(</span><span class="err">읽기</span><span class="w"> </span><span class="err">전용</span><span class="w"> </span><span class="err">페이지에</span><span class="w"> </span><span class="err">쓰기</span><span class="w"> </span><span class="err">등</span><span class="o">)</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                  </span><span class="n">Page</span><span class="w"> </span><span class="n">Fault</span><span class="w"> </span><span class="err">처리</span><span class="w"> </span><span class="err">과정</span><span class="w">                        </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">CPU가</span><span class="w"> </span><span class="err">가상</span><span class="w"> </span><span class="err">주소</span><span class="w"> </span><span class="err">접근</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">▼</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">MMU가</span><span class="w"> </span><span class="n">PTE</span><span class="w"> </span><span class="err">확인</span><span class="o">:</span><span class="w"> </span><span class="n">Present</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">▼</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="n">Fault</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="err">발생</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">▼</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="n">OS</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="n">Fault</span><span class="w"> </span><span class="n">Handler</span><span class="w"> </span><span class="err">실행</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">┌─────┴─────────────────────────────────┐</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">                                       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">▼</span><span class="w">                                       </span><span class="err">▼</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">유효한</span><span class="w"> </span><span class="err">접근</span><span class="o">?</span><span class="w">                            </span><span class="err">무효한</span><span class="w"> </span><span class="err">접근</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">                                       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="err">▼</span><span class="w">                                       </span><span class="err">▼</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">5</span><span class="o">.</span><span class="w"> </span><span class="err">빈</span><span class="w"> </span><span class="err">프레임</span><span class="w"> </span><span class="err">찾기</span><span class="w">                       </span><span class="n">SIGSEGV</span><span class="w"> </span><span class="err">발생</span><span class="w">       </span><span class="err">│</span>
<span class="err">│</span><span class="w">     </span><span class="o">(</span><span class="err">없으면</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="w">                  </span><span class="o">(</span><span class="err">프로세스</span><span class="w"> </span><span class="err">종료</span><span class="o">)</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">▼</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">6</span><span class="o">.</span><span class="w"> </span><span class="err">디스크에서</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">읽기</span><span class="w"> </span><span class="o">(~</span><span class="mi">10</span><span class="n">ms</span><span class="o">)</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">▼</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">7</span><span class="o">.</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">테이블</span><span class="w"> </span><span class="err">갱신</span><span class="w"> </span><span class="o">(</span><span class="n">Present</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">)</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="err">▼</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mi">8</span><span class="o">.</span><span class="w"> </span><span class="err">명령어</span><span class="w"> </span><span class="err">재실행</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="62">6.2 페이지 폴트 비용<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>페이지 폴트 시간:
- 디스크 읽기: ~10ms (HDD) 또는 ~0.1ms (SSD)
- CPU 클럭: 3GHz = 0.33ns/사이클

사이클 수:
- HDD: 10ms / 0.33ns = 30,000,000 사이클
- SSD: 0.1ms / 0.33ns = 300,000 사이클

일반 메모리 접근: ~100 사이클

성능 영향 계산:
페이지 폴트율 p에 대해:
EAT = (1-p) × 100ns + p × 10ms
    = 100ns + p × 10,000,000ns

허용 가능한 성능 저하를 10%로 제한하면:
110ns ≥ 100ns + p × 10,000,000ns
p ≤ 0.000001 (백만 번에 한 번)

→ 페이지 폴트율은 매우 낮아야 함!
</code></pre></div>

<h3 id="63-demand-paging-vs-prepaging">6.3 Demand Paging vs Prepaging<a class="header-link" href="#63-demand-paging-vs-prepaging" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Demand Paging:
- 필요할 때만 페이지 로드
- 초기에는 메모리 사용 적음
- 처음 접근 시 페이지 폴트 발생

┌─────────────────────────────────────────────────────────────┐
│  프로세스 시작 시:                                           │
│  - 코드 페이지 로드 안 됨                                    │
│  - 첫 명령어 실행 시 페이지 폴트                             │
│  - 필요한 페이지만 로드                                      │
└─────────────────────────────────────────────────────────────┘

Prepaging:
- 관련 페이지들을 미리 로드
- 초기 페이지 폴트 감소
- 사용 안 될 페이지도 로드할 수 있음

┌─────────────────────────────────────────────────────────────┐
│  프로세스 시작 시:                                           │
│  - Working Set 예측하여 미리 로드                            │
│  - 코드 영역 전체 또는 일부 프리로드                          │
│  - 초기 페이지 폴트 감소                                     │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="7">7. 페이지 교체 알고리즘<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-fifo-first-in-first-out">7.1 FIFO (First-In, First-Out)<a class="header-link" href="#71-fifo-first-in-first-out" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">먼저</span><span class="w"> </span><span class="err">들어온</span><span class="w"> </span><span class="err">페이지를</span><span class="w"> </span><span class="err">교체</span>

<span class="err">예시</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">프레임</span><span class="o">,</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">순서</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span>

<span class="err">┌────┬─────────┬─────────┬─────────┬───────┐</span>
<span class="err">│접근│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="err">결과</span><span class="w">  </span><span class="err">│</span>
<span class="err">├────┼─────────┼─────────┼─────────┼───────┤</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">교체</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">교체</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">교체</span>
<span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">교체</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">교체</span>
<span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">교체</span>
<span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">교체</span>
<span class="err">└────┴─────────┴─────────┴─────────┴───────┘</span>

<span class="err">총</span><span class="w"> </span><span class="err">미스</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="err">회</span><span class="o">,</span><span class="w"> </span><span class="err">히트</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="err">회</span>

<span class="n">Belady</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">Anomaly</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">FIFO에서</span><span class="w"> </span><span class="err">프레임</span><span class="w"> </span><span class="err">수</span><span class="w"> </span><span class="err">증가</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">미스율</span><span class="w"> </span><span class="err">증가</span><span class="w"> </span><span class="err">가능</span>
<span class="o">-</span><span class="w"> </span><span class="err">비직관적</span><span class="w"> </span><span class="err">현상</span>
</code></pre></div>

<h3 id="72-optimal-opt">7.2 Optimal (OPT)<a class="header-link" href="#72-optimal-opt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">오래</span><span class="w"> </span><span class="err">사용되지</span><span class="w"> </span><span class="err">않을</span><span class="w"> </span><span class="err">페이지를</span><span class="w"> </span><span class="err">교체</span>

<span class="err">예시</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">프레임</span><span class="o">,</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">순서</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span>

<span class="err">┌────┬─────────┬─────────┬─────────┬───────┬────────────────┐</span>
<span class="err">│접근│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="err">결과</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="err">미래</span><span class="w"> </span><span class="err">참조</span><span class="w">      </span><span class="err">│</span>
<span class="err">├────┼─────────┼─────────┼─────────┼───────┼────────────────┤</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">늦게</span><span class="w"> </span><span class="err">사용│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">다시</span><span class="w"> </span><span class="err">안</span><span class="w"> </span><span class="err">사용</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">늦게</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">늦게</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">다시</span><span class="w"> </span><span class="err">안</span><span class="w"> </span><span class="err">사용</span><span class="w"> </span><span class="err">│</span>
<span class="err">└────┴─────────┴─────────┴─────────┴───────┴────────────────┘</span>

<span class="err">총</span><span class="w"> </span><span class="err">미스</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span><span class="err">회</span><span class="o">,</span><span class="w"> </span><span class="err">히트</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="err">회</span>

<span class="err">최적이지만</span><span class="w"> </span><span class="err">구현</span><span class="w"> </span><span class="err">불가능</span><span class="w"> </span><span class="o">(</span><span class="err">미래</span><span class="w"> </span><span class="err">예측</span><span class="w"> </span><span class="err">필요</span><span class="o">)</span>
<span class="err">→</span><span class="w"> </span><span class="err">비교</span><span class="w"> </span><span class="err">기준으로만</span><span class="w"> </span><span class="err">사용</span>
</code></pre></div>

<h3 id="73-lru-least-recently-used">7.3 LRU (Least Recently Used)<a class="header-link" href="#73-lru-least-recently-used" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">가장</span><span class="w"> </span><span class="err">오래</span><span class="w"> </span><span class="err">전에</span><span class="w"> </span><span class="err">사용된</span><span class="w"> </span><span class="err">페이지를</span><span class="w"> </span><span class="err">교체</span>

<span class="err">예시</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">프레임</span><span class="o">,</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">순서</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span>

<span class="err">┌────┬─────────┬─────────┬─────────┬───────┬────────────────┐</span>
<span class="err">│접근│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="err">결과</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">LRU</span><span class="w"> </span><span class="err">순서</span><span class="w">       </span><span class="err">│</span>
<span class="err">├────┼─────────┼─────────┼─────────┼───────┼────────────────┤</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="w">  </span><span class="o">(</span><span class="mi">1</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="w">  </span><span class="o">(</span><span class="mi">2</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="w">  </span><span class="o">(</span><span class="mi">3</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">5</span><span class="w">  </span><span class="o">(</span><span class="mi">4</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">1</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Hit</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="w">  </span><span class="o">(</span><span class="mi">5</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="w">  </span><span class="o">(</span><span class="mi">1</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="err">│</span><span class="w">    </span><span class="mi">3</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">4</span><span class="w">    </span><span class="err">│</span><span class="w">    </span><span class="mi">5</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Miss</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="w">  </span><span class="o">(</span><span class="mi">2</span><span class="w"> </span><span class="err">교체</span><span class="o">)</span><span class="err">│</span>
<span class="err">└────┴─────────┴─────────┴─────────┴───────┴────────────────┘</span>

<span class="err">총</span><span class="w"> </span><span class="err">미스</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="err">회</span><span class="o">,</span><span class="w"> </span><span class="err">히트</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="err">회</span>

<span class="err">구현</span><span class="w"> </span><span class="err">방법</span><span class="o">:</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="err">타임스탬프</span><span class="o">:</span><span class="w"> </span><span class="err">각</span><span class="w"> </span><span class="err">페이지에</span><span class="w"> </span><span class="err">마지막</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">시간</span><span class="w"> </span><span class="err">기록</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="err">스택</span><span class="o">:</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">페이지를</span><span class="w"> </span><span class="err">스택</span><span class="w"> </span><span class="n">top으로</span><span class="w"> </span><span class="err">이동</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="err">근사</span><span class="w"> </span><span class="n">LRU</span><span class="o">:</span><span class="w"> </span><span class="n">Clock</span><span class="w"> </span><span class="err">알고리즘</span><span class="w"> </span><span class="err">등</span>
</code></pre></div>

<h3 id="74-clock-algorithm-second-chance">7.4 Clock Algorithm (Second Chance)<a class="header-link" href="#74-clock-algorithm-second-chance" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="n">FIFO</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Reference</span><span class="w"> </span><span class="n">Bit로</span><span class="w"> </span><span class="n">LRU</span><span class="w"> </span><span class="err">근사</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="n">Clock</span><span class="w"> </span><span class="n">Hand</span><span class="w"> </span><span class="o">(</span><span class="err">시계</span><span class="w"> </span><span class="err">바늘</span><span class="o">)</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">↓</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">┌────────┐</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="n">Page</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">│</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="err">이면</span><span class="w"> </span><span class="err">교체</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">┌──┴────────┴──┐</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌───┴───┐</span><span class="w">      </span><span class="err">┌───┴───┐</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="n">Page</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="n">Page</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">│</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w">      </span><span class="err">│</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="err">이면</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="err">으로</span><span class="w"> </span><span class="err">바꾸고</span><span class="w"> </span><span class="err">통과</span><span class="w">    </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└───┬───┘</span><span class="w">      </span><span class="err">└───┬───┘</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──┬────────┬──┘</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="n">Page</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="err">│</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="w">    </span><span class="err">│</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">          </span><span class="err">└────────┘</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">알고리즘</span><span class="o">:</span>
<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="err">시계</span><span class="w"> </span><span class="err">바늘이</span><span class="w"> </span><span class="err">가리키는</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">확인</span>
<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="err">이면</span><span class="w"> </span><span class="err">해당</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">교체</span>
<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="err">이면</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="err">으로</span><span class="w"> </span><span class="err">설정하고</span><span class="w"> </span><span class="err">다음</span><span class="w"> </span><span class="err">페이지로</span><span class="w"> </span><span class="err">이동</span>
<span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">페이지가</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="err">이면</span><span class="w"> </span><span class="err">한</span><span class="w"> </span><span class="err">바퀴</span><span class="w"> </span><span class="err">돌아</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="err">인</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">교체</span>

<span class="n">Enhanced</span><span class="w"> </span><span class="n">Clock</span><span class="w"> </span><span class="o">(</span><span class="n">NRU</span><span class="o">):</span>
<span class="o">-</span><span class="w"> </span><span class="n">Modified</span><span class="o">(</span><span class="n">M</span><span class="o">)</span><span class="w"> </span><span class="err">비트</span><span class="w"> </span><span class="err">추가</span>
<span class="o">-</span><span class="w"> </span><span class="err">우선순위</span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span><span class="n">M</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span><span class="n">M</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="o">,</span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">수정된</span><span class="w"> </span><span class="err">페이지는</span><span class="w"> </span><span class="err">디스크</span><span class="w"> </span><span class="err">쓰기</span><span class="w"> </span><span class="err">필요하므로</span><span class="w"> </span><span class="err">후순위</span>
</code></pre></div>

<h3 id="75">7.5 알고리즘 비교<a class="header-link" href="#75" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌────────────────┬──────────────────┬─────────────────────────┐
│   알고리즘      │     장점          │       단점              │
├────────────────┼──────────────────┼─────────────────────────┤
│ FIFO           │ 구현 간단        │ Belady&#39;s Anomaly       │
│                │                  │ 성능 불안정             │
├────────────────┼──────────────────┼─────────────────────────┤
│ Optimal        │ 최적 성능        │ 구현 불가능 (미래 예측) │
│                │ 비교 기준        │                         │
├────────────────┼──────────────────┼─────────────────────────┤
│ LRU            │ 좋은 성능        │ 구현 비용 높음          │
│                │ Stack property  │ 하드웨어 지원 필요       │
├────────────────┼──────────────────┼─────────────────────────┤
│ Clock          │ 효율적 근사     │ LRU보다 약간 낮은 성능   │
│                │ 구현 용이        │                         │
├────────────────┼──────────────────┼─────────────────────────┤
│ Working Set    │ 스래싱 방지     │ 파라미터 설정 어려움     │
│                │ 적응적          │                         │
└────────────────┴──────────────────┴─────────────────────────┘
</code></pre></div>

<hr />
<h2 id="8">8. 고급 주제<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81-copy-on-write-cow">8.1 Copy-on-Write (COW)<a class="header-link" href="#81-copy-on-write-cow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="n">fork</span><span class="o">()</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">페이지를</span><span class="w"> </span><span class="err">복사하지</span><span class="w"> </span><span class="err">않고</span><span class="w"> </span><span class="err">공유</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                     </span><span class="n">Copy</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">Write</span><span class="w">                            </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">fork</span><span class="o">()</span><span class="w"> </span><span class="err">직후</span><span class="o">:</span><span class="w">                                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Parent</span><span class="w">                 </span><span class="n">Child</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌─────────┐</span><span class="w">           </span><span class="err">┌─────────┐</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">│──────┬────│</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">│</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="sr">/O)   │      │    │ (R/</span><span class="n">O</span><span class="o">)</span><span class="w">   </span><span class="err">│</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">├─────────┤</span><span class="w">      </span><span class="err">│</span><span class="w">    </span><span class="err">├─────────┤</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│──┐</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">┌──│</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="sr">/O)   │  │   │ │  │ (R/</span><span class="n">O</span><span class="o">)</span><span class="w">   </span><span class="err">│</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└─────────┘</span><span class="w">  </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="err">└─────────┘</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="w">                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">   </span><span class="err">▼</span><span class="w"> </span><span class="err">│</span><span class="w">                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w"> </span><span class="err">┌─────┐</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="n">Frame</span><span class="err">│</span><span class="w">  </span><span class="n">Physical</span><span class="w"> </span><span class="n">Memory</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="n">A</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="o">(</span><span class="err">공유</span><span class="o">)</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w"> </span><span class="err">└─────┘</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">│</span><span class="w">   </span><span class="err">▲</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">               </span><span class="err">└───┘</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Child가</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="mi">1</span><span class="err">에</span><span class="w"> </span><span class="err">쓰기</span><span class="w"> </span><span class="err">시도</span><span class="o">:</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌─────────┐</span><span class="w">           </span><span class="err">┌─────────┐</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="n">Page</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="err">│</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="sr">/W)   │           │ (R/</span><span class="n">W</span><span class="o">)</span><span class="w">   </span><span class="err">│</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────┬────┘</span><span class="w">           </span><span class="err">└────┬────┘</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">▼</span><span class="w">                     </span><span class="err">▼</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌─────────┐</span><span class="w">           </span><span class="err">┌─────────┐</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="w"> </span><span class="n">Frame</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="err">←</span><span class="w"> </span><span class="err">복사본</span><span class="w"> </span><span class="err">생성</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="o">(</span><span class="err">원본</span><span class="w"> </span><span class="err">유지</span><span class="o">)</span><span class="err">│</span><span class="w">           </span><span class="err">│</span><span class="o">(</span><span class="err">수정된</span><span class="w"> </span><span class="err">내용</span><span class="o">)</span><span class="err">│</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└─────────┘</span><span class="w">           </span><span class="err">└─────────┘</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">장점</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">fork</span><span class="o">()</span><span class="w"> </span><span class="err">빠름</span><span class="w"> </span><span class="o">(</span><span class="err">복사</span><span class="w"> </span><span class="err">지연</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">절약</span><span class="w"> </span><span class="o">(</span><span class="err">읽기만</span><span class="w"> </span><span class="err">하면</span><span class="w"> </span><span class="err">공유</span><span class="w"> </span><span class="err">유지</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">exec</span><span class="o">()</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">버려지므로</span><span class="w"> </span><span class="err">효율적</span>
</code></pre></div>

<h3 id="82-mmap">8.2 메모리 맵 파일 (mmap)<a class="header-link" href="#82-mmap" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">원리</span><span class="o">:</span><span class="w"> </span><span class="err">파일을</span><span class="w"> </span><span class="err">가상</span><span class="w"> </span><span class="err">주소</span><span class="w"> </span><span class="err">공간에</span><span class="w"> </span><span class="err">직접</span><span class="w"> </span><span class="err">매핑</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">프로세스</span><span class="w"> </span><span class="err">가상</span><span class="w"> </span><span class="err">주소</span><span class="w"> </span><span class="err">공간</span><span class="w">        </span><span class="err">디스크</span><span class="w"> </span><span class="err">파일</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mh">0x40000000</span><span class="w"> </span><span class="err">┌────────────┐</span><span class="w">     </span><span class="err">┌────────────┐</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">             </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">             </span><span class="err">│</span><span class="w">  </span><span class="n">Mapped</span><span class="w">    </span><span class="err">│◀═══▶│</span><span class="w">   </span><span class="n">File</span><span class="w">     </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">             </span><span class="err">│</span><span class="w">  </span><span class="n">Region</span><span class="w">    </span><span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">  </span><span class="n">Content</span><span class="w">   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">             </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">            </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="mh">0x40100000</span><span class="w"> </span><span class="err">└────────────┘</span><span class="w">     </span><span class="err">└────────────┘</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">접근</span><span class="w"> </span><span class="err">방식</span><span class="o">:</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">파일</span><span class="w"> </span><span class="err">내용을</span><span class="w"> </span><span class="err">메모리처럼</span><span class="w"> </span><span class="err">접근</span><span class="w"> </span><span class="o">(</span><span class="err">포인터</span><span class="w"> </span><span class="err">사용</span><span class="o">)</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">페이지</span><span class="w"> </span><span class="err">폴트</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">파일에서</span><span class="w"> </span><span class="err">자동</span><span class="w"> </span><span class="err">로드</span><span class="w">                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">수정</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">자동으로</span><span class="w"> </span><span class="err">파일에</span><span class="w"> </span><span class="err">반영</span><span class="w"> </span><span class="o">(</span><span class="err">또는</span><span class="w"> </span><span class="err">명시적</span><span class="w"> </span><span class="n">msync</span><span class="o">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="err">용도</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">대용량</span><span class="w"> </span><span class="err">파일</span><span class="w"> </span><span class="err">처리</span>
<span class="o">-</span><span class="w"> </span><span class="err">프로세스</span><span class="w"> </span><span class="err">간</span><span class="w"> </span><span class="err">공유</span><span class="w"> </span><span class="err">메모리</span>
<span class="o">-</span><span class="w"> </span><span class="err">동적</span><span class="w"> </span><span class="err">라이브러리</span><span class="w"> </span><span class="err">로딩</span>
</code></pre></div>

<h3 id="83-huge-pages">8.3 Huge Pages<a class="header-link" href="#83-huge-pages" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">일반</span><span class="w"> </span><span class="nt">페이지</span><span class="w"> </span><span class="nt">vs</span><span class="w"> </span><span class="nt">Huge</span><span class="w"> </span><span class="nt">Page</span><span class="o">:</span>

<span class="nt">일반</span><span class="w"> </span><span class="nt">페이지</span><span class="w"> </span><span class="o">(</span><span class="nt">4KB</span><span class="o">):</span>
<span class="nt">-</span><span class="w"> </span><span class="nt">2MB</span><span class="w"> </span><span class="nt">메모리</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">512</span><span class="w"> </span><span class="nt">페이지</span>
<span class="nt">-</span><span class="w"> </span><span class="nt">512</span><span class="w"> </span><span class="nt">TLB</span><span class="w"> </span><span class="nt">엔트리</span><span class="w"> </span><span class="nt">필요</span><span class="w"> </span><span class="o">(</span><span class="nt">TLB</span><span class="w"> </span><span class="nt">압박</span><span class="o">)</span>
<span class="nt">-</span><span class="w"> </span><span class="nt">페이지</span><span class="w"> </span><span class="nt">테이블</span><span class="w"> </span><span class="nt">오버헤드</span><span class="w"> </span><span class="nt">큼</span>

<span class="nt">Huge</span><span class="w"> </span><span class="nt">Page</span><span class="w"> </span><span class="o">(</span><span class="nt">2MB</span><span class="o">):</span>
<span class="nt">-</span><span class="w"> </span><span class="nt">2MB</span><span class="w"> </span><span class="nt">메모리</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">1</span><span class="w"> </span><span class="nt">페이지</span>
<span class="nt">-</span><span class="w"> </span><span class="nt">1</span><span class="w"> </span><span class="nt">TLB</span><span class="w"> </span><span class="nt">엔트리만</span><span class="w"> </span><span class="nt">필요</span>
<span class="nt">-</span><span class="w"> </span><span class="nt">TLB</span><span class="w"> </span><span class="nt">커버리지</span><span class="w"> </span><span class="nt">증가</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="nt">TLB</span><span class="w"> </span><span class="nt">커버리지</span><span class="w"> </span><span class="nt">비교</span><span class="w"> </span><span class="o">(</span><span class="nt">64</span><span class="w"> </span><span class="nt">TLB</span><span class="w"> </span><span class="nt">엔트리</span><span class="o">):</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">4KB</span><span class="w"> </span><span class="nt">페이지</span><span class="o">:</span><span class="w">  </span><span class="nt">64</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="nt">4KB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">256KB</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">2MB</span><span class="w"> </span><span class="nt">페이지</span><span class="o">:</span><span class="w">  </span><span class="nt">64</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="nt">2MB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">128MB</span><span class="w">                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">1GB</span><span class="w"> </span><span class="nt">페이지</span><span class="o">:</span><span class="w">  </span><span class="nt">64</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="nt">1GB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">64GB</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nt">데이터베이스</span><span class="o">,</span><span class="w"> </span><span class="nt">가상화</span><span class="w"> </span><span class="nt">등</span><span class="w"> </span><span class="nt">대용량</span><span class="w"> </span><span class="nt">메모리</span><span class="w"> </span><span class="nt">사용</span><span class="w"> </span><span class="nt">시</span><span class="w"> </span><span class="nt">큰</span><span class="w"> </span><span class="nt">효과</span><span class="w">        </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="nt">Linux에서</span><span class="w"> </span><span class="nt">사용</span><span class="o">:</span>
<span class="err">#</span><span class="w"> </span><span class="nt">시스템</span><span class="w"> </span><span class="nt">설정</span>
<span class="nt">echo</span><span class="w"> </span><span class="nt">1024</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="nt">proc</span><span class="o">/</span><span class="nt">sys</span><span class="o">/</span><span class="nt">vm</span><span class="o">/</span><span class="nt">nr_hugepages</span>

<span class="err">#</span><span class="w"> </span><span class="nt">프로그램에서</span>
<span class="nt">mmap</span><span class="o">(...,</span><span class="w"> </span><span class="nt">MAP_HUGETLB</span><span class="o">,</span><span class="w"> </span><span class="o">...);</span>
</code></pre></div>

<hr />
<h2 id="9">9. 연습 문제<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="_4">기초 문제<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>가상 메모리의 주요 장점 3가지는?</p>
</li>
<li>
<p>32비트 시스템, 4KB 페이지에서 가상 주소 0x12345ABC의:</p>
</li>
<li>VPN은?</li>
<li>
<p>Offset은?</p>
</li>
<li>
<p>TLB의 역할과 필요성을 설명하시오.</p>
</li>
</ol>
<h3 id="_5">중급 문제<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>다음 접근 순서에서 FIFO, LRU 알고리즘의 미스 횟수를 구하시오:
   (3 프레임, 접근: 7,0,1,2,0,3,0,4,2,3)</p>
</li>
<li>
<p>2단계 페이지 테이블에서 TLB 미스 시 메모리 접근 횟수는?</p>
</li>
<li>
<p>Copy-on-Write의 동작 원리와 장점을 설명하시오.</p>
</li>
</ol>
<h3 id="_6">심화 문제<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>64비트 시스템에서 4단계 페이지 테이블을 사용하는 이유는?</p>
</li>
<li>
<p>다음 상황에서 Effective Access Time을 계산하시오:</p>
</li>
<li>TLB 히트 시간: 10ns</li>
<li>TLB 히트율: 98%</li>
<li>페이지 테이블 워크: 200ns (4번 메모리 접근)</li>
<li>메모리 접근: 100ns</li>
<li>페이지 폴트율: 0.001%</li>
<li>
<p>페이지 폴트 처리: 10ms</p>
</li>
<li>
<p>Working Set 모델이 스래싱을 방지하는 원리를 설명하시오.</p>
</li>
</ol>
<details>
<summary>정답</summary>

1. 가상 메모리 장점:
   - 물리 메모리보다 큰 프로그램 실행 가능
   - 메모리 보호 (프로세스 격리)
   - 메모리 공유 (라이브러리 등)
   - 단편화 해결
   - 재배치 투명성

2. 주소 분해 (0x12345ABC):
   - VPN = 0x12345 (상위 20비트)
   - Offset = 0xABC (하위 12비트)

3. TLB 역할:
   - 가상-물리 주소 변환 결과 캐싱
   - 페이지 테이블 접근 오버헤드 감소
   - 필요성: 4단계 테이블 = 4번 추가 메모리 접근을 1사이클로 단축

4. 미스 횟수:
   FIFO: 7,0,1,2,0,3,0,4,2,3
   - Miss: 7,0,1 (초기 로드)
   - Miss: 2 (7 교체)
   - Hit: 0
   - Miss: 3 (0 교체, wait 0 was just hit... 재계산)

   실제 계산:
   [7,-,-] → [7,0,-] → [7,0,1] → [2,0,1] → Hit → [2,3,1] → [2,3,0] → [4,3,0] → [4,2,0] → [4,2,3]
   FIFO: 9 Miss, 1 Hit

   LRU:
   [7,-,-] → [7,0,-] → [7,0,1] → [2,0,1] → Hit(0) → [2,0,3] → Hit(0) → [4,0,3] → [4,0,2] → [4,3,2]
   LRU: 8 Miss, 2 Hit

5. 2단계 페이지 테이블 TLB 미스 시:
   - Page Directory 접근: 1회
   - Page Table 접근: 1회
   - 실제 데이터 접근: 1회
   - 총 3번 메모리 접근

6. Copy-on-Write:
   - 원리: fork() 시 페이지 테이블만 복사하고 실제 페이지는 공유, 쓰기 시 복사
   - 장점: fork() 빠름, 메모리 절약, exec() 시 효율적

7. 4단계 페이지 테이블 이유:
   - 64비트 주소 공간이 너무 큼
   - 단일 레벨: 2^52 / 4KB × 8B = 수 PB 테이블
   - 다단계: 사용하는 영역만 테이블 할당하여 메모리 절약

8. EAT 계산:
   TLB 히트: 10ns + 100ns = 110ns
   TLB 미스: 10ns + 200ns + 100ns = 310ns
   페이지 폴트: 10ms = 10,000,000ns

   EAT = 0.98 × 0.99999 × 110 + 0.02 × 0.99999 × 310 + 0.00001 × 10,000,000
       = 107.78 + 6.20 + 100
       ≈ 214ns

9. Working Set 모델:
   - 프로세스의 Working Set 크기 추적
   - 물리 메모리 < 모든 프로세스의 Working Set 합이면
   - 일부 프로세스 스왑 아웃하여 다른 프로세스에 충분한 메모리 제공
   - 각 프로세스가 Working Set만큼의 프레임을 보장받아 스래싱 방지

</details>

<hr />
<h2 id="_7">다음 단계<a class="header-link" href="#_7" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./17_IO_Systems.md">17_IO_Systems.md</a> - I/O 시스템, 인터럽트, DMA</li>
</ul>
<hr />
<h2 id="_8">참고 자료<a class="header-link" href="#_8" title="Permanent link">&para;</a></h2>
<ul>
<li>Operating System Concepts (Silberschatz et al.)</li>
<li>Computer Architecture: A Quantitative Approach (Hennessy &amp; Patterson)</li>
<li><a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html">Intel Software Developer's Manual - Paging</a></li>
<li><a href="https://www.kernel.org/doc/html/latest/mm/">Linux Kernel Documentation - Memory Management</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Computer_Architecture/15_Cache_Memory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">캐시 메모리</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Computer_Architecture/17_IO_Systems.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">입출력 시스템</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}