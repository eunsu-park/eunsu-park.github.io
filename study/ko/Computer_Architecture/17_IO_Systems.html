{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>입출력 시스템 - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Computer_Architecture/">Computer Architecture</a>
    <span class="separator">/</span>
    <span class="current">입출력 시스템</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>입출력 시스템</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Computer_Architecture/16_Virtual_Memory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">가상 메모리</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Computer_Architecture/18_Parallel_Processing_Multicore.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">병렬 처리와 멀티코어</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">개요</a></li>
<li><a href="#_3">목차</a></li>
<li><a href="#1-io">1. I/O 시스템 개요</a><ul>
<li><a href="#11-io">1.1 I/O 장치의 다양성</a></li>
<li><a href="#12-io">1.2 I/O 시스템 구조</a></li>
<li><a href="#13-io">1.3 I/O 제어 방식 비교</a></li>
</ul>
</li>
<li><a href="#2-io">2. 프로그램 I/O (폴링)</a><ul>
<li><a href="#21">2.1 폴링의 개념</a></li>
<li><a href="#22-io">2.2 I/O 포트와 레지스터</a></li>
<li><a href="#23">2.3 폴링 프로그래밍 예시</a></li>
<li><a href="#24">2.4 폴링의 장단점</a></li>
</ul>
</li>
<li><a href="#3-io">3. 인터럽트 기반 I/O</a><ul>
<li><a href="#31">3.1 인터럽트의 개념</a></li>
<li><a href="#32">3.2 인터럽트 처리 과정</a></li>
<li><a href="#33">3.3 인터럽트 벡터 테이블</a></li>
<li><a href="#34-io">3.4 인터럽트 기반 I/O 프로그래밍</a></li>
<li><a href="#35">3.5 인터럽트의 장단점</a></li>
</ul>
</li>
<li><a href="#4-dma-direct-memory-access">4. DMA (Direct Memory Access)</a><ul>
<li><a href="#41-dma">4.1 DMA의 개념</a></li>
<li><a href="#42-dma">4.2 DMA 동작 과정</a></li>
<li><a href="#43-dma">4.3 DMA 컨트롤러 구조</a></li>
<li><a href="#44-dma">4.4 DMA 전송 모드</a></li>
<li><a href="#45-dma">4.5 DMA 프로그래밍 예시</a></li>
</ul>
</li>
<li><a href="#5">5. 버스 구조</a><ul>
<li><a href="#51">5.1 버스의 종류</a></li>
<li><a href="#52">5.2 버스 특성</a></li>
<li><a href="#53">5.3 버스 중재</a></li>
</ul>
</li>
<li><a href="#6-io">6. I/O 인터페이스</a><ul>
<li><a href="#61-io">6.1 I/O 주소 지정</a></li>
<li><a href="#62">6.2 장치 드라이버 구조</a></li>
</ul>
</li>
<li><a href="#7-io">7. 현대 I/O 시스템</a><ul>
<li><a href="#71-nvme-non-volatile-memory-express">7.1 NVMe (Non-Volatile Memory Express)</a></li>
<li><a href="#72-usb">7.2 USB 시스템</a></li>
<li><a href="#73-io">7.3 가상화 I/O</a></li>
</ul>
</li>
<li><a href="#8">8. 연습 문제</a><ul>
<li><a href="#_4">기초 문제</a></li>
<li><a href="#_5">중급 문제</a></li>
<li><a href="#_6">심화 문제</a></li>
</ul>
</li>
<li><a href="#_7">다음 단계</a></li>
<li><a href="#_8">참고 자료</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">입출력 시스템<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">개요<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>입출력(I/O) 시스템은 CPU와 외부 장치(키보드, 디스크, 네트워크 등) 간의 데이터 전송을 담당합니다. I/O 시스템의 설계는 시스템 전체 성능에 큰 영향을 미치며, 폴링, 인터럽트, DMA 등 다양한 방식으로 구현됩니다. 이 레슨에서는 I/O 시스템의 구조와 동작 원리를 학습합니다.</p>
<p><strong>난이도</strong>: ⭐⭐⭐</p>
<p><strong>선수 지식</strong>: CPU 구조, 메모리 시스템</p>
<hr />
<h2 id="_3">목차<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-io-시스템-개요">I/O 시스템 개요</a></li>
<li><a href="#2-프로그램-io-폴링">프로그램 I/O (폴링)</a></li>
<li><a href="#3-인터럽트-기반-io">인터럽트 기반 I/O</a></li>
<li><a href="#4-dma-direct-memory-access">DMA (Direct Memory Access)</a></li>
<li><a href="#5-버스-구조">버스 구조</a></li>
<li><a href="#6-io-인터페이스">I/O 인터페이스</a></li>
<li><a href="#7-현대-io-시스템">현대 I/O 시스템</a></li>
<li><a href="#8-연습-문제">연습 문제</a></li>
</ol>
<hr />
<h2 id="1-io">1. I/O 시스템 개요<a class="header-link" href="#1-io" title="Permanent link">&para;</a></h2>
<h3 id="11-io">1.1 I/O 장치의 다양성<a class="header-link" href="#11-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                  I/O 장치 분류                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  입력 장치                출력 장치              저장 장치   │
│  ┌──────────┐           ┌──────────┐          ┌──────────┐ │
│  │ 키보드   │           │ 모니터   │          │ HDD/SSD  │ │
│  │ 마우스   │           │ 프린터   │          │ USB      │ │
│  │ 스캐너   │           │ 스피커   │          │ SD카드   │ │
│  │ 마이크   │           │ LED      │          │ 광학드라이브│ │
│  │ 터치스크린│           │          │          │          │ │
│  └──────────┘           └──────────┘          └──────────┘ │
│                                                             │
│  통신 장치                                                  │
│  ┌────────────────────────────────────────────────────────┐│
│  │ 네트워크 카드 (NIC), WiFi, Bluetooth, USB 허브          ││
│  └────────────────────────────────────────────────────────┘│
│                                                             │
└─────────────────────────────────────────────────────────────┘

I/O 장치 특성:
┌─────────────────┬──────────────┬───────────────────────────┐
│     장치        │   데이터율    │         특성              │
├─────────────────┼──────────────┼───────────────────────────┤
│ 키보드          │  ~100 B/s    │ 저속, 비동기, 문자 단위   │
├─────────────────┼──────────────┼───────────────────────────┤
│ 마우스          │  ~1 KB/s     │ 저속, 동기, 이벤트        │
├─────────────────┼──────────────┼───────────────────────────┤
│ 기가비트 이더넷  │  125 MB/s    │ 고속, 패킷 단위           │
├─────────────────┼──────────────┼───────────────────────────┤
│ SATA SSD       │  ~600 MB/s   │ 고속, 블록 단위           │
├─────────────────┼──────────────┼───────────────────────────┤
│ NVMe SSD       │  ~7 GB/s     │ 초고속, 병렬 처리         │
├─────────────────┼──────────────┼───────────────────────────┤
│ 4K 디스플레이   │  ~20 GB/s    │ 초고속, 연속 데이터       │
└─────────────────┴──────────────┴───────────────────────────┘
</code></pre></div>

<h3 id="12-io">1.2 I/O 시스템 구조<a class="header-link" href="#12-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    I/O 시스템 계층                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────────────────────────────────────────────┐   │
│   │              응용 프로그램                            │   │
│   │         read(), write(), printf()                   │   │
│   └─────────────────────────────────────────────────────┘   │
│                           │                                 │
│                           ▼                                 │
│   ┌─────────────────────────────────────────────────────┐   │
│   │            운영체제 I/O 서브시스템                     │   │
│   │      버퍼링, 캐싱, 스풀링, 스케줄링                    │   │
│   └─────────────────────────────────────────────────────┘   │
│                           │                                 │
│                           ▼                                 │
│   ┌─────────────────────────────────────────────────────┐   │
│   │              디바이스 드라이버                         │   │
│   │        장치별 제어 코드, 인터럽트 처리                  │   │
│   └─────────────────────────────────────────────────────┘   │
│                           │                                 │
│                           ▼                                 │
│   ┌─────────────────────────────────────────────────────┐   │
│   │              하드웨어 컨트롤러                         │   │
│   │        I/O 포트, 레지스터, 버스 인터페이스             │   │
│   └─────────────────────────────────────────────────────┘   │
│                           │                                 │
│                           ▼                                 │
│   ┌─────────────────────────────────────────────────────┐   │
│   │               I/O 장치                               │   │
│   │          물리적 장치 (디스크, 키보드 등)               │   │
│   └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="13-io">1.3 I/O 제어 방식 비교<a class="header-link" href="#13-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌───────────────────┬────────────────────┬────────────────────┐
│                   │  프로그램 I/O      │   인터럽트 I/O     │
│      특성         │    (폴링)          │                    │
├───────────────────┼────────────────────┼────────────────────┤
│ CPU 개입          │      높음          │       중간         │
├───────────────────┼────────────────────┼────────────────────┤
│ CPU 효율          │      낮음          │       높음         │
├───────────────────┼────────────────────┼────────────────────┤
│ 구현 복잡도       │      낮음          │       중간         │
├───────────────────┼────────────────────┼────────────────────┤
│ 적합한 장치       │   고속, 예측 가능  │  저속, 비동기      │
├───────────────────┼────────────────────┼────────────────────┤
│ 데이터 전송       │  CPU 경유          │   CPU 경유         │
└───────────────────┴────────────────────┴────────────────────┘

┌───────────────────┬────────────────────┐
│                   │       DMA          │
│      특성         │                    │
├───────────────────┼────────────────────┤
│ CPU 개입          │       낮음         │
├───────────────────┼────────────────────┤
│ CPU 효율          │     매우 높음      │
├───────────────────┼────────────────────┤
│ 구현 복잡도       │       높음         │
├───────────────────┼────────────────────┤
│ 적합한 장치       │   대용량 전송      │
├───────────────────┼────────────────────┤
│ 데이터 전송       │   메모리 직접      │
└───────────────────┴────────────────────┘
</code></pre></div>

<hr />
<h2 id="2-io">2. 프로그램 I/O (폴링)<a class="header-link" href="#2-io" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 폴링의 개념<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">정의</span><span class="o">:</span><span class="w"> </span><span class="n">CPU가</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">장치의</span><span class="w"> </span><span class="err">상태를</span><span class="w"> </span><span class="err">주기적으로</span><span class="w"> </span><span class="err">확인하며</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">전송</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="err">폴링</span><span class="w"> </span><span class="err">동작</span><span class="w"> </span><span class="err">과정</span><span class="w">                            </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="n">CPU</span><span class="w">                           </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">장치</span><span class="w">                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="err">상태</span><span class="w"> </span><span class="err">확인</span><span class="w"> </span><span class="o">(</span><span class="err">읽기</span><span class="w"> </span><span class="err">준비</span><span class="o">?)</span><span class="w">     </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│──────────────────────────────▶│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;아직 안 됨&quot;</span><span class="w">               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│◀──────────────────────────────│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="err">상태</span><span class="w"> </span><span class="err">확인</span><span class="w"> </span><span class="o">(</span><span class="err">다시</span><span class="o">)</span><span class="w">           </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│──────────────────────────────▶│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;아직 안 됨&quot;</span><span class="w">               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│◀──────────────────────────────│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">         </span><span class="o">...</span><span class="err">반복</span><span class="o">...</span><span class="w">             </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="n">N</span><span class="o">.</span><span class="w"> </span><span class="err">상태</span><span class="w"> </span><span class="err">확인</span><span class="w">                  </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│──────────────────────────────▶│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;준비 완료&quot;</span><span class="w">              </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│◀──────────────────────────────│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">읽기</span><span class="w">              </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│◀──────────────────────────────│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                               </span><span class="err">│</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">문제</span><span class="o">:</span><span class="w"> </span><span class="n">CPU가</span><span class="w"> </span><span class="err">대기하며</span><span class="w"> </span><span class="err">아무</span><span class="w"> </span><span class="err">일도</span><span class="w"> </span><span class="err">못함</span><span class="w"> </span><span class="o">(</span><span class="n">Busy</span><span class="w"> </span><span class="n">Waiting</span><span class="o">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="22-io">2.2 I/O 포트와 레지스터<a class="header-link" href="#22-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>I/O 장치 컨트롤러의 레지스터:

┌─────────────────────────────────────────────────────────────┐
│              I/O Controller Registers                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ Status Register (상태 레지스터)                      │    │
│  │ ┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐  │    │
│  │ │Busy │Ready│Error│ IRQ │ ... │ ... │ ... │ ... │  │    │
│  │ └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘  │    │
│  │ - 장치 상태 표시 (읽기 전용)                         │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ Control Register (제어 레지스터)                     │    │
│  │ ┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐  │    │
│  │ │Start│ IE  │Mode │ Dir │ ... │ ... │ ... │ ... │  │    │
│  │ └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘  │    │
│  │ - 장치 제어 명령 (쓰기)                              │    │
│  │ - IE: Interrupt Enable                              │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ Data Register (데이터 레지스터)                      │    │
│  │ ┌───────────────────────────────────────────────┐   │    │
│  │ │                Data (8/16/32 bits)            │   │    │
│  │ └───────────────────────────────────────────────┘   │    │
│  │ - 실제 전송 데이터                                   │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="23">2.3 폴링 프로그래밍 예시<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// 간단한 폴링 기반 I/O 코드</span>

<span class="cp">#define STATUS_REG  0x3F8  </span><span class="c1">// 상태 레지스터 주소</span>
<span class="cp">#define DATA_REG    0x3F9  </span><span class="c1">// 데이터 레지스터 주소</span>
<span class="cp">#define READY_BIT   0x01   </span><span class="c1">// Ready 비트 마스크</span>

<span class="c1">// 문자 출력 (폴링)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">putchar_polling</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 장치가 준비될 때까지 대기 (Busy Wait)</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">inb</span><span class="p">(</span><span class="n">STATUS_REG</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">READY_BIT</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// CPU가 계속 루프를 돌며 확인</span>
<span class="w">        </span><span class="c1">// 아무 일도 하지 못함</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 데이터 전송</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DATA_REG</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 문자열 출력</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">print_string_polling</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">putchar_polling</span><span class="p">(</span><span class="o">*</span><span class="n">str</span><span class="o">++</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 문자 입력 (폴링)</span>
<span class="kt">char</span><span class="w"> </span><span class="nf">getchar_polling</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 입력 데이터가 있을 때까지 대기</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">inb</span><span class="p">(</span><span class="n">STATUS_REG</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">READY_BIT</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Busy Wait</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">inb</span><span class="p">(</span><span class="n">DATA_REG</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="24">2.4 폴링의 장단점<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>장점:
┌─────────────────────────────────────────────────────────────┐
│ - 구현이 간단함                                              │
│ - 하드웨어 요구사항 최소                                     │
│ - 예측 가능한 타이밍                                         │
│ - 빠른 장치에서는 효율적 (데이터가 즉시 준비되는 경우)         │
│ - 실시간 시스템에서 지터(jitter) 최소화                       │
└─────────────────────────────────────────────────────────────┘

단점:
┌─────────────────────────────────────────────────────────────┐
│ - CPU 시간 낭비 (Busy Waiting)                              │
│ - 느린 장치에서 매우 비효율적                                │
│ - 여러 장치 처리 어려움                                      │
│ - 전력 소비 증가                                            │
└─────────────────────────────────────────────────────────────┘

CPU 시간 낭비 계산:
- 시리얼 포트: 115200 bps = 11520 문자/초
- 한 문자당 약 87us
- 3GHz CPU: 87us = 261,000 사이클
- 한 문자 전송에 CPU가 26만 사이클 대기!
</code></pre></div>

<hr />
<h2 id="3-io">3. 인터럽트 기반 I/O<a class="header-link" href="#3-io" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 인터럽트의 개념<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">정의</span><span class="o">:</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">장치가</span><span class="w"> </span><span class="n">CPU에</span><span class="w"> </span><span class="err">비동기적으로</span><span class="w"> </span><span class="err">신호를</span><span class="w"> </span><span class="err">보내</span><span class="w"> </span><span class="err">처리를</span><span class="w"> </span><span class="err">요청</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                  </span><span class="err">인터럽트</span><span class="w"> </span><span class="err">동작</span><span class="w"> </span><span class="err">과정</span><span class="w">                           </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">      </span><span class="n">CPU</span><span class="w"> </span><span class="o">(</span><span class="err">작업</span><span class="w"> </span><span class="err">수행</span><span class="w"> </span><span class="err">중</span><span class="o">)</span><span class="w">                    </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">장치</span><span class="w">         </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">명령</span><span class="w"> </span><span class="err">발행</span><span class="w">                    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│─────────────────────────────────────▶│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="err">다른</span><span class="w"> </span><span class="err">작업</span><span class="w"> </span><span class="err">수행</span><span class="w">                   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="o">(</span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">완료</span><span class="w"> </span><span class="err">기다리지</span><span class="w"> </span><span class="err">않음</span><span class="o">)</span><span class="w">            </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">         </span><span class="o">...</span><span class="err">시간</span><span class="w"> </span><span class="err">경과</span><span class="o">...</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">처리</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="err">인터럽트</span><span class="w"> </span><span class="err">신호</span><span class="w"> </span><span class="o">(</span><span class="n">IRQ</span><span class="o">)</span><span class="w">              </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│◀═════════════════════════════════════│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">5</span><span class="o">.</span><span class="w"> </span><span class="err">현재</span><span class="w"> </span><span class="err">상태</span><span class="w"> </span><span class="err">저장</span><span class="w">                   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">6</span><span class="o">.</span><span class="w"> </span><span class="err">인터럽트</span><span class="w"> </span><span class="err">핸들러</span><span class="w"> </span><span class="err">실행</span><span class="w">             </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">7</span><span class="o">.</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">전송</span><span class="w">                      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">  </span><span class="mi">8</span><span class="o">.</span><span class="w"> </span><span class="err">원래</span><span class="w"> </span><span class="err">작업</span><span class="w"> </span><span class="err">재개</span><span class="w">                   </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">                                      </span><span class="err">│</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">장점</span><span class="o">:</span><span class="w"> </span><span class="n">CPU가</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">대기</span><span class="w"> </span><span class="err">중에도</span><span class="w"> </span><span class="err">다른</span><span class="w"> </span><span class="err">작업</span><span class="w"> </span><span class="err">수행</span><span class="w"> </span><span class="err">가능</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="32">3.2 인터럽트 처리 과정<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│<span class="w">               </span>인터럽트<span class="w"> </span>처리<span class="w"> </span>상세<span class="w"> </span>단계<span class="w">                         </span>│
├─────────────────────────────────────────────────────────────┤
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">1</span>.<span class="w"> </span>장치가<span class="w"> </span><span class="nv">IRQ</span><span class="w"> </span>라인<span class="w"> </span>활성화<span class="w">                                   </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>컨트롤러<span class="w"> </span><span class="ss">(</span><span class="nv">PIC</span><span class="o">/</span><span class="nv">APIC</span><span class="ss">)</span>에<span class="w"> </span>신호<span class="w"> </span>전달<span class="w">             </span>│
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">2</span>.<span class="w"> </span>인터럽트<span class="w"> </span>컨트롤러가<span class="w"> </span><span class="nv">CPU</span>에<span class="w"> </span>인터럽트<span class="w"> </span>요청<span class="w">                   </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>우선순위<span class="w"> </span>확인<span class="w">                               </span>│
│<span class="w">     </span>└──<span class="w"> </span>마스크되지<span class="w"> </span>않은<span class="w"> </span>경우<span class="w"> </span><span class="nv">CPU</span>에<span class="w"> </span>전달<span class="w">                      </span>│
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">3</span>.<span class="w"> </span><span class="nv">CPU</span>가<span class="w"> </span>현재<span class="w"> </span>명령어<span class="w"> </span>완료<span class="w"> </span>후<span class="w"> </span>인터럽트<span class="w"> </span>확인<span class="w">                   </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>플래그<span class="w"> </span>확인<span class="w"> </span><span class="ss">(</span><span class="k">IF</span><span class="ss">)</span><span class="w">                            </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>가능<span class="w"> </span>상태면<span class="w"> </span>처리<span class="w"> </span>시작<span class="w">                        </span>│
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">4</span>.<span class="w"> </span><span class="nv">CPU</span><span class="w"> </span>상태<span class="w"> </span>저장<span class="w">                                           </span>│
│<span class="w">     </span>└──<span class="w"> </span>플래그<span class="w"> </span>레지스터<span class="w"> </span>→<span class="w"> </span>스택<span class="w">                               </span>│
│<span class="w">     </span>└──<span class="w"> </span><span class="nv">CS</span>:<span class="nv">IP</span><span class="w"> </span><span class="ss">(</span>또는<span class="w"> </span><span class="nv">RIP</span><span class="ss">)</span><span class="w"> </span>→<span class="w"> </span>스택<span class="w">                             </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>비활성화<span class="w"> </span><span class="ss">(</span>중첩<span class="w"> </span>방지<span class="ss">)</span><span class="w">                        </span>│
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">5</span>.<span class="w"> </span>인터럽트<span class="w"> </span>벡터<span class="w"> </span>테이블<span class="w"> </span>참조<span class="w">                                </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>번호로<span class="w"> </span>핸들러<span class="w"> </span>주소<span class="w"> </span>조회<span class="w">                     </span>│
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">6</span>.<span class="w"> </span>인터럽트<span class="w"> </span>서비스<span class="w"> </span>루틴<span class="w"> </span><span class="ss">(</span><span class="nv">ISR</span><span class="ss">)</span><span class="w"> </span>실행<span class="w">                          </span>│
│<span class="w">     </span>└──<span class="w"> </span>장치별<span class="w"> </span>처리<span class="w"> </span>코드<span class="w"> </span>실행<span class="w">                                </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>확인<span class="w"> </span><span class="ss">(</span><span class="nv">Acknowledge</span><span class="ss">)</span><span class="w"> </span>신호<span class="w"> </span>전송<span class="w">                </span>│
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">7</span>.<span class="w"> </span><span class="nv">EOI</span><span class="w"> </span><span class="ss">(</span><span class="k">End</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">Interrupt</span><span class="ss">)</span><span class="w"> </span>전송<span class="w">                             </span>│
│<span class="w">     </span>└──<span class="w"> </span>인터럽트<span class="w"> </span>컨트롤러에<span class="w"> </span>처리<span class="w"> </span>완료<span class="w"> </span>알림<span class="w">                   </span>│
│<span class="w">                                                             </span>│
│<span class="w">  </span><span class="mi">8</span>.<span class="w"> </span><span class="nv">IRET</span><span class="w"> </span>명령으로<span class="w"> </span>복귀<span class="w">                                      </span>│
│<span class="w">     </span>└──<span class="w"> </span>저장된<span class="w"> </span>상태<span class="w"> </span>복원<span class="w">                                     </span>│
│<span class="w">     </span>└──<span class="w"> </span>원래<span class="w"> </span>코드로<span class="w"> </span>복귀<span class="w">                                     </span>│
│<span class="w">                                                             </span>│
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="33">3.3 인터럽트 벡터 테이블<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>x86 인터럽트 벡터 테이블 (IDT):

┌─────────────────────────────────────────────────────────────┐
│             Interrupt Descriptor Table (IDT)                 │
├──────┬──────────────────────────────────────────────────────┤
│ Vec  │ 설명                                                  │
├──────┼──────────────────────────────────────────────────────┤
│  0   │ Divide Error (#DE)                                   │
│  1   │ Debug Exception (#DB)                                │
│  2   │ NMI (Non-Maskable Interrupt)                         │
│  3   │ Breakpoint (#BP)                                     │
│  6   │ Invalid Opcode (#UD)                                 │
│  8   │ Double Fault (#DF)                                   │
│ 13   │ General Protection Fault (#GP)                       │
│ 14   │ Page Fault (#PF)                                     │
│ ...  │ ...                                                  │
│ 32   │ IRQ 0: Timer (PIT)                                   │
│ 33   │ IRQ 1: Keyboard                                      │
│ 34   │ IRQ 2: Cascade (PIC2 연결)                           │
│ 35   │ IRQ 3: COM2/COM4                                     │
│ 36   │ IRQ 4: COM1/COM3                                     │
│ ...  │ ...                                                  │
│ 46   │ IRQ 14: Primary IDE                                  │
│ 47   │ IRQ 15: Secondary IDE                                │
│ ...  │ ...                                                  │
│ 128  │ System Call (Linux: int 0x80)                        │
│ ...  │ ...                                                  │
│ 255  │ Reserved                                             │
└──────┴──────────────────────────────────────────────────────┘

IDT Entry 구조 (64비트):
┌─────────────────────────────────────────────────────────────┐
│  63        48 47 46  44 43    40 39  35 34  32             │
│  ├───────────┼──┼──────┼────────┼─────┼─────┤              │
│  │  Offset   │P │ DPL  │  Type  │ IST │  0  │              │
│  │   [63:48] │  │      │        │     │     │              │
│  └───────────┴──┴──────┴────────┴─────┴─────┘              │
│  31              16 15                0                     │
│  ├─────────────────┼─────────────────┤                     │
│  │  Segment Sel.   │  Offset [15:0]  │                     │
│  └─────────────────┴─────────────────┘                     │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="34-io">3.4 인터럽트 기반 I/O 프로그래밍<a class="header-link" href="#34-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// 인터럽트 기반 키보드 드라이버 예시</span>

<span class="cp">#define KEYBOARD_IRQ    1</span>
<span class="cp">#define KEYBOARD_PORT   0x60</span>

<span class="c1">// 키보드 버퍼</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">keyboard_buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">buffer_head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">volatile</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// 인터럽트 핸들러 (ISR)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">keyboard_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. 스캔코드 읽기</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">scancode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inb</span><span class="p">(</span><span class="n">KEYBOARD_PORT</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. 버퍼에 저장</span>
<span class="w">    </span><span class="n">keyboard_buffer</span><span class="p">[</span><span class="n">buffer_head</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scancode</span><span class="p">;</span>
<span class="w">    </span><span class="n">buffer_head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">buffer_head</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 3. EOI 전송 (인터럽트 완료 알림)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="mh">0x20</span><span class="p">,</span><span class="w"> </span><span class="mh">0x20</span><span class="p">);</span><span class="w">  </span><span class="c1">// PIC에 EOI</span>
<span class="p">}</span>

<span class="c1">// 문자 읽기 (블로킹)</span>
<span class="kt">char</span><span class="w"> </span><span class="nf">getchar_interrupt</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 버퍼에 데이터가 있을 때까지 대기</span>
<span class="w">    </span><span class="c1">// (실제로는 sleep/wakeup 사용)</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">buffer_head</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// CPU 절전 또는 다른 프로세스 실행</span>
<span class="w">        </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;hlt&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Halt until interrupt</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyboard_buffer</span><span class="p">[</span><span class="n">buffer_tail</span><span class="p">];</span>
<span class="w">    </span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">buffer_tail</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 인터럽트 핸들러 등록</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">init_keyboard</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// IDT에 핸들러 등록</span>
<span class="w">    </span><span class="n">set_interrupt_handler</span><span class="p">(</span><span class="mi">32</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">KEYBOARD_IRQ</span><span class="p">,</span><span class="w"> </span><span class="n">keyboard_handler</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 인터럽트 활성화</span>
<span class="w">    </span><span class="n">enable_irq</span><span class="p">(</span><span class="n">KEYBOARD_IRQ</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="35">3.5 인터럽트의 장단점<a class="header-link" href="#35" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>장점:
┌─────────────────────────────────────────────────────────────┐
│ - CPU 효율성 향상 (대기 시간에 다른 작업 수행)               │
│ - 비동기 이벤트 처리에 적합                                  │
│ - 다중 장치 처리 용이                                       │
│ - 전력 효율적 (CPU가 대기 상태로 전환 가능)                  │
└─────────────────────────────────────────────────────────────┘

단점:
┌─────────────────────────────────────────────────────────────┐
│ - 구현 복잡성 증가                                          │
│ - 인터럽트 오버헤드 (컨텍스트 저장/복원)                     │
│ - 인터럽트 지연 시간 (Latency) 존재                         │
│ - 고빈도 인터럽트 시 오버헤드 증가 (Interrupt Storm)        │
└─────────────────────────────────────────────────────────────┘

인터럽트 오버헤드:
- 상태 저장: ~100 사이클
- 핸들러 진입: ~50 사이클
- 캐시/TLB 영향: ~100+ 사이클
- 총: ~500-1000 사이클/인터럽트

초당 10만 인터럽트 @ 3GHz:
오버헤드 = 100,000 × 500 / 3,000,000,000 ≈ 1.7% CPU
</code></pre></div>

<hr />
<h2 id="4-dma-direct-memory-access">4. DMA (Direct Memory Access)<a class="header-link" href="#4-dma-direct-memory-access" title="Permanent link">&para;</a></h2>
<h3 id="41-dma">4.1 DMA의 개념<a class="header-link" href="#41-dma" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">정의</span><span class="o">:</span><span class="w"> </span><span class="n">CPU를</span><span class="w"> </span><span class="err">거치지</span><span class="w"> </span><span class="err">않고</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="err">장치와</span><span class="w"> </span><span class="err">메모리</span><span class="w"> </span><span class="err">간</span><span class="w"> </span><span class="err">직접</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">전송</span>

<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="n">DMA</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="err">기반</span><span class="w"> </span><span class="err">전송</span><span class="w"> </span><span class="err">비교</span><span class="w">                       </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">CPU</span><span class="w"> </span><span class="err">기반</span><span class="w"> </span><span class="err">전송</span><span class="w"> </span><span class="o">(</span><span class="n">Programmed</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="o">):</span><span class="w">                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">Memory</span><span class="w"> </span><span class="err">←────</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="err">────→</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w">                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="n">read</span><span class="w">      </span><span class="n">write</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="err">매</span><span class="w"> </span><span class="err">바이트마다</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="err">개입</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU가</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">이동</span><span class="w"> </span><span class="err">담당</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="err">시간</span><span class="w"> </span><span class="err">소모</span><span class="w"> </span><span class="err">큼</span><span class="w">                                        </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">DMA</span><span class="w"> </span><span class="err">전송</span><span class="o">:</span><span class="w">                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="n">Memory</span><span class="w"> </span><span class="err">◀══════════════▶</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">                                              </span><span class="err">│</span>
<span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="n">Controller</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">              </span><span class="err">└─────────┐</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                        </span><span class="err">│</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">           </span><span class="n">CPU</span><span class="w"> </span><span class="err">─────────┘</span><span class="w"> </span><span class="o">(</span><span class="err">설정만</span><span class="o">)</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU는</span><span class="w"> </span><span class="err">전송</span><span class="w"> </span><span class="err">설정만</span><span class="w"> </span><span class="err">담당</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">DMA</span><span class="w"> </span><span class="err">컨트롤러가</span><span class="w"> </span><span class="err">전송</span><span class="w"> </span><span class="err">수행</span><span class="w">                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="err">전송</span><span class="w"> </span><span class="err">완료</span><span class="w"> </span><span class="err">시</span><span class="w"> </span><span class="err">인터럽트로</span><span class="w"> </span><span class="err">알림</span><span class="w">                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">CPU는</span><span class="w"> </span><span class="err">다른</span><span class="w"> </span><span class="err">작업</span><span class="w"> </span><span class="err">가능</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="42-dma">4.2 DMA 동작 과정<a class="header-link" href="#42-dma" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    DMA 전송 과정                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. CPU가 DMA 컨트롤러 설정                                  │
│     ┌─────────────────────────────────────────────────────┐│
│     │ - 소스 주소 (메모리 또는 I/O)                        ││
│     │ - 목적지 주소                                        ││
│     │ - 전송 크기 (바이트 수)                              ││
│     │ - 전송 방향 (읽기/쓰기)                              ││
│     │ - 전송 모드 (블록/사이클 스틸링)                      ││
│     └─────────────────────────────────────────────────────┘│
│                                                             │
│  2. CPU가 DMA 전송 시작 명령                                 │
│                                                             │
│  3. DMA 컨트롤러가 버스 요청 (Bus Request)                   │
│     - CPU에 HOLD 신호 전송                                  │
│                                                             │
│  4. CPU가 버스 승인 (Bus Grant)                             │
│     - HLDA 신호로 버스 제어권 양도                          │
│     - CPU는 버스 사용하지 않는 작업 수행                    │
│                                                             │
│  5. DMA 컨트롤러가 데이터 전송                              │
│     ┌────────┐         ┌────────┐                          │
│     │ Memory │◀═══════▶│  I/O   │                          │
│     └────────┘   DMA   └────────┘                          │
│                  Bus                                        │
│                                                             │
│  6. 전송 완료 시                                            │
│     - 버스 반환                                             │
│     - CPU에 인터럽트 발생                                   │
│                                                             │
│  7. CPU가 완료 처리                                         │
│     - 상태 확인                                             │
│     - 필요시 다음 전송 설정                                 │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="43-dma">4.3 DMA 컨트롤러 구조<a class="header-link" href="#43-dma" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    DMA Controller                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │              Control Registers                       │    │
│  ├──────────────────────────────────────────────────────┤    │
│  │  ┌─────────────────────────────────────────────┐    │    │
│  │  │ Command Register                             │    │    │
│  │  │ - DMA 동작 모드 설정                          │    │    │
│  │  └─────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────┐    │    │
│  │  │ Mode Register                                │    │    │
│  │  │ - 전송 방향, 모드 (단일/블록/수요)            │    │    │
│  │  └─────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────┐    │    │
│  │  │ Status Register                              │    │    │
│  │  │ - 완료 상태, 요청 상태                        │    │    │
│  │  └─────────────────────────────────────────────┘    │    │
│  └──────────────────────────────────────────────────────┘    │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │              Channel 0                              │    │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │    │
│  │  │ Address Reg │ │ Count Reg   │ │ Page Reg    │   │    │
│  │  │  0x0000     │ │   1024      │ │   0x00      │   │    │
│  │  └─────────────┘ └─────────────┘ └─────────────┘   │    │
│  └──────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────┐    │
│  │              Channel 1                              │    │
│  │  ... (동일 구조)                                    │    │
│  └──────────────────────────────────────────────────────┘    │
│  ... Channel 2, 3, ...                                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="44-dma">4.4 DMA 전송 모드<a class="header-link" href="#44-dma" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="n">전송</span><span class="w"> </span><span class="p">(</span><span class="n">Block</span><span class="o">/</span><span class="n">Burst</span><span class="w"> </span><span class="n">Mode</span><span class="p">):</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────┬────────────────────────────────┬──────</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">CPU</span><span class="w">  </span><span class="err">│</span><span class="w">           </span><span class="n">DMA</span><span class="w">                  </span><span class="err">│</span><span class="w"> </span><span class="n">CPU</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">사용</span><span class="w">  </span><span class="err">│</span><span class="w">     </span><span class="n">버스</span><span class="w"> </span><span class="n">독점</span><span class="w"> </span><span class="n">사용</span><span class="w">              </span><span class="err">│</span><span class="n">사용</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──────┴────────────────────────────────┴──────</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">전체</span><span class="w"> </span><span class="n">블록을</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">번에</span><span class="w"> </span><span class="n">전송</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">가장</span><span class="w"> </span><span class="n">빠른</span><span class="w"> </span><span class="n">전송</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">CPU가</span><span class="w"> </span><span class="n">오래</span><span class="w"> </span><span class="n">대기할</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">있음</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">대용량</span><span class="w"> </span><span class="n">데이터에</span><span class="w"> </span><span class="n">적합</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">사이클</span><span class="w"> </span><span class="n">스틸링</span><span class="w"> </span><span class="p">(</span><span class="n">Cycle</span><span class="w"> </span><span class="n">Stealing</span><span class="p">):</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="err">│</span><span class="n">D</span><span class="w"> </span><span class="err">│</span><span class="n">C</span><span class="w"> </span><span class="err">│</span><span class="n">D</span><span class="w"> </span><span class="err">│</span><span class="n">C</span><span class="w"> </span><span class="err">│</span><span class="n">D</span><span class="w"> </span><span class="err">│</span><span class="n">C</span><span class="w"> </span><span class="err">│</span><span class="n">D</span><span class="w"> </span><span class="err">│</span><span class="n">C</span><span class="w"> </span><span class="err">│</span><span class="n">D</span><span class="w"> </span><span class="err">│</span><span class="n">C</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">P</span><span class="w"> </span><span class="err">│</span><span class="n">M</span><span class="w"> </span><span class="err">│</span><span class="n">P</span><span class="w"> </span><span class="err">│</span><span class="n">M</span><span class="w"> </span><span class="err">│</span><span class="n">P</span><span class="w"> </span><span class="err">│</span><span class="n">M</span><span class="w"> </span><span class="err">│</span><span class="n">P</span><span class="w"> </span><span class="err">│</span><span class="n">M</span><span class="w"> </span><span class="err">│</span><span class="n">P</span><span class="w"> </span><span class="err">│</span><span class="n">M</span><span class="w"> </span><span class="err">│</span><span class="n">P</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">U</span><span class="w"> </span><span class="err">│</span><span class="n">A</span><span class="w"> </span><span class="err">│</span><span class="n">U</span><span class="w"> </span><span class="err">│</span><span class="n">A</span><span class="w"> </span><span class="err">│</span><span class="n">U</span><span class="w"> </span><span class="err">│</span><span class="n">A</span><span class="w"> </span><span class="err">│</span><span class="n">U</span><span class="w"> </span><span class="err">│</span><span class="n">A</span><span class="w"> </span><span class="err">│</span><span class="n">U</span><span class="w"> </span><span class="err">│</span><span class="n">A</span><span class="w"> </span><span class="err">│</span><span class="n">U</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">번에</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">워드</span><span class="o">/</span><span class="n">바이트씩</span><span class="w"> </span><span class="n">전송</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">CPU와</span><span class="w"> </span><span class="n">DMA가</span><span class="w"> </span><span class="n">번갈아</span><span class="w"> </span><span class="n">버스</span><span class="w"> </span><span class="n">사용</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="n">영향</span><span class="w"> </span><span class="n">최소화</span><span class="w">                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">전송</span><span class="w"> </span><span class="n">속도는</span><span class="w"> </span><span class="n">느림</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="mf">3.</span><span class="w"> </span><span class="n">수요</span><span class="w"> </span><span class="n">전송</span><span class="w"> </span><span class="p">(</span><span class="n">Demand</span><span class="w"> </span><span class="n">Mode</span><span class="p">):</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">장치가</span><span class="w"> </span><span class="n">준비될</span><span class="w"> </span><span class="n">때마다</span><span class="w"> </span><span class="n">전송</span><span class="w"> </span><span class="p">(</span><span class="n">DREQ</span><span class="w"> </span><span class="n">신호</span><span class="w"> </span><span class="n">기반</span><span class="p">)</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">장치</span><span class="w"> </span><span class="n">속도에</span><span class="w"> </span><span class="n">맞춤</span><span class="w">                                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="45-dma">4.5 DMA 프로그래밍 예시<a class="header-link" href="#45-dma" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// DMA 디스크 읽기 예시 (간략화)</span>

<span class="cp">#define DMA_CHANNEL     2</span>
<span class="cp">#define DMA_ADDR_REG    0x04  </span><span class="c1">// 채널 2 주소</span>
<span class="cp">#define DMA_COUNT_REG   0x05  </span><span class="c1">// 채널 2 카운트</span>
<span class="cp">#define DMA_PAGE_REG    0x81  </span><span class="c1">// 채널 2 페이지</span>
<span class="cp">#define DMA_MODE_REG    0x0B</span>
<span class="cp">#define DMA_MASK_REG    0x0A</span>

<span class="c1">// DMA 전송 설정</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">setup_dma_read</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">buffer</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 1. DMA 채널 마스크 (비활성화)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_MASK_REG</span><span class="p">,</span><span class="w"> </span><span class="n">DMA_CHANNEL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mh">0x04</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. 플립플롭 리셋</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. 모드 설정 (읽기, 채널 2, 단일 모드)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_MODE_REG</span><span class="p">,</span><span class="w"> </span><span class="mh">0x46</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. 주소 설정 (하위 16비트)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_ADDR_REG</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_ADDR_REG</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 5. 페이지 설정 (상위 비트)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_PAGE_REG</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 6. 카운트 설정 (count - 1)</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_COUNT_REG</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_COUNT_REG</span><span class="p">,</span><span class="w"> </span><span class="p">((</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 7. DMA 채널 활성화</span>
<span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="n">DMA_MASK_REG</span><span class="p">,</span><span class="w"> </span><span class="n">DMA_CHANNEL</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 디스크 읽기 명령 + DMA</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">read_disk_dma</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">sector</span><span class="p">,</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// DMA 설정</span>
<span class="w">    </span><span class="n">setup_dma_read</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 디스크 컨트롤러에 읽기 명령 발행</span>
<span class="w">    </span><span class="n">issue_disk_read_command</span><span class="p">(</span><span class="n">sector</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// CPU는 다른 작업 수행 가능</span>
<span class="w">    </span><span class="c1">// 전송 완료 시 인터럽트 발생</span>
<span class="p">}</span>

<span class="c1">// DMA 완료 인터럽트 핸들러</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">dma_complete_handler</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 전송 완료 처리</span>
<span class="w">    </span><span class="c1">// 상태 확인, 버퍼 사용 가능</span>
<span class="w">    </span><span class="n">signal_dma_complete</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="5">5. 버스 구조<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 버스의 종류<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    시스템 버스 구조                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                      CPU                             │    │
│  └─────────────────────────┬───────────────────────────┘    │
│                            │                                │
│                       Front-Side Bus                        │
│                      (또는 QPI/UPI)                         │
│                            │                                │
│  ┌─────────────────────────┴───────────────────────────┐    │
│  │              Memory Controller Hub                   │    │
│  │                   (Northbridge)                      │    │
│  └───────────┬─────────────┬─────────────┬─────────────┘    │
│              │             │             │                  │
│          Memory         PCIe         DMI                   │
│           Bus           x16                                │
│              │             │             │                  │
│  ┌───────────┴───┐    ┌────┴────┐       │                  │
│  │    DRAM       │    │   GPU   │       │                  │
│  └───────────────┘    └─────────┘       │                  │
│                                         │                  │
│  ┌──────────────────────────────────────┴──────────────┐   │
│  │             I/O Controller Hub                      │   │
│  │                 (Southbridge)                       │   │
│  └───────┬──────────┬──────────┬──────────┬───────────┘   │
│          │          │          │          │                │
│        SATA       USB        PCIe      Audio              │
│          │          │        x1         │                  │
│    ┌─────┴─────┐ ┌──┴──┐  ┌──┴──┐  ┌───┴───┐             │
│    │ HDD/SSD  │ │ USB │  │ NIC │  │Codec  │             │
│    └──────────┘ │Devs │  └─────┘  └───────┘             │
│                 └─────┘                                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="52">5.2 버스 특성<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>버스 구성 요소:
┌─────────────────────────────────────────────────────────────┐
│  ┌───────────────────────────────────────────────────────┐  │
│  │                    Data Bus                            │  │
│  │  - 데이터 전송 라인                                     │  │
│  │  - 폭: 8, 16, 32, 64비트                               │  │
│  │  - 양방향                                              │  │
│  └───────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                   Address Bus                          │  │
│  │  - 메모리/I/O 주소 지정                                 │  │
│  │  - 폭: 20, 32, 36, 40+비트                             │  │
│  │  - 단방향 (CPU → 장치)                                  │  │
│  └───────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                   Control Bus                          │  │
│  │  - 제어 신호 전송                                       │  │
│  │  - Read, Write, IRQ, DMA 요청 등                       │  │
│  │  - 양방향                                              │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘

주요 버스 표준:
┌────────────────┬──────────────┬───────────────┬─────────────┐
│     버스        │   대역폭      │    용도        │    특징     │
├────────────────┼──────────────┼───────────────┼─────────────┤
│ PCIe 4.0 x16   │  ~64 GB/s    │ GPU, 고속 장치 │ 직렬, 레인  │
├────────────────┼──────────────┼───────────────┼─────────────┤
│ PCIe 5.0 x16   │  ~128 GB/s   │ 차세대 GPU    │ 최신 표준   │
├────────────────┼──────────────┼───────────────┼─────────────┤
│ SATA III       │  ~600 MB/s   │ 저장 장치      │ 직렬        │
├────────────────┼──────────────┼───────────────┼─────────────┤
│ NVMe (PCIe 4)  │  ~7 GB/s     │ 고속 SSD      │ 저지연      │
├────────────────┼──────────────┼───────────────┼─────────────┤
│ USB 3.2 Gen2  │  ~1.25 GB/s  │ 주변 장치      │ 범용        │
├────────────────┼──────────────┼───────────────┼─────────────┤
│ Thunderbolt 4 │  ~5 GB/s     │ 고속 주변장치  │ 데이지체인  │
└────────────────┴──────────────┴───────────────┴─────────────┘
</code></pre></div>

<h3 id="53">5.3 버스 중재<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>여러 장치가 버스를 공유할 때 충돌 방지:

1. 중앙 집중식 중재:
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐           │
│  │Device 0│  │Device 1│  │Device 2│  │Device 3│           │
│  └───┬────┘  └───┬────┘  └───┬────┘  └───┬────┘           │
│      │  REQ      │  REQ      │  REQ      │  REQ            │
│      │           │           │           │                  │
│      └─────┬─────┴─────┬─────┴─────┬─────┘                  │
│            │           │           │                        │
│            ▼           ▼           ▼                        │
│  ┌──────────────────────────────────────────────┐          │
│  │              Bus Arbiter                      │          │
│  │           (중앙 중재기)                        │          │
│  │  - 요청 수신                                  │          │
│  │  - 우선순위에 따라 GRANT 신호 발행            │          │
│  └──────────────────────────────────────────────┘          │
│            │           │           │                        │
│      GRANT │     GRANT │     GRANT │                        │
│            ▼           ▼           ▼                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘

2. 우선순위 방식:
- 고정 우선순위: 장치마다 고정된 우선순위
- 라운드 로빈: 순환하며 공평하게 할당
- 동적 우선순위: 사용 패턴에 따라 조정
</code></pre></div>

<hr />
<h2 id="6-io">6. I/O 인터페이스<a class="header-link" href="#6-io" title="Permanent link">&para;</a></h2>
<h3 id="61-io">6.1 I/O 주소 지정<a class="header-link" href="#61-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">분리</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="p">(</span><span class="n">Isolated</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Port</span><span class="o">-</span><span class="n">Mapped</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="p">):</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">메모리</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="n">공간</span><span class="w">                </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="n">공간</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────┐</span><span class="w">        </span><span class="err">┌────────────────────┐</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">x0000_0000</span><span class="w">        </span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">x0000</span><span class="w">             </span><span class="err">│</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="n">Memory</span><span class="w">        </span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">    </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Ports</span><span class="w">       </span><span class="err">│</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">xFFFF_FFFF</span><span class="w">        </span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">xFFFF</span><span class="w">             </span><span class="err">│</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────┘</span><span class="w">        </span><span class="err">└────────────────────┘</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">별도의</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="n">공간</span><span class="w"> </span><span class="n">사용</span><span class="w">                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">IN</span><span class="p">,</span><span class="w"> </span><span class="n">OUT</span><span class="w"> </span><span class="n">명령어</span><span class="w"> </span><span class="n">사용</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">x86</span><span class="w"> </span><span class="n">아키텍처에서</span><span class="w"> </span><span class="n">사용</span><span class="w">                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">예시</span><span class="p">:</span><span class="w">                                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">outb</span><span class="p">(</span><span class="mf">0</span><span class="n">x3F8</span><span class="p">,</span><span class="w"> </span><span class="kd">data</span><span class="p">);</span><span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">포트</span><span class="w"> </span><span class="mf">0</span><span class="n">x3F8에</span><span class="w"> </span><span class="n">쓰기</span><span class="w">                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="kd">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inb</span><span class="p">(</span><span class="mf">0</span><span class="n">x3F8</span><span class="p">);</span><span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">포트</span><span class="w"> </span><span class="mf">0</span><span class="n">x3F8에서</span><span class="w"> </span><span class="n">읽기</span><span class="w">                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">맵</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="p">(</span><span class="n">Memory</span><span class="o">-</span><span class="n">Mapped</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="p">):</span>
<span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">통합</span><span class="w"> </span><span class="n">주소</span><span class="w"> </span><span class="n">공간</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌────────────────────────────────────────────┐</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">x0000_0000</span><span class="w">                                </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                            </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="kr">Sys</span><span class="n">tem</span><span class="w"> </span><span class="n">Memory</span><span class="w"> </span><span class="p">(</span><span class="n">RAM</span><span class="p">)</span><span class="w">                   </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                            </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">x7FFF_FFFF</span><span class="w">                                </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">├────────────────────────────────────────────┤</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">x8000_0000</span><span class="w">                                </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                            </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">Device</span><span class="w"> </span><span class="n">Registers</span><span class="w">                  </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">      </span><span class="p">(</span><span class="n">메모리처럼</span><span class="w"> </span><span class="n">접근</span><span class="p">)</span><span class="w">                       </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">                                            </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mf">0</span><span class="n">xFFFF_FFFF</span><span class="w">                                </span><span class="err">│</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└────────────────────────────────────────────┘</span><span class="w">            </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">일반</span><span class="w"> </span><span class="n">메모리</span><span class="w"> </span><span class="n">명령어로</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">접근</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">ARM</span><span class="p">,</span><span class="w"> </span><span class="n">RISC</span><span class="o">-</span><span class="n">V</span><span class="w"> </span><span class="n">등에서</span><span class="w"> </span><span class="n">주로</span><span class="w"> </span><span class="n">사용</span><span class="w">                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">현대</span><span class="w"> </span><span class="n">PC에서도</span><span class="w"> </span><span class="n">대부분의</span><span class="w"> </span><span class="n">장치가</span><span class="w"> </span><span class="n">MMIO</span><span class="w"> </span><span class="n">사용</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">예시</span><span class="p">:</span><span class="w">                                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">volatile</span><span class="w"> </span><span class="n">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uint32_t</span><span class="o">*</span><span class="p">)</span><span class="mf">0</span><span class="n">xFE200000</span><span class="p">;</span><span class="w">           </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="o">*</span><span class="n">reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">val</span><span class="n">ue</span><span class="p">;</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">레지스터에</span><span class="w"> </span><span class="n">쓰기</span><span class="w">               </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="nb">val</span><span class="n">ue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">reg</span><span class="p">;</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="n">레지스터에서</span><span class="w"> </span><span class="n">읽기</span><span class="w">             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="62">6.2 장치 드라이버 구조<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="nt">디바이스</span><span class="w"> </span><span class="nt">드라이버</span><span class="w"> </span><span class="nt">구조</span><span class="w">                     </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌─────────────────────────────────────────────────────┐</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="nt">Driver</span><span class="w"> </span><span class="nt">Entry</span><span class="w"> </span><span class="nt">Points</span><span class="w">                     </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">├─────────────────────────────────────────────────────┤</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">init</span><span class="o">()</span><span class="w">      </span><span class="nt">-</span><span class="w"> </span><span class="nt">드라이버</span><span class="w"> </span><span class="nt">초기화</span><span class="w">                       </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">open</span><span class="o">()</span><span class="w">      </span><span class="nt">-</span><span class="w"> </span><span class="nt">장치</span><span class="w"> </span><span class="nt">열기</span><span class="w">                             </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">close</span><span class="o">()</span><span class="w">     </span><span class="nt">-</span><span class="w"> </span><span class="nt">장치</span><span class="w"> </span><span class="nt">닫기</span><span class="w">                             </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">read</span><span class="o">()</span><span class="w">      </span><span class="nt">-</span><span class="w"> </span><span class="nt">데이터</span><span class="w"> </span><span class="nt">읽기</span><span class="w">                           </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">write</span><span class="o">()</span><span class="w">     </span><span class="nt">-</span><span class="w"> </span><span class="nt">데이터</span><span class="w"> </span><span class="nt">쓰기</span><span class="w">                           </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">ioctl</span><span class="o">()</span><span class="w">     </span><span class="nt">-</span><span class="w"> </span><span class="nt">제어</span><span class="w"> </span><span class="nt">명령</span><span class="w">                             </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">interrupt_handler</span><span class="o">()</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">인터럽트</span><span class="w"> </span><span class="nt">처리</span><span class="w">                 </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└─────────────────────────────────────────────────────┘</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">┌─────────────────────────────────────────────────────┐</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">              </span><span class="nt">Driver</span><span class="w"> </span><span class="nt">Internal</span><span class="w"> </span><span class="nt">Data</span><span class="w">                    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">├─────────────────────────────────────────────────────┤</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">장치</span><span class="w"> </span><span class="nt">상태</span><span class="w">                                         </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">버퍼</span><span class="w">                                              </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">대기</span><span class="w"> </span><span class="nt">큐</span><span class="w">                                           </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="nt">-</span><span class="w"> </span><span class="nt">설정</span><span class="w"> </span><span class="nt">정보</span><span class="w">                                         </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">└─────────────────────────────────────────────────────┘</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>

<span class="nt">리눅스</span><span class="w"> </span><span class="nt">디바이스</span><span class="w"> </span><span class="nt">드라이버</span><span class="w"> </span><span class="nt">예시</span><span class="o">:</span>
<span class="nt">static</span><span class="w"> </span><span class="nt">struct</span><span class="w"> </span><span class="nt">file_operations</span><span class="w"> </span><span class="nt">my_fops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">.owner</span><span class="w">   </span><span class="err">=</span><span class="w"> </span><span class="err">THIS_MODULE,</span>
<span class="w">    </span><span class="err">.open</span><span class="w">    </span><span class="err">=</span><span class="w"> </span><span class="err">my_open,</span>
<span class="w">    </span><span class="err">.release</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">my_close,</span>
<span class="w">    </span><span class="err">.read</span><span class="w">    </span><span class="err">=</span><span class="w"> </span><span class="err">my_read,</span>
<span class="w">    </span><span class="err">.write</span><span class="w">   </span><span class="err">=</span><span class="w"> </span><span class="err">my_write,</span>
<span class="w">    </span><span class="err">.unlocked_ioctl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">my_ioctl,</span>
<span class="p">}</span><span class="o">;</span>
</code></pre></div>

<hr />
<h2 id="7-io">7. 현대 I/O 시스템<a class="header-link" href="#7-io" title="Permanent link">&para;</a></h2>
<h3 id="71-nvme-non-volatile-memory-express">7.1 NVMe (Non-Volatile Memory Express)<a class="header-link" href="#71-nvme-non-volatile-memory-express" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    NVMe 아키텍처                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  기존 SATA/AHCI vs NVMe:                                    │
│                                                             │
│  SATA/AHCI:                                                 │
│  - 단일 명령 큐 (깊이 32)                                    │
│  - HDD 시대에 설계                                          │
│  - 높은 지연시간                                            │
│                                                             │
│  NVMe:                                                      │
│  - 64K 큐, 각 큐당 64K 명령                                 │
│  - SSD에 최적화                                             │
│  - 낮은 지연시간                                            │
│  - PCIe 직접 연결                                           │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                   CPU / Driver                       │   │
│  └─────────────────────────┬───────────────────────────┘   │
│                            │                                │
│           ┌────────────────┼────────────────┐              │
│           │                │                │              │
│           ▼                ▼                ▼              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │ Submit Q 0  │  │ Submit Q 1  │  │ Submit Q N  │        │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘        │
│         │                │                │                │
│         └────────────────┼────────────────┘                │
│                          │                                  │
│                          ▼                                  │
│  ┌──────────────────────────────────────────────────────┐  │
│  │                 NVMe Controller                       │  │
│  └──────────────────────────────────────────────────────┘  │
│                          │                                  │
│         ┌────────────────┼────────────────┐                │
│         │                │                │                │
│         ▼                ▼                ▼                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │Complete Q 0 │  │Complete Q 1 │  │Complete Q N │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="72-usb">7.2 USB 시스템<a class="header-link" href="#72-usb" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    USB 아키텍처                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  USB 세대별 속도:                                           │
│  ┌──────────────┬──────────────────────────────────────┐   │
│  │ USB 2.0     │  480 Mbps (High Speed)               │   │
│  │ USB 3.0     │  5 Gbps (SuperSpeed)                 │   │
│  │ USB 3.1     │  10 Gbps (SuperSpeed+)               │   │
│  │ USB 3.2     │  20 Gbps (SuperSpeed USB 20Gbps)     │   │
│  │ USB4        │  40 Gbps                              │   │
│  └──────────────┴──────────────────────────────────────┘   │
│                                                             │
│  USB 전송 타입:                                             │
│  ┌──────────────┬──────────────────────────────────────┐   │
│  │ Control     │ 설정, 제어 (작은 데이터)              │   │
│  │ Bulk        │ 대용량 데이터 (저장 장치)             │   │
│  │ Interrupt   │ 소량, 주기적 (키보드, 마우스)         │   │
│  │ Isochronous │ 실시간, 주기적 (오디오, 비디오)       │   │
│  └──────────────┴──────────────────────────────────────┘   │
│                                                             │
│  USB 토폴로지:                                              │
│                                                             │
│       Host Controller                                       │
│            │                                                │
│            ▼                                                │
│        Root Hub                                             │
│        /   |   \                                            │
│       /    |    \                                           │
│    Hub  Device  Device                                      │
│    / \                                                      │
│   /   \                                                     │
│ Dev   Dev                                                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="73-io">7.3 가상화 I/O<a class="header-link" href="#73-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                   I/O 가상화 기법                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 에뮬레이션:                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  Guest OS  →  Hypervisor  →  Physical Device        │   │
│  │            (I/O 트랩 및 에뮬레이션)                   │   │
│  └─────────────────────────────────────────────────────┘   │
│  - 느림, 호환성 높음                                        │
│                                                             │
│  2. Para-virtualization (virtio):                          │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  Guest OS (virtio 드라이버) → Hypervisor → Device   │   │
│  └─────────────────────────────────────────────────────┘   │
│  - 최적화된 가상 인터페이스                                 │
│  - 게스트 OS 수정 필요                                     │
│                                                             │
│  3. Direct Device Assignment (VFIO):                       │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  Guest OS  →  Physical Device (직접 접근)           │   │
│  │            (IOMMU로 메모리 격리)                     │   │
│  └─────────────────────────────────────────────────────┘   │
│  - 네이티브 성능                                           │
│  - 장치 공유 불가                                          │
│                                                             │
│  4. SR-IOV (Single Root I/O Virtualization):               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  하나의 물리 장치를 여러 가상 함수(VF)로 분할         │   │
│  │  각 VM이 독립적인 VF에 직접 접근                      │   │
│  └─────────────────────────────────────────────────────┘   │
│  - 네이티브 성능 + 공유 가능                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="8">8. 연습 문제<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="_4">기초 문제<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>폴링, 인터럽트, DMA 방식의 차이점을 설명하시오.</p>
</li>
<li>
<p>인터럽트 벡터 테이블의 역할은?</p>
</li>
<li>
<p>DMA 컨트롤러에 설정해야 하는 정보 3가지는?</p>
</li>
</ol>
<h3 id="_5">중급 문제<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<ol>
<li>다음 상황에서 적합한 I/O 방식을 선택하시오:</li>
<li>(a) 키보드 입력 처리</li>
<li>(b) 10MB 파일 디스크에서 읽기</li>
<li>
<p>(c) 고속 네트워크 패킷 처리 (10Gbps)</p>
</li>
<li>
<p>인터럽트 기반 I/O에서 발생할 수 있는 "Interrupt Storm"이란?</p>
</li>
<li>
<p>메모리 맵 I/O와 포트 맵 I/O의 장단점을 비교하시오.</p>
</li>
</ol>
<h3 id="_6">심화 문제<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<ol>
<li>다음 조건에서 CPU 효율을 계산하시오:</li>
<li>CPU 클럭: 3GHz</li>
<li>디스크 전송률: 500MB/s</li>
<li>DMA 블록 크기: 4KB</li>
<li>
<p>DMA 완료 인터럽트 처리 시간: 1000 사이클</p>
</li>
<li>
<p>USB의 4가지 전송 타입을 설명하고 각각에 적합한 장치 예를 들시오.</p>
</li>
<li>
<p>SR-IOV가 가상화 환경에서 I/O 성능을 향상시키는 원리를 설명하시오.</p>
</li>
</ol>
<details>
<summary>정답</summary>

1. I/O 방식 비교:
   - 폴링: CPU가 계속 상태 확인, 간단하지만 CPU 낭비
   - 인터럽트: 장치가 완료 알림, CPU 효율적이지만 오버헤드
   - DMA: 메모리 직접 전송, 대용량에 효율적이지만 복잡

2. 인터럽트 벡터 테이블:
   - 인터럽트 번호를 핸들러 주소로 매핑
   - 인터럽트 발생 시 해당 핸들러로 점프

3. DMA 설정 정보:
   - 소스/목적지 주소
   - 전송 크기 (바이트 수)
   - 전송 방향 (읽기/쓰기)

4. 적합한 I/O 방식:
   - (a) 인터럽트 (저속, 비동기)
   - (b) DMA (대용량 블록 전송)
   - (c) DMA + 폴링 또는 NAPI (고속, 많은 패킷)

5. Interrupt Storm:
   - 너무 많은 인터럽트가 발생하여 CPU가 핸들러 처리만 하는 상황
   - 정상 작업 수행 불가
   - 해결: 인터럽트 병합, 폴링 전환 (NAPI)

6. I/O 주소 지정 비교:
   - 포트 맵: 별도 주소 공간, 별도 명령어 필요, 주소 공간 절약
   - 메모리 맵: 통합 주소 공간, 일반 명령어 사용, 캐시 주의 필요

7. CPU 효율 계산:
   - 전송률 500MB/s, 블록 4KB → 초당 125,000 전송
   - 각 전송마다 1000 사이클 인터럽트 처리
   - 총 인터럽트 사이클: 125,000,000
   - CPU 효율: 1 - (125M / 3G) = 1 - 0.042 = 95.8%

8. USB 전송 타입:
   - Control: 장치 설정, 상태 확인 (모든 USB 장치)
   - Bulk: 대용량 데이터 (USB 드라이브, 프린터)
   - Interrupt: 소량 주기적 (키보드, 마우스)
   - Isochronous: 실시간 (웹캠, USB 오디오)

9. SR-IOV 원리:
   - 하나의 물리 장치에 여러 가상 함수(VF) 생성
   - 각 VM이 전용 VF에 직접 접근
   - 하이퍼바이저 개입 없이 네이티브 성능
   - IOMMU로 메모리 격리 보장

</details>

<hr />
<h2 id="_7">다음 단계<a class="header-link" href="#_7" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./18_Parallel_Processing_Multicore.md">18_Parallel_Processing_Multicore.md</a> - 멀티코어 아키텍처와 병렬 프로그래밍</li>
</ul>
<hr />
<h2 id="_8">참고 자료<a class="header-link" href="#_8" title="Permanent link">&para;</a></h2>
<ul>
<li>Computer Organization and Design (Patterson &amp; Hennessy)</li>
<li>Operating System Concepts (Silberschatz et al.)</li>
<li><a href="https://nvmexpress.org/specifications/">NVMe Specification</a></li>
<li><a href="https://www.usb.org/documents">USB Specification</a></li>
<li>Linux Device Drivers (Corbet, Rubini, Kroah-Hartman)</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Computer_Architecture/16_Virtual_Memory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">가상 메모리</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Computer_Architecture/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Computer_Architecture/18_Parallel_Processing_Multicore.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">병렬 처리와 멀티코어</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}