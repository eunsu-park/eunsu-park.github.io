{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apache Spark ê¸°ì´ˆ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Data_Engineering/">Data Engineering</a>
    <span class="separator">/</span>
    <span class="current">Apache Spark ê¸°ì´ˆ</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Apache Spark ê¸°ì´ˆ</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Engineering/06_Prefect_Modern_Orchestration.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Prefect ëª¨ë˜ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Engineering/08_PySpark_DataFrames.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">PySpark DataFrame</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">ê°œìš”</a></li>
<li><a href="#1-spark">1. Spark ê°œìš”</a><ul>
<li><a href="#11-spark">1.1 Sparkì˜ íŠ¹ì§•</a></li>
<li><a href="#12-spark">1.2 Spark ìƒíƒœê³„</a></li>
</ul>
</li>
<li><a href="#2-spark">2. Spark ì•„í‚¤í…ì²˜</a><ul>
<li><a href="#21">2.1 í´ëŸ¬ìŠ¤í„° êµ¬ì„±</a></li>
<li><a href="#22">2.2 í•µì‹¬ ê°œë…</a></li>
<li><a href="#23">2.3 ì‹¤í–‰ íë¦„</a></li>
</ul>
</li>
<li><a href="#3-rdd-resilient-distributed-dataset">3. RDD (Resilient Distributed Dataset)</a><ul>
<li><a href="#31-rdd">3.1 RDD ê°œë…</a></li>
<li><a href="#32-rdd">3.2 RDD ì—°ì‚°</a></li>
<li><a href="#33-pair-rdd">3.3 Pair RDD ì—°ì‚°</a></li>
</ul>
</li>
<li><a href="#4">4. ì„¤ì¹˜ ë° ì‹¤í–‰</a><ul>
<li><a href="#41-pyspark">4.1 ë¡œì»¬ ì„¤ì¹˜ (PySpark)</a></li>
<li><a href="#42-docker">4.2 Docker ì„¤ì¹˜</a></li>
<li><a href="#43">4.3 í´ëŸ¬ìŠ¤í„° ëª¨ë“œ</a></li>
</ul>
</li>
<li><a href="#5-sparksession">5. SparkSession</a><ul>
<li><a href="#51-sparksession">5.1 SparkSession ìƒì„±</a></li>
<li><a href="#52">5.2 ì£¼ìš” ì„¤ì •</a></li>
</ul>
</li>
<li><a href="#6">6. ê¸°ë³¸ ì˜ˆì œ</a><ul>
<li><a href="#61-word-count">6.1 Word Count</a></li>
<li><a href="#62-dataframe">6.2 DataFrame ê¸°ë³¸</a></li>
</ul>
</li>
<li><a href="#_2">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-rdd">ë¬¸ì œ 1: RDD ê¸°ë³¸ ì—°ì‚°</a></li>
<li><a href="#2-pair-rdd">ë¬¸ì œ 2: Pair RDD</a></li>
</ul>
</li>
<li><a href="#_3">ìš”ì•½</a></li>
<li><a href="#_4">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="apache-spark">Apache Spark ê¸°ì´ˆ<a class="header-link" href="#apache-spark" title="Permanent link">&para;</a></h1>
<h2 id="_1">ê°œìš”<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>Apache SparkëŠ” ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ í†µí•© ë¶„ì„ ì—”ì§„ì…ë‹ˆë‹¤. ì¸ë©”ëª¨ë¦¬ ì²˜ë¦¬ë¡œ Hadoop MapReduceë³´ë‹¤ ë¹ ë¥¸ ì„±ëŠ¥ì„ ì œê³µí•˜ë©°, ë°°ì¹˜ ì²˜ë¦¬ì™€ ìŠ¤íŠ¸ë¦¬ë°ì„ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="1-spark">1. Spark ê°œìš”<a class="header-link" href="#1-spark" title="Permanent link">&para;</a></h2>
<h3 id="11-spark">1.1 Sparkì˜ íŠ¹ì§•<a class="header-link" href="#11-spark" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Apache Spark íŠ¹ì§•                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   1. ì†ë„ (Speed)                                              â”‚
â”‚      - ì¸ë©”ëª¨ë¦¬ ì²˜ë¦¬ë¡œ Hadoopë³´ë‹¤ 100ë°° ë¹ ë¦„                     â”‚
â”‚      - ë””ìŠ¤í¬ ê¸°ë°˜ë³´ë‹¤ 10ë°° ë¹ ë¦„                                 â”‚
â”‚                                                                â”‚
â”‚   2. ì‚¬ìš© í¸ì˜ì„± (Ease of Use)                                  â”‚
â”‚      - Python, Scala, Java, R ì§€ì›                             â”‚
â”‚      - SQL ì¸í„°í˜ì´ìŠ¤ ì œê³µ                                      â”‚
â”‚                                                                â”‚
â”‚   3. ë²”ìš©ì„± (Generality)                                       â”‚
â”‚      - SQL, ìŠ¤íŠ¸ë¦¬ë°, ML, ê·¸ë˜í”„ ì²˜ë¦¬                           â”‚
â”‚      - í•˜ë‚˜ì˜ ì—”ì§„ìœ¼ë¡œ ë‹¤ì–‘í•œ ì›Œí¬ë¡œë“œ                           â”‚
â”‚                                                                â”‚
â”‚   4. í˜¸í™˜ì„± (Compatibility)                                     â”‚
â”‚      - HDFS, S3, Cassandra ë“± ë‹¤ì–‘í•œ ë°ì´í„° ì†ŒìŠ¤                â”‚
â”‚      - YARN, Kubernetes, Standalone í´ëŸ¬ìŠ¤í„°                    â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12-spark">1.2 Spark ìƒíƒœê³„<a class="header-link" href="#12-spark" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Spark Ecosystem                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Spark SQL â”‚ â”‚ Streaming  â”‚ â”‚   MLlib    â”‚ â”‚  GraphX    â”‚  â”‚
â”‚   â”‚    + DF    â”‚ â”‚ (Structured)â”‚ â”‚(Machine   â”‚ â”‚  (Graph)   â”‚  â”‚
â”‚   â”‚            â”‚ â”‚             â”‚ â”‚ Learning) â”‚ â”‚            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   â”‚                     Spark Core                           â”‚  â”‚
â”‚   â”‚                 (RDD, Task Scheduling)                   â”‚  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   â”‚    Standalone    â”‚    YARN    â”‚    Kubernetes    â”‚ Mesos â”‚  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   â”‚  HDFS  â”‚   S3   â”‚   GCS   â”‚  Cassandra  â”‚  JDBC  â”‚ etc â”‚  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-spark">2. Spark ì•„í‚¤í…ì²˜<a class="header-link" href="#2-spark" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 í´ëŸ¬ìŠ¤í„° êµ¬ì„±<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Spark Cluster Architecture                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    Driver Program                      â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚   â”‚   â”‚              SparkContext                        â”‚ â”‚    â”‚
â”‚   â”‚   â”‚   - ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì                           â”‚ â”‚    â”‚
â”‚   â”‚   â”‚   - í´ëŸ¬ìŠ¤í„°ì™€ ì—°ê²°                              â”‚ â”‚    â”‚
â”‚   â”‚   â”‚   - Job ìƒì„± ë° ìŠ¤ì¼€ì¤„ë§                         â”‚ â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â†“                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                  Cluster Manager                       â”‚    â”‚
â”‚   â”‚       (Standalone, YARN, Kubernetes, Mesos)            â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â†“                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚   Worker    â”‚  â”‚   Worker    â”‚  â”‚   Worker    â”‚           â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚
â”‚   â”‚  â”‚Executorâ”‚ â”‚  â”‚  â”‚Executorâ”‚ â”‚  â”‚  â”‚Executorâ”‚ â”‚           â”‚
â”‚   â”‚  â”‚ Task  â”‚  â”‚  â”‚  â”‚ Task  â”‚  â”‚  â”‚  â”‚ Task  â”‚  â”‚           â”‚
â”‚   â”‚  â”‚ Task  â”‚  â”‚  â”‚  â”‚ Task  â”‚  â”‚  â”‚  â”‚ Task  â”‚  â”‚           â”‚
â”‚   â”‚  â”‚ Cache â”‚  â”‚  â”‚  â”‚ Cache â”‚  â”‚  â”‚  â”‚ Cache â”‚  â”‚           â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="22">2.2 í•µì‹¬ ê°œë…<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê°œë…</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Driver</strong></td>
<td>ë©”ì¸ í”„ë¡œê·¸ë¨ ì‹¤í–‰, SparkContext ìƒì„±</td>
</tr>
<tr>
<td><strong>Executor</strong></td>
<td>Worker ë…¸ë“œì—ì„œ Task ì‹¤í–‰</td>
</tr>
<tr>
<td><strong>Task</strong></td>
<td>ì‹¤í–‰ì˜ ê¸°ë³¸ ë‹¨ìœ„</td>
</tr>
<tr>
<td><strong>Job</strong></td>
<td>Actionì— ì˜í•´ ìƒì„±ë˜ëŠ” ë³‘ë ¬ ê³„ì‚°</td>
</tr>
<tr>
<td><strong>Stage</strong></td>
<td>Job ë‚´ì˜ Task ê·¸ë£¹ (Shuffle ê²½ê³„)</td>
</tr>
<tr>
<td><strong>Partition</strong></td>
<td>ë°ì´í„°ì˜ ë…¼ë¦¬ì  ë¶„í•  ë‹¨ìœ„</td>
</tr>
</tbody>
</table>
<h3 id="23">2.3 ì‹¤í–‰ íë¦„<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Spark ì‹¤í–‰ íë¦„:</span>
<span class="sd">1. Driverì—ì„œ SparkContext ìƒì„±</span>
<span class="sd">2. ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ í•´ì„</span>
<span class="sd">3. Transformation â†’ DAG (Directed Acyclic Graph) ìƒì„±</span>
<span class="sd">4. Action í˜¸ì¶œ ì‹œ Job ìƒì„±</span>
<span class="sd">5. Job â†’ Stages â†’ Tasksë¡œ ë¶„í•´</span>
<span class="sd">6. Cluster Managerê°€ Executorì— Task í• ë‹¹</span>
<span class="sd">7. Executorì—ì„œ Task ì‹¤í–‰</span>
<span class="sd">8. ê²°ê³¼ë¥¼ Driverë¡œ ë°˜í™˜</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># ì˜ˆì‹œ ì½”ë“œ íë¦„</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Example&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Transformations (Lazy - ì‹¤í–‰ ì•ˆ ë¨)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># ì½ê¸° ê³„íš</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span>                  <span class="c1"># í•„í„° ê³„íš</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>             <span class="c1"># ì§‘ê³„ ê³„íš</span>

<span class="c1"># Action (ì‹¤ì œ ì‹¤í–‰ íŠ¸ë¦¬ê±°)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>  <span class="c1"># Job ìƒì„± â†’ Stages â†’ Tasks â†’ ì‹¤í–‰</span>
</code></pre></div>

<hr />
<h2 id="3-rdd-resilient-distributed-dataset">3. RDD (Resilient Distributed Dataset)<a class="header-link" href="#3-rdd-resilient-distributed-dataset" title="Permanent link">&para;</a></h2>
<h3 id="31-rdd">3.1 RDD ê°œë…<a class="header-link" href="#31-rdd" title="Permanent link">&para;</a></h3>
<p>RDDëŠ” Sparkì˜ ê¸°ë³¸ ë°ì´í„° êµ¬ì¡°ë¡œ, ë¶„ì‚°ëœ ë¶ˆë³€ ë°ì´í„° ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkContext</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="s2">&quot;local[*]&quot;</span><span class="p">,</span> <span class="s2">&quot;RDD Example&quot;</span><span class="p">)</span>

<span class="c1"># RDD ìƒì„± ë°©ë²•</span>
<span class="c1"># 1. ì»¬ë ‰ì…˜ì—ì„œ ìƒì„±</span>
<span class="n">rdd1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="c1"># 2. ì™¸ë¶€ ë°ì´í„°ì—ì„œ ìƒì„±</span>
<span class="n">rdd2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;data.txt&quot;</span><span class="p">)</span>

<span class="c1"># 3. ê¸°ì¡´ RDD ë³€í™˜</span>
<span class="n">rdd3</span> <span class="o">=</span> <span class="n">rdd1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># RDD íŠ¹ì„±</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">R - Resilient: ì¥ì•  ë³µêµ¬ ê°€ëŠ¥ (Lineageë¡œ ì¬ê³„ì‚°)</span>
<span class="sd">D - Distributed: í´ëŸ¬ìŠ¤í„°ì— ë¶„ì‚° ì €ì¥</span>
<span class="sd">D - Dataset: ë°ì´í„° ì»¬ë ‰ì…˜</span>
<span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>

<h3 id="32-rdd">3.2 RDD ì—°ì‚°<a class="header-link" href="#32-rdd" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Transformations (Lazy)</span>
<span class="c1"># - ìƒˆë¡œìš´ RDD ë°˜í™˜</span>
<span class="c1"># - ì‹¤í–‰ ê³„íšë§Œ ìƒì„±</span>

<span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="c1"># map: ê° ìš”ì†Œì— í•¨ìˆ˜ ì ìš©</span>
<span class="n">mapped</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># [2, 4, 6, ...]</span>

<span class="c1"># filter: ì¡°ê±´ì— ë§ëŠ” ìš”ì†Œë§Œ ì„ íƒ</span>
<span class="n">filtered</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># [2, 4, 6, 8, 10]</span>

<span class="c1"># flatMap: map í›„ flatten</span>
<span class="n">flat</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># [1, 2, 2, 4, 3, 6, ...]</span>

<span class="c1"># distinct: ì¤‘ë³µ ì œê±°</span>
<span class="n">distinct</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>

<span class="c1"># union: ë‘ RDD í•©ì¹˜ê¸°</span>
<span class="n">union</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]))</span>

<span class="c1"># groupByKey: í‚¤ë³„ ê·¸ë£¹í™”</span>
<span class="n">pairs</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">pairs</span><span class="o">.</span><span class="n">groupByKey</span><span class="p">()</span>  <span class="c1"># [(&quot;a&quot;, [1, 3]), (&quot;b&quot;, [2])]</span>

<span class="c1"># reduceByKey: í‚¤ë³„ ë¦¬ë“€ìŠ¤</span>
<span class="n">reduced</span> <span class="o">=</span> <span class="n">pairs</span><span class="o">.</span><span class="n">reduceByKey</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># [(&quot;a&quot;, 4), (&quot;b&quot;, 2)]</span>


<span class="c1"># Actions (Eager)</span>
<span class="c1"># - ê²°ê³¼ ë°˜í™˜ ë˜ëŠ” ì €ì¥</span>
<span class="c1"># - ì‹¤ì œ ì‹¤í–‰ íŠ¸ë¦¬ê±°</span>

<span class="c1"># collect: ëª¨ë“  ìš”ì†Œë¥¼ Driverë¡œ ë°˜í™˜</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>  <span class="c1"># [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>

<span class="c1"># count: ìš”ì†Œ ê°œìˆ˜</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># 10</span>

<span class="c1"># first / take: ì²« ë²ˆì§¸ / nê°œ ìš”ì†Œ</span>
<span class="n">first</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>  <span class="c1"># 1</span>
<span class="n">take3</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># [1, 2, 3]</span>

<span class="c1"># reduce: ì „ì²´ ë¦¬ë“€ìŠ¤</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># 55</span>

<span class="c1"># foreach: ê° ìš”ì†Œì— í•¨ìˆ˜ ì ìš© (ë¶€ìˆ˜ íš¨ê³¼)</span>
<span class="n">rdd</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># saveAsTextFile: íŒŒì¼ë¡œ ì €ì¥</span>
<span class="n">rdd</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="p">(</span><span class="s2">&quot;output/&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="33-pair-rdd">3.3 Pair RDD ì—°ì‚°<a class="header-link" href="#33-pair-rdd" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Key-Value ìŒ RDD ì—°ì‚°</span>
<span class="n">sales</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;Electronics&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Clothing&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Electronics&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Clothing&quot;</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Food&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
<span class="p">])</span>

<span class="c1"># í‚¤ë³„ í•©ê³„</span>
<span class="n">total_by_category</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">reduceByKey</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="c1"># [(&quot;Electronics&quot;, 300), (&quot;Clothing&quot;, 125), (&quot;Food&quot;, 30)]</span>

<span class="c1"># í‚¤ë³„ í‰ê· </span>
<span class="n">count_sum</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">combineByKey</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>                      <span class="c1"># createCombiner</span>
    <span class="k">lambda</span> <span class="n">acc</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">acc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">,</span> <span class="n">acc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># mergeValue</span>
    <span class="k">lambda</span> <span class="n">acc1</span><span class="p">,</span> <span class="n">acc2</span><span class="p">:</span> <span class="p">(</span><span class="n">acc1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">acc2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">acc1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">acc2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># mergeCombiner</span>
<span class="p">)</span>
<span class="n">avg_by_category</span> <span class="o">=</span> <span class="n">count_sum</span><span class="o">.</span><span class="n">mapValues</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># ì •ë ¬</span>
<span class="n">sorted_rdd</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">sortByKey</span><span class="p">()</span>

<span class="c1"># Join</span>
<span class="n">inventory</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;Electronics&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Clothing&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">joined</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inventory</span><span class="p">)</span>
<span class="c1"># [(&quot;Electronics&quot;, (100, 50)), (&quot;Electronics&quot;, (200, 50)), ...]</span>
</code></pre></div>

<hr />
<h2 id="4">4. ì„¤ì¹˜ ë° ì‹¤í–‰<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-pyspark">4.1 ë¡œì»¬ ì„¤ì¹˜ (PySpark)<a class="header-link" href="#41-pyspark" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># pip ì„¤ì¹˜</span>
pip<span class="w"> </span>install<span class="w"> </span>pyspark

<span class="c1"># ë²„ì „ í™•ì¸</span>
pyspark<span class="w"> </span>--version

<span class="c1"># PySpark ì…¸ ì‹œì‘</span>
pyspark

<span class="c1"># spark-submitìœ¼ë¡œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</span>
spark-submit<span class="w"> </span>my_script.py
</code></pre></div>

<h3 id="42-docker">4.2 Docker ì„¤ì¹˜<a class="header-link" href="#42-docker" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yaml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">spark-master</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bitnami/spark:3.4</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SPARK_MODE=master</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8080:8080&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;7077:7077&quot;</span>

<span class="w">  </span><span class="nt">spark-worker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bitnami/spark:3.4</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SPARK_MODE=worker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SPARK_MASTER_URL=spark://spark-master:7077</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spark-master</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># ì‹¤í–‰</span>
docker-compose<span class="w"> </span>up<span class="w"> </span>-d

<span class="c1"># í´ëŸ¬ìŠ¤í„°ì— ì‘ì—… ì œì¶œ</span>
spark-submit<span class="w"> </span>--master<span class="w"> </span>spark://localhost:7077<span class="w"> </span>my_script.py
</code></pre></div>

<h3 id="43">4.3 í´ëŸ¬ìŠ¤í„° ëª¨ë“œ<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Standalone í´ëŸ¬ìŠ¤í„°</span>
spark-submit<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--master<span class="w"> </span>spark://master:7077<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--deploy-mode<span class="w"> </span>cluster<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--executor-memory<span class="w"> </span>4G<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--executor-cores<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--num-executors<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>my_script.py

<span class="c1"># YARN í´ëŸ¬ìŠ¤í„°</span>
spark-submit<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--master<span class="w"> </span>yarn<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--deploy-mode<span class="w"> </span>cluster<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--executor-memory<span class="w"> </span>4G<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>my_script.py

<span class="c1"># Kubernetes í´ëŸ¬ìŠ¤í„°</span>
spark-submit<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--master<span class="w"> </span>k8s://https://k8s-master:6443<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--deploy-mode<span class="w"> </span>cluster<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conf<span class="w"> </span>spark.kubernetes.container.image<span class="o">=</span>my-spark-image<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>my_script.py
</code></pre></div>

<hr />
<h2 id="5-sparksession">5. SparkSession<a class="header-link" href="#5-sparksession" title="Permanent link">&para;</a></h2>
<h3 id="51-sparksession">5.1 SparkSession ìƒì„±<a class="header-link" href="#51-sparksession" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

<span class="c1"># ê¸°ë³¸ SparkSession</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;My Application&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># ì„¤ì • í¬í•¨</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;My Application&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">master</span><span class="p">(</span><span class="s2">&quot;local[*]&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.shuffle.partitions&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.executor.memory&quot;</span><span class="p">,</span> <span class="s2">&quot;4g&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.driver.memory&quot;</span><span class="p">,</span> <span class="s2">&quot;2g&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.adaptive.enabled&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">enableHiveSupport</span><span class="p">()</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># SparkContext ì ‘ê·¼</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span>

<span class="c1"># ì„¤ì • í™•ì¸</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spark.sql.shuffle.partitions&quot;</span><span class="p">))</span>

<span class="c1"># ì„¸ì…˜ ì¢…ë£Œ</span>
<span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div>

<h3 id="52">5.2 ì£¼ìš” ì„¤ì •<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìì£¼ ì‚¬ìš©í•˜ëŠ” ì„¤ì •</span>
<span class="n">common_configs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ë©”ëª¨ë¦¬ ì„¤ì •</span>
    <span class="s2">&quot;spark.executor.memory&quot;</span><span class="p">:</span> <span class="s2">&quot;4g&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spark.driver.memory&quot;</span><span class="p">:</span> <span class="s2">&quot;2g&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spark.executor.memoryOverhead&quot;</span><span class="p">:</span> <span class="s2">&quot;512m&quot;</span><span class="p">,</span>

    <span class="c1"># ë³‘ë ¬ì„± ì„¤ì •</span>
    <span class="s2">&quot;spark.executor.cores&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spark.default.parallelism&quot;</span><span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spark.sql.shuffle.partitions&quot;</span><span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>

    <span class="c1"># ì§ë ¬í™” ì„¤ì •</span>
    <span class="s2">&quot;spark.serializer&quot;</span><span class="p">:</span> <span class="s2">&quot;org.apache.spark.serializer.KryoSerializer&quot;</span><span class="p">,</span>

    <span class="c1"># Adaptive Query Execution (Spark 3.0+)</span>
    <span class="s2">&quot;spark.sql.adaptive.enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spark.sql.adaptive.coalescePartitions.enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spark.sql.adaptive.skewJoin.enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>

    <span class="c1"># ìºì‹œ ì„¤ì •</span>
    <span class="s2">&quot;spark.storage.memoryFraction&quot;</span><span class="p">:</span> <span class="s2">&quot;0.6&quot;</span><span class="p">,</span>

    <span class="c1"># ì…”í”Œ ì„¤ì •</span>
    <span class="s2">&quot;spark.shuffle.compress&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># ì„¤ì • ì ìš© ì˜ˆì‹œ</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.shuffle.partitions&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.adaptive.enabled&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6">6. ê¸°ë³¸ ì˜ˆì œ<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-word-count">6.1 Word Count<a class="header-link" href="#61-word-count" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

<span class="c1"># SparkSession ìƒì„±</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Word Count&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span>

<span class="c1"># í…ìŠ¤íŠ¸ íŒŒì¼ ì½ê¸°</span>
<span class="n">text_rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">)</span>

<span class="c1"># Word Count ë¡œì§</span>
<span class="n">word_counts</span> <span class="o">=</span> <span class="n">text_rdd</span> \
    <span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> \
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">word</span><span class="p">:</span> <span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="mi">1</span><span class="p">))</span> \
    <span class="o">.</span><span class="n">reduceByKey</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">sortBy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># ê²°ê³¼ ì¶œë ¥</span>
<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">word_counts</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># íŒŒì¼ë¡œ ì €ì¥</span>
<span class="n">word_counts</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="p">(</span><span class="s2">&quot;output/word_counts&quot;</span><span class="p">)</span>

<span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div>

<h3 id="62-dataframe">6.2 DataFrame ê¸°ë³¸<a class="header-link" href="#62-dataframe" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">col</span><span class="p">,</span> <span class="nb">sum</span> <span class="k">as</span> <span class="n">_sum</span><span class="p">,</span> <span class="n">avg</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;DataFrame Example&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># DataFrame ìƒì„±</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Engineering&quot;</span><span class="p">,</span> <span class="mi">50000</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Engineering&quot;</span><span class="p">,</span> <span class="mi">60000</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="mi">45000</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Diana&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="mi">55000</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;department&quot;</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">])</span>

<span class="c1"># ê¸°ë³¸ ì—°ì‚°</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>

<span class="c1"># í•„í„°ë§</span>
<span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;salary&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ì§‘ê³„</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;department&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
        <span class="n">_sum</span><span class="p">(</span><span class="s2">&quot;salary&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_salary&quot;</span><span class="p">),</span>
        <span class="n">avg</span><span class="p">(</span><span class="s2">&quot;salary&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;avg_salary&quot;</span><span class="p">)</span>
    <span class="p">)</span> \
    <span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># SQL ì‚¬ìš©</span>
<span class="n">df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;employees&quot;</span><span class="p">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT department, AVG(salary) as avg_salary</span>
<span class="s2">    FROM employees</span>
<span class="s2">    GROUP BY department</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="_2">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1-rdd">ë¬¸ì œ 1: RDD ê¸°ë³¸ ì—°ì‚°<a class="header-link" href="#1-rdd" title="Permanent link">&para;</a></h3>
<p>1ë¶€í„° 100ê¹Œì§€ì˜ ìˆ«ì ì¤‘ ì§ìˆ˜ë§Œ ì„ íƒí•˜ì—¬ ì œê³±ì˜ í•©ì„ êµ¬í•˜ì„¸ìš”.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># í’€ì´</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span> \
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># 171700</span>
</code></pre></div>

<h3 id="2-pair-rdd">ë¬¸ì œ 2: Pair RDD<a class="header-link" href="#2-pair-rdd" title="Permanent link">&para;</a></h3>
<p>ë¡œê·¸ íŒŒì¼ì—ì„œ ì—ëŸ¬ ìˆ˜ì¤€ë³„ ë¡œê·¸ ìˆ˜ë¥¼ ì§‘ê³„í•˜ì„¸ìš”.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ì…ë ¥: &quot;2024-01-01 ERROR: Connection failed&quot;</span>
<span class="n">logs</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;logs.txt&quot;</span><span class="p">)</span>
<span class="n">error_counts</span> <span class="o">=</span> <span class="n">logs</span> \
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> \
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">level</span><span class="p">:</span> <span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> \
    <span class="o">.</span><span class="n">reduceByKey</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="_3">ìš”ì•½<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ê°œë…</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Spark</strong></td>
<td>ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ í†µí•© ì—”ì§„</td>
</tr>
<tr>
<td><strong>RDD</strong></td>
<td>ê¸°ë³¸ ë¶„ì‚° ë°ì´í„° êµ¬ì¡°</td>
</tr>
<tr>
<td><strong>Transformation</strong></td>
<td>ìƒˆ RDD ìƒì„± (Lazy)</td>
</tr>
<tr>
<td><strong>Action</strong></td>
<td>ê²°ê³¼ ë°˜í™˜ (Eager)</td>
</tr>
<tr>
<td><strong>Driver</strong></td>
<td>ë©”ì¸ í”„ë¡œê·¸ë¨ ì‹¤í–‰ ë…¸ë“œ</td>
</tr>
<tr>
<td><strong>Executor</strong></td>
<td>Task ì‹¤í–‰ ì›Œì»¤</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_4">ì°¸ê³  ìë£Œ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://spark.apache.org/docs/latest/">Apache Spark Documentation</a></li>
<li><a href="https://spark.apache.org/docs/latest/api/python/">PySpark API Reference</a></li>
<li><a href="https://www.oreilly.com/library/view/learning-spark-2nd/9781492050032/">Learning Spark (O'Reilly)</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Engineering/06_Prefect_Modern_Orchestration.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Prefect ëª¨ë˜ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Engineering/08_PySpark_DataFrames.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">PySpark DataFrame</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}