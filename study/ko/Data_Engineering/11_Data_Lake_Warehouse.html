{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Lakeì™€ Data Warehouse - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Data_Engineering/">Data Engineering</a>
    <span class="separator">/</span>
    <span class="current">Data Lakeì™€ Data Warehouse</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Data Lakeì™€ Data Warehouse</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Engineering/10_Kafka_Streaming.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Kafka ìŠ¤íŠ¸ë¦¬ë°</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Engineering/12_dbt_Transformation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">dbt ë³€í™˜ ë„êµ¬</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">ê°œìš”</a></li>
<li><a href="#1-data-warehouse">1. Data Warehouse</a><ul>
<li><a href="#11">1.1 ê°œë…</a></li>
<li><a href="#12">1.2 ì£¼ìš” ì†”ë£¨ì…˜</a></li>
<li><a href="#13-data-warehouse-sql">1.3 Data Warehouse SQL ì˜ˆì‹œ</a></li>
</ul>
</li>
<li><a href="#2-data-lake">2. Data Lake</a><ul>
<li><a href="#21">2.1 ê°œë…</a></li>
<li><a href="#22">2.2 ì£¼ìš” ìŠ¤í† ë¦¬ì§€</a></li>
<li><a href="#23-data-lake">2.3 Data Lake íŒŒì¼ êµ¬ì¡°</a></li>
</ul>
</li>
<li><a href="#3-data-warehouse-vs-data-lake">3. Data Warehouse vs Data Lake</a><ul>
<li><a href="#31">3.1 ë¹„êµ</a></li>
<li><a href="#32">3.2 ì„ íƒ ê¸°ì¤€</a></li>
</ul>
</li>
<li><a href="#4-lakehouse">4. Lakehouse</a><ul>
<li><a href="#41">4.1 ê°œë…</a></li>
<li><a href="#42">4.2 í•µì‹¬ ê¸°ëŠ¥</a></li>
</ul>
</li>
<li><a href="#5-delta-lake">5. Delta Lake</a><ul>
<li><a href="#51-delta-lake">5.1 Delta Lake ê¸°ë³¸</a></li>
<li><a href="#52-delta-lake">5.2 Delta Lake ê³ ê¸‰ ê¸°ëŠ¥</a></li>
</ul>
</li>
<li><a href="#6-apache-iceberg">6. Apache Iceberg</a><ul>
<li><a href="#61-iceberg">6.1 Iceberg ê¸°ë³¸</a></li>
<li><a href="#62-delta-lake-vs-iceberg">6.2 Delta Lake vs Iceberg ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#7">7. ëª¨ë˜ ë°ì´í„° ìŠ¤íƒ</a><ul>
<li><a href="#71">7.1 ì•„í‚¤í…ì²˜ íŒ¨í„´</a></li>
</ul>
</li>
<li><a href="#_2">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1">ë¬¸ì œ 1: ì•„í‚¤í…ì²˜ ì„ íƒ</a></li>
<li><a href="#2-delta-lake">ë¬¸ì œ 2: Delta Lake êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#_3">ìš”ì•½</a></li>
<li><a href="#_4">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="data-lake-data-warehouse">Data Lakeì™€ Data Warehouse<a class="header-link" href="#data-lake-data-warehouse" title="Permanent link">&para;</a></h1>
<h2 id="_1">ê°œìš”<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>ë°ì´í„° ì €ì¥ì†Œ ì•„í‚¤í…ì²˜ëŠ” ì¡°ì§ì˜ ë°ì´í„° ì „ëµì— í•µì‹¬ì ì…ë‹ˆë‹¤. Data Lake, Data Warehouse, ê·¸ë¦¬ê³  ë‘˜ì„ ê²°í•©í•œ Lakehouse ì•„í‚¤í…ì²˜ì˜ íŠ¹ì„±ê³¼ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ì´í•´í•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="1-data-warehouse">1. Data Warehouse<a class="header-link" href="#1-data-warehouse" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ê°œë…<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Data Warehouse                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   íŠ¹ì§•:                                                        â”‚
â”‚   - êµ¬ì¡°í™”ëœ ë°ì´í„° (ìŠ¤í‚¤ë§ˆ ì •ì˜ í•„ìˆ˜)                           â”‚
â”‚   - Schema-on-Write (ì“°ê¸° ì‹œ ìŠ¤í‚¤ë§ˆ ì ìš©)                       â”‚
â”‚   - ë¶„ì„ ìµœì í™” (OLAP)                                         â”‚
â”‚   - SQL ê¸°ë°˜ ì¿¼ë¦¬                                              â”‚
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    Data Warehouse                     â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
â”‚   â”‚   â”‚  Dim Tables    â”‚    Fact Tables                 â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”‚dim_date  â”‚  â”‚  â”‚fact_salesâ”‚                 â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”‚dim_productâ”‚  â”‚  â”‚fact_ordersâ”‚                â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â”‚dim_customerâ”‚ â”‚                               â”‚â”‚    â”‚
â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12">1.2 ì£¼ìš” ì†”ë£¨ì…˜<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì†”ë£¨ì…˜</th>
<th>ìœ í˜•</th>
<th>íŠ¹ì§•</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Snowflake</strong></td>
<td>í´ë¼ìš°ë“œ</td>
<td>ë¶„ë¦¬ëœ ìŠ¤í† ë¦¬ì§€/ì»´í“¨íŒ…, ìë™ í™•ì¥</td>
</tr>
<tr>
<td><strong>BigQuery</strong></td>
<td>í´ë¼ìš°ë“œ (GCP)</td>
<td>ì„œë²„ë¦¬ìŠ¤, í˜íƒ€ë°”ì´íŠ¸ ê·œëª¨</td>
</tr>
<tr>
<td><strong>Redshift</strong></td>
<td>í´ë¼ìš°ë“œ (AWS)</td>
<td>Columnar, MPP ì•„í‚¤í…ì²˜</td>
</tr>
<tr>
<td><strong>Synapse</strong></td>
<td>í´ë¼ìš°ë“œ (Azure)</td>
<td>í†µí•© ë¶„ì„ í”Œë«í¼</td>
</tr>
<tr>
<td><strong>PostgreSQL</strong></td>
<td>ì˜¨í”„ë ˆë¯¸ìŠ¤</td>
<td>ì†Œê·œëª¨, ì˜¤í”ˆì†ŒìŠ¤</td>
</tr>
</tbody>
</table>
<h3 id="13-data-warehouse-sql">1.3 Data Warehouse SQL ì˜ˆì‹œ<a class="header-link" href="#13-data-warehouse-sql" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Snowflake/BigQuery ìŠ¤íƒ€ì¼ ë¶„ì„ ì¿¼ë¦¬</span>

<span class="c1">-- ì›”ë³„ ë§¤ì¶œ íŠ¸ë Œë“œ</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">,</span>
<span class="w">    </span><span class="n">d</span><span class="p">.</span><span class="n">month_name</span><span class="p">,</span>
<span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_sales</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">customer_sk</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">unique_customers</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_order_value</span><span class="p">,</span>
<span class="w">    </span><span class="c1">-- ì „ì›” ëŒ€ë¹„ ì„±ì¥ë¥ </span>
<span class="w">    </span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LAG</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">))</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">))</span>
<span class="w">        </span><span class="o">/</span><span class="w"> </span><span class="k">NULLIF</span><span class="p">(</span><span class="n">LAG</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">))</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span>
<span class="w">        </span><span class="k">AS</span><span class="w"> </span><span class="n">mom_growth_pct</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">fact_sales</span><span class="w"> </span><span class="n">f</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">dim_date</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">date_sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">date_sk</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2023</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">month_name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="k">month</span><span class="p">;</span>


<span class="c1">-- ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ LTV (Life Time Value)</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">customer_metrics</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span>
<span class="w">        </span><span class="k">c</span><span class="p">.</span><span class="n">customer_sk</span><span class="p">,</span>
<span class="w">        </span><span class="k">c</span><span class="p">.</span><span class="n">customer_segment</span><span class="p">,</span>
<span class="w">        </span><span class="k">MIN</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">full_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">first_purchase_date</span><span class="p">,</span>
<span class="w">        </span><span class="k">MAX</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">full_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">last_purchase_date</span><span class="p">,</span>
<span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_orders</span><span class="p">,</span>
<span class="w">        </span><span class="k">SUM</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">sales_amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_revenue</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">fact_sales</span><span class="w"> </span><span class="n">f</span>
<span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">dim_customer</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">customer_sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_sk</span>
<span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">dim_date</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">date_sk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">date_sk</span>
<span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_sk</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_segment</span>
<span class="p">)</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">customer_segment</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">customer_count</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">total_orders</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_orders</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">total_revenue</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_ltv</span><span class="p">,</span>
<span class="w">    </span><span class="n">PERCENTILE_CONT</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">WITHIN</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="p">(</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">total_revenue</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">median_ltv</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">customer_metrics</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">customer_segment</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">avg_ltv</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>

<hr />
<h2 id="2-data-lake">2. Data Lake<a class="header-link" href="#2-data-lake" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ê°œë…<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Data Lake                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   íŠ¹ì§•:                                                        â”‚
â”‚   - ëª¨ë“  í˜•íƒœì˜ ë°ì´í„° (êµ¬ì¡°í™”, ë°˜êµ¬ì¡°í™”, ë¹„êµ¬ì¡°í™”)               â”‚
â”‚   - Schema-on-Read (ì½ê¸° ì‹œ ìŠ¤í‚¤ë§ˆ ì ìš©)                        â”‚
â”‚   - ì›ë³¸ ë°ì´í„° ë³´ì¡´                                           â”‚
â”‚   - ì €ë¹„ìš© ìŠ¤í† ë¦¬ì§€                                            â”‚
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                     Data Lake                         â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  Raw Zone (Bronze)                              â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - ì›ë³¸ ë°ì´í„° (JSON, CSV, Logs, Images)        â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                         â†“                             â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  Processed Zone (Silver)                        â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - ì •ì œëœ ë°ì´í„° (Parquet, Delta)               â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                         â†“                             â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚  Curated Zone (Gold)                            â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  - ë¶„ì„/ML ì¤€ë¹„ ë°ì´í„°                          â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="22">2.2 ì£¼ìš” ìŠ¤í† ë¦¬ì§€<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ìŠ¤í† ë¦¬ì§€</th>
<th>í´ë¼ìš°ë“œ</th>
<th>íŠ¹ì§•</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>S3</strong></td>
<td>AWS</td>
<td>ê°ì²´ ìŠ¤í† ë¦¬ì§€, ë†’ì€ ë‚´êµ¬ì„±</td>
</tr>
<tr>
<td><strong>GCS</strong></td>
<td>GCP</td>
<td>Google Cloud Storage</td>
</tr>
<tr>
<td><strong>ADLS</strong></td>
<td>Azure</td>
<td>Azure Data Lake Storage</td>
</tr>
<tr>
<td><strong>HDFS</strong></td>
<td>ì˜¨í”„ë ˆë¯¸ìŠ¤</td>
<td>Hadoop Distributed File System</td>
</tr>
</tbody>
</table>
<h3 id="23-data-lake">2.3 Data Lake íŒŒì¼ êµ¬ì¡°<a class="header-link" href="#23-data-lake" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>s3://my-data-lake/
â”œâ”€â”€ raw/                          # Bronze ë ˆì´ì–´
â”‚   â”œâ”€â”€ orders/
â”‚   â”‚   â”œâ”€â”€ year=2024/
â”‚   â”‚   â”‚   â”œâ”€â”€ month=01/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ day=15/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ orders_20240115_001.json
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ orders_20240115_002.json
â”‚   â”œâ”€â”€ customers/
â”‚   â”‚   â””â”€â”€ snapshot_20240115.csv
â”‚   â””â”€â”€ logs/
â”‚       â””â”€â”€ app_logs_20240115.log
â”‚
â”œâ”€â”€ processed/                    # Silver ë ˆì´ì–´
â”‚   â”œâ”€â”€ orders/
â”‚   â”‚   â””â”€â”€ year=2024/
â”‚   â”‚       â””â”€â”€ month=01/
â”‚   â”‚           â””â”€â”€ part-00000.parquet
â”‚   â””â”€â”€ customers/
â”‚       â””â”€â”€ part-00000.parquet
â”‚
â””â”€â”€ curated/                      # Gold ë ˆì´ì–´
    â”œâ”€â”€ fact_sales/
    â”‚   â””â”€â”€ year=2024/
    â”‚       â””â”€â”€ month=01/
    â””â”€â”€ dim_customers/
        â””â”€â”€ current/
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># PySparkë¡œ Data Lake ê³„ì¸µ ì²˜ë¦¬</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.functions</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;DataLakeProcessing&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Raw â†’ Processed (Bronze â†’ Silver)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_raw_orders</span><span class="p">():</span>
    <span class="c1"># Raw JSON ì½ê¸°</span>
    <span class="n">raw_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/raw/orders/&quot;</span><span class="p">)</span>

    <span class="c1"># ì •ì œ</span>
    <span class="n">processed_df</span> <span class="o">=</span> <span class="n">raw_df</span> \
        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;order_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">())</span> \
        <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;processed_at&quot;</span><span class="p">,</span> <span class="n">current_timestamp</span><span class="p">())</span> \
        <span class="o">.</span><span class="n">dropDuplicates</span><span class="p">([</span><span class="s2">&quot;order_id&quot;</span><span class="p">])</span>

    <span class="c1"># Parquetìœ¼ë¡œ ì €ì¥</span>
    <span class="n">processed_df</span><span class="o">.</span><span class="n">write</span> \
        <span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/processed/orders/&quot;</span><span class="p">)</span>


<span class="c1"># Processed â†’ Curated (Silver â†’ Gold)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_fact_sales</span><span class="p">():</span>
    <span class="n">orders</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/processed/orders/&quot;</span><span class="p">)</span>
    <span class="n">customers</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/processed/customers/&quot;</span><span class="p">)</span>

    <span class="n">fact_sales</span> <span class="o">=</span> <span class="n">orders</span> \
        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">customers</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;order_id&quot;</span><span class="p">),</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;customer_sk&quot;</span><span class="p">),</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;order_date&quot;</span><span class="p">),</span>
            <span class="n">col</span><span class="p">(</span><span class="s2">&quot;amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">fact_sales</span><span class="o">.</span><span class="n">write</span> \
        <span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;s3://my-data-lake/curated/fact_sales/&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3-data-warehouse-vs-data-lake">3. Data Warehouse vs Data Lake<a class="header-link" href="#3-data-warehouse-vs-data-lake" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ë¹„êµ<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>íŠ¹ì„±</th>
<th>Data Warehouse</th>
<th>Data Lake</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ë°ì´í„° ìœ í˜•</strong></td>
<td>êµ¬ì¡°í™”</td>
<td>ëª¨ë“  ìœ í˜•</td>
</tr>
<tr>
<td><strong>ìŠ¤í‚¤ë§ˆ</strong></td>
<td>Schema-on-Write</td>
<td>Schema-on-Read</td>
</tr>
<tr>
<td><strong>ì‚¬ìš©ì</strong></td>
<td>ë¹„ì¦ˆë‹ˆìŠ¤ ë¶„ì„ê°€</td>
<td>ë°ì´í„° ê³¼í•™ì, ì—”ì§€ë‹ˆì–´</td>
</tr>
<tr>
<td><strong>ì²˜ë¦¬</strong></td>
<td>OLAP</td>
<td>ë°°ì¹˜, ìŠ¤íŠ¸ë¦¬ë°, ML</td>
</tr>
<tr>
<td><strong>ë¹„ìš©</strong></td>
<td>ë†’ìŒ</td>
<td>ë‚®ìŒ</td>
</tr>
<tr>
<td><strong>ì¿¼ë¦¬ ì„±ëŠ¥</strong></td>
<td>ìµœì í™”ë¨</td>
<td>ê°€ë³€ì </td>
</tr>
<tr>
<td><strong>ë°ì´í„° í’ˆì§ˆ</strong></td>
<td>ë†’ìŒ (ì •ì œë¨)</td>
<td>ê°€ë³€ì </td>
</tr>
</tbody>
</table>
<h3 id="32">3.2 ì„ íƒ ê¸°ì¤€<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">choose_architecture</span><span class="p">(</span><span class="n">requirements</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì•„í‚¤í…ì²˜ ì„ íƒ ê°€ì´ë“œ&quot;&quot;&quot;</span>

    <span class="n">warehouse_factors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;structured_data_only&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sql_analytics_primary&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_governance&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fast_query_response&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">lake_factors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unstructured_data&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ml_workloads&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;raw_data_preservation&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cost_sensitive&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;schema_flexibility&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">warehouse_factors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lake_factors</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Data Warehouse ê¶Œì¥&quot;</span>
    <span class="k">elif</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lake_factors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">warehouse_factors</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Data Lake ê¶Œì¥&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Lakehouse ê³ ë ¤&quot;</span>
</code></pre></div>

<hr />
<h2 id="4-lakehouse">4. Lakehouse<a class="header-link" href="#4-lakehouse" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ê°œë…<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>LakehouseëŠ” Data Lakeì˜ ìœ ì—°ì„±ê³¼ Data Warehouseì˜ ì„±ëŠ¥/ê´€ë¦¬ ê¸°ëŠ¥ì„ ê²°í•©í•œ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Lakehouse Architecture                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                   Applications                          â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  â”‚    BI    â”‚ â”‚    ML    â”‚ â”‚  SQL     â”‚ â”‚ Streamingâ”‚  â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                  Query Engine                           â”‚  â”‚
â”‚   â”‚        (Spark, Presto, Trino, Dremio)                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Lakehouse Format Layer                     â”‚  â”‚
â”‚   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚     â”‚  ACID Transactions â”‚ Schema Enforcement      â”‚   â”‚  â”‚
â”‚   â”‚     â”‚  Time Travel       â”‚ Unified Batch/Streaming â”‚   â”‚  â”‚
â”‚   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â”‚           Delta Lake / Apache Iceberg / Apache Hudi    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Object Storage (Data Lake)                 â”‚  â”‚
â”‚   â”‚                  S3 / GCS / ADLS / HDFS                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="42">4.2 í•µì‹¬ ê¸°ëŠ¥<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê¸°ëŠ¥</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ACID íŠ¸ëœì­ì…˜</strong></td>
<td>ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥</td>
</tr>
<tr>
<td><strong>ìŠ¤í‚¤ë§ˆ ì§„í™”</strong></td>
<td>ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì§€ì›</td>
</tr>
<tr>
<td><strong>íƒ€ì„ íŠ¸ë˜ë¸”</strong></td>
<td>ê³¼ê±° ë°ì´í„° ë²„ì „ ì¡°íšŒ</td>
</tr>
<tr>
<td><strong>Upsert/Merge</strong></td>
<td>íš¨ìœ¨ì ì¸ ë°ì´í„° ê°±ì‹ </td>
</tr>
<tr>
<td><strong>í†µí•© ì²˜ë¦¬</strong></td>
<td>ë°°ì¹˜ + ìŠ¤íŠ¸ë¦¬ë° ë‹¨ì¼ í…Œì´ë¸”</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5-delta-lake">5. Delta Lake<a class="header-link" href="#5-delta-lake" title="Permanent link">&para;</a></h2>
<h3 id="51-delta-lake">5.1 Delta Lake ê¸°ë³¸<a class="header-link" href="#51-delta-lake" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">delta</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Delta Lake ì„¤ì •</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;DeltaLake&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.extensions&quot;</span><span class="p">,</span> <span class="s2">&quot;io.delta.sql.DeltaSparkSessionExtension&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.spark_catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.spark.sql.delta.catalog.DeltaCatalog&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Delta í…Œì´ë¸” ìƒì„±</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
<span class="p">],</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="c1"># ì½ê¸°</span>
<span class="n">delta_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="c1"># SQLë¡œ ì ‘ê·¼</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE users USING DELTA LOCATION &#39;/data/delta/users&#39;&quot;</span><span class="p">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-delta-lake">5.2 Delta Lake ê³ ê¸‰ ê¸°ëŠ¥<a class="header-link" href="#52-delta-lake" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">delta.tables</span><span class="w"> </span><span class="kn">import</span> <span class="n">DeltaTable</span>

<span class="c1"># MERGE (Upsert)</span>
<span class="n">delta_table</span> <span class="o">=</span> <span class="n">DeltaTable</span><span class="o">.</span><span class="n">forPath</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="n">new_data</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Alice Updated&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span>  <span class="c1"># ì—…ë°ì´íŠ¸</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>        <span class="c1"># ì‚½ì…</span>
<span class="p">],</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">])</span>

<span class="n">delta_table</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">new_data</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
    <span class="s2">&quot;target.id = source.id&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">whenMatchedUpdate</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;source.name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;source.amount&quot;</span>
<span class="p">})</span><span class="o">.</span><span class="n">whenNotMatchedInsert</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;source.id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;source.name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;source.amount&quot;</span>
<span class="p">})</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>


<span class="c1"># Time Travel (ê³¼ê±° ë²„ì „ ì¡°íšŒ)</span>
<span class="c1"># ë²„ì „ ë²ˆí˜¸ë¡œ</span>
<span class="n">df_v0</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;versionAsOf&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>

<span class="c1"># íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ</span>
<span class="n">df_yesterday</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;timestampAsOf&quot;</span><span class="p">,</span> <span class="s2">&quot;2024-01-14&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>


<span class="c1"># íˆìŠ¤í† ë¦¬ í™•ì¸</span>
<span class="n">delta_table</span><span class="o">.</span><span class="n">history</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Vacuum (ì˜¤ë˜ëœ íŒŒì¼ ì •ë¦¬)</span>
<span class="n">delta_table</span><span class="o">.</span><span class="n">vacuum</span><span class="p">(</span><span class="n">retentionHours</span><span class="o">=</span><span class="mi">168</span><span class="p">)</span>  <span class="c1"># 7ì¼ ë³´ì¡´</span>


<span class="c1"># ìŠ¤í‚¤ë§ˆ ì§„í™”</span>
<span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;mergeSchema&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/data/delta/users&quot;</span><span class="p">)</span>


<span class="c1"># Z-Order ìµœì í™” (ì¿¼ë¦¬ ì„±ëŠ¥)</span>
<span class="n">delta_table</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span><span class="o">.</span><span class="n">executeZOrderBy</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-apache-iceberg">6. Apache Iceberg<a class="header-link" href="#6-apache-iceberg" title="Permanent link">&para;</a></h2>
<h3 id="61-iceberg">6.1 Iceberg ê¸°ë³¸<a class="header-link" href="#61-iceberg" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Iceberg&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.extensions&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.iceberg&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.iceberg.spark.SparkCatalog&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.iceberg.type&quot;</span><span class="p">,</span> <span class="s2">&quot;hive&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.iceberg.uri&quot;</span><span class="p">,</span> <span class="s2">&quot;thrift://localhost:9083&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Iceberg í…Œì´ë¸” ìƒì„±</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    CREATE TABLE iceberg.db.users (</span>
<span class="s2">        id INT,</span>
<span class="s2">        name STRING,</span>
<span class="s2">        amount DECIMAL(10, 2)</span>
<span class="s2">    ) USING ICEBERG</span>
<span class="s2">    PARTITIONED BY (bucket(16, id))</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1"># ë°ì´í„° ì‚½ì…</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    INSERT INTO iceberg.db.users VALUES</span>
<span class="s2">    (1, &#39;Alice&#39;, 100.00),</span>
<span class="s2">    (2, &#39;Bob&#39;, 200.00)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Time Travel</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iceberg.db.users VERSION AS OF 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iceberg.db.users TIMESTAMP AS OF &#39;2024-01-15&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ìŠ¤ëƒ…ìƒ· í™•ì¸</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iceberg.db.users.snapshots&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="62-delta-lake-vs-iceberg">6.2 Delta Lake vs Iceberg ë¹„êµ<a class="header-link" href="#62-delta-lake-vs-iceberg" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>íŠ¹ì„±</th>
<th>Delta Lake</th>
<th>Iceberg</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ê°œë°œì‚¬</strong></td>
<td>Databricks</td>
<td>Netflix â†’ Apache</td>
</tr>
<tr>
<td><strong>í˜¸í™˜ì„±</strong></td>
<td>Spark ì¤‘ì‹¬</td>
<td>ì—”ì§„ ë…ë¦½ì </td>
</tr>
<tr>
<td><strong>ë©”íƒ€ë°ì´í„°</strong></td>
<td>íŠ¸ëœì­ì…˜ ë¡œê·¸</td>
<td>ìŠ¤ëƒ…ìƒ· ê¸°ë°˜</td>
</tr>
<tr>
<td><strong>íŒŒí‹°ì…˜ ì§„í™”</strong></td>
<td>ì œí•œì </td>
<td>ê°•ë ¥í•œ ì§€ì›</td>
</tr>
<tr>
<td><strong>ìˆ¨ê²¨ì§„ íŒŒí‹°ì…˜</strong></td>
<td>ë¯¸ì§€ì›</td>
<td>ì§€ì›</td>
</tr>
<tr>
<td><strong>ì»¤ë®¤ë‹ˆí‹°</strong></td>
<td>Databricks ìƒíƒœê³„</td>
<td>ë‹¤ì–‘í•œ ë²¤ë”</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7">7. ëª¨ë˜ ë°ì´í„° ìŠ¤íƒ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ì•„í‚¤í…ì²˜ íŒ¨í„´<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Modern Data Stack                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Data Sources                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚ SaaS   â”‚ â”‚Databaseâ”‚ â”‚  API   â”‚ â”‚  IoT   â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Ingestion (EL)                              â”‚  â”‚
â”‚   â”‚        Fivetran / Airbyte / Stitch                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚           Cloud Data Warehouse / Lakehouse              â”‚  â”‚
â”‚   â”‚        Snowflake / BigQuery / Databricks                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚              Transformation (T)                          â”‚  â”‚
â”‚   â”‚                      dbt                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                 BI / Analytics                           â”‚  â”‚
â”‚   â”‚        Looker / Tableau / Metabase / Mode               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="_2">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1">ë¬¸ì œ 1: ì•„í‚¤í…ì²˜ ì„ íƒ<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ì•„í‚¤í…ì²˜ë¥¼ ì„ íƒí•˜ê³  ì´ìœ ë¥¼ ì„¤ëª…í•˜ì„¸ìš”:
- ì¼ì¼ 10TBì˜ ë¡œê·¸ ë°ì´í„°
- ML ëª¨ë¸ í•™ìŠµì— ì‚¬ìš©
- ì›ë³¸ ë°ì´í„° 5ë…„ ë³´ì¡´ í•„ìš”</p>
<h3 id="2-delta-lake">ë¬¸ì œ 2: Delta Lake êµ¬í˜„<a class="header-link" href="#2-delta-lake" title="Permanent link">&para;</a></h3>
<p>ê³ ê° ë°ì´í„°ì— ëŒ€í•œ SCD Type 2ë¥¼ Delta Lake MERGEë¡œ êµ¬í˜„í•˜ì„¸ìš”.</p>
<hr />
<h2 id="_3">ìš”ì•½<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ì•„í‚¤í…ì²˜</th>
<th>íŠ¹ì§•</th>
<th>ì‚¬ìš© ì‚¬ë¡€</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data Warehouse</strong></td>
<td>êµ¬ì¡°í™”, SQL ìµœì í™”</td>
<td>BI, ë¦¬í¬íŒ…</td>
</tr>
<tr>
<td><strong>Data Lake</strong></td>
<td>ëª¨ë“  ë°ì´í„°, ì €ë¹„ìš©</td>
<td>ML, ì›ë³¸ ë³´ì¡´</td>
</tr>
<tr>
<td><strong>Lakehouse</strong></td>
<td>Lake + Warehouse ì¥ì </td>
<td>í†µí•© ë¶„ì„</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_4">ì°¸ê³  ìë£Œ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.delta.io/">Delta Lake Documentation</a></li>
<li><a href="https://iceberg.apache.org/">Apache Iceberg Documentation</a></li>
<li><a href="https://www.databricks.com/product/data-lakehouse">Databricks Lakehouse</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Engineering/10_Kafka_Streaming.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Kafka ìŠ¤íŠ¸ë¦¬ë°</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Engineering/12_dbt_Transformation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">dbt ë³€í™˜ ë„êµ¬</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}