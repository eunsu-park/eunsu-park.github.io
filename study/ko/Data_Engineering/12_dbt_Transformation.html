{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dbt ë³€í™˜ ë„êµ¬ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Data_Engineering/">Data Engineering</a>
    <span class="separator">/</span>
    <span class="current">dbt ë³€í™˜ ë„êµ¬</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>dbt ë³€í™˜ ë„êµ¬</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Engineering/11_Data_Lake_Warehouse.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Data Lakeì™€ Data Warehouse</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Engineering/13_Data_Quality_Governance.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë°ì´í„° í’ˆì§ˆê³¼ ê±°ë²„ë„ŒìŠ¤</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">ê°œìš”</a></li>
<li><a href="#1-dbt">1. dbt ê°œìš”</a><ul>
<li><a href="#11-dbt">1.1 dbtë€?</a></li>
<li><a href="#12-dbt-core-vs-dbt-cloud">1.2 dbt Core vs dbt Cloud</a></li>
<li><a href="#13">1.3 ì„¤ì¹˜</a></li>
</ul>
</li>
<li><a href="#2">2. í”„ë¡œì íŠ¸ êµ¬ì¡°</a><ul>
<li><a href="#21">2.1 í”„ë¡œì íŠ¸ ì´ˆê¸°í™”</a></li>
<li><a href="#22">2.2 ì„¤ì • íŒŒì¼</a></li>
</ul>
</li>
<li><a href="#3-models">3. ëª¨ë¸ (Models)</a><ul>
<li><a href="#31">3.1 ê¸°ë³¸ ëª¨ë¸</a></li>
<li><a href="#32">3.2 ì†ŒìŠ¤ ì •ì˜</a></li>
<li><a href="#33-materialization">3.3 Materialization ìœ í˜•</a></li>
</ul>
</li>
<li><a href="#4">4. í…ŒìŠ¤íŠ¸</a><ul>
<li><a href="#41">4.1 ìŠ¤í‚¤ë§ˆ í…ŒìŠ¤íŠ¸</a></li>
<li><a href="#42">4.2 ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸</a></li>
<li><a href="#43">4.3 í…ŒìŠ¤íŠ¸ ì‹¤í–‰</a></li>
</ul>
</li>
<li><a href="#5">5. ë¬¸ì„œí™”</a><ul>
<li><a href="#51">5.1 ë¬¸ì„œ ì •ì˜</a></li>
<li><a href="#52">5.2 ë¬¸ì„œ ìƒì„± ë° ì„œë¹™</a></li>
</ul>
</li>
<li><a href="#6-jinja">6. Jinja í…œí”Œë¦¿</a><ul>
<li><a href="#61-jinja">6.1 ê¸°ë³¸ Jinja ë¬¸ë²•</a></li>
<li><a href="#62-macros">6.2 Macros</a></li>
<li><a href="#63-dbt">6.3 dbt ë‚´ì¥ í•¨ìˆ˜</a></li>
</ul>
</li>
<li><a href="#7-incremental">7. ì¦ë¶„ ì²˜ë¦¬ (Incremental)</a><ul>
<li><a href="#71">7.1 ê¸°ë³¸ ì¦ë¶„ ëª¨ë¸</a></li>
<li><a href="#72">7.2 ì¦ë¶„ ì „ëµ</a></li>
</ul>
</li>
<li><a href="#8">8. ì‹¤í–‰ ëª…ë ¹</a><ul>
<li><a href="#81">8.1 ê¸°ë³¸ ëª…ë ¹</a></li>
<li><a href="#82-selectors">8.2 ì„ íƒì (Selectors)</a></li>
</ul>
</li>
<li><a href="#_2">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1">ë¬¸ì œ 1: ìŠ¤í…Œì´ì§• ëª¨ë¸</a></li>
<li><a href="#2_1">ë¬¸ì œ 2: ì¦ë¶„ ëª¨ë¸</a></li>
<li><a href="#3">ë¬¸ì œ 3: í…ŒìŠ¤íŠ¸ ì‘ì„±</a></li>
</ul>
</li>
<li><a href="#_3">ìš”ì•½</a></li>
<li><a href="#_4">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="dbt">dbt ë³€í™˜ ë„êµ¬<a class="header-link" href="#dbt" title="Permanent link">&para;</a></h1>
<h2 id="_1">ê°œìš”<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>dbt(data build tool)ëŠ” SQL ê¸°ë°˜ì˜ ë°ì´í„° ë³€í™˜ ë„êµ¬ì…ë‹ˆë‹¤. ELT íŒ¨í„´ì—ì„œ Transform ë‹¨ê³„ë¥¼ ë‹´ë‹¹í•˜ë©°, ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ë§ ëª¨ë²” ì‚¬ë¡€(ë²„ì „ ê´€ë¦¬, í…ŒìŠ¤íŠ¸, ë¬¸ì„œí™”)ë¥¼ ë°ì´í„° ë³€í™˜ì— ì ìš©í•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="1-dbt">1. dbt ê°œìš”<a class="header-link" href="#1-dbt" title="Permanent link">&para;</a></h2>
<h3 id="11-dbt">1.1 dbtë€?<a class="header-link" href="#11-dbt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        dbt ì—­í•                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   ELT íŒŒì´í”„ë¼ì¸ì—ì„œ T(Transform) ë‹´ë‹¹                          â”‚
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚ Extract  â”‚ â†’  â”‚   Load   â”‚ â†’  â”‚Transform â”‚               â”‚
â”‚   â”‚ (Fivetranâ”‚    â”‚  (to DW) â”‚    â”‚  (dbt)   â”‚               â”‚
â”‚   â”‚  Airbyte)â”‚    â”‚          â”‚    â”‚          â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                â”‚
â”‚   dbt í•µì‹¬ ê¸°ëŠ¥:                                               â”‚
â”‚   - SQL ê¸°ë°˜ ëª¨ë¸ ì •ì˜                                         â”‚
â”‚   - ì˜ì¡´ì„± ìë™ ê´€ë¦¬                                           â”‚
â”‚   - í…ŒìŠ¤íŠ¸ ë° ë¬¸ì„œí™”                                           â”‚
â”‚   - Jinja í…œí”Œë¦¿ ì§€ì›                                          â”‚
â”‚   - ë²„ì „ ê´€ë¦¬ (Git)                                            â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12-dbt-core-vs-dbt-cloud">1.2 dbt Core vs dbt Cloud<a class="header-link" href="#12-dbt-core-vs-dbt-cloud" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>íŠ¹ì„±</th>
<th>dbt Core</th>
<th>dbt Cloud</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ë¹„ìš©</strong></td>
<td>ë¬´ë£Œ (ì˜¤í”ˆì†ŒìŠ¤)</td>
<td>ìœ ë£Œ (SaaS)</td>
</tr>
<tr>
<td><strong>ì‹¤í–‰</strong></td>
<td>CLI</td>
<td>Web UI + API</td>
</tr>
<tr>
<td><strong>ìŠ¤ì¼€ì¤„ë§</strong></td>
<td>ì™¸ë¶€ ë„êµ¬ í•„ìš” (Airflow)</td>
<td>ë‚´ì¥ ìŠ¤ì¼€ì¤„ëŸ¬</td>
</tr>
<tr>
<td><strong>IDE</strong></td>
<td>VS Code ë“±</td>
<td>ë‚´ì¥ IDE</td>
</tr>
<tr>
<td><strong>í˜‘ì—…</strong></td>
<td>Git ì‚¬ìš©</td>
<td>ë‚´ì¥ í˜‘ì—… ê¸°ëŠ¥</td>
</tr>
</tbody>
</table>
<h3 id="13">1.3 ì„¤ì¹˜<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># dbt Core ì„¤ì¹˜</span>
pip<span class="w"> </span>install<span class="w"> </span>dbt-core

<span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ë³„ ì–´ëŒ‘í„° ì„¤ì¹˜</span>
pip<span class="w"> </span>install<span class="w"> </span>dbt-postgres<span class="w">      </span><span class="c1"># PostgreSQL</span>
pip<span class="w"> </span>install<span class="w"> </span>dbt-snowflake<span class="w">     </span><span class="c1"># Snowflake</span>
pip<span class="w"> </span>install<span class="w"> </span>dbt-bigquery<span class="w">      </span><span class="c1"># BigQuery</span>
pip<span class="w"> </span>install<span class="w"> </span>dbt-redshift<span class="w">      </span><span class="c1"># Redshift</span>
pip<span class="w"> </span>install<span class="w"> </span>dbt-databricks<span class="w">    </span><span class="c1"># Databricks</span>

<span class="c1"># ë²„ì „ í™•ì¸</span>
dbt<span class="w"> </span>--version
</code></pre></div>

<hr />
<h2 id="2">2. í”„ë¡œì íŠ¸ êµ¬ì¡°<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 í”„ë¡œì íŠ¸ ì´ˆê¸°í™”<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±</span>
dbt<span class="w"> </span>init<span class="w"> </span>my_project
<span class="nb">cd</span><span class="w"> </span>my_project

<span class="c1"># í”„ë¡œì íŠ¸ êµ¬ì¡°</span>
my_project/
â”œâ”€â”€<span class="w"> </span>dbt_project.yml<span class="w">          </span><span class="c1"># í”„ë¡œì íŠ¸ ì„¤ì •</span>
â”œâ”€â”€<span class="w"> </span>profiles.yml<span class="w">             </span><span class="c1"># ì—°ê²° ì„¤ì • (~/.dbt/profiles.yml)</span>
â”œâ”€â”€<span class="w"> </span>models/<span class="w">                  </span><span class="c1"># SQL ëª¨ë¸</span>
â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>staging/<span class="w">            </span><span class="c1"># ìŠ¤í…Œì´ì§• ëª¨ë¸</span>
â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>intermediate/<span class="w">       </span><span class="c1"># ì¤‘ê°„ ëª¨ë¸</span>
â”‚<span class="w">   </span>â””â”€â”€<span class="w"> </span>marts/<span class="w">              </span><span class="c1"># ìµœì¢… ëª¨ë¸</span>
â”œâ”€â”€<span class="w"> </span>tests/<span class="w">                   </span><span class="c1"># ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸</span>
â”œâ”€â”€<span class="w"> </span>macros/<span class="w">                  </span><span class="c1"># ì¬ì‚¬ìš© ë§¤í¬ë¡œ</span>
â”œâ”€â”€<span class="w"> </span>seeds/<span class="w">                   </span><span class="c1"># ì‹œë“œ ë°ì´í„° (CSV)</span>
â”œâ”€â”€<span class="w"> </span>snapshots/<span class="w">               </span><span class="c1"># SCD ìŠ¤ëƒ…ìƒ·</span>
â”œâ”€â”€<span class="w"> </span>analyses/<span class="w">                </span><span class="c1"># ë¶„ì„ ì¿¼ë¦¬</span>
â””â”€â”€<span class="w"> </span>target/<span class="w">                  </span><span class="c1"># ì»´íŒŒì¼ëœ ê²°ê³¼</span>
</code></pre></div>

<h3 id="22">2.2 ì„¤ì • íŒŒì¼<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># dbt_project.yml</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;my_project&#39;</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1.0.0&#39;</span>
<span class="nt">config-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;my_project&#39;</span>

<span class="nt">model-paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;models&quot;</span><span class="p p-Indicator">]</span>
<span class="nt">analysis-paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;analyses&quot;</span><span class="p p-Indicator">]</span>
<span class="nt">test-paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;tests&quot;</span><span class="p p-Indicator">]</span>
<span class="nt">seed-paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;seeds&quot;</span><span class="p p-Indicator">]</span>
<span class="nt">macro-paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;macros&quot;</span><span class="p p-Indicator">]</span>
<span class="nt">snapshot-paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;snapshots&quot;</span><span class="p p-Indicator">]</span>

<span class="nt">target-path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;target&quot;</span>
<span class="nt">clean-targets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;target&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;dbt_packages&quot;</span>

<span class="c1"># ëª¨ë¸ë³„ ì„¤ì •</span>
<span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my_project</span><span class="p">:</span>
<span class="w">    </span><span class="nt">staging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">+materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">view</span>
<span class="w">      </span><span class="nt">+schema</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">staging</span>
<span class="w">    </span><span class="nt">intermediate</span><span class="p">:</span>
<span class="w">      </span><span class="nt">+materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ephemeral</span>
<span class="w">    </span><span class="nt">marts</span><span class="p">:</span>
<span class="w">      </span><span class="nt">+materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">table</span>
<span class="w">      </span><span class="nt">+schema</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marts</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># profiles.yml (~/.dbt/profiles.yml)</span>
<span class="nt">my_project</span><span class="p">:</span>
<span class="w">  </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span>
<span class="w">  </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dev</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432</span>
<span class="w">      </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">env_var(&#39;DB_PASSWORD&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">dbname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analytics</span>
<span class="w">      </span><span class="nt">schema</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dbt_dev</span>
<span class="w">      </span><span class="nt">threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>

<span class="w">    </span><span class="nt">prod</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod-db.example.com</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432</span>
<span class="w">      </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">env_var(&#39;PROD_USER&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">env_var(&#39;PROD_PASSWORD&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">dbname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analytics</span>
<span class="w">      </span><span class="nt">schema</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dbt_prod</span>
<span class="w">      </span><span class="nt">threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
</code></pre></div>

<hr />
<h2 id="3-models">3. ëª¨ë¸ (Models)<a class="header-link" href="#3-models" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ê¸°ë³¸ ëª¨ë¸<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- models/staging/stg_orders.sql</span>
<span class="c1">-- ìŠ¤í…Œì´ì§• ëª¨ë¸: ì†ŒìŠ¤ ë°ì´í„° ì •ì œ</span>

<span class="k">SELECT</span>
<span class="w">    </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">    </span><span class="k">CAST</span><span class="p">(</span><span class="n">order_date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">DATE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">order_date</span><span class="p">,</span>
<span class="w">    </span><span class="k">CAST</span><span class="p">(</span><span class="n">amount</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span>
<span class="w">    </span><span class="n">status</span><span class="p">,</span>
<span class="w">    </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">loaded_at</span>
<span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">source</span><span class="p">(</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">order_id</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">-- models/staging/stg_customers.sql</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">    </span><span class="k">TRIM</span><span class="p">(</span><span class="n">first_name</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">first_name</span><span class="p">,</span>
<span class="w">    </span><span class="k">TRIM</span><span class="p">(</span><span class="n">last_name</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">last_name</span><span class="p">,</span>
<span class="w">    </span><span class="k">LOWER</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">    </span><span class="n">created_at</span>
<span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">source</span><span class="p">(</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;customers&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">-- models/marts/core/fct_orders.sql</span>
<span class="c1">-- íŒ©íŠ¸ í…Œì´ë¸”: ì£¼ë¬¸</span>

<span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;order_id&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">partition_by</span><span class="o">=</span><span class="err">{</span>
<span class="w">            </span><span class="s1">&#39;field&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;order_date&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="s1">&#39;data_type&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;date&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="s1">&#39;granularity&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;month&#39;</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>

<span class="k">WITH</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">customers</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_customers&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">)</span>

<span class="k">SELECT</span>
<span class="w">    </span><span class="n">o</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">o</span><span class="p">.</span><span class="n">customer_id</span><span class="p">,</span>
<span class="w">    </span><span class="k">c</span><span class="p">.</span><span class="n">first_name</span><span class="p">,</span>
<span class="w">    </span><span class="k">c</span><span class="p">.</span><span class="n">last_name</span><span class="p">,</span>
<span class="w">    </span><span class="k">c</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">    </span><span class="n">o</span><span class="p">.</span><span class="n">order_date</span><span class="p">,</span>
<span class="w">    </span><span class="n">o</span><span class="p">.</span><span class="n">amount</span><span class="p">,</span>
<span class="w">    </span><span class="n">o</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="w">    </span><span class="c1">-- íŒŒìƒ ì»¬ëŸ¼</span>
<span class="w">    </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">order_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">order_year</span><span class="p">,</span>
<span class="w">    </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">MONTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">order_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">order_month</span><span class="p">,</span>
<span class="w">    </span><span class="k">CASE</span>
<span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;high&#39;</span>
<span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span>
<span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;low&#39;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">order_tier</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_id</span>
</code></pre></div>

<h3 id="32">3.2 ì†ŒìŠ¤ ì •ì˜<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># models/staging/_sources.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">sources</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">raw</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì›ë³¸</span><span class="nv"> </span><span class="s">ë°ì´í„°</span><span class="nv"> </span><span class="s">ì†ŒìŠ¤&quot;</span>
<span class="w">    </span><span class="nt">database</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">raw_db</span>
<span class="w">    </span><span class="nt">schema</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public</span>
<span class="w">    </span><span class="nt">tables</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">orders</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì£¼ë¬¸</span><span class="nv"> </span><span class="s">ì›ë³¸</span><span class="nv"> </span><span class="s">í…Œì´ë¸”&quot;</span>
<span class="w">        </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order_id</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì£¼ë¬¸</span><span class="nv"> </span><span class="s">ê³ ìœ </span><span class="nv"> </span><span class="s">ID&quot;</span>
<span class="w">            </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unique</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer_id</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ê³ ê°</span><span class="nv"> </span><span class="s">ID&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">amount</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì£¼ë¬¸</span><span class="nv"> </span><span class="s">ê¸ˆì•¡&quot;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customers</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ê³ ê°</span><span class="nv"> </span><span class="s">ì›ë³¸</span><span class="nv"> </span><span class="s">í…Œì´ë¸”&quot;</span>
<span class="w">        </span><span class="nt">freshness</span><span class="p">:</span>
<span class="w">          </span><span class="nt">warn_after</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="nt"> period</span><span class="p">:</span><span class="w"> </span><span class="nv">hour</span><span class="p p-Indicator">}</span>
<span class="w">          </span><span class="nt">error_after</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="nv">24</span><span class="p p-Indicator">,</span><span class="nt"> period</span><span class="p">:</span><span class="w"> </span><span class="nv">hour</span><span class="p p-Indicator">}</span>
<span class="w">        </span><span class="nt">loaded_at_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">updated_at</span>
</code></pre></div>

<h3 id="33-materialization">3.3 Materialization ìœ í˜•<a class="header-link" href="#33-materialization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- View (ê¸°ë³¸ê°’): ë§¤ë²ˆ ì¿¼ë¦¬ ì‹¤í–‰</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;view&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- Table: ë¬¼ë¦¬ì  í…Œì´ë¸” ìƒì„±</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- Incremental: ì¦ë¶„ ì²˜ë¦¬</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span>
<span class="w">    </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;order_id&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">on_schema_change</span><span class="o">=</span><span class="s1">&#39;append_new_columns&#39;</span>
<span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">source</span><span class="p">(</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">order_date</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">order_date</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="c1">-- Ephemeral: CTEë¡œ ì¸ë¼ì¸ (í…Œì´ë¸” ë¯¸ìƒì„±)</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;ephemeral&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
</code></pre></div>

<hr />
<h2 id="4">4. í…ŒìŠ¤íŠ¸<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ìŠ¤í‚¤ë§ˆ í…ŒìŠ¤íŠ¸<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># models/marts/core/_schema.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fct_orders</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì£¼ë¬¸</span><span class="nv"> </span><span class="s">íŒ©íŠ¸</span><span class="nv"> </span><span class="s">í…Œì´ë¸”&quot;</span>
<span class="w">    </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order_id</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì£¼ë¬¸</span><span class="nv"> </span><span class="s">ê³ ìœ </span><span class="nv"> </span><span class="s">ID&quot;</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unique</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer_id</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">relationships</span><span class="p">:</span>
<span class="w">              </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ref(&#39;dim_customers&#39;)</span>
<span class="w">              </span><span class="nt">field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer_id</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">amount</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dbt_utils.expression_is_true</span><span class="p">:</span>
<span class="w">              </span><span class="nt">expression</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&gt;=</span><span class="nv"> </span><span class="s">0&quot;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">accepted_values</span><span class="p">:</span>
<span class="w">              </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;pending&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;completed&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cancelled&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;refunded&#39;</span><span class="p p-Indicator">]</span>
</code></pre></div>

<h3 id="42">4.2 ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/assert_positive_amounts.sql</span>
<span class="c1">-- ëª¨ë“  ì£¼ë¬¸ ê¸ˆì•¡ì´ ì–‘ìˆ˜ì¸ì§€ í™•ì¸</span>

<span class="k">SELECT</span>
<span class="w">    </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">amount</span>
<span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;fct_orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">-- macros/test_row_count_equal.sql</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">row_count_equal</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">compare_model</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="k">WITH</span><span class="w"> </span><span class="n">model_count</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">compare_count</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">compare_model</span><span class="w"> </span><span class="err">}}</span>
<span class="p">)</span>

<span class="k">SELECT</span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">cnt</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">model_count</span><span class="p">,</span>
<span class="w">    </span><span class="k">c</span><span class="p">.</span><span class="n">cnt</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">compare_count</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">model_count</span><span class="w"> </span><span class="n">m</span>
<span class="k">CROSS</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">compare_count</span><span class="w"> </span><span class="k">c</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">cnt</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">cnt</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endtest</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
</code></pre></div>

<h3 id="43">4.3 í…ŒìŠ¤íŠ¸ ì‹¤í–‰<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰</span>
dbt<span class="w"> </span><span class="nb">test</span>

<span class="c1"># íŠ¹ì • ëª¨ë¸ í…ŒìŠ¤íŠ¸</span>
dbt<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--select<span class="w"> </span>fct_orders

<span class="c1"># ì†ŒìŠ¤ freshness í…ŒìŠ¤íŠ¸</span>
dbt<span class="w"> </span><span class="nb">source</span><span class="w"> </span>freshness
</code></pre></div>

<hr />
<h2 id="5">5. ë¬¸ì„œí™”<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ë¬¸ì„œ ì •ì˜<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># models/marts/core/_schema.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fct_orders</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">## ì£¼ë¬¸ íŒ©íŠ¸ í…Œì´ë¸”</span>

<span class="w">      </span><span class="no">ì´ í…Œì´ë¸”ì€ ëª¨ë“  ì£¼ë¬¸ íŠ¸ëœì­ì…˜ì„ í¬í•¨í•©ë‹ˆë‹¤.</span>

<span class="w">      </span><span class="no">### ì‚¬ìš© ì‚¬ë¡€</span>
<span class="w">      </span><span class="no">- ì¼ë³„/ì›”ë³„ ë§¤ì¶œ ë¶„ì„</span>
<span class="w">      </span><span class="no">- ê³ ê° êµ¬ë§¤ íŒ¨í„´ ë¶„ì„</span>
<span class="w">      </span><span class="no">- ì¬êµ¬ë§¤ìœ¨ ê³„ì‚°</span>

<span class="w">      </span><span class="no">### ê°±ì‹  ì£¼ê¸°</span>
<span class="w">      </span><span class="no">- ë§¤ì¼ 06:00 UTC</span>

<span class="w">    </span><span class="nt">meta</span><span class="p">:</span>
<span class="w">      </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;data-team@company.com&quot;</span>
<span class="w">      </span><span class="nt">contains_pii</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="w">    </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order_id</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì£¼ë¬¸</span><span class="nv"> </span><span class="s">ê³ ìœ </span><span class="nv"> </span><span class="s">ì‹ë³„ì</span><span class="nv"> </span><span class="s">(UUID)&quot;</span>
<span class="w">        </span><span class="nt">meta</span><span class="p">:</span>
<span class="w">          </span><span class="nt">dimension</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">amount</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ì£¼ë¬¸</span><span class="nv"> </span><span class="s">ì´ì•¡</span><span class="nv"> </span><span class="s">(USD)&quot;</span>
<span class="w">        </span><span class="nt">meta</span><span class="p">:</span>
<span class="w">          </span><span class="nt">measure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">aggregation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sum</span>
</code></pre></div>

<h3 id="52">5.2 ë¬¸ì„œ ìƒì„± ë° ì„œë¹™<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë¬¸ì„œ ìƒì„±</span>
dbt<span class="w"> </span>docs<span class="w"> </span>generate

<span class="c1"># ë¬¸ì„œ ì„œë²„ ì‹¤í–‰</span>
dbt<span class="w"> </span>docs<span class="w"> </span>serve<span class="w"> </span>--port<span class="w"> </span><span class="m">8080</span>

<span class="c1"># http://localhost:8080 ì—ì„œ í™•ì¸</span>
</code></pre></div>

<hr />
<h2 id="6-jinja">6. Jinja í…œí”Œë¦¿<a class="header-link" href="#6-jinja" title="Permanent link">&para;</a></h2>
<h3 id="61-jinja">6.1 ê¸°ë³¸ Jinja ë¬¸ë²•<a class="header-link" href="#61-jinja" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- ë³€ìˆ˜</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">my_var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;{{ my_var }}&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">col</span>

<span class="c1">-- ì¡°ê±´ë¬¸</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="k">CASE</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;prod&#39;</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;high&#39;</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;high&#39;</span>
<span class="w">        </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;low&#39;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tier</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">orders</span>

<span class="c1">-- ë°˜ë³µë¬¸</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;quantity&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;discount&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_</span><span class="err">{{</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="err">}}{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">loop</span><span class="p">.</span><span class="k">last</span><span class="w"> </span><span class="o">%</span><span class="err">}</span><span class="p">,</span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endfor</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">order_items</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">order_id</span>
</code></pre></div>

<h3 id="62-macros">6.2 Macros<a class="header-link" href="#62-macros" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- macros/generate_schema_name.sql</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">macro</span><span class="w"> </span><span class="n">generate_schema_name</span><span class="p">(</span><span class="n">custom_schema_name</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="o">-%</span><span class="err">}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%-</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">default_schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">schema</span><span class="w"> </span><span class="o">-%</span><span class="err">}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">custom_schema_name</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="o">-%</span><span class="err">}</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">default_schema</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%-</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">-%</span><span class="err">}</span>
<span class="w">        </span><span class="err">{{</span><span class="w"> </span><span class="n">default_schema</span><span class="w"> </span><span class="err">}}</span><span class="n">_</span><span class="err">{{</span><span class="w"> </span><span class="n">custom_schema_name</span><span class="w"> </span><span class="err">}}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%-</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">-%</span><span class="err">}</span>
<span class="err">{</span><span class="o">%-</span><span class="w"> </span><span class="n">endmacro</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>


<span class="c1">-- macros/cents_to_dollars.sql</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">macro</span><span class="w"> </span><span class="n">cents_to_dollars</span><span class="p">(</span><span class="k">column_name</span><span class="p">,</span><span class="w"> </span><span class="k">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="n">ROUND</span><span class="p">(</span><span class="err">{{</span><span class="w"> </span><span class="k">column_name</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">precision</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endmacro</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>


<span class="c1">-- macros/limit_data_in_dev.sql</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">macro</span><span class="w"> </span><span class="n">limit_data_in_dev</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;dev&#39;</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="w">        </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endmacro</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">-- ë§¤í¬ë¡œ ì‚¬ìš©</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">order_id</span><span class="p">,</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="n">cents_to_dollars</span><span class="p">(</span><span class="s1">&#39;amount_cents&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">amount_dollars</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">orders</span>
<span class="err">{{</span><span class="w"> </span><span class="n">limit_data_in_dev</span><span class="p">()</span><span class="w"> </span><span class="err">}}</span>
</code></pre></div>

<h3 id="63-dbt">6.3 dbt ë‚´ì¥ í•¨ìˆ˜<a class="header-link" href="#63-dbt" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- ref(): ë‹¤ë¥¸ ëª¨ë¸ ì°¸ì¡°</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">ref</span><span class="p">(</span><span class="s1">&#39;stg_orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- source(): ì†ŒìŠ¤ í…Œì´ë¸” ì°¸ì¡°</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">source</span><span class="p">(</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orders&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- this: í˜„ì¬ ëª¨ë¸ ì°¸ì¡° (incrementalì—ì„œ ìœ ìš©)</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">updated_at</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="err">}}</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>

<span class="c1">-- config(): ì„¤ì • ê°’ ì ‘ê·¼</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s1">&#39;materialized&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- target: íƒ€ê²Ÿ í™˜ê²½ ì •ë³´</span>
<span class="err">{{</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="err">}}</span><span class="w">    </span><span class="c1">-- dev, prod</span>
<span class="err">{{</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">schema</span><span class="w"> </span><span class="err">}}</span><span class="w">  </span><span class="c1">-- dbt_dev</span>
<span class="err">{{</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="err">}}</span><span class="w">    </span><span class="c1">-- postgres, snowflake</span>
</code></pre></div>

<hr />
<h2 id="7-incremental">7. ì¦ë¶„ ì²˜ë¦¬ (Incremental)<a class="header-link" href="#7-incremental" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ê¸°ë³¸ ì¦ë¶„ ëª¨ë¸<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- models/marts/fct_events.sql</span>
<span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;event_id&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;delete+insert&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>

<span class="k">SELECT</span>
<span class="w">    </span><span class="n">event_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">user_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">event_type</span><span class="p">,</span>
<span class="w">    </span><span class="n">event_data</span><span class="p">,</span>
<span class="w">    </span><span class="n">created_at</span>
<span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">source</span><span class="p">(</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;events&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_incremental</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
<span class="c1">-- ë§ˆì§€ë§‰ ì‹¤í–‰ ì´í›„ ë°ì´í„°ë§Œ ì²˜ë¦¬</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">created_at</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">created_at</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="err">}}</span><span class="p">)</span>
<span class="err">{</span><span class="o">%</span><span class="w"> </span><span class="n">endif</span><span class="w"> </span><span class="o">%</span><span class="err">}</span>
</code></pre></div>

<h3 id="72">7.2 ì¦ë¶„ ì „ëµ<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Append (ê¸°ë³¸): ìƒˆ ë°ì´í„° ì¶”ê°€ë§Œ</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span>
<span class="w">    </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;append&#39;</span>
<span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- Delete+Insert: í‚¤ ê¸°ì¤€ ì‚­ì œ í›„ ì‚½ì…</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span>
<span class="w">    </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;delete+insert&#39;</span>
<span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- Merge (Snowflake, BigQuery): MERGE ë¬¸ ì‚¬ìš©</span>
<span class="err">{{</span><span class="w"> </span><span class="n">config</span><span class="p">(</span>
<span class="w">    </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">unique_key</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">incremental_strategy</span><span class="o">=</span><span class="s1">&#39;merge&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">merge_update_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;amount&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;updated_at&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="w"> </span><span class="err">}}</span>
</code></pre></div>

<hr />
<h2 id="8">8. ì‹¤í–‰ ëª…ë ¹<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ê¸°ë³¸ ëª…ë ¹<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì—°ê²° í…ŒìŠ¤íŠ¸</span>
dbt<span class="w"> </span>debug

<span class="c1"># ëª¨ë“  ëª¨ë¸ ì‹¤í–‰</span>
dbt<span class="w"> </span>run

<span class="c1"># íŠ¹ì • ëª¨ë¸ë§Œ ì‹¤í–‰</span>
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>fct_orders
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>staging.*
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>+fct_orders+<span class="w">  </span><span class="c1"># ì˜ì¡´ì„± í¬í•¨</span>

<span class="c1"># í…ŒìŠ¤íŠ¸ ì‹¤í–‰</span>
dbt<span class="w"> </span><span class="nb">test</span>

<span class="c1"># ë¹Œë“œ (run + test)</span>
dbt<span class="w"> </span>build

<span class="c1"># Seed ë°ì´í„° ë¡œë“œ</span>
dbt<span class="w"> </span>seed

<span class="c1"># ì»´íŒŒì¼ë§Œ (ì‹¤í–‰ ì•ˆ í•¨)</span>
dbt<span class="w"> </span>compile

<span class="c1"># ì •ë¦¬</span>
dbt<span class="w"> </span>clean
</code></pre></div>

<h3 id="82-selectors">8.2 ì„ íƒì (Selectors)<a class="header-link" href="#82-selectors" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ëª¨ë¸ ì´ë¦„ìœ¼ë¡œ</span>
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>my_model

<span class="c1"># ê²½ë¡œë¡œ</span>
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>models/staging/*

<span class="c1"># íƒœê·¸ë¡œ</span>
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>tag:daily

<span class="c1"># ìƒìœ„ ì˜ì¡´ì„± í¬í•¨</span>
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>+my_model

<span class="c1"># í•˜ìœ„ ì˜ì¡´ì„± í¬í•¨</span>
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>my_model+

<span class="c1"># ì–‘ë°©í–¥</span>
dbt<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>+my_model+

<span class="c1"># íŠ¹ì • ëª¨ë¸ ì œì™¸</span>
dbt<span class="w"> </span>run<span class="w"> </span>--exclude<span class="w"> </span>my_model
</code></pre></div>

<hr />
<h2 id="_2">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1">ë¬¸ì œ 1: ìŠ¤í…Œì´ì§• ëª¨ë¸<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>ì›ë³¸ products í…Œì´ë¸”ì—ì„œ stg_products ëª¨ë¸ì„ ìƒì„±í•˜ì„¸ìš”. ê°€ê²©ì„ ë‹¬ëŸ¬ë¡œ ë³€í™˜í•˜ê³  NULL ê°’ì„ ì²˜ë¦¬í•˜ì„¸ìš”.</p>
<h3 id="2_1">ë¬¸ì œ 2: ì¦ë¶„ ëª¨ë¸<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>ì¼ë³„ íŒë§¤ ì§‘ê³„ í…Œì´ë¸”ì„ ì¦ë¶„ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ëª¨ë¸ì„ ì‘ì„±í•˜ì„¸ìš”.</p>
<h3 id="3">ë¬¸ì œ 3: í…ŒìŠ¤íŠ¸ ì‘ì„±<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>fct_sales ëª¨ë¸ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ì„¸ìš” (unique, not_null, ê¸ˆì•¡ ì–‘ìˆ˜ í™•ì¸).</p>
<hr />
<h2 id="_3">ìš”ì•½<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ê°œë…</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Model</strong></td>
<td>SQL ê¸°ë°˜ ë°ì´í„° ë³€í™˜ ì •ì˜</td>
</tr>
<tr>
<td><strong>Source</strong></td>
<td>ì›ë³¸ ë°ì´í„° ì°¸ì¡°</td>
</tr>
<tr>
<td><strong>ref()</strong></td>
<td>ëª¨ë¸ ê°„ ì°¸ì¡° (ì˜ì¡´ì„± ìë™ ê´€ë¦¬)</td>
</tr>
<tr>
<td><strong>Test</strong></td>
<td>ë°ì´í„° í’ˆì§ˆ ê²€ì¦</td>
</tr>
<tr>
<td><strong>Materialization</strong></td>
<td>view, table, incremental, ephemeral</td>
</tr>
<tr>
<td><strong>Macro</strong></td>
<td>ì¬ì‚¬ìš© ê°€ëŠ¥í•œ SQL í…œí”Œë¦¿</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_4">ì°¸ê³  ìë£Œ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.getdbt.com/">dbt Documentation</a></li>
<li><a href="https://courses.getdbt.com/">dbt Learn</a></li>
<li><a href="https://docs.getdbt.com/guides/best-practices">dbt Best Practices</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Engineering/11_Data_Lake_Warehouse.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Data Lakeì™€ Data Warehouse</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Engineering/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Engineering/13_Data_Quality_Governance.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë°ì´í„° í’ˆì§ˆê³¼ ê±°ë²„ë„ŒìŠ¤</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}