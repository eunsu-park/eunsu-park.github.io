{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>18. ë² ì´ì§€ì•ˆ í†µê³„ ê¸°ì´ˆ (Introduction to Bayesian Statistics) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Data_Science/">Data Science</a>
    <span class="separator">/</span>
    <span class="current">18. ë² ì´ì§€ì•ˆ í†µê³„ ê¸°ì´ˆ (Introduction to Bayesian Statistics)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>18. ë² ì´ì§€ì•ˆ í†µê³„ ê¸°ì´ˆ (Introduction to Bayesian Statistics)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Science/17_Generalized_Linear_Models.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">17. ì¼ë°˜í™” ì„ í˜•ëª¨í˜• (Generalized Linear Models)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Science/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Science/19_Bayesian_Inference.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">19. ë² ì´ì§€ì•ˆ ì¶”ë¡  (Bayesian Inference)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">ê°œìš”</a></li>
<li><a href="#1-vs">1. ë¹ˆë„ì£¼ì˜ vs ë² ì´ì§€ì•ˆ íŒ¨ëŸ¬ë‹¤ì„</a><ul>
<li><a href="#11">1.1 í™•ë¥  í•´ì„ì˜ ì°¨ì´</a></li>
<li><a href="#12">1.2 ë¹„êµ ì˜ˆì œ: ë™ì „ ë˜ì§€ê¸°</a></li>
<li><a href="#13">1.3 í•´ì„ì˜ ì°¨ì´</a></li>
</ul>
</li>
<li><a href="#2-bayes-theorem">2. ë² ì´ì¦ˆ ì •ë¦¬ (Bayes' Theorem)</a><ul>
<li><a href="#21">2.1 ë² ì´ì¦ˆ ì •ë¦¬ì˜ ìœ ë„</a></li>
<li><a href="#22">2.2 ìš©ì–´ ì •ë¦¬</a></li>
<li><a href="#23">2.3 ë² ì´ì¦ˆ ì •ë¦¬ êµ¬í˜„</a></li>
<li><a href="#24">2.4 ì—°ì†ì ì¸ ì—…ë°ì´íŠ¸</a></li>
</ul>
</li>
<li><a href="#3">3. ì‚¬ì „ë¶„í¬, ê°€ëŠ¥ë„, ì‚¬í›„ë¶„í¬</a><ul>
<li><a href="#31">3.1 ì‚¬ì „ë¶„í¬ì˜ ì¢…ë¥˜</a></li>
<li><a href="#32">3.2 ì‚¬ì „ë¶„í¬ì˜ ì˜í–¥</a></li>
<li><a href="#33">3.3 ê°€ëŠ¥ë„ í•¨ìˆ˜</a></li>
</ul>
</li>
<li><a href="#4-conjugate-priors">4. ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ (Conjugate Priors)</a><ul>
<li><a href="#41">4.1 ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ë€?</a></li>
<li><a href="#42-beta-binomial">4.2 Beta-Binomial ì¼¤ë ˆ</a></li>
<li><a href="#43-normal-normal">4.3 Normal-Normal ì¼¤ë ˆ (ì•Œë ¤ì§„ ë¶„ì‚°)</a></li>
<li><a href="#44-gamma-poisson">4.4 Gamma-Poisson ì¼¤ë ˆ</a></li>
<li><a href="#45">4.5 ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ ìš”ì•½í‘œ</a></li>
</ul>
</li>
<li><a href="#5-map-maximum-a-posteriori">5. MAP ì¶”ì • (Maximum A Posteriori)</a><ul>
<li><a href="#51-map-vs-mle">5.1 MAP vs MLE</a></li>
<li><a href="#52-map">5.2 MAP ì¶”ì •ì˜ ìˆ˜ì¹˜ì  ê³„ì‚°</a></li>
<li><a href="#53-map">5.3 MAPê³¼ ì •ê·œí™”ì˜ ê´€ê³„</a></li>
</ul>
</li>
<li><a href="#6">6. ì‹¤ìŠµ ì˜ˆì œ</a><ul>
<li><a href="#61-ab">6.1 A/B í…ŒìŠ¤íŠ¸ì˜ ë² ì´ì§€ì•ˆ ë¶„ì„</a></li>
<li><a href="#62">6.2 í’ˆì§ˆ ê´€ë¦¬ì˜ ë² ì´ì§€ì•ˆ ì ‘ê·¼</a></li>
</ul>
</li>
<li><a href="#7">7. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1">ë¬¸ì œ 1: ë² ì´ì¦ˆ ì •ë¦¬ ì ìš©</a></li>
<li><a href="#2">ë¬¸ì œ 2: ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ ì„ íƒ</a></li>
<li><a href="#3_1">ë¬¸ì œ 3: ì‚¬ì „ë¶„í¬ ë¯¼ê°ë„ ë¶„ì„</a></li>
<li><a href="#4">ë¬¸ì œ 4: ìˆœì°¨ì  ì—…ë°ì´íŠ¸</a></li>
</ul>
</li>
<li><a href="#8">8. í•µì‹¬ ìš”ì•½</a><ul>
<li><a href="#_2">ë² ì´ì§€ì•ˆ í†µê³„ì˜ í•µì‹¬ ê°œë…</a></li>
<li><a href="#_3">ì£¼ìš” ì¼¤ë ˆìŒ</a></li>
<li><a href="#_4">ì¶”ì • ë°©ë²• ë¹„êµ</a></li>
<li><a href="#_5">ë‹¤ìŒ ì¥ ë¯¸ë¦¬ë³´ê¸°</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="18-introduction-to-bayesian-statistics">18. ë² ì´ì§€ì•ˆ í†µê³„ ê¸°ì´ˆ (Introduction to Bayesian Statistics)<a class="header-link" href="#18-introduction-to-bayesian-statistics" title="Permanent link">&para;</a></h1>
<p><a href="./17_Generalized_Linear_Models.md">ì´ì „: ì¼ë°˜í™” ì„ í˜•ëª¨í˜•</a> | <a href="./19_Bayesian_Inference.md">ë‹¤ìŒ: ë² ì´ì§€ì•ˆ ì¶”ë¡ </a></p>
<h2 id="_1">ê°œìš”<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>ë² ì´ì§€ì•ˆ í†µê³„í•™ì€ í™•ë¥ ì„ <strong>ë¶ˆí™•ì‹¤ì„±ì˜ ì •ë„</strong>ë¡œ í•´ì„í•˜ë©°, ì‚¬ì „ ì§€ì‹ê³¼ ë°ì´í„°ë¥¼ ê²°í•©í•˜ì—¬ ì¶”ë¡ í•©ë‹ˆë‹¤. ì´ ì¥ì—ì„œëŠ” ë¹ˆë„ì£¼ì˜ì™€ ë² ì´ì§€ì•ˆ íŒ¨ëŸ¬ë‹¤ì„ì˜ ì°¨ì´, ë² ì´ì¦ˆ ì •ë¦¬, ê·¸ë¦¬ê³  í•µì‹¬ ê°œë…ì¸ ì‚¬ì „ë¶„í¬, ê°€ëŠ¥ë„, ì‚¬í›„ë¶„í¬ë¥¼ í•™ìŠµí•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="1-vs">1. ë¹ˆë„ì£¼ì˜ vs ë² ì´ì§€ì•ˆ íŒ¨ëŸ¬ë‹¤ì„<a class="header-link" href="#1-vs" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 í™•ë¥  í•´ì„ì˜ ì°¨ì´<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê´€ì </th>
<th>ë¹ˆë„ì£¼ì˜ (Frequentist)</th>
<th>ë² ì´ì§€ì•ˆ (Bayesian)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>í™•ë¥ ì˜ ì˜ë¯¸</strong></td>
<td>ì¥ê¸°ì ì¸ ë¹ˆë„ (ë¬´í•œ ë°˜ë³µ ì‹œ)</td>
<td>ë¶ˆí™•ì‹¤ì„±ì˜ ì •ë„ (ë¯¿ìŒ)</td>
</tr>
<tr>
<td><strong>ëª¨ìˆ˜</strong></td>
<td>ê³ ì •ëœ ë¯¸ì§€ì˜ ìƒìˆ˜</td>
<td>í™•ë¥ ë³€ìˆ˜ (ë¶„í¬ë¥¼ ê°€ì§)</td>
</tr>
<tr>
<td><strong>ì¶”ë¡  ëª©í‘œ</strong></td>
<td>ì ì¶”ì •, ì‹ ë¢°êµ¬ê°„</td>
<td>ì‚¬í›„ë¶„í¬ ì „ì²´</td>
</tr>
<tr>
<td><strong>ì‚¬ì „ ì •ë³´</strong></td>
<td>ì‚¬ìš©í•˜ì§€ ì•ŠìŒ</td>
<td>ì‚¬ì „ë¶„í¬ë¡œ ë°˜ì˜</td>
</tr>
<tr>
<td><strong>í•´ì„</strong></td>
<td>"95% ì‹ ë¢°êµ¬ê°„" (ë°˜ë³µ ì‹œ 95%ê°€ ì°¸ê°’ í¬í•¨)</td>
<td>"95% í™•ë¥ ë¡œ ì°¸ê°’ì´ êµ¬ê°„ ë‚´ ì¡´ì¬"</td>
</tr>
</tbody>
</table>
<h3 id="12">1.2 ë¹„êµ ì˜ˆì œ: ë™ì „ ë˜ì§€ê¸°<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># ë°ì´í„°: 10ë²ˆ ë˜ì ¸ì„œ 7ë²ˆ ì•ë©´</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n_heads</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># === ë¹ˆë„ì£¼ì˜ ì ‘ê·¼ ===</span>
<span class="c1"># ì ì¶”ì •: MLE</span>
<span class="n">p_mle</span> <span class="o">=</span> <span class="n">n_heads</span> <span class="o">/</span> <span class="n">n_trials</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ë¹ˆë„ì£¼ì˜] MLE ì¶”ì •ì¹˜: </span><span class="si">{</span><span class="n">p_mle</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 95% ì‹ ë¢°êµ¬ê°„ (Wald interval)</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p_mle</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_mle</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_trials</span><span class="p">)</span>
<span class="n">ci_freq</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_mle</span> <span class="o">-</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">se</span><span class="p">,</span> <span class="n">p_mle</span> <span class="o">+</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">se</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ë¹ˆë„ì£¼ì˜] 95% ì‹ ë¢°êµ¬ê°„: (</span><span class="si">{</span><span class="n">ci_freq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_freq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># === ë² ì´ì§€ì•ˆ ì ‘ê·¼ ===</span>
<span class="c1"># ì‚¬ì „ë¶„í¬: Beta(1, 1) = Uniform(0, 1)</span>
<span class="n">alpha_prior</span><span class="p">,</span> <span class="n">beta_prior</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

<span class="c1"># ì‚¬í›„ë¶„í¬: Beta(alpha + heads, beta + tails)</span>
<span class="n">alpha_post</span> <span class="o">=</span> <span class="n">alpha_prior</span> <span class="o">+</span> <span class="n">n_heads</span>
<span class="n">beta_post</span> <span class="o">=</span> <span class="n">beta_prior</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_trials</span> <span class="o">-</span> <span class="n">n_heads</span><span class="p">)</span>

<span class="n">posterior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">alpha_post</span><span class="p">,</span> <span class="n">beta_post</span><span class="p">)</span>

<span class="c1"># ì‚¬í›„ í‰ê· </span>
<span class="n">p_bayes</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[ë² ì´ì§€ì•ˆ] ì‚¬í›„ í‰ê· : </span><span class="si">{</span><span class="n">p_bayes</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 95% ì‹ ìš©êµ¬ê°„ (Credible Interval)</span>
<span class="n">ci_bayes</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ë² ì´ì§€ì•ˆ] 95% ì‹ ìš©êµ¬ê°„: (</span><span class="si">{</span><span class="n">ci_bayes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_bayes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="13">1.3 í•´ì„ì˜ ì°¨ì´<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì‹œê°í™”</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">p_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># ë¹ˆë„ì£¼ì˜: ê°€ëŠ¥ë„ í•¨ìˆ˜</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">n_heads</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">,</span> <span class="n">p_range</span><span class="p">)</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">likelihood</span> <span class="o">/</span> <span class="n">likelihood</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># ì •ê·œí™”</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Likelihood&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">p_mle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MLE = </span><span class="si">{</span><span class="n">p_mle</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">ci_freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ci_freq</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% CI&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;p (ë™ì „ì˜ ì•ë©´ í™•ë¥ )&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì •ê·œí™”ëœ ê°€ëŠ¥ë„&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¹ˆë„ì£¼ì˜: ê°€ëŠ¥ë„ í•¨ìˆ˜ì™€ ì‹ ë¢°êµ¬ê°„&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ë² ì´ì§€ì•ˆ: ì‚¬í›„ë¶„í¬</span>
<span class="n">prior_pdf</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">alpha_prior</span><span class="p">,</span> <span class="n">beta_prior</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">)</span>
<span class="n">posterior_pdf</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="n">prior_pdf</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prior: Beta(1,1)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="n">posterior_pdf</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Posterior: Beta(</span><span class="si">{</span><span class="n">alpha_post</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">beta_post</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">p_bayes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ì‚¬í›„ í‰ê·  = </span><span class="si">{</span><span class="n">p_bayes</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">ci_bayes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ci_bayes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% Credible Interval&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;p (ë™ì „ì˜ ì•ë©´ í™•ë¥ )&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë² ì´ì§€ì•ˆ: ì‚¬ì „ë¶„í¬ì™€ ì‚¬í›„ë¶„í¬&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="2-bayes-theorem">2. ë² ì´ì¦ˆ ì •ë¦¬ (Bayes' Theorem)<a class="header-link" href="#2-bayes-theorem" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ë² ì´ì¦ˆ ì •ë¦¬ì˜ ìœ ë„<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>ì¡°ê±´ë¶€ í™•ë¥ ì˜ ì •ì˜ì—ì„œ ì¶œë°œ:</p>
<p>$$P(A|B) = \frac{P(A \cap B)}{P(B)}$$</p>
<p>$$P(B|A) = \frac{P(A \cap B)}{P(A)}$$</p>
<p>ì´ ë‘ ì‹ì—ì„œ P(A âˆ© B)ë¥¼ ì†Œê±°í•˜ë©´:</p>
<p>$$P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}$$</p>
<p><strong>ëª¨ìˆ˜ Î¸ì™€ ë°ì´í„° Dì˜ ê´€ê³„ë¡œ í‘œí˜„:</strong></p>
<p>$$P(\theta|D) = \frac{P(D|\theta) \cdot P(\theta)}{P(D)}$$</p>
<h3 id="22">2.2 ìš©ì–´ ì •ë¦¬<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ìš©ì–´</th>
<th>ìˆ˜ì‹</th>
<th>ì˜ë¯¸</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ì‚¬í›„ë¶„í¬ (Posterior)</strong></td>
<td>P(Î¸|D)</td>
<td>ë°ì´í„°ë¥¼ ê´€ì¸¡í•œ í›„ ëª¨ìˆ˜ì— ëŒ€í•œ ë¯¿ìŒ</td>
</tr>
<tr>
<td><strong>ê°€ëŠ¥ë„ (Likelihood)</strong></td>
<td>P(D|Î¸)</td>
<td>ì£¼ì–´ì§„ ëª¨ìˆ˜ì—ì„œ ë°ì´í„°ê°€ ê´€ì¸¡ë  í™•ë¥ </td>
</tr>
<tr>
<td><strong>ì‚¬ì „ë¶„í¬ (Prior)</strong></td>
<td>P(Î¸)</td>
<td>ë°ì´í„° ê´€ì¸¡ ì „ ëª¨ìˆ˜ì— ëŒ€í•œ ì‚¬ì „ ì§€ì‹</td>
</tr>
<tr>
<td><strong>ì£¼ë³€ ê°€ëŠ¥ë„ (Evidence)</strong></td>
<td>P(D)</td>
<td>ì •ê·œí™” ìƒìˆ˜ (ëª¨ë“  Î¸ì— ëŒ€í•œ ì ë¶„)</td>
</tr>
</tbody>
</table>
<h3 id="23">2.3 ë² ì´ì¦ˆ ì •ë¦¬ êµ¬í˜„<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bayes_theorem_discrete</span><span class="p">(</span><span class="n">prior</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì´ì‚°í˜• ë² ì´ì¦ˆ ì •ë¦¬ ê³„ì‚°</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    prior : dict</span>
<span class="sd">        ì‚¬ì „í™•ë¥  {ê°€ì„¤: í™•ë¥ }</span>
<span class="sd">    likelihood : dict</span>
<span class="sd">        ê°€ëŠ¥ë„ {ê°€ì„¤: P(ë°ì´í„°|ê°€ì„¤)}</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    posterior : dict</span>
<span class="sd">        ì‚¬í›„í™•ë¥  {ê°€ì„¤: P(ê°€ì„¤|ë°ì´í„°)}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ë¹„ì •ê·œí™” ì‚¬í›„í™•ë¥ </span>
    <span class="n">unnormalized</span> <span class="o">=</span> <span class="p">{</span><span class="n">h</span><span class="p">:</span> <span class="n">prior</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">*</span> <span class="n">likelihood</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">prior</span><span class="p">}</span>

    <span class="c1"># ì£¼ë³€ ê°€ëŠ¥ë„ (ì •ê·œí™” ìƒìˆ˜)</span>
    <span class="n">evidence</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">unnormalized</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="c1"># ì •ê·œí™”</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="p">{</span><span class="n">h</span><span class="p">:</span> <span class="n">p</span> <span class="o">/</span> <span class="n">evidence</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">unnormalized</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">return</span> <span class="n">posterior</span>

<span class="c1"># ì˜ˆì œ: ì§ˆë³‘ ì§„ë‹¨</span>
<span class="c1"># ê°€ì„¤: ì§ˆë³‘ì´ ìˆë‹¤(D), ì§ˆë³‘ì´ ì—†ë‹¤(~D)</span>
<span class="n">prior</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>   <span class="c1"># ìœ ë³‘ë¥  0.1%</span>
    <span class="s1">&#39;~D&#39;</span><span class="p">:</span> <span class="mf">0.999</span>
<span class="p">}</span>

<span class="c1"># ê²€ì‚¬ ê²°ê³¼ê°€ ì–‘ì„±(+)ì¼ ë•Œì˜ ê°€ëŠ¥ë„</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>    <span class="c1"># ë¯¼ê°ë„: P(+|D) = 99%</span>
    <span class="s1">&#39;~D&#39;</span><span class="p">:</span> <span class="mf">0.05</span>    <span class="c1"># ìœ„ì–‘ì„±ë¥ : P(+|~D) = 5%</span>
<span class="p">}</span>

<span class="n">posterior</span> <span class="o">=</span> <span class="n">bayes_theorem_discrete</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ì§ˆë³‘ ì§„ë‹¨ ë² ì´ì¦ˆ ì—…ë°ì´íŠ¸ ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‚¬ì „í™•ë¥  P(ì§ˆë³‘) = </span><span class="si">{</span><span class="n">prior</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê°€ëŠ¥ë„ P(ì–‘ì„±|ì§ˆë³‘) = </span><span class="si">{</span><span class="n">likelihood</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê°€ëŠ¥ë„ P(ì–‘ì„±|ì •ìƒ) = </span><span class="si">{</span><span class="n">likelihood</span><span class="p">[</span><span class="s1">&#39;~D&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ê²€ì‚¬ ì–‘ì„± í›„ ì‚¬í›„í™•ë¥ :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P(ì§ˆë³‘|ì–‘ì„±) = </span><span class="si">{</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P(ì •ìƒ|ì–‘ì„±) = </span><span class="si">{</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;~D&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="24">2.4 ì—°ì†ì ì¸ ì—…ë°ì´íŠ¸<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sequential_bayes_update</span><span class="p">(</span><span class="n">prior_dist</span><span class="p">,</span> <span class="n">data_points</span><span class="p">,</span> <span class="n">likelihood_func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ìˆœì°¨ì  ë² ì´ì¦ˆ ì—…ë°ì´íŠ¸ (ë°ì´í„°ê°€ í•˜ë‚˜ì”© ë“¤ì–´ì˜¬ ë•Œ)</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    prior_dist : scipy.stats distribution</span>
<span class="sd">        ì´ˆê¸° ì‚¬ì „ë¶„í¬</span>
<span class="sd">    data_points : array-like</span>
<span class="sd">        ê´€ì¸¡ëœ ë°ì´í„°</span>
<span class="sd">    likelihood_func : callable</span>
<span class="sd">        likelihood_func(x, theta) -&gt; P(x|theta)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">current_prior</span> <span class="o">=</span> <span class="n">prior_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta_range</span><span class="p">)</span>

    <span class="n">history</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_prior</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_points</span><span class="p">:</span>
        <span class="c1"># ê°€ëŠ¥ë„ ê³„ì‚°</span>
        <span class="n">likelihood</span> <span class="o">=</span> <span class="n">likelihood_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">theta_range</span><span class="p">)</span>

        <span class="c1"># ë¹„ì •ê·œí™” ì‚¬í›„ë¶„í¬</span>
        <span class="n">unnormalized_posterior</span> <span class="o">=</span> <span class="n">current_prior</span> <span class="o">*</span> <span class="n">likelihood</span>

        <span class="c1"># ì •ê·œí™” (ìˆ˜ì¹˜ì  ì ë¶„)</span>
        <span class="n">posterior</span> <span class="o">=</span> <span class="n">unnormalized_posterior</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">unnormalized_posterior</span><span class="p">,</span> <span class="n">theta_range</span><span class="p">)</span>

        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">current_prior</span> <span class="o">=</span> <span class="n">posterior</span>

    <span class="k">return</span> <span class="n">theta_range</span><span class="p">,</span> <span class="n">history</span>

<span class="c1"># ë™ì „ ë˜ì§€ê¸° ì‹œë®¬ë ˆì´ì…˜</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">true_p</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">true_p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># 20ë²ˆ ë˜ì§€ê¸°</span>

<span class="c1"># ë² ë¥´ëˆ„ì´ ê°€ëŠ¥ë„</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bernoulli_likelihood</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta</span><span class="o">**</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># ìˆœì°¨ì  ì—…ë°ì´íŠ¸</span>
<span class="n">theta_range</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="n">sequential_bayes_update</span><span class="p">(</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># ê· ë“± ì‚¬ì „ë¶„í¬</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">bernoulli_likelihood</span>
<span class="p">)</span>

<span class="c1"># ì‹œê°í™”</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">update_points</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">update_points</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">history</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">true_p</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;True p = </span><span class="si">{</span><span class="n">true_p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">history</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> ê´€ì¸¡ í›„&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ìˆœì°¨ì  ë² ì´ì¦ˆ ì—…ë°ì´íŠ¸: ì‚¬í›„ë¶„í¬ì˜ ë³€í™”&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë°ì´í„°: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì´ ì•ë©´ ìˆ˜: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">, ì „ì²´: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3">3. ì‚¬ì „ë¶„í¬, ê°€ëŠ¥ë„, ì‚¬í›„ë¶„í¬<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ì‚¬ì „ë¶„í¬ì˜ ì¢…ë¥˜<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># 1. ë¬´ì •ë³´ ì‚¬ì „ë¶„í¬ (Non-informative Prior)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">uniform_prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">uniform_prior</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¬´ì •ë³´ ì‚¬ì „ë¶„í¬</span><span class="se">\n</span><span class="s1">Beta(1, 1) = Uniform(0, 1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">uniform_prior</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Jeffreys ì‚¬ì „ë¶„í¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">jeffreys_prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">jeffreys_prior</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Jeffreys ì‚¬ì „ë¶„í¬</span><span class="se">\n</span><span class="s1">Beta(0.5, 0.5)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">jeffreys_prior</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. ì•½í•œ ì •ë³´ ì‚¬ì „ë¶„í¬ (Weakly Informative)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">weak_prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weak_prior</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì•½í•œ ì •ë³´ ì‚¬ì „ë¶„í¬</span><span class="se">\n</span><span class="s1">Beta(2, 2)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weak_prior</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 4. ì •ë³´ì  ì‚¬ì „ë¶„í¬ (Informative Prior) - 0.3 ì¤‘ì‹¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">informative_prior1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">informative_prior1</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì •ë³´ì  ì‚¬ì „ë¶„í¬ (ë‚®ì€ p)</span><span class="se">\n</span><span class="s1">Beta(3, 7), í‰ê· =0.3&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">informative_prior1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 5. ì •ë³´ì  ì‚¬ì „ë¶„í¬ - 0.7 ì¤‘ì‹¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">informative_prior2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">informative_prior2</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì •ë³´ì  ì‚¬ì „ë¶„í¬ (ë†’ì€ p)</span><span class="se">\n</span><span class="s1">Beta(7, 3), í‰ê· =0.7&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">informative_prior2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 6. ê°•í•œ ì •ë³´ì  ì‚¬ì „ë¶„í¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">strong_prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">strong_prior</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê°•í•œ ì •ë³´ì  ì‚¬ì „ë¶„í¬</span><span class="se">\n</span><span class="s1">Beta(30, 30), í‰ê· =0.5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">strong_prior</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="32">3.2 ì‚¬ì „ë¶„í¬ì˜ ì˜í–¥<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ê°™ì€ ë°ì´í„°, ë‹¤ë¥¸ ì‚¬ì „ë¶„í¬</span>
<span class="n">n_trials</span><span class="p">,</span> <span class="n">n_heads</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span>

<span class="n">priors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;ë¬´ì •ë³´ Beta(1,1)&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Jeffreys Beta(0.5,0.5)&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ì•½ì •ë³´ Beta(2,2)&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ì •ë³´ì  Beta(5,5)&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ê°•ì •ë³´ Beta(20,20)&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">priors</span><span class="p">):</span>
    <span class="c1"># ì‚¬ì „ë¶„í¬</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="c1"># ì‚¬í›„ë¶„í¬</span>
    <span class="n">a_post</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">n_heads</span>
    <span class="n">b_post</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_trials</span> <span class="o">-</span> <span class="n">n_heads</span><span class="p">)</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a_post</span><span class="p">,</span> <span class="n">b_post</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">prior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prior&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Posterior&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MLE&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Post Mean=</span><span class="si">{</span><span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ì‚¬ì „ë¶„í¬ì˜ ì˜í–¥ (ë°ì´í„°: </span><span class="si">{</span><span class="n">n_heads</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">n_trials</span><span class="si">}</span><span class="s1"> ì„±ê³µ)&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="33">3.3 ê°€ëŠ¥ë„ í•¨ìˆ˜<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_likelihood_function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;binomial&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ê°€ëŠ¥ë„ í•¨ìˆ˜ ì‹œê°í™”</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">distribution</span> <span class="o">==</span> <span class="s1">&#39;binomial&#39;</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">theta_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

        <span class="c1"># ê°€ëŠ¥ë„ í•¨ìˆ˜: L(Î¸) = Î¸^k * (1-Î¸)^(n-k)</span>
        <span class="n">likelihood</span> <span class="o">=</span> <span class="n">theta_range</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">theta_range</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
        <span class="n">log_likelihood</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">theta_range</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">theta_range</span><span class="p">)</span>

        <span class="c1"># MLE</span>
        <span class="n">mle</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="n">n</span>

        <span class="c1"># ê°€ëŠ¥ë„ í•¨ìˆ˜</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MLE = </span><span class="si">{</span><span class="n">mle</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;L(Î¸)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê°€ëŠ¥ë„ í•¨ìˆ˜ (Likelihood)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># ë¡œê·¸ ê°€ëŠ¥ë„ í•¨ìˆ˜</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">log_likelihood</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MLE = </span><span class="si">{</span><span class="n">mle</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;log L(Î¸)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¡œê·¸ ê°€ëŠ¥ë„ í•¨ìˆ˜ (Log-Likelihood)&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">mle</span>

<span class="c1"># ì˜ˆì œ</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># 7/10 ì„±ê³µ</span>
<span class="n">mle</span> <span class="o">=</span> <span class="n">plot_likelihood_function</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë°ì´í„°: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì„±ê³µ ìˆ˜: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">, ì‹œí–‰ ìˆ˜: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MLE: </span><span class="si">{</span><span class="n">mle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="4-conjugate-priors">4. ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ (Conjugate Priors)<a class="header-link" href="#4-conjugate-priors" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ë€?<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p><strong>ì •ì˜</strong>: ì‚¬ì „ë¶„í¬ì™€ ì‚¬í›„ë¶„í¬ê°€ ê°™ì€ ë¶„í¬ì¡±ì— ì†í•˜ë©´ "ì¼¤ë ˆ(conjugate)"ë¼ê³  í•©ë‹ˆë‹¤.</p>
<p><strong>ì¥ì </strong>:
- ì‚¬í›„ë¶„í¬ë¥¼ í•´ì„ì ìœ¼ë¡œ(closed-form) ê³„ì‚° ê°€ëŠ¥
- ìˆ˜ì¹˜ì  ë°©ë²• ë¶ˆí•„ìš”
- ìˆœì°¨ì  ì—…ë°ì´íŠ¸ê°€ ê°„ë‹¨</p>
<h3 id="42-beta-binomial">4.2 Beta-Binomial ì¼¤ë ˆ<a class="header-link" href="#42-beta-binomial" title="Permanent link">&para;</a></h3>
<p><strong>ëª¨ë¸</strong>:
- ê°€ëŠ¥ë„: X ~ Binomial(n, Î¸)
- ì‚¬ì „ë¶„í¬: Î¸ ~ Beta(Î±, Î²)
- ì‚¬í›„ë¶„í¬: Î¸|X ~ Beta(Î± + x, Î² + n - x)</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BetaBinomialModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Beta-Binomial ì¼¤ë ˆ ëª¨ë¸&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        alpha_prior : float</span>
<span class="sd">            Beta ì‚¬ì „ë¶„í¬ì˜ alpha íŒŒë¼ë¯¸í„°</span>
<span class="sd">        beta_prior : float</span>
<span class="sd">            Beta ì‚¬ì „ë¶„í¬ì˜ beta íŒŒë¼ë¯¸í„°</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_prior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta_prior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_observations</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">posterior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_observations</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_successes</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë°ì´í„°ë¡œ ì‚¬í›„ë¶„í¬ ì—…ë°ì´íŠ¸&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span> <span class="o">+=</span> <span class="n">n_successes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_observations</span> <span class="o">+=</span> <span class="n">n_trials</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">credible_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì‹ ìš©êµ¬ê°„ ê³„ì‚°&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_predictive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ì‚¬í›„ ì˜ˆì¸¡ë¶„í¬: ìƒˆë¡œìš´ n_trials ì‹œí–‰ì—ì„œ ì„±ê³µ ìˆ˜</span>
<span class="sd">        Beta-Binomial ë¶„í¬</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_observations</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">betabinom</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ëª¨ë¸ ìš”ì•½&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Beta-Binomial Model Summary ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prior: Beta(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span><span class="si">}</span><span class="s2"> successes / </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_observations</span><span class="si">}</span><span class="s2"> trials&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior: Beta(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span><span class="si">}</span><span class="s2">, &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">n_observations</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">n_successes</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior Mean: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior Std: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credible_interval</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% Credible Interval: (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>


<span class="c1"># ì˜ˆì œ: í´ë¦­ë¥  ì¶”ì •</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BetaBinomialModel</span><span class="p">(</span><span class="n">alpha_prior</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta_prior</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># ì‚¬ì „: í‰ê·  20% í´ë¦­ë¥ </span>

<span class="c1"># 1ì°¨ ë°ì´í„°: 100ëª… ì¤‘ 35ëª… í´ë¦­</span>
<span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1ì°¨ ë°ì´í„° í›„:&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># 2ì°¨ ë°ì´í„°: ì¶”ê°€ 50ëª… ì¤‘ 22ëª… í´ë¦­</span>
<span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2ì°¨ ë°ì´í„° í›„:&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># ì‹œê°í™”</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># ì‚¬ì „ë¶„í¬</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">prior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prior: Beta(2,8)&#39;</span><span class="p">)</span>

<span class="c1"># ì¤‘ê°„ ì‚¬í›„ë¶„í¬ (1ì°¨ ë°ì´í„° í›„)</span>
<span class="n">post1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">-</span> <span class="mi">35</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">post1</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After 1st data: Beta(37, 73)&#39;</span><span class="p">)</span>

<span class="c1"># ìµœì¢… ì‚¬í›„ë¶„í¬</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Final Posterior: Beta(59, 95)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">posterior_mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Posterior Mean = </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">posterior_mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸ (í´ë¦­ë¥ )&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Beta-Binomial ì¼¤ë ˆ: í´ë¦­ë¥  ì¶”ì •&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="43-normal-normal">4.3 Normal-Normal ì¼¤ë ˆ (ì•Œë ¤ì§„ ë¶„ì‚°)<a class="header-link" href="#43-normal-normal" title="Permanent link">&para;</a></h3>
<p><strong>ëª¨ë¸</strong>:
- ê°€ëŠ¥ë„: X ~ N(Î¼, ÏƒÂ²)  (ÏƒÂ² ì•Œë ¤ì§)
- ì‚¬ì „ë¶„í¬: Î¼ ~ N(Î¼â‚€, Ïƒâ‚€Â²)
- ì‚¬í›„ë¶„í¬: Î¼|X ~ N(Î¼â‚™, Ïƒâ‚™Â²)</p>
<p>$$\mu_n = \frac{\frac{\mu_0}{\sigma_0^2} + \frac{n\bar{x}}{\sigma^2}}{\frac{1}{\sigma_0^2} + \frac{n}{\sigma^2}}$$</p>
<p>$$\sigma_n^2 = \frac{1}{\frac{1}{\sigma_0^2} + \frac{n}{\sigma^2}}$$</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NormalNormalModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normal-Normal ì¼¤ë ˆ ëª¨ë¸ (ì•Œë ¤ì§„ ë¶„ì‚°)&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu_prior</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma_prior</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sigma_known</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        mu_prior : float</span>
<span class="sd">            ì‚¬ì „ë¶„í¬ í‰ê· </span>
<span class="sd">        sigma_prior : float</span>
<span class="sd">            ì‚¬ì „ë¶„í¬ í‘œì¤€í¸ì°¨</span>
<span class="sd">        sigma_known : float</span>
<span class="sd">            ì•Œë ¤ì§„ ë°ì´í„° í‘œì¤€í¸ì°¨</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span> <span class="o">=</span> <span class="n">mu_prior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_0</span> <span class="o">=</span> <span class="n">sigma_prior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma_known</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì‚¬í›„ ì •ë°€ë„ (ë¶„ì‚°ì˜ ì—­ìˆ˜)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_variance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_precision</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x_bar</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">posterior_precision</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_variance</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">posterior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_std</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë°ì´í„° ì¶”ê°€&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">credible_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Normal-Normal Model Summary ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prior: N(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_0</span><span class="si">}</span><span class="s2">Â²)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Known Ïƒ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data: n=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">, xÌ„=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x_bar</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;Data: none&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior: N(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_mean</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_std</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">Â²)&quot;</span><span class="p">)</span>
        <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credible_interval</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% Credible Interval: (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>


<span class="c1"># ì˜ˆì œ: ì²´ì˜¨ ì¸¡ì •</span>
<span class="c1"># ì‚¬ì „ ì§€ì‹: í‰ê·  ì²´ì˜¨ì€ ëŒ€ëµ 36.5ë„, ë¶ˆí™•ì‹¤ì„± Ïƒ=0.5</span>
<span class="c1"># ì¸¡ì • ì˜¤ì°¨ Ïƒ=0.2 (ì•Œë ¤ì§„ ê°’)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">NormalNormalModel</span><span class="p">(</span><span class="n">mu_prior</span><span class="o">=</span><span class="mf">36.5</span><span class="p">,</span> <span class="n">sigma_prior</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sigma_known</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì‚¬ì „ë¶„í¬:&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># ë°ì´í„° ìˆ˜ì§‘: í™˜ì ì²´ì˜¨ ì¸¡ì •</span>
<span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mf">37.1</span><span class="p">,</span> <span class="mf">37.3</span><span class="p">,</span> <span class="mf">36.9</span><span class="p">,</span> <span class="mf">37.2</span><span class="p">,</span> <span class="mf">37.0</span><span class="p">]</span>
<span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë°ì´í„° ì—…ë°ì´íŠ¸ í›„:&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># ì‹œê°í™”</span>
<span class="n">mu_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">35.5</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mu_range</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu_range</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Prior: N(</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">mu_0</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">sigma_0</span><span class="si">}</span><span class="s1">Â²)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mu_range</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu_range</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Posterior: N(</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">posterior_mean</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">posterior_std</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">Â²)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">mu_range</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu_range</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ê°œë³„ ì¸¡ì •ê°’ í‘œì‹œ</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">measurements</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Measurements&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">measurements</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Sample Mean = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¼ (ì²´ì˜¨)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Normal-Normal ì¼¤ë ˆ: ì²´ì˜¨ ì¶”ì •&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="44-gamma-poisson">4.4 Gamma-Poisson ì¼¤ë ˆ<a class="header-link" href="#44-gamma-poisson" title="Permanent link">&para;</a></h3>
<p><strong>ëª¨ë¸</strong>:
- ê°€ëŠ¥ë„: X ~ Poisson(Î»)
- ì‚¬ì „ë¶„í¬: Î» ~ Gamma(Î±, Î²)
- ì‚¬í›„ë¶„í¬: Î»|X ~ Gamma(Î± + Î£xáµ¢, Î² + n)</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GammaPoissonModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gamma-Poisson ì¼¤ë ˆ ëª¨ë¸&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        alpha_prior : float (shape)</span>
<span class="sd">        beta_prior : float (rate)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_prior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta_prior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sum_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">posterior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">alpha_post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_x</span>
        <span class="n">beta_post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">alpha_post</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">beta_post</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">credible_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_predictive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ì‚¬í›„ ì˜ˆì¸¡ë¶„í¬: Negative Binomial</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alpha_post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_x</span>
        <span class="n">beta_post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">beta_post</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta_post</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">nbinom</span><span class="p">(</span><span class="n">alpha_post</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Gamma-Poisson Model Summary ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prior: Gamma(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data: n=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">, Î£x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sum_x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">alpha_post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_x</span>
        <span class="n">beta_post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior: Gamma(</span><span class="si">{</span><span class="n">alpha_post</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">beta_post</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior Mean (Î»): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior Std: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credible_interval</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% Credible Interval: (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>


<span class="c1"># ì˜ˆì œ: ì½œì„¼í„° í†µí™” ìˆ˜ ì¶”ì •</span>
<span class="c1"># ì‚¬ì „: ì‹œê°„ë‹¹ ì•½ 10í†µ ì˜ˆìƒ, ë¶ˆí™•ì‹¤ì„± ìˆìŒ</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GammaPoissonModel</span><span class="p">(</span><span class="n">alpha_prior</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">beta_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># í‰ê·  10, ë¶„ì‚° 10</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì‚¬ì „ë¶„í¬:&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># 5ì‹œê°„ ë™ì•ˆì˜ í†µí™” ìˆ˜</span>
<span class="n">calls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">calls</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë°ì´í„° í›„:&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># ì‹œê°í™”</span>
<span class="n">lambda_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ì‚¬í›„ë¶„í¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambda_range</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">lambda_range</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prior&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambda_range</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">lambda_range</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Posterior&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">lambda_range</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">lambda_range</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">posterior_mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Post Mean = </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">posterior_mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">calls</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Sample Mean = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">calls</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î» (ì‹œê°„ë‹¹ í†µí™” ìˆ˜)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gamma-Poisson ì¼¤ë ˆ: í†µí™”ìœ¨ ì¶”ì •&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ì‚¬í›„ ì˜ˆì¸¡ë¶„í¬</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">pred_dist</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior_predictive</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">pred_dist</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x_pred</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Posterior Predictive&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pred_dist</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Expected = </span><span class="si">{</span><span class="n">pred_dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ë‹¤ìŒ ì‹œê°„ í†µí™” ìˆ˜&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;í™•ë¥ &#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì‚¬í›„ ì˜ˆì¸¡ë¶„í¬&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="45">4.5 ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ ìš”ì•½í‘œ<a class="header-link" href="#45" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê°€ëŠ¥ë„</th>
<th>ì‚¬ì „ë¶„í¬</th>
<th>ì‚¬í›„ë¶„í¬</th>
<th>ì—…ë°ì´íŠ¸ ê·œì¹™</th>
</tr>
</thead>
<tbody>
<tr>
<td>Binomial(n, p)</td>
<td>Beta(Î±, Î²)</td>
<td>Beta(Î±+x, Î²+n-x)</td>
<td>Î±â†Î±+x, Î²â†Î²+(n-x)</td>
</tr>
<tr>
<td>Poisson(Î»)</td>
<td>Gamma(Î±, Î²)</td>
<td>Gamma(Î±+Î£x, Î²+n)</td>
<td>Î±â†Î±+Î£x, Î²â†Î²+n</td>
</tr>
<tr>
<td>Normal(Î¼, ÏƒÂ²)</td>
<td>Normal(Î¼â‚€, Ïƒâ‚€Â²)</td>
<td>Normal(Î¼â‚™, Ïƒâ‚™Â²)</td>
<td>ì •ë°€ë„ ê°€ì¤‘ í‰ê· </td>
</tr>
<tr>
<td>Exponential(Î»)</td>
<td>Gamma(Î±, Î²)</td>
<td>Gamma(Î±+n, Î²+Î£x)</td>
<td>Î±â†Î±+n, Î²â†Î²+Î£x</td>
</tr>
<tr>
<td>Multinomial</td>
<td>Dirichlet</td>
<td>Dirichlet</td>
<td>Î±â†Î±+counts</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5-map-maximum-a-posteriori">5. MAP ì¶”ì • (Maximum A Posteriori)<a class="header-link" href="#5-map-maximum-a-posteriori" title="Permanent link">&para;</a></h2>
<h3 id="51-map-vs-mle">5.1 MAP vs MLE<a class="header-link" href="#51-map-vs-mle" title="Permanent link">&para;</a></h3>
<p><strong>MLE</strong>: ê°€ëŠ¥ë„ë¥¼ ìµœëŒ€í™”
$$\hat{\theta}_{MLE} = \arg\max_\theta P(D|\theta)$$</p>
<p><strong>MAP</strong>: ì‚¬í›„ë¶„í¬ë¥¼ ìµœëŒ€í™”
$$\hat{\theta}_{MAP} = \arg\max_\theta P(\theta|D) = \arg\max_\theta P(D|\theta)P(\theta)$$</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_mle_map</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">n_successes</span><span class="p">,</span> <span class="n">alpha_prior</span><span class="p">,</span> <span class="n">beta_prior</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MLEì™€ MAP ë¹„êµ&quot;&quot;&quot;</span>

    <span class="c1"># MLE</span>
    <span class="n">mle</span> <span class="o">=</span> <span class="n">n_successes</span> <span class="o">/</span> <span class="n">n_trials</span>

    <span class="c1"># MAP for Beta-Binomial</span>
    <span class="c1"># posterior: Beta(alpha + k, beta + n - k)</span>
    <span class="c1"># mode of Beta(a, b) = (a - 1) / (a + b - 2) when a, b &gt; 1</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">alpha_prior</span> <span class="o">+</span> <span class="n">n_successes</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">beta_prior</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_trials</span> <span class="o">-</span> <span class="n">n_successes</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">map_est</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># ëª¨ë“œê°€ ê²½ê³„ì— ìˆëŠ” ê²½ìš°</span>
        <span class="n">map_est</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># ì‚¬í›„ í‰ê·  ì‚¬ìš©</span>

    <span class="c1"># ì‚¬í›„ í‰ê· </span>
    <span class="n">posterior_mean</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mle</span><span class="p">,</span> <span class="n">map_est</span><span class="p">,</span> <span class="n">posterior_mean</span>

<span class="c1"># ë‹¤ì–‘í•œ ì‚¬ì „ë¶„í¬ì™€ ë°ì´í„° í¬ê¸°ì—ì„œ ë¹„êµ</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;n=10, k=7&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="s1">&#39;n=100, k=70&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;n=10, k=3&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;n=100, k=30&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">priors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Uniform&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Weak&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Informative 0.5&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Strong 0.5&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scenarios</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">priors</span><span class="p">))</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.25</span>

    <span class="n">mles</span><span class="p">,</span> <span class="n">maps</span><span class="p">,</span> <span class="n">means</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">priors</span><span class="p">:</span>
        <span class="n">mle</span><span class="p">,</span> <span class="n">map_est</span><span class="p">,</span> <span class="n">post_mean</span> <span class="o">=</span> <span class="n">compare_mle_map</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">mles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mle</span><span class="p">)</span>
        <span class="n">maps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">map_est</span><span class="p">)</span>
        <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">post_mean</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span> <span class="n">mles</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MLE&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">maps</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MAP&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Posterior Mean&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;True ratio = </span><span class="si">{</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">priors</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì¶”ì •ì¹˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;MLE vs MAP vs Posterior Mean: ì‚¬ì „ë¶„í¬ì˜ ì˜í–¥&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-map">5.2 MAP ì¶”ì •ì˜ ìˆ˜ì¹˜ì  ê³„ì‚°<a class="header-link" href="#52-map" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize_scalar</span><span class="p">,</span> <span class="n">minimize</span>

<span class="k">def</span><span class="w"> </span><span class="nf">map_estimation_normal</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prior_mean</span><span class="p">,</span> <span class="n">prior_std</span><span class="p">,</span> <span class="n">known_std</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì •ê·œë¶„í¬ ë°ì´í„°ì˜ MAP ì¶”ì • (ìˆ˜ì¹˜ì  ë°©ë²•)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">x_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># ìŒì˜ ë¡œê·¸ ì‚¬í›„í™•ë¥  (ìµœì†Œí™”)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">neg_log_posterior</span><span class="p">(</span><span class="n">mu</span><span class="p">):</span>
        <span class="c1"># ë¡œê·¸ ê°€ëŠ¥ë„</span>
        <span class="n">log_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">known_std</span><span class="p">)</span> <span class="o">-</span> \
                         <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">data</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">known_std</span><span class="o">**</span><span class="mi">2</span>
        <span class="c1"># ë¡œê·¸ ì‚¬ì „í™•ë¥ </span>
        <span class="n">log_prior</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">mu</span> <span class="o">-</span> <span class="n">prior_mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">prior_std</span><span class="o">**</span><span class="mi">2</span>

        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">log_likelihood</span> <span class="o">+</span> <span class="n">log_prior</span><span class="p">)</span>

    <span class="c1"># ìµœì í™”</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">neg_log_posterior</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">x_bar</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">known_std</span><span class="p">,</span> <span class="n">x_bar</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">known_std</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>

<span class="c1"># ì˜ˆì œ</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">true_mu</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">true_mu</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># ë‹¤ì–‘í•œ ì‚¬ì „ë¶„í¬ë¡œ MAP ì¶”ì •</span>
<span class="n">priors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>   <span class="c1"># ë§¤ìš° ì•½í•œ ì‚¬ì „ë¶„í¬</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>     <span class="c1"># ì•½í•œ ì‚¬ì „ë¶„í¬</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>     <span class="c1"># ì˜ëª»ëœ ê°•í•œ ì‚¬ì „ë¶„í¬</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>   <span class="c1"># ì˜¬ë°”ë¥¸ ê°•í•œ ì‚¬ì „ë¶„í¬</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True Î¼: </span><span class="si">{</span><span class="n">true_mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAP estimates with different priors:&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">prior_mean</span><span class="p">,</span> <span class="n">prior_std</span> <span class="ow">in</span> <span class="n">priors</span><span class="p">:</span>
    <span class="n">map_est</span> <span class="o">=</span> <span class="n">map_estimation_normal</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prior_mean</span><span class="p">,</span> <span class="n">prior_std</span><span class="p">,</span> <span class="n">known_std</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prior N(</span><span class="si">{</span><span class="n">prior_mean</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">prior_std</span><span class="si">}</span><span class="s2">Â²): MAP = </span><span class="si">{</span><span class="n">map_est</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="53-map">5.3 MAPê³¼ ì •ê·œí™”ì˜ ê´€ê³„<a class="header-link" href="#53-map" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># MAP ì¶”ì •ì€ ì •ê·œí™”(regularization)ì™€ ë™ë“±</span>
<span class="c1"># Beta(Î±, Î²) prior for Binomial â†’ L2 ì •ê·œí™”ì™€ ìœ ì‚¬í•œ íš¨ê³¼</span>

<span class="k">def</span><span class="w"> </span><span class="nf">show_map_regularization_connection</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MAPê³¼ ì •ê·œí™”ì˜ ì—°ê²°&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== MAPê³¼ ì •ê·œí™”ì˜ ê´€ê³„ ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. ë¡œì§€ìŠ¤í‹± íšŒê·€ì—ì„œ:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - ì •ê·œ ì‚¬ì „ë¶„í¬ N(0, ÏƒÂ²) â†’ L2 ì •ê·œí™” (Ridge)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - ë¼í”Œë¼ìŠ¤ ì‚¬ì „ë¶„í¬ â†’ L1 ì •ê·œí™” (Lasso)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. ì„ í˜• íšŒê·€ì—ì„œ:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - MAP with N(0, ÏƒÂ²) prior â‰¡ Ridge regression&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - Î» = ÏƒÂ²_noise / ÏƒÂ²_prior&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. ë² ì´ì§€ì•ˆ ê´€ì :&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - ì •ê·œí™” ê°•ë„ = ì‚¬ì „ë¶„í¬ì˜ í™•ì‹ ë„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - ê°•í•œ ì‚¬ì „ë¶„í¬ â†’ ê°•í•œ ì •ê·œí™”&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - ë¬´ì •ë³´ ì‚¬ì „ë¶„í¬ â†’ ì •ê·œí™” ì—†ìŒ (MLE)&quot;</span><span class="p">)</span>

<span class="n">show_map_regularization_connection</span><span class="p">()</span>

<span class="c1"># ì‹œê°ì  ì˜ˆì‹œ</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Ridge vs MAP</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Ridge ê´€ì : L2 íŒ¨ë„í‹°</span>
<span class="n">ridge_penalty</span> <span class="o">=</span> <span class="n">theta</span><span class="o">**</span><span class="mi">2</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ridge_penalty</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;L2 penalty: Î»Î¸Â²&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Penalty&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ridge Regression: L2 Penalty&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># MAP ê´€ì : ì •ê·œ ì‚¬ì „ë¶„í¬</span>
<span class="n">prior_pdf</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">neg_log_prior</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prior_pdf</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">neg_log_prior</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-log P(Î¸) for N(0, 1)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;-log Prior&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MAP: Negative Log Prior&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="6">6. ì‹¤ìŠµ ì˜ˆì œ<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-ab">6.1 A/B í…ŒìŠ¤íŠ¸ì˜ ë² ì´ì§€ì•ˆ ë¶„ì„<a class="header-link" href="#61-ab" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BayesianABTest</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë² ì´ì§€ì•ˆ A/B í…ŒìŠ¤íŠ¸&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_prior</span> <span class="o">=</span> <span class="n">alpha_prior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_prior</span> <span class="o">=</span> <span class="n">beta_prior</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">successes_A</span><span class="p">,</span> <span class="n">trials_A</span><span class="p">,</span> <span class="n">successes_B</span><span class="p">,</span> <span class="n">trials_B</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ë°ì´í„° ì í•©&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">successes_A</span> <span class="o">=</span> <span class="n">successes_A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trials_A</span> <span class="o">=</span> <span class="n">trials_A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">successes_B</span> <span class="o">=</span> <span class="n">successes_B</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trials_B</span> <span class="o">=</span> <span class="n">trials_B</span>

        <span class="c1"># ì‚¬í›„ë¶„í¬</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posterior_A</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha_prior</span> <span class="o">+</span> <span class="n">successes_A</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_prior</span> <span class="o">+</span> <span class="n">trials_A</span> <span class="o">-</span> <span class="n">successes_A</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posterior_B</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha_prior</span> <span class="o">+</span> <span class="n">successes_B</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_prior</span> <span class="o">+</span> <span class="n">trials_B</span> <span class="o">-</span> <span class="n">successes_B</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prob_B_better</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">100000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;P(B &gt; A) ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ê³„ì‚°&quot;&quot;&quot;</span>
        <span class="n">samples_A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_A</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="n">samples_B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_B</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">samples_B</span> <span class="o">&gt;</span> <span class="n">samples_A</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">expected_lift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">100000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ê¸°ëŒ€ ìƒìŠ¹ë¥ &quot;&quot;&quot;</span>
        <span class="n">samples_A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_A</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="n">samples_B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_B</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="n">lift</span> <span class="o">=</span> <span class="p">(</span><span class="n">samples_B</span> <span class="o">-</span> <span class="n">samples_A</span><span class="p">)</span> <span class="o">/</span> <span class="n">samples_A</span>
        <span class="k">return</span> <span class="n">lift</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">lift</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Bayesian A/B Test Results ===&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Group A: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">successes_A</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">trials_A</span><span class="si">}</span><span class="s2"> &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">successes_A</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">trials_A</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group B: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">successes_B</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">trials_B</span><span class="si">}</span><span class="s2"> &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">successes_B</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">trials_B</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Posterior Mean A: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_A</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Posterior Mean B: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">posterior_B</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">prob_b_better</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_B_better</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">P(B &gt; A): </span><span class="si">{</span><span class="n">prob_b_better</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">prob_b_better</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

        <span class="n">lift_mean</span><span class="p">,</span> <span class="n">lift_ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_lift</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected Lift: </span><span class="si">{</span><span class="n">lift_mean</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% CI for Lift: (</span><span class="si">{</span><span class="n">lift_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%, </span><span class="si">{</span><span class="n">lift_ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ê²°ê³¼ ì‹œê°í™”&quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">p_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

        <span class="c1"># ì‚¬í›„ë¶„í¬ ë¹„êµ</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_A</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_B</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_A</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_B</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ì „í™˜ìœ¨&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „í™˜ìœ¨ì˜ ì‚¬í›„ë¶„í¬&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># ì°¨ì´ ë¶„í¬</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">samples_A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_A</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
        <span class="n">samples_B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">posterior_B</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">samples_B</span> <span class="o">-</span> <span class="n">samples_A</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No difference&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mean diff = </span><span class="si">{</span><span class="n">diff</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;B - A&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „í™˜ìœ¨ ì°¨ì´ ë¶„í¬&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># ìƒìŠ¹ë¥  ë¶„í¬</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">lift</span> <span class="o">=</span> <span class="p">(</span><span class="n">samples_B</span> <span class="o">-</span> <span class="n">samples_A</span><span class="p">)</span> <span class="o">/</span> <span class="n">samples_A</span>
        <span class="n">lift</span> <span class="o">=</span> <span class="n">lift</span><span class="p">[(</span><span class="n">lift</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lift</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)]</span>  <span class="c1"># ê·¹ë‹¨ê°’ ì œê±°</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lift</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No lift&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">lift</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Median = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">lift</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ìƒìŠ¹ë¥  (B-A)/A&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìƒìŠ¹ë¥  ë¶„í¬&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># ì˜ˆì œ: ì›¹ì‚¬ì´íŠ¸ ë²„íŠ¼ ìƒ‰ìƒ A/B í…ŒìŠ¤íŠ¸</span>
<span class="n">ab_test</span> <span class="o">=</span> <span class="n">BayesianABTest</span><span class="p">(</span><span class="n">alpha_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta_prior</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ab_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">successes_A</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">trials_A</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>   <span class="c1"># ê¸°ì¡´ ë²„íŠ¼: 48/500 í´ë¦­</span>
    <span class="n">successes_B</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span> <span class="n">trials_B</span><span class="o">=</span><span class="mi">500</span>    <span class="c1"># ìƒˆ ë²„íŠ¼: 63/500 í´ë¦­</span>
<span class="p">)</span>
<span class="n">ab_test</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">ab_test</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>

<h3 id="62">6.2 í’ˆì§ˆ ê´€ë¦¬ì˜ ë² ì´ì§€ì•ˆ ì ‘ê·¼<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bayesian_quality_control</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì œì¡° í’ˆì§ˆ ê´€ë¦¬ì˜ ë² ì´ì§€ì•ˆ ë¶„ì„&quot;&quot;&quot;</span>

    <span class="c1"># ì‹œë‚˜ë¦¬ì˜¤: ë¶ˆëŸ‰ë¥  ì¶”ì •</span>
    <span class="c1"># ì‚¬ì „ ì§€ì‹: ê³¼ê±° ê²½í—˜ìœ¼ë¡œ ë¶ˆëŸ‰ë¥  ì•½ 5%, ì‹ ë¢°ë„ ì¤‘ê°„</span>

    <span class="c1"># ì‚¬ì „ë¶„í¬: Beta(2, 38) â†’ í‰ê·  5%, í‘œë³¸í¬ê¸° 40ì— í•´ë‹¹í•˜ëŠ” ì •ë³´</span>
    <span class="n">alpha_prior</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">beta_prior</span> <span class="o">=</span> <span class="mi">38</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">alpha_prior</span><span class="p">,</span> <span class="n">beta_prior</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ì œì¡° í’ˆì§ˆ ê´€ë¦¬ ë² ì´ì§€ì•ˆ ë¶„ì„ ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‚¬ì „ë¶„í¬: Beta(</span><span class="si">{</span><span class="n">alpha_prior</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">beta_prior</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‚¬ì „ í‰ê·  (ì˜ˆìƒ ë¶ˆëŸ‰ë¥ ): </span><span class="si">{</span><span class="n">prior</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‚¬ì „ 95% êµ¬ê°„: (</span><span class="si">{</span><span class="n">prior</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%, </span><span class="si">{</span><span class="n">prior</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

    <span class="c1"># ìƒˆ ë°ì´í„°: 100ê°œ ìƒ˜í”Œ ì¤‘ 8ê°œ ë¶ˆëŸ‰</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">n_defects</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="c1"># ì‚¬í›„ë¶„í¬</span>
    <span class="n">alpha_post</span> <span class="o">=</span> <span class="n">alpha_prior</span> <span class="o">+</span> <span class="n">n_defects</span>
    <span class="n">beta_post</span> <span class="o">=</span> <span class="n">beta_prior</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">n_defects</span><span class="p">)</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">alpha_post</span><span class="p">,</span> <span class="n">beta_post</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë°ì´í„°: </span><span class="si">{</span><span class="n">n_defects</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2"> ë¶ˆëŸ‰&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‚¬í›„ë¶„í¬: Beta(</span><span class="si">{</span><span class="n">alpha_post</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">beta_post</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‚¬í›„ í‰ê·  (ì¶”ì • ë¶ˆëŸ‰ë¥ ): </span><span class="si">{</span><span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‚¬í›„ 95% ì‹ ìš©êµ¬ê°„: (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

    <span class="c1"># ì˜ì‚¬ê²°ì •: ë¶ˆëŸ‰ë¥ ì´ 10%ë¥¼ ì´ˆê³¼í•  í™•ë¥ </span>
    <span class="n">prob_exceed_10</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">0.10</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">P(ë¶ˆëŸ‰ë¥  &gt; 10%): </span><span class="si">{</span><span class="n">prob_exceed_10</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">prob_exceed_10</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âš ï¸ ê¶Œê³ : í’ˆì§ˆ ì ê²€ í•„ìš” (10% ì´ˆê³¼ í™•ë¥ ì´ 5% ì´ìƒ)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ“ ì •ìƒ: í’ˆì§ˆ ê¸°ì¤€ ì¶©ì¡±&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">p_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="c1"># ì‚¬ì „/ì‚¬í›„ ë¹„êµ</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="n">prior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prior&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Posterior&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p_range</span><span class="p">,</span> <span class="n">posterior</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_range</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Threshold (10%)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Post Mean = </span><span class="si">{</span><span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ë¶ˆëŸ‰ë¥ &#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¶ˆëŸ‰ë¥ ì˜ ì‚¬ì „/ì‚¬í›„ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ê¸°ì¤€ ì´ˆê³¼ í™•ë¥ </span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">exceed_probs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thresholds</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">exceed_probs</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í˜„ì¬ ê¸°ì¤€ (10%)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ìœ ì˜ìˆ˜ì¤€ (5%)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ë¶ˆëŸ‰ë¥  ê¸°ì¤€ (%)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì´ˆê³¼ í™•ë¥ &#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¶ˆëŸ‰ë¥  ê¸°ì¤€ì— ë”°ë¥¸ ì´ˆê³¼ í™•ë¥ &#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">bayesian_quality_control</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7">7. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="1">ë¬¸ì œ 1: ë² ì´ì¦ˆ ì •ë¦¬ ì ìš©<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>ìŠ¤íŒ¸ í•„í„°ë¥¼ êµ¬í˜„í•˜ë ¤ í•©ë‹ˆë‹¤.
- P(ìŠ¤íŒ¸) = 0.3 (30%ê°€ ìŠ¤íŒ¸)
- P("ë¬´ë£Œ"|ìŠ¤íŒ¸) = 0.8 (ìŠ¤íŒ¸ ë©”ì¼ì˜ 80%ì— "ë¬´ë£Œ" í¬í•¨)
- P("ë¬´ë£Œ"|ì •ìƒ) = 0.1 (ì •ìƒ ë©”ì¼ì˜ 10%ì— "ë¬´ë£Œ" í¬í•¨)</p>
<p>"ë¬´ë£Œ"ê°€ í¬í•¨ëœ ë©”ì¼ì´ ìŠ¤íŒ¸ì¼ í™•ë¥ ì„ ê³„ì‚°í•˜ì„¸ìš”.</p>
<h3 id="2">ë¬¸ì œ 2: ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ ì„ íƒ<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ìƒí™©ì— ì í•©í•œ ì¼¤ë ˆ ì‚¬ì „ë¶„í¬ë¥¼ ì„ íƒí•˜ê³  ì´ìœ ë¥¼ ì„¤ëª…í•˜ì„¸ìš”:
1. ì›¹ì‚¬ì´íŠ¸ í´ë¦­ë¥  ì¶”ì •
2. ì½œì„¼í„° ì‹œê°„ë‹¹ í†µí™” ìˆ˜ ì¶”ì •
3. ì œí’ˆ ë¬´ê²Œì˜ í‰ê·  ì¶”ì • (ë¶„ì‚°ì€ ì•Œë ¤ì§)</p>
<h3 id="3_1">ë¬¸ì œ 3: ì‚¬ì „ë¶„í¬ ë¯¼ê°ë„ ë¶„ì„<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<p>ë™ì¼í•œ ë°ì´í„°(100íšŒ ì‹œí–‰, 30íšŒ ì„±ê³µ)ì— ëŒ€í•´ ë‹¤ìŒ ì‚¬ì „ë¶„í¬ë¡œ MAP ì¶”ì •ì„ ìˆ˜í–‰í•˜ì„¸ìš”:
1. Beta(1, 1)
2. Beta(5, 5)
3. Beta(1, 9)
4. Beta(9, 1)</p>
<p>ê° ê²½ìš°ì˜ MAP ì¶”ì •ì¹˜ì™€ MLEë¥¼ ë¹„êµí•˜ê³ , ì‚¬ì „ë¶„í¬ê°€ ê²°ê³¼ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë¶„ì„í•˜ì„¸ìš”.</p>
<h3 id="4">ë¬¸ì œ 4: ìˆœì°¨ì  ì—…ë°ì´íŠ¸<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>ë§¤ì¼ ê³ ê° 10ëª…ì´ ë°©ë¬¸í•˜ê³ , 3ì¼ê°„ì˜ êµ¬ë§¤ ë°ì´í„°ê°€ [3, 5, 4]ì…ë‹ˆë‹¤.
Beta(1, 1) ì‚¬ì „ë¶„í¬ë¥¼ ì‹œì‘ìœ¼ë¡œ ë§¤ì¼ ë°ì´í„°ê°€ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ ì‚¬í›„ë¶„í¬ë¥¼ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.
ìµœì¢… ì‚¬í›„ë¶„í¬ì˜ í‰ê· ê³¼ 95% ì‹ ìš©êµ¬ê°„ì„ êµ¬í•˜ì„¸ìš”.</p>
<hr />
<h2 id="8">8. í•µì‹¬ ìš”ì•½<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="_2">ë² ì´ì§€ì•ˆ í†µê³„ì˜ í•µì‹¬ ê°œë…<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>í™•ë¥ ì˜ ì˜ë¯¸</strong>: ë¶ˆí™•ì‹¤ì„±ì˜ ì •ë„ (ë¯¿ìŒ)</li>
<li><strong>ë² ì´ì¦ˆ ì •ë¦¬</strong>: ì‚¬ì „ ì§€ì‹ + ë°ì´í„° â†’ ì‚¬í›„ ì§€ì‹</li>
<li><strong>ì¼¤ë ˆ ì‚¬ì „ë¶„í¬</strong>: í•´ì„ì  ì‚¬í›„ë¶„í¬ ê³„ì‚° ê°€ëŠ¥</li>
</ol>
<h3 id="_3">ì£¼ìš” ì¼¤ë ˆìŒ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Binomial + Beta â†’ Beta
Poisson + Gamma â†’ Gamma
Normal(Î¼, ÏƒÂ²_known) + Normal â†’ Normal
</code></pre></div>

<h3 id="_4">ì¶”ì • ë°©ë²• ë¹„êµ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ë°©ë²•</th>
<th>ëª©ì </th>
<th>íŠ¹ì§•</th>
</tr>
</thead>
<tbody>
<tr>
<td>MLE</td>
<td>max P(D|Î¸)</td>
<td>ë°ì´í„°ë§Œ ì‚¬ìš©</td>
</tr>
<tr>
<td>MAP</td>
<td>max P(Î¸|D)</td>
<td>ì‚¬ì „ë¶„í¬ ë°˜ì˜</td>
</tr>
<tr>
<td>ì‚¬í›„ í‰ê· </td>
<td>E[Î¸|D]</td>
<td>ì „ì²´ ë¶ˆí™•ì‹¤ì„± ë°˜ì˜</td>
</tr>
</tbody>
</table>
<h3 id="_5">ë‹¤ìŒ ì¥ ë¯¸ë¦¬ë³´ê¸°<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<p>09ì¥ <strong>ë² ì´ì§€ì•ˆ ì¶”ë¡ </strong>ì—ì„œëŠ”:
- MCMC ë°©ë²• (Metropolis-Hastings, Gibbs Sampling)
- PyMCë¥¼ ì‚¬ìš©í•œ ë² ì´ì§€ì•ˆ ëª¨ë¸ë§
- ë² ì´ì§€ì•ˆ íšŒê·€ë¶„ì„
- ëª¨ë¸ ë¹„êµì™€ ì„ íƒ</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Science/17_Generalized_Linear_Models.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">17. ì¼ë°˜í™” ì„ í˜•ëª¨í˜• (Generalized Linear Models)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Science/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Science/19_Bayesian_Inference.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">19. ë² ì´ì§€ì•ˆ ì¶”ë¡  (Bayesian Inference)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}