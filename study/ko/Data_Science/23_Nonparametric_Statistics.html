{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>23. ë¹„ëª¨ìˆ˜ í†µê³„ (Nonparametric Statistics) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Data_Science/">Data Science</a>
    <span class="separator">/</span>
    <span class="current">23. ë¹„ëª¨ìˆ˜ í†µê³„ (Nonparametric Statistics)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>23. ë¹„ëª¨ìˆ˜ í†µê³„ (Nonparametric Statistics)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Science/22_Multivariate_Analysis.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">22. ë‹¤ë³€ëŸ‰ ë¶„ì„ (Multivariate Analysis)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Science/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Science/24_Experimental_Design.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">24. ì‹¤í—˜ ì„¤ê³„ (Experimental Design)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">ê°œìš”</a></li>
<li><a href="#1">1. ë¹„ëª¨ìˆ˜ ê²€ì •ì´ í•„ìš”í•œ ê²½ìš°</a><ul>
<li><a href="#11">1.1 ì–¸ì œ ë¹„ëª¨ìˆ˜ ê²€ì •ì„ ì‚¬ìš©í•˜ëŠ”ê°€?</a></li>
<li><a href="#12-vs">1.2 ëª¨ìˆ˜ì  vs ë¹„ëª¨ìˆ˜ì  ê²€ì • ëŒ€ì‘</a></li>
</ul>
</li>
<li><a href="#2-mann-whitney-u">2. Mann-Whitney U ê²€ì •</a><ul>
<li><a href="#21">2.1 ê°œë…</a></li>
<li><a href="#22">2.2 ë‹¨ì¸¡ ê²€ì •</a></li>
</ul>
</li>
<li><a href="#3-wilcoxon">3. Wilcoxon ë¶€í˜¸ìˆœìœ„ ê²€ì •</a><ul>
<li><a href="#31">3.1 ëŒ€ì‘í‘œë³¸ ë¹„êµ</a></li>
<li><a href="#32">3.2 ë‹¨ì¼ í‘œë³¸ ê²€ì • (ì¤‘ìœ„ìˆ˜ ê²€ì •)</a></li>
</ul>
</li>
<li><a href="#4-kruskal-wallis-h">4. Kruskal-Wallis H ê²€ì •</a><ul>
<li><a href="#41">4.1 ê°œë…</a></li>
<li><a href="#42-post-hoc-tests">4.2 ì‚¬í›„ê²€ì • (Post-hoc Tests)</a></li>
</ul>
</li>
<li><a href="#5-friedman">5. Friedman ê²€ì •</a><ul>
<li><a href="#51">5.1 ê°œë…</a></li>
<li><a href="#52-nemenyi">5.2 Nemenyi ì‚¬í›„ê²€ì •</a></li>
</ul>
</li>
<li><a href="#6-spearman-kendall">6. ë¹„ëª¨ìˆ˜ì  ìƒê´€ (Spearman, Kendall)</a><ul>
<li><a href="#61-spearman">6.1 Spearman ìˆœìœ„ ìƒê´€</a></li>
<li><a href="#62-kendall">6.2 Kendall ìˆœìœ„ ìƒê´€</a></li>
<li><a href="#63">6.3 ìƒê´€ê³„ìˆ˜ ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#7">7. ì‹¤ìŠµ ì˜ˆì œ</a><ul>
<li><a href="#71">7.1 ì¢…í•© ë¹„ëª¨ìˆ˜ ë¶„ì„</a></li>
</ul>
</li>
<li><a href="#8">8. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1_1">ë¬¸ì œ 1: ê²€ì • ì„ íƒ</a></li>
<li><a href="#2-mann-whitney-u_1">ë¬¸ì œ 2: Mann-Whitney U</a></li>
<li><a href="#3">ë¬¸ì œ 3: ìƒê´€ ë¶„ì„</a></li>
<li><a href="#4-kruskal-wallis">ë¬¸ì œ 4: Kruskal-Wallis í›„ ì‚¬í›„ê²€ì •</a></li>
</ul>
</li>
<li><a href="#9">9. í•µì‹¬ ìš”ì•½</a><ul>
<li><a href="#_2">ê²€ì • ì„ íƒ í”Œë¡œìš°ì°¨íŠ¸</a></li>
<li><a href="#scipystats">scipy.stats í•¨ìˆ˜</a></li>
<li><a href="#_3">íš¨ê³¼ í¬ê¸° í•´ì„</a></li>
<li><a href="#_4">ë‹¤ìŒ ì¥ ë¯¸ë¦¬ë³´ê¸°</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="23-nonparametric-statistics">23. ë¹„ëª¨ìˆ˜ í†µê³„ (Nonparametric Statistics)<a class="header-link" href="#23-nonparametric-statistics" title="Permanent link">&para;</a></h1>
<p><a href="./22_Multivariate_Analysis.md">ì´ì „: ë‹¤ë³€ëŸ‰ ë¶„ì„</a> | <a href="./24_Experimental_Design.md">ë‹¤ìŒ: ì‹¤í—˜ ì„¤ê³„</a></p>
<h2 id="_1">ê°œìš”<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>ë¹„ëª¨ìˆ˜ í†µê³„ëŠ” ëª¨ì§‘ë‹¨ì˜ ë¶„í¬ì— ëŒ€í•œ ê°€ì • ì—†ì´ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ ì•Šê±°ë‚˜ í‘œë³¸ í¬ê¸°ê°€ ì‘ì„ ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="1">1. ë¹„ëª¨ìˆ˜ ê²€ì •ì´ í•„ìš”í•œ ê²½ìš°<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ì–¸ì œ ë¹„ëª¨ìˆ˜ ê²€ì •ì„ ì‚¬ìš©í•˜ëŠ”ê°€?<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">when_to_use_nonparametric</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë¹„ëª¨ìˆ˜ ê²€ì • ì‚¬ìš© ìƒí™©&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ================================================</span>
<span class="s2">    ë¹„ëª¨ìˆ˜ ê²€ì •ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°</span>
<span class="s2">    ================================================</span>

<span class="s2">    1. ì •ê·œì„± ìœ„ë°˜</span>
<span class="s2">       - ë°ì´í„°ê°€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠìŒ</span>
<span class="s2">       - Shapiro-Wilk ê²€ì • ë“±ì—ì„œ ê¸°ê°</span>

<span class="s2">    2. ì‘ì€ í‘œë³¸ í¬ê¸°</span>
<span class="s2">       - n &lt; 30ì¸ ê²½ìš° CLT ì ìš© ì–´ë ¤ì›€</span>
<span class="s2">       - ì •ê·œì„± ê²€ì •ë„ ê²€ì •ë ¥ ë¶€ì¡±</span>

<span class="s2">    3. ìˆœìœ„/ì„œì—´ ë°ì´í„°</span>
<span class="s2">       - ë¦¬ì»¤íŠ¸ ì²™ë„ (1~5ì )</span>
<span class="s2">       - ìˆœìœ„ ë°ì´í„°</span>

<span class="s2">    4. ì´ìƒì¹˜ ì¡´ì¬</span>
<span class="s2">       - ê·¹ë‹¨ê°’ì— ë¯¼ê°í•œ í‰ê·  ëŒ€ì‹  ì¤‘ìœ„ìˆ˜ ë¹„êµ</span>
<span class="s2">       - ìˆœìœ„ ê¸°ë°˜ ë°©ë²•ì€ ì´ìƒì¹˜ì— ê°•ê±´</span>

<span class="s2">    5. ë™ì§ˆì„± ê°€ì • ìœ„ë°˜</span>
<span class="s2">       - ë¶„ì‚° ë™ì§ˆì„± (ë“±ë¶„ì‚°) ê°€ì • ìœ„ë°˜</span>

<span class="s2">    ================================================</span>
<span class="s2">    ë¹„ëª¨ìˆ˜ ê²€ì •ì˜ ì¥ë‹¨ì </span>
<span class="s2">    ================================================</span>

<span class="s2">    ì¥ì :</span>
<span class="s2">    - ë¶„í¬ ê°€ì • ë¶ˆí•„ìš”</span>
<span class="s2">    - ì´ìƒì¹˜ì— ê°•ê±´</span>
<span class="s2">    - ìˆœìœ„ ë°ì´í„°ì— ì í•©</span>

<span class="s2">    ë‹¨ì :</span>
<span class="s2">    - ê°€ì •ì´ ë§Œì¡±ë˜ë©´ ëª¨ìˆ˜ì  ê²€ì •ë³´ë‹¤ ê²€ì •ë ¥ ë‚®ìŒ</span>
<span class="s2">    - íš¨ê³¼ í¬ê¸° í•´ì„ì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŒ</span>
<span class="s2">    - ì¼ë¶€ ë³µì¡í•œ ì„¤ê³„ì— ì ìš© ì–´ë ¤ì›€</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">when_to_use_nonparametric</span><span class="p">()</span>

<span class="c1"># ì •ê·œì„± ê²€ì • ì˜ˆì‹œ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_normality</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì •ê·œì„± ê²€ì • ìˆ˜í–‰&quot;&quot;&quot;</span>
    <span class="c1"># Shapiro-Wilk</span>
    <span class="n">stat_sw</span><span class="p">,</span> <span class="n">p_sw</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># D&#39;Agostino-Pearson</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">stat_da</span><span class="p">,</span> <span class="n">p_da</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">stat_da</span><span class="p">,</span> <span class="n">p_da</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ì •ê·œì„± ê²€ì • ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í‘œë³¸ í¬ê¸°: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro-Wilk: W=</span><span class="si">{</span><span class="n">stat_sw</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p_sw</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">p_da</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;D&#39;Agostino-Pearson: p=</span><span class="si">{</span><span class="n">p_da</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">is_normal</span> <span class="o">=</span> <span class="n">p_sw</span> <span class="o">&gt;</span> <span class="n">alpha</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²°ë¡ : </span><span class="si">{</span><span class="s1">&#39;ì •ê·œë¶„í¬ë¡œ ë³¼ ìˆ˜ ìˆìŒ&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_normal</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;ì •ê·œë¶„í¬ ì•„ë‹˜&#39;</span><span class="si">}</span><span class="s2"> (Î±=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">is_normal</span>

<span class="c1"># ì •ê·œ ë°ì´í„°</span>
<span class="n">normal_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">check_normality</span><span class="p">(</span><span class="n">normal_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># ë¹„ì •ê·œ ë°ì´í„° (ì§€ìˆ˜ë¶„í¬)</span>
<span class="n">skewed_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">check_normality</span><span class="p">(</span><span class="n">skewed_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="12-vs">1.2 ëª¨ìˆ˜ì  vs ë¹„ëª¨ìˆ˜ì  ê²€ì • ëŒ€ì‘<a class="header-link" href="#12-vs" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ëª¨ìˆ˜ì  ê²€ì •</th>
<th>ë¹„ëª¨ìˆ˜ì  ê²€ì •</th>
<th>ìƒí™©</th>
</tr>
</thead>
<tbody>
<tr>
<td>1-í‘œë³¸ t-ê²€ì •</td>
<td>Wilcoxon ë¶€í˜¸ìˆœìœ„ ê²€ì •</td>
<td>ë‹¨ì¼ í‘œë³¸, ì¤‘ìœ„ìˆ˜ ê²€ì •</td>
</tr>
<tr>
<td>ë…ë¦½í‘œë³¸ t-ê²€ì •</td>
<td>Mann-Whitney U</td>
<td>ë‘ ë…ë¦½ í‘œë³¸ ë¹„êµ</td>
</tr>
<tr>
<td>ëŒ€ì‘í‘œë³¸ t-ê²€ì •</td>
<td>Wilcoxon ë¶€í˜¸ìˆœìœ„ ê²€ì •</td>
<td>ëŒ€ì‘ í‘œë³¸ ë¹„êµ</td>
</tr>
<tr>
<td>ì¼ì› ANOVA</td>
<td>Kruskal-Wallis H</td>
<td>3ê°œ ì´ìƒ ë…ë¦½ í‘œë³¸</td>
</tr>
<tr>
<td>ë°˜ë³µì¸¡ì • ANOVA</td>
<td>Friedman</td>
<td>3ê°œ ì´ìƒ ëŒ€ì‘ í‘œë³¸</td>
</tr>
<tr>
<td>Pearson ìƒê´€</td>
<td>Spearman/Kendall</td>
<td>ìƒê´€ê´€ê³„</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-mann-whitney-u">2. Mann-Whitney U ê²€ì •<a class="header-link" href="#2-mann-whitney-u" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ê°œë…<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p><strong>ëª©ì </strong>: ë‘ ë…ë¦½ í‘œë³¸ì˜ ë¶„í¬ ë¹„êµ (ì¤‘ìœ„ìˆ˜ ë˜ëŠ” ë¶„í¬ ìœ„ì¹˜)</p>
<p><strong>ê°€ì„¤</strong>:
- Hâ‚€: ë‘ ì§‘ë‹¨ì˜ ë¶„í¬ê°€ ë™ì¼
- Hâ‚: ë‘ ì§‘ë‹¨ì˜ ë¶„í¬ê°€ ë‹¤ë¦„ (ë˜ëŠ” í•œìª½ì´ í™•ë¥ ì ìœ¼ë¡œ ë” í¼)</p>
<p><strong>ê²€ì • í†µê³„ëŸ‰</strong>: U (ìˆœìœ„ í•© ê¸°ë°˜)</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mann_whitney_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mann-Whitney U ê²€ì • ì˜ˆì‹œ&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># ì‹œë‚˜ë¦¬ì˜¤: ë‘ ê·¸ë£¹ì˜ ì²˜ë¦¬ íš¨ê³¼ ë¹„êµ (ì •ê·œì„± ìœ„ë°˜)</span>
    <span class="c1"># ê·¸ë£¹ A: ëŒ€ì¡°êµ°</span>
    <span class="c1"># ê·¸ë£¹ B: ì²˜ë¦¬êµ°</span>

    <span class="n">group_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>  <span class="c1"># ë¹„ì •ê·œ</span>
    <span class="n">group_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>  <span class="c1"># ë¹„ì •ê·œ, ë” í° ê°’</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Mann-Whitney U ê²€ì • ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ê·¸ë£¹ A: n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group_a</span><span class="p">)</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">group_a</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê·¸ë£¹ B: n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group_b</span><span class="p">)</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">group_b</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì •ê·œì„± ê²€ì •</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì •ê·œì„± ê²€ì •:&quot;</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_a</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">group_a</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_b</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">group_b</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê·¸ë£¹ A: p=</span><span class="si">{</span><span class="n">p_a</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê·¸ë£¹ B: p=</span><span class="si">{</span><span class="n">p_b</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Mann-Whitney U ê²€ì •</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mann-Whitney U ê²€ì •:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  U í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ê²°ë¡ : ë‘ ê·¸ë£¹ ê°„ ìœ ì˜í•œ ì°¨ì´ ìˆìŒ (p &lt; 0.05)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ê²°ë¡ : ë‘ ê·¸ë£¹ ê°„ ìœ ì˜í•œ ì°¨ì´ ì—†ìŒ (p &gt;= 0.05)&quot;</span><span class="p">)</span>

    <span class="c1"># íš¨ê³¼ í¬ê¸°: rank-biserial correlation</span>
    <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_a</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_b</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">statistic</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">*</span> <span class="n">n2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">íš¨ê³¼ í¬ê¸° (rank-biserial r): </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  |r| &lt; 0.1: ì‘ì€ íš¨ê³¼&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  0.1 &lt;= |r| &lt; 0.3: ì¤‘ê°„ íš¨ê³¼&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  |r| &gt;= 0.3: í° íš¨ê³¼&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># ë°•ìŠ¤í”Œë¡¯</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="s1">&#39;Group B&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ê°’&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë°•ìŠ¤í”Œë¡¯&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># íˆìŠ¤í† ê·¸ë¨</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">group_a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Group A&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">group_b</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Group B&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">group_a</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A ì¤‘ìœ„ìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">group_b</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B ì¤‘ìœ„ìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ê°’&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¶„í¬ ë¹„êµ&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ìˆœìœ„ ë¶„í¬</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span><span class="p">])</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rankdata</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span>
    <span class="n">ranks_a</span> <span class="o">=</span> <span class="n">ranks</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">group_a</span><span class="p">)]</span>
    <span class="n">ranks_b</span> <span class="o">=</span> <span class="n">ranks</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">group_a</span><span class="p">):]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ranks_a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Group A ranks&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ranks_b</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Group B ranks&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ìˆœìœ„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë¹ˆë„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆœìœ„ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span>

<span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span> <span class="o">=</span> <span class="n">mann_whitney_example</span><span class="p">()</span>
</code></pre></div>

<h3 id="22">2.2 ë‹¨ì¸¡ ê²€ì •<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë‹¨ì¸¡ ê²€ì •: ê·¸ë£¹ Bê°€ ê·¸ë£¹ Aë³´ë‹¤ í°ì§€ ê²€ì •</span>
<span class="n">stat_greater</span><span class="p">,</span> <span class="n">p_greater</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;less&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë‹¨ì¸¡ ê²€ì • (B &gt; A): p = </span><span class="si">{</span><span class="n">p_greater</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">stat_less</span><span class="p">,</span> <span class="n">p_less</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë‹¨ì¸¡ ê²€ì • (A &gt; B): p = </span><span class="si">{</span><span class="n">p_less</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3-wilcoxon">3. Wilcoxon ë¶€í˜¸ìˆœìœ„ ê²€ì •<a class="header-link" href="#3-wilcoxon" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ëŒ€ì‘í‘œë³¸ ë¹„êµ<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p><strong>ëª©ì </strong>: ëŒ€ì‘ë˜ëŠ” ë‘ ì¸¡ì •ê°’ì˜ ì°¨ì´ê°€ 0ì¸ì§€ ê²€ì •</p>
<p><strong>ì‚¬ìš© ìƒí™©</strong>: ì „/í›„ ë¹„êµ, ì§ì§€ì–´ì§„ í‘œë³¸</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wilcoxon_signed_rank_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wilcoxon ë¶€í˜¸ìˆœìœ„ ê²€ì • ì˜ˆì‹œ&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># ì‹œë‚˜ë¦¬ì˜¤: ë‹¤ì´ì–´íŠ¸ í”„ë¡œê·¸ë¨ ì „í›„ ì²´ì¤‘ ë³€í™”</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">before</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="c1"># í‰ê·  3kg ê°ì†Œ íš¨ê³¼ + ë¹„ì •ê·œ ì˜¤ì°¨</span>
    <span class="n">after</span> <span class="o">=</span> <span class="n">before</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="n">after</span> <span class="o">-</span> <span class="n">before</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Wilcoxon ë¶€í˜¸ìˆœìœ„ ê²€ì • ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í‘œë³¸ í¬ê¸°: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì „: í‰ê· =</span><span class="si">{</span><span class="n">before</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">before</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í›„: í‰ê· =</span><span class="si">{</span><span class="n">after</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">after</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì°¨ì´: í‰ê· =</span><span class="si">{</span><span class="n">diff</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì°¨ì´ì˜ ì •ê·œì„± ê²€ì •</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_norm</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì°¨ì´ì˜ ì •ê·œì„±: p=</span><span class="si">{</span><span class="n">p_norm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Wilcoxon ê²€ì •</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">after</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Wilcoxon ê²€ì •:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  W í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ëŒ€ì‘í‘œë³¸ t-ê²€ì •ê³¼ ë¹„êµ</span>
    <span class="n">t_stat</span><span class="p">,</span> <span class="n">t_p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">after</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ëŒ€ì‘ t-ê²€ì • (ë¹„êµìš©):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  t í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  p-value: </span><span class="si">{</span><span class="n">t_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># íš¨ê³¼ í¬ê¸°</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">statistic</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">íš¨ê³¼ í¬ê¸° (r): </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># ì „í›„ ë¹„êµ</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">before</span><span class="p">,</span> <span class="n">after</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Before&#39;</span><span class="p">,</span> <span class="s1">&#39;After&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì²´ì¤‘ (kg)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „í›„ ë¹„êµ&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ê°œì¸ë³„ ë³€í™”</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">before</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">after</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">before</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">after</span><span class="o">.</span><span class="n">mean</span><span class="p">()],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í‰ê· &#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Before&#39;</span><span class="p">,</span> <span class="s1">&#39;After&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì²´ì¤‘ (kg)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê°œì¸ë³„ ë³€í™”&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ì°¨ì´ ë¶„í¬</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë³€í™” ì—†ìŒ&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ì°¨ì´ (After - Before)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì°¨ì´ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">before</span><span class="p">,</span> <span class="n">after</span>

<span class="n">before</span><span class="p">,</span> <span class="n">after</span> <span class="o">=</span> <span class="n">wilcoxon_signed_rank_example</span><span class="p">()</span>
</code></pre></div>

<h3 id="32">3.2 ë‹¨ì¼ í‘œë³¸ ê²€ì • (ì¤‘ìœ„ìˆ˜ ê²€ì •)<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë‹¨ì¼ í‘œë³¸: ì¤‘ìœ„ìˆ˜ê°€ íŠ¹ì • ê°’ì¸ì§€ ê²€ì •</span>
<span class="k">def</span><span class="w"> </span><span class="nf">one_sample_wilcoxon</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">hypothesized_median</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ë‹¨ì¼ í‘œë³¸ Wilcoxon ê²€ì •</span>
<span class="sd">    H0: ì¤‘ìœ„ìˆ˜ = hypothesized_median</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff_from_median</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="n">hypothesized_median</span>

    <span class="c1"># 0ì¸ ê°’ ì œì™¸</span>
    <span class="n">diff_from_median</span> <span class="o">=</span> <span class="n">diff_from_median</span><span class="p">[</span><span class="n">diff_from_median</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff_from_median</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ëª¨ë“  ê°’ì´ ê°€ì„¤ ì¤‘ìœ„ìˆ˜ì™€ ê°™ìŠµë‹ˆë‹¤.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">diff_from_median</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== ë‹¨ì¼ í‘œë³¸ Wilcoxon ê²€ì • ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;H0: ì¤‘ìœ„ìˆ˜ = </span><span class="si">{</span><span class="n">hypothesized_median</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í‘œë³¸ ì¤‘ìœ„ìˆ˜: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;W í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²°ë¡ : ì¤‘ìœ„ìˆ˜ëŠ” </span><span class="si">{</span><span class="n">hypothesized_median</span><span class="si">}</span><span class="s2">ê³¼ ìœ ì˜í•˜ê²Œ ë‹¤ë¦„&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²°ë¡ : ì¤‘ìœ„ìˆ˜ê°€ </span><span class="si">{</span><span class="n">hypothesized_median</span><span class="si">}</span><span class="s2">ì´ë¼ëŠ” ì¦ê±° ë¶€ì¡±&quot;</span><span class="p">)</span>

<span class="c1"># ì˜ˆì‹œ</span>
<span class="n">sample_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>
<span class="n">one_sample_wilcoxon</span><span class="p">(</span><span class="n">sample_data</span><span class="p">,</span> <span class="n">hypothesized_median</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="4-kruskal-wallis-h">4. Kruskal-Wallis H ê²€ì •<a class="header-link" href="#4-kruskal-wallis-h" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ê°œë…<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p><strong>ëª©ì </strong>: 3ê°œ ì´ìƒ ë…ë¦½ ê·¸ë£¹ì˜ ë¶„í¬ ë¹„êµ (ì¼ì› ANOVAì˜ ë¹„ëª¨ìˆ˜ì  ëŒ€ì•ˆ)</p>
<p><strong>ê°€ì„¤</strong>:
- Hâ‚€: ëª¨ë“  ê·¸ë£¹ì˜ ë¶„í¬ê°€ ë™ì¼
- Hâ‚: ìµœì†Œ í•˜ë‚˜ì˜ ê·¸ë£¹ì´ ë‹¤ë¦„</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kruskal_wallis_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Kruskal-Wallis H ê²€ì • ì˜ˆì‹œ&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># ì‹œë‚˜ë¦¬ì˜¤: 3ê°€ì§€ êµìœ¡ ë°©ë²•ì˜ íš¨ê³¼ ë¹„êµ</span>
    <span class="n">method_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span>  <span class="c1"># ì „í†µì </span>
    <span class="n">method_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="o">+</span> <span class="mi">65</span>  <span class="c1"># ì˜¨ë¼ì¸</span>
    <span class="n">method_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="o">+</span> <span class="mi">70</span>  <span class="c1"># í˜¼í•©</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Kruskal-Wallis H ê²€ì • ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë°©ë²• A: n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">method_a</span><span class="p">)</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">method_a</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë°©ë²• B: n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">method_b</span><span class="p">)</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">method_b</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë°©ë²• C: n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">method_c</span><span class="p">)</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">method_c</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì •ê·œì„± ê²€ì •</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì •ê·œì„± ê²€ì •:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">method_a</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">method_b</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">method_c</span><span class="p">)]:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Kruskal-Wallis ê²€ì •</span>
    <span class="n">H_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span><span class="n">method_a</span><span class="p">,</span> <span class="n">method_b</span><span class="p">,</span> <span class="n">method_c</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Kruskal-Wallis ê²€ì •:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  H í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">H_stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># íš¨ê³¼ í¬ê¸°: eta-squared</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">method_a</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">method_b</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">method_c</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">eta_sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">H_stat</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">íš¨ê³¼ í¬ê¸° (Î·Â²): </span><span class="si">{</span><span class="n">eta_sq</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  0.01: ì‘ì€ íš¨ê³¼&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  0.06: ì¤‘ê°„ íš¨ê³¼&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  0.14: í° íš¨ê³¼&quot;</span><span class="p">)</span>

    <span class="c1"># ì¼ì› ANOVAì™€ ë¹„êµ</span>
    <span class="n">F_stat</span><span class="p">,</span> <span class="n">anova_p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f_oneway</span><span class="p">(</span><span class="n">method_a</span><span class="p">,</span> <span class="n">method_b</span><span class="p">,</span> <span class="n">method_c</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì¼ì› ANOVA (ë¹„êµìš©):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  F í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">F_stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  p-value: </span><span class="si">{</span><span class="n">anova_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ë°•ìŠ¤í”Œë¡¯</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">method_a</span><span class="p">,</span> <span class="n">method_b</span><span class="p">,</span> <span class="n">method_c</span><span class="p">],</span>
               <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Method A&#39;</span><span class="p">,</span> <span class="s1">&#39;Method B&#39;</span><span class="p">,</span> <span class="s1">&#39;Method C&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì ìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;êµìœ¡ ë°©ë²•ë³„ ì ìˆ˜ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ë°”ì´ì˜¬ë¦° í”Œë¡¯</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">violinplot</span><span class="p">([</span><span class="n">method_a</span><span class="p">,</span> <span class="n">method_b</span><span class="p">,</span> <span class="n">method_c</span><span class="p">],</span> <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                           <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showmedians</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Method A&#39;</span><span class="p">,</span> <span class="s1">&#39;Method B&#39;</span><span class="p">,</span> <span class="s1">&#39;Method C&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì ìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë°”ì´ì˜¬ë¦° í”Œë¡¯&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">method_a</span><span class="p">,</span> <span class="n">method_b</span><span class="p">,</span> <span class="n">method_c</span>

<span class="n">method_a</span><span class="p">,</span> <span class="n">method_b</span><span class="p">,</span> <span class="n">method_c</span> <span class="o">=</span> <span class="n">kruskal_wallis_example</span><span class="p">()</span>
</code></pre></div>

<h3 id="42-post-hoc-tests">4.2 ì‚¬í›„ê²€ì • (Post-hoc Tests)<a class="header-link" href="#42-post-hoc-tests" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">mannwhitneyu</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dunn_test_alternative</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">group_names</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dunn ê²€ì •ì˜ ëŒ€ì•ˆ: Bonferroni ë³´ì •ëœ Mann-Whitney U ê²€ì •</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_comparisons</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">adjusted_alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">n_comparisons</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== ì‚¬í›„ê²€ì • (Bonferroni ë³´ì •) ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¹„êµ íšŸìˆ˜: </span><span class="si">{</span><span class="n">n_comparisons</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë³´ì •ëœ Î±: </span><span class="si">{</span><span class="n">adjusted_alpha</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)),</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
        <span class="n">significant</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">adjusted_alpha</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;comparison&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="n">stat</span><span class="p">,</span>
            <span class="s1">&#39;p-value&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span>
            <span class="s1">&#39;significant&#39;</span><span class="p">:</span> <span class="n">significant</span>
        <span class="p">})</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">: U=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;*&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">significant</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">method_a</span><span class="p">,</span> <span class="n">method_b</span><span class="p">,</span> <span class="n">method_c</span><span class="p">]</span>
<span class="n">group_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">posthoc_results</span> <span class="o">=</span> <span class="n">dunn_test_alternative</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">group_names</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5-friedman">5. Friedman ê²€ì •<a class="header-link" href="#5-friedman" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ê°œë…<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p><strong>ëª©ì </strong>: ë°˜ë³µì¸¡ì • ë˜ëŠ” ë¸”ë¡ ì„¤ê³„ì—ì„œ 3ê°œ ì´ìƒ ì¡°ê±´ ë¹„êµ</p>
<p><strong>ì‚¬ìš© ìƒí™©</strong>: ê°™ì€ í”¼í—˜ìê°€ ì—¬ëŸ¬ ì¡°ê±´ì—ì„œ ì¸¡ì •ë¨</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">friedman_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Friedman ê²€ì • ì˜ˆì‹œ&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># ì‹œë‚˜ë¦¬ì˜¤: ê°™ì€ í•™ìƒë“¤ì˜ 3ê°œ ì‹œí—˜ ì ìˆ˜</span>
    <span class="n">n_students</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="c1"># ìƒê´€ëœ ë°ì´í„° ìƒì„± (ê°™ì€ í•™ìƒì˜ ì—¬ëŸ¬ ì‹œí—˜)</span>
    <span class="n">ability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n_students</span><span class="p">)</span>  <span class="c1"># ê¸°ì € ëŠ¥ë ¥</span>
    <span class="n">exam1</span> <span class="o">=</span> <span class="n">ability</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n_students</span><span class="p">)</span>
    <span class="n">exam2</span> <span class="o">=</span> <span class="n">ability</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n_students</span><span class="p">)</span>  <span class="c1"># ì•½ê°„ ë” ì–´ë ¤ì›€</span>
    <span class="n">exam3</span> <span class="o">=</span> <span class="n">ability</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n_students</span><span class="p">)</span>  <span class="c1"># ë” ì–´ë ¤ì›€</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Friedman ê²€ì • ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í•™ìƒ ìˆ˜: </span><span class="si">{</span><span class="n">n_students</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exam 1: ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">exam1</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exam 2: ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">exam2</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exam 3: ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">exam3</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Friedman ê²€ì •</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">friedmanchisquare</span><span class="p">(</span><span class="n">exam1</span><span class="p">,</span> <span class="n">exam2</span><span class="p">,</span> <span class="n">exam3</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Friedman ê²€ì •:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ï‡Â² í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># íš¨ê³¼ í¬ê¸°: Kendall&#39;s W</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># ì¡°ê±´ ìˆ˜</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">stat</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_students</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">íš¨ê³¼ í¬ê¸° (Kendall&#39;s W): </span><span class="si">{</span><span class="n">W</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  W &lt; 0.3: ì•½í•œ ì¼ì¹˜&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  0.3 &lt;= W &lt; 0.5: ì¤‘ê°„ ì¼ì¹˜&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  W &gt;= 0.5: ê°•í•œ ì¼ì¹˜&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ë°•ìŠ¤í”Œë¡¯</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">exam1</span><span class="p">,</span> <span class="n">exam2</span><span class="p">,</span> <span class="n">exam3</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Exam 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Exam 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Exam 3&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì ìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì‹œí—˜ë³„ ì ìˆ˜ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ê°œì¸ë³„ í”„ë¡œíŒŒì¼</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_students</span><span class="p">)):</span>  <span class="c1"># ì²˜ìŒ 10ëª…ë§Œ</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">exam1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">exam2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">exam3</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">exam1</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">exam2</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">exam3</span><span class="o">.</span><span class="n">mean</span><span class="p">()],</span>
            <span class="s1">&#39;rs-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í‰ê· &#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Exam 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Exam 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Exam 3&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì ìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê°œì¸ë³„ í”„ë¡œíŒŒì¼&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">exam1</span><span class="p">,</span> <span class="n">exam2</span><span class="p">,</span> <span class="n">exam3</span>

<span class="n">exam1</span><span class="p">,</span> <span class="n">exam2</span><span class="p">,</span> <span class="n">exam3</span> <span class="o">=</span> <span class="n">friedman_example</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-nemenyi">5.2 Nemenyi ì‚¬í›„ê²€ì •<a class="header-link" href="#52-nemenyi" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nemenyi_posthoc</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">group_names</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Nemenyi ì‚¬í›„ê²€ì • (Friedman ì´í›„)</span>
<span class="sd">    Wilcoxon ë¶€í˜¸ìˆœìœ„ ê²€ì •ì˜ Bonferroni ë³´ì •</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_comparisons</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">adjusted_alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">n_comparisons</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== Nemenyi ì‚¬í›„ê²€ì • ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¹„êµ íšŸìˆ˜: </span><span class="si">{</span><span class="n">n_comparisons</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë³´ì •ëœ Î±: </span><span class="si">{</span><span class="n">adjusted_alpha</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)),</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">significant</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">adjusted_alpha</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;comparison&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="n">stat</span><span class="p">,</span>
            <span class="s1">&#39;p-value&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span>
            <span class="s1">&#39;significant&#39;</span><span class="p">:</span> <span class="n">significant</span>
        <span class="p">})</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">: W=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;*&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">significant</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">exam1</span><span class="p">,</span> <span class="n">exam2</span><span class="p">,</span> <span class="n">exam3</span><span class="p">]</span>
<span class="n">group_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Exam1&#39;</span><span class="p">,</span> <span class="s1">&#39;Exam2&#39;</span><span class="p">,</span> <span class="s1">&#39;Exam3&#39;</span><span class="p">]</span>
<span class="n">nemenyi_results</span> <span class="o">=</span> <span class="n">nemenyi_posthoc</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">group_names</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-spearman-kendall">6. ë¹„ëª¨ìˆ˜ì  ìƒê´€ (Spearman, Kendall)<a class="header-link" href="#6-spearman-kendall" title="Permanent link">&para;</a></h2>
<h3 id="61-spearman">6.1 Spearman ìˆœìœ„ ìƒê´€<a class="header-link" href="#61-spearman" title="Permanent link">&para;</a></h3>
<p><strong>íŠ¹ì§•</strong>: ìˆœìœ„ ê¸°ë°˜, ë‹¨ì¡° ê´€ê³„ ì¸¡ì • (ì„ í˜•ì¼ í•„ìš” ì—†ìŒ)</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">spearman_correlation_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Spearman ìƒê´€ ì˜ˆì‹œ&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># ë¹„ì„ í˜• ê´€ê³„ ë°ì´í„°</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># ë¡œê·¸ ê´€ê³„ + ì¡ìŒ</span>

    <span class="c1"># Pearson ìƒê´€</span>
    <span class="n">pearson_r</span><span class="p">,</span> <span class="n">pearson_p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># Spearman ìƒê´€</span>
    <span class="n">spearman_r</span><span class="p">,</span> <span class="n">spearman_p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ìƒê´€ ë¶„ì„ ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pearson ìƒê´€: r=</span><span class="si">{</span><span class="n">pearson_r</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">pearson_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spearman ìƒê´€: Ï=</span><span class="si">{</span><span class="n">spearman_r</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">spearman_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë¹„ì„ í˜• ê´€ê³„ì—ì„œ Spearmanì´ ë” ì í•©&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># ì›ë³¸ ë°ì´í„°</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ì›ë³¸ ë°ì´í„°</span><span class="se">\n</span><span class="s1">Pearson r=</span><span class="si">{</span><span class="n">pearson_r</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, Spearman Ï=</span><span class="si">{</span><span class="n">spearman_r</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ìˆœìœ„ ë³€í™˜</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x_ranks</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rankdata</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y_ranks</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rankdata</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_ranks</span><span class="p">,</span> <span class="n">y_ranks</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X ìˆœìœ„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y ìˆœìœ„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆœìœ„ ë³€í™˜ í›„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ì´ìƒì¹˜ê°€ ìˆëŠ” ê²½ìš°</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x_outlier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">])</span>  <span class="c1"># ê·¹ë‹¨ì  ì´ìƒì¹˜</span>
    <span class="n">y_outlier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()])</span>

    <span class="n">pearson_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x_outlier</span><span class="p">,</span> <span class="n">y_outlier</span><span class="p">)</span>
    <span class="n">spearman_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x_outlier</span><span class="p">,</span> <span class="n">y_outlier</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_outlier</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_outlier</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì¼ë°˜ ë°ì´í„°&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_outlier</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_outlier</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì´ìƒì¹˜&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ì´ìƒì¹˜ í¬í•¨</span><span class="se">\n</span><span class="s1">Pearson=</span><span class="si">{</span><span class="n">pearson_out</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, Spearman=</span><span class="si">{</span><span class="n">spearman_out</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">spearman_correlation_example</span><span class="p">()</span>
</code></pre></div>

<h3 id="62-kendall">6.2 Kendall ìˆœìœ„ ìƒê´€<a class="header-link" href="#62-kendall" title="Permanent link">&para;</a></h3>
<p><strong>íŠ¹ì§•</strong>: ìŒë³„ ë¹„êµ ê¸°ë°˜, Spearmanë³´ë‹¤ ê°•ê±´</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kendall_correlation_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Kendall tau ìƒê´€ ì˜ˆì‹œ&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># ìˆœìœ„ ë°ì´í„° (ë¦¬ì»¤íŠ¸ ì²™ë„ ë“±)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">rater1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># 1~5ì </span>
    <span class="c1"># ì–´ëŠ ì •ë„ ì¼ì¹˜í•˜ì§€ë§Œ ì™„ì „íˆ ê°™ì§€ëŠ” ì•ŠìŒ</span>
    <span class="n">rater2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rater1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Pearson (ë¶€ì ì ˆ)</span>
    <span class="n">pearson_r</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">rater1</span><span class="p">,</span> <span class="n">rater2</span><span class="p">)</span>

    <span class="c1"># Spearman</span>
    <span class="n">spearman_r</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">rater1</span><span class="p">,</span> <span class="n">rater2</span><span class="p">)</span>

    <span class="c1"># Kendall</span>
    <span class="n">kendall_tau</span><span class="p">,</span> <span class="n">kendall_p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kendalltau</span><span class="p">(</span><span class="n">rater1</span><span class="p">,</span> <span class="n">rater2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ìˆœìœ„ ë°ì´í„° ìƒê´€ ë¶„ì„ ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í‰ê°€ì 1 ë¶„í¬: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">rater1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í‰ê°€ì 2 ë¶„í¬: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">rater2</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pearson r: </span><span class="si">{</span><span class="n">pearson_r</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (ìˆœìœ„ ë°ì´í„°ì— ë¶€ì ì ˆ)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spearman Ï: </span><span class="si">{</span><span class="n">spearman_r</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kendall Ï„: </span><span class="si">{</span><span class="n">kendall_tau</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">kendall_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í•´ì„:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Ï„ = 0: ì¼ì¹˜/ë¶ˆì¼ì¹˜ ìŒì´ ê· ë“±&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Ï„ = 1: ì™„ì „í•œ ìˆœìœ„ ì¼ì¹˜&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Ï„ = -1: ì™„ì „í•œ ì—­ìˆœìœ„&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># ì§€í„° ì¶”ê°€ (ê°™ì€ ì ìˆ˜ê°€ ê²¹ì¹˜ì§€ ì•Šê²Œ)</span>
    <span class="n">jitter1</span> <span class="o">=</span> <span class="n">rater1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">jitter2</span> <span class="o">=</span> <span class="n">rater2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">jitter1</span><span class="p">,</span> <span class="n">jitter2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì™„ì „ ì¼ì¹˜ì„ &#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;í‰ê°€ì 1&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;í‰ê°€ì 2&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;í‰ê°€ì ê°„ ì¼ì¹˜ë„</span><span class="se">\n</span><span class="s1">Kendall Ï„ = </span><span class="si">{</span><span class="n">kendall_tau</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">rater1</span><span class="p">,</span> <span class="n">rater2</span>

<span class="n">rater1</span><span class="p">,</span> <span class="n">rater2</span> <span class="o">=</span> <span class="n">kendall_correlation_example</span><span class="p">()</span>
</code></pre></div>

<h3 id="63">6.3 ìƒê´€ê³„ìˆ˜ ë¹„êµ<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_correlations</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì„¸ ê°€ì§€ ìƒê´€ê³„ìˆ˜ ë¹„êµ&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    =================================================</span>
<span class="s2">    ìƒê´€ê³„ìˆ˜ ë¹„êµ</span>
<span class="s2">    =================================================</span>

<span class="s2">    | íŠ¹ì„± | Pearson | Spearman | Kendall |</span>
<span class="s2">    |------|---------|----------|---------|</span>
<span class="s2">    | ê´€ê³„ | ì„ í˜• | ë‹¨ì¡° | ë‹¨ì¡° |</span>
<span class="s2">    | ë°ì´í„° | ì—°ì†í˜• | ìˆœì„œí˜•/ì—°ì†í˜• | ìˆœì„œí˜• |</span>
<span class="s2">    | ì´ìƒì¹˜ | ë¯¼ê° | ê°•ê±´ | ë§¤ìš° ê°•ê±´ |</span>
<span class="s2">    | ë™ë¥  ì²˜ë¦¬ | í•´ë‹¹ì—†ìŒ | í‰ê·  ìˆœìœ„ | ë³´ì • ê°€ëŠ¥ |</span>
<span class="s2">    | ê³„ì‚° | O(n) | O(n log n) | O(nÂ²) |</span>
<span class="s2">    | ë²”ìœ„ | [-1, 1] | [-1, 1] | [-1, 1] |</span>

<span class="s2">    ì„ íƒ ê¸°ì¤€:</span>
<span class="s2">    - ì—°ì†í˜• &amp; ì„ í˜• ê´€ê³„ â†’ Pearson</span>
<span class="s2">    - ë¹„ì •ê·œ/ì´ìƒì¹˜/ë¹„ì„ í˜• â†’ Spearman</span>
<span class="s2">    - ìˆœìœ„/ì„œì—´ ë°ì´í„° â†’ Kendall</span>
<span class="s2">    - ì‘ì€ í‘œë³¸ í¬ê¸° â†’ Kendall</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">compare_correlations</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7">7. ì‹¤ìŠµ ì˜ˆì œ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ì¢…í•© ë¹„ëª¨ìˆ˜ ë¶„ì„<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">comprehensive_nonparametric_analysis</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì¢…í•© ë¹„ëª¨ìˆ˜ ë¶„ì„ ìˆ˜í–‰</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    data_dict : dict</span>
<span class="sd">        {ê·¸ë£¹ëª…: ë°ì´í„°} í˜•íƒœ</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì¢…í•© ë¹„ëª¨ìˆ˜ ë¶„ì„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>

    <span class="n">groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">group_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">n_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>

    <span class="c1"># 1. ê¸°ìˆ  í†µê³„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[1] ê¸°ìˆ  í†µê³„&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">, ì¤‘ìœ„ìˆ˜=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;IQR=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="mi">75</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 2. ì •ê·œì„± ê²€ì •</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[2] ì •ê·œì„± ê²€ì • (Shapiro-Wilk)&quot;</span><span class="p">)</span>
    <span class="n">all_normal</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">is_normal</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">alpha</span>
        <span class="n">all_normal</span> <span class="o">=</span> <span class="n">all_normal</span> <span class="ow">and</span> <span class="n">is_normal</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;(ì •ê·œ)&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_normal</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;(ë¹„ì •ê·œ)&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 3. ì ì ˆí•œ ê²€ì • ì„ íƒ ë° ìˆ˜í–‰</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[3] ê·¸ë£¹ ë¹„êµ ê²€ì • (ê·¸ë£¹ ìˆ˜: </span><span class="si">{</span><span class="n">n_groups</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n_groups</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># ë‘ ê·¸ë£¹: Mann-Whitney U</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mann-Whitney U: U=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;Mann-Whitney U&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># ì„¸ ê·¸ë£¹ ì´ìƒ: Kruskal-Wallis</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span><span class="o">*</span><span class="n">groups</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Kruskal-Wallis H: H=</span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="s2">&quot;Kruskal-Wallis&quot;</span>

        <span class="c1"># ìœ ì˜í•˜ë©´ ì‚¬í›„ê²€ì •</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  ì‚¬í›„ê²€ì • (Bonferroni ë³´ì •):&quot;</span><span class="p">)</span>
            <span class="n">n_comp</span> <span class="o">=</span> <span class="n">n_groups</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_groups</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">adj_alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">n_comp</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_groups</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">ph_p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span> <span class="k">if</span> <span class="n">ph_p</span> <span class="o">&lt;</span> <span class="n">adj_alpha</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">group_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">: p=</span><span class="si">{</span><span class="n">ph_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sig</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 4. ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ë°•ìŠ¤í”Œë¡¯</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">group_names</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ê°’&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">test_name</span><span class="si">}</span><span class="s1"> ê²€ì •</span><span class="se">\n</span><span class="s1">p = </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># íˆìŠ¤í† ê·¸ë¨</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ê°’&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°€ë„&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¶„í¬ ë¹„êµ&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Control&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s1">&#39;Treatment A&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="mi">55</span><span class="p">,</span>
    <span class="s1">&#39;Treatment B&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span>
<span class="p">}</span>
<span class="n">comprehensive_nonparametric_analysis</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="1_1">ë¬¸ì œ 1: ê²€ì • ì„ íƒ<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ìƒí™©ì— ì í•©í•œ ë¹„ëª¨ìˆ˜ ê²€ì •ì„ ì„ íƒí•˜ì„¸ìš”:
1. ë‚¨ë…€ í•™ìƒì˜ ì‹œí—˜ ì ìˆ˜ ë¹„êµ (ì ìˆ˜ ë¶„í¬ê°€ í¸í¬)
2. 3ê°œ ë³‘ì›ì˜ ëŒ€ê¸° ì‹œê°„ ë¹„êµ
3. ë™ì¼ í™˜ìì˜ ì¹˜ë£Œ ì „í›„ í†µì¦ ì ìˆ˜ ë¹„êµ</p>
<h3 id="2-mann-whitney-u_1">ë¬¸ì œ 2: Mann-Whitney U<a class="header-link" href="#2-mann-whitney-u_1" title="Permanent link">&para;</a></h3>
<p>ë‘ ê·¸ë£¹ì˜ ë°ì´í„°ê°€ ì£¼ì–´ì¡Œì„ ë•Œ:
- Group A: [23, 28, 31, 35, 39, 42]
- Group B: [18, 22, 25, 29, 33]</p>
<p>ìˆ˜ë™ìœ¼ë¡œ U í†µê³„ëŸ‰ì„ ê³„ì‚°í•˜ê³  scipy ê²°ê³¼ì™€ ë¹„êµí•˜ì„¸ìš”.</p>
<h3 id="3">ë¬¸ì œ 3: ìƒê´€ ë¶„ì„<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>10ê°œì˜ ìˆœìœ„ ìŒ ë°ì´í„°ì— ëŒ€í•´:
1. Spearman ìƒê´€ê³„ìˆ˜ ê³„ì‚°
2. Kendall tau ê³„ì‚°
3. ë‘ ê³„ìˆ˜ì˜ ì°¨ì´ í•´ì„</p>
<h3 id="4-kruskal-wallis">ë¬¸ì œ 4: Kruskal-Wallis í›„ ì‚¬í›„ê²€ì •<a class="header-link" href="#4-kruskal-wallis" title="Permanent link">&para;</a></h3>
<p>4ê°œ ê·¸ë£¹ ë¹„êµì—ì„œ Kruskal-Wallisê°€ ìœ ì˜í•  ë•Œ:
1. í•„ìš”í•œ ì‚¬í›„ê²€ì • ë¹„êµ íšŸìˆ˜
2. Bonferroni ë³´ì •ëœ ìœ ì˜ìˆ˜ì¤€
3. ì–´ë–¤ ìŒì´ ìœ ì˜í•˜ê²Œ ë‹¤ë¥¸ì§€ íŒë‹¨</p>
<hr />
<h2 id="9">9. í•µì‹¬ ìš”ì•½<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="_2">ê²€ì • ì„ íƒ í”Œë¡œìš°ì°¨íŠ¸<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ë°ì´í„° ìœ í˜• í™•ì¸
    â”‚
    â”œâ”€â”€ ì •ê·œì„± ë§Œì¡±? â”€â”€â”€â”¬â”€â”€ Yes â†’ ëª¨ìˆ˜ì  ê²€ì •
    â”‚                   â””â”€â”€ No â†’ ë¹„ëª¨ìˆ˜ ê²€ì •
    â”‚
ë¹„ëª¨ìˆ˜ ê²€ì • ì„ íƒ:
    â”‚
    â”œâ”€â”€ 2 ë…ë¦½ ê·¸ë£¹ â†’ Mann-Whitney U
    â”‚
    â”œâ”€â”€ 2 ëŒ€ì‘ ê·¸ë£¹ â†’ Wilcoxon ë¶€í˜¸ìˆœìœ„
    â”‚
    â”œâ”€â”€ 3+ ë…ë¦½ ê·¸ë£¹ â†’ Kruskal-Wallis H â†’ ì‚¬í›„: Dunn
    â”‚
    â”œâ”€â”€ 3+ ëŒ€ì‘ ê·¸ë£¹ â†’ Friedman â†’ ì‚¬í›„: Nemenyi
    â”‚
    â””â”€â”€ ìƒê´€ â†’ Spearman (ì—°ì†) / Kendall (ìˆœìœ„)
</code></pre></div>

<h3 id="scipystats">scipy.stats í•¨ìˆ˜<a class="header-link" href="#scipystats" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê²€ì •</th>
<th>í•¨ìˆ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mann-Whitney U</td>
<td><code>mannwhitneyu(x, y)</code></td>
</tr>
<tr>
<td>Wilcoxon</td>
<td><code>wilcoxon(x, y)</code></td>
</tr>
<tr>
<td>Kruskal-Wallis</td>
<td><code>kruskal(g1, g2, g3, ...)</code></td>
</tr>
<tr>
<td>Friedman</td>
<td><code>friedmanchisquare(g1, g2, g3, ...)</code></td>
</tr>
<tr>
<td>Spearman</td>
<td><code>spearmanr(x, y)</code></td>
</tr>
<tr>
<td>Kendall</td>
<td><code>kendalltau(x, y)</code></td>
</tr>
</tbody>
</table>
<h3 id="_3">íš¨ê³¼ í¬ê¸° í•´ì„<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê²€ì •</th>
<th>íš¨ê³¼ í¬ê¸°</th>
<th>ì‘ìŒ</th>
<th>ì¤‘ê°„</th>
<th>í¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mann-Whitney</td>
<td>rank-biserial r</td>
<td>0.1</td>
<td>0.3</td>
<td>0.5</td>
</tr>
<tr>
<td>Kruskal-Wallis</td>
<td>Î·Â²</td>
<td>0.01</td>
<td>0.06</td>
<td>0.14</td>
</tr>
<tr>
<td>Friedman</td>
<td>Kendall's W</td>
<td>0.1</td>
<td>0.3</td>
<td>0.5</td>
</tr>
</tbody>
</table>
<h3 id="_4">ë‹¤ìŒ ì¥ ë¯¸ë¦¬ë³´ê¸°<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<p>14ì¥ <strong>ì‹¤í—˜ ì„¤ê³„</strong>ì—ì„œëŠ”:
- ì‹¤í—˜ ì„¤ê³„ì˜ ê¸°ë³¸ ì›ë¦¬
- A/B í…ŒìŠ¤íŠ¸
- í‘œë³¸ í¬ê¸° ê²°ì • (ê²€ì •ë ¥ ë¶„ì„)
- ìˆœì°¨ì  ê²€ì •</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Data_Science/22_Multivariate_Analysis.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">22. ë‹¤ë³€ëŸ‰ ë¶„ì„ (Multivariate Analysis)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Data_Science/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Data_Science/24_Experimental_Design.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">24. ì‹¤í—˜ ì„¤ê³„ (Experimental Design)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}