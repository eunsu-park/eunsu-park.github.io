{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관계형 모델(The Relational Model) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Database_Theory/">Database Theory</a>
    <span class="separator">/</span>
    <span class="current">관계형 모델(The Relational Model)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>관계형 모델(The Relational Model)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Database_Theory/01_Introduction_to_Database_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">데이터베이스 시스템 소개(Introduction to Database Systems)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Database_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Database_Theory/03_Relational_Algebra.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">관계 대수(Relational Algebra)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#table-of-contents">목차(Table of Contents)</a></li>
<li><a href="#1-codd">1. 역사적 맥락: Codd의 비전</a><ul>
<li><a href="#codd">Codd가 해결한 문제</a></li>
<li><a href="#codd_1">Codd의 핵심 통찰</a></li>
</ul>
</li>
<li><a href="#2-codd-12">2. Codd의 12가지 규칙</a><ul>
<li><a href="#0">규칙 0: 기초 규칙</a></li>
<li><a href="#12">12가지 규칙</a></li>
<li><a href="#_1">실제 평가</a></li>
</ul>
</li>
<li><a href="#3">3. 형식적 정의</a><ul>
<li><a href="#domain">도메인(Domain)</a></li>
<li><a href="#relation-schema">관계 스키마(Relation Schema)</a></li>
<li><a href="#relation-instance">관계(Relation, Instance)</a></li>
<li><a href="#_2">형식적 예</a></li>
<li><a href="#_3">관계의 속성</a></li>
<li><a href="#vs">관계 vs. 테이블</a></li>
<li><a href="#sql">SQL의 속성 타입 및 도메인</a></li>
</ul>
</li>
<li><a href="#4-keys">4. 키(Keys)</a><ul>
<li><a href="#superkey">슈퍼키(Superkey)</a></li>
<li><a href="#candidate-key">후보키(Candidate Key)</a></li>
<li><a href="#primary-key">기본키(Primary Key)</a></li>
<li><a href="#foreign-key">외래키(Foreign Key)</a></li>
<li><a href="#composite-key">복합키(Composite Key)</a></li>
<li><a href="#vs_1">대리키 vs. 자연키</a></li>
<li><a href="#_4">키 타입 요약</a></li>
</ul>
</li>
<li><a href="#5">5. 무결성 제약조건</a><ul>
<li><a href="#_5">도메인 제약조건</a></li>
<li><a href="#_6">엔티티 무결성 제약조건</a></li>
<li><a href="#_7">참조 무결성 제약조건</a></li>
<li><a href="#_8">참조 무결성 동작</a></li>
<li><a href="#_9">참조 무결성 동작 예</a></li>
<li><a href="#_10">키 제약조건</a></li>
<li><a href="#_11">일반 제약조건 (의미론적 제약조건)</a></li>
<li><a href="#_12">제약조건 요약</a></li>
</ul>
</li>
<li><a href="#6">6. 관계형 스키마 표기법</a><ul>
<li><a href="#_13">텍스트 표기법</a></li>
<li><a href="#_14">밑줄 규약</a></li>
<li><a href="#_15">다이어그램 표기법</a></li>
<li><a href="#sql-ddl">스키마 정의로서의 SQL DDL</a></li>
</ul>
</li>
<li><a href="#7-null-3">7. NULL 의미와 3치 논리</a><ul>
<li><a href="#null">NULL이 나타내는 것</a></li>
<li><a href="#3-three-valued-logic-3vl">3치 논리(Three-Valued Logic, 3VL)</a></li>
<li><a href="#3vl">3VL에 대한 진리표</a></li>
<li><a href="#sql_1">SQL 쿼리에 대한 함의</a></li>
<li><a href="#null_1">집계에서의 NULL</a></li>
<li><a href="#null_2">불린 표현식에서의 NULL</a></li>
<li><a href="#distinct-group-by-null">DISTINCT 및 GROUP BY에서의 NULL</a></li>
<li><a href="#null_3">조인에서의 NULL</a></li>
<li><a href="#coalesce-nullif">COALESCE 및 NULLIF</a></li>
<li><a href="#null_4">NULL에 대한 모범 사례</a></li>
</ul>
</li>
<li><a href="#8">8. 실제 관계형 모델</a><ul>
<li><a href="#python">관계형 개념의 Python 구현</a></li>
<li><a href="#_16">일반적인 관계형 모델 오해</a></li>
</ul>
</li>
<li><a href="#9">9. 연습문제</a><ul>
<li><a href="#_17">개념적 질문</a></li>
<li><a href="#_18">스키마 설계 질문</a></li>
<li><a href="#sql-null">SQL 및 NULL 질문</a></li>
<li><a href="#_19">설계 연습</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="the-relational-model">관계형 모델(The Relational Model)<a class="header-link" href="#the-relational-model" title="Permanent link">&para;</a></h1>
<p><strong>이전</strong>: <a href="./01_Introduction_to_Database_Systems.md">데이터베이스 시스템 소개</a> | <strong>다음</strong>: <a href="./03_Relational_Algebra.md">관계 대수</a></p>
<hr />
<p>Edgar F. Codd가 1970년에 도입한 관계형 모델은 가장 널리 사용되는 데이터 모델이며 SQL 데이터베이스의 이론적 기반입니다. 이 모델은 데이터를 수학적 관계(테이블)로 표현하고 구조 정의, 무결성 강제, 데이터 조작을 위한 엄격한 프레임워크를 제공합니다. 이 레슨에서는 모든 데이터베이스 실무자가 이해해야 하는 형식적 정의, 핵심 개념, 무결성 제약조건, NULL의 미묘한 의미를 다룹니다.</p>
<h2 id="table-of-contents">목차(Table of Contents)<a class="header-link" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-historical-context-codds-vision">역사적 맥락: Codd의 비전</a></li>
<li><a href="#2-codds-12-rules">Codd의 12가지 규칙</a></li>
<li><a href="#3-formal-definitions">형식적 정의</a></li>
<li><a href="#4-keys">키</a></li>
<li><a href="#5-integrity-constraints">무결성 제약조건</a></li>
<li><a href="#6-relational-schema-notation">관계형 스키마 표기법</a></li>
<li><a href="#7-null-semantics-and-three-valued-logic">NULL 의미와 3치 논리</a></li>
<li><a href="#8-relational-model-in-practice">실제 관계형 모델</a></li>
<li><a href="#9-exercises">연습문제</a></li>
</ol>
<hr />
<h2 id="1-codd">1. 역사적 맥락: Codd의 비전<a class="header-link" href="#1-codd" title="Permanent link">&para;</a></h2>
<p>1970년, IBM San Jose Research Laboratory의 연구원 Edgar F. Codd는 Communications of the ACM에 "A Relational Model of Data for Large Shared Data Banks"를 발표했습니다. 이 논문은 데이터 관리에 대한 우리의 사고방식을 근본적으로 변화시켰습니다.</p>
<h3 id="codd">Codd가 해결한 문제<a class="header-link" href="#codd" title="Permanent link">&para;</a></h3>
<p>관계형 모델 이전에는 두 가지 지배적인 접근법이 있었습니다:</p>
<div class="highlight"><pre><span></span><code>계층 모델(IMS):              네트워크 모델(CODASYL):

     ROOT                          STUDENT ──── COURSE
    /    \                            │    \  /     │
  CHILD1  CHILD2                      │     \/      │
    |                                 │     /\      │
  CHILD3                              │    /  \     │
                                      ▼   /    \    ▼
                                   ADVISOR    ENROLLMENT

둘 다 다음을 요구했습니다:
  - 포인터 체인을 통한 탐색 프로그램
  - 물리적 데이터 레이아웃에 대한 지식
  - 구조 변경 시 코드 재작성
</code></pre></div>

<h3 id="codd_1">Codd의 핵심 통찰<a class="header-link" href="#codd_1" title="Permanent link">&para;</a></h3>
<p>Codd는 데이터를 <strong>관계(relations)</strong>(수학적 개념)로 표현할 것을 제안했으며, 이는 테이블에 해당합니다:</p>
<div class="highlight"><pre><span></span><code><span class="err">대신</span><span class="o">:</span><span class="w">                             </span><span class="err">사용</span><span class="o">:</span>
<span class="w">  </span><span class="s2">&quot;STUDENT 레코드에서              &quot;</span><span class="n">SELECT</span><span class="w"> </span><span class="n">student_name</span>
<span class="w">   </span><span class="err">등록</span><span class="w"> </span><span class="err">체인을</span><span class="w"> </span><span class="err">따라</span><span class="w">                 </span><span class="n">FROM</span><span class="w"> </span><span class="n">students</span>
<span class="w">   </span><span class="err">과목</span><span class="w"> </span><span class="err">이름</span><span class="w"> </span><span class="err">찾기</span><span class="s2">&quot;                  JOIN courses</span>
<span class="s2">                                     ON students.id = enrollments.student_id</span>
<span class="s2">                                     WHERE course_name = &#39;Database Theory&#39;&quot;</span>

<span class="w">  </span><span class="err">방법</span><span class="o">(</span><span class="n">HOW</span><span class="o">)</span><span class="err">을</span><span class="w"> </span><span class="err">탐색</span><span class="w">                  </span><span class="err">무엇</span><span class="o">(</span><span class="n">WHAT</span><span class="o">)</span><span class="err">을</span><span class="w"> </span><span class="err">선언</span>
<span class="w">  </span><span class="o">(</span><span class="err">절차적</span><span class="o">)</span><span class="w">                          </span><span class="o">(</span><span class="err">선언적</span><span class="o">)</span>
</code></pre></div>

<p>이러한 <strong>절차적 탐색</strong>에서 <strong>선언적 명세</strong>로의 전환은 혁명적이었습니다.</p>
<hr />
<h2 id="2-codd-12">2. Codd의 12가지 규칙<a class="header-link" href="#2-codd-12" title="Permanent link">&para;</a></h2>
<p>1985년, Codd는 데이터베이스 관리 시스템이 진정으로 "관계형"이기 위해 필요한 것을 정의하는 12개의 규칙 (실제로는 0-12로 번호가 매겨진 13개)을 발표했습니다. 이러한 규칙은 RDBMS 구현을 평가하는 벤치마크 역할을 합니다.</p>
<h3 id="0">규칙 0: 기초 규칙<a class="header-link" href="#0" title="Permanent link">&para;</a></h3>
<blockquote>
<p>관계형 DBMS는 관계형 기능만을 사용하여 저장된 데이터를 관리해야 합니다.</p>
</blockquote>
<h3 id="12">12가지 규칙<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>규칙 이름</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>정보 규칙(Information Rule)</strong></td>
<td>모든 데이터는 테이블(관계)의 값으로 표현됩니다. 여기에는 메타데이터(시스템 카탈로그)도 포함됩니다.</td>
</tr>
<tr>
<td>2</td>
<td><strong>보장된 접근 규칙(Guaranteed Access Rule)</strong></td>
<td>모든 데이터는 테이블 이름, 열 이름, 기본 키 값을 지정하여 접근 가능합니다. 포인터가 필요하지 않습니다.</td>
</tr>
<tr>
<td>3</td>
<td><strong>NULL의 체계적 처리(Systematic Treatment of NULL)</strong></td>
<td>NULL은 누락되거나 적용 불가능한 데이터를 나타내며, 빈 문자열이나 0과 구별됩니다. 모든 데이터 타입에 대해 지원됩니다.</td>
</tr>
<tr>
<td>4</td>
<td><strong>동적 온라인 카탈로그(Dynamic Online Catalog)</strong></td>
<td>데이터베이스 설명(메타데이터)은 테이블에 저장되고 사용자 데이터와 동일한 관계형 언어를 사용하여 쿼리 가능합니다.</td>
</tr>
<tr>
<td>5</td>
<td><strong>포괄적 데이터 부속어(Comprehensive Data Sublanguage)</strong></td>
<td>최소한 하나의 언어가 데이터 정의, 조작, 무결성 제약조건, 권한 부여, 트랜잭션을 지원해야 합니다. (SQL이 이를 충족합니다.)</td>
</tr>
<tr>
<td>6</td>
<td><strong>뷰 업데이트 규칙(View Updating Rule)</strong></td>
<td>이론적으로 업데이트 가능한 모든 뷰는 시스템에 의해 업데이트 가능해야 합니다.</td>
</tr>
<tr>
<td>7</td>
<td><strong>고수준 삽입, 업데이트, 삭제(High-Level Insert, Update, Delete)</strong></td>
<td>집합 단위 연산 (행 단위만이 아님). 단일 문에서 여러 행을 삽입, 업데이트 또는 삭제할 수 있습니다.</td>
</tr>
<tr>
<td>8</td>
<td><strong>물리적 데이터 독립성(Physical Data Independence)</strong></td>
<td>물리적 저장이나 접근 방법의 변경이 애플리케이션에 영향을 주지 않습니다.</td>
</tr>
<tr>
<td>9</td>
<td><strong>논리적 데이터 독립성(Logical Data Independence)</strong></td>
<td>정보를 보존하는 개념 스키마의 변경이 애플리케이션에 영향을 주지 않습니다.</td>
</tr>
<tr>
<td>10</td>
<td><strong>무결성 독립성(Integrity Independence)</strong></td>
<td>무결성 제약조건은 카탈로그에 정의되며 (애플리케이션 프로그램이 아님) 애플리케이션에 영향을 주지 않고 변경될 수 있습니다.</td>
</tr>
<tr>
<td>11</td>
<td><strong>분산 독립성(Distribution Independence)</strong></td>
<td>데이터가 중앙집중식이든 분산되어 있든 애플리케이션은 동일하게 작동합니다.</td>
</tr>
<tr>
<td>12</td>
<td><strong>비전복 규칙(Nonsubversion Rule)</strong></td>
<td>시스템이 저수준(레코드 단위) 인터페이스를 제공하는 경우, 관계형 무결성 제약조건을 우회하는 데 사용될 수 없습니다.</td>
</tr>
</tbody>
</table>
<h3 id="_1">실제 평가<a class="header-link" href="#_1" title="Permanent link">&para;</a></h3>
<p>어떤 상용 RDBMS도 12가지 규칙을 완전히 만족하지 않습니다. 다음은 대략적인 평가입니다:</p>
<div class="highlight"><pre><span></span><code>규칙 준수 (대략):

                    PostgreSQL  MySQL   Oracle  SQLite
규칙 1 (Info)          ✓         ✓       ✓       ✓
규칙 2 (Access)        ✓         ✓       ✓       ✓
규칙 3 (NULL)          ✓         ✓       ✓       ~
규칙 4 (Catalog)       ✓         ✓       ✓       ~
규칙 5 (Language)      ✓         ✓       ✓       ✓
규칙 6 (View Update)   ~         ~       ~       ~
규칙 7 (Set Ops)       ✓         ✓       ✓       ✓
규칙 8 (Physical DI)   ✓         ✓       ✓       ~
규칙 9 (Logical DI)    ~         ~       ~       ~
규칙 10 (Integrity)    ✓         ~       ✓       ~
규칙 11 (Distribution) ~         ~       ~       ✗
규칙 12 (Nonsub.)      ✓         ~       ✓       ~

✓ = 대체로 준수  ~ = 부분적  ✗ = 미지원
</code></pre></div>

<hr />
<h2 id="3">3. 형식적 정의<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<p>관계형 모델은 집합론과 1차 술어 논리에 기반을 두고 있습니다. 형식적 정의를 이해하는 것은 데이터베이스 설계와 쿼리 작성에 필수적입니다.</p>
<h3 id="domain">도메인(Domain)<a class="header-link" href="#domain" title="Permanent link">&para;</a></h3>
<p><strong>도메인(Domain)</strong> D는 원자적(나눌 수 없는) 값의 집합입니다. 각 도메인은 논리적 정의(값이 의미하는 것)와 데이터 타입을 가집니다.</p>
<div class="highlight"><pre><span></span><code>도메인의 예:

D_StudentID  = {S001, S002, S003, ..., S999}
D_Name       = 길이 &lt;= 50인 모든 문자열의 집합
D_GPA        = {x in R | 0.0 &lt;= x &lt;= 4.0}
D_Grade      = {A+, A, A-, B+, B, B-, C+, C, C-, D+, D, F}
D_Credits    = {1, 2, 3, 4, 5}
D_Boolean    = {TRUE, FALSE}
D_Date       = 모든 유효한 달력 날짜의 집합
</code></pre></div>

<h3 id="relation-schema">관계 스키마(Relation Schema)<a class="header-link" href="#relation-schema" title="Permanent link">&para;</a></h3>
<p><strong>관계 스키마(Relation schema)</strong> R(A1, A2, ..., An)는 다음으로 구성됩니다:
- 관계 이름 R
- 속성 목록 A1, A2, ..., An
- 각 속성 Ai는 도메인 dom(Ai)을 가짐</p>
<div class="highlight"><pre><span></span><code>형식 표기법:

  R(A1: D1, A2: D2, ..., An: Dn)

예:

  STUDENT(student_id: D_StudentID,
          name: D_Name,
          gpa: D_GPA)
</code></pre></div>

<p>관계의 <strong>차수(degree)</strong> (또는 원수, arity)는 속성 개수 n입니다.</p>
<h3 id="relation-instance">관계(Relation, Instance)<a class="header-link" href="#relation-instance" title="Permanent link">&para;</a></h3>
<p>관계 스키마 R(A1, A2, ..., An)의 <strong>관계(relation)</strong> r은 n-튜플의 집합입니다:</p>
<div class="highlight"><pre><span></span><code>r(R) ⊆ dom(A1) × dom(A2) × ... × dom(An)
</code></pre></div>

<p>각 n-튜플 t는 순서가 있는 값의 목록입니다:</p>
<div class="highlight"><pre><span></span><code>t = &lt;v1, v2, ..., vn&gt;   where vi ∈ dom(Ai) ∪ {NULL}
</code></pre></div>

<h3 id="_2">형식적 예<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">스키마</span><span class="o">:</span>
<span class="w">  </span><span class="n">STUDENT</span><span class="o">(</span><span class="n">student_id</span><span class="o">:</span><span class="w"> </span><span class="n">D_StudentID</span><span class="o">,</span><span class="w"> </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">D_Name</span><span class="o">,</span><span class="w"> </span><span class="n">year</span><span class="o">:</span><span class="w"> </span><span class="n">D_Year</span><span class="o">,</span><span class="w"> </span><span class="n">gpa</span><span class="o">:</span><span class="w"> </span><span class="n">D_GPA</span><span class="o">)</span>

<span class="w">  </span><span class="n">where</span><span class="w"> </span><span class="n">D_StudentID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">S001</span><span class="o">..</span><span class="n">S999</span><span class="o">}</span>
<span class="w">        </span><span class="n">D_Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">길이</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">50</span><span class="err">인</span><span class="w"> </span><span class="err">문자열</span>
<span class="w">        </span><span class="n">D_Year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">}</span>
<span class="w">        </span><span class="n">D_GPA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">x</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="err">≤</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="err">≤</span><span class="w"> </span><span class="mf">4.0</span><span class="o">}</span>

<span class="err">인스턴스</span><span class="w"> </span><span class="o">(</span><span class="err">시간</span><span class="w"> </span><span class="n">t에서</span><span class="o">):</span>
<span class="w">  </span><span class="n">r</span><span class="o">(</span><span class="n">STUDENT</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S001</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Alice Kim&quot;</span><span class="o">,</span><span class="w">  </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mf">3.85</span><span class="o">&gt;,</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S002</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Bob Park&quot;</span><span class="o">,</span><span class="w">   </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mf">3.42</span><span class="o">&gt;,</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S003</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Carol Lee&quot;</span><span class="o">,</span><span class="w">  </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mf">3.91</span><span class="o">&gt;,</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">S004</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;Dave Choi&quot;</span><span class="o">,</span><span class="w">  </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">NULL</span><span class="o">&gt;</span>
<span class="w">  </span><span class="o">}</span>

<span class="w">  </span><span class="err">차수</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="err">카디널리티</span><span class="o">(</span><span class="err">튜플</span><span class="w"> </span><span class="err">개수</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
</code></pre></div>

<h3 id="_3">관계의 속성<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>속성</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>중복 튜플 없음(No duplicate tuples)</strong></td>
<td>관계는 집합이므로, 두 개의 튜플이 동일할 수 없음</td>
</tr>
<tr>
<td><strong>튜플은 순서가 없음(Tuples are unordered)</strong></td>
<td>행의 고유한 순서가 없음</td>
</tr>
<tr>
<td><strong>속성은 순서가 없음(Attributes are unordered)</strong></td>
<td>열의 순서는 중요하지 않음 (SQL 구현은 일반적으로 선언 순서를 보존)</td>
</tr>
<tr>
<td><strong>속성 값은 원자적(Attribute values are atomic)</strong></td>
<td>각 셀은 단일하고 나눌 수 없는 값을 포함 (제1정규형)</td>
</tr>
<tr>
<td><strong>각 속성은 고유한 이름을 가짐(Each attribute has a distinct name)</strong></td>
<td>동일한 관계에서 두 개의 속성이 이름을 공유할 수 없음</td>
</tr>
</tbody>
</table>
<h3 id="vs">관계 vs. 테이블<a class="header-link" href="#vs" title="Permanent link">&para;</a></h3>
<p>종종 서로 교환하여 사용되지만, 미묘한 차이가 있습니다:</p>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────┬────────────────────────────────┐
│     관계 (이론)              │        테이블 (SQL)             │
├─────────────────────────────┼────────────────────────────────┤
│ 튜플의 집합 (중복 없음)       │ 행의 다중집합 (중복 허용)        │
│ 튜플은 순서가 없음           │ 행은 물리적 순서를 가질 수 있음   │
│ 속성은 순서가 없음           │ 열은 선언된 순서를 가짐          │
│ 모든 값은 원자적             │ 일부에서 배열, JSON 허용         │
│ 명명된 관점만               │ 위치 접근 가능                   │
│ 도메인 기반 타이핑           │ SQL 데이터 타입                  │
└─────────────────────────────┴────────────────────────────────┘

SQL 테이블은 엄격하게 관계가 아닙니다. 왜냐하면:
  1. SQL은 중복 행을 허용합니다 (제약되지 않는 한)
  2. SQL은 열 순서를 보존합니다
  3. SQL은 추가 기능을 가집니다 (auto-increment 등)
</code></pre></div>

<h3 id="sql">SQL의 속성 타입 및 도메인<a class="header-link" href="#sql" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- 수학적 도메인을 SQL 타입으로 매핑</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">grade_domain</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">VALUE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;A+&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;A-&#39;</span><span class="p">,</span><span class="s1">&#39;B+&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;B-&#39;</span><span class="p">,</span><span class="s1">&#39;C+&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;C-&#39;</span><span class="p">,</span><span class="s1">&#39;D+&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">));</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">gpa_domain</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">VALUE</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">VALUE</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">        </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- D_StudentID</span>
<span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">    </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- D_Name</span>
<span class="w">    </span><span class="k">year</span><span class="w">        </span><span class="nb">SMALLINT</span><span class="w">       </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- D_Year</span>
<span class="w">    </span><span class="n">gpa</span><span class="w">         </span><span class="n">gpa_domain</span><span class="p">,</span><span class="w">               </span><span class="c1">-- D_GPA (도메인 사용)</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">pk_student</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">ck_year</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<p>참고: <code>CREATE DOMAIN</code> 구문은 PostgreSQL에서 지원되지만 모든 RDBMS에서 지원되지는 않습니다.</p>
<hr />
<h2 id="4-keys">4. 키(Keys)<a class="header-link" href="#4-keys" title="Permanent link">&para;</a></h2>
<p>키는 관계형 모델의 기본입니다. 튜플을 고유하게 식별하고 관계 간 관계를 설정하는 메커니즘을 제공합니다.</p>
<h3 id="superkey">슈퍼키(Superkey)<a class="header-link" href="#superkey" title="Permanent link">&para;</a></h3>
<p>관계 스키마 R의 <strong>슈퍼키(superkey)</strong>는 속성 집합 SK ⊆ R로, 유효한 관계 인스턴스 r(R)의 어떤 두 튜플도 SK에 대해 동일한 값을 가지지 않습니다.</p>
<p>형식적으로: r(R)의 임의의 두 개의 서로 다른 튜플 t1, t2에 대해:</p>
<div class="highlight"><pre><span></span><code><span class="n">t1</span><span class="o">[</span><span class="n">SK</span><span class="o">]</span><span class="w"> </span><span class="err">≠</span><span class="w"> </span><span class="n">t2</span><span class="o">[</span><span class="n">SK</span><span class="o">]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>STUDENT(student_id, name, year, gpa)

STUDENT의 슈퍼키:
  {student_id}                          ← 최소
  {student_id, name}                    ← 최소가 아님 (student_id만으로 충분)
  {student_id, name, year}              ← 최소가 아님
  {student_id, name, year, gpa}         ← 자명한 슈퍼키 (모든 속성)
  {name, year}                          ← 고유한 경우 슈퍼키일 수 있음

참고: 모든 속성의 집합은 항상 슈퍼키입니다 (자명한 슈퍼키).
</code></pre></div>

<h3 id="candidate-key">후보키(Candidate Key)<a class="header-link" href="#candidate-key" title="Permanent link">&para;</a></h3>
<p><strong>후보키(candidate key)</strong>는 <strong>최소 슈퍼키(minimal superkey)</strong>입니다 -- 고유성 속성을 잃지 않고 어떤 속성도 제거할 수 없는 슈퍼키입니다.</p>
<div class="highlight"><pre><span></span><code>형식 정의:
  R의 슈퍼키 K는 K의 모든 진부분집합 K&#39; ⊂ K에 대해,
  K&#39;가 R의 슈퍼키가 아닐 때 후보키입니다.

예:
  ENROLLMENT(student_id, course_id, semester, grade)

  슈퍼키:
    {student_id, course_id, semester}             ← 최소 → 후보키
    {student_id, course_id, semester, grade}      ← 최소가 아님

  (name, year)가 STUDENT에 대해 고유하다고 가정하면:
    {name, year}는 또 다른 후보키입니다

  관계는 여러 개의 후보키를 가질 수 있습니다.
</code></pre></div>

<h3 id="primary-key">기본키(Primary Key)<a class="header-link" href="#primary-key" title="Permanent link">&para;</a></h3>
<p><strong>기본키(primary key)</strong>는 데이터베이스 설계자가 튜플의 주요 식별자로 선택한 후보키입니다. 스키마 표기법에서 밑줄로 표시됩니다.</p>
<div class="highlight"><pre><span></span><code>규약:
  <span class="k">-</span> 기본키 속성에 밑줄 표시
  <span class="k">-</span> 기본키 값은 NULL일 수 없음
  <span class="k">-</span> 각 관계는 정확히 하나의 기본키를 가짐
  <span class="k">-</span> 다른 후보키는 대체키(ALTERNATE KEYS)가 됨

  STUDENT(student_id, name, year, gpa)
         ^^^^^^^^^^
         기본키

  {student_id}와 {name, year} 둘 다 후보키인 경우:
    기본키: {student_id}       (설계자가 선택)
    대체키: {name, year}       (다른 후보키)
</code></pre></div>

<h3 id="foreign-key">외래키(Foreign Key)<a class="header-link" href="#foreign-key" title="Permanent link">&para;</a></h3>
<p><strong>외래키(foreign key)</strong>는 한 관계에서 다른 (또는 동일한) 관계의 기본키를 참조하는 속성 집합입니다.</p>
<div class="highlight"><pre><span></span><code>형식 정의:
  관계 R1의 속성 집합 FK는 다음 조건을 만족할 때
  관계 R2를 참조하는 외래키입니다:
    1. FK의 속성이 R2의 기본키 PK와 동일한 도메인을 가짐
    2. r(R1)의 튜플 t1에서 FK의 값이:
       (a) r(R2)의 어떤 튜플 t2의 PK 값으로 나타나거나, 또는
       (b) NULL (허용되는 경우)

예:
  STUDENT(student_id, name, year, gpa)
  COURSE(course_id, title, credits)
  ENROLLMENT(student_id, course_id, semester, grade)
             ^^^^^^^^^^  ^^^^^^^^^
             FK → STUDENT  FK → COURSE

다이어그램으로:

  STUDENT                    ENROLLMENT                    COURSE
  ┌───────────┐             ┌───────────────┐             ┌───────────┐
  │student_id │◄────────────│student_id (FK)│             │course_id  │
  │name       │             │course_id  (FK)│────────────►│title      │
  │year       │             │semester       │             │credits    │
  │gpa        │             │grade          │             └───────────┘
  └───────────┘             └───────────────┘
</code></pre></div>

<h3 id="composite-key">복합키(Composite Key)<a class="header-link" href="#composite-key" title="Permanent link">&para;</a></h3>
<p>여러 속성으로 구성된 키:</p>
<div class="highlight"><pre><span></span><code>ENROLLMENT(student_id, course_id, semester, grade)

기본키: {student_id, course_id, semester}
  <span class="k">-</span> 세 개의 속성으로 구성된 복합키
  <span class="k">-</span> student_id만으로는 충분하지 않음 (학생이 여러 과목 수강)
  <span class="k">-</span> (student_id, course_id)만으로는 충분하지 않음
    (학생이 다른 학기에 과목을 재수강할 수 있음)
</code></pre></div>

<h3 id="vs_1">대리키 vs. 자연키<a class="header-link" href="#vs_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">자연키</span><span class="o">:</span><span class="w">                        </span><span class="err">대리키</span><span class="o">:</span>
<span class="w">  </span><span class="err">실제</span><span class="w"> </span><span class="err">데이터</span><span class="w"> </span><span class="err">사용</span><span class="w">                </span><span class="err">시스템</span><span class="w"> </span><span class="err">생성</span><span class="w"> </span><span class="err">값</span><span class="w"> </span><span class="err">사용</span>

<span class="w">  </span><span class="n">STUDENT</span><span class="o">(</span><span class="n">ssn</span><span class="o">,</span><span class="w"> </span><span class="n">name</span><span class="o">,</span><span class="w"> </span><span class="o">...)</span><span class="w">            </span><span class="n">STUDENT</span><span class="o">(</span><span class="n">student_id</span><span class="o">,</span><span class="w"> </span><span class="n">ssn</span><span class="o">,</span><span class="w"> </span><span class="n">name</span><span class="o">,</span><span class="w"> </span><span class="o">...)</span>
<span class="w">          </span><span class="o">^^^</span><span class="w">                                 </span><span class="o">^^^^^^^^^^</span>
<span class="w">          </span><span class="err">자연</span><span class="w"> </span><span class="n">PK</span><span class="w">                             </span><span class="err">대리</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="o">(</span><span class="n">auto</span><span class="o">-</span><span class="n">increment</span><span class="o">)</span>

<span class="err">자연키의</span><span class="w"> </span><span class="err">장점</span><span class="o">:</span><span class="w">                   </span><span class="err">대리키의</span><span class="w"> </span><span class="err">장점</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">의미</span><span class="w"> </span><span class="err">있음</span><span class="w">                      </span><span class="o">-</span><span class="w"> </span><span class="err">간결함</span><span class="w"> </span><span class="o">(</span><span class="err">정수</span><span class="o">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">추가</span><span class="w"> </span><span class="err">열</span><span class="w"> </span><span class="err">불필요</span><span class="w">                 </span><span class="o">-</span><span class="w"> </span><span class="err">불변</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">이미</span><span class="w"> </span><span class="err">고유함</span><span class="w">                    </span><span class="o">-</span><span class="w"> </span><span class="err">비즈니스</span><span class="w"> </span><span class="err">의미</span><span class="w"> </span><span class="err">변경</span><span class="w"> </span><span class="err">없음</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">자체</span><span class="w"> </span><span class="err">문서화</span><span class="w">                    </span><span class="o">-</span><span class="w"> </span><span class="err">간단한</span><span class="w"> </span><span class="err">조인</span>

<span class="err">단점</span><span class="o">:</span><span class="w">                            </span><span class="err">단점</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">변경될</span><span class="w"> </span><span class="err">수</span><span class="w"> </span><span class="err">있음</span><span class="w"> </span><span class="o">(</span><span class="err">이름</span><span class="w"> </span><span class="err">변경</span><span class="o">)</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="err">추가</span><span class="w"> </span><span class="err">열</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">클</span><span class="w"> </span><span class="err">수</span><span class="w"> </span><span class="err">있음</span><span class="w"> </span><span class="o">(</span><span class="n">SSN</span><span class="o">,</span><span class="w"> </span><span class="n">ISBN</span><span class="o">)</span><span class="w">         </span><span class="o">-</span><span class="w"> </span><span class="err">의미론적</span><span class="w"> </span><span class="err">의미</span><span class="w"> </span><span class="err">없음</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="err">개인정보</span><span class="w"> </span><span class="err">문제</span><span class="w"> </span><span class="o">(</span><span class="n">SSN</span><span class="o">)</span><span class="w">            </span><span class="o">-</span><span class="w"> </span><span class="err">의미를</span><span class="w"> </span><span class="err">위한</span><span class="w"> </span><span class="err">조회</span><span class="w"> </span><span class="err">필요</span>
</code></pre></div>

<h3 id="_4">키 타입 요약<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                      키 계층                                 │
│                                                             │
│  슈퍼키                                                      │
│    │                                                        │
│    ├── 후보키 (최소 슈퍼키)                                  │
│    │     │                                                  │
│    │     ├── 기본키 (선택된 후보키)                           │
│    │     │                                                  │
│    │     └── 대체키 (선택되지 않은 후보키)                     │
│    │                                                        │
│    └── 비최소 슈퍼키                                         │
│                                                             │
│  외래키 (다른 관계의 기본키를 참조)                           │
│                                                             │
│  복합키 (여러 속성을 가진 키)                                │
│                                                             │
│  대리키 (시스템 생성, 비즈니스 의미 없음)                     │
│  자연키 (실제 데이터에서 파생)                               │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="5">5. 무결성 제약조건<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<p>무결성 제약조건은 데이터 정확성과 일관성을 보장하기 위해 데이터베이스의 값을 제한하는 규칙입니다. 관계형 모델은 여러 유형의 제약조건을 정의합니다.</p>
<h3 id="_5">도메인 제약조건<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<p><strong>도메인 제약조건(domain constraint)</strong>은 각 속성 값이 속성의 도메인(또는 허용되는 경우 NULL)에서 나와야 한다고 지정합니다.</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- SQL의 도메인 제약조건</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">   </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">       </span><span class="c1">-- 도메인 + NOT NULL</span>
<span class="w">    </span><span class="k">year</span><span class="w">        </span><span class="nb">SMALLINT</span><span class="w">      </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">gpa</span><span class="w">         </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">email</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">  </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%@%.%&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 도메인 제약조건 위반 예:</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">85</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alice@univ.edu&#39;</span><span class="p">);</span>
<span class="c1">-- 오류: year=5가 CHECK 제약조건 위반 (year BETWEEN 1 AND 4)</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alice@univ.edu&#39;</span><span class="p">);</span>
<span class="c1">-- 오류: gpa=4.50이 CHECK 제약조건 위반 (gpa &lt;= 4.0)</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">85</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;alice@univ.edu&#39;</span><span class="p">);</span>
<span class="c1">-- 오류: name이 NOT NULL</span>
</code></pre></div>

<h3 id="_6">엔티티 무결성 제약조건<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<p><strong>엔티티 무결성 제약조건(entity integrity constraint)</strong>은 기본키 속성이 NULL일 수 없다고 명시합니다.</p>
<div class="highlight"><pre><span></span><code><span class="nl">규칙</span><span class="p">:</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="n">A2</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">Ak</span><span class="err">}</span><span class="n">가</span><span class="w"> </span><span class="n">R의</span><span class="w"> </span><span class="n">기본키인</span><span class="w"> </span><span class="n">경우</span><span class="p">,</span>
<span class="w">      </span><span class="n">r</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="n">의</span><span class="w"> </span><span class="n">모든</span><span class="w"> </span><span class="n">튜플</span><span class="w"> </span><span class="n">t에</span><span class="w"> </span><span class="nl">대해</span><span class="p">:</span>
<span class="w">        </span><span class="n">t</span><span class="o">[</span><span class="n">Ai</span><span class="o">]</span><span class="w"> </span><span class="err">≠</span><span class="w"> </span><span class="k">NULL</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">k</span>

<span class="nl">근거</span><span class="p">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">기본키는</span><span class="w"> </span><span class="n">각</span><span class="w"> </span><span class="n">튜플을</span><span class="w"> </span><span class="n">고유하게</span><span class="w"> </span><span class="n">식별함</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">PK가</span><span class="w"> </span><span class="n">NULL이면</span><span class="p">,</span><span class="w"> </span><span class="n">그</span><span class="w"> </span><span class="n">튜플을</span><span class="w"> </span><span class="n">다른</span><span class="w"> </span><span class="n">튜플과</span><span class="w"> </span><span class="n">구별할</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">없음</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">SQL에서</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="err">≠</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">(</span><span class="n">NULL을</span><span class="w"> </span><span class="n">무엇과</span><span class="w"> </span><span class="n">비교해도</span><span class="w"> </span><span class="n">UNKNOWN이</span><span class="w"> </span><span class="n">됨</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">따라서</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">PK는</span><span class="w"> </span><span class="n">식별을</span><span class="w"> </span><span class="n">불가능하게</span><span class="w"> </span><span class="n">만듦</span>

<span class="nl">예</span><span class="p">:</span>
<span class="w">  </span><span class="n">ENROLLMENT</span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">,</span><span class="w"> </span><span class="n">grade</span><span class="p">)</span>
<span class="w">             </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
<span class="w">             </span><span class="n">복합</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">이</span><span class="w"> </span><span class="n">중</span><span class="w"> </span><span class="n">어느</span><span class="w"> </span><span class="n">것도</span><span class="w"> </span><span class="n">NULL일</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">없음</span>

<span class="w">  </span><span class="nl">유효</span><span class="p">:</span><span class="w">   </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS301&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fall2025&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="nl">무효</span><span class="p">:</span><span class="w">   </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fall2025&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w">     </span><span class="c1">-- course_id는 PK의 일부</span>
<span class="w">  </span><span class="nl">유효</span><span class="p">:</span><span class="w">   </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS301&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fall2025&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="w">  </span><span class="c1">-- grade는 PK의 일부가 아님</span>
</code></pre></div>

<h3 id="_7">참조 무결성 제약조건<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<p><strong>참조 무결성 제약조건(referential integrity constraint)</strong>은 외래키 값이 참조된 관계의 기존 기본키 값과 일치하거나 NULL이어야 함을 보장합니다.</p>
<div class="highlight"><pre><span></span><code><span class="nl">규칙</span><span class="p">:</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">R1</span><span class="p">)</span><span class="n">의</span><span class="w"> </span><span class="n">모든</span><span class="w"> </span><span class="n">튜플</span><span class="w"> </span><span class="n">t1에</span><span class="w"> </span><span class="n">대해</span><span class="w"> </span><span class="n">R2를</span><span class="w"> </span><span class="n">참조하는</span><span class="w"> </span><span class="n">외래키</span><span class="w"> </span><span class="n">FK를</span><span class="w"> </span><span class="n">가진</span><span class="w"> </span><span class="nl">경우</span><span class="p">:</span>
<span class="w">      </span><span class="n">t1</span><span class="o">[</span><span class="n">FK</span><span class="o">]</span><span class="n">는</span><span class="w"> </span><span class="n">NULL이거나</span>
<span class="w">      </span><span class="n">t1</span><span class="o">[</span><span class="n">FK</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="o">[</span><span class="n">PK</span><span class="o">]</span><span class="n">인</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">R2</span><span class="p">)</span><span class="n">의</span><span class="w"> </span><span class="n">튜플</span><span class="w"> </span><span class="n">t2가</span><span class="w"> </span><span class="n">존재함</span>

<span class="nl">예</span><span class="p">:</span>

<span class="w">  </span><span class="nl">STUDENT</span><span class="p">:</span><span class="w">                           </span><span class="nl">COURSE</span><span class="p">:</span>
<span class="w">  </span><span class="err">┌──────┬──────┐</span><span class="w">                    </span><span class="err">┌──────┬───────────┐</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">S001</span><span class="w"> </span><span class="err">│</span><span class="n">Alice</span><span class="w"> </span><span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="n">CS101</span><span class="w"> </span><span class="err">│</span><span class="n">Intro</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">S002</span><span class="w"> </span><span class="err">│</span><span class="n">Bob</span><span class="w">   </span><span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="n">CS301</span><span class="w"> </span><span class="err">│</span><span class="n">DB</span><span class="w"> </span><span class="n">Theory</span><span class="w">  </span><span class="err">│</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">S003</span><span class="w"> </span><span class="err">│</span><span class="n">Carol</span><span class="w"> </span><span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="n">MA201</span><span class="w"> </span><span class="err">│</span><span class="n">Lin</span><span class="w"> </span><span class="n">Alg</span><span class="w">    </span><span class="err">│</span>
<span class="w">  </span><span class="err">└──────┴──────┘</span><span class="w">                    </span><span class="err">└──────┴───────────┘</span>

<span class="w">  </span><span class="nl">ENROLLMENT</span><span class="p">:</span>
<span class="w">  </span><span class="err">┌────────┬─────────┬───────┐</span>
<span class="w">  </span><span class="err">│</span><span class="n">stu_id</span><span class="w">  </span><span class="err">│</span><span class="n">course_id</span><span class="err">│</span><span class="w"> </span><span class="n">grade</span><span class="w"> </span><span class="err">│</span>
<span class="w">  </span><span class="err">├────────┼─────────┼───────┤</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">S001</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS101</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">A</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="err">✓</span><span class="w"> </span><span class="n">S001이</span><span class="w"> </span><span class="n">STUDENT에</span><span class="w"> </span><span class="n">존재</span><span class="p">,</span><span class="w"> </span><span class="n">CS101이</span><span class="w"> </span><span class="n">COURSE에</span><span class="w"> </span><span class="n">존재</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">S002</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS301</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">B</span><span class="o">+</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">✓</span><span class="w"> </span><span class="n">S002가</span><span class="w"> </span><span class="n">STUDENT에</span><span class="w"> </span><span class="n">존재</span><span class="p">,</span><span class="w"> </span><span class="n">CS301이</span><span class="w"> </span><span class="n">COURSE에</span><span class="w"> </span><span class="n">존재</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">S004</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS101</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">A</span><span class="o">-</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="err">✗</span><span class="w"> </span><span class="n">S004가</span><span class="w"> </span><span class="n">STUDENT에</span><span class="w"> </span><span class="n">존재하지</span><span class="w"> </span><span class="n">않음</span><span class="err">!</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">S003</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS999</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="n">B</span><span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="err">✗</span><span class="w"> </span><span class="n">CS999가</span><span class="w"> </span><span class="n">COURSE에</span><span class="w"> </span><span class="n">존재하지</span><span class="w"> </span><span class="n">않음</span><span class="err">!</span>
<span class="w">  </span><span class="err">└────────┴─────────┴───────┘</span>
</code></pre></div>

<h3 id="_8">참조 무결성 동작<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<p>참조된 튜플이 삭제되거나 업데이트될 때, DBMS는 고아 외래키를 처리해야 합니다:</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">enrollment</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">semester</span><span class="w">    </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="n">grade</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>

<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">),</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">student</span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">           </span><span class="c1">-- 학생 삭제 시 enrollment 삭제</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">          </span><span class="c1">-- 학생 PK 변경 시 FK 업데이트</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">course</span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w">          </span><span class="c1">-- 수강생이 있으면 과목 삭제 방지</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">           </span><span class="c1">-- 과목 PK 변경 시 FK 업데이트</span>
<span class="p">);</span>
</code></pre></div>

<table>
<thead>
<tr>
<th>동작</th>
<th>행동</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CASCADE</strong></td>
<td>참조하는 튜플로 삭제/업데이트 전파</td>
</tr>
<tr>
<td><strong>RESTRICT</strong> (또는 NO ACTION)</td>
<td>참조하는 튜플이 존재하면 삭제/업데이트 거부</td>
</tr>
<tr>
<td><strong>SET NULL</strong></td>
<td>참조하는 튜플에서 외래키를 NULL로 설정</td>
</tr>
<tr>
<td><strong>SET DEFAULT</strong></td>
<td>외래키를 기본값으로 설정</td>
</tr>
</tbody>
</table>
<h3 id="_9">참조 무결성 동작 예<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">시나리오</span><span class="o">:</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="n">WHERE</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;S001&#39;</span><span class="o">;</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">CASCADE</span><span class="o">:</span>
<span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">S001의</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="n">enrollment가</span><span class="w"> </span><span class="err">자동으로</span><span class="w"> </span><span class="err">삭제됨</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">RESTRICT</span><span class="o">:</span>
<span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">S001이</span><span class="w"> </span><span class="n">enrollment를</span><span class="w"> </span><span class="err">가지고</span><span class="w"> </span><span class="err">있으므로</span><span class="w"> </span><span class="n">DELETE가</span><span class="w"> </span><span class="err">거부됨</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">SET</span><span class="w"> </span><span class="n">NULL</span><span class="o">:</span>
<span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">S001의</span><span class="w"> </span><span class="err">행에</span><span class="w"> </span><span class="err">대해</span><span class="w"> </span><span class="n">enrollment</span><span class="o">.</span><span class="na">student_id가</span><span class="w"> </span><span class="n">NULL로</span><span class="w"> </span><span class="err">설정됨</span>
<span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="o">(</span><span class="err">그러나</span><span class="w"> </span><span class="n">student_id가</span><span class="w"> </span><span class="n">enrollment에서</span><span class="w"> </span><span class="n">PK의</span><span class="w"> </span><span class="err">일부이므로</span>
<span class="w">     </span><span class="n">SET</span><span class="w"> </span><span class="n">NULL은</span><span class="w"> </span><span class="err">엔티티</span><span class="w"> </span><span class="err">무결성을</span><span class="w"> </span><span class="err">위반합니다</span><span class="o">!)</span>

<span class="n">ON</span><span class="w"> </span><span class="n">DELETE</span><span class="w"> </span><span class="n">SET</span><span class="w"> </span><span class="n">DEFAULT</span><span class="o">:</span>
<span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">enrollment</span><span class="o">.</span><span class="na">student_id가</span><span class="w"> </span><span class="err">기본값으로</span><span class="w"> </span><span class="err">설정됨</span>
</code></pre></div>

<h3 id="_10">키 제약조건<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<p>키 선언을 통해 강제되는 추가 제약조건:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- UNIQUE 제약조건: 대체키</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">     </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">email</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- 대체키</span>
<span class="w">    </span><span class="n">ssn</span><span class="w">         </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w">     </span><span class="k">UNIQUE</span><span class="w">            </span><span class="c1">-- 또 다른 대체키 (nullable)</span>
<span class="p">);</span>

<span class="c1">-- 복합 UNIQUE 제약조건</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">course_offering</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">offering_id</span><span class="w">   </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">          </span><span class="c1">-- 대리키</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">     </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">semester</span><span class="w">      </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">instructor_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">)</span><span class="w">                </span><span class="c1">-- 자연키 제약조건</span>
<span class="p">);</span>
</code></pre></div>

<h3 id="_11">일반 제약조건 (의미론적 제약조건)<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<p>도메인, 키, 참조 제약조건만으로 표현할 수 없는 제약조건:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- CHECK 제약조건 (튜플 수준)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="w">      </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">credits</span><span class="w">    </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">credits</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">max_seats</span><span class="w">  </span><span class="nb">INT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">max_seats</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">min_seats</span><span class="w">  </span><span class="nb">INT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">min_seats</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">seats_check</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">max_seats</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">min_seats</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- ASSERTION (테이블 간 제약조건, SQL 표준이지만 거의 구현되지 않음)</span>
<span class="c1">-- &quot;학생은 학기당 7개 이상의 과목을 수강할 수 없습니다&quot;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">ASSERTION</span><span class="w"> </span><span class="n">max_courses_per_semester</span>
<span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span>
<span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">enrollment</span>
<span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span>
<span class="w">        </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">7</span>
<span class="w">    </span><span class="p">));</span>

<span class="c1">-- 실제로는 테이블 간 제약조건에 트리거를 사용합니다:</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">check_max_courses</span><span class="p">()</span>
<span class="k">RETURNS</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">enrollment</span>
<span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NEW</span><span class="p">.</span><span class="n">student_id</span>
<span class="w">        </span><span class="k">AND</span><span class="w"> </span><span class="n">semester</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NEW</span><span class="p">.</span><span class="n">semester</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="n">RAISE</span><span class="w"> </span><span class="k">EXCEPTION</span><span class="w"> </span><span class="s1">&#39;Student cannot enroll in more than 7 courses per semester&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="k">NEW</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">trg_max_courses</span>
<span class="w">    </span><span class="k">BEFORE</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">enrollment</span>
<span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">check_max_courses</span><span class="p">();</span>
</code></pre></div>

<h3 id="_12">제약조건 요약<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                    무결성 제약조건                               │
│                                                                 │
│  고유 모델 제약조건 (관계형 모델에 내장):                         │
│    - 중복 튜플 없음                                             │
│    - 원자적 속성 값 (1NF)                                       │
│                                                                 │
│  스키마 기반 제약조건 (DDL):                                    │
│    - 도메인 제약조건 (데이터 타입, CHECK)                        │
│    - 키 제약조건 (PRIMARY KEY, UNIQUE)                          │
│    - 엔티티 무결성 (PK NOT NULL)                                │
│    - 참조 무결성 (FOREIGN KEY)                                  │
│    - NOT NULL 제약조건                                          │
│                                                                 │
│  애플리케이션 기반 제약조건 (비즈니스 규칙):                     │
│    - 트리거                                                     │
│    - 애플리케이션 로직                                          │
│    - 어서션 (SQL에서 거의 지원되지 않음)                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="6">6. 관계형 스키마 표기법<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<p>문서와 교과서에서 관계형 스키마를 표현하는 몇 가지 표준 방법이 있습니다.</p>
<h3 id="_13">텍스트 표기법<a class="header-link" href="#_13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>STUDENT(student_id, name, year, gpa)
  PK: student_id
  FK: (없음)

COURSE(course_id, title, credits, dept_id)
  PK: course_id
  FK: dept_id → DEPARTMENT(dept_id)

ENROLLMENT(student_id, course_id, semester, grade)
  PK: (student_id, course_id, semester)
  FK: student_id → STUDENT(student_id)
      course_id → COURSE(course_id)

DEPARTMENT(dept_id, dept_name, building, budget)
  PK: dept_id

INSTRUCTOR(instructor_id, name, dept_id, salary)
  PK: instructor_id
  FK: dept_id → DEPARTMENT(dept_id)
</code></pre></div>

<h3 id="_14">밑줄 규약<a class="header-link" href="#_14" title="Permanent link">&para;</a></h3>
<p>기본키 속성에 밑줄을 표시합니다 (여기서는 밑줄로 표시):</p>
<div class="highlight"><pre><span></span><code>STUDENT(_student_id_, name, year, gpa)
COURSE(_course_id_, title, credits, dept_id*)
ENROLLMENT(_student_id*_, _course_id*_, <span class="ge">_semester_</span>, grade)
DEPARTMENT(_dept_id_, dept_name, building, budget)
INSTRUCTOR(_instructor_id_, name, dept_id*, salary)

규약:
  <span class="ge">_밑줄_</span> = 기본키 속성
  <span class="k">*</span> = 외래키 속성
</code></pre></div>

<h3 id="_15">다이어그램 표기법<a class="header-link" href="#_15" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌──────────────────┐     ┌──────────────────┐     ┌──────────────────┐
│    DEPARTMENT     │     │    INSTRUCTOR     │     │      COURSE      │
├──────────────────┤     ├──────────────────┤     ├──────────────────┤
│ PK dept_id       │◄────│ PK instructor_id │     │ PK course_id     │
│    dept_name     │     │    name          │     │    title         │
│    building      │     │ FK dept_id    ───┘     │    credits       │
│    budget        │     │    salary       │     │ FK dept_id    ───┤
└──────────────────┘     └──────────────────┘     └────────┬─────────┘
                                                           │
                                                           │
┌──────────────────┐     ┌──────────────────────┐         │
│     STUDENT      │     │     ENROLLMENT       │         │
├──────────────────┤     ├──────────────────────┤         │
│ PK student_id    │◄────│ PK,FK student_id  ───┘         │
│    name          │     │ PK,FK course_id   ─────────────┘
│    year          │     │ PK    semester     │
│    gpa           │     │       grade        │
└──────────────────┘     └──────────────────────┘
</code></pre></div>

<h3 id="sql-ddl">스키마 정의로서의 SQL DDL<a class="header-link" href="#sql-ddl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- SQL로 완전한 스키마 정의</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">     </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_name</span><span class="w">   </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">building</span><span class="w">    </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
<span class="w">    </span><span class="n">budget</span><span class="w">      </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">budget</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">instructor</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">instructor_id</span><span class="w">  </span><span class="nb">SERIAL</span><span class="w">       </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w">           </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">        </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">salary</span><span class="w">         </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">department</span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">year</span><span class="w">        </span><span class="nb">SMALLINT</span><span class="w">     </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">gpa</span><span class="w">         </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">      </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">credits</span><span class="w">     </span><span class="nb">SMALLINT</span><span class="w">     </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">credits</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">     </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">department</span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">enrollment</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">student_id</span><span class="w">  </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">course_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">      </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">semester</span><span class="w">    </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">  </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">grade</span><span class="w">       </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">semester</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">student</span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">course</span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="p">);</span>
</code></pre></div>

<hr />
<h2 id="7-null-3">7. NULL 의미와 3치 논리<a class="header-link" href="#7-null-3" title="Permanent link">&para;</a></h2>
<p>NULL은 관계형 모델에서 가장 미묘하고 자주 오해되는 개념 중 하나입니다. NULL 의미를 이해하는 것은 올바른 쿼리 작성에 중요합니다.</p>
<h3 id="null">NULL이 나타내는 것<a class="header-link" href="#null" title="Permanent link">&para;</a></h3>
<p>NULL은 <strong>값이 아닙니다</strong>. 다음을 나타내는 <strong>마커</strong>입니다:</p>
<table>
<thead>
<tr>
<th>의미</th>
<th>예</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>누락(Missing)</strong> (값이 존재하지만 알 수 없음)</td>
<td>아직 기록되지 않은 학생의 전화번호</td>
</tr>
<tr>
<td><strong>적용 불가능(Inapplicable)</strong> (값이 의미가 없음)</td>
<td>집에 사는 학생의 아파트 번호</td>
</tr>
<tr>
<td><strong>보류(Withheld)</strong> (값이 존재하지만 공개되지 않음)</td>
<td>동료의 급여</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code>중요한 구별:
  NULL ≠ 0       (0은 알려진 값)
  NULL ≠ &#39;&#39;      (빈 문자열은 알려진 값)
  NULL ≠ FALSE   (false는 알려진 불린 값)
  NULL ≠ NULL    (NULL과 NULL을 비교하면 UNKNOWN이지 TRUE가 아님!)
</code></pre></div>

<h3 id="3-three-valued-logic-3vl">3치 논리(Three-Valued Logic, 3VL)<a class="header-link" href="#3-three-valued-logic-3vl" title="Permanent link">&para;</a></h3>
<p>표준 불린 논리는 두 개의 값을 가집니다: TRUE와 FALSE. SQL은 TRUE, FALSE, <strong>UNKNOWN</strong>을 가진 <strong>3치 논리</strong>를 사용합니다.</p>
<p>NULL을 포함하는 비교는 UNKNOWN을 생성합니다:</p>
<div class="highlight"><pre><span></span><code><span class="mf">5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">3</span><span class="w">        </span><span class="err">→</span><span class="w"> </span><span class="n">TRUE</span>
<span class="mf">5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">7</span><span class="w">        </span><span class="err">→</span><span class="w"> </span><span class="n">FALSE</span>
<span class="mf">5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">NULL</span><span class="w">     </span><span class="err">→</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">NULL</span><span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="w">  </span><span class="err">→</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="w">     </span><span class="err">→</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mf">5</span><span class="w">    </span><span class="err">→</span><span class="w"> </span><span class="n">UNKNOWN</span>
<span class="n">NULL</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">UNKNOWN</span>
</code></pre></div>

<h3 id="3vl">3VL에 대한 진리표<a class="header-link" href="#3vl" title="Permanent link">&para;</a></h3>
<p><strong>AND:</strong></p>
<div class="highlight"><pre><span></span><code><span class="w">         </span><span class="n">│</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="n">─────────┼──────────────────────────────</span>
<span class="no">TRUE</span><span class="w">     </span><span class="n">│</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="no">FALSE</span><span class="w">    </span><span class="n">│</span><span class="w">  </span><span class="no">FALSE</span><span class="w">    </span><span class="no">FALSE</span><span class="w">    </span><span class="no">FALSE</span>
<span class="no">UNKNOWN</span><span class="w">  </span><span class="n">│</span><span class="w">  </span><span class="no">UNKNOWN</span><span class="w">  </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
</code></pre></div>

<p><strong>OR:</strong></p>
<div class="highlight"><pre><span></span><code><span class="w">         </span><span class="n">│</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="n">─────────┼──────────────────────────────</span>
<span class="no">TRUE</span><span class="w">     </span><span class="n">│</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">TRUE</span><span class="w">     </span><span class="no">TRUE</span>
<span class="no">FALSE</span><span class="w">    </span><span class="n">│</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">FALSE</span><span class="w">    </span><span class="no">UNKNOWN</span>
<span class="no">UNKNOWN</span><span class="w">  </span><span class="n">│</span><span class="w">  </span><span class="no">TRUE</span><span class="w">     </span><span class="no">UNKNOWN</span><span class="w">  </span><span class="no">UNKNOWN</span>
</code></pre></div>

<p><strong>NOT:</strong></p>
<div class="highlight"><pre><span></span><code>NOT TRUE    → FALSE
NOT FALSE   → TRUE
NOT UNKNOWN → UNKNOWN
</code></pre></div>

<h3 id="sql_1">SQL 쿼리에 대한 함의<a class="header-link" href="#sql_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- 설정</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>

<span class="c1">-- 쿼리 1: WHERE value = 10</span>
<span class="c1">-- 반환: {(1, 10)}</span>
<span class="c1">-- 행 (3, NULL): NULL = 10 → UNKNOWN → 행 제외</span>

<span class="c1">-- 쿼리 2: WHERE value &lt;&gt; 10</span>
<span class="c1">-- 반환: {(2, 20)}</span>
<span class="c1">-- 행 (3, NULL): NULL &lt;&gt; 10 → UNKNOWN → 행 제외!</span>
<span class="c1">-- 놀라움: &quot;value = 10&quot;도 &quot;value &lt;&gt; 10&quot;도 NULL 행을 반환하지 않습니다!</span>

<span class="c1">-- 쿼리 3: WHERE value = NULL</span>
<span class="c1">-- 반환: 빈 집합!</span>
<span class="c1">-- NULL = NULL → UNKNOWN → NULL을 가진 모든 행이 제외됨</span>
<span class="c1">-- 이것은 일반적인 버그입니다. 대신 IS NULL을 사용하세요.</span>

<span class="c1">-- 쿼리 4: WHERE value IS NULL</span>
<span class="c1">-- 반환: {(3, NULL)}</span>
<span class="c1">-- IS NULL은 NULL을 올바르게 확인하는 특수 연산자입니다</span>

<span class="c1">-- 쿼리 5: WHERE value IS NOT NULL</span>
<span class="c1">-- 반환: {(1, 10), (2, 20)}</span>
</code></pre></div>

<h3 id="null_1">집계에서의 NULL<a class="header-link" href="#null_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- 집계 함수에서의 NULL 동작</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">scores</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">scores</span><span class="w"> </span><span class="k">VALUES</span>
<span class="w">    </span><span class="p">(</span><span class="s1">&#39;S001&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S002&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S003&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;S004&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">70</span><span class="p">);</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 4 (모든 행 계산)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 3 (NULL 제외)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 240 (NULL 제외)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 80 (240/3, NULL 제외)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 70 (NULL 제외)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 90 (NULL 제외)</span>

<span class="c1">-- 중요: AVG(score) = 80, 60이 아님!</span>
<span class="c1">-- AVG는 NULL을 무시하므로 240/3 = 80을 계산, 240/4 = 60이 아님</span>
<span class="c1">-- NULL을 0으로 처리하려면:</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="k">COALESCE</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 60 (240/4)</span>
</code></pre></div>

<h3 id="null_2">불린 표현식에서의 NULL<a class="header-link" href="#null_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- WHERE 절은 조건이 TRUE인 행만 유지합니다</span>
<span class="c1">-- 조건이 FALSE 또는 UNKNOWN인 행은 필터링됩니다</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
<span class="c1">-- gpa가 NULL인 경우: NULL &gt; 3.5 → UNKNOWN → 행 제외</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
<span class="c1">-- gpa가 NULL인 경우:</span>
<span class="c1">--   NULL &gt; 3.5 → UNKNOWN</span>
<span class="c1">--   NULL &lt;= 3.5 → UNKNOWN</span>
<span class="c1">--   UNKNOWN OR UNKNOWN → UNKNOWN</span>
<span class="c1">--   논리적으로 gpa &gt; 3.5 OR gpa &lt;= 3.5가 모든 경우를 커버해야 하지만</span>
<span class="c1">--   행이 제외됩니다!</span>

<span class="c1">-- NULL을 포함하려면:</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
</code></pre></div>

<h3 id="distinct-group-by-null">DISTINCT 및 GROUP BY에서의 NULL<a class="header-link" href="#distinct-group-by-null" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- DISTINCT와 GROUP BY에서는 NULL이 동등한 것으로 간주됩니다</span>
<span class="c1">-- (이것은 &quot;NULL ≠ NULL&quot;에 대한 예외입니다)</span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">instructor</span><span class="p">;</span>
<span class="c1">-- 여러 instructor가 dept = NULL을 가지면,</span>
<span class="c1">-- 결과에 하나의 NULL만 나타납니다</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">dept</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">instructor</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">dept</span><span class="p">;</span>
<span class="c1">-- dept = NULL인 모든 행이 함께 그룹화됩니다</span>
</code></pre></div>

<h3 id="null_3">조인에서의 NULL<a class="header-link" href="#null_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- 조인에서 NULL 값은 절대 일치하지 않습니다</span>

<span class="c1">-- STUDENT: (S001, &#39;Alice&#39;, &#39;CS&#39;), (S002, &#39;Bob&#39;, NULL)</span>
<span class="c1">-- DEPARTMENT: (&#39;CS&#39;, &#39;Computer Science&#39;), (&#39;EE&#39;, &#39;Electrical Engineering&#39;)</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">dept_name</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="n">s</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">dept_id</span><span class="p">;</span>

<span class="c1">-- 결과: (&#39;Alice&#39;, &#39;Computer Science&#39;)만</span>
<span class="c1">-- Bob은 NULL = &#39;CS&#39; → UNKNOWN, NULL = &#39;EE&#39; → UNKNOWN이므로 제외됩니다</span>
</code></pre></div>

<h3 id="coalesce-nullif">COALESCE 및 NULLIF<a class="header-link" href="#coalesce-nullif" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- COALESCE: 첫 번째 비NULL 인자 반환</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">phone</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No contact info&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">contact</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">student</span><span class="p">;</span>
<span class="c1">-- phone이 NULL이고 email이 &#39;alice@univ.edu&#39;인 경우:</span>
<span class="c1">--   &#39;alice@univ.edu&#39; 반환</span>
<span class="c1">-- 둘 다 NULL인 경우:</span>
<span class="c1">--   &#39;No contact info&#39; 반환</span>

<span class="c1">-- NULLIF: 두 값이 같으면 NULL 반환</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">NULLIF</span><span class="p">(</span><span class="n">actual_score</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">adjusted_score</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">test_results</span><span class="p">;</span>
<span class="c1">-- actual_score = 0인 경우: NULL 반환 (0을 알 수 없는 것으로 처리)</span>
<span class="c1">-- actual_score = 85인 경우: 85 반환</span>
</code></pre></div>

<h3 id="null_4">NULL에 대한 모범 사례<a class="header-link" href="#null_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">해야</span><span class="w"> </span><span class="n">할</span><span class="w"> </span><span class="n">것</span><span class="err">:</span>
<span class="w">  </span><span class="n">✓</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="n">확인에</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="err">/</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="n">사용</span>
<span class="w">  </span><span class="n">✓</span><span class="w"> </span><span class="n">기본값</span><span class="w"> </span><span class="n">제공에</span><span class="w"> </span><span class="n">COALESCE</span><span class="w"> </span><span class="n">사용</span>
<span class="w">  </span><span class="n">✓</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">절</span><span class="w"> </span><span class="n">작성</span><span class="w"> </span><span class="n">시</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="n">동작</span><span class="w"> </span><span class="n">고려</span>
<span class="w">  </span><span class="n">✓</span><span class="w"> </span><span class="n">집계</span><span class="w"> </span><span class="n">쿼리에서</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="n">처리에</span><span class="w"> </span><span class="n">대해</span><span class="w"> </span><span class="n">명시적으로</span><span class="w"> </span><span class="n">설명</span>
<span class="w">  </span><span class="n">✓</span><span class="w"> </span><span class="n">NULL을</span><span class="w"> </span><span class="n">허용하는</span><span class="w"> </span><span class="n">열과</span><span class="w"> </span><span class="n">그</span><span class="w"> </span><span class="n">이유를</span><span class="w"> </span><span class="n">문서화</span>

<span class="n">하지</span><span class="w"> </span><span class="n">말아야</span><span class="w"> </span><span class="n">할</span><span class="w"> </span><span class="n">것</span><span class="err">:</span>
<span class="w">  </span><span class="n">✗</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="n">또는</span><span class="w"> </span><span class="err">&lt;&gt;</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="n">사용</span><span class="w"> </span><span class="p">(</span><span class="n">항상</span><span class="w"> </span><span class="no">UNKNOWN</span><span class="w"> </span><span class="n">반환</span><span class="p">)</span>
<span class="w">  </span><span class="n">✗</span><span class="w"> </span><span class="n">AVG가</span><span class="w"> </span><span class="n">NULL을</span><span class="w"> </span><span class="n">0으로</span><span class="w"> </span><span class="n">포함한다고</span><span class="w"> </span><span class="n">가정</span>
<span class="w">  </span><span class="n">✗</span><span class="w"> </span><span class="n">UNKNOWN과의</span><span class="w"> </span><span class="n">OR이</span><span class="w"> </span><span class="n">행을</span><span class="w"> </span><span class="n">제외할</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">있음을</span><span class="w"> </span><span class="n">잊지</span><span class="w"> </span><span class="n">말</span><span class="w"> </span><span class="n">것</span>
<span class="w">  </span><span class="n">✗</span><span class="w"> </span><span class="n">기본키</span><span class="w"> </span><span class="n">열에서</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="n">허용</span>
<span class="w">  </span><span class="n">✗</span><span class="w"> </span><span class="n">NULL을</span><span class="w"> </span><span class="n">의미</span><span class="w"> </span><span class="n">있는</span><span class="w"> </span><span class="n">비즈니스</span><span class="w"> </span><span class="n">값으로</span><span class="w"> </span><span class="n">사용</span><span class="w"> </span><span class="p">(</span><span class="n">대신</span><span class="w"> </span><span class="n">플래그</span><span class="w"> </span><span class="n">열</span><span class="w"> </span><span class="n">사용</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. 실제 관계형 모델<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="python">관계형 개념의 Python 구현<a class="header-link" href="#python" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Python에서 관계형 모델 개념의 단순화된 구현.</span>
<span class="sd">교육 목적만을 위한 것입니다.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Domain</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;도메인(허용된 값의 집합)을 나타냅니다.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">check_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_fn</span> <span class="o">=</span> <span class="n">check_fn</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># NULL은 명시적으로 제약되지 않는 한 허용됩니다</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Relation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;제약조건 확인을 가진 단순화된 관계(테이블).&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attributes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">primary_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">domains</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span> <span class="o">=</span> <span class="n">attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span> <span class="o">=</span> <span class="n">primary_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domains</span> <span class="o">=</span> <span class="n">domains</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;제약조건 확인과 함께 튜플을 삽입합니다.&quot;&quot;&quot;</span>
        <span class="c1"># 확인: 모든 속성이 존재</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># 엔티티 무결성: PK는 NULL일 수 없음</span>
        <span class="k">for</span> <span class="n">pk_attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">pk_attr</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Entity integrity violation: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;PK attribute &#39;</span><span class="si">{</span><span class="n">pk_attr</span><span class="si">}</span><span class="s2">&#39; cannot be NULL&quot;</span>
                <span class="p">)</span>

        <span class="c1"># 도메인 제약조건</span>
        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">domain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">domain</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Domain violation: </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;not in domain </span><span class="si">{</span><span class="n">domain</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># 키 제약조건: 중복 PK 없음</span>
        <span class="n">pk_values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">existing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span>
            <span class="n">existing_pk</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">existing</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pk_values</span> <span class="o">==</span> <span class="n">existing_pk</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Key violation: duplicate PK </span><span class="si">{</span><span class="n">pk_values</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;서술논리와 일치하는 튜플을 선택합니다 (sigma 연산).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span> <span class="k">if</span> <span class="n">predicate</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;주어진 속성으로 프로젝트합니다 (pi 연산).&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span>
            <span class="n">projected</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">projected</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">attrs</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">)</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuples</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NULL&#39;</span><span class="p">))</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span>
            <span class="p">)</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="c1"># --- 데모 ---</span>

<span class="c1"># 도메인 정의</span>
<span class="n">gpa_domain</span> <span class="o">=</span> <span class="n">Domain</span><span class="p">(</span><span class="s2">&quot;GPA&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="n">year_domain</span> <span class="o">=</span> <span class="n">Domain</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">})</span>

<span class="c1"># 관계 생성</span>
<span class="n">student</span> <span class="o">=</span> <span class="n">Relation</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;STUDENT&quot;</span><span class="p">,</span>
    <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;student_id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">],</span>
    <span class="n">primary_key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;student_id&quot;</span><span class="p">],</span>
    <span class="n">domains</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="n">gpa_domain</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">year_domain</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># 유효한 튜플 삽입</span>
<span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S001&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.85</span><span class="p">})</span>
<span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S002&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.42</span><span class="p">})</span>
<span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S003&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Carol&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">student</span><span class="p">)</span>

<span class="c1"># 엔티티 무결성 위반</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dave&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">})</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caught: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 도메인 제약조건 위반</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S004&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Eve&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">})</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caught: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 키 제약조건 위반</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">student</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;student_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S001&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Frank&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;gpa&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">})</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caught: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 선택</span>
<span class="n">honors</span> <span class="o">=</span> <span class="n">student</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;gpa&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;gpa&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Honors students:&quot;</span><span class="p">,</span> <span class="n">honors</span><span class="p">)</span>

<span class="c1"># 프로젝션</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">student</span><span class="o">.</span><span class="n">project</span><span class="p">([</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Names and years:&quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</code></pre></div>

<h3 id="_16">일반적인 관계형 모델 오해<a class="header-link" href="#_16" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>오해                          현실
─────────────────────────────          ─────────────────────────────────
&quot;테이블은 관계입니다&quot;                 SQL 테이블은 다중집합이지 집합이 아님
                                       (중복을 허용)

&quot;열 순서가 중요합니다&quot;                 형식 모델에서는 중요하지 않음
                                       (SQL은 선언 순서를 보존)

&quot;NULL은 빈 것이거나 0을 의미합니다&quot;    NULL은 알 수 없거나 적용 불가능하거나
                                       누락을 의미 — 빈/0이 아님

&quot;모든 테이블에 자동 증가 ID가           모델은 기본키를 요구하지만
 있어야 합니다&quot;                        어떤 후보키든 가능

&quot;외래키는 어떤 열이든 참조할 수 있음&quot;  FK는 기본키를 참조
                                       (실제로는 UNIQUE 키)

&quot;관계형 = SQL&quot;                        SQL은 관계형 모델에서 여러 면에서
                                       벗어남 (중복, NULL 처리, 백 의미론)
</code></pre></div>

<hr />
<h2 id="9">9. 연습문제<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="_17">개념적 질문<a class="header-link" href="#_17" title="Permanent link">&para;</a></h3>
<p><strong>연습문제 2.1</strong>: Codd의 12가지 규칙을 자신의 말로 설명하세요. 각 규칙에 대해, 이를 만족하는 DBMS 기능의 예를 제시하세요.</p>
<p><strong>연습문제 2.2</strong>: 다음의 차이를 설명하세요:
- (a) 슈퍼키와 후보키
- (b) 기본키와 대체키
- (c) 자연키와 대리키
- (d) 엔티티 무결성과 참조 무결성</p>
<p><strong>연습문제 2.3</strong>: 관계형 모델이 기본키에서 NULL 값을 금지하는 이유는 무엇입니까? 이 제한이 완화되면 어떤 문제가 발생할까요?</p>
<p><strong>연습문제 2.4</strong>: SQL에서 NULL = NULL이 UNKNOWN으로 평가되는 이유를 설명하고, TRUE가 아닌 이유를 설명하세요. NULL = NULL을 TRUE로 처리하면 잘못된 쿼리 결과를 생성할 시나리오를 설명하세요.</p>
<h3 id="_18">스키마 설계 질문<a class="header-link" href="#_18" title="Permanent link">&para;</a></h3>
<p><strong>연습문제 2.5</strong>: 다음 도서관 시스템 요구사항이 주어졌을 때, 모든 관계, 그들의 속성, 기본키, 외래키, 도메인 제약조건을 식별하세요:</p>
<ul>
<li>도서관에는 각각 ISBN, 제목, 저자, 출판사, 연도, 사본 수를 가진 책들이 있습니다</li>
<li>회원은 회원 ID, 이름, 주소, 전화번호를 가집니다</li>
<li>회원은 책을 빌릴 수 있습니다. 각 대출은 회원, 책, 대출 날짜, 반납 예정일, 반납 날짜를 기록합니다</li>
<li>각 책은 하나 이상의 카테고리에 속합니다 (예: Fiction, Science, History)</li>
</ul>
<p><strong>연습문제 2.6</strong>: 다음 관계 스키마에 대해, 모든 후보키를 식별하세요:</p>
<div class="highlight"><pre><span></span><code>FLIGHT(flight_number, airline, departure_city, arrival_city,
       departure_time, arrival_time, gate, aircraft_id)

제약조건:
  <span class="k">-</span> flight number는 항공편을 고유하게 식별합니다
  <span class="k">-</span> 항공기는 한 번에 하나의 게이트에만 있을 수 있습니다
  <span class="k">-</span> 게이트는 한 번에 하나의 항공기만 가질 수 있습니다
</code></pre></div>

<p><strong>연습문제 2.7</strong>: 주어진 이 스키마에서, 모든 무결성 제약조건 위반을 식별하고 수정하세요:</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">emp_id</span><span class="w">    </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w">      </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">dept_id</span><span class="w">   </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">department</span><span class="p">(</span><span class="n">dept_id</span><span class="p">),</span>
<span class="w">    </span><span class="n">salary</span><span class="w">    </span><span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="n">mgr_id</span><span class="w">    </span><span class="nb">INT</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">employee</span><span class="p">(</span><span class="n">emp_id</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 시도된 삽입:</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">75000</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Computer Science&#39;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">60000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Carol&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;EE01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">65000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Dave&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CS01&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">55000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</code></pre></div>

<h3 id="sql-null">SQL 및 NULL 질문<a class="header-link" href="#sql-null" title="Permanent link">&para;</a></h3>
<p><strong>연습문제 2.8</strong>: 각 쿼리의 출력을 예측하세요. 이유를 설명하세요.</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">);</span>

<span class="c1">-- (a)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>

<span class="c1">-- (b)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>

<span class="c1">-- (c)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>

<span class="c1">-- (d)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="c1">-- (e)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>

<span class="c1">-- (f)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
</code></pre></div>

<p><strong>연습문제 2.9</strong>: 다음에 대해 NULL을 올바르게 처리하는 SQL 쿼리를 작성하세요:</p>
<p><code>EMPLOYEE(emp_id, name, dept, salary, bonus)</code> 주어짐, 여기서 <code>bonus</code>는 NULL일 수 있음:</p>
<ul>
<li>(a) 총 보상 (급여 + 보너스)이 100,000을 초과하는 직원 찾기</li>
<li>(b) NULL 보너스를 0으로 처리하여 평균 보너스 찾기</li>
<li>(c) 모든 직원이 비NULL 보너스를 가진 부서 찾기</li>
<li>(d) 직원 'E001'과 다른 보너스를 가진 직원 찾기 (NULL 포함)</li>
</ul>
<h3 id="_19">설계 연습<a class="header-link" href="#_19" title="Permanent link">&para;</a></h3>
<p><strong>연습문제 2.10</strong>: 다음 요구사항으로 온라인 서점을 위한 관계형 스키마를 설계하세요:</p>
<ul>
<li>책은 ISBN, 제목, 가격, 출판일, 페이지 수를 가집니다</li>
<li>저자는 ID, 이름, 전기를 가집니다. 한 책은 여러 저자를 가질 수 있고, 저자는 여러 책을 쓸 수 있습니다</li>
<li>고객은 ID, 이름, 이메일, 배송 주소를 가집니다</li>
<li>고객은 주문을 할 수 있습니다. 각 주문은 주문 ID, 주문 날짜, 상태를 가집니다</li>
<li>각 주문은 하나 이상의 책을 수량과 함께 포함합니다</li>
<li>고객은 책에 대한 리뷰를 작성할 수 있습니다 (평점 1-5, 텍스트, 날짜)</li>
</ul>
<p>제공 사항:
1. 기본 및 외래키를 가진 모든 관계 스키마
2. 각 속성에 대한 도메인 제약조건
3. 추가 무결성 제약조건 (CHECK로 또는 영어로 작성)
4. 최소 두 개의 관계에 대한 유효하고 무효한 튜플의 예</p>
<hr />
<p><strong>이전</strong>: <a href="./01_Introduction_to_Database_Systems.md">데이터베이스 시스템 소개</a> | <strong>다음</strong>: <a href="./03_Relational_Algebra.md">관계 대수</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Database_Theory/01_Introduction_to_Database_Systems.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">데이터베이스 시스템 소개(Introduction to Database Systems)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Database_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Database_Theory/03_Relational_Algebra.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">관계 대수(Relational Algebra)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}