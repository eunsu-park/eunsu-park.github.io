{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관계 대수(Relational Algebra) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Database_Theory/">Database Theory</a>
    <span class="separator">/</span>
    <span class="current">관계 대수(Relational Algebra)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>관계 대수(Relational Algebra)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Database_Theory/02_Relational_Model.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">관계형 모델(The Relational Model)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Database_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Database_Theory/04_ER_Modeling.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ER 모델링(ER Modeling)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">목차</a></li>
<li><a href="#1">1. 관계 대수 개요</a><ul>
<li><a href="#_2">관계 대수란?</a></li>
<li><a href="#_3">연산의 범주</a></li>
<li><a href="#_4">실행 예제 데이터베이스</a></li>
</ul>
</li>
<li><a href="#2">2. 단항 연산</a><ul>
<li><a href="#sigma">선택 (sigma)</a></li>
<li><a href="#pi">프로젝션 (pi)</a></li>
<li><a href="#rho">재명명 (rho)</a></li>
</ul>
</li>
<li><a href="#3">3. 집합 연산</a><ul>
<li><a href="#_5">합집합</a></li>
<li><a href="#_6">차집합</a></li>
<li><a href="#_7">교집합</a></li>
<li><a href="#_8">집합 연산 요약</a></li>
</ul>
</li>
<li><a href="#4">4. 이항 연산: 카티션 곱과 조인</a><ul>
<li><a href="#_9">카티션 곱 (크로스 곱)</a></li>
<li><a href="#_10">세타 조인</a></li>
<li><a href="#_11">동등 조인</a></li>
<li><a href="#_12">자연 조인</a></li>
<li><a href="#_13">외부 조인</a></li>
<li><a href="#_14">조인 비교 요약</a></li>
<li><a href="#_15">세미 조인과 안티 조인</a></li>
</ul>
</li>
<li><a href="#5">5. 나눗셈</a><ul>
<li><a href="#_16">기본 연산으로 표현된 나눗셈</a></li>
<li><a href="#_17">나눗셈 예제</a></li>
</ul>
</li>
<li><a href="#6">6. 추가 연산</a><ul>
<li><a href="#_18">집계와 그룹화</a></li>
<li><a href="#_19">대입</a></li>
<li><a href="#_20">정렬</a></li>
</ul>
</li>
<li><a href="#7">7. 쿼리 트리와 대수적 최적화</a><ul>
<li><a href="#_21">쿼리 트리</a></li>
<li><a href="#_22">대수적 최적화</a></li>
<li><a href="#_23">주요 동치 규칙</a></li>
<li><a href="#_24">최적화 예제</a></li>
<li><a href="#_25">휴리스틱 최적화 규칙</a></li>
</ul>
</li>
<li><a href="#8">8. 관계 해석 (간단한 소개)</a><ul>
<li><a href="#trc">튜플 관계 해석 (TRC)</a></li>
<li><a href="#drc">도메인 관계 해석 (DRC)</a></li>
<li><a href="#_26">대수와 해석의 동치성</a></li>
<li><a href="#_27">표현식의 안전성</a></li>
</ul>
</li>
<li><a href="#9-sql">9. SQL과의 동치성</a><ul>
<li><a href="#_28">연산별 매핑</a></li>
<li><a href="#sql">상세한 SQL 동치</a></li>
</ul>
</li>
<li><a href="#10">10. 완전한 작업 예제</a><ul>
<li><a href="#1_1">예제 1: 다단계 쿼리</a></li>
<li><a href="#2_1">예제 2: 나눗셈 쿼리</a></li>
<li><a href="#3_1">예제 3: 외부 조인</a></li>
</ul>
</li>
<li><a href="#11">11. 연습 문제</a><ul>
<li><a href="#_29">기본 연산</a></li>
<li><a href="#_30">조인 연산</a></li>
<li><a href="#_31">나눗셈</a></li>
<li><a href="#_32">최적화</a></li>
<li><a href="#_33">관계 해석</a></li>
<li><a href="#_34">도전 문제</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="relational-algebra">관계 대수(Relational Algebra)<a class="header-link" href="#relational-algebra" title="Permanent link">&para;</a></h1>
<p><strong>이전</strong>: <a href="./02_Relational_Model.md">관계 모델</a> | <strong>다음</strong>: <a href="./04_ER_Modeling.md">ER 모델링</a></p>
<hr />
<p>관계 대수는 관계 모델의 형식적 질의 언어입니다. 하나 또는 두 개의 관계를 입력으로 받아 새로운 관계를 출력으로 생성하는 연산자의 집합을 제공합니다. 관계 대수를 이해하는 것은 SQL 쿼리 처리의 기반이 되기 때문에 필수적입니다. 모든 SQL 쿼리는 내부적으로 관계 대수 표현식으로 변환되며, 쿼리 최적화기는 이를 변환하고 개선할 수 있습니다.</p>
<h2 id="_1">목차<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-관계-대수-개요">관계 대수 개요</a></li>
<li><a href="#2-단항-연산">단항 연산</a></li>
<li><a href="#3-집합-연산">집합 연산</a></li>
<li><a href="#4-이항-연산-카티션-곱과-조인">이항 연산: 카티션 곱과 조인</a></li>
<li><a href="#5-나눗셈">나눗셈</a></li>
<li><a href="#6-추가-연산">추가 연산</a></li>
<li><a href="#7-쿼리-트리와-대수적-최적화">쿼리 트리와 대수적 최적화</a></li>
<li><a href="#8-관계-해석-간단한-소개">관계 해석 (간단한 소개)</a></li>
<li><a href="#9-sql과의-동치성">SQL과의 동치성</a></li>
<li><a href="#10-완전한-작업-예제">완전한 작업 예제</a></li>
<li><a href="#11-연습-문제">연습 문제</a></li>
</ol>
<hr />
<h2 id="1">1. 관계 대수 개요<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="_2">관계 대수란?<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<p>관계 대수는 <strong>절차적(procedural)</strong> 쿼리 언어입니다. 원하는 결과를 계산하기 위한 일련의 연산을 기술합니다. 각 연산은 하나 이상의 관계를 받아 새로운 관계를 생성합니다.</p>
<div class="highlight"><pre><span></span><code>속성:
  - 폐쇄성(Closure): 모든 연산의 결과는 관계입니다
                     (연산의 조합을 가능하게 함)
  - 집합 의미론: 관계는 집합입니다 (중복 튜플 없음)
  - 기반: 집합 이론과 1차 논리를 기반으로 함
</code></pre></div>

<h3 id="_3">연산의 범주<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="err">관계</span><span class="w"> </span><span class="err">대수</span><span class="w"> </span><span class="err">연산</span><span class="p">(</span><span class="n">Relational</span><span class="w"> </span><span class="n">Algebra</span><span class="w"> </span><span class="n">Operations</span><span class="p">)</span><span class="w">      </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">기본</span><span class="p">(</span><span class="err">다른</span><span class="w"> </span><span class="err">연산으로</span><span class="w"> </span><span class="err">표현</span><span class="w"> </span><span class="err">불가</span><span class="p">)</span><span class="o">:</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">σ</span><span class="w">  </span><span class="err">선택</span><span class="p">(</span><span class="n">Selection</span><span class="p">)</span><span class="w">          </span><span class="p">(</span><span class="err">행</span><span class="w"> </span><span class="err">필터링</span><span class="p">)</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">π</span><span class="w">  </span><span class="err">프로젝션</span><span class="p">(</span><span class="n">Projection</span><span class="p">)</span><span class="w">      </span><span class="p">(</span><span class="err">열</span><span class="w"> </span><span class="err">선택</span><span class="p">)</span><span class="w">                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">ρ</span><span class="w">  </span><span class="err">재명명</span><span class="p">(</span><span class="n">Rename</span><span class="p">)</span><span class="w">            </span><span class="p">(</span><span class="err">관계</span><span class="o">/</span><span class="err">속성</span><span class="w"> </span><span class="err">이름</span><span class="w"> </span><span class="err">변경</span><span class="p">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">∪</span><span class="w">  </span><span class="err">합집합</span><span class="p">(</span><span class="n">Union</span><span class="p">)</span><span class="w">             </span><span class="p">(</span><span class="err">두</span><span class="w"> </span><span class="err">관계</span><span class="w"> </span><span class="err">결합</span><span class="p">)</span><span class="w">                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">−</span><span class="w">  </span><span class="err">차집합</span><span class="p">(</span><span class="n">Set</span><span class="w"> </span><span class="n">Difference</span><span class="p">)</span><span class="w">    </span><span class="p">(</span><span class="n">R에</span><span class="w"> </span><span class="err">있지만</span><span class="w"> </span><span class="n">S에</span><span class="w"> </span><span class="err">없는</span><span class="w"> </span><span class="err">튜플</span><span class="p">)</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">×</span><span class="w">  </span><span class="err">카티션</span><span class="w"> </span><span class="err">곱</span><span class="p">(</span><span class="n">Cartesian</span><span class="w"> </span><span class="n">Product</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="err">모든</span><span class="w"> </span><span class="err">조합</span><span class="p">)</span><span class="w">              </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="err">유도</span><span class="p">(</span><span class="err">기본</span><span class="w"> </span><span class="err">연산으로</span><span class="w"> </span><span class="err">표현</span><span class="w"> </span><span class="err">가능</span><span class="p">)</span><span class="o">:</span><span class="w">                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">⋈</span><span class="w">  </span><span class="err">조인</span><span class="p">(</span><span class="n">Join</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="err">다양한</span><span class="w"> </span><span class="err">유형</span><span class="p">)</span><span class="w">                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">∩</span><span class="w">  </span><span class="err">교집합</span><span class="p">(</span><span class="n">Intersection</span><span class="p">)</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">÷</span><span class="w">  </span><span class="err">나눗셈</span><span class="p">(</span><span class="n">Division</span><span class="p">)</span><span class="w">                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">←</span><span class="w">  </span><span class="err">대입</span><span class="p">(</span><span class="n">Assignment</span><span class="p">)</span><span class="w">                                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">δ</span><span class="w">  </span><span class="err">중복</span><span class="w"> </span><span class="err">제거</span><span class="p">(</span><span class="n">Duplicate</span><span class="w"> </span><span class="n">elimination</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="err">백</span><span class="w"> </span><span class="err">의미론용</span><span class="p">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">γ</span><span class="w">  </span><span class="err">그룹화</span><span class="o">/</span><span class="err">집계</span><span class="p">(</span><span class="n">Grouping</span><span class="o">/</span><span class="n">Aggregation</span><span class="p">)</span><span class="w">                      </span><span class="err">│</span>
<span class="err">│</span><span class="w">    </span><span class="err">τ</span><span class="w">  </span><span class="err">정렬</span><span class="p">(</span><span class="n">Sorting</span><span class="p">)</span><span class="w">                                         </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="_4">실행 예제 데이터베이스<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<p>이 강의 전체에서 다음 샘플 데이터베이스를 사용합니다:</p>
<div class="highlight"><pre><span></span><code>STUDENT:
┌──────┬───────────┬──────┬──────┐
│ sid  │ name      │ year │ dept │
├──────┼───────────┼──────┼──────┤
│ S001 │ Alice     │  3   │ CS   │
│ S002 │ Bob       │  2   │ CS   │
│ S003 │ Carol     │  4   │ EE   │
│ S004 │ Dave      │  3   │ ME   │
│ S005 │ Eve       │  1   │ CS   │
└──────┴───────────┴──────┴──────┘

COURSE:
┌───────┬──────────────────────┬─────────┬──────┐
│ cid   │ title                │ credits │ dept │
├───────┼──────────────────────┼─────────┼──────┤
│ CS101 │ Intro to CS          │ 3       │ CS   │
│ CS301 │ Database Theory      │ 3       │ CS   │
│ CS401 │ Machine Learning     │ 4       │ CS   │
│ EE201 │ Circuit Analysis     │ 3       │ EE   │
│ MA101 │ Calculus I           │ 4       │ MA   │
└───────┴──────────────────────┴─────────┴──────┘

ENROLLMENT:
┌──────┬───────┬───────┐
│ sid  │ cid   │ grade │
├──────┼───────┼───────┤
│ S001 │ CS101 │ A     │
│ S001 │ CS301 │ A+    │
│ S001 │ MA101 │ B+    │
│ S002 │ CS101 │ B     │
│ S002 │ CS301 │ A-    │
│ S003 │ EE201 │ A     │
│ S003 │ CS101 │ B+    │
│ S004 │ CS101 │ C     │
│ S005 │ CS101 │ A     │
│ S005 │ MA101 │ A-    │
└──────┴───────┴───────┘

INSTRUCTOR:
┌──────┬──────────┬──────┬────────┐
│ iid  │ name     │ dept │ salary │
├──────┼──────────┼──────┼────────┤
│ I001 │ Prof. Kim│ CS   │ 95000  │
│ I002 │ Prof. Lee│ CS   │ 88000  │
│ I003 │ Prof. Park│ EE  │ 92000  │
│ I004 │ Prof. Choi│ MA  │ 85000  │
└──────┴──────────┴──────┴────────┘
</code></pre></div>

<hr />
<h2 id="2">2. 단항 연산<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<p>단항 연산은 단일 관계를 입력으로 받습니다.</p>
<h3 id="sigma">선택 (sigma)<a class="header-link" href="#sigma" title="Permanent link">&para;</a></h3>
<p><strong>선택(Selection)</strong> 연산은 조건(predicate)을 기반으로 행을 필터링합니다.</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="err">σ</span><span class="n">_조건</span><span class="o">(</span><span class="n">R</span><span class="o">)</span>

<span class="err">출력</span><span class="o">:</span><span class="w">     </span><span class="err">조건을</span><span class="w"> </span><span class="err">만족하는</span><span class="w"> </span><span class="n">R의</span><span class="w"> </span><span class="err">튜플만을</span><span class="w"> </span><span class="err">포함하는</span><span class="w"> </span><span class="err">관계</span><span class="o">.</span>

<span class="err">스키마</span><span class="o">:</span><span class="w">   </span><span class="n">R과</span><span class="w"> </span><span class="err">동일</span><span class="w"> </span><span class="o">(</span><span class="err">모든</span><span class="w"> </span><span class="err">속성</span><span class="w"> </span><span class="err">유지</span><span class="o">)</span>
</code></pre></div>

<p><strong>형식적 정의:</strong></p>
<div class="highlight"><pre><span></span><code>σ_조건(R) = { t | t ∈ R  AND  condition(t)이 TRUE }
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">CS</span><span class="w"> </span><span class="n">학생</span><span class="w"> </span><span class="n">선택</span><span class="p">:</span>

<span class="w">   </span><span class="n">σ_</span><span class="err">{</span><span class="n">dept</span><span class="o">=</span><span class="err">&#39;</span><span class="n">CS</span><span class="err">&#39;}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>

<span class="w">   </span><span class="n">결과</span><span class="p">:</span>
<span class="w">   </span><span class="err">┌──────┬───────┬──────┬──────┐</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">sid</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">name</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="err">│</span>
<span class="w">   </span><span class="err">├──────┼───────┼──────┼──────┤</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">S001</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Alice</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="mf">3</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">S002</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Bob</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mf">2</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">S005</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Eve</span><span class="w">   </span><span class="err">│</span><span class="w">  </span><span class="mf">1</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">└──────┴───────┴──────┴──────┘</span>


<span class="mf">2.</span><span class="w"> </span><span class="mf">3</span><span class="n">학년</span><span class="w"> </span><span class="n">CS</span><span class="w"> </span><span class="n">학생</span><span class="w"> </span><span class="n">선택</span><span class="p">:</span>

<span class="w">   </span><span class="n">σ_</span><span class="err">{</span><span class="n">dept</span><span class="o">=</span><span class="err">&#39;</span><span class="n">CS</span><span class="err">&#39;</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="n">year</span><span class="o">=</span><span class="mf">3</span><span class="err">}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>

<span class="w">   </span><span class="n">결과</span><span class="p">:</span>
<span class="w">   </span><span class="err">┌──────┬───────┬──────┬──────┐</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">sid</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">name</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="err">│</span>
<span class="w">   </span><span class="err">├──────┼───────┼──────┼──────┤</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">S001</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Alice</span><span class="w"> </span><span class="err">│</span><span class="w">  </span><span class="mf">3</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">└──────┴───────┴──────┴──────┘</span>


<span class="mf">3.</span><span class="w"> </span><span class="mf">4</span><span class="n">학점</span><span class="w"> </span><span class="n">과목</span><span class="w"> </span><span class="n">선택</span><span class="p">:</span>

<span class="w">   </span><span class="n">σ_</span><span class="err">{</span><span class="n">credits</span><span class="o">=</span><span class="mf">4</span><span class="err">}</span><span class="p">(</span><span class="n">COURSE</span><span class="p">)</span>

<span class="w">   </span><span class="n">결과</span><span class="p">:</span>
<span class="w">   </span><span class="err">┌───────┬──────────────────┬─────────┬──────┐</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">cid</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">title</span><span class="w">            </span><span class="err">│</span><span class="w"> </span><span class="n">credits</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="err">│</span>
<span class="w">   </span><span class="err">├───────┼──────────────────┼─────────┼──────┤</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS401</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Machine</span><span class="w"> </span><span class="n">Learning</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="mf">4</span><span class="w">       </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">MA101</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">Calculus</span><span class="w"> </span><span class="n">I</span><span class="w">       </span><span class="err">│</span><span class="w"> </span><span class="mf">4</span><span class="w">       </span><span class="err">│</span><span class="w"> </span><span class="n">MA</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">└───────┴──────────────────┴─────────┴──────┘</span>
</code></pre></div>

<p><strong>선택 조건에 사용 가능한 것:</strong>
- 비교 연산자: =, ≠, &lt;, &gt;, ≤, ≥
- 논리 연결사: AND (∧), OR (∨), NOT (¬)
- 속성 이름과 상수</p>
<h3 id="pi">프로젝션 (pi)<a class="header-link" href="#pi" title="Permanent link">&para;</a></h3>
<p><strong>프로젝션(Projection)</strong> 연산은 특정 열(속성)을 선택하고 중복을 제거합니다.</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="err">π</span><span class="n">_</span><span class="o">{</span><span class="err">속성</span><span class="n">_목록</span><span class="o">}(</span><span class="n">R</span><span class="o">)</span>

<span class="err">출력</span><span class="o">:</span><span class="w">     </span><span class="err">지정된</span><span class="w"> </span><span class="err">속성만을</span><span class="w"> </span><span class="err">포함하는</span><span class="w"> </span><span class="err">관계</span><span class="o">,</span>
<span class="w">          </span><span class="err">중복</span><span class="w"> </span><span class="err">튜플</span><span class="w"> </span><span class="err">제거</span><span class="o">.</span>

<span class="err">스키마</span><span class="o">:</span><span class="w">   </span><span class="err">속성</span><span class="n">_목록의</span><span class="w"> </span><span class="err">속성만</span>
</code></pre></div>

<p><strong>형식적 정의:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">π_</span><span class="err">{</span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="n">A2</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">Ak</span><span class="err">}</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="o">&lt;</span><span class="n">t</span><span class="o">[</span><span class="n">A1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">[</span><span class="n">A2</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">t</span><span class="o">[</span><span class="n">Ak</span><span class="o">]&gt;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="err">}</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">학생</span><span class="w"> </span><span class="n">이름과</span><span class="w"> </span><span class="n">학과</span><span class="w"> </span><span class="n">프로젝션</span><span class="p">:</span>

<span class="w">   </span><span class="n">π_</span><span class="err">{</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">dept</span><span class="err">}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>

<span class="w">   </span><span class="n">결과</span><span class="p">:</span>
<span class="w">   </span><span class="err">┌───────┬──────┐</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">name</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="err">│</span>
<span class="w">   </span><span class="err">├───────┼──────┤</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Alice</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Bob</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Carol</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="n">EE</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Dave</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="n">ME</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Eve</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">└───────┴──────┘</span>


<span class="mf">2.</span><span class="w"> </span><span class="n">STUDENT에서</span><span class="w"> </span><span class="n">중복</span><span class="w"> </span><span class="n">없는</span><span class="w"> </span><span class="n">학과</span><span class="w"> </span><span class="n">프로젝션</span><span class="p">:</span>

<span class="w">   </span><span class="n">π_</span><span class="err">{</span><span class="n">dept</span><span class="err">}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>

<span class="w">   </span><span class="n">결과</span><span class="p">:</span>
<span class="w">   </span><span class="err">┌──────┐</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="err">│</span>
<span class="w">   </span><span class="err">├──────┤</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">CS</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">EE</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">ME</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">└──────┘</span>
<span class="w">   </span><span class="p">(</span><span class="n">참고</span><span class="p">:</span><span class="w"> </span><span class="n">CS는</span><span class="w"> </span><span class="n">중복이</span><span class="w"> </span><span class="n">제거되어</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">번만</span><span class="w"> </span><span class="n">나타남</span><span class="p">)</span>


<span class="mf">3.</span><span class="w"> </span><span class="n">선택과</span><span class="w"> </span><span class="n">프로젝션</span><span class="w"> </span><span class="n">조합</span><span class="p">:</span>

<span class="w">   </span><span class="s">&quot;CS 학생의 이름 찾기&quot;</span>
<span class="w">   </span><span class="n">π_</span><span class="err">{</span><span class="n">name</span><span class="err">}</span><span class="p">(</span><span class="n">σ_</span><span class="err">{</span><span class="n">dept</span><span class="o">=</span><span class="err">&#39;</span><span class="n">CS</span><span class="err">&#39;}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">))</span>

<span class="w">   </span><span class="mf">1</span><span class="n">단계</span><span class="p">:</span><span class="w"> </span><span class="n">σ_</span><span class="err">{</span><span class="n">dept</span><span class="o">=</span><span class="err">&#39;</span><span class="n">CS</span><span class="err">&#39;}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">{</span><span class="n">Alice</span><span class="o">/</span><span class="n">CS</span><span class="p">,</span><span class="w"> </span><span class="n">Bob</span><span class="o">/</span><span class="n">CS</span><span class="p">,</span><span class="w"> </span><span class="n">Eve</span><span class="o">/</span><span class="n">CS</span><span class="err">}</span>
<span class="w">   </span><span class="mf">2</span><span class="n">단계</span><span class="p">:</span><span class="w"> </span><span class="n">π_</span><span class="err">{</span><span class="n">name</span><span class="err">}</span><span class="p">(</span><span class="mf">...</span><span class="p">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">{</span><span class="n">Alice</span><span class="p">,</span><span class="w"> </span><span class="n">Bob</span><span class="p">,</span><span class="w"> </span><span class="n">Eve</span><span class="err">}</span>

<span class="w">   </span><span class="n">결과</span><span class="p">:</span>
<span class="w">   </span><span class="err">┌───────┐</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">name</span><span class="w">  </span><span class="err">│</span>
<span class="w">   </span><span class="err">├───────┤</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Alice</span><span class="w"> </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Bob</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">Eve</span><span class="w">   </span><span class="err">│</span>
<span class="w">   </span><span class="err">└───────┘</span>
</code></pre></div>

<h3 id="rho">재명명 (rho)<a class="header-link" href="#rho" title="Permanent link">&para;</a></h3>
<p><strong>재명명(Rename)</strong> 연산은 관계 및/또는 그 속성의 이름을 변경합니다.</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="err">ρ</span><span class="n">_</span><span class="o">{</span><span class="n">S</span><span class="o">(</span><span class="n">B1</span><span class="o">,</span><span class="w"> </span><span class="n">B2</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Bn</span><span class="o">)}(</span><span class="n">R</span><span class="o">)</span>

<span class="w">          </span><span class="err">관계</span><span class="w"> </span><span class="n">R을</span><span class="w"> </span><span class="n">S로</span><span class="w"> </span><span class="err">재명명하고</span><span class="w"> </span><span class="err">속성을</span><span class="w"> </span><span class="n">B1</span><span class="o">,</span><span class="w"> </span><span class="n">B2</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Bn으로</span><span class="w"> </span><span class="err">변경</span>

<span class="err">축약형</span><span class="o">:</span><span class="w">   </span><span class="err">ρ</span><span class="n">_S</span><span class="o">(</span><span class="n">R</span><span class="o">)</span><span class="w">          </span><span class="o">--</span><span class="w"> </span><span class="err">관계만</span><span class="w"> </span><span class="err">재명명</span>
<span class="w">          </span><span class="err">ρ</span><span class="n">_</span><span class="o">{(</span><span class="n">B1</span><span class="o">,...,</span><span class="n">Bn</span><span class="o">)}(</span><span class="n">R</span><span class="o">)</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="err">속성만</span><span class="w"> </span><span class="err">재명명</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">STUDENT를</span><span class="w"> </span><span class="n">S로</span><span class="w"> </span><span class="n">재명명</span><span class="p">:</span>

<span class="w">   </span><span class="n">ρ_S</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>
<span class="w">   </span><span class="err">→</span><span class="w"> </span><span class="n">동일한</span><span class="w"> </span><span class="n">튜플이지만</span><span class="w"> </span><span class="n">관계는</span><span class="w"> </span><span class="n">이제</span><span class="w"> </span><span class="n">S로</span><span class="w"> </span><span class="n">호출됨</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">자기</span><span class="w"> </span><span class="n">조인</span><span class="w"> </span><span class="n">준비를</span><span class="w"> </span><span class="n">위한</span><span class="w"> </span><span class="n">재명명</span><span class="p">:</span>

<span class="w">   </span><span class="n">ρ_</span><span class="err">{</span><span class="n">S1</span><span class="p">(</span><span class="n">sid1</span><span class="p">,</span><span class="w"> </span><span class="n">name1</span><span class="p">,</span><span class="w"> </span><span class="n">year1</span><span class="p">,</span><span class="w"> </span><span class="n">dept1</span><span class="p">)</span><span class="err">}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>
<span class="w">   </span><span class="n">ρ_</span><span class="err">{</span><span class="n">S2</span><span class="p">(</span><span class="n">sid2</span><span class="p">,</span><span class="w"> </span><span class="n">name2</span><span class="p">,</span><span class="w"> </span><span class="n">year2</span><span class="p">,</span><span class="w"> </span><span class="n">dept2</span><span class="p">)</span><span class="err">}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>

<span class="w">   </span><span class="n">이제</span><span class="w"> </span><span class="n">속성</span><span class="w"> </span><span class="n">이름</span><span class="w"> </span><span class="n">충돌</span><span class="w"> </span><span class="n">없이</span><span class="w"> </span><span class="n">S1과</span><span class="w"> </span><span class="n">S2를</span><span class="w"> </span><span class="n">조인할</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">있습니다</span><span class="mf">.</span>

<span class="mf">3.</span><span class="w"> </span><span class="n">실용적</span><span class="w"> </span><span class="n">사용</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">같은</span><span class="w"> </span><span class="n">학과의</span><span class="w"> </span><span class="n">학생</span><span class="w"> </span><span class="n">쌍</span><span class="w"> </span><span class="n">찾기</span><span class="p">:</span>

<span class="w">   </span><span class="n">σ_</span><span class="err">{</span><span class="n">S1</span><span class="mf">.</span><span class="n">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S2</span><span class="mf">.</span><span class="n">dept</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="n">S1</span><span class="mf">.</span><span class="n">sid</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">S2</span><span class="mf">.</span><span class="n">sid</span><span class="err">}</span><span class="p">(</span>
<span class="w">       </span><span class="n">ρ_</span><span class="err">{</span><span class="n">S1</span><span class="p">(</span><span class="n">sid1</span><span class="p">,</span><span class="w"> </span><span class="n">name1</span><span class="p">,</span><span class="w"> </span><span class="n">year1</span><span class="p">,</span><span class="w"> </span><span class="n">dept1</span><span class="p">)</span><span class="err">}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span><span class="w"> </span><span class="err">×</span>
<span class="w">       </span><span class="n">ρ_</span><span class="err">{</span><span class="n">S2</span><span class="p">(</span><span class="n">sid2</span><span class="p">,</span><span class="w"> </span><span class="n">name2</span><span class="p">,</span><span class="w"> </span><span class="n">year2</span><span class="p">,</span><span class="w"> </span><span class="n">dept2</span><span class="p">)</span><span class="err">}</span><span class="p">(</span><span class="n">STUDENT</span><span class="p">)</span>
<span class="w">   </span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3">3. 집합 연산<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<p>집합 연산은 <strong>합병 호환(union-compatible)</strong> (또는 타입 호환) 관계를 요구합니다. 동일한 수의 속성을 가져야 하며, 대응하는 속성들은 호환 가능한 도메인을 가져야 합니다.</p>
<div class="highlight"><pre><span></span><code>합병 호환성:
  R(A1: D1, A2: D2, ..., An: Dn)
  S(B1: D1, B2: D2, ..., Bn: Dn)

  동일한 수의 속성 (n)과 호환 가능한 도메인.
  속성 이름은 다를 수 있음 (결과는 관례적으로 R의 이름 사용).
</code></pre></div>

<h3 id="_5">합집합<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="w"> </span><span class="err">∪</span><span class="w"> </span><span class="n">S</span>

<span class="err">출력</span><span class="o">:</span><span class="w">     </span><span class="n">R</span><span class="o">,</span><span class="w"> </span><span class="n">S</span><span class="o">,</span><span class="w"> </span><span class="err">또는</span><span class="w"> </span><span class="err">둘</span><span class="w"> </span><span class="err">다에</span><span class="w"> </span><span class="err">있는</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">튜플</span><span class="o">.</span>
<span class="w">          </span><span class="err">중복</span><span class="w"> </span><span class="err">제거됨</span><span class="o">.</span>

<span class="n">R</span><span class="w"> </span><span class="err">∪</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">R</span><span class="w">  </span><span class="n">OR</span><span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code>CS_STUDENTS = π_{sid, name}(σ_{dept=&#39;CS&#39;}(STUDENT))
┌──────┬───────┐
│ sid  │ name  │
├──────┼───────┤
│ S001 │ Alice │
│ S002 │ Bob   │
│ S005 │ Eve   │
└──────┴───────┘

YEAR3_STUDENTS = π_{sid, name}(σ_{year=3}(STUDENT))
┌──────┬───────┐
│ sid  │ name  │
├──────┼───────┤
│ S001 │ Alice │
│ S004 │ Dave  │
└──────┴───────┘

CS_STUDENTS ∪ YEAR3_STUDENTS =
┌──────┬───────┐
│ sid  │ name  │
├──────┼───────┤
│ S001 │ Alice │  ← 둘 다에 나타나지만 한 번만 나열
│ S002 │ Bob   │
│ S005 │ Eve   │
│ S004 │ Dave  │
└──────┴───────┘
</code></pre></div>

<h3 id="_6">차집합<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="w"> </span><span class="err">−</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="o">(</span><span class="err">또는</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">\</span><span class="w"> </span><span class="n">S</span><span class="o">)</span>

<span class="err">출력</span><span class="o">:</span><span class="w">     </span><span class="n">R에는</span><span class="w"> </span><span class="err">있지만</span><span class="w"> </span><span class="n">S에는</span><span class="w"> </span><span class="err">없는</span><span class="w"> </span><span class="err">튜플</span><span class="o">.</span>

<span class="n">R</span><span class="w"> </span><span class="err">−</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">R</span><span class="w">  </span><span class="n">AND</span><span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="err">∉</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code>&quot;3학년이 아닌 CS 학생&quot;

CS_STUDENTS − YEAR3_STUDENTS =
┌──────┬──────┐
│ sid  │ name │
├──────┼──────┤
│ S002 │ Bob  │
│ S005 │ Eve  │
└──────┴──────┘

참고: Alice (S001)는 YEAR3_STUDENTS에 있기 때문에 제거됨.
참고: R − S ≠ S − R  (차집합은 교환법칙이 성립하지 않음)

YEAR3_STUDENTS − CS_STUDENTS =
┌──────┬──────┐
│ sid  │ name │
├──────┼──────┤
│ S004 │ Dave │
└──────┴──────┘
</code></pre></div>

<h3 id="_7">교집합<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="w"> </span><span class="err">∩</span><span class="w"> </span><span class="n">S</span>

<span class="err">출력</span><span class="o">:</span><span class="w">     </span><span class="n">R과</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="err">둘</span><span class="w"> </span><span class="err">다에</span><span class="w"> </span><span class="err">있는</span><span class="w"> </span><span class="err">튜플</span><span class="o">.</span>

<span class="n">R</span><span class="w"> </span><span class="err">∩</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">R</span><span class="w">  </span><span class="n">AND</span><span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">}</span>

<span class="err">참고</span><span class="o">:</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="err">∩</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="err">−</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="w"> </span><span class="err">−</span><span class="w"> </span><span class="n">S</span><span class="o">)</span><span class="w">  </span><span class="o">(</span><span class="err">교집합은</span><span class="w"> </span><span class="err">유도</span><span class="w"> </span><span class="err">가능</span><span class="o">)</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code>&quot;CS이면서 3학년인 학생&quot;

CS_STUDENTS ∩ YEAR3_STUDENTS =
┌──────┬───────┐
│ sid  │ name  │
├──────┼───────┤
│ S001 │ Alice │
└──────┴───────┘
</code></pre></div>

<h3 id="_8">집합 연산 요약<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>     R           S                R ∪ S         R − S         R ∩ S

  ┌──────┐   ┌──────┐         ┌──────┐      ┌──────┐     ┌──────┐
  │ a    │   │ a    │         │ a    │      │ b    │     │ a    │
  │ b    │   │ a    │         │ b    │      │ c    │     │      │
  │ c    │   │ d    │         │ c    │      └──────┘     └──────┘
  └──────┘   └──────┘         │ d    │
                              └──────┘

  벤 다이어그램:
       ┌─────────────┐
       │  R          │
       │      ┌──────┼──────┐
       │      │ R∩S  │      │
       │      │      │   S  │
       └──────┼──────┘      │
              │             │
              └─────────────┘

  R ∪ S = 전체 음영 영역
  R − S = 왼쪽만 (겹치지 않음)
  R ∩ S = 겹치는 부분만
  S − R = 오른쪽만 (겹치지 않음)
</code></pre></div>

<hr />
<h2 id="4">4. 이항 연산: 카티션 곱과 조인<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="_9">카티션 곱 (크로스 곱)<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="n">S</span>

<span class="err">출력</span><span class="o">:</span><span class="w">     </span><span class="n">R의</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">튜플과</span><span class="w"> </span><span class="n">S의</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">튜플의</span><span class="w"> </span><span class="err">결합</span><span class="o">.</span>
<span class="w">          </span><span class="n">R이</span><span class="w"> </span><span class="n">n개의</span><span class="w"> </span><span class="err">튜플</span><span class="o">,</span><span class="w"> </span><span class="n">S가</span><span class="w"> </span><span class="n">m개의</span><span class="w"> </span><span class="err">튜플이면</span><span class="o">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="n">S는</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="n">m개의</span><span class="w"> </span><span class="err">튜플</span><span class="o">.</span>
<span class="w">          </span><span class="n">R이</span><span class="w"> </span><span class="n">p개의</span><span class="w"> </span><span class="err">속성</span><span class="o">,</span><span class="w"> </span><span class="n">S가</span><span class="w"> </span><span class="n">q개의</span><span class="w"> </span><span class="err">속성이면</span><span class="o">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="n">S는</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q개의</span><span class="w"> </span><span class="err">속성</span><span class="o">.</span>
</code></pre></div>

<p><strong>형식적 정의:</strong></p>
<div class="highlight"><pre><span></span><code>R × S = { &lt;t_r, t_s&gt; | t_r ∈ R  AND  t_s ∈ S }
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code>A = {(a1, b1), (a2, b2)}     B = {(c1, d1), (c2, d2), (c3, d3)}

A × B =
┌────┬────┬────┬────┐
│ A  │ B  │ C  │ D  │
├────┼────┼────┼────┤
│ a1 │ b1 │ c1 │ d1 │
│ a1 │ b1 │ c2 │ d2 │
│ a1 │ b1 │ c3 │ d3 │
│ a2 │ b2 │ c1 │ d1 │
│ a2 │ b2 │ c2 │ d2 │
│ a2 │ b2 │ c3 │ d3 │
└────┴────┴────┴────┘

|A| = 2, |B| = 3, |A × B| = 2 × 3 = 6
</code></pre></div>

<p>카티션 곱 자체는 많은 의미 없는 조합을 생성하기 때문에 거의 유용하지 않습니다. 선택과 결합할 때(조인을 제공) 강력해집니다.</p>
<h3 id="_10">세타 조인<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<p><strong>세타 조인(Theta Join)</strong>은 카티션 곱과 선택을 결합합니다:</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="w"> </span><span class="err">⋈</span><span class="n">_θ</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="o">(</span><span class="err">여기서</span><span class="w"> </span><span class="err">θ는</span><span class="w"> </span><span class="err">조건</span><span class="o">)</span>

<span class="err">정의</span><span class="o">:</span><span class="w">     </span><span class="n">R</span><span class="w"> </span><span class="err">⋈</span><span class="n">_θ</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">σ</span><span class="n">_θ</span><span class="o">(</span><span class="n">R</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="n">S</span><span class="o">)</span>

<span class="err">조건</span><span class="w"> </span><span class="err">θ는</span><span class="w"> </span><span class="o">=,</span><span class="w"> </span><span class="err">≠</span><span class="o">,</span><span class="w"> </span><span class="o">&lt;,</span><span class="w"> </span><span class="o">&gt;,</span><span class="w"> </span><span class="err">≤</span><span class="o">,</span><span class="w"> </span><span class="err">≥</span><span class="w"> </span><span class="err">등의</span><span class="w"> </span><span class="err">비교를</span><span class="w"> </span><span class="err">사용할</span><span class="w"> </span><span class="err">수</span><span class="w"> </span><span class="err">있음</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code>&quot;같은 학과의 학생과 과목 찾기&quot;

STUDENT ⋈_{STUDENT.dept = COURSE.dept} COURSE

동치: σ_{STUDENT.dept = COURSE.dept}(STUDENT × COURSE)

결과 (일부):
┌──────┬───────┬──────┬──────┬───────┬──────────────────┬─────────┬───────┐
│ sid  │ name  │ year │ s.dept│ cid  │ title            │ credits │c.dept │
├──────┼───────┼──────┼──────┼───────┼──────────────────┼─────────┼───────┤
│ S001 │ Alice │  3   │ CS   │ CS101 │ Intro to CS      │ 3       │ CS    │
│ S001 │ Alice │  3   │ CS   │ CS301 │ Database Theory  │ 3       │ CS    │
│ S001 │ Alice │  3   │ CS   │ CS401 │ Machine Learning │ 4       │ CS    │
│ S002 │ Bob   │  2   │ CS   │ CS101 │ Intro to CS      │ 3       │ CS    │
│ S002 │ Bob   │  2   │ CS   │ CS301 │ Database Theory  │ 3       │ CS    │
│ S002 │ Bob   │  2   │ CS   │ CS401 │ Machine Learning │ 4       │ CS    │
│ S003 │ Carol │  4   │ EE   │ EE201 │ Circuit Analysis │ 3       │ EE    │
│ S005 │ Eve   │  1   │ CS   │ CS101 │ Intro to CS      │ 3       │ CS    │
│ S005 │ Eve   │  1   │ CS   │ CS301 │ Database Theory  │ 3       │ CS    │
│ S005 │ Eve   │  1   │ CS   │ CS401 │ Machine Learning │ 4       │ CS    │
└──────┴───────┴──────┴──────┴───────┴──────────────────┴─────────┴───────┘
(Dave/ME는 일치하는 과목이 없어 결과에 없음)
</code></pre></div>

<h3 id="_11">동등 조인<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<p><strong>동등 조인(Equi-Join)</strong>은 조건이 동등(=)만 사용하는 세타 조인입니다:</p>
<div class="highlight"><pre><span></span><code>R ⋈_{R.A = S.B} S

모든 동등 조인은 세타 조인이지만, 모든 세타 조인이 동등 조인은 아님.
R.A &gt; S.B를 사용하는 세타 조인은 동등 조인이 아님.
</code></pre></div>

<h3 id="_12">자연 조인<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<p><strong>자연 조인(Natural Join)</strong>은 다음과 같은 특별한 동등 조인입니다:
1. 모든 공통 속성 이름에서 조인
2. 결과에서 중복 열 제거</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="w"> </span><span class="err">⋈</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="o">(</span><span class="err">아래</span><span class="w"> </span><span class="err">첨자</span><span class="w"> </span><span class="err">없음</span><span class="o">)</span>

<span class="err">정의</span><span class="o">:</span><span class="w">     </span><span class="n">R과</span><span class="w"> </span><span class="n">S에서</span><span class="w"> </span><span class="err">같은</span><span class="w"> </span><span class="err">이름을</span><span class="w"> </span><span class="err">가진</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">속성에서</span><span class="w"> </span><span class="err">조인한</span><span class="w"> </span><span class="err">후</span><span class="o">,</span>
<span class="w">          </span><span class="err">중복</span><span class="w"> </span><span class="err">속성</span><span class="w"> </span><span class="err">열을</span><span class="w"> </span><span class="err">프로젝션으로</span><span class="w"> </span><span class="err">제거</span><span class="o">.</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code>STUDENT ⋈ ENROLLMENT

공통 속성: sid

1단계: STUDENT.sid = ENROLLMENT.sid에서 동등 조인
2단계: 중복 sid 열 제거

결과:
┌──────┬───────┬──────┬──────┬───────┬───────┐
│ sid  │ name  │ year │ dept │ cid   │ grade │
├──────┼───────┼──────┼──────┼───────┼───────┤
│ S001 │ Alice │  3   │ CS   │ CS101 │ A     │
│ S001 │ Alice │  3   │ CS   │ CS301 │ A+    │
│ S001 │ Alice │  3   │ CS   │ MA101 │ B+    │
│ S002 │ Bob   │  2   │ CS   │ CS101 │ B     │
│ S002 │ Bob   │  2   │ CS   │ CS301 │ A-    │
│ S003 │ Carol │  4   │ EE   │ EE201 │ A     │
│ S003 │ Carol │  4   │ EE   │ CS101 │ B+    │
│ S004 │ Dave  │  3   │ ME   │ CS101 │ C     │
│ S005 │ Eve   │  1   │ CS   │ CS101 │ A     │
│ S005 │ Eve   │  1   │ CS   │ MA101 │ A-    │
└──────┴───────┴──────┴──────┴───────┴───────┘

경고: 관계가 의도치 않게 속성 이름을 공유할 때 자연 조인에 주의!

STUDENT(sid, name, year, dept) ⋈ COURSE(cid, title, credits, dept)
                          ^^^^                                ^^^^
이는 &#39;dept&#39;에서 조인하는데, 원하는 것이 아닐 수 있음!
학생을 그들의 학과의 과목과 매칭시킴.
</code></pre></div>

<h3 id="_13">외부 조인<a class="header-link" href="#_13" title="Permanent link">&para;</a></h3>
<p>표준 조인은 매칭되지 않는 튜플을 버립니다. <strong>외부 조인(Outer Join)</strong>은 NULL로 채워서 매칭되지 않는 튜플을 보존합니다.</p>
<div class="highlight"><pre><span></span><code>세 가지 유형:

1. 왼쪽 외부 조인(LEFT OUTER JOIN) (⟕):
   왼쪽 관계의 모든 튜플 유지.
   오른쪽에 매칭이 없으면 NULL로 채움.

2. 오른쪽 외부 조인(RIGHT OUTER JOIN) (⟖):
   오른쪽 관계의 모든 튜플 유지.
   왼쪽에 매칭이 없으면 NULL로 채움.

3. 완전 외부 조인(FULL OUTER JOIN) (⟗):
   양쪽 관계의 모든 튜플 유지.
   필요에 따라 양쪽을 NULL로 채움.
</code></pre></div>

<p><strong>예제: 왼쪽 외부 조인</strong></p>
<div class="highlight"><pre><span></span><code>STUDENT ⟕_{STUDENT.sid = ENROLLMENT.sid} ENROLLMENT

&quot;등록이 없는 학생을 포함하여 모든 학생과 그들의 등록 찾기&quot;

(데이터에서 S004/Dave가 등록이 없다고 가정.)

Dave가 등록이 없다면:

결과:
┌──────┬───────┬──────┬──────┬───────┬───────┐
│ sid  │ name  │ year │ dept │ cid   │ grade │
├──────┼───────┼──────┼──────┼───────┼───────┤
│ S001 │ Alice │  3   │ CS   │ CS101 │ A     │
│ S001 │ Alice │  3   │ CS   │ CS301 │ A+    │
│ S001 │ Alice │  3   │ CS   │ MA101 │ B+    │
│ S002 │ Bob   │  2   │ CS   │ CS101 │ B     │
│ S002 │ Bob   │  2   │ CS   │ CS301 │ A-    │
│ S003 │ Carol │  4   │ EE   │ EE201 │ A     │
│ S003 │ Carol │  4   │ EE   │ CS101 │ B+    │
│ S004 │ Dave  │  3   │ ME   │ NULL  │ NULL  │  ← NULL로 보존됨
│ S005 │ Eve   │  1   │ CS   │ CS101 │ A     │
│ S005 │ Eve   │  1   │ CS   │ MA101 │ A-    │
└──────┴───────┴──────┴──────┴───────┴───────┘
</code></pre></div>

<h3 id="_14">조인 비교 요약<a class="header-link" href="#_14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌──────────────────────────────────────────────────────────────────┐
│                        조인 유형                                   │
│                                                                  │
│  카티션 곱         R × S      모든 조합 (n × m 튜플)              │
│  세타 조인         R ⋈_θ S    카티션 + θ 선택                    │
│  동등 조인         R ⋈_{=} S  동등만 사용하는 세타 조인           │
│  자연 조인         R ⋈ S      공통 속성에서 동등 조인,            │
│                                중복 제거                          │
│  왼쪽 외부 조인    R ⟕ S      자연 + 매칭 안된 R 유지            │
│  오른쪽 외부 조인  R ⟖ S      자연 + 매칭 안된 S 유지            │
│  완전 외부 조인    R ⟗ S      자연 + 매칭 안된 모두 유지         │
│  세미 조인        R ⋉ S       S에 매칭이 있는 R의 튜플           │
│  안티 조인        R ▷ S       S에 매칭이 없는 R의 튜플           │
└──────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="_15">세미 조인과 안티 조인<a class="header-link" href="#_15" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>세미 조인:  R ⋉ S = π_{attrs(R)}(R ⋈ S)

&quot;S에 매칭되는 튜플이 있는 R의 튜플 반환&quot;
(결과에는 R의 속성만 나타남)

안티 조인:  R ▷ S = R − π_{attrs(R)}(R ⋈ S)

&quot;S에 매칭되는 튜플이 없는 R의 튜플 반환&quot;
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code>&quot;최소 한 과목에 등록한 학생&quot; (세미 조인):
STUDENT ⋉ ENROLLMENT
→ ENROLLMENT에 나타나는 STUDENT의 모든 학생

&quot;어떤 과목에도 등록하지 않은 학생&quot; (안티 조인):
STUDENT ▷ ENROLLMENT
→ 매칭되는 등록이 없는 학생
</code></pre></div>

<hr />
<h2 id="5">5. 나눗셈<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<p><strong>나눗셈(Division)</strong> 연산은 "모든(for all)" 쿼리에 답합니다. 관계 대수에서 가장 강력하면서도 가장 직관적이지 않은 연산 중 하나입니다.</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="w"> </span><span class="err">÷</span><span class="w"> </span><span class="n">S</span>

<span class="err">주어진</span><span class="o">:</span><span class="w">   </span><span class="n">R</span><span class="o">(</span><span class="n">A1</span><span class="o">,</span><span class="w"> </span><span class="n">A2</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">An</span><span class="o">,</span><span class="w"> </span><span class="n">B1</span><span class="o">,</span><span class="w"> </span><span class="n">B2</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Bm</span><span class="o">)</span>
<span class="w">          </span><span class="n">S</span><span class="o">(</span><span class="n">B1</span><span class="o">,</span><span class="w"> </span><span class="n">B2</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Bm</span><span class="o">)</span>

<span class="err">결과</span><span class="o">:</span><span class="w">     </span><span class="n">S의</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">튜플</span><span class="w"> </span><span class="n">s에</span><span class="w"> </span><span class="err">대해</span><span class="o">,</span><span class="w"> </span><span class="err">튜플</span><span class="w"> </span><span class="o">&lt;</span><span class="n">t</span><span class="o">,</span><span class="w"> </span><span class="n">s</span><span class="o">&gt;</span><span class="err">가</span><span class="w"> </span><span class="n">R에</span><span class="w"> </span><span class="err">있는</span>
<span class="w">          </span><span class="o">{</span><span class="n">A1</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">An</span><span class="o">}</span><span class="err">에</span><span class="w"> </span><span class="err">대한</span><span class="w"> </span><span class="err">튜플</span><span class="w"> </span><span class="n">t</span><span class="o">.</span>

<span class="err">형식적으로</span><span class="o">:</span>
<span class="w">  </span><span class="n">R</span><span class="w"> </span><span class="err">÷</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="err">π</span><span class="n">_</span><span class="o">{</span><span class="n">A</span><span class="o">}(</span><span class="n">R</span><span class="o">)</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="err">∀</span><span class="n">s</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">t</span><span class="o">,</span><span class="n">s</span><span class="o">&gt;</span><span class="w"> </span><span class="err">∈</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">}</span>

<span class="w">  </span><span class="err">여기서</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="n">A1</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">An</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">R에는</span><span class="w"> </span><span class="err">있지만</span><span class="w"> </span><span class="n">S에는</span><span class="w"> </span><span class="err">없는</span><span class="w"> </span><span class="err">속성</span><span class="o">)</span>
</code></pre></div>

<h3 id="_16">기본 연산으로 표현된 나눗셈<a class="header-link" href="#_16" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>R ÷ S = π_A(R) − π_A( (π_A(R) × S) − R )

설명:
  1. π_A(R)              = R의 모든 가능한 A-값
  2. π_A(R) × S          = 모든 A-값과 모든 S-튜플의 짝
  3. (π_A(R) × S) − R    = R에서 빠진 조합
  4. π_A(...)             = 최소 하나의 S-튜플이 빠진 A-값
  5. π_A(R) − ...         = S-튜플이 하나도 빠지지 않은 A-값
                          = 모든 S-튜플과 연관된 A-값
</code></pre></div>

<h3 id="_17">나눗셈 예제<a class="header-link" href="#_17" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>&quot;모든 CS 과목에 등록한 학생 찾기&quot;

1단계: 피제수 정의 (학생-과목 쌍)
  R = π_{sid, cid}(ENROLLMENT)
  ┌──────┬───────┐
  │ sid  │ cid   │
  ├──────┼───────┤
  │ S001 │ CS101 │
  │ S001 │ CS301 │
  │ S001 │ MA101 │
  │ S002 │ CS101 │
  │ S002 │ CS301 │
  │ S003 │ EE201 │
  │ S003 │ CS101 │
  │ S004 │ CS101 │
  │ S005 │ CS101 │
  │ S005 │ MA101 │
  └──────┴───────┘

2단계: 제수 정의 (모든 CS 과목)
  S = π_{cid}(σ_{dept=&#39;CS&#39;}(COURSE))
  ┌───────┐
  │ cid   │
  ├───────┤
  │ CS101 │
  │ CS301 │
  │ CS401 │
  └───────┘

3단계: R ÷ S = {CS101, CS301, CS401} 모두와 연관된 학생

  각 학생 확인:
    S001: {CS101, CS301}이 있지만 CS401이 없음 → ✗
    S002: {CS101, CS301}이 있지만 CS401이 없음 → ✗
    S003: {CS101}만 있음                       → ✗
    S004: {CS101}만 있음                       → ✗
    S005: {CS101}만 있음                       → ✗

  결과: 공집합 (세 CS 과목 모두에 등록한 학생 없음)

CS401이 과목 목록에 없다면 (CS101과 CS301만):
  S = {CS101, CS301}
  S001: {CS101, CS301} 있음 → ✓
  S002: {CS101, CS301} 있음 → ✓
  기타: ✗

  결과:
  ┌──────┐
  │ sid  │
  ├──────┤
  │ S001 │
  │ S002 │
  └──────┘
</code></pre></div>

<hr />
<h2 id="6">6. 추가 연산<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="_18">집계와 그룹화<a class="header-link" href="#_18" title="Permanent link">&para;</a></h3>
<p><strong>그룹화/집계(Grouping/Aggregation)</strong> 연산자는 집계 함수를 지원하도록 관계 대수를 확장합니다.</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">_</span><span class="o">{</span><span class="n">G1</span><span class="o">,</span><span class="w"> </span><span class="n">G2</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Gn</span><span class="o">}</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="n">_</span><span class="o">{</span><span class="n">F1</span><span class="o">(</span><span class="n">A1</span><span class="o">),</span><span class="w"> </span><span class="n">F2</span><span class="o">(</span><span class="n">A2</span><span class="o">),</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Fk</span><span class="o">(</span><span class="n">Ak</span><span class="o">)}</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="o">)</span>

<span class="w">            </span><span class="err">또는</span><span class="w"> </span><span class="err">더</span><span class="w"> </span><span class="err">일반적으로</span><span class="o">:</span>

<span class="w">            </span><span class="err">γ</span><span class="n">_</span><span class="o">{</span><span class="n">G</span><span class="o">;</span><span class="w"> </span><span class="n">F1</span><span class="o">(</span><span class="n">A1</span><span class="o">)</span><span class="w"> </span><span class="n">AS</span><span class="w"> </span><span class="n">name1</span><span class="o">,</span><span class="w"> </span><span class="o">...}(</span><span class="n">R</span><span class="o">)</span>

<span class="err">여기서</span><span class="o">:</span>
<span class="w">  </span><span class="n">G1</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Gn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">그룹화</span><span class="w"> </span><span class="err">속성</span>
<span class="w">  </span><span class="n">F1</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Fk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">집계</span><span class="w"> </span><span class="err">함수</span><span class="w"> </span><span class="o">(</span><span class="n">COUNT</span><span class="o">,</span><span class="w"> </span><span class="n">SUM</span><span class="o">,</span><span class="w"> </span><span class="n">AVG</span><span class="o">,</span><span class="w"> </span><span class="n">MIN</span><span class="o">,</span><span class="w"> </span><span class="n">MAX</span><span class="o">)</span>
<span class="w">  </span><span class="n">A1</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="n">Ak</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">집계할</span><span class="w"> </span><span class="err">속성</span>
</code></pre></div>

<p><strong>예제:</strong></p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;학과별 학생 수&quot;</span>

<span class="nt">γ_</span><span class="p">{</span><span class="err">dept</span><span class="p">;</span><span class="w"> </span><span class="err">COUNT(sid)</span><span class="w"> </span><span class="err">AS</span><span class="w"> </span><span class="err">count</span><span class="p">}</span><span class="o">(</span><span class="nt">STUDENT</span><span class="o">)</span>

<span class="nt">결과</span><span class="o">:</span>
<span class="err">┌──────┬───────┐</span>
<span class="err">│</span><span class="w"> </span><span class="nt">dept</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">count</span><span class="w"> </span><span class="err">│</span>
<span class="err">├──────┼───────┤</span>
<span class="err">│</span><span class="w"> </span><span class="nt">CS</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">3</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="nt">EE</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">1</span><span class="w">     </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="nt">ME</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">1</span><span class="w">     </span><span class="err">│</span>
<span class="err">└──────┴───────┘</span>


<span class="s2">&quot;학과별 평균 급여 (교수용)&quot;</span>

<span class="nt">γ_</span><span class="p">{</span><span class="err">dept</span><span class="p">;</span><span class="w"> </span><span class="err">AVG(salary)</span><span class="w"> </span><span class="err">AS</span><span class="w"> </span><span class="err">avg_sal,</span><span class="w"> </span><span class="err">COUNT(*)</span><span class="w"> </span><span class="err">AS</span><span class="w"> </span><span class="err">num</span><span class="p">}</span><span class="o">(</span><span class="nt">INSTRUCTOR</span><span class="o">)</span>

<span class="nt">결과</span><span class="o">:</span>
<span class="err">┌──────┬─────────┬─────┐</span>
<span class="err">│</span><span class="w"> </span><span class="nt">dept</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">avg_sal</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">num</span><span class="w"> </span><span class="err">│</span>
<span class="err">├──────┼─────────┼─────┤</span>
<span class="err">│</span><span class="w"> </span><span class="nt">CS</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">91500</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">2</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="nt">EE</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">92000</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">1</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="nt">MA</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">85000</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">1</span><span class="w">   </span><span class="err">│</span>
<span class="err">└──────┴─────────┴─────┘</span>
</code></pre></div>

<h3 id="_19">대입<a class="header-link" href="#_19" title="Permanent link">&para;</a></h3>
<p><strong>대입(Assignment)</strong> 연산자는 중간 결과를 저장합니다:</p>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="n">temp</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="err">표현식</span>

<span class="err">예제</span><span class="o">:</span>
<span class="w">  </span><span class="n">CS_STUDENTS</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="err">σ</span><span class="n">_</span><span class="o">{</span><span class="n">dept</span><span class="o">=</span><span class="s1">&#39;CS&#39;</span><span class="o">}(</span><span class="n">STUDENT</span><span class="o">)</span>
<span class="w">  </span><span class="n">CS_NAMES</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="err">π</span><span class="n">_</span><span class="o">{</span><span class="n">name</span><span class="o">}(</span><span class="n">CS_STUDENTS</span><span class="o">)</span>
</code></pre></div>

<h3 id="_20">정렬<a class="header-link" href="#_20" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">표기법</span><span class="o">:</span><span class="w">   </span><span class="err">τ</span><span class="n">_</span><span class="o">{</span><span class="n">A1</span><span class="w"> </span><span class="n">ASC</span><span class="o">,</span><span class="w"> </span><span class="n">A2</span><span class="w"> </span><span class="n">DESC</span><span class="o">}(</span><span class="n">R</span><span class="o">)</span>

<span class="err">참고</span><span class="o">:</span><span class="w"> </span><span class="err">정렬은</span><span class="w"> </span><span class="err">집합이</span><span class="w"> </span><span class="err">아닌</span><span class="w"> </span><span class="err">리스트를</span><span class="w"> </span><span class="err">생성</span><span class="o">.</span><span class="w"> </span><span class="err">엄밀히</span><span class="w"> </span><span class="err">말하면</span><span class="o">,</span>
<span class="w">      </span><span class="err">순수</span><span class="w"> </span><span class="err">관계</span><span class="w"> </span><span class="err">대수</span><span class="o">(</span><span class="err">집합만</span><span class="w"> </span><span class="err">생성</span><span class="o">)</span><span class="err">를</span><span class="w"> </span><span class="err">넘어감</span><span class="o">.</span>
</code></pre></div>

<hr />
<h2 id="7">7. 쿼리 트리와 대수적 최적화<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="_21">쿼리 트리<a class="header-link" href="#_21" title="Permanent link">&para;</a></h3>
<p><strong>쿼리 트리(Query Tree)</strong> (또는 연산자 트리)는 관계 대수 표현식을 트리로 표현한 것입니다:
- 리프 노드는 기본 관계
- 내부 노드는 관계 대수 연산
- 루트는 최종 결과 생성</p>
<p><strong>예제:</strong> "CS301에 등록한 CS 학생의 이름 찾기"</p>
<div class="highlight"><pre><span></span><code>관계 대수:
  π_{name}(σ_{dept=&#39;CS&#39; AND cid=&#39;CS301&#39;}(STUDENT ⋈ ENROLLMENT))

쿼리 트리:

              π_{name}
                 │
          σ_{dept=&#39;CS&#39; AND cid=&#39;CS301&#39;}
                 │
                ⋈_{sid=sid}
               / \
          STUDENT  ENROLLMENT
</code></pre></div>

<h3 id="_22">대수적 최적화<a class="header-link" href="#_22" title="Permanent link">&para;</a></h3>
<p>쿼리 최적화기는 <strong>동치 규칙(equivalence rules)</strong>을 사용하여 쿼리 트리를 변환해 더 효율적인 실행 계획을 찾습니다.</p>
<h3 id="_23">주요 동치 규칙<a class="header-link" href="#_23" title="Permanent link">&para;</a></h3>
<p><strong>규칙 1: 선택의 연쇄(Cascade of Selection)</strong></p>
<div class="highlight"><pre><span></span><code>σ_{c1 AND c2}(R) = σ_{c1}(σ_{c2}(R))

연결된 선택은 일련의 선택으로 분리 가능.
</code></pre></div>

<p><strong>규칙 2: 선택의 교환법칙(Commutativity of Selection)</strong></p>
<div class="highlight"><pre><span></span><code>σ_{c1}(σ_{c2}(R)) = σ_{c2}(σ_{c1}(R))

선택의 순서는 중요하지 않음.
</code></pre></div>

<p><strong>규칙 3: 프로젝션의 연쇄(Cascade of Projection)</strong></p>
<div class="highlight"><pre><span></span><code>π_{L1}(π_{L2}(...π_{Ln}(R)...)) = π_{L1}(R)

가장 바깥쪽 프로젝션만 중요 (L1 ⊆ L2 ⊆ ... ⊆ Ln인 경우).
</code></pre></div>

<p><strong>규칙 4: 선택과 프로젝션의 교환(Commuting Selection with Projection)</strong></p>
<div class="highlight"><pre><span></span><code>선택 조건 c가 L의 속성만 포함하는 경우:
  π_L(σ_c(R)) = σ_c(π_L(R))
</code></pre></div>

<p><strong>규칙 5: 조인의 교환법칙(Commutativity of Join)</strong></p>
<div class="highlight"><pre><span></span><code>R ⋈ S = S ⋈ R
R × S = S × R
</code></pre></div>

<p><strong>규칙 6: 조인의 결합법칙(Associativity of Join)</strong></p>
<div class="highlight"><pre><span></span><code>(R ⋈ S) ⋈ T = R ⋈ (S ⋈ T)
</code></pre></div>

<p><strong>규칙 7: 조인을 통한 선택 밀어내기(Pushing Selection Through Join)</strong></p>
<div class="highlight"><pre><span></span><code>조건 c가 R의 속성만 포함하는 경우:
  σ_c(R ⋈ S) = σ_c(R) ⋈ S

이것이 가장 중요한 최적화 규칙!
중간 결과의 크기를 줄임.
</code></pre></div>

<p><strong>규칙 8: 집합 연산의 교환법칙(Commutativity of Set Operations)</strong></p>
<div class="highlight"><pre><span></span><code>R ∪ S = S ∪ R
R ∩ S = S ∩ R
(하지만 R − S ≠ S − R)
</code></pre></div>

<h3 id="_24">최적화 예제<a class="header-link" href="#_24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>원본 쿼리 트리 (최적화 안됨):

              π_{name}
                 │
          σ_{dept=&#39;CS&#39; AND cid=&#39;CS301&#39;}
                 │
                ⋈_{sid=sid}
               / \
          STUDENT  ENROLLMENT
          (5 rows)  (10 rows)
          카티션: 필터 전 50 rows

최적화된 쿼리 트리 (선택 밀어내기):

              π_{name}
                 │
                ⋈_{sid=sid}
               / \
   σ_{dept=&#39;CS&#39;}  σ_{cid=&#39;CS301&#39;}
        |              |
     STUDENT       ENROLLMENT
     (→3 rows)     (→2 rows)
     조인: 6개 조합, ~2개 매칭

최적화된 트리:
  1. 먼저 STUDENT를 3명의 CS 학생으로 필터링
  2. 먼저 ENROLLMENT를 2개의 CS301 등록으로 필터링
  3. 5 × 10 = 50 대신 3 × 2 = 6개 조합만 조인
  4. 중간 결과 크기 대폭 감소
</code></pre></div>

<h3 id="_25">휴리스틱 최적화 규칙<a class="header-link" href="#_25" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">선택을</span><span class="w"> </span><span class="n">가능한</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">아래로</span><span class="w"> </span><span class="n">밀어내기</span>
<span class="w">   </span><span class="p">(</span><span class="n">초기에</span><span class="w"> </span><span class="n">튜플</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">감소</span><span class="p">)</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">프로젝션을</span><span class="w"> </span><span class="n">가능한</span><span class="w"> </span><span class="n">한</span><span class="w"> </span><span class="n">아래로</span><span class="w"> </span><span class="n">밀어내기</span>
<span class="w">   </span><span class="p">(</span><span class="n">초기에</span><span class="w"> </span><span class="n">속성</span><span class="w"> </span><span class="n">수</span><span class="w"> </span><span class="n">감소</span><span class="p">,</span><span class="w"> </span><span class="n">단</span><span class="w"> </span><span class="n">조인</span><span class="w"> </span><span class="n">속성</span><span class="w"> </span><span class="n">유지</span><span class="p">)</span>

<span class="mf">3.</span><span class="w"> </span><span class="n">가장</span><span class="w"> </span><span class="n">제한적인</span><span class="w"> </span><span class="n">선택을</span><span class="w"> </span><span class="n">먼저</span><span class="w"> </span><span class="n">선택</span>
<span class="w">   </span><span class="p">(</span><span class="n">가장</span><span class="w"> </span><span class="n">많은</span><span class="w"> </span><span class="n">튜플을</span><span class="w"> </span><span class="n">제거하는</span><span class="w"> </span><span class="n">선택</span><span class="p">)</span>

<span class="mf">4.</span><span class="w"> </span><span class="n">카티션</span><span class="w"> </span><span class="n">곱</span><span class="w"> </span><span class="n">피하기</span>
<span class="w">   </span><span class="p">(</span><span class="n">항상</span><span class="w"> </span><span class="n">카티션</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">선택보다</span><span class="w"> </span><span class="n">조인</span><span class="w"> </span><span class="n">선호</span><span class="p">)</span>

<span class="mf">5.</span><span class="w"> </span><span class="n">중간</span><span class="w"> </span><span class="n">결과</span><span class="w"> </span><span class="n">크기를</span><span class="w"> </span><span class="n">최소화하는</span><span class="w"> </span><span class="n">조인</span><span class="w"> </span><span class="n">순서</span><span class="w"> </span><span class="n">선택</span>
<span class="w">   </span><span class="p">(</span><span class="n">가장</span><span class="w"> </span><span class="n">어려운</span><span class="w"> </span><span class="n">최적화</span><span class="w"> </span><span class="n">문제</span><span class="w"> </span><span class="err">—</span><span class="w"> </span><span class="n">종종</span><span class="w"> </span><span class="n">NP</span><span class="o">-</span><span class="n">hard</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. 관계 해석 (간단한 소개)<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<p>관계 대수가 <strong>절차적(procedural)</strong>(결과를 계산하는 방법 지정)인 반면, <strong>관계 해석(Relational Calculus)</strong>은 <strong>선언적(declarative)</strong>(결과가 무엇이어야 하는지 지정, 계산 방법은 아님)입니다.</p>
<h3 id="trc">튜플 관계 해석 (TRC)<a class="header-link" href="#trc" title="Permanent link">&para;</a></h3>
<p>TRC에서 쿼리는 관계에 대한 튜플 변수를 사용하여 표현됩니다.</p>
<div class="highlight"><pre><span></span><code>일반 형식:
  { t | P(t) }

  &quot;술어 P(t)가 참인 모든 튜플 t의 집합&quot;

예제: &quot;모든 CS 학생 찾기&quot;

  { t | t ∈ STUDENT ∧ t.dept = &#39;CS&#39; }

  &quot;dept가 CS인 STUDENT의 튜플 t 집합&quot;

예제: &quot;3학년 또는 4학년 학생의 이름과 학과 찾기&quot;

  { t.name, t.dept | t ∈ STUDENT ∧ (t.year = 3 ∨ t.year = 4) }

예제: &quot;CS301에 등록한 학생 찾기&quot;

  { t | t ∈ STUDENT ∧ ∃e ∈ ENROLLMENT(e.sid = t.sid ∧ e.cid = &#39;CS301&#39;) }

  &quot;동일한 sid를 가지고 cid = CS301인 등록 e가 존재하는
   STUDENT의 튜플 t&quot;
</code></pre></div>

<h3 id="drc">도메인 관계 해석 (DRC)<a class="header-link" href="#drc" title="Permanent link">&para;</a></h3>
<p>DRC에서 변수는 튜플이 아닌 개별 값(도메인)에 대한 범위를 갖습니다.</p>
<div class="highlight"><pre><span></span><code>일반 형식:
  { &lt;x1, x2, ..., xn&gt; | P(x1, x2, ..., xn) }

예제: &quot;CS 학생의 이름 찾기&quot;

  { &lt;n&gt; | ∃s, y, d (STUDENT(s, n, y, d) ∧ d = &#39;CS&#39;) }

  &quot;(s, n, y, d)가 STUDENT의 튜플이고 d가 CS인
   값 s, y, d가 존재하는 이름 값 n의 집합&quot;
</code></pre></div>

<h3 id="_26">대수와 해석의 동치성<a class="header-link" href="#_26" title="Permanent link">&para;</a></h3>
<p><strong>코드의 정리(Codd's Theorem)</strong> (1972): 관계 대수와 (안전한) 관계 해석은 동일한 표현력을 가집니다. 하나로 표현할 수 있는 모든 쿼리는 다른 것으로도 표현할 수 있습니다.</p>
<div class="highlight"><pre><span></span><code>┌──────────────────────────────────────────────────────┐
│                                                      │
│  관계 대수(Relational Algebra)  ≡  안전한 튜플 관계 해석  │
│                      ≡  안전한 도메인 관계 해석          │
│                      ≡  SQL (핵심)                   │
│                                                      │
│  쿼리 언어가 관계 대수로 표현할 수 있는 모든 것을        │
│  표현할 수 있다면 &quot;관계적으로 완전(relationally complete)&quot;│
│                                                      │
│  SQL은 관계적으로 완전 (그 이상 — 집계, 정렬, 재귀 등)   │
└──────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="_27">표현식의 안전성<a class="header-link" href="#_27" title="Permanent link">&para;</a></h3>
<p>관계 해석 표현식이 유한한 결과를 보장하면 <strong>안전(safe)</strong>합니다. 안전하지 않은 표현식은 무한한 결과를 생성할 수 있습니다:</p>
<div class="highlight"><pre><span></span><code>안전하지 않음:  { t | ¬(t ∈ STUDENT) }
         &quot;STUDENT에 없는 모든 튜플&quot; — 무한!

안전함:    { t | t ∈ STUDENT ∧ ¬(∃e ∈ ENROLLMENT(e.sid = t.sid)) }
         &quot;어떤 과목에도 등록하지 않은 학생&quot; — 유한 결과
</code></pre></div>

<hr />
<h2 id="9-sql">9. SQL과의 동치성<a class="header-link" href="#9-sql" title="Permanent link">&para;</a></h2>
<p>모든 관계 대수 표현식은 동치인 SQL이 있습니다. 이 대응 관계를 이해하면 SQL 쿼리 작성 및 최적화에 도움이 됩니다.</p>
<h3 id="_28">연산별 매핑<a class="header-link" href="#_28" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">┌────────────────────┬──────────────────────────────────────────┐</span>
<span class="n">│</span><span class="w"> </span><span class="n">관계</span><span class="w"> </span><span class="n">대수</span><span class="w">            </span><span class="n">│</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="n">동치</span><span class="w">                                  </span><span class="n">│</span>
<span class="n">├────────────────────┼──────────────────────────────────────────┤</span>
<span class="n">│</span><span class="w"> </span><span class="n">σ_</span><span class="err">{</span><span class="n">c</span><span class="err">}</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="w">           </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">c</span><span class="w">                  </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">π_</span><span class="err">{</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="err">}</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="w">         </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w">              </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">ρ_</span><span class="err">{</span><span class="n">S</span><span class="err">}</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="w">           </span><span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="p">(</span><span class="k">FROM</span><span class="w"> </span><span class="n">절에서</span><span class="p">)</span><span class="w">                    </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">∪</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">S</span><span class="w">    </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">∩</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">INTERSECT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">S│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">−</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">EXCEPT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">×</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="p">(</span><span class="n">또는</span><span class="w"> </span><span class="k">CROSS</span><span class="w"> </span><span class="k">JOIN</span><span class="p">)</span><span class="w">     </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">⋈_</span><span class="err">{</span><span class="n">c</span><span class="err">}</span><span class="w"> </span><span class="n">S</span><span class="w">          </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">c</span><span class="w">              </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">⋈</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">NATURAL</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">S</span><span class="w">           </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">⟕</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">OUTER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">÷</span><span class="w"> </span><span class="n">S</span><span class="w">              </span><span class="n">│</span><span class="w"> </span><span class="p">(</span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="n">상관</span><span class="w"> </span><span class="n">부질의</span><span class="w"> </span><span class="n">필요</span><span class="p">)</span><span class="w">            </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">γ_</span><span class="err">{</span><span class="n">G</span><span class="p">;</span><span class="n">F</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="err">}</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="w">      </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">G</span><span class="w">        </span><span class="n">│</span>
<span class="n">│</span><span class="w"> </span><span class="n">τ_</span><span class="err">{</span><span class="n">A</span><span class="err">}</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="w">           </span><span class="n">│</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">A</span><span class="w">               </span><span class="n">│</span>
<span class="n">└────────────────────┴──────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="sql">상세한 SQL 동치<a class="header-link" href="#sql" title="Permanent link">&para;</a></h3>
<p><strong>선택:</strong></p>
<div class="highlight"><pre><span></span><code>σ_{dept=&#39;CS&#39; AND year&gt;=3}(STUDENT)

SELECT *
FROM student
WHERE dept = &#39;CS&#39; AND year &gt;= 3;
</code></pre></div>

<p><strong>프로젝션:</strong></p>
<div class="highlight"><pre><span></span><code>π_{name, dept}(STUDENT)

SELECT DISTINCT name, dept
FROM student;

참고: SQL은 기본적으로 중복을 제거하지 않음.
      관계 대수의 집합 의미론과 일치시키려면 DISTINCT를 사용해야 함.
</code></pre></div>

<p><strong>자연 조인:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">STUDENT</span><span class="w"> </span><span class="err">⋈</span><span class="w"> </span><span class="nt">ENROLLMENT</span>

<span class="nt">--</span><span class="w"> </span><span class="nt">방법</span><span class="w"> </span><span class="nt">1</span><span class="o">:</span><span class="w"> </span><span class="nt">NATURAL</span><span class="w"> </span><span class="nt">JOIN</span><span class="w"> </span><span class="o">(</span><span class="nt">모든</span><span class="w"> </span><span class="nt">공통</span><span class="w"> </span><span class="nt">열에서</span><span class="w"> </span><span class="nt">매칭</span><span class="o">)</span>
<span class="nt">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">student</span><span class="w"> </span><span class="nt">NATURAL</span><span class="w"> </span><span class="nt">JOIN</span><span class="w"> </span><span class="nt">enrollment</span><span class="o">;</span>

<span class="nt">--</span><span class="w"> </span><span class="nt">방법</span><span class="w"> </span><span class="nt">2</span><span class="o">:</span><span class="w"> </span><span class="nt">명시적</span><span class="w"> </span><span class="nt">JOIN</span><span class="w"> </span><span class="o">(</span><span class="nt">더</span><span class="w"> </span><span class="nt">안전</span><span class="w"> </span><span class="err">—</span><span class="w"> </span><span class="nt">어떤</span><span class="w"> </span><span class="nt">열이</span><span class="w"> </span><span class="nt">매칭되는지</span><span class="w"> </span><span class="nt">제어</span><span class="o">)</span>
<span class="nt">SELECT</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">sid</span><span class="o">,</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">name</span><span class="o">,</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">year</span><span class="o">,</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">dept</span><span class="o">,</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">cid</span><span class="o">,</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">grade</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">student</span><span class="w"> </span><span class="nt">s</span>
<span class="nt">JOIN</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span><span class="o">;</span>
</code></pre></div>

<p><strong>나눗셈 (SQL로 표현하기 가장 어려움):</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">R</span><span class="w"> </span><span class="err">÷</span><span class="w"> </span><span class="nt">S</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="s2">&quot;S의 모든 튜플과 연관된 R의 튜플 찾기&quot;</span>

<span class="nt">--</span><span class="w"> </span><span class="s2">&quot;모든 CS 과목에 등록한 학생 찾기&quot;</span>
<span class="nt">SELECT</span><span class="w"> </span><span class="nt">DISTINCT</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e</span>
<span class="nt">WHERE</span><span class="w"> </span><span class="nt">NOT</span><span class="w"> </span><span class="nt">EXISTS</span><span class="w"> </span><span class="o">(</span>
<span class="w">    </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">cid</span>
<span class="w">    </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">course</span><span class="w"> </span><span class="nt">c</span>
<span class="w">    </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;CS&#39;</span>
<span class="w">    </span><span class="nt">AND</span><span class="w"> </span><span class="nt">NOT</span><span class="w"> </span><span class="nt">EXISTS</span><span class="w"> </span><span class="o">(</span>
<span class="w">        </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">1</span>
<span class="w">        </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e2</span>
<span class="w">        </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">e2</span><span class="p">.</span><span class="nc">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="w">        </span><span class="nt">AND</span><span class="w"> </span><span class="nt">e2</span><span class="p">.</span><span class="nc">cid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">cid</span>
<span class="w">    </span><span class="o">)</span>
<span class="o">);</span>

<span class="nt">--</span><span class="w"> </span><span class="nt">COUNT를</span><span class="w"> </span><span class="nt">사용한</span><span class="w"> </span><span class="nt">대안</span><span class="o">:</span>
<span class="nt">SELECT</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="nt">FROM</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e</span>
<span class="nt">JOIN</span><span class="w"> </span><span class="nt">course</span><span class="w"> </span><span class="nt">c</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">cid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">cid</span>
<span class="nt">WHERE</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;CS&#39;</span>
<span class="nt">GROUP</span><span class="w"> </span><span class="nt">BY</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="nt">HAVING</span><span class="w"> </span><span class="nt">COUNT</span><span class="o">(</span><span class="nt">DISTINCT</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">cid</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span>
<span class="w">    </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">COUNT</span><span class="o">(*)</span><span class="w"> </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">course</span><span class="w"> </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;CS&#39;</span>
<span class="o">);</span>
</code></pre></div>

<p><strong>조합 예제:</strong></p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;어떤 과목에서든 A를 받은 학생의 이름 찾기&quot;</span>

<span class="nt">관계</span><span class="w"> </span><span class="nt">대수</span><span class="o">:</span>
<span class="w">  </span><span class="nt">π_</span><span class="p">{</span><span class="err">name</span><span class="p">}</span><span class="o">(</span><span class="nt">σ_</span><span class="p">{</span><span class="err">grade=&#39;A&#39;</span><span class="p">}</span><span class="o">(</span><span class="nt">STUDENT</span><span class="w"> </span><span class="err">⋈</span><span class="w"> </span><span class="nt">ENROLLMENT</span><span class="o">))</span>

<span class="nt">SQL</span><span class="o">:</span>
<span class="w">  </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">DISTINCT</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">name</span>
<span class="w">  </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">student</span><span class="w"> </span><span class="nt">s</span>
<span class="w">  </span><span class="nt">JOIN</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="w">  </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">grade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="o">;</span>
</code></pre></div>

<hr />
<h2 id="10">10. 완전한 작업 예제<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="1_1">예제 1: 다단계 쿼리<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p><strong>쿼리:</strong> "CS 학과가 가르치는 과목에 등록했지만 CS 전공이 아닌 학생의 이름과 학과 찾기."</p>
<div class="highlight"><pre><span></span><code><span class="nt">관계</span><span class="w"> </span><span class="nt">대수</span><span class="o">:</span>

<span class="w">  </span><span class="nt">CS_COURSES</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">σ_</span><span class="p">{</span><span class="err">dept=&#39;CS&#39;</span><span class="p">}</span><span class="o">(</span><span class="nt">COURSE</span><span class="o">)</span>
<span class="w">  </span><span class="nt">CS_ENROLLED</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">ENROLLMENT</span><span class="w"> </span><span class="err">⋈</span><span class="nt">_</span><span class="p">{</span><span class="err">cid</span><span class="p">}</span><span class="w"> </span><span class="nt">CS_COURSES</span>
<span class="w">  </span><span class="nt">NON_CS_STUDENTS</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">σ_</span><span class="p">{</span><span class="err">dept≠&#39;CS&#39;</span><span class="p">}</span><span class="o">(</span><span class="nt">STUDENT</span><span class="o">)</span>
<span class="w">  </span><span class="nt">RESULT</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">π_</span><span class="p">{</span><span class="err">name,</span><span class="w"> </span><span class="err">dept</span><span class="p">}</span><span class="o">(</span><span class="nt">NON_CS_STUDENTS</span><span class="w"> </span><span class="err">⋈</span><span class="nt">_</span><span class="p">{</span><span class="err">sid</span><span class="p">}</span><span class="w"> </span><span class="nt">CS_ENROLLED</span><span class="o">)</span>

<span class="nt">단계별</span><span class="o">:</span>

<span class="nt">1</span><span class="o">.</span><span class="w"> </span><span class="nt">CS_COURSES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">σ_</span><span class="p">{</span><span class="err">dept=&#39;CS&#39;</span><span class="p">}</span><span class="o">(</span><span class="nt">COURSE</span><span class="o">)</span>
<span class="w">   </span><span class="err">→</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">CS401</span><span class="p">}</span>

<span class="nt">2</span><span class="o">.</span><span class="w"> </span><span class="nt">CS_ENROLLED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">π_</span><span class="p">{</span><span class="err">sid</span><span class="p">}</span><span class="o">(</span><span class="nt">ENROLLMENT</span><span class="w"> </span><span class="err">⋈</span><span class="w"> </span><span class="nt">CS_COURSES</span><span class="o">)</span>
<span class="w">   </span><span class="err">→</span><span class="w"> </span><span class="p">{</span><span class="err">S001,</span><span class="w"> </span><span class="err">S002,</span><span class="w"> </span><span class="err">S003,</span><span class="w"> </span><span class="err">S004,</span><span class="w"> </span><span class="err">S005</span><span class="p">}</span><span class="w"> </span><span class="o">(</span><span class="nt">CS101</span><span class="o">/</span><span class="nt">CS301</span><span class="o">/</span><span class="nt">CS401을</span><span class="w"> </span><span class="nt">수강한</span><span class="w"> </span><span class="nt">모두</span><span class="o">)</span>

<span class="nt">3</span><span class="o">.</span><span class="w"> </span><span class="nt">NON_CS_STUDENTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">σ_</span><span class="p">{</span><span class="err">dept≠&#39;CS&#39;</span><span class="p">}</span><span class="o">(</span><span class="nt">STUDENT</span><span class="o">)</span>
<span class="w">   </span><span class="err">→</span><span class="w"> </span><span class="p">{</span><span class="err">S003/Carol/EE,</span><span class="w"> </span><span class="err">S004/Dave/ME</span><span class="p">}</span>

<span class="nt">4</span><span class="o">.</span><span class="w"> </span><span class="nt">RESULT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">π_</span><span class="p">{</span><span class="err">name,</span><span class="w"> </span><span class="err">dept</span><span class="p">}</span><span class="o">(</span><span class="nt">NON_CS_STUDENTS</span><span class="w"> </span><span class="err">⋈</span><span class="w"> </span><span class="nt">CS_ENROLLED</span><span class="o">)</span>
<span class="w">   </span><span class="err">→</span><span class="w"> </span><span class="p">{</span><span class="err">(Carol,</span><span class="w"> </span><span class="err">EE),</span><span class="w"> </span><span class="err">(Dave,</span><span class="w"> </span><span class="err">ME)</span><span class="p">}</span>

<span class="nt">SQL</span><span class="o">:</span>
<span class="w">  </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">DISTINCT</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">name</span><span class="o">,</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">dept</span>
<span class="w">  </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">student</span><span class="w"> </span><span class="nt">s</span>
<span class="w">  </span><span class="nt">JOIN</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="w">  </span><span class="nt">JOIN</span><span class="w"> </span><span class="nt">course</span><span class="w"> </span><span class="nt">c</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">cid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">cid</span>
<span class="w">  </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">c</span><span class="p">.</span><span class="nc">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;CS&#39;</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">dept</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s1">&#39;CS&#39;</span><span class="o">;</span>
</code></pre></div>

<h3 id="2_1">예제 2: 나눗셈 쿼리<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p><strong>쿼리:</strong> "학생 S001이 수강한 모든 과목을 수강한 학생 찾기."</p>
<div class="highlight"><pre><span></span><code><span class="nt">관계</span><span class="w"> </span><span class="nt">대수</span><span class="o">:</span>

<span class="w">  </span><span class="nt">S001_COURSES</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">π_</span><span class="p">{</span><span class="err">cid</span><span class="p">}</span><span class="o">(</span><span class="nt">σ_</span><span class="p">{</span><span class="err">sid=&#39;S001&#39;</span><span class="p">}</span><span class="o">(</span><span class="nt">ENROLLMENT</span><span class="o">))</span>
<span class="w">  </span><span class="nt">ALL_ENROLLMENTS</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">π_</span><span class="p">{</span><span class="err">sid,</span><span class="w"> </span><span class="err">cid</span><span class="p">}</span><span class="o">(</span><span class="nt">ENROLLMENT</span><span class="o">)</span>
<span class="w">  </span><span class="nt">RESULT</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">ALL_ENROLLMENTS</span><span class="w"> </span><span class="err">÷</span><span class="w"> </span><span class="nt">S001_COURSES</span>

<span class="nt">단계별</span><span class="o">:</span>

<span class="nt">1</span><span class="o">.</span><span class="w"> </span><span class="nt">S001_COURSES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span>

<span class="nt">2</span><span class="o">.</span><span class="w"> </span><span class="nt">각</span><span class="w"> </span><span class="nt">학생</span><span class="w"> </span><span class="nt">확인</span><span class="o">:</span>
<span class="w">   </span><span class="nt">S001</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span><span class="w"> </span><span class="err">⊇</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">✓</span>
<span class="w">   </span><span class="nt">S002</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301</span><span class="p">}</span><span class="w">        </span><span class="err">⊇</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="o">(</span><span class="nt">MA101</span><span class="w"> </span><span class="nt">빠짐</span><span class="o">)</span>
<span class="w">   </span><span class="nt">S003</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="err">EE201,</span><span class="w"> </span><span class="err">CS101</span><span class="p">}</span><span class="w">        </span><span class="err">⊇</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">✗</span>
<span class="w">   </span><span class="nt">S004</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="err">CS101</span><span class="p">}</span><span class="w">               </span><span class="err">⊇</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">✗</span>
<span class="w">   </span><span class="nt">S005</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span><span class="w">        </span><span class="err">⊇</span><span class="w"> </span><span class="p">{</span><span class="err">CS101,</span><span class="w"> </span><span class="err">CS301,</span><span class="w"> </span><span class="err">MA101</span><span class="p">}</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="o">(</span><span class="nt">CS301</span><span class="w"> </span><span class="nt">빠짐</span><span class="o">)</span>

<span class="nt">3</span><span class="o">.</span><span class="w"> </span><span class="nt">RESULT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="err">S001</span><span class="p">}</span>

<span class="nt">SQL</span><span class="o">:</span>
<span class="w">  </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="w">  </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e</span>
<span class="w">  </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">cid</span><span class="w"> </span><span class="nt">IN</span><span class="w"> </span><span class="o">(</span>
<span class="w">      </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">cid</span><span class="w"> </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;S001&#39;</span>
<span class="w">  </span><span class="o">)</span>
<span class="w">  </span><span class="nt">GROUP</span><span class="w"> </span><span class="nt">BY</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="w">  </span><span class="nt">HAVING</span><span class="w"> </span><span class="nt">COUNT</span><span class="o">(</span><span class="nt">DISTINCT</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">cid</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span>
<span class="w">      </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">COUNT</span><span class="o">(</span><span class="nt">DISTINCT</span><span class="w"> </span><span class="nt">cid</span><span class="o">)</span><span class="w"> </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">WHERE</span><span class="w"> </span><span class="nt">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;S001&#39;</span>
<span class="w">  </span><span class="o">);</span>
</code></pre></div>

<h3 id="3_1">예제 3: 외부 조인<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<p><strong>쿼리:</strong> "등록이 없는 학생을 포함하여 모든 학생과 그들의 등록 수 나열."</p>
<div class="highlight"><pre><span></span><code><span class="nt">관계</span><span class="w"> </span><span class="nt">대수</span><span class="o">:</span>

<span class="w">  </span><span class="nt">JOINED</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">STUDENT</span><span class="w"> </span><span class="err">⟕</span><span class="w"> </span><span class="nt">ENROLLMENT</span><span class="w">       </span><span class="o">(</span><span class="nt">sid에서</span><span class="w"> </span><span class="nt">왼쪽</span><span class="w"> </span><span class="nt">외부</span><span class="w"> </span><span class="nt">조인</span><span class="o">)</span>
<span class="w">  </span><span class="nt">RESULT</span><span class="w"> </span><span class="err">←</span><span class="w"> </span><span class="nt">γ_</span><span class="p">{</span><span class="err">sid,</span><span class="w"> </span><span class="err">name</span><span class="p">;</span><span class="w"> </span><span class="err">COUNT(cid)</span><span class="w"> </span><span class="err">AS</span><span class="w"> </span><span class="err">num_courses</span><span class="p">}</span><span class="o">(</span><span class="nt">JOINED</span><span class="o">)</span>

<span class="nt">Dave</span><span class="w"> </span><span class="o">(</span><span class="nt">S004</span><span class="o">)</span><span class="nt">가</span><span class="w"> </span><span class="nt">등록이</span><span class="w"> </span><span class="nt">없다면</span><span class="o">:</span>

<span class="nt">SQL</span><span class="o">:</span>
<span class="w">  </span><span class="nt">SELECT</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">sid</span><span class="o">,</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">name</span><span class="o">,</span><span class="w"> </span><span class="nt">COUNT</span><span class="o">(</span><span class="nt">e</span><span class="p">.</span><span class="nc">cid</span><span class="o">)</span><span class="w"> </span><span class="nt">AS</span><span class="w"> </span><span class="nt">num_courses</span>
<span class="w">  </span><span class="nt">FROM</span><span class="w"> </span><span class="nt">student</span><span class="w"> </span><span class="nt">s</span>
<span class="w">  </span><span class="nt">LEFT</span><span class="w"> </span><span class="nt">OUTER</span><span class="w"> </span><span class="nt">JOIN</span><span class="w"> </span><span class="nt">enrollment</span><span class="w"> </span><span class="nt">e</span><span class="w"> </span><span class="nt">ON</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">e</span><span class="p">.</span><span class="nc">sid</span>
<span class="w">  </span><span class="nt">GROUP</span><span class="w"> </span><span class="nt">BY</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">sid</span><span class="o">,</span><span class="w"> </span><span class="nt">s</span><span class="p">.</span><span class="nc">name</span>
<span class="w">  </span><span class="nt">ORDER</span><span class="w"> </span><span class="nt">BY</span><span class="w"> </span><span class="nt">num_courses</span><span class="w"> </span><span class="nt">DESC</span><span class="o">;</span>

<span class="nt">결과</span><span class="o">:</span>
<span class="w">  </span><span class="err">┌──────┬───────┬─────────────┐</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">sid</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">name</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">num_courses</span><span class="w"> </span><span class="err">│</span>
<span class="w">  </span><span class="err">├──────┼───────┼─────────────┤</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">S001</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">Alice</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">3</span><span class="w">           </span><span class="err">│</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">S002</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">Bob</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">2</span><span class="w">           </span><span class="err">│</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">S003</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">Carol</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">2</span><span class="w">           </span><span class="err">│</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">S005</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">Eve</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nt">2</span><span class="w">           </span><span class="err">│</span>
<span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">S004</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nt">Dave</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="nt">0</span><span class="w">           </span><span class="err">│</span><span class="w">  </span><span class="err">←</span><span class="w"> </span><span class="nt">LEFT</span><span class="w"> </span><span class="nt">OUTER</span><span class="w"> </span><span class="nt">JOIN으로</span><span class="w"> </span><span class="nt">보존됨</span>
<span class="w">  </span><span class="err">└──────┴───────┴─────────────┘</span>
</code></pre></div>

<hr />
<h2 id="11">11. 연습 문제<a class="header-link" href="#11" title="Permanent link">&para;</a></h2>
<h3 id="_29">기본 연산<a class="header-link" href="#_29" title="Permanent link">&para;</a></h3>
<p><strong>연습 문제 3.1</strong>: 샘플 데이터베이스를 사용하여 다음에 대한 관계 대수 표현식을 작성하세요:</p>
<ul>
<li>(a) 2학년 또는 3학년의 모든 학생</li>
<li>(b) 4학점 이상의 과목 제목</li>
<li>(c) EE201에 등록한 학생 ID</li>
<li>(d) CS 학과가 아닌 학생의 이름</li>
</ul>
<p><strong>연습 문제 3.2</strong>: 다음 표현식을 단계별로 평가하고, 중간 결과를 보여주세요:</p>
<ul>
<li>(a) <code>π_{name}(σ_{year &gt; 2}(STUDENT))</code></li>
<li>(b) <code>π_{sid}(σ_{grade='A'}(ENROLLMENT)) ∩ π_{sid}(σ_{dept='CS'}(STUDENT))</code></li>
<li>(c) <code>STUDENT ⋈ (σ_{cid='CS301'}(ENROLLMENT))</code></li>
</ul>
<h3 id="_30">조인 연산<a class="header-link" href="#_30" title="Permanent link">&para;</a></h3>
<p><strong>연습 문제 3.3</strong>: 다음 각각에 대해 관계 대수 표현식과 동치 SQL을 작성하세요:</p>
<ul>
<li>(a) "Database Theory"에 등록한 학생의 이름 찾기</li>
<li>(b) A 학점을 받은 학생이 최소 한 명 있는 과목 제목 찾기</li>
<li>(c) 자신의 학과 외의 과목에 등록한 학생 찾기</li>
<li>(d) 최소 한 과목을 공유하는 학생 쌍 찾기</li>
</ul>
<p><strong>연습 문제 3.4</strong>: 샘플 데이터에서 다음 세 쿼리 결과의 차이를 설명하세요:</p>
<div class="highlight"><pre><span></span><code><span class="n">Q1</span><span class="o">:</span><span class="w"> </span><span class="n">STUDENT</span><span class="w"> </span><span class="err">⋈</span><span class="w"> </span><span class="n">ENROLLMENT</span>
<span class="n">Q2</span><span class="o">:</span><span class="w"> </span><span class="n">STUDENT</span><span class="w"> </span><span class="err">⟕</span><span class="w"> </span><span class="n">ENROLLMENT</span>
<span class="n">Q3</span><span class="o">:</span><span class="w"> </span><span class="n">STUDENT</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="n">ENROLLMENT</span>
</code></pre></div>

<p>각각 몇 개의 튜플을 생성하나요? Q2에는 나타나지만 Q1에는 나타나지 않는 튜플은?</p>
<h3 id="_31">나눗셈<a class="header-link" href="#_31" title="Permanent link">&para;</a></h3>
<p><strong>연습 문제 3.5</strong>: 나눗셈을 사용하여 다음에 대한 관계 대수 표현식을 작성하세요:</p>
<ul>
<li>(a) 모든 3학점 과목에 등록한 학생</li>
<li>(b) Bob (S002)이 수강한 모든 과목을 수강한 학생</li>
</ul>
<p>단계별 평가를 보여주세요.</p>
<p><strong>연습 문제 3.6</strong>: 연습 문제 3.5의 각 나눗셈 쿼리를 다음을 사용하여 SQL로 표현하세요:
- (i) 이중 NOT EXISTS
- (ii) HAVING COUNT를 사용한 GROUP BY</p>
<h3 id="_32">최적화<a class="header-link" href="#_32" title="Permanent link">&para;</a></h3>
<p><strong>연습 문제 3.7</strong>: 다음 쿼리가 주어졌을 때:</p>
<div class="highlight"><pre><span></span><code>π_{name}(σ_{credits=3 AND grade=&#39;A&#39;}(STUDENT ⋈ ENROLLMENT ⋈ COURSE))
</code></pre></div>

<ul>
<li>(a) 초기(최적화 안된) 쿼리 트리 그리기</li>
<li>(b) 대수적 최적화 규칙을 적용하여 최적화된 쿼리 트리 생성</li>
<li>(c) 어떤 규칙을 적용했는지, 왜 최적화된 트리가 더 나은지 설명</li>
<li>(d) 중간 결과 크기의 감소 추정</li>
</ul>
<p><strong>연습 문제 3.8</strong>: 다음 동치를 증명하거나 반증하세요:</p>
<ul>
<li>(a) <code>σ_{c1}(R ∪ S) = σ_{c1}(R) ∪ σ_{c1}(S)</code></li>
<li>(b) <code>σ_{c1}(R − S) = σ_{c1}(R) − σ_{c1}(S)</code></li>
<li>(c) <code>π_A(R ∪ S) = π_A(R) ∪ π_A(S)</code></li>
<li>(d) <code>σ_{c1}(R × S) = σ_{c1}(R) × S</code>  (c1이 R의 속성만 포함하는 경우)</li>
</ul>
<h3 id="_33">관계 해석<a class="header-link" href="#_33" title="Permanent link">&para;</a></h3>
<p><strong>연습 문제 3.9</strong>: 다음을 튜플 관계 해석(TRC)으로 표현하세요:</p>
<ul>
<li>(a) CS 학과 학생의 이름</li>
<li>(b) 최소 두 과목에 등록한 학생</li>
<li>(c) 등록한 학생이 없는 과목</li>
<li>(d) CS 학과가 제공하는 모든 과목에 등록한 학생</li>
</ul>
<p><strong>연습 문제 3.10</strong>: 다음 TRC 표현식 중 어느 것이 안전한지 결정하세요. 안전하지 않다면 그 이유를 설명하고 안전한 동치를 제공하세요:</p>
<ul>
<li>(a) <code>{ t | ¬(t ∈ STUDENT) }</code></li>
<li>(b) <code>{ t.name | t ∈ STUDENT ∧ t.gpa &gt; 3.5 }</code></li>
<li>(c) <code>{ &lt;x, y&gt; | ∃t ∈ STUDENT(t.sid = x ∧ t.name = y) }</code></li>
<li>(d) <code>{ t | t.salary &gt; 100000 }</code></li>
</ul>
<h3 id="_34">도전 문제<a class="header-link" href="#_34" title="Permanent link">&para;</a></h3>
<p><strong>연습 문제 3.11</strong>: 관계 R(A, B, C)가 다음 튜플을 포함합니다:</p>
<div class="highlight"><pre><span></span><code>{(a1, b1, c1), (a1, b2, c1), (a1, b2, c2), (a2, b1, c1), (a2, b1, c2)}
</code></pre></div>

<p>관계 S(B, C)는: <code>{(b1, c1), (b1, c2)}</code>를 포함합니다</p>
<p>R ÷ S를 단계별로 계산하세요. 결과의 각 튜플이 S의 모든 튜플과 연관되어 있는지 확인하여 답을 검증하세요.</p>
<p><strong>연습 문제 3.12</strong>: 다음에 대한 단일 관계 대수 표현식(대입 없음) 작성:</p>
<p>"평균 교수 급여가 가장 높은 학과 찾기."</p>
<p>힌트: 집계와 비교 패턴이 필요합니다.</p>
<hr />
<p><strong>이전</strong>: <a href="./02_Relational_Model.md">관계 모델</a> | <strong>다음</strong>: <a href="./04_ER_Modeling.md">ER 모델링</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Database_Theory/02_Relational_Model.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">관계형 모델(The Relational Model)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Database_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Database_Theory/04_ER_Modeling.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ER 모델링(ER Modeling)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}