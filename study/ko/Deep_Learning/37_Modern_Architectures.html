{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>37. í˜„ëŒ€ ë”¥ëŸ¬ë‹ ì•„í‚¤í…ì²˜ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Deep_Learning/">Deep Learning</a>
    <span class="separator">/</span>
    <span class="current">37. í˜„ëŒ€ ë”¥ëŸ¬ë‹ ì•„í‚¤í…ì²˜</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>37. í˜„ëŒ€ ë”¥ëŸ¬ë‹ ì•„í‚¤í…ì²˜</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Deep_Learning/36_Self_Supervised_Learning.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">36. Self-Supervised Learning</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Deep_Learning/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Deep_Learning/38_Object_Detection.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">38. ê°ì²´ íƒì§€ (Object Detection)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ì•„í‚¤í…ì²˜ ì§„í™” íƒ€ì„ë¼ì¸</a><ul>
<li><a href="#_2">ì£¼ìš” íŠ¸ë Œë“œ</a></li>
</ul>
</li>
<li><a href="#2-convnext-convnet">2. ConvNeXt: ConvNetì˜ í˜„ëŒ€í™”</a><ul>
<li><a href="#21-resnet-convnext">2.1 ResNetì—ì„œ ConvNeXtë¡œì˜ ì„¤ê³„ ì§„í™”</a></li>
<li><a href="#22-convnext">2.2 ConvNeXt ë¸”ë¡ ì•„í‚¤í…ì²˜</a></li>
<li><a href="#23-pytorch">2.3 PyTorch êµ¬í˜„</a></li>
<li><a href="#24-convnext-v2-2023">2.4 ConvNeXt V2 ê°œì„ ì‚¬í•­ (2023)</a></li>
</ul>
</li>
<li><a href="#3-efficientnetv2">3. EfficientNetV2</a><ul>
<li><a href="#31-fused-mbconv-vs-mbconv">3.1 Fused-MBConv vs. MBConv</a></li>
<li><a href="#32">3.2 ì ì§„ì  í•™ìŠµ</a></li>
<li><a href="#33-timm-efficientnetv2">3.3 timmìœ¼ë¡œ EfficientNetV2 ì‚¬ìš©í•˜ê¸°</a></li>
</ul>
</li>
<li><a href="#4-dinov2">4. DINOv2: ìê¸°ì§€ë„ í•™ìŠµ ë¹„ì „ íŒŒìš´ë°ì´ì…˜ ëª¨ë¸</a><ul>
<li><a href="#41">4.1 ì£¼ìš” í˜ì‹ </a></li>
<li><a href="#42">4.2 ëª¨ë¸ ë³€í˜•</a></li>
<li><a href="#43-dinov2">4.3 ì‚¬ì „í•™ìŠµëœ DINOv2 ì‚¬ìš©í•˜ê¸°</a></li>
<li><a href="#44-dinov2">4.4 DINOv2ë¥¼ ì‚¬ìš©í•œ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ íƒœìŠ¤í¬</a></li>
</ul>
</li>
<li><a href="#5-latent-consistency-models-lcm">5. ì ì¬ ì¼ê´€ì„± ëª¨ë¸(Latent Consistency Models, LCM)</a><ul>
<li><a href="#51-consistency-distillation">5.1 ì¼ê´€ì„± ì¦ë¥˜(Consistency Distillation)</a></li>
<li><a href="#52-lcm">5.2 LCM í•™ìŠµ</a></li>
<li><a href="#53-lcm-lora">5.3 ë¹ ë¥¸ íŒŒì¸íŠœë‹ì„ ìœ„í•œ LCM-LoRA</a></li>
<li><a href="#54-diffusers-lcm">5.4 Diffusersë¡œ LCM ì‚¬ìš©í•˜ê¸°</a></li>
</ul>
</li>
<li><a href="#6">6. ì•„í‚¤í…ì²˜ ë¹„êµ í‘œ</a></li>
<li><a href="#7">7. ì‚¬ì „í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©í•˜ê¸°: ì‹¤ìš© ê°€ì´ë“œ</a><ul>
<li><a href="#71-timm-pytorch-image-models">7.1 timm ë¼ì´ë¸ŒëŸ¬ë¦¬ (PyTorch Image Models)</a></li>
<li><a href="#72-hugging-face-transformers">7.2 Hugging Face Transformers</a></li>
<li><a href="#73">7.3 ì „ì´ í•™ìŠµ ëª¨ë²” ì‚¬ë¡€</a></li>
</ul>
</li>
<li><a href="#8">8. ì•„í‚¤í…ì²˜ ì„ íƒ ê°€ì´ë“œ</a><ul>
<li><a href="#81">8.1 ì˜ì‚¬ ê²°ì • íŠ¸ë¦¬</a></li>
<li><a href="#82">8.2 ì‹¤ìš©ì  ê¶Œì¥ì‚¬í•­</a></li>
</ul>
</li>
<li><a href="#9">9. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-convnext">ë¬¸ì œ 1: ConvNeXt ë¸”ë¡ êµ¬í˜„</a></li>
<li><a href="#2">ë¬¸ì œ 2: ì ì§„ì  í•™ìŠµ ìŠ¤ì¼€ì¤„</a></li>
<li><a href="#3-dinov2">ë¬¸ì œ 3: DINOv2 íŠ¹ì§• ì¶”ì¶œ</a></li>
<li><a href="#4-lcm">ë¬¸ì œ 4: LCM ë¹ ë¥¸ ìƒì„±</a></li>
<li><a href="#5">ë¬¸ì œ 5: ëª¨ë¸ ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#_3">ë„¤ë¹„ê²Œì´ì…˜</a></li>
<li><a href="#_4">ì¶”ê°€ ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <p><a href="./36_Self_Supervised_Learning.md">ì´ì „: Self-Supervised Learning</a> | <a href="./38_Object_Detection.md">ë‹¤ìŒ: ê°ì²´ íƒì§€</a></p>
<hr />
<h1 id="37">37. í˜„ëŒ€ ë”¥ëŸ¬ë‹ ì•„í‚¤í…ì²˜<a class="header-link" href="#37" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ìµœê·¼ ë”¥ëŸ¬ë‹ ì•„í‚¤í…ì²˜ í˜ì‹ (2020-2024) ì‚´í´ë³´ê¸°</li>
<li>ConvNeXtì™€ Transformer ì‹œëŒ€ì˜ ìˆœìˆ˜ ConvNetì˜ ì§„í™” ì´í•´í•˜ê¸°</li>
<li>EfficientNetV2ì™€ ì ì§„ì  í•™ìŠµ ì „ëµ(progressive training strategies)ì— ëŒ€í•´ ë°°ìš°ê¸°</li>
<li>ìê¸°ì§€ë„ í•™ìŠµ ë¹„ì „ íŒŒìš´ë°ì´ì…˜ ëª¨ë¸ì¸ DINOv2 íƒêµ¬í•˜ê¸°</li>
<li>ë¹ ë¥¸ í™•ì‚° ìƒ˜í”Œë§ì„ ìœ„í•œ ì ì¬ ì¼ê´€ì„± ëª¨ë¸(Latent Consistency Models, LCM) ì´í•´í•˜ê¸°</li>
<li>timm ë° transformers ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œ ì‚¬ì „í•™ìŠµëœ í˜„ëŒ€ ì•„í‚¤í…ì²˜ ì ìš©í•˜ê¸°</li>
</ul>
<hr />
<h2 id="1">1. ì•„í‚¤í…ì²˜ ì§„í™” íƒ€ì„ë¼ì¸<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<p>ë”¥ëŸ¬ë‹ ì•„í‚¤í…ì²˜ í™˜ê²½ì€ ë¹ ë¥´ê²Œ ì§„í™”í•´ì™”ìŠµë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="mi">2017</span><span class="o">:</span><span class="w"> </span><span class="n">ResNet</span><span class="o">/</span><span class="n">ResNeXt</span><span class="w"> </span><span class="n">dominance</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Bottleneck</span><span class="w"> </span><span class="n">blocks</span><span class="o">,</span><span class="w"> </span><span class="n">skip</span><span class="w"> </span><span class="n">connections</span>

<span class="mi">2017</span><span class="o">:</span><span class="w"> </span><span class="n">Transformer</span><span class="w"> </span><span class="o">(</span><span class="n">NLP</span><span class="o">)</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Self</span><span class="o">-</span><span class="n">attention</span><span class="o">,</span><span class="w"> </span><span class="n">positional</span><span class="w"> </span><span class="n">encoding</span>

<span class="mi">2020</span><span class="o">:</span><span class="w"> </span><span class="n">Vision</span><span class="w"> </span><span class="n">Transformer</span><span class="w"> </span><span class="o">(</span><span class="n">ViT</span><span class="o">)</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Pure</span><span class="w"> </span><span class="n">attention</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">vision</span>

<span class="mi">2021</span><span class="o">:</span><span class="w"> </span><span class="n">Swin</span><span class="w"> </span><span class="n">Transformer</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Hierarchical</span><span class="w"> </span><span class="n">vision</span><span class="w"> </span><span class="n">transformer</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">shifted</span><span class="w"> </span><span class="n">windows</span>

<span class="mi">2022</span><span class="o">:</span><span class="w"> </span><span class="n">ConvNeXt</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Modernized</span><span class="w"> </span><span class="n">ConvNet</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">Transformers</span>

<span class="mi">2022</span><span class="o">:</span><span class="w"> </span><span class="n">EfficientNetV2</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Progressive</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Fused</span><span class="o">-</span><span class="n">MBConv</span>

<span class="mi">2023</span><span class="o">:</span><span class="w"> </span><span class="n">DINOv2</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Self</span><span class="o">-</span><span class="n">supervised</span><span class="w"> </span><span class="n">vision</span><span class="w"> </span><span class="n">foundation</span><span class="w"> </span><span class="n">model</span>

<span class="mi">2023</span><span class="o">:</span><span class="w"> </span><span class="n">Latent</span><span class="w"> </span><span class="n">Consistency</span><span class="w"> </span><span class="n">Models</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Fast</span><span class="w"> </span><span class="n">diffusion</span><span class="w"> </span><span class="n">sampling</span><span class="w"> </span><span class="o">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">4</span><span class="w"> </span><span class="n">steps</span><span class="o">)</span>

<span class="mi">2024</span><span class="o">:</span><span class="w"> </span><span class="n">ConvNeXt</span><span class="w"> </span><span class="n">V2</span><span class="o">,</span><span class="w"> </span><span class="n">Mamba</span><span class="o">,</span><span class="w"> </span><span class="n">Hyena</span>
<span class="w">      </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Continued</span><span class="w"> </span><span class="n">innovation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">architectures</span>
</code></pre></div>

<h3 id="_2">ì£¼ìš” íŠ¸ë Œë“œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>í•˜ì´ë¸Œë¦¬ë“œ ì•„í‚¤í…ì²˜</strong>: í•©ì„±ê³±(convolutions)ê³¼ ì–´í…ì…˜(attention) ê²°í•©</li>
<li><strong>ìê¸°ì§€ë„ ì‚¬ì „í•™ìŠµ(Self-supervised pretraining)</strong>: DINO, MAE, CLIP</li>
<li><strong>ìŠ¤ì¼€ì¼ë§ ë²•ì¹™(Scaling laws)</strong>: ë” í° ëª¨ë¸, ë” ë§ì€ ë°ì´í„°, ë” ê¸´ í•™ìŠµ</li>
<li><strong>íš¨ìœ¨ì„±</strong>: FLOPs, íŒŒë¼ë¯¸í„°, ì§€ì—°ì‹œê°„ ê°ì†Œ</li>
<li><strong>íŒŒìš´ë°ì´ì…˜ ëª¨ë¸(Foundation models)</strong>: ë²”ìš© ì‚¬ì „í•™ìŠµ ëª¨ë¸</li>
</ol>
<hr />
<h2 id="2-convnext-convnet">2. ConvNeXt: ConvNetì˜ í˜„ëŒ€í™”<a class="header-link" href="#2-convnext-convnet" title="Permanent link">&para;</a></h2>
<p><strong>ConvNeXt</strong> (Liu et al., 2022)ëŠ” ìˆœìˆ˜ ConvNetì´ ìµœì‹  ì„¤ê³„ ì„ íƒìœ¼ë¡œ í˜„ëŒ€í™”ë  ë•Œ Transformerì™€ ê²½ìŸí•  ìˆ˜ ìˆìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
<h3 id="21-resnet-convnext">2.1 ResNetì—ì„œ ConvNeXtë¡œì˜ ì„¤ê³„ ì§„í™”<a class="header-link" href="#21-resnet-convnext" title="Permanent link">&para;</a></h3>
<p>ResNet-50ì—ì„œ ì‹œì‘í•˜ì—¬ ë‹¨ê³„ë³„ë¡œ í˜„ëŒ€ì  ê°œì„ ì‚¬í•­ì„ ì ìš©:</p>
<div class="highlight"><pre><span></span><code>Step 1: Training procedure (90 â†’ 300 epochs, AdamW, mixup, cutmix)
        Accuracy: 76.1% â†’ 78.8%

Step 2: Macro design (stage ratio 3:4:6:3 â†’ 3:3:9:3)
        Patchify stem (7Ã—7 stride-2 â†’ 4Ã—4 stride-4)
        Accuracy: 78.8% â†’ 79.4%

Step 3: ResNeXt-ify (grouped convolutions)
        Depthwise convolution (groups = channels)
        Accuracy: 79.4% â†’ 80.5%

Step 4: Inverted bottleneck (narrow â†’ wide â†’ narrow)
        Expansion ratio 4Ã— (similar to Transformers&#39; MLP)
        Accuracy: 80.5% â†’ 80.6%

Step 5: Large kernel sizes (3Ã—3 â†’ 7Ã—7)
        Accuracy: 80.6% â†’ 81.0%

Step 6: Micro design (ReLU â†’ GELU, BN â†’ LN, fewer layers)
        Accuracy: 81.0% â†’ 82.0%

Final ConvNeXt-T: 82.0% (matches Swin-T)
</code></pre></div>

<h3 id="22-convnext">2.2 ConvNeXt ë¸”ë¡ ì•„í‚¤í…ì²˜<a class="header-link" href="#22-convnext" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Input (C channels)
    |
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  (Residual connection)
    |                  |
Depthwise Conv 7Ã—7     |
    |                  |
LayerNorm              |
    |                  |
1Ã—1 Conv (4C)          |  (Expansion)
    |                  |
GELU                   |
    |                  |
1Ã—1 Conv (C)           |  (Projection)
    |                  |
    +â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |
Output (C channels)
</code></pre></div>

<p><strong>ResNetê³¼ì˜ ì£¼ìš” ì°¨ì´ì </strong>:
- 3Ã—3 í‘œì¤€ í•©ì„±ê³± ëŒ€ì‹  <strong>Depthwise convolution</strong> (7Ã—7)
- <strong>Inverted bottleneck</strong>: 4Cë¡œ í™•ì¥í•œ í›„ ë‹¤ì‹œ Cë¡œ íˆ¬ì˜
- BatchNorm ëŒ€ì‹  <strong>LayerNorm</strong>
- ReLU ëŒ€ì‹  <strong>GELU</strong>
- <strong>ë” ì ì€ í™œì„±í™” í•¨ìˆ˜</strong>: ë¸”ë¡ë‹¹ í•˜ë‚˜ë§Œ</p>
<h3 id="23-pytorch">2.3 PyTorch êµ¬í˜„<a class="header-link" href="#23-pytorch" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ConvNeXtBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ConvNeXt block with inverted bottleneck design.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">expansion_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">layer_scale_init</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Depthwise convolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dwconv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span>
            <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="n">kernel_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dim</span>
        <span class="p">)</span>

        <span class="c1"># Normalization and projection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwconv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">expansion_ratio</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>  <span class="c1"># Expansion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GELU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwconv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">expansion_ratio</span> <span class="o">*</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>  <span class="c1"># Projection</span>

        <span class="c1"># Layer scale (learned per-channel scaling)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
            <span class="n">layer_scale_init</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="p">)</span> <span class="k">if</span> <span class="n">layer_scale_init</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">shortcut</span> <span class="o">=</span> <span class="n">x</span>

        <span class="c1"># Depthwise conv</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwconv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># Permute for LayerNorm and pointwise convs</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># (N, C, H, W) -&gt; (N, H, W, C)</span>

        <span class="c1"># Inverted bottleneck with LayerNorm</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwconv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwconv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># Layer scale</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">x</span>

        <span class="c1"># Permute back</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># (N, H, W, C) -&gt; (N, C, H, W)</span>

        <span class="c1"># Residual connection</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">shortcut</span> <span class="o">+</span> <span class="n">x</span>
        <span class="k">return</span> <span class="n">x</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ConvNeXt</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ConvNeXt model.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">in_chans</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">depths</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  <span class="c1"># Number of blocks per stage</span>
        <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="mi">96</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">768</span><span class="p">],</span>  <span class="c1"># Channels per stage</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Stem: patchify with 4Ã—4 conv, stride 4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stem</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_chans</span><span class="p">,</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Build 4 stages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stages</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="c1"># Downsampling layer (except first stage)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">downsample</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">),</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">downsample</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>

            <span class="c1"># Stack ConvNeXt blocks</span>
            <span class="n">blocks</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="p">[</span>
                <span class="n">ConvNeXtBlock</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">depths</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="p">])</span>

            <span class="n">stage</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">downsample</span><span class="p">,</span> <span class="n">blocks</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>

        <span class="c1"># Head</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_classes</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># Stem</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># (N, C, H, W) -&gt; (N, H, W, C)</span>

        <span class="c1"># Stages</span>
        <span class="k">for</span> <span class="n">stage</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stages</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># -&gt; (N, C, H, W)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">stage</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># -&gt; (N, H, W, C)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>  <span class="c1"># Global average pooling</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_features</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>


<span class="c1"># Example usage</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ConvNeXt</span><span class="p">(</span>
    <span class="n">depths</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  <span class="c1"># ConvNeXt-T</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="mi">96</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">768</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output shape: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (2, 1000)</span>
</code></pre></div>

<h3 id="24-convnext-v2-2023">2.4 ConvNeXt V2 ê°œì„ ì‚¬í•­ (2023)<a class="header-link" href="#24-convnext-v2-2023" title="Permanent link">&para;</a></h3>
<p><strong>ConvNeXt V2</strong>ëŠ” ë‹¤ìŒì„ ë„ì…í–ˆìŠµë‹ˆë‹¤:
1. <strong>ì „ì—­ ì‘ë‹µ ì •ê·œí™”(Global Response Normalization, GRN)</strong>: ì±„ë„ ê°„ íŠ¹ì§• ê²½ìŸ ê°•í™”
2. <strong>ì™„ì „ í•©ì„±ê³± MAE(Fully convolutional MAE)</strong>: ConvNetì„ ìœ„í•œ ë§ˆìŠ¤í¬ ì˜¤í† ì¸ì½”ë” ì‚¬ì „í•™ìŠµ
3. <strong>ì„±ëŠ¥ í–¥ìƒ</strong>: ImageNet-1Kì—ì„œ 87.3% (ConvNeXt V2-H)</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GRN</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Global Response Normalization layer.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># x: (N, H, W, C)</span>
        <span class="c1"># Compute global feature map</span>
        <span class="n">Gx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Normalize</span>
        <span class="n">Nx</span> <span class="o">=</span> <span class="n">Gx</span> <span class="o">/</span> <span class="p">(</span><span class="n">Gx</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
        <span class="c1"># Scale and shift</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">Nx</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+</span> <span class="n">x</span>
</code></pre></div>

<hr />
<h2 id="3-efficientnetv2">3. EfficientNetV2<a class="header-link" href="#3-efficientnetv2" title="Permanent link">&para;</a></h2>
<p><strong>EfficientNetV2</strong> (Tan &amp; Le, 2021)ëŠ” ë‹¤ìŒì„ í†µí•´ í•™ìŠµ ì†ë„ì™€ íŒŒë¼ë¯¸í„° íš¨ìœ¨ì„±ì„ ê°œì„ í•©ë‹ˆë‹¤:
1. <strong>Fused-MBConv ë¸”ë¡</strong>: í™•ì¥(expansion)ê³¼ depthwise í•©ì„±ê³± ìœµí•©
2. <strong>ì ì§„ì  í•™ìŠµ(Progressive training)</strong>: ì´ë¯¸ì§€ í¬ê¸°ì™€ ì •ê·œí™”ë¥¼ ì ì§„ì ìœ¼ë¡œ ì¦ê°€
3. <strong>ì‹ ê²½ë§ ì•„í‚¤í…ì²˜ íƒìƒ‰(Neural Architecture Search, NAS)</strong>: í•™ìŠµ ì†ë„ì— ìµœì í™”</p>
<h3 id="31-fused-mbconv-vs-mbconv">3.1 Fused-MBConv vs. MBConv<a class="header-link" href="#31-fused-mbconv-vs-mbconv" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">MBConv</span><span class="w"> </span><span class="p">(</span><span class="n">MobileNetV2</span><span class="p">)</span><span class="o">:</span><span class="w">                </span><span class="n">Fused</span><span class="o">-</span><span class="n">MBConv</span><span class="o">:</span>
<span class="w">  </span><span class="n">Input</span><span class="w">                                </span><span class="n">Input</span>
<span class="w">    </span><span class="o">|</span><span class="w">                                    </span><span class="o">|</span>
<span class="w">  </span><span class="mi">1</span><span class="err">Ã—</span><span class="mi">1</span><span class="w"> </span><span class="n">Conv</span><span class="w"> </span><span class="p">(</span><span class="n">expand</span><span class="p">)</span><span class="w">                    </span><span class="mi">3</span><span class="err">Ã—</span><span class="mi">3</span><span class="w"> </span><span class="n">Conv</span><span class="w"> </span><span class="p">(</span><span class="n">expand</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w">                                    </span><span class="o">|</span>
<span class="w">  </span><span class="n">DW</span><span class="w"> </span><span class="mi">3</span><span class="err">Ã—</span><span class="mi">3</span><span class="w">                               </span><span class="p">[</span><span class="n">Fused</span><span class="w"> </span><span class="n">operation</span><span class="p">]</span>
<span class="w">    </span><span class="o">|</span><span class="w">                                    </span><span class="o">|</span>
<span class="w">  </span><span class="mi">1</span><span class="err">Ã—</span><span class="mi">1</span><span class="w"> </span><span class="n">Conv</span><span class="w"> </span><span class="p">(</span><span class="n">project</span><span class="p">)</span><span class="w">                   </span><span class="mi">1</span><span class="err">Ã—</span><span class="mi">1</span><span class="w"> </span><span class="n">Conv</span><span class="w"> </span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w">                                    </span><span class="o">|</span>
<span class="w">  </span><span class="n">Output</span><span class="w">                               </span><span class="n">Output</span>

<span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">ops</span><span class="w">                       </span><span class="mi">2</span><span class="w"> </span><span class="n">ops</span><span class="w"> </span><span class="p">(</span><span class="n">faster</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">FLOPs</span><span class="p">)</span>
</code></pre></div>

<p><strong>íŠ¸ë ˆì´ë“œì˜¤í”„</strong>:
- <strong>MBConv</strong>: ë” í° ëª¨ë¸ì— ì í•© (ë” ì ì€ íŒŒë¼ë¯¸í„°)
- <strong>Fused-MBConv</strong>: ë” ì‘ì€ ëª¨ë¸ì— ì í•© (ë” ë¹ ë¥¸ í•™ìŠµ)</p>
<p>EfficientNetV2ëŠ” ì„œë¡œ ë‹¤ë¥¸ ë‹¨ê³„ì—ì„œ <strong>ë‘˜ ë‹¤</strong> ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<h3 id="32">3.2 ì ì§„ì  í•™ìŠµ<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p><strong>í•µì‹¬ ì•„ì´ë””ì–´</strong>: ì²˜ìŒì—ëŠ” ë” ì‘ì€ ì´ë¯¸ì§€ì™€ ì•½í•œ ì •ê·œí™”ë¡œ í•™ìŠµí•˜ê³ , ì ì§„ì ìœ¼ë¡œ ì¦ê°€ì‹œí‚µë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>Stage 1 (epochs 0-50):
  - Image size: 128Ã—128
  - RandAugment magnitude: 5
  - Mixup alpha: 0

Stage 2 (epochs 50-100):
  - Image size: 192Ã—192
  - RandAugment magnitude: 10
  - Mixup alpha: 0.2

Stage 3 (epochs 100-150):
  - Image size: 256Ã—256
  - RandAugment magnitude: 15
  - Mixup alpha: 0.4
</code></pre></div>

<p><strong>ì´ì </strong>:
- <strong>ë” ë¹ ë¥¸ ìˆ˜ë ´</strong>: ë” ì‘ì€ ì´ë¯¸ì§€ë¡œ ìµœì í™”ê°€ ë” ì‰¬ì›€
- <strong>ë” ë‚˜ì€ ì •ê·œí™”</strong>: ë” í° ì´ë¯¸ì§€ì— ë” ê°•ë ¥í•œ ì¦ê°•
- <strong>í–¥ìƒëœ ì •í™•ë„</strong>: ImageNetì—ì„œ 85.7% (EfficientNetV2-L)</p>
<h3 id="33-timm-efficientnetv2">3.3 timmìœ¼ë¡œ EfficientNetV2 ì‚¬ìš©í•˜ê¸°<a class="header-link" href="#33-timm-efficientnetv2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">timm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># List available EfficientNetV2 models</span>
<span class="n">models</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">list_models</span><span class="p">(</span><span class="s1">&#39;*efficientnetv2*&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
<span class="c1"># [&#39;tf_efficientnetv2_b0&#39;, &#39;tf_efficientnetv2_b1&#39;, ..., &#39;tf_efficientnetv2_l&#39;]</span>

<span class="c1"># Load pretrained EfficientNetV2-S</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;tf_efficientnetv2_s&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="c1"># Get model info</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameters: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">M&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input size: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">default_cfg</span><span class="p">[</span><span class="s1">&#39;input_size&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Inference</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">resolve_model_data_config</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">create_transform</span><span class="p">(</span><span class="o">**</span><span class="n">data_config</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;cat.jpg&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># (1, 3, 384, 384)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">top5_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="n">probs</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Print top-5 predictions</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ImageNetInfo</span><span class="o">.</span><span class="n">label_names</span><span class="p">()</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">top5_idx</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="4-dinov2">4. DINOv2: ìê¸°ì§€ë„ í•™ìŠµ ë¹„ì „ íŒŒìš´ë°ì´ì…˜ ëª¨ë¸<a class="header-link" href="#4-dinov2" title="Permanent link">&para;</a></h2>
<p><strong>DINOv2</strong> (Oquab et al., 2023)ëŠ” ë ˆì´ë¸” ì—†ì´ 1ì–µ 4200ë§Œ ì´ë¯¸ì§€ë¡œ ì‚¬ì „í•™ìŠµëœ ìê¸°ì§€ë„ í•™ìŠµ Vision Transformerì…ë‹ˆë‹¤.</p>
<h3 id="41">4.1 ì£¼ìš” í˜ì‹ <a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ë ˆì´ë¸” ì—†ëŠ” ìê¸° ì¦ë¥˜(Self-distillation with no labels)</strong> (DINO í”„ë ˆì„ì›Œí¬)</li>
<li><strong>ë ˆì§€ìŠ¤í„° í† í°ì„ ê°€ì§„ ViT ë°±ë³¸</strong></li>
<li><strong>ëŒ€ê·œëª¨ ì‚¬ì „í•™ìŠµ</strong> (1ì–µ 4200ë§Œ ì´ë¯¸ì§€, LVD-142M ë°ì´í„°ì…‹)</li>
<li><strong>ë©€í‹°íƒœìŠ¤í¬ í—¤ë“œ</strong>: ë¶„ë¥˜, ë¶„í• , ê¹Šì´ ì¶”ì •</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">DINO</span><span class="w"> </span><span class="n">Self</span><span class="o">-</span><span class="nl">Distillation</span><span class="p">:</span>

<span class="w">   </span><span class="n">Student</span><span class="w"> </span><span class="p">(</span><span class="n">ViT</span><span class="o">-</span><span class="n">S</span><span class="p">)</span><span class="w">          </span><span class="n">Teacher</span><span class="w"> </span><span class="p">(</span><span class="n">EMA</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Student</span><span class="p">)</span>
<span class="w">         </span><span class="o">|</span><span class="w">                          </span><span class="o">|</span>
<span class="w">    </span><span class="o">[</span><span class="n">CLS</span><span class="o">]</span><span class="w"> </span><span class="n">token</span><span class="w">               </span><span class="o">[</span><span class="n">CLS</span><span class="o">]</span><span class="w"> </span><span class="n">token</span>
<span class="w">         </span><span class="o">|</span><span class="w">                          </span><span class="o">|</span>
<span class="w">    </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">              </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Predict</span><span class="w"> </span><span class="err">â”‚</span><span class="w">              </span><span class="err">â”‚</span><span class="w"> </span><span class="n">Target</span><span class="w">  </span><span class="err">â”‚</span>
<span class="w">    </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">              </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="w">         </span><span class="o">|</span><span class="w">                          </span><span class="o">|</span>
<span class="w">         </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="w"> </span><span class="k">Match</span><span class="w"> </span><span class="err">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="w">              </span><span class="p">(</span><span class="k">no</span><span class="w"> </span><span class="n">labels</span><span class="err">!</span><span class="p">)</span>

<span class="nl">Augmentations</span><span class="p">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nl">Student</span><span class="p">:</span><span class="w"> </span><span class="n">strong</span><span class="w"> </span><span class="n">crops</span><span class="w"> </span><span class="p">(</span><span class="n">multi</span><span class="o">-</span><span class="n">crop</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nl">Teacher</span><span class="p">:</span><span class="w"> </span><span class="n">weak</span><span class="w"> </span><span class="n">crops</span><span class="w"> </span><span class="p">(</span><span class="k">global</span><span class="w"> </span><span class="n">views</span><span class="p">)</span>
</code></pre></div>

<ol>
<li><strong>ë ˆì§€ìŠ¤í„° í† í°(Register tokens)</strong> (ì¶”ê°€ í•™ìŠµ ê°€ëŠ¥ í† í°):</li>
<li>ë°°ê²½ ì•„í‹°íŒ©íŠ¸ë¥¼ í¡ìˆ˜í•˜ì—¬ íŠ¹ì§• í’ˆì§ˆ í–¥ìƒ</li>
<li>
<p>[CLS] í† í°ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ë¶„ë¥˜ì—ëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŒ</p>
</li>
<li>
<p><strong>ë™ê²°ëœ ë°±ë³¸ + ì„ í˜• í”„ë¡œë¸Œ(linear probes)</strong>:</p>
</li>
<li>ë™ê²°ëœ DINOv2ë¡œ íŠ¹ì§• ì¶”ì¶œ</li>
<li>ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ íƒœìŠ¤í¬ë¥¼ ìœ„í•œ ê²½ëŸ‰ í—¤ë“œ í•™ìŠµ</li>
</ol>
<h3 id="42">4.2 ëª¨ë¸ ë³€í˜•<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ëª¨ë¸</th>
<th>íŒŒë¼ë¯¸í„°</th>
<th>ë ˆì´ì–´</th>
<th>Hidden Dim</th>
<th>Patch Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>DINOv2-S</td>
<td>22M</td>
<td>12</td>
<td>384</td>
<td>14Ã—14</td>
</tr>
<tr>
<td>DINOv2-B</td>
<td>86M</td>
<td>12</td>
<td>768</td>
<td>14Ã—14</td>
</tr>
<tr>
<td>DINOv2-L</td>
<td>304M</td>
<td>24</td>
<td>1024</td>
<td>14Ã—14</td>
</tr>
<tr>
<td>DINOv2-g</td>
<td>1.1B</td>
<td>40</td>
<td>1536</td>
<td>14Ã—14</td>
</tr>
</tbody>
</table>
<h3 id="43-dinov2">4.3 ì‚¬ì „í•™ìŠµëœ DINOv2 ì‚¬ìš©í•˜ê¸°<a class="header-link" href="#43-dinov2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoImageProcessor</span><span class="p">,</span> <span class="n">AutoModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>

<span class="c1"># Load pretrained DINOv2-base</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">AutoImageProcessor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;facebook/dinov2-base&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;facebook/dinov2-base&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="c1"># Load image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;cat.jpg&#39;</span><span class="p">)</span>

<span class="c1"># Extract features</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">images</span><span class="o">=</span><span class="n">img</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">)</span>

<span class="c1"># Get patch embeddings (excluding [CLS])</span>
<span class="n">patch_embeddings</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">last_hidden_state</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>  <span class="c1"># (1, num_patches, 768)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Patch embeddings shape: </span><span class="si">{</span><span class="n">patch_embeddings</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Get [CLS] token (global image representation)</span>
<span class="n">cls_token</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">last_hidden_state</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># (1, 768)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CLS token shape: </span><span class="si">{</span><span class="n">cls_token</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Use as feature extractor for downstream tasks</span>
<span class="c1"># Example: k-NN classification</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Assume we have a training set</span>
<span class="n">train_features</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Extract from training images</span>
<span class="n">train_labels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Fit k-NN</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_features</span><span class="p">),</span> <span class="n">train_labels</span><span class="p">)</span>

<span class="c1"># Predict</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cls_token</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</code></pre></div>

<h3 id="44-dinov2">4.4 DINOv2ë¥¼ ì‚¬ìš©í•œ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ íƒœìŠ¤í¬<a class="header-link" href="#44-dinov2" title="Permanent link">&para;</a></h3>
<p><strong>1. ì´ë¯¸ì§€ ë¶„ë¥˜(Image Classification)</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dinov2ForImageClassification</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Dinov2ForImageClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
    <span class="s1">&#39;facebook/dinov2-base&#39;</span><span class="p">,</span>
    <span class="n">num_labels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># Custom dataset</span>
    <span class="n">ignore_mismatched_sizes</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Fine-tune on custom dataset</span>
<span class="c1"># ... training loop ...</span>
</code></pre></div>

<p><strong>2. ì˜ë¯¸ë¡ ì  ë¶„í• (Semantic Segmentation)</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Use patch embeddings for dense prediction</span>
<span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">patch_embeddings</span><span class="o">.</span><span class="n">shape</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">W</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Assume square</span>

<span class="c1"># Reshape to spatial grid</span>
<span class="n">spatial_features</span> <span class="o">=</span> <span class="n">patch_embeddings</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="n">spatial_features</span> <span class="o">=</span> <span class="n">spatial_features</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># (B, D, H, W)</span>

<span class="c1"># Add segmentation head</span>
<span class="n">seg_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">seg_head</span><span class="p">(</span><span class="n">spatial_features</span><span class="p">)</span>  <span class="c1"># (B, num_classes, H, W)</span>
</code></pre></div>

<p><strong>3. ê¹Šì´ ì¶”ì •(Depth Estimation)</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Similar to segmentation, but regress depth</span>
<span class="n">depth_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">depth_map</span> <span class="o">=</span> <span class="n">depth_head</span><span class="p">(</span><span class="n">spatial_features</span><span class="p">)</span>  <span class="c1"># (B, 1, H, W)</span>
</code></pre></div>

<hr />
<h2 id="5-latent-consistency-models-lcm">5. ì ì¬ ì¼ê´€ì„± ëª¨ë¸(Latent Consistency Models, LCM)<a class="header-link" href="#5-latent-consistency-models-lcm" title="Permanent link">&para;</a></h2>
<p><strong>ì ì¬ ì¼ê´€ì„± ëª¨ë¸(Latent Consistency Models)</strong> (Luo et al., 2023)ì€ í™•ì‚° ëª¨ë¸ì—ì„œ 1-4 ë‹¨ê³„ë¡œ ë¹ ë¥¸ ìƒ˜í”Œë§ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤ (í‘œì¤€ í™•ì‚°ì˜ 25-50 ë‹¨ê³„ vs.).</p>
<h3 id="51-consistency-distillation">5.1 ì¼ê´€ì„± ì¦ë¥˜(Consistency Distillation)<a class="header-link" href="#51-consistency-distillation" title="Permanent link">&para;</a></h3>
<p><strong>í•µì‹¬ ì•„ì´ë””ì–´</strong>: ì‚¬ì „í•™ìŠµëœ í™•ì‚° ëª¨ë¸ì„ ë…¸ì´ì¦ˆê°€ ìˆëŠ” ì ì¬ ë³€ìˆ˜ë¥¼ ê¹¨ë—í•œ ì ì¬ ë³€ìˆ˜ë¡œ ì§ì ‘ ë§¤í•‘í•˜ëŠ” ì¼ê´€ì„± ëª¨ë¸ë¡œ ì¦ë¥˜í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>Standard Diffusion (DDPM):
  x_T (noise) â†’ x_{T-1} â†’ ... â†’ x_1 â†’ x_0 (clean)
  (50 steps, slow)

Latent Consistency Model:
  x_T (noise) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ x_0 (clean)
  (1-4 steps, fast!)

Consistency property:
  For any t, t&#39; âˆˆ [0, T]:
    f(x_t, t) â‰ˆ f(x_{t&#39;}, t&#39;)
  (all noisy latents map to same clean latent)
</code></pre></div>

<h3 id="52-lcm">5.2 LCM í•™ìŠµ<a class="header-link" href="#52-lcm" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ì‚¬ì „í•™ìŠµëœ í™•ì‚° ëª¨ë¸ë¡œ ì‹œì‘</strong> (ì˜ˆ: Stable Diffusion)</li>
<li><strong>ì¼ê´€ì„± ì†ì‹¤ì„ ì‚¬ìš©í•˜ì—¬ LCMìœ¼ë¡œ ì¦ë¥˜</strong>:</li>
</ol>
<div class="highlight"><pre><span></span><code>Consistency loss:
  L = E_{x, t, t&#39;} [ || f(x_t, t) - sg(f(x_{t&#39;}, t&#39;)) ||^2 ]

  where:
    <span class="k">-</span> x_t, x_{t&#39;} are noisy latents at different timesteps
    <span class="k">-</span> f is the consistency model (student)
    <span class="k">-</span> sg is stop-gradient (teacher is EMA of student)
</code></pre></div>

<ol>
<li><strong>ëª‡ ë‹¨ê³„ ìƒ˜í”Œë§</strong>: 2-4 ë‹¨ê³„ë¡œ ODE ì†”ë²„ ì‚¬ìš© (ì˜ˆ: DDIM)</li>
</ol>
<h3 id="53-lcm-lora">5.3 ë¹ ë¥¸ íŒŒì¸íŠœë‹ì„ ìœ„í•œ LCM-LoRA<a class="header-link" href="#53-lcm-lora" title="Permanent link">&para;</a></h3>
<p><strong>LCM-LoRA</strong>ëŠ” ì¼ê´€ì„± ì¦ë¥˜ì— ì €ë­í¬ ì ì‘(Low-Rank Adaptation)ì„ ì ìš©í•©ë‹ˆë‹¤:
- <strong>ë” ë¹ ë¥¸ í•™ìŠµ</strong>: LoRA ê°€ì¤‘ì¹˜ë§Œ í•™ìŠµ (~íŒŒë¼ë¯¸í„°ì˜ 1-5%)
- <strong>ì¡°í•© ê°€ëŠ¥(Composable)</strong>: ë‹¤ë¥¸ LoRA(ìŠ¤íƒ€ì¼, ìºë¦­í„° ë“±)ì™€ ê²°í•©
- <strong>íš¨ìœ¨ì </strong>: ë‹¨ì¼ GPUì—ì„œ ì¦ë¥˜ ê°€ëŠ¥</p>
<h3 id="54-diffusers-lcm">5.4 Diffusersë¡œ LCM ì‚¬ìš©í•˜ê¸°<a class="header-link" href="#54-diffusers-lcm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">diffusers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiffusionPipeline</span><span class="p">,</span> <span class="n">LCMScheduler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Load LCM pipeline</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">DiffusionPipeline</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
    <span class="s2">&quot;SimianLuo/LCM_Dreamshaper_v7&quot;</span><span class="p">,</span>
    <span class="n">torch_dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span>
<span class="p">)</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="c1"># LCM uses special scheduler</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">LCMScheduler</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Generate with 4 steps (vs. 50 for standard diffusion!)</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;A beautiful sunset over mountains, highly detailed, 8k&quot;</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span>
    <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
    <span class="n">num_inference_steps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>  <span class="c1"># Very fast!</span>
    <span class="n">guidance_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># LCM works best with guidance_scale=1</span>
<span class="p">)</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;sunset_lcm.png&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>LCM-LoRA ì‚¬ìš©í•˜ê¸°</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">diffusers</span><span class="w"> </span><span class="kn">import</span> <span class="n">StableDiffusionPipeline</span><span class="p">,</span> <span class="n">LCMScheduler</span>

<span class="c1"># Load base model</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">StableDiffusionPipeline</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
    <span class="s2">&quot;runwayml/stable-diffusion-v1-5&quot;</span><span class="p">,</span>
    <span class="n">torch_dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span>
<span class="p">)</span>

<span class="c1"># Load LCM-LoRA weights</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">load_lora_weights</span><span class="p">(</span><span class="s2">&quot;latent-consistency/lcm-lora-sdv1-5&quot;</span><span class="p">)</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">LCMScheduler</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="c1"># Generate with 4-8 steps</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span>
    <span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;Portrait of a cat, oil painting&quot;</span><span class="p">,</span>
    <span class="n">num_inference_steps</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">guidance_scale</span><span class="o">=</span><span class="mf">1.0</span>
<span class="p">)</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

<hr />
<h2 id="6">6. ì•„í‚¤í…ì²˜ ë¹„êµ í‘œ<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ì•„í‚¤í…ì²˜</th>
<th>íŒŒë¼ë¯¸í„°</th>
<th>FLOPs (G)</th>
<th>ImageNet ì •í™•ë„</th>
<th>í•™ìŠµ ë°ì´í„°</th>
<th>ì‚¬ì „í•™ìŠµ ë°©ë²•</th>
</tr>
</thead>
<tbody>
<tr>
<td>ResNet-50</td>
<td>25M</td>
<td>4.1</td>
<td>76.2%</td>
<td>1.3M</td>
<td>Supervised</td>
</tr>
<tr>
<td>EfficientNet-B4</td>
<td>19M</td>
<td>4.5</td>
<td>82.9%</td>
<td>1.3M</td>
<td>Supervised + AutoAug</td>
</tr>
<tr>
<td>EfficientNetV2-S</td>
<td>24M</td>
<td>8.4</td>
<td>84.9%</td>
<td>1.3M</td>
<td>Supervised + Progressive</td>
</tr>
<tr>
<td>ViT-B/16</td>
<td>86M</td>
<td>17.6</td>
<td>84.5%</td>
<td>300M</td>
<td>Supervised (JFT-300M)</td>
</tr>
<tr>
<td>Swin-B</td>
<td>88M</td>
<td>15.4</td>
<td>85.2%</td>
<td>1.3M</td>
<td>Supervised</td>
</tr>
<tr>
<td>ConvNeXt-B</td>
<td>89M</td>
<td>15.4</td>
<td>85.8%</td>
<td>1.3M</td>
<td>Supervised</td>
</tr>
<tr>
<td>ConvNeXt V2-B</td>
<td>89M</td>
<td>15.4</td>
<td>86.8%</td>
<td>1.3M</td>
<td>FCMAE (self-supervised)</td>
</tr>
<tr>
<td>DINOv2-B</td>
<td>86M</td>
<td>17.6</td>
<td>84.5% (linear)</td>
<td>142M</td>
<td>Self-supervised (DINO)</td>
</tr>
<tr>
<td>DINOv2-g</td>
<td>1.1B</td>
<td>280</td>
<td>88.5% (linear)</td>
<td>142M</td>
<td>Self-supervised (DINO)</td>
</tr>
</tbody>
</table>
<p><strong>ì°¸ê³ ì‚¬í•­</strong>:
- <strong>FLOPs</strong>: 224Ã—224 í•´ìƒë„ì—ì„œ ì¸¡ì •
- <strong>ImageNet Acc</strong>: ImageNet-1K ê²€ì¦ ì„¸íŠ¸ì—ì„œ Top-1 ì •í™•ë„
- <strong>DINOv2 (linear)</strong>: ì„ í˜• í”„ë¡œë¸Œ í‰ê°€ (ë™ê²°ëœ íŠ¹ì§• + ì„ í˜• ë¶„ë¥˜ê¸°)</p>
<hr />
<h2 id="7">7. ì‚¬ì „í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©í•˜ê¸°: ì‹¤ìš© ê°€ì´ë“œ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-timm-pytorch-image-models">7.1 timm ë¼ì´ë¸ŒëŸ¬ë¦¬ (PyTorch Image Models)<a class="header-link" href="#71-timm-pytorch-image-models" title="Permanent link">&para;</a></h3>
<p><strong>timm</strong>ì€ í†µí•©ëœ ì¸í„°í˜ì´ìŠ¤ë¡œ 700ê°œ ì´ìƒì˜ ì‚¬ì „í•™ìŠµëœ ëª¨ë¸ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">timm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># List all models</span>
<span class="n">all_models</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">list_models</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total models: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_models</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Search for specific architecture</span>
<span class="n">convnext_models</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">list_models</span><span class="p">(</span><span class="s1">&#39;convnext*&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">convnext_models</span><span class="p">)</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span>
    <span class="s1">&#39;convnext_base.fb_in22k_ft_in1k&#39;</span><span class="p">,</span>  <span class="c1"># Pretrained on ImageNet-22k, fine-tuned on 1k</span>
    <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">num_classes</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>

<span class="c1"># Inspect model</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">default_cfg</span><span class="p">)</span>  <span class="c1"># Config dict</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameters: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">M&quot;</span><span class="p">)</span>

<span class="c1"># Feature extraction mode</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;convnext_base&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Returns features instead of logits</span>

<span class="c1"># Get intermediate features</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;convnext_base&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">features_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stage </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">feat</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Stage 0: (1, 128, 56, 56)</span>
<span class="c1"># Stage 1: (1, 256, 28, 28)</span>
<span class="c1"># Stage 2: (1, 512, 14, 14)</span>
<span class="c1"># Stage 3: (1, 1024, 7, 7)</span>
</code></pre></div>

<h3 id="72-hugging-face-transformers">7.2 Hugging Face Transformers<a class="header-link" href="#72-hugging-face-transformers" title="Permanent link">&para;</a></h3>
<p><strong>transformers</strong> ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” AutoModelì„ í†µí•´ ë¹„ì „ ëª¨ë¸ì„ ì§€ì›í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoImageProcessor</span><span class="p">,</span> <span class="n">AutoModelForImageClassification</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Load processor and model</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">AutoImageProcessor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;microsoft/swin-base-patch4-window7-224&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForImageClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;microsoft/swin-base-patch4-window7-224&quot;</span><span class="p">)</span>

<span class="c1"># Prepare input</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;cat.jpg&quot;</span><span class="p">)</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">images</span><span class="o">=</span><span class="n">img</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">)</span>

<span class="c1"># Inference</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">logits</span>
    <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted class: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">id2label</span><span class="p">[</span><span class="n">predicted_class</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="73">7.3 ì „ì´ í•™ìŠµ ëª¨ë²” ì‚¬ë¡€<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<p><strong>1. íŠ¹ì§• ì¶”ì¶œ(Feature Extraction)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Freeze pretrained weights</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;convnext_base&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Replace classifier head</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">model</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">in_features</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>

<span class="c1"># Only train the head</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</code></pre></div>

<p><strong>2. íŒŒì¸íŠœë‹(Fine-tuning)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Unfreeze all layers</span>
<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Use lower learning rate for pretrained weights</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">([</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">stages</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">5e-5</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">}</span>
<span class="p">])</span>
</code></pre></div>

<p><strong>3. ì ì§„ì  ë™ê²° í•´ì œ(Progressive unfreezing)</strong> (ULMFiT ì „ëµ):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Epoch 0-5: Train head only</span>
<span class="c1"># Epoch 5-10: Unfreeze last stage</span>
<span class="c1"># Epoch 10+: Unfreeze all</span>

<span class="k">def</span><span class="w"> </span><span class="nf">unfreeze_layers</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">epoch</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="c1"># Freeze all except head</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
            <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">stages</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
            <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="n">epoch</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="c1"># Unfreeze last stage</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
            <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Unfreeze all</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
            <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

<hr />
<h2 id="8">8. ì•„í‚¤í…ì²˜ ì„ íƒ ê°€ì´ë“œ<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ì˜ì‚¬ ê²°ì • íŠ¸ë¦¬<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€</span><span class="w"> </span><span class="n">Need</span><span class="w"> </span><span class="n">supervised</span><span class="w"> </span><span class="n">pretraining</span><span class="err">?</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€</span><span class="w"> </span><span class="n">Yes</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€</span><span class="w"> </span><span class="n">Priority</span><span class="p">:</span><span class="w"> </span><span class="n">Accuracy</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">ConvNeXt</span><span class="w"> </span><span class="n">V2</span><span class="p">,</span><span class="w"> </span><span class="n">EfficientNetV2</span><span class="o">-</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">Swin</span><span class="o">-</span><span class="n">L</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Priority</span><span class="p">:</span><span class="w"> </span><span class="n">Speed</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">EfficientNetV2</span><span class="o">-</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">MobileNetV3</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="o">-</span><span class="n">supervised</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”œâ”€</span><span class="w"> </span><span class="n">Vision</span><span class="w"> </span><span class="n">foundation</span><span class="w"> </span><span class="n">model</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">DINOv2</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">g</span><span class="w"> </span><span class="p">(</span><span class="n">best</span><span class="w"> </span><span class="n">features</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Custom</span><span class="w"> </span><span class="n">dataset</span>
<span class="err">â”‚</span><span class="w">        </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">DINO</span><span class="p">,</span><span class="w"> </span><span class="n">MAE</span><span class="p">,</span><span class="w"> </span><span class="n">SimCLR</span>

<span class="err">â”Œâ”€</span><span class="w"> </span><span class="n">Need</span><span class="w"> </span><span class="n">generative</span><span class="w"> </span><span class="n">model</span><span class="err">?</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€</span><span class="w"> </span><span class="n">Fast</span><span class="w"> </span><span class="n">sampling</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">4</span><span class="w"> </span><span class="n">steps</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Latent</span><span class="w"> </span><span class="n">Consistency</span><span class="w"> </span><span class="n">Models</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Best</span><span class="w"> </span><span class="n">quality</span><span class="w"> </span><span class="p">(</span><span class="mi">25</span><span class="o">-</span><span class="mi">50</span><span class="w"> </span><span class="n">steps</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Stable</span><span class="w"> </span><span class="n">Diffusion</span><span class="p">,</span><span class="w"> </span><span class="n">DALL</span><span class="o">-</span><span class="n">E</span><span class="w"> </span><span class="mi">3</span>

<span class="err">â”Œâ”€</span><span class="w"> </span><span class="n">Deployment</span><span class="w"> </span><span class="n">constraints</span><span class="err">?</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span><span class="w"> </span><span class="n">IoT</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">MobileNetV3</span><span class="p">,</span><span class="w"> </span><span class="n">EfficientNet</span><span class="o">-</span><span class="n">B0</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€</span><span class="w"> </span><span class="n">Low</span><span class="w"> </span><span class="n">latency</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="n">ms</span><span class="p">)</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">ConvNeXt</span><span class="o">-</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">EfficientNetV2</span><span class="o">-</span><span class="n">S</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">constraints</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€</span><span class="w"> </span><span class="n">Any</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">model</span>
</code></pre></div>

<h3 id="82">8.2 ì‹¤ìš©ì  ê¶Œì¥ì‚¬í•­<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<p><strong>ë²”ìš© ë¹„ì „ íƒœìŠ¤í¬</strong> (ë¶„ë¥˜, íƒì§€, ë¶„í• ):
- <strong>DINOv2</strong>: í“¨ìƒ· í•™ìŠµ(few-shot learning)ì„ ìœ„í•œ ìµœê³ ì˜ ë™ê²°ëœ íŠ¹ì§•
- <strong>ConvNeXt V2</strong>: ìµœê³ ì˜ íŒŒì¸íŠœë‹ ì„±ëŠ¥
- <strong>EfficientNetV2</strong>: ìµœê³ ì˜ ì†ë„-ì •í™•ë„ íŠ¸ë ˆì´ë“œì˜¤í”„</p>
<p><strong>ìƒì„± íƒœìŠ¤í¬</strong> (ì´ë¯¸ì§€ í•©ì„±):
- <strong>Stable Diffusion XL</strong>: ìµœê³  í’ˆì§ˆ (50 ë‹¨ê³„)
- <strong>LCM</strong>: ìµœê³  ì†ë„ (4 ë‹¨ê³„)
- <strong>LCM-LoRA</strong>: ìµœê³  ì»¤ìŠ¤í„°ë§ˆì´ì§•</p>
<p><strong>ìì› ì œì•½</strong>:
- <strong>MobileNetV3</strong>: ëª¨ë°”ì¼ ë°°í¬
- <strong>EfficientNet-B0/B1</strong>: ì—£ì§€ ë””ë°”ì´ìŠ¤ì—ì„œ ì¢‹ì€ ì •í™•ë„</p>
<hr />
<h2 id="9">9. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="1-convnext">ë¬¸ì œ 1: ConvNeXt ë¸”ë¡ êµ¬í˜„<a class="header-link" href="#1-convnext" title="Permanent link">&para;</a></h3>
<p>ì œê³µëœ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì²˜ìŒë¶€í„° ConvNeXt ë¸”ë¡ì„ êµ¬í˜„í•˜ì„¸ìš”. ë‹¤ìŒì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:
- Depthwise 7Ã—7 í•©ì„±ê³±
- LayerNorm
- Inverted bottleneck (4Ã— í™•ì¥ì„ ê°€ì§„ 1Ã—1 í•©ì„±ê³±)
- GELU í™œì„±í™”
- Layer scale
- Residual connection</p>
<p>ì…ë ¥ shape <code>(2, 64, 32, 32)</code>ë¡œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
<details>
<summary>ì†”ë£¨ì…˜</summary>


<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ConvNeXtBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">expansion_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">layer_scale_init</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dwconv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwconv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">expansion_ratio</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GELU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwconv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">expansion_ratio</span> <span class="o">*</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">layer_scale_init</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">shortcut</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwconv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># (N, C, H, W) -&gt; (N, H, W, C)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwconv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwconv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">x</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># (N, H, W, C) -&gt; (N, C, H, W)</span>
        <span class="k">return</span> <span class="n">shortcut</span> <span class="o">+</span> <span class="n">x</span>

<span class="c1"># Test</span>
<span class="n">block</span> <span class="o">=</span> <span class="n">ConvNeXtBlock</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">block</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ConvNeXt block test passed!&quot;</span><span class="p">)</span>
</code></pre></div>


</details>

<h3 id="2">ë¬¸ì œ 2: ì ì§„ì  í•™ìŠµ ìŠ¤ì¼€ì¤„<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒì„ ìˆ˜í–‰í•˜ëŠ” EfficientNetV2ë¥¼ ìœ„í•œ ì ì§„ì  í•™ìŠµ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ êµ¬í˜„í•˜ì„¸ìš”:
- ì´ë¯¸ì§€ í¬ê¸°ë¥¼ 128 â†’ 192 â†’ 256ìœ¼ë¡œ ì¦ê°€
- RandAugment magnitudeë¥¼ 5 â†’ 10 â†’ 15ë¡œ ì¦ê°€
- Mixup alphaë¥¼ 0 â†’ 0.2 â†’ 0.4ë¡œ ì¦ê°€
- ê° ë‹¨ê³„ëŠ” 50 ì—í­ ì§€ì†</p>
<details>
<summary>ì†”ë£¨ì…˜</summary>


<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProgressiveTrainingScheduler</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_epochs</span><span class="o">=</span><span class="mi">150</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_epochs</span> <span class="o">=</span> <span class="n">total_epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stages</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="s1">&#39;rand_aug_mag&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;mixup_alpha&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="mi">192</span><span class="p">,</span> <span class="s1">&#39;rand_aug_mag&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;mixup_alpha&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;rand_aug_mag&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;mixup_alpha&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">stage</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stages</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">stage</span><span class="p">[</span><span class="s1">&#39;epochs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">epoch</span> <span class="o">&lt;</span> <span class="n">stage</span><span class="p">[</span><span class="s1">&#39;epochs&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="n">stage</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;rand_aug_mag&#39;</span><span class="p">:</span> <span class="n">stage</span><span class="p">[</span><span class="s1">&#39;rand_aug_mag&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;mixup_alpha&#39;</span><span class="p">:</span> <span class="n">stage</span><span class="p">[</span><span class="s1">&#39;mixup_alpha&#39;</span><span class="p">]</span>
                <span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Return last stage config</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>

<span class="c1"># Usage</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">ProgressiveTrainingScheduler</span><span class="p">()</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">]:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">scheduler</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">: img_size=</span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;img_size&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;rand_aug=</span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;rand_aug_mag&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, mixup=</span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;mixup_alpha&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>


</details>

<h3 id="3-dinov2">ë¬¸ì œ 3: DINOv2 íŠ¹ì§• ì¶”ì¶œ<a class="header-link" href="#3-dinov2" title="Permanent link">&para;</a></h3>
<p>DINOv2ì—ì„œ íŒ¨ì¹˜ ë ˆë²¨ íŠ¹ì§•ì„ ì¶”ì¶œí•˜ê³  ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì§• ìœ ì‚¬ë„ë¥¼ ì‹œê°í™”í•˜ì„¸ìš”.
1. DINOv2-small ë¡œë“œ
2. ì´ë¯¸ì§€ì˜ íŒ¨ì¹˜ ì„ë² ë”© ì¶”ì¶œ
3. íŒ¨ì¹˜ ê°„ ìŒë³„ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚°
4. íˆíŠ¸ë§µìœ¼ë¡œ ì‹œê°í™”</p>
<details>
<summary>ì†”ë£¨ì…˜</summary>


<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoImageProcessor</span><span class="p">,</span> <span class="n">AutoModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Load model</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">AutoImageProcessor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;facebook/dinov2-small&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;facebook/dinov2-small&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="c1"># Load image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;cat.jpg&#39;</span><span class="p">)</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">images</span><span class="o">=</span><span class="n">img</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">)</span>

<span class="c1"># Extract features</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">patch_embeddings</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">last_hidden_state</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>  <span class="c1"># Exclude [CLS]</span>

<span class="c1"># Reshape to spatial grid</span>
<span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">patch_embeddings</span><span class="o">.</span><span class="n">shape</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">W</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">patches</span> <span class="o">=</span> <span class="n">patch_embeddings</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">D</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># (H, W, D)</span>

<span class="c1"># Compute cosine similarity</span>
<span class="n">patches_flat</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>  <span class="c1"># (H*W, D)</span>
<span class="c1"># Normalize</span>
<span class="n">patches_norm</span> <span class="o">=</span> <span class="n">patches_flat</span> <span class="o">/</span> <span class="n">patches_flat</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Cosine similarity matrix</span>
<span class="n">sim_matrix</span> <span class="o">=</span> <span class="n">patches_norm</span> <span class="o">@</span> <span class="n">patches_norm</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># (H*W, H*W)</span>

<span class="c1"># Visualize</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sim_matrix</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cosine Similarity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Patch-level Feature Similarity (DINOv2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Patch index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Patch index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dinov2_similarity.png&#39;</span><span class="p">)</span>
</code></pre></div>


</details>

<h3 id="4-lcm">ë¬¸ì œ 4: LCM ë¹ ë¥¸ ìƒì„±<a class="header-link" href="#4-lcm" title="Permanent link">&para;</a></h3>
<p>í‘œì¤€ DDIM (50 ë‹¨ê³„)ê³¼ LCM (4 ë‹¨ê³„) ê°„ì˜ ìƒì„± ì†ë„ì™€ í’ˆì§ˆì„ ë¹„êµí•˜ì„¸ìš”:
1. Stable Diffusion 1.5 ë¡œë“œ
2. DDIMìœ¼ë¡œ ìƒì„± (50 ë‹¨ê³„)
3. LCM-LoRA ë¡œë“œ
4. LCMìœ¼ë¡œ ìƒì„± (4 ë‹¨ê³„)
5. ë‘ ê²½ìš°ì˜ ì‹œê°„ ì¸¡ì •</p>
<details>
<summary>ì†”ë£¨ì…˜</summary>


<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">diffusers</span><span class="w"> </span><span class="kn">import</span> <span class="n">StableDiffusionPipeline</span><span class="p">,</span> <span class="n">LCMScheduler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Load base model</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">StableDiffusionPipeline</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
    <span class="s2">&quot;runwayml/stable-diffusion-v1-5&quot;</span><span class="p">,</span>
    <span class="n">torch_dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span>
<span class="p">)</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;A serene lake with mountains in background, sunset, highly detailed&quot;</span>

<span class="c1"># Standard DDIM</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating with DDIM (50 steps)...&quot;</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">image_ddim</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">num_inference_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">guidance_scale</span><span class="o">=</span><span class="mf">7.5</span><span class="p">)</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ddim_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DDIM time: </span><span class="si">{</span><span class="n">ddim_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="n">image_ddim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;ddim_50steps.png&quot;</span><span class="p">)</span>

<span class="c1"># Load LCM-LoRA</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">load_lora_weights</span><span class="p">(</span><span class="s2">&quot;latent-consistency/lcm-lora-sdv1-5&quot;</span><span class="p">)</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">LCMScheduler</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># LCM generation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating with LCM (4 steps)...&quot;</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">image_lcm</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">num_inference_steps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">guidance_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">lcm_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LCM time: </span><span class="si">{</span><span class="n">lcm_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="n">image_lcm</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;lcm_4steps.png&quot;</span><span class="p">)</span>

<span class="c1"># Speed comparison</span>
<span class="n">speedup</span> <span class="o">=</span> <span class="n">ddim_time</span> <span class="o">/</span> <span class="n">lcm_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Speedup: </span><span class="si">{</span><span class="n">speedup</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x faster with LCM&quot;</span><span class="p">)</span>
</code></pre></div>


</details>

<h3 id="5">ë¬¸ì œ 5: ëª¨ë¸ ë¹„êµ<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ì…‹ì—ì„œ ConvNeXt-T, EfficientNetV2-S, DINOv2-Së¥¼ ë¹„êµí•˜ì„¸ìš”:
1. timm/transformersì—ì„œ ì„¸ ëª¨ë¸ ëª¨ë‘ ë¡œë“œ
2. í•™ìŠµ ì„¸íŠ¸ì— ëŒ€í•œ íŠ¹ì§• ì¶”ì¶œ (ë™ê²°)
3. íŠ¹ì§•ì— ëŒ€í•´ ì„ í˜• SVM í•™ìŠµ
4. ì •í™•ë„ ë° ì¶”ë¡  ì‹œê°„ ë³´ê³ </p>
<details>
<summary>ì†”ë£¨ì…˜</summary>


<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">timm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoImageProcessor</span><span class="p">,</span> <span class="n">AutoModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Assume we have a dataset loader</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># DataLoader for training set</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="o">...</span>   <span class="c1"># DataLoader for test set</span>

<span class="k">def</span><span class="w"> </span><span class="nf">extract_features</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">is_dinov2</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">imgs</span><span class="p">,</span> <span class="n">lbls</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
            <span class="n">imgs</span> <span class="o">=</span> <span class="n">imgs</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">is_dinov2</span><span class="p">:</span>
                <span class="c1"># DINOv2 uses different interface</span>
                <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span>
                <span class="n">feats</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">last_hidden_state</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># [CLS]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">feats</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span>  <span class="c1"># timm feature extractor</span>
            <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feats</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lbls</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="c1"># 1. ConvNeXt-T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading ConvNeXt-T...&quot;</span><span class="p">)</span>
<span class="n">convnext</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;convnext_tiny&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">convnext</span> <span class="o">=</span> <span class="n">convnext</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">train_feats_cn</span><span class="p">,</span> <span class="n">train_labels</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">convnext</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">)</span>
<span class="n">test_feats_cn</span><span class="p">,</span> <span class="n">test_labels</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">convnext</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">)</span>
<span class="n">cn_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># 2. EfficientNetV2-S</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading EfficientNetV2-S...&quot;</span><span class="p">)</span>
<span class="n">effnet</span> <span class="o">=</span> <span class="n">timm</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;tf_efficientnetv2_s&#39;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">effnet</span> <span class="o">=</span> <span class="n">effnet</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">train_feats_eff</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">effnet</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">)</span>
<span class="n">test_feats_eff</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">effnet</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">)</span>
<span class="n">eff_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># 3. DINOv2-S</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading DINOv2-S...&quot;</span><span class="p">)</span>
<span class="n">dinov2</span> <span class="o">=</span> <span class="n">AutoModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;facebook/dinov2-small&#39;</span><span class="p">)</span>
<span class="n">dinov2</span> <span class="o">=</span> <span class="n">dinov2</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">train_feats_dino</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">dinov2</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">is_dinov2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_feats_dino</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">dinov2</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">is_dinov2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dino_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># Train linear SVM on each</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">train_feats</span><span class="p">,</span> <span class="n">test_feats</span><span class="p">,</span> <span class="n">infer_time</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;ConvNeXt-T&#39;</span><span class="p">,</span> <span class="n">train_feats_cn</span><span class="p">,</span> <span class="n">test_feats_cn</span><span class="p">,</span> <span class="n">cn_time</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;EfficientNetV2-S&#39;</span><span class="p">,</span> <span class="n">train_feats_eff</span><span class="p">,</span> <span class="n">test_feats_eff</span><span class="p">,</span> <span class="n">eff_time</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;DINOv2-S&#39;</span><span class="p">,</span> <span class="n">train_feats_dino</span><span class="p">,</span> <span class="n">test_feats_dino</span><span class="p">,</span> <span class="n">dino_time</span><span class="p">)</span>
<span class="p">]:</span>
    <span class="n">svm</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
    <span class="n">svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_feats</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_feats</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">test_labels</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Accuracy=</span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Inference time=</span><span class="si">{</span><span class="n">infer_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</code></pre></div>


</details>

<hr />
<h2 id="_3">ë„¤ë¹„ê²Œì´ì…˜<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>ì´ì „</strong>: <a href="26_Normalization_Layers.md">26. ì •ê·œí™” ë ˆì´ì–´(Normalization Layers)</a></li>
<li><strong>ë‹¤ìŒ</strong>: <a href="00_Overview.md">ê°œìš”</a></li>
</ul>
<hr />
<h2 id="_4">ì¶”ê°€ ìë£Œ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>ConvNeXt</strong>: <a href="https://arxiv.org/abs/2201.03545">A ConvNet for the 2020s</a> (Liu et al., 2022)</li>
<li><strong>ConvNeXt V2</strong>: <a href="https://arxiv.org/abs/2301.00808">Co-designing and Scaling ConvNets with Masked Autoencoders</a> (Woo et al., 2023)</li>
<li><strong>EfficientNetV2</strong>: <a href="https://arxiv.org/abs/2104.00298">Smaller Models and Faster Training</a> (Tan &amp; Le, 2021)</li>
<li><strong>DINOv2</strong>: <a href="https://arxiv.org/abs/2304.07193">Learning Robust Visual Features without Supervision</a> (Oquab et al., 2023)</li>
<li><strong>Latent Consistency Models</strong>: <a href="https://arxiv.org/abs/2310.04378">Synthesizing High-Resolution Images with Few-Step Inference</a> (Luo et al., 2023)</li>
<li><strong>timm Documentation</strong>: https://timm.fast.ai/</li>
<li><strong>Hugging Face Models</strong>: https://huggingface.co/models</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Deep_Learning/36_Self_Supervised_Learning.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">36. Self-Supervised Learning</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Deep_Learning/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Deep_Learning/38_Object_Detection.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">38. ê°ì²´ íƒì§€ (Object Detection)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}