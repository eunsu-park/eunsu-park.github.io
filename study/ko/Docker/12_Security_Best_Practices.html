{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€(Security Best Practices) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Docker/">Docker</a>
    <span class="separator">/</span>
    <span class="current">ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€(Security Best Practices)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€(Security Best Practices)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Docker/11_Container_Networking.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí‚¹(Container Networking)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Docker/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1">1. ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ê°œìš”</a><ul>
<li><a href="#container-threat-model">ì»¨í…Œì´ë„ˆ ìœ„í˜‘ ëª¨ë¸(Container Threat Model)</a></li>
<li><a href="#defense-in-depth-strategy">ì‹¬ì¸µ ë°©ì–´ ì „ëµ(Defense in Depth Strategy)</a></li>
<li><a href="#_3">ë³´ì•ˆ ì›ì¹™</a></li>
</ul>
</li>
<li><a href="#2">2. ì´ë¯¸ì§€ ë³´ì•ˆ</a><ul>
<li><a href="#_4">ì•ˆì „í•œ ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„ íƒ</a></li>
<li><a href="#_5">ìµœì†Œ í”„ë¡œë•ì…˜ ì´ë¯¸ì§€ë¥¼ ìœ„í•œ ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ</a></li>
<li><a href="#trivy">Trivyë¥¼ ì‚¬ìš©í•œ ì´ë¯¸ì§€ ìŠ¤ìºë‹</a></li>
<li><a href="#snyk">Snykë¥¼ ì‚¬ìš©í•œ ìŠ¤ìºë‹</a></li>
<li><a href="#cicd">CI/CDì—ì„œ ìë™í™”ëœ ìŠ¤ìºë‹</a></li>
</ul>
</li>
<li><a href="#3-dockerfile">3. Dockerfile ëª¨ë²” ì‚¬ë¡€</a><ul>
<li><a href="#non-root">Non-Root ì‚¬ìš©ìë¡œ ì‹¤í–‰</a></li>
<li><a href="#copy-vs-add">COPY vs ADD</a></li>
<li><a href="#_6">ì‹œí¬ë¦¿ ì²˜ë¦¬</a></li>
<li><a href="#dockerignore">.dockerignore ì‚¬ìš©</a></li>
<li><a href="#_7">ë ˆì´ì–´ ìµœì í™”</a></li>
<li><a href="#dockerfile">ê°•í™”ëœ Dockerfile ì˜ˆì œ</a></li>
</ul>
</li>
<li><a href="#4">4. ëŸ°íƒ€ì„ ë³´ì•ˆ</a><ul>
<li><a href="#capabilities">Capabilities ì œê±°</a></li>
<li><a href="#capabilities-docker-compose">Capabilitiesë¥¼ ì‚¬ìš©í•œ Docker Compose</a></li>
<li><a href="#read-only-filesystem">ì½ê¸° ì „ìš© íŒŒì¼ì‹œìŠ¤í…œ(Read-Only Filesystem)</a></li>
<li><a href="#seccomp">Seccomp í”„ë¡œíŒŒì¼</a></li>
<li><a href="#apparmor">AppArmor í”„ë¡œíŒŒì¼</a></li>
<li><a href="#_8">ë³´ì•ˆ ì˜µì…˜ ì˜ˆì œ</a></li>
</ul>
</li>
<li><a href="#5">5. ì‹œí¬ë¦¿ ê´€ë¦¬</a><ul>
<li><a href="#docker-secrets-swarm-mode">Docker Secrets (Swarm Mode)</a></li>
<li><a href="#_9">í™˜ê²½ ë³€ìˆ˜ì˜ í•¨ì •</a></li>
<li><a href="#_10">ì™¸ë¶€ ì‹œí¬ë¦¿ ë§¤ë‹ˆì €</a><ul>
<li><a href="#hashicorp-vault">HashiCorp Vault</a></li>
<li><a href="#aws-secrets-manager">AWS Secrets Manager</a></li>
</ul>
</li>
<li><a href="#kubernetes-secrets">Kubernetes Secrets</a></li>
</ul>
</li>
<li><a href="#6">6. ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ</a><ul>
<li><a href="#_11">ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬</a></li>
<li><a href="#tls">TLS ì•”í˜¸í™”</a></li>
<li><a href="#egress">Egress ì œì–´</a></li>
<li><a href="#kubernetes">Kubernetes ë„¤íŠ¸ì›Œí¬ ì •ì±…</a></li>
</ul>
</li>
<li><a href="#7">7. ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë³´ì•ˆ</a><ul>
<li><a href="#docker-content-trust">Docker Content Trustë¥¼ ì‚¬ìš©í•œ ì´ë¯¸ì§€ ì„œëª…</a></li>
<li><a href="#notary">ì´ë¯¸ì§€ ì„œëª…ì„ ìœ„í•œ Notary</a></li>
<li><a href="#_12">ì¸ì¦ì„ ì‚¬ìš©í•œ í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬</a></li>
<li><a href="#harbor">Harbor ë ˆì§€ìŠ¤íŠ¸ë¦¬</a></li>
</ul>
</li>
<li><a href="#8-kubernetes">8. Kubernetes ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸</a><ul>
<li><a href="#pod">Pod ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸</a></li>
<li><a href="#pod-pod-security-standards">Pod ë³´ì•ˆ í‘œì¤€(Pod Security Standards)</a></li>
<li><a href="#pod_1">ì œí•œëœ Pod ì˜ˆì œ</a></li>
<li><a href="#pod-rbac">Podë¥¼ ìœ„í•œ RBAC</a></li>
</ul>
</li>
<li><a href="#9">9. ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬</a><ul>
<li><a href="#falco">ëŸ°íƒ€ì„ ì´ìƒ íƒì§€ë¥¼ ìœ„í•œ Falco</a></li>
<li><a href="#docker-bench-security">Docker Bench Security</a></li>
<li><a href="#_13">ê°ì‚¬ ë¡œê¹…</a><ul>
<li><a href="#docker-daemon">Docker Daemon ê°ì‚¬</a></li>
<li><a href="#kubernetes_1">Kubernetes ê°ì‚¬ ì •ì±…</a></li>
</ul>
</li>
<li><a href="#prometheus">Prometheusë¥¼ ì‚¬ìš©í•œ ëª¨ë‹ˆí„°ë§</a></li>
</ul>
</li>
<li><a href="#10">10. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-dockerfile">ì—°ìŠµ 1: ì•ˆì „í•œ Dockerfile</a></li>
<li><a href="#2_1">ì—°ìŠµ 2: ëŸ°íƒ€ì„ ë³´ì•ˆ êµ¬ì„±</a></li>
<li><a href="#3-kubernetes">ì—°ìŠµ 3: Kubernetes ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸</a></li>
<li><a href="#4_1">ì—°ìŠµ 4: ì´ë¯¸ì§€ ìŠ¤ìºë‹ íŒŒì´í”„ë¼ì¸</a></li>
<li><a href="#5_1">ì—°ìŠµ 5: ì‹œí¬ë¦¿ ê´€ë¦¬</a></li>
<li><a href="#6_1">ì—°ìŠµ 6: ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ</a></li>
</ul>
</li>
<li><a href="#_14">ìš”ì•½</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="security-best-practices">ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€(Security Best Practices)<a class="header-link" href="#security-best-practices" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ìœ„í˜‘ ëª¨ë¸ ì´í•´</li>
<li>ì´ë¯¸ì§€ ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€ ë° ì·¨ì•½ì  ìŠ¤ìºë‹ ì ìš©</li>
<li>ëŸ°íƒ€ì„ ë³´ì•ˆ ì œì–´ ë° ìµœì†Œ ê¶Œí•œ êµ¬í˜„</li>
<li>ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‹œí¬ë¦¿ì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬</li>
<li>ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ë° ê²©ë¦¬ êµ¬ì„±</li>
<li>ì„œëª… ë° ì½˜í…ì¸  ì‹ ë¢°ë¡œ ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë³´ì•ˆ</li>
<li>Kubernetes ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸(Security Context) ë° Pod ë³´ì•ˆ í‘œì¤€ ì ìš©</li>
<li>ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ë™ì‘ ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬</li>
</ul>
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ì»¨í…Œì´ë„ˆ-ë³´ì•ˆ-ê°œìš”">ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ê°œìš”</a></li>
<li><a href="#2-ì´ë¯¸ì§€-ë³´ì•ˆ">ì´ë¯¸ì§€ ë³´ì•ˆ</a></li>
<li><a href="#3-dockerfile-ëª¨ë²”-ì‚¬ë¡€">Dockerfile ëª¨ë²” ì‚¬ë¡€</a></li>
<li><a href="#4-ëŸ°íƒ€ì„-ë³´ì•ˆ">ëŸ°íƒ€ì„ ë³´ì•ˆ</a></li>
<li><a href="#5-ì‹œí¬ë¦¿-ê´€ë¦¬">ì‹œí¬ë¦¿ ê´€ë¦¬</a></li>
<li><a href="#6-ë„¤íŠ¸ì›Œí¬-ë³´ì•ˆ">ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ</a></li>
<li><a href="#7-ì»¨í…Œì´ë„ˆ-ë ˆì§€ìŠ¤íŠ¸ë¦¬-ë³´ì•ˆ">ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë³´ì•ˆ</a></li>
<li><a href="#8-kubernetes-ë³´ì•ˆ-ì»¨í…ìŠ¤íŠ¸">Kubernetes ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸</a></li>
<li><a href="#9-ëª¨ë‹ˆí„°ë§-ë°-ê°ì‚¬">ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬</a></li>
<li><a href="#10-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<p><strong>ë‚œì´ë„</strong>: â­â­â­â­</p>
<hr />
<h2 id="1">1. ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ê°œìš”<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="container-threat-model">ì»¨í…Œì´ë„ˆ ìœ„í˜‘ ëª¨ë¸(Container Threat Model)<a class="header-link" href="#container-threat-model" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                 </span><span class="nx">Container</span><span class="w"> </span><span class="nx">Attack</span><span class="w"> </span><span class="nx">Surface</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nx">Supply</span><span class="w"> </span><span class="nx">Chain</span><span class="w"> </span><span class="nx">Attacks</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Malicious</span><span class="w"> </span><span class="kd">base</span><span class="w"> </span><span class="nx">images</span><span class="w">                        </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Compromised</span><span class="w"> </span><span class="nx">dependencies</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Vulnerable</span><span class="w"> </span><span class="nx">packages</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â–¼</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="nx">Image</span><span class="w"> </span><span class="nx">Vulnerabilities</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Known</span><span class="w"> </span><span class="nx">CVEs</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">OS</span><span class="o">/</span><span class="nx">libraries</span><span class="w">                   </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Outdated</span><span class="w"> </span><span class="nx">software</span><span class="w">                            </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Exposed</span><span class="w"> </span><span class="nx">secrets</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">layers</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â–¼</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nx">Runtime</span><span class="w"> </span><span class="nx">Threats</span><span class="w">                                </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Container</span><span class="w"> </span><span class="nx">breakout</span><span class="w">                           </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Privilege</span><span class="w"> </span><span class="nx">escalation</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Resource</span><span class="w"> </span><span class="nx">abuse</span><span class="w">                               </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                         </span><span class="err">â–¼</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="nx">Host</span><span class="o">/</span><span class="nx">Orchestrator</span><span class="w"> </span><span class="nx">Attacks</span><span class="w">                      </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Compromised</span><span class="w"> </span><span class="nx">Docker</span><span class="w"> </span><span class="nx">daemon</span><span class="w">                    </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Kubernetes</span><span class="w"> </span><span class="nx">API</span><span class="w"> </span><span class="nx">abuse</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="nx">Node</span><span class="w"> </span><span class="nx">compromise</span><span class="w">                              </span><span class="err">â”‚</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">    </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="defense-in-depth-strategy">ì‹¬ì¸µ ë°©ì–´ ì „ëµ(Defense in Depth Strategy)<a class="header-link" href="#defense-in-depth-strategy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Container Security Layers                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Layer 7: Monitoring &amp; Incident Response                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Runtime detection, Audit logs, Alerting           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Layer 6: Network Security                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Network policies, TLS, Firewalls                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Layer 5: Secrets Management                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Vault, Docker secrets, Encrypted storage          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Layer 4: Runtime Security                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Capabilities, Seccomp, AppArmor, SELinux          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Layer 3: Image Security                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Scanning, Signing, Minimal base, No root          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Layer 2: Host Security                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  OS hardening, CIS benchmarks, Updates             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Layer 1: Infrastructure Security                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  IAM, VPC isolation, Physical security             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="_3">ë³´ì•ˆ ì›ì¹™<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ìµœì†Œ ê¶Œí•œ(Least Privilege)</strong>: í•„ìš”í•œ ìµœì†Œ ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰</li>
<li><strong>ì‹¬ì¸µ ë°©ì–´(Defense in Depth)</strong>: ì—¬ëŸ¬ ê³„ì¸µì˜ ë³´ì•ˆ ì œì–´</li>
<li><strong>ë¶ˆë³€ì„±(Immutability)</strong>: ì»¨í…Œì´ë„ˆë¥¼ ë¶ˆë³€ ì•„í‹°íŒ©íŠ¸ë¡œ ì·¨ê¸‰</li>
<li><strong>ìµœì†Œ ê³µê²© í‘œë©´(Minimal Attack Surface)</strong>: ë…¸ì¶œëœ êµ¬ì„± ìš”ì†Œ ê°ì†Œ</li>
<li><strong>ì‹œí”„íŠ¸ ë ˆí”„íŠ¸(Shift Left)</strong>: ê°œë°œ ë¼ì´í”„ì‚¬ì´í´ ì´ˆê¸°ì— ë³´ì•ˆ ì ìš©</li>
<li><strong>ì œë¡œ íŠ¸ëŸ¬ìŠ¤íŠ¸(Zero Trust)</strong>: ëª¨ë“  ê²ƒì„ ê²€ì¦í•˜ê³ , ì•„ë¬´ê²ƒë„ ì‹ ë¢°í•˜ì§€ ì•ŠìŒ</li>
</ol>
<hr />
<h2 id="2">2. ì´ë¯¸ì§€ ë³´ì•ˆ<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="_4">ì•ˆì „í•œ ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„ íƒ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># âŒ BAD: Large attack surface, many vulnerabilities</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu:latest</span>

<span class="c"># âŒ BAD: &quot;latest&quot; tag is not reproducible</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:latest</span>

<span class="c"># âœ… GOOD: Minimal base image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">alpine:3.19</span>

<span class="c"># âœ… GOOD: Distroless (no shell, package manager)</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">gcr.io/distroless/base-debian12</span>

<span class="c"># âœ… GOOD: Specific version tag for reproducibility</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18.19-alpine3.19</span>

<span class="c"># âœ… BEST: Digest pinning for immutability</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18.19-alpine3.19@sha256:abc123...</span>
</code></pre></div>

<h3 id="_5">ìµœì†Œ í”„ë¡œë•ì…˜ ì´ë¯¸ì§€ë¥¼ ìœ„í•œ ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># âŒ BAD: Build tools in production image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">golang:1.21</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>go<span class="w"> </span>build<span class="w"> </span>-o<span class="w"> </span>myapp
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;./myapp&quot;</span><span class="p">]</span>

<span class="c"># âœ… GOOD: Multi-stage build</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">golang:1.21</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>go<span class="w"> </span>build<span class="w"> </span>-o<span class="w"> </span>myapp

<span class="k">FROM</span><span class="w"> </span><span class="s">alpine:3.19</span>
<span class="k">RUN</span><span class="w"> </span>apk<span class="w"> </span>add<span class="w"> </span>--no-cache<span class="w"> </span>ca-certificates
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/myapp<span class="w"> </span>/myapp
<span class="k">USER</span><span class="w"> </span><span class="s">1000</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/myapp&quot;</span><span class="p">]</span>

<span class="c"># âœ… BEST: Distroless final image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">golang:1.21</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span><span class="nv">CGO_ENABLED</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>go<span class="w"> </span>build<span class="w"> </span>-o<span class="w"> </span>myapp

<span class="k">FROM</span><span class="w"> </span><span class="s">gcr.io/distroless/static-debian12</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/myapp<span class="w"> </span>/myapp
<span class="k">USER</span><span class="w"> </span><span class="s">nonroot:nonroot</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/myapp&quot;</span><span class="p">]</span>
</code></pre></div>

<h3 id="trivy">Trivyë¥¼ ì‚¬ìš©í•œ ì´ë¯¸ì§€ ìŠ¤ìºë‹<a class="header-link" href="#trivy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Install Trivy</span>
<span class="c1"># macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>trivy

<span class="c1"># Linux</span>
wget<span class="w"> </span>-qO<span class="w"> </span>-<span class="w"> </span>https://aquasecurity.github.io/trivy-repo/deb/public.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb https://aquasecurity.github.io/trivy-repo/deb </span><span class="k">$(</span>lsb_release<span class="w"> </span>-sc<span class="k">)</span><span class="s2"> main&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/trivy.list
sudo<span class="w"> </span>apt-get<span class="w"> </span>update
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>trivy

<span class="c1"># Scan Docker image</span>
trivy<span class="w"> </span>image<span class="w"> </span>nginx:latest

<span class="c1"># Output (truncated):</span>
<span class="c1"># nginx:latest (debian 12.4)</span>
<span class="c1"># Total: 85 (CRITICAL: 12, HIGH: 23, MEDIUM: 35, LOW: 15)</span>
<span class="c1">#</span>
<span class="c1"># â”œâ”€â”€ libssl3 (CVE-2023-12345) CRITICAL</span>
<span class="c1"># â”‚   Installed Version: 3.0.11-1~deb12u1</span>
<span class="c1"># â”‚   Fixed Version: 3.0.11-1~deb12u2</span>
<span class="c1"># â””â”€â”€ ...</span>

<span class="c1"># Scan with severity filter</span>
trivy<span class="w"> </span>image<span class="w"> </span>--severity<span class="w"> </span>CRITICAL,HIGH<span class="w"> </span>nginx:latest

<span class="c1"># Scan and exit with error if vulnerabilities found</span>
trivy<span class="w"> </span>image<span class="w"> </span>--exit-code<span class="w"> </span><span class="m">1</span><span class="w"> </span>--severity<span class="w"> </span>CRITICAL<span class="w"> </span>myapp:latest

<span class="c1"># Scan for secrets in image</span>
trivy<span class="w"> </span>image<span class="w"> </span>--scanners<span class="w"> </span>secret<span class="w"> </span>nginx:latest

<span class="c1"># Generate JSON report</span>
trivy<span class="w"> </span>image<span class="w"> </span>-f<span class="w"> </span>json<span class="w"> </span>-o<span class="w"> </span>report.json<span class="w"> </span>nginx:latest
</code></pre></div>

<h3 id="snyk">Snykë¥¼ ì‚¬ìš©í•œ ìŠ¤ìºë‹<a class="header-link" href="#snyk" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Install Snyk</span>
npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>snyk

<span class="c1"># Authenticate</span>
snyk<span class="w"> </span>auth

<span class="c1"># Scan image</span>
snyk<span class="w"> </span>container<span class="w"> </span><span class="nb">test</span><span class="w"> </span>nginx:latest

<span class="c1"># Scan and monitor</span>
snyk<span class="w"> </span>container<span class="w"> </span>monitor<span class="w"> </span>nginx:latest

<span class="c1"># Scan Dockerfile</span>
snyk<span class="w"> </span>container<span class="w"> </span><span class="nb">test</span><span class="w"> </span>nginx:latest<span class="w"> </span>--file<span class="o">=</span>Dockerfile
</code></pre></div>

<h3 id="cicd">CI/CDì—ì„œ ìë™í™”ëœ ìŠ¤ìºë‹<a class="header-link" href="#cicd" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .github/workflows/scan.yml</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Scan</span>

<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">pull_request</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build image</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker build -t myapp:${{ github.sha }} .</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Trivy scanner</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasecurity/trivy-action@master</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">image-ref</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:${{ github.sha }}</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;sarif&#39;</span>
<span class="w">          </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.sarif&#39;</span>
<span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;CRITICAL,HIGH&#39;</span>
<span class="w">          </span><span class="nt">exit-code</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1&#39;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Trivy results to GitHub Security</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github/codeql-action/upload-sarif@v2</span>
<span class="w">        </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always()</span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.sarif&#39;</span>
</code></pre></div>

<hr />
<h2 id="3-dockerfile">3. Dockerfile ëª¨ë²” ì‚¬ë¡€<a class="header-link" href="#3-dockerfile" title="Permanent link">&para;</a></h2>
<h3 id="non-root">Non-Root ì‚¬ìš©ìë¡œ ì‹¤í–‰<a class="header-link" href="#non-root" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># âŒ BAD: Running as root (default)</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">nginx:alpine</span>
<span class="k">COPY</span><span class="w"> </span>app<span class="w"> </span>/usr/share/nginx/html

<span class="c"># âœ… GOOD: Create and use non-root user</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">nginx:alpine</span>
<span class="k">RUN</span><span class="w"> </span>addgroup<span class="w"> </span>-g<span class="w"> </span><span class="m">1000</span><span class="w"> </span>appgroup<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>adduser<span class="w"> </span>-D<span class="w"> </span>-u<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-G<span class="w"> </span>appgroup<span class="w"> </span>appuser
<span class="k">USER</span><span class="w"> </span><span class="s">appuser</span>
<span class="k">COPY</span><span class="w"> </span>app<span class="w"> </span>/usr/share/nginx/html

<span class="c"># âœ… GOOD: Use numeric UID (works better in Kubernetes)</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18-alpine</span>
<span class="k">RUN</span><span class="w"> </span>addgroup<span class="w"> </span>-g<span class="w"> </span><span class="m">1001</span><span class="w"> </span>nodegroup<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>adduser<span class="w"> </span>-D<span class="w"> </span>-u<span class="w"> </span><span class="m">1001</span><span class="w"> </span>-G<span class="w"> </span>nodegroup<span class="w"> </span>nodeuser
<span class="k">USER</span><span class="w"> </span><span class="s">1001</span>
<span class="k">COPY</span><span class="w"> </span>--chown<span class="o">=</span><span class="m">1001</span>:1001<span class="w"> </span>.<span class="w"> </span>/app
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;server.js&quot;</span><span class="p">]</span>

<span class="c"># âœ… BEST: Distroless with non-root</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">COPY</span><span class="w"> </span>package*.json<span class="w"> </span>./
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>ci<span class="w"> </span>--only<span class="o">=</span>production

<span class="k">FROM</span><span class="w"> </span><span class="s">gcr.io/distroless/nodejs18-debian12</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/node_modules<span class="w"> </span>/app/node_modules
<span class="k">COPY</span><span class="w"> </span>--chown<span class="o">=</span>nonroot:nonroot<span class="w"> </span>.<span class="w"> </span>/app
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">USER</span><span class="w"> </span><span class="s">nonroot</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;server.js&quot;</span><span class="p">]</span>
</code></pre></div>

<h3 id="copy-vs-add">COPY vs ADD<a class="header-link" href="#copy-vs-add" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># âŒ BAD: ADD has unexpected behavior (auto-extraction)</span>
<span class="k">ADD</span><span class="w"> </span>archive.tar.gz<span class="w"> </span>/app/
<span class="k">ADD</span><span class="w"> </span>https://example.com/file.txt<span class="w"> </span>/app/

<span class="c"># âœ… GOOD: Use COPY for local files</span>
<span class="k">COPY</span><span class="w"> </span>archive.tar.gz<span class="w"> </span>/app/
<span class="k">COPY</span><span class="w"> </span>src/<span class="w"> </span>/app/src/

<span class="c"># âœ… GOOD: Explicit tar extraction if needed</span>
<span class="k">RUN</span><span class="w"> </span>wget<span class="w"> </span>https://example.com/archive.tar.gz<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>tar<span class="w"> </span>xzf<span class="w"> </span>archive.tar.gz<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>rm<span class="w"> </span>archive.tar.gz
</code></pre></div>

<h3 id="_6">ì‹œí¬ë¦¿ ì²˜ë¦¬<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># âŒ BAD: Secrets in environment variables</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">alpine</span>
<span class="k">ENV</span><span class="w"> </span><span class="nv">API_KEY</span><span class="o">=</span>sk-1234567890abcdef
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;./app&quot;</span><span class="p">]</span>

<span class="c"># âŒ BAD: Secrets in build args (exposed in history)</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">alpine</span>
<span class="k">ARG</span><span class="w"> </span>API_KEY
<span class="k">RUN</span><span class="w"> </span>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$API_KEY</span><span class="s2">&quot;</span><span class="w"> </span>https://api.example.com
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;./app&quot;</span><span class="p">]</span>

<span class="c"># âœ… GOOD: Use Docker BuildKit secrets</span>
<span class="c"># syntax=docker/dockerfile:1.4</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">alpine</span>
<span class="k">RUN</span><span class="w"> </span>--mount<span class="o">=</span><span class="nv">type</span><span class="o">=</span>secret,id<span class="o">=</span>api_key<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">API_KEY</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span>/run/secrets/api_key<span class="k">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$API_KEY</span><span class="s2">&quot;</span><span class="w"> </span>https://api.example.com
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;./app&quot;</span><span class="p">]</span>

<span class="c"># Build with:</span>
<span class="c"># docker buildx build --secret id=api_key,src=./api_key.txt -t myapp .</span>

<span class="c"># âœ… GOOD: Runtime secrets with Docker Swarm</span>
<span class="c"># Secrets mounted at /run/secrets/&lt;secret_name&gt;</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">alpine</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;API_KEY=$(cat /run/secrets/api_key) ./app&quot;</span><span class="p">]</span>
</code></pre></div>

<h3 id="dockerignore">.dockerignore ì‚¬ìš©<a class="header-link" href="#dockerignore" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .dockerignore</span>
<span class="c1"># Prevent sensitive files from being copied into image</span>

<span class="c1"># Git</span>
.git
.gitignore

<span class="c1"># Secrets</span>
.env
.env.*
*.key
*.pem
secrets/
credentials.json

<span class="c1"># Build artifacts</span>
node_modules/
dist/
build/
*.log

<span class="c1"># Documentation</span>
README.md
docs/
*.md

<span class="c1"># CI/CD</span>
.github/
.gitlab-ci.yml
Jenkinsfile

<span class="c1"># IDE</span>
.vscode/
.idea/
*.swp
</code></pre></div>

<h3 id="_7">ë ˆì´ì–´ ìµœì í™”<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># âŒ BAD: Many layers, cache invalidation</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18-alpine</span>
<span class="k">COPY</span><span class="w"> </span>package.json<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install
<span class="k">COPY</span><span class="w"> </span>src/<span class="w"> </span>./src/
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>prune<span class="w"> </span>--production

<span class="c"># âœ… GOOD: Optimized layer caching</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18-alpine</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="c"># Cache dependencies separately</span>
<span class="k">COPY</span><span class="w"> </span>package*.json<span class="w"> </span>./
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>ci
<span class="c"># Copy source and build</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>npm<span class="w"> </span>prune<span class="w"> </span>--production

<span class="k">FROM</span><span class="w"> </span><span class="s">node:18-alpine</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/dist<span class="w"> </span>./dist
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/node_modules<span class="w"> </span>./node_modules
<span class="k">USER</span><span class="w"> </span><span class="s">node</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dist/server.js&quot;</span><span class="p">]</span>
</code></pre></div>

<h3 id="dockerfile">ê°•í™”ëœ Dockerfile ì˜ˆì œ<a class="header-link" href="#dockerfile" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c"># syntax=docker/dockerfile:1.4</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">golang:1.21-alpine3.19</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>

<span class="c"># Install build dependencies</span>
<span class="k">RUN</span><span class="w"> </span>apk<span class="w"> </span>add<span class="w"> </span>--no-cache<span class="w"> </span>git<span class="w"> </span>ca-certificates<span class="w"> </span>tzdata

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/build</span>

<span class="c"># Cache dependencies</span>
<span class="k">COPY</span><span class="w"> </span>go.mod<span class="w"> </span>go.sum<span class="w"> </span>./
<span class="k">RUN</span><span class="w"> </span>go<span class="w"> </span>mod<span class="w"> </span>download

<span class="c"># Build with security flags</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span><span class="nv">CGO_ENABLED</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">GOOS</span><span class="o">=</span>linux<span class="w"> </span><span class="nv">GOARCH</span><span class="o">=</span>amd64<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>go<span class="w"> </span>build<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-ldflags<span class="o">=</span><span class="s2">&quot;-w -s -extldflags &#39;-static&#39;&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-a<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-o<span class="w"> </span>app<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>./cmd/server

<span class="c"># Production image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">scratch</span>

<span class="c"># Copy necessary files from builder</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/etc/ssl/certs/ca-certificates.crt<span class="w"> </span>/etc/ssl/certs/
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/usr/share/zoneinfo<span class="w"> </span>/usr/share/zoneinfo
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/etc/passwd<span class="w"> </span>/etc/passwd
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/build/app<span class="w"> </span>/app

<span class="c"># Use non-root user (UID 65534 = nobody)</span>
<span class="k">USER</span><span class="w"> </span><span class="s">65534:65534</span>

<span class="c"># Health check</span>
<span class="k">HEALTHCHECK</span><span class="w"> </span>--interval<span class="o">=</span>30s<span class="w"> </span>--timeout<span class="o">=</span>3s<span class="w"> </span>--start-period<span class="o">=</span>5s<span class="w"> </span>--retries<span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>CMD<span class="w"> </span><span class="o">[</span><span class="s2">&quot;/app&quot;</span>,<span class="w"> </span><span class="s2">&quot;healthcheck&quot;</span><span class="o">]</span>

<span class="c"># Run application</span>
<span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/app&quot;</span><span class="p">]</span>
</code></pre></div>

<hr />
<h2 id="4">4. ëŸ°íƒ€ì„ ë³´ì•ˆ<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="capabilities">Capabilities ì œê±°<a class="header-link" href="#capabilities" title="Permanent link">&para;</a></h3>
<p>Linux capabilitiesëŠ” ì„¸ë¶„í™”ëœ ê¶Œí•œ ì œì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># âŒ BAD: Running with all capabilities</span>
docker<span class="w"> </span>run<span class="w"> </span>--privileged<span class="w"> </span>myapp

<span class="c1"># âœ… GOOD: Drop all capabilities, add only needed ones</span>
docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cap-drop<span class="o">=</span>ALL<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cap-add<span class="o">=</span>NET_BIND_SERVICE<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>myapp

<span class="c1"># List of common capabilities:</span>
<span class="c1"># NET_BIND_SERVICE - Bind to ports &lt; 1024</span>
<span class="c1"># CHOWN - Change file ownership</span>
<span class="c1"># DAC_OVERRIDE - Bypass file permission checks</span>
<span class="c1"># SETUID/SETGID - Change UID/GID</span>
<span class="c1"># NET_ADMIN - Network configuration</span>
<span class="c1"># SYS_TIME - Set system clock</span>
</code></pre></div>

<h3 id="capabilities-docker-compose">Capabilitiesë¥¼ ì‚¬ìš©í•œ Docker Compose<a class="header-link" href="#capabilities-docker-compose" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">web</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
<span class="w">    </span><span class="nt">cap_drop</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ALL</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CHOWN</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SETUID</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SETGID</span>
<span class="w">    </span><span class="nt">security_opt</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-new-privileges:true</span>
<span class="w">    </span><span class="nt">read_only</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tmpfs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/cache/nginx</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp</span>
</code></pre></div>

<h3 id="read-only-filesystem">ì½ê¸° ì „ìš© íŒŒì¼ì‹œìŠ¤í…œ(Read-Only Filesystem)<a class="header-link" href="#read-only-filesystem" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># âŒ BAD: Writable filesystem (default)</span>
docker<span class="w"> </span>run<span class="w"> </span>myapp

<span class="c1"># âœ… GOOD: Read-only root filesystem</span>
docker<span class="w"> </span>run<span class="w"> </span>--read-only<span class="w"> </span>myapp

<span class="c1"># âœ… GOOD: Read-only with tmpfs for writable dirs</span>
docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--read-only<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--tmpfs<span class="w"> </span>/tmp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--tmpfs<span class="w"> </span>/var/run<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>myapp
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">    </span><span class="nt">read_only</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tmpfs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp:noexec,nosuid,size=64m</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run:noexec,nosuid,size=64m</span>
</code></pre></div>

<h3 id="seccomp">Seccomp í”„ë¡œíŒŒì¼<a class="header-link" href="#seccomp" title="Permanent link">&para;</a></h3>
<p>Seccomp(Secure Computing Mode)ì€ ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì œí•œí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1">// seccomp-profile.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;defaultAction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SCMP_ACT_ERRNO&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;architectures&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;SCMP_ARCH_X86_64&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;SCMP_ARCH_X86&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;SCMP_ARCH_AARCH64&quot;</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;syscalls&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;accept&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;accept4&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;bind&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;connect&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;socket&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;read&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;write&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;open&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;close&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;stat&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;fstat&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;mmap&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;mprotect&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;rt_sigaction&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;rt_sigreturn&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;futex&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;exit_group&quot;</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SCMP_ACT_ALLOW&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Run with custom seccomp profile</span>
docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--security-opt<span class="w"> </span><span class="nv">seccomp</span><span class="o">=</span>seccomp-profile.json<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>myapp

<span class="c1"># Disable seccomp (not recommended in production)</span>
docker<span class="w"> </span>run<span class="w"> </span>--security-opt<span class="w"> </span><span class="nv">seccomp</span><span class="o">=</span>unconfined<span class="w"> </span>myapp
</code></pre></div>

<h3 id="apparmor">AppArmor í”„ë¡œíŒŒì¼<a class="header-link" href="#apparmor" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check AppArmor status</span>
sudo<span class="w"> </span>aa-status

<span class="c1"># Docker&#39;s default AppArmor profile: docker-default</span>
<span class="c1"># Located at: /etc/apparmor.d/docker</span>

<span class="c1"># Run with custom AppArmor profile</span>
docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--security-opt<span class="w"> </span><span class="nv">apparmor</span><span class="o">=</span>docker-custom<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>myapp

<span class="c1"># Disable AppArmor (not recommended)</span>
docker<span class="w"> </span>run<span class="w"> </span>--security-opt<span class="w"> </span><span class="nv">apparmor</span><span class="o">=</span>unconfined<span class="w"> </span>myapp
</code></pre></div>

<h3 id="_8">ë³´ì•ˆ ì˜µì…˜ ì˜ˆì œ<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">secure-app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>

<span class="w">    </span><span class="c1"># Drop all capabilities</span>
<span class="w">    </span><span class="nt">cap_drop</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ALL</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span>

<span class="w">    </span><span class="c1"># Read-only filesystem</span>
<span class="w">    </span><span class="nt">read_only</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">tmpfs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp:noexec,nosuid,nodev,size=64m</span>

<span class="w">    </span><span class="c1"># Security options</span>
<span class="w">    </span><span class="nt">security_opt</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-new-privileges:true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apparmor:docker-default</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seccomp:seccomp-profile.json</span>

<span class="w">    </span><span class="c1"># User</span>
<span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000:1000&quot;</span>

<span class="w">    </span><span class="c1"># Resource limits</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">          </span><span class="nt">cpus</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0.5&#39;</span>
<span class="w">          </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512M</span>
<span class="w">        </span><span class="nt">reservations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">cpus</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0.25&#39;</span>
<span class="w">          </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256M</span>

<span class="w">    </span><span class="c1"># Prevent privilege escalation</span>
<span class="w">    </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>

<hr />
<h2 id="5">5. ì‹œí¬ë¦¿ ê´€ë¦¬<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="docker-secrets-swarm-mode">Docker Secrets (Swarm Mode)<a class="header-link" href="#docker-secrets-swarm-mode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Create secret from file</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;my-db-password&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>db_password<span class="w"> </span>-

<span class="c1"># Create secret from stdin</span>
docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>api_key<span class="w"> </span>api_key.txt

<span class="c1"># List secrets</span>
docker<span class="w"> </span>secret<span class="w"> </span>ls

<span class="c1"># Inspect secret (content not shown)</span>
docker<span class="w"> </span>secret<span class="w"> </span>inspect<span class="w"> </span>db_password

<span class="c1"># Use secret in service</span>
docker<span class="w"> </span>service<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>web<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--secret<span class="w"> </span>db_password<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--secret<span class="w"> </span>api_key<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>myapp:latest

<span class="c1"># Secret available at /run/secrets/&lt;secret_name&gt;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml (Swarm stack)</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db_password</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api_key</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Reference secret file in env var</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DB_PASSWORD_FILE=/run/secrets/db_password</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>

<span class="nt">secrets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">db_password</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">api_key</span><span class="p">:</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./api_key.txt</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># app.py - Reading secrets</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_secret</span><span class="p">(</span><span class="n">secret_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read secret from file.&quot;&quot;&quot;</span>
    <span class="n">secret_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/run/secrets/</span><span class="si">{</span><span class="n">secret_name</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">secret_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="c1"># Fallback to environment variable (dev only)</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">secret_name</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

<span class="n">db_password</span> <span class="o">=</span> <span class="n">get_secret</span><span class="p">(</span><span class="s1">&#39;db_password&#39;</span><span class="p">)</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="n">get_secret</span><span class="p">(</span><span class="s1">&#39;api_key&#39;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_9">í™˜ê²½ ë³€ìˆ˜ì˜ í•¨ì •<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># âŒ BAD: Secrets in environment variables (visible in docker inspect)</span>
docker<span class="w"> </span>run<span class="w"> </span>-e<span class="w"> </span><span class="nv">DB_PASSWORD</span><span class="o">=</span>secret123<span class="w"> </span>myapp

<span class="c1"># âŒ BAD: Secrets in Dockerfile</span>
ENV<span class="w"> </span><span class="nv">API_KEY</span><span class="o">=</span>sk-1234567890

<span class="c1"># âŒ BAD: Secrets visible in process list</span>
docker<span class="w"> </span>run<span class="w"> </span>myapp<span class="w"> </span>--api-key<span class="o">=</span>sk-1234567890

<span class="c1"># âœ… GOOD: Secrets in files</span>
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span>/path/to/secrets:/secrets:ro<span class="w"> </span>myapp

<span class="c1"># âœ… GOOD: Docker secrets (Swarm)</span>
docker<span class="w"> </span>service<span class="w"> </span>create<span class="w"> </span>--secret<span class="w"> </span>db_password<span class="w"> </span>myapp

<span class="c1"># âœ… BETTER: External secret manager</span>
docker<span class="w"> </span>run<span class="w"> </span>-e<span class="w"> </span><span class="nv">VAULT_ADDR</span><span class="o">=</span>https://vault.example.com<span class="w"> </span>myapp
</code></pre></div>

<h3 id="_10">ì™¸ë¶€ ì‹œí¬ë¦¿ ë§¤ë‹ˆì €<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<h4 id="hashicorp-vault">HashiCorp Vault<a class="header-link" href="#hashicorp-vault" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VAULT_ADDR=https://vault.example.com</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VAULT_TOKEN_FILE=/run/secrets/vault-token</span>
<span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vault-token</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sh -c &quot;</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">export VAULT_TOKEN=$(cat /run/secrets/vault-token) &amp;&amp;</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">export DB_PASSWORD=$(vault kv get -field=password secret/db) &amp;&amp;</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">./app</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>

<span class="nt">secrets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">vault-token</span><span class="p">:</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./vault-token.txt</span>
</code></pre></div>

<h4 id="aws-secrets-manager">AWS Secrets Manager<a class="header-link" href="#aws-secrets-manager" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># app.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_secret</span><span class="p">(</span><span class="n">secret_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve secret from AWS Secrets Manager.&quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;secretsmanager&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;us-east-1&#39;</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">(</span><span class="n">SecretId</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;SecretString&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;SecretString&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;SecretBinary&#39;</span><span class="p">])</span>

<span class="c1"># Retrieve database credentials</span>
<span class="n">db_creds</span> <span class="o">=</span> <span class="n">get_secret</span><span class="p">(</span><span class="s1">&#39;prod/db/credentials&#39;</span><span class="p">)</span>
<span class="n">db_password</span> <span class="o">=</span> <span class="n">db_creds</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.11-slim</span>
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>boto3
<span class="k">COPY</span><span class="w"> </span>app.py<span class="w"> </span>/app/
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># IAM role attached to ECS task or EC2 instance</span>
<span class="c"># No hardcoded credentials needed</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.py&quot;</span><span class="p">]</span>
</code></pre></div>

<h3 id="kubernetes-secrets">Kubernetes Secrets<a class="header-link" href="#kubernetes-secrets" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># secret.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-secret</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Base64 encoded</span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cGFzc3dvcmQxMjM=</span>

<span class="nn">---</span>
<span class="c1"># deployment.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DB_PASSWORD</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-secret</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
<span class="w">        </span><span class="c1"># Or mount as file</span>
<span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secrets</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/secrets</span>
<span class="w">          </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secrets</span>
<span class="w">        </span><span class="nt">secret</span><span class="p">:</span>
<span class="w">          </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-secret</span>
</code></pre></div>

<hr />
<h2 id="6">6. ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="_11">ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">frontend</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>

<span class="w">  </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api:latest</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private</span>

<span class="w">  </span><span class="nt">database</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private</span>
<span class="w">    </span><span class="c1"># Database not exposed to public network</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">public</span><span class="p">:</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge</span>
<span class="w">  </span><span class="nt">private</span><span class="p">:</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge</span>
<span class="w">    </span><span class="nt">internal</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># No external access</span>
</code></pre></div>

<h3 id="tls">TLS ì•”í˜¸í™”<a class="header-link" href="#tls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">nginx</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:443&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./nginx.conf:/etc/nginx/nginx.conf:ro</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./certs:/etc/nginx/certs:ro</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">frontend</span>

<span class="w">  </span><span class="nt">app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TLS_CERT=/certs/server.crt</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TLS_KEY=/certs/server.key</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./certs:/certs:ro</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">frontend</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># nginx.conf</span>
<span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="w"> </span><span class="s">http2</span><span class="p">;</span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># TLS configuration</span>
<span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/nginx/certs/server.crt</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/nginx/certs/server.key</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_protocols</span><span class="w"> </span><span class="s">TLSv1.2</span><span class="w"> </span><span class="s">TLSv1.3</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_ciphers</span><span class="w"> </span><span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_prefer_server_ciphers</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Security headers</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Strict-Transport-Security</span><span class="w"> </span><span class="s">&quot;max-age=31536000</span><span class="p">;</span><span class="w"> </span><span class="kn">includeSubDomains&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Frame-Options</span><span class="w"> </span><span class="s">&quot;SAMEORIGIN&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Content-Type-Options</span><span class="w"> </span><span class="s">&quot;nosniff&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-XSS-Protection</span><span class="w"> </span><span class="s">&quot;1</span><span class="p">;</span><span class="w"> </span><span class="kn">mode=block&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://app:8080</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="egress">Egress ì œì–´<a class="header-link" href="#egress" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Block all egress except specific destinations</span>
docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--internal<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>isolated-net

docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>proxy<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--network<span class="w"> </span>isolated-net<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>squid

<span class="c1"># Configure Squid to allow only specific domains</span>
<span class="c1"># /etc/squid/squid.conf</span>
<span class="c1"># acl allowed_sites dstdomain .example.com .api.trusted.com</span>
<span class="c1"># http_access allow allowed_sites</span>
<span class="c1"># http_access deny all</span>
</code></pre></div>

<h3 id="kubernetes">Kubernetes ë„¤íŠ¸ì›Œí¬ ì •ì±…<a class="header-link" href="#kubernetes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># network-policy.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deny-all-ingress</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">podSelector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">  </span><span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow-frontend-to-backend</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">  </span><span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">from</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">frontend</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow-backend-to-db</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">  </span><span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
<span class="w">  </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">database</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432</span>
<span class="w">  </span><span class="c1"># Allow DNS</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">namespaceSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kube-system</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UDP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53</span>
</code></pre></div>

<hr />
<h2 id="7">7. ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë³´ì•ˆ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="docker-content-trust">Docker Content Trustë¥¼ ì‚¬ìš©í•œ ì´ë¯¸ì§€ ì„œëª…<a class="header-link" href="#docker-content-trust" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Enable Docker Content Trust</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DOCKER_CONTENT_TRUST</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Generate root and repository keys</span>
docker<span class="w"> </span>trust<span class="w"> </span>key<span class="w"> </span>generate<span class="w"> </span>mykey

<span class="c1"># Add signer to repository</span>
docker<span class="w"> </span>trust<span class="w"> </span>signer<span class="w"> </span>add<span class="w"> </span>--key<span class="w"> </span>mykey.pub<span class="w"> </span>myuser<span class="w"> </span>myrepo/myimage

<span class="c1"># Push signed image</span>
docker<span class="w"> </span>push<span class="w"> </span>myrepo/myimage:v1.0
<span class="c1"># Signing and pushing trust metadata...</span>

<span class="c1"># Pull signed image (verification automatic with DCT enabled)</span>
docker<span class="w"> </span>pull<span class="w"> </span>myrepo/myimage:v1.0
<span class="c1"># Pull (1 of 1): myrepo/myimage:v1.0@sha256:abc...</span>
<span class="c1"># Tagging myrepo/myimage:v1.0@sha256:abc... as myrepo/myimage:v1.0</span>
</code></pre></div>

<h3 id="notary">ì´ë¯¸ì§€ ì„œëª…ì„ ìœ„í•œ Notary<a class="header-link" href="#notary" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Install Notary</span>
go<span class="w"> </span>install<span class="w"> </span>github.com/notaryproject/notation/cmd/notation@latest

<span class="c1"># Initialize repository</span>
notary<span class="w"> </span>init<span class="w"> </span>myrepo/myimage

<span class="c1"># Sign image</span>
notary<span class="w"> </span>addhash<span class="w"> </span>myrepo/myimage<span class="w"> </span>v1.0<span class="w"> </span>sha256:abc123...

<span class="c1"># List trusted tags</span>
notary<span class="w"> </span>list<span class="w"> </span>myrepo/myimage

<span class="c1"># Verify signature</span>
notary<span class="w"> </span>verify<span class="w"> </span>myrepo/myimage<span class="w"> </span>v1.0
</code></pre></div>

<h3 id="_12">ì¸ì¦ì„ ì‚¬ìš©í•œ í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">registry</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry:2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5000:5000&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">REGISTRY_AUTH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">htpasswd</span>
<span class="w">      </span><span class="nt">REGISTRY_AUTH_HTPASSWD_PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/auth/htpasswd</span>
<span class="w">      </span><span class="nt">REGISTRY_AUTH_HTPASSWD_REALM</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Registry Realm</span>
<span class="w">      </span><span class="nt">REGISTRY_HTTP_TLS_CERTIFICATE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/certs/domain.crt</span>
<span class="w">      </span><span class="nt">REGISTRY_HTTP_TLS_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/certs/domain.key</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./auth:/auth</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./certs:/certs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry-data:/var/lib/registry</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">registry-data</span><span class="p">:</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Create htpasswd file</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>--entrypoint<span class="w"> </span>htpasswd<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>httpd:2<span class="w"> </span>-Bbn<span class="w"> </span>myuser<span class="w"> </span>mypassword<span class="w"> </span>&gt;<span class="w"> </span>auth/htpasswd

<span class="c1"># Login to private registry</span>
docker<span class="w"> </span>login<span class="w"> </span>localhost:5000
<span class="c1"># Username: myuser</span>
<span class="c1"># Password: mypassword</span>

<span class="c1"># Tag and push image</span>
docker<span class="w"> </span>tag<span class="w"> </span>myapp:latest<span class="w"> </span>localhost:5000/myapp:latest
docker<span class="w"> </span>push<span class="w"> </span>localhost:5000/myapp:latest
</code></pre></div>

<h3 id="harbor">Harbor ë ˆì§€ìŠ¤íŠ¸ë¦¬<a class="header-link" href="#harbor" title="Permanent link">&para;</a></h3>
<p>HarborëŠ” ë³´ì•ˆ ê¸°ëŠ¥ì´ ìˆëŠ” ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml (simplified Harbor setup)</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">harbor-core</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">goharbor/harbor-core:v2.9.0</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CORE_SECRET=not-a-secure-secret</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">JOBSERVICE_SECRET=not-a-secure-secret</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">harbor-db</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>

<span class="w">  </span><span class="nt">harbor-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">goharbor/harbor-db:v2.9.0</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSTGRES_PASSWORD=root123</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">goharbor/redis-photon:v2.9.0</span>

<span class="w">  </span><span class="nt">harbor-portal</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">goharbor/harbor-portal:v2.9.0</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080&quot;</span>
</code></pre></div>

<p><strong>Harbor ê¸°ëŠ¥</strong>:
- ì·¨ì•½ì  ìŠ¤ìºë‹ (Trivy, Clair)
- ì´ë¯¸ì§€ ì„œëª… (Notary)
- RBAC ë° ë©€í‹° í…Œë„Œì‹œ
- ë ˆì§€ìŠ¤íŠ¸ë¦¬ ê°„ ë³µì œ
- ê°ì‚¬ ë¡œê¹…
- ì¿¼í„° ê´€ë¦¬</p>
<hr />
<h2 id="8-kubernetes">8. Kubernetes ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸<a class="header-link" href="#8-kubernetes" title="Permanent link">&para;</a></h2>
<h3 id="pod">Pod ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸<a class="header-link" href="#pod" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># secure-pod.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-pod</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Pod-level security context</span>
<span class="w">    </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">    </span><span class="nt">runAsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">    </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">    </span><span class="nt">seccompProfile</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RuntimeDefault</span>

<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">    </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Container-level security context (overrides pod-level)</span>
<span class="w">      </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">readOnlyRootFilesystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">      </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">        </span><span class="nt">drop</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ALL</span>
<span class="w">        </span><span class="nt">add</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span>

<span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tmp</span>
<span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cache</span>
<span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/app/cache</span>

<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tmp</span>
<span class="w">    </span><span class="nt">emptyDir</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cache</span>
<span class="w">    </span><span class="nt">emptyDir</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>

<h3 id="pod-pod-security-standards">Pod ë³´ì•ˆ í‘œì¤€(Pod Security Standards)<a class="header-link" href="#pod-pod-security-standards" title="Permanent link">&para;</a></h3>
<p>KubernetesëŠ” ì„¸ ê°€ì§€ ë³´ì•ˆ ìˆ˜ì¤€ì„ ì •ì˜í•©ë‹ˆë‹¤:</p>
<ol>
<li><strong>Privileged</strong>: ì œí•œ ì—†ìŒ (ê¶Œì¥í•˜ì§€ ì•ŠìŒ)</li>
<li><strong>Baseline</strong>: ìµœì†Œí•œì˜ ì œí•œ</li>
<li><strong>Restricted</strong>: ì—„ê²©í•œ ì œí•œ (ëª¨ë²” ì‚¬ë¡€)</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># namespace.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Namespace</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pod-security.kubernetes.io/enforce</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restricted</span>
<span class="w">    </span><span class="nt">pod-security.kubernetes.io/audit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restricted</span>
<span class="w">    </span><span class="nt">pod-security.kubernetes.io/warn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restricted</span>
</code></pre></div>

<h3 id="pod_1">ì œí•œëœ Pod ì˜ˆì œ<a class="header-link" href="#pod_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># restricted-deployment.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-app</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-app</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-app</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">        </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">        </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">        </span><span class="nt">seccompProfile</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RuntimeDefault</span>

<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">        </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">          </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">          </span><span class="nt">readOnlyRootFilesystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">          </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">            </span><span class="nt">drop</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ALL</span>

<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;512Mi&quot;</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100m&quot;</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;128Mi&quot;</span>

<span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tmp</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp</span>

<span class="w">        </span><span class="nt">livenessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="w">        </span><span class="nt">readinessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/ready</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>

<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tmp</span>
<span class="w">        </span><span class="nt">emptyDir</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sizeLimit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100Mi</span>
</code></pre></div>

<h3 id="pod-rbac">Podë¥¼ ìœ„í•œ RBAC<a class="header-link" href="#pod-rbac" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># service-account.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ServiceAccount</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-sa</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>

<span class="nn">---</span>
<span class="c1"># role.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-role</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;configmaps&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;secrets&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;list&quot;</span><span class="p p-Indicator">]</span>

<span class="nn">---</span>
<span class="c1"># role-binding.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RoleBinding</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-rolebinding</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">subjects</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ServiceAccount</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-sa</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">roleRef</span><span class="p">:</span>
<span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Role</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-role</span>
<span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>

<span class="nn">---</span>
<span class="c1"># deployment.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp-sa</span>
<span class="w">      </span><span class="nt">automountServiceAccountToken</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">  </span><span class="c1"># Disable if not needed</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
</code></pre></div>

<hr />
<h2 id="9">9. ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="falco">ëŸ°íƒ€ì„ ì´ìƒ íƒì§€ë¥¼ ìœ„í•œ Falco<a class="header-link" href="#falco" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># falco-daemonset.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DaemonSet</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">falco</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">falco</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">falco</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">falco</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">falco</span>
<span class="w">      </span><span class="nt">hostNetwork</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">hostPID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">falco</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">falcosecurity/falco:0.36.0</span>
<span class="w">        </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">          </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker-socket</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/host/dev</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proc</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/host/proc</span>
<span class="w">          </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">boot</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/host/boot</span>
<span class="w">          </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lib-modules</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/host/lib/modules</span>
<span class="w">          </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">usr</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/host/usr</span>
<span class="w">          </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">etc</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/host/etc</span>
<span class="w">          </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker-socket</span>
<span class="w">        </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev</span>
<span class="w">        </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">proc</span>
<span class="w">        </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/proc</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">boot</span>
<span class="w">        </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/boot</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lib-modules</span>
<span class="w">        </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/lib/modules</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">usr</span>
<span class="w">        </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">etc</span>
<span class="w">        </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc</span>
</code></pre></div>

<p><strong>Falco ê·œì¹™</strong> (<code>/etc/falco/falco_rules.yaml</code>):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Detect shell in container</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Terminal shell in container</span>
<span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A shell was spawned in a container</span>
<span class="w">  </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">spawned_process and</span>
<span class="w">    </span><span class="no">container and</span>
<span class="w">    </span><span class="no">shell_procs and</span>
<span class="w">    </span><span class="no">proc.tty != 0</span>
<span class="w">  </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">Shell spawned in container</span>
<span class="w">    </span><span class="no">(user=%user.name container=%container.name</span>
<span class="w">    </span><span class="no">shell=%proc.name parent=%proc.pname</span>
<span class="w">    </span><span class="no">cmdline=%proc.cmdline)</span>
<span class="w">  </span><span class="nt">priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WARNING</span>

<span class="c1"># Detect file modification in /etc</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Write to /etc directory</span>
<span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File was written to /etc directory</span>
<span class="w">  </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">evt.type in (write, open) and</span>
<span class="w">    </span><span class="no">evt.dir = &lt; and</span>
<span class="w">    </span><span class="no">fd.name startswith /etc</span>
<span class="w">  </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">File written in /etc</span>
<span class="w">    </span><span class="no">(user=%user.name file=%fd.name</span>
<span class="w">    </span><span class="no">command=%proc.cmdline container=%container.name)</span>
<span class="w">  </span><span class="nt">priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ERROR</span>

<span class="c1"># Detect privilege escalation</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set Setuid or Setgid bit</span>
<span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">An attempt to set setuid or setgid bit</span>
<span class="w">  </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">evt.type = chmod or evt.type = fchmod and</span>
<span class="w">    </span><span class="no">((evt.arg.mode contains S_ISUID) or</span>
<span class="w">     </span><span class="no">(evt.arg.mode contains S_ISGID))</span>
<span class="w">  </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">Setuid or setgid bit set</span>
<span class="w">    </span><span class="no">(user=%user.name file=%evt.arg.filename</span>
<span class="w">    </span><span class="no">mode=%evt.arg.mode container=%container.name)</span>
<span class="w">  </span><span class="nt">priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRITICAL</span>
</code></pre></div>

<h3 id="docker-bench-security">Docker Bench Security<a class="header-link" href="#docker-bench-security" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Run Docker Bench Security</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--net<span class="w"> </span>host<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--pid<span class="w"> </span>host<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--userns<span class="w"> </span>host<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cap-add<span class="w"> </span>audit_control<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">DOCKER_CONTENT_TRUST</span><span class="o">=</span><span class="nv">$DOCKER_CONTENT_TRUST</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/etc:/etc:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/usr/bin/containerd:/usr/bin/containerd:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/usr/bin/runc:/usr/bin/runc:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/usr/lib/systemd:/usr/lib/systemd:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/var/lib:/var/lib:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/var/run/docker.sock:/var/run/docker.sock:ro<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--label<span class="w"> </span>docker_bench_security<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>docker/docker-bench-security

<span class="c1"># Output:</span>
<span class="c1"># [INFO] 1 - Host Configuration</span>
<span class="c1"># [PASS] 1.1.1 - Ensure a separate partition for containers...</span>
<span class="c1"># [WARN] 1.1.2 - Ensure only trusted users are allowed...</span>
<span class="c1"># ...</span>
<span class="c1"># [INFO] 4 - Container Images and Build File</span>
<span class="c1"># [WARN] 4.1 - Ensure a user for the container has been created</span>
<span class="c1"># [PASS] 4.5 - Ensure Content trust for Docker is Enabled</span>
</code></pre></div>

<h3 id="_13">ê°ì‚¬ ë¡œê¹…<a class="header-link" href="#_13" title="Permanent link">&para;</a></h3>
<h4 id="docker-daemon">Docker Daemon ê°ì‚¬<a class="header-link" href="#docker-daemon" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// /etc/docker/daemon.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;log-driver&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;json-file&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;log-opts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;max-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10m&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;max-file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;audit-log-enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;audit-log-path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/var/log/docker-audit.log&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;audit-log-max-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;100m&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;audit-log-max-backups&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="kubernetes_1">Kubernetes ê°ì‚¬ ì •ì±…<a class="header-link" href="#kubernetes_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># audit-policy.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audit.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="c1"># Log pod changes at RequestResponse level</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequestResponse</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">    </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>

<span class="c1"># Log secret access at Metadata level</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Metadata</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">    </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;secrets&quot;</span><span class="p p-Indicator">]</span>

<span class="c1"># Don&#39;t log read-only requests</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span>
<span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;watch&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>

<h3 id="prometheus">Prometheusë¥¼ ì‚¬ìš©í•œ ëª¨ë‹ˆí„°ë§<a class="header-link" href="#prometheus" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># prometheus-config.yaml</span>
<span class="nt">global</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scrape_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15s</span>

<span class="nt">scrape_configs</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">job_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;docker&#39;</span>
<span class="w">    </span><span class="nt">static_configs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;localhost:9323&#39;</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">job_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;cadvisor&#39;</span>
<span class="w">    </span><span class="nt">static_configs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;cadvisor:8080&#39;</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">job_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;node-exporter&#39;</span>
<span class="w">    </span><span class="nt">static_configs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;node-exporter:9100&#39;</span><span class="p p-Indicator">]</span>

<span class="c1"># Alerting rules</span>
<span class="nt">rule_files</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;/etc/prometheus/alerts.yml&#39;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># alerts.yml</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_security</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ContainerRunningAsRoot</span>
<span class="w">    </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">container_running_as_root == 1</span>
<span class="w">    </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">warning</span>
<span class="w">    </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">      </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Container</span><span class="nv"> </span><span class="s">running</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">root</span><span class="nv"> </span><span class="s">user&quot;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HighCPUUsage</span>
<span class="w">    </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rate(container_cpu_usage_seconds_total[5m]) &gt; 0.8</span>
<span class="w">    </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10m</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">warning</span>
<span class="w">    </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">      </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Container</span><span class="nv"> </span><span class="s">CPU</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">80%&quot;</span>
</code></pre></div>

<hr />
<h2 id="10">10. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="1-dockerfile">ì—°ìŠµ 1: ì•ˆì „í•œ Dockerfile<a class="header-link" href="#1-dockerfile" title="Permanent link">&para;</a></h3>
<p>ì•ˆì „í•˜ì§€ ì•Šì€ Dockerfileì„ ì•ˆì „í•œ ê²ƒìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
<p><strong>ì•ˆì „í•˜ì§€ ì•Šì€ Dockerfile</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu:latest</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3<span class="w"> </span>python3-pip
<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/app
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
<span class="k">ENV</span><span class="w"> </span><span class="nv">SECRET_KEY</span><span class="o">=</span>mysecretkey123
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.py&quot;</span><span class="p">]</span>
</code></pre></div>

<p><strong>ì‘ì—…</strong>:
1. ìµœì†Œ ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì‚¬ìš©
2. ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ êµ¬í˜„
3. Non-root ì‚¬ìš©ìë¡œ ì‹¤í–‰
4. í•˜ë“œì½”ë”©ëœ ì‹œí¬ë¦¿ ì œê±°
5. ë³´ì•ˆ ìŠ¤ìºë‹ ì¶”ê°€
6. ì½ê¸° ì „ìš© íŒŒì¼ì‹œìŠ¤í…œ êµ¬í˜„</p>
<h3 id="2_1">ì—°ìŠµ 2: ëŸ°íƒ€ì„ ë³´ì•ˆ êµ¬ì„±<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>ì•ˆì „í•œ Docker Compose êµ¬ì„±ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># TODO: Harden this configuration</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">web</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:latest</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>

<span class="w">  </span><span class="nt">app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DB_PASSWORD=password123</span>

<span class="w">  </span><span class="nt">db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres:latest</span>
</code></pre></div>

<p><strong>ì‘ì—…</strong>:
1. Capability ì œê±° ì¶”ê°€
2. ì½ê¸° ì „ìš© íŒŒì¼ì‹œìŠ¤í…œ êµ¬í˜„
3. ì ì ˆí•œ ì‚¬ìš©ì êµ¬ì„±
4. í™˜ê²½ ë³€ìˆ˜ ì‹œí¬ë¦¿ ì œê±°
5. ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ ì¶”ê°€
6. ë¦¬ì†ŒìŠ¤ ì œí•œ êµ¬í˜„</p>
<h3 id="3-kubernetes">ì—°ìŠµ 3: Kubernetes ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸<a class="header-link" href="#3-kubernetes" title="Permanent link">&para;</a></h3>
<p>ì œí•œëœ Pod ë³´ì•ˆ í‘œì¤€ìœ¼ë¡œ ë°°í¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># TODO: Add security context</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
</code></pre></div>

<p><strong>ì‘ì—…</strong>:
1. Pod ë ˆë²¨ ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ ì¶”ê°€
2. ì»¨í…Œì´ë„ˆ ë ˆë²¨ ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ ì¶”ê°€
3. ëª¨ë“  capabilities ì œê±°
4. ì½ê¸° ì „ìš© ë£¨íŠ¸ íŒŒì¼ì‹œìŠ¤í…œ êµ¬í˜„
5. ë¦¬ì†ŒìŠ¤ ì œí•œ ì¶”ê°€
6. ì ì ˆí•œ í”„ë¡œë¸Œ êµ¬ì„±</p>
<h3 id="4_1">ì—°ìŠµ 4: ì´ë¯¸ì§€ ìŠ¤ìºë‹ íŒŒì´í”„ë¼ì¸<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<p>ì·¨ì•½ì ì„ ìœ„í•´ ì´ë¯¸ì§€ë¥¼ ìŠ¤ìº”í•˜ëŠ” CI/CD íŒŒì´í”„ë¼ì¸ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p><strong>GitHub Actions ì›Œí¬í”Œë¡œìš°</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># TODO: Complete this workflow</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Scan</span>

<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scan</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build image</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker build -t myapp:${{ github.sha }} .</span>

<span class="w">      </span><span class="c1"># TODO: Add Trivy scanning</span>
<span class="w">      </span><span class="c1"># TODO: Fail on CRITICAL vulnerabilities</span>
<span class="w">      </span><span class="c1"># TODO: Upload results to GitHub Security</span>
</code></pre></div>

<h3 id="5_1">ì—°ìŠµ 5: ì‹œí¬ë¦¿ ê´€ë¦¬<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ì ì ˆí•œ ì‹œí¬ë¦¿ ê´€ë¦¬ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.</p>
<p><strong>ì‹œë‚˜ë¦¬ì˜¤</strong>: ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í•„ìš”í•œ ê²ƒ:
- ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸
- ì™¸ë¶€ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ API í‚¤
- TLS ì¸ì¦ì„œ</p>
<p><strong>ì‘ì—…</strong>:
1. Docker Swarm secrets êµ¬í˜„
2. íŒŒì¼ì—ì„œ ì‹œí¬ë¦¿ì„ ì½ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ìƒì„±
3. ì ì ˆí•œ íŒŒì¼ ê¶Œí•œ êµ¬ì„±
4. ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜ ì „ëµ êµ¬í˜„
5. ì‹œí¬ë¦¿ ë¼ì´í”„ì‚¬ì´í´ ë¬¸ì„œí™”</p>
<h3 id="6_1">ì—°ìŠµ 6: ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ<a class="header-link" href="#6_1" title="Permanent link">&para;</a></h3>
<p>3ê³„ì¸µ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># TODO: Add network security</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">frontend</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:443&quot;</span>

<span class="w">  </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api:latest</span>

<span class="w">  </span><span class="nt">database</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>

<span class="w">  </span><span class="nt">cache</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
</code></pre></div>

<p><strong>ì‘ì—…</strong>:
1. ê²©ë¦¬ëœ ë„¤íŠ¸ì›Œí¬ ìƒì„±
2. í”„ë¡ íŠ¸ì—”ë“œê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ì—†ë„ë¡ ë³´ì¥
3. ë°±ì—”ë“œ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ êµ¬í˜„
4. ëª¨ë“  í†µì‹ ì— TLS êµ¬ì„±
5. ë„¤íŠ¸ì›Œí¬ ì •ì±… ì¶”ê°€ (Kubernetes ì‚¬ìš© ì‹œ)</p>
<hr />
<h2 id="_14">ìš”ì•½<a class="header-link" href="#_14" title="Permanent link">&para;</a></h2>
<p>ì´ ë ˆìŠ¨ì—ì„œ ë°°ìš´ ë‚´ìš©:</p>
<ul>
<li>ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ìœ„í˜‘ ëª¨ë¸ê³¼ ì‹¬ì¸µ ë°©ì–´ ì „ëµ</li>
<li>ì´ë¯¸ì§€ ë³´ì•ˆ: ìµœì†Œ ë² ì´ìŠ¤ ì´ë¯¸ì§€, ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ, ì·¨ì•½ì  ìŠ¤ìºë‹</li>
<li>Dockerfile ëª¨ë²” ì‚¬ë¡€: non-root ì‚¬ìš©ì, ì‹œí¬ë¦¿ ì²˜ë¦¬, ë ˆì´ì–´ ìµœì í™”</li>
<li>ëŸ°íƒ€ì„ ë³´ì•ˆ: capabilities, seccomp, AppArmor, ì½ê¸° ì „ìš© íŒŒì¼ì‹œìŠ¤í…œ</li>
<li>ì‹œí¬ë¦¿ ê´€ë¦¬: Docker secrets, ì™¸ë¶€ vault, Kubernetes secrets</li>
<li>ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ: ê²©ë¦¬, TLS, egress ì œì–´, ë„¤íŠ¸ì›Œí¬ ì •ì±…</li>
<li>ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë³´ì•ˆ: ì´ë¯¸ì§€ ì„œëª…, ì½˜í…ì¸  ì‹ ë¢°, í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬</li>
<li>Kubernetes ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸: Pod ë³´ì•ˆ í‘œì¤€, RBAC, ì œí•œëœ pods</li>
<li>ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬: Falco, Docker Bench, ê°ì‚¬ ë¡œê¹…, Prometheus</li>
</ul>
<p><strong>í•µì‹¬ ìš”ì </strong>:
- ë³´ì•ˆì€ ì¼íšŒì„± êµ¬ì„±ì´ ì•„ë‹Œ ì§€ì†ì ì¸ í”„ë¡œì„¸ìŠ¤ì…ë‹ˆë‹¤
- ì‹¬ì¸µ ë°©ì–´ ì ìš©: ì—¬ëŸ¬ ê³„ì¸µì˜ ë³´ì•ˆ ì œì–´
- ì‹œí”„íŠ¸ ë ˆí”„íŠ¸: ê°œë°œ ë¼ì´í”„ì‚¬ì´í´ ì´ˆê¸°ì— ë³´ì•ˆ í†µí•©
- ìµœì†Œ ê¶Œí•œ: í•„ìš”í•œ ìµœì†Œ ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰
- ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬: ë³´ì•ˆ ì‚¬ê³  íƒì§€ ë° ëŒ€ì‘
- CI/CD íŒŒì´í”„ë¼ì¸ì—ì„œ ë³´ì•ˆ ìŠ¤ìºë‹ ìë™í™”</p>
<p><strong>í”„ë¡œë•ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸</strong>:
- [ ] ìµœì†Œ ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì‚¬ìš© (Alpine, distroless)
- [ ] ì·¨ì•½ì ì„ ìœ„í•´ ì´ë¯¸ì§€ ìŠ¤ìº” (Trivy, Snyk)
- [ ] ì»¨í…Œì´ë„ˆë¥¼ non-root ì‚¬ìš©ìë¡œ ì‹¤í–‰
- [ ] ë¶ˆí•„ìš”í•œ capabilities ì œê±°
- [ ] ì½ê¸° ì „ìš© íŒŒì¼ì‹œìŠ¤í…œ êµ¬í˜„
- [ ] ì‹œí¬ë¦¿ ê´€ë¦¬ ì‚¬ìš© (Vault, Docker secrets)
- [ ] ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ ë° ì•”í˜¸í™” í™œì„±í™”
- [ ] ì´ë¯¸ì§€ ì„œëª… ë° ê²€ì¦ (Content Trust)
- [ ] Pod ë³´ì•ˆ í‘œì¤€ ì ìš© (Kubernetes)
- [ ] ëŸ°íƒ€ì„ ë™ì‘ ëª¨ë‹ˆí„°ë§ (Falco)
- [ ] ê°ì‚¬ ë¡œê¹… êµ¬í˜„
- [ ] ì •ê¸°ì ì¸ ë³´ì•ˆ ê²€í†  ë° ì—…ë°ì´íŠ¸</p>
<p><strong>ì¶”ê°€ ì½ê¸° ìë£Œ</strong>:
- <a href="https://www.cisecurity.org/benchmark/docker">CIS Docker Benchmark</a>
- <a href="https://www.cisecurity.org/benchmark/kubernetes">CIS Kubernetes Benchmark</a>
- <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf">NIST Application Container Security Guide</a>
- <a href="https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html">OWASP Docker Security Cheat Sheet</a></p>
<hr />
<p><a href="./11_Container_Networking.md">ì´ì „: 11_Container_Networking</a> | <a href="./00_Overview.md">ë‹¤ìŒ: 00_Overview</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Docker/11_Container_Networking.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí‚¹(Container Networking)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Docker/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}