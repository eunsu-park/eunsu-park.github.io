{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14. Linux ì„±ëŠ¥ íŠœë‹ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Linux/">Linux</a>
    <span class="separator">/</span>
    <span class="current">14. Linux ì„±ëŠ¥ íŠœë‹</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>14. Linux ì„±ëŠ¥ íŠœë‹</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Linux/13_Systemd_Advanced.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. systemd ì‹¬í™”</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Linux/15_Container_Internals.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ êµ¬ì¡°</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1">1. ì„±ëŠ¥ ë¶„ì„ ê¸°ì´ˆ</a><ul>
<li><a href="#11-use">1.1 USE ë°©ë²•ë¡ </a></li>
<li><a href="#12">1.2 ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ ë„êµ¬</a></li>
<li><a href="#13-sysctl">1.3 sysctl ê¸°ë³¸</a></li>
</ul>
</li>
<li><a href="#2-cpu">2. CPU íŠœë‹</a><ul>
<li><a href="#21-cpu">2.1 CPU ì •ë³´ í™•ì¸</a></li>
<li><a href="#22-cpu-governor">2.2 CPU Governor</a></li>
<li><a href="#23">2.3 í”„ë¡œì„¸ìŠ¤ ìš°ì„ ìˆœìœ„</a></li>
<li><a href="#24-cpu-sysctl">2.4 CPU ê´€ë ¨ sysctl</a></li>
</ul>
</li>
<li><a href="#3">3. ë©”ëª¨ë¦¬ íŠœë‹</a><ul>
<li><a href="#31">3.1 ë©”ëª¨ë¦¬ ì •ë³´ í™•ì¸</a></li>
<li><a href="#32-swap">3.2 Swap íŠœë‹</a></li>
<li><a href="#33-sysctl">3.3 ë©”ëª¨ë¦¬ ê´€ë ¨ sysctl</a></li>
<li><a href="#34">3.4 ìºì‹œ ê´€ë¦¬</a></li>
</ul>
</li>
<li><a href="#4-io">4. I/O íŠœë‹</a><ul>
<li><a href="#41-io">4.1 I/O ìŠ¤ì¼€ì¤„ëŸ¬</a></li>
<li><a href="#42-io">4.2 ë””ìŠ¤í¬ I/O íŠœë‹</a></li>
<li><a href="#43">4.3 íŒŒì¼ì‹œìŠ¤í…œ íŠœë‹</a></li>
<li><a href="#44-io">4.4 I/O ìš°ì„ ìˆœìœ„</a></li>
</ul>
</li>
<li><a href="#5">5. ë„¤íŠ¸ì›Œí¬ íŠœë‹</a><ul>
<li><a href="#51">5.1 ë„¤íŠ¸ì›Œí¬ ì •ë³´ í™•ì¸</a></li>
<li><a href="#52-tcp">5.2 TCP íŠœë‹</a></li>
<li><a href="#53">5.3 ê³ ì„±ëŠ¥ ì›¹ ì„œë²„ ì„¤ì •</a></li>
<li><a href="#54">5.4 ì—°ê²° ì œí•œ</a></li>
</ul>
</li>
<li><a href="#6">6. í”„ë¡œíŒŒì¼ë§ ë„êµ¬</a><ul>
<li><a href="#61-perf">6.1 perf ê¸°ë³¸</a></li>
<li><a href="#62-flamegraph">6.2 Flamegraph</a></li>
<li><a href="#63-straceltrace">6.3 strace/ltrace</a></li>
<li><a href="#64">6.4 ê¸°íƒ€ ë„êµ¬</a></li>
<li><a href="#65">6.5 ì„±ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸</a></li>
</ul>
</li>
<li><a href="#7">7. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1_1">ì—°ìŠµ 1: ì›¹ ì„œë²„ íŠœë‹</a></li>
<li><a href="#2">ì—°ìŠµ 2: ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ íŠœë‹</a></li>
<li><a href="#3_1">ì—°ìŠµ 3: ì„±ëŠ¥ ë¬¸ì œ ì§„ë‹¨</a></li>
<li><a href="#4-flamegraph">ì—°ìŠµ 4: Flamegraph ë¶„ì„</a></li>
</ul>
</li>
<li><a href="#_3">ë‹¤ìŒ ë‹¨ê³„</a></li>
<li><a href="#_4">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="14-linux">14. Linux ì„±ëŠ¥ íŠœë‹<a class="header-link" href="#14-linux" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ì‹œìŠ¤í…œ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ë¶„ì„</li>
<li>sysctlì„ í†µí•œ ì»¤ë„ íŒŒë¼ë¯¸í„° ìµœì í™”</li>
<li>CPU, ë©”ëª¨ë¦¬, I/O ì„±ëŠ¥ íŠœë‹</li>
<li>perfì™€ flamegraphë¥¼ í™œìš©í•œ í”„ë¡œíŒŒì¼ë§</li>
</ul>
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ì„±ëŠ¥-ë¶„ì„-ê¸°ì´ˆ">ì„±ëŠ¥ ë¶„ì„ ê¸°ì´ˆ</a></li>
<li><a href="#2-cpu-íŠœë‹">CPU íŠœë‹</a></li>
<li><a href="#3-ë©”ëª¨ë¦¬-íŠœë‹">ë©”ëª¨ë¦¬ íŠœë‹</a></li>
<li><a href="#4-io-íŠœë‹">I/O íŠœë‹</a></li>
<li><a href="#5-ë„¤íŠ¸ì›Œí¬-íŠœë‹">ë„¤íŠ¸ì›Œí¬ íŠœë‹</a></li>
<li><a href="#6-í”„ë¡œíŒŒì¼ë§-ë„êµ¬">í”„ë¡œíŒŒì¼ë§ ë„êµ¬</a></li>
<li><a href="#7-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<hr />
<h2 id="1">1. ì„±ëŠ¥ ë¶„ì„ ê¸°ì´ˆ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11-use">1.1 USE ë°©ë²•ë¡ <a class="header-link" href="#11-use" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                </span><span class="n">USE</span><span class="w"> </span><span class="err">ë°©ë²•ë¡ </span><span class="w"> </span><span class="p">(</span><span class="n">Brendan</span><span class="w"> </span><span class="n">Gregg</span><span class="p">)</span><span class="w">                    </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ê°</span><span class="w"> </span><span class="err">ë¦¬ì†ŒìŠ¤ì—</span><span class="w"> </span><span class="err">ëŒ€í•´</span><span class="w"> </span><span class="err">í™•ì¸</span><span class="o">:</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">U</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Utilization</span><span class="w"> </span><span class="p">(</span><span class="err">ì‚¬ìš©ë¥ </span><span class="p">)</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">ë¦¬ì†ŒìŠ¤ê°€</span><span class="w"> </span><span class="err">ì–¼ë§ˆë‚˜</span><span class="w"> </span><span class="err">ì‚¬ìš©ë˜ê³ </span><span class="w"> </span><span class="err">ìˆëŠ”ê°€</span><span class="o">?</span><span class="w">                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">ì˜ˆ</span><span class="o">:</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="mh">80</span><span class="o">%</span><span class="w"> </span><span class="err">ì‚¬ìš©</span><span class="w"> </span><span class="err">ì¤‘</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">S</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Saturation</span><span class="w"> </span><span class="p">(</span><span class="err">í¬í™”ë„</span><span class="p">)</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">ì‘ì—…ì´</span><span class="w"> </span><span class="err">ëŒ€ê¸°</span><span class="w"> </span><span class="err">ì¤‘ì¸ê°€</span><span class="o">?</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">ì˜ˆ</span><span class="o">:</span><span class="w"> </span><span class="err">ì‹¤í–‰</span><span class="w"> </span><span class="err">ëŒ€ê¸°ì—´ì—</span><span class="w"> </span><span class="mh">10</span><span class="err">ê°œ</span><span class="w"> </span><span class="err">í”„ë¡œì„¸ìŠ¤</span><span class="w">                        </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">E</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Errors</span><span class="w"> </span><span class="p">(</span><span class="err">ì—ëŸ¬</span><span class="p">)</span><span class="w">                                          </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">ì—ëŸ¬ê°€</span><span class="w"> </span><span class="err">ë°œìƒí•˜ëŠ”ê°€</span><span class="o">?</span><span class="w">                                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">      </span><span class="err">ì˜ˆ</span><span class="o">:</span><span class="w"> </span><span class="err">ë„¤íŠ¸ì›Œí¬</span><span class="w"> </span><span class="err">íŒ¨í‚·</span><span class="w"> </span><span class="err">ë“œë¡­</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ì£¼ìš”</span><span class="w"> </span><span class="err">ë¦¬ì†ŒìŠ¤</span><span class="o">:</span><span class="w">                                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â€¢</span><span class="w"> </span><span class="nl">CPU:</span><span class="w"> </span><span class="n">mpstat</span><span class="p">,</span><span class="w"> </span><span class="n">vmstat</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="w">                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â€¢</span><span class="w"> </span><span class="nl">Memory:</span><span class="w"> </span><span class="n">free</span><span class="p">,</span><span class="w"> </span><span class="n">vmstat</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">meminfo</span><span class="w">                     </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â€¢</span><span class="w"> </span><span class="n">Disk</span><span class="w"> </span><span class="n">I</span><span class="o">/</span><span class="nl">O:</span><span class="w"> </span><span class="n">iostat</span><span class="p">,</span><span class="w"> </span><span class="n">iotop</span><span class="w">                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â€¢</span><span class="w"> </span><span class="nl">Network:</span><span class="w"> </span><span class="n">netstat</span><span class="p">,</span><span class="w"> </span><span class="n">ss</span><span class="p">,</span><span class="w"> </span><span class="n">sar</span><span class="w">                               </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="12">1.2 ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ ë„êµ¬<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># top - ì‹¤ì‹œê°„ í”„ë¡œì„¸ìŠ¤ ëª¨ë‹ˆí„°ë§</span>
top
<span class="c1"># ë‹¨ì¶•í‚¤: 1=CPUë³„, M=ë©”ëª¨ë¦¬ìˆœ, P=CPUìˆœ, k=kill</span>

<span class="c1"># htop - í–¥ìƒëœ top</span>
htop

<span class="c1"># vmstat - ê°€ìƒ ë©”ëª¨ë¦¬ í†µê³„</span>
vmstat<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w">  </span><span class="c1"># 1ì´ˆ ê°„ê²©, 5íšŒ</span>
<span class="c1">#  r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span>
<span class="c1">#  2  0      0 1234567 12345 234567    0    0     1     2  100  200  5  2 93  0  0</span>
<span class="c1"># r: ì‹¤í–‰ ëŒ€ê¸° í”„ë¡œì„¸ìŠ¤</span>
<span class="c1"># b: I/O ëŒ€ê¸° í”„ë¡œì„¸ìŠ¤</span>
<span class="c1"># si/so: swap in/out</span>
<span class="c1"># bi/bo: block in/out</span>
<span class="c1"># us/sy/id/wa: user/system/idle/wait</span>

<span class="c1"># mpstat - CPU í†µê³„</span>
mpstat<span class="w"> </span>-P<span class="w"> </span>ALL<span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="c1"># ëª¨ë“  CPU, 1ì´ˆ ê°„ê²©</span>

<span class="c1"># iostat - I/O í†µê³„</span>
iostat<span class="w"> </span>-x<span class="w"> </span><span class="m">1</span><span class="w">      </span><span class="c1"># í™•ì¥ ì •ë³´, 1ì´ˆ ê°„ê²©</span>

<span class="c1"># sar - ì‹œìŠ¤í…œ í™œë™ ë¦¬í¬íŠ¸</span>
sar<span class="w"> </span>-u<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w">       </span><span class="c1"># CPU</span>
sar<span class="w"> </span>-r<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w">       </span><span class="c1"># ë©”ëª¨ë¦¬</span>
sar<span class="w"> </span>-d<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w">       </span><span class="c1"># ë””ìŠ¤í¬</span>
sar<span class="w"> </span>-n<span class="w"> </span>DEV<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w">   </span><span class="c1"># ë„¤íŠ¸ì›Œí¬</span>

<span class="c1"># free - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</span>
free<span class="w"> </span>-h

<span class="c1"># uptime - ë¶€í•˜ í‰ê· </span>
uptime
<span class="c1"># load average: 1.50, 1.20, 0.80  (1ë¶„, 5ë¶„, 15ë¶„)</span>
</code></pre></div>

<h3 id="13-sysctl">1.3 sysctl ê¸°ë³¸<a class="header-link" href="#13-sysctl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># í˜„ì¬ ì„¤ì • í™•ì¸</span>
sysctl<span class="w"> </span>-a<span class="w">                    </span><span class="c1"># ëª¨ë“  ì„¤ì •</span>
sysctl<span class="w"> </span>vm.swappiness<span class="w">         </span><span class="c1"># íŠ¹ì • ì„¤ì •</span>
cat<span class="w"> </span>/proc/sys/vm/swappiness<span class="w">  </span><span class="c1"># ì§ì ‘ ì½ê¸°</span>

<span class="c1"># ì„ì‹œ ë³€ê²½</span>
sysctl<span class="w"> </span>-w<span class="w"> </span>vm.swappiness<span class="o">=</span><span class="m">10</span>
<span class="c1"># ë˜ëŠ”</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">10</span><span class="w"> </span>&gt;<span class="w"> </span>/proc/sys/vm/swappiness

<span class="c1"># ì˜êµ¬ ì„¤ì •</span>
<span class="c1"># /etc/sysctl.conf ë˜ëŠ” /etc/sysctl.d/*.conf</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;vm.swappiness = 10&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/sysctl.d/99-custom.conf
sysctl<span class="w"> </span>-p<span class="w"> </span>/etc/sysctl.d/99-custom.conf<span class="w">  </span><span class="c1"># ì ìš©</span>
sysctl<span class="w"> </span>--system<span class="w">  </span><span class="c1"># ëª¨ë“  ì„¤ì • íŒŒì¼ ë¡œë“œ</span>
</code></pre></div>

<hr />
<h2 id="2-cpu">2. CPU íŠœë‹<a class="header-link" href="#2-cpu" title="Permanent link">&para;</a></h2>
<h3 id="21-cpu">2.1 CPU ì •ë³´ í™•ì¸<a class="header-link" href="#21-cpu" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># CPU ì •ë³´</span>
lscpu
cat<span class="w"> </span>/proc/cpuinfo

<span class="c1"># CPU ì£¼íŒŒìˆ˜</span>
cat<span class="w"> </span>/sys/devices/system/cpu/cpu*/cpufreq/scaling_cur_freq
cpupower<span class="w"> </span>frequency-info

<span class="c1"># NUMA ì •ë³´</span>
numactl<span class="w"> </span>--hardware
lscpu<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>NUMA
</code></pre></div>

<h3 id="22-cpu-governor">2.2 CPU Governor<a class="header-link" href="#22-cpu-governor" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># í˜„ì¬ governor í™•ì¸</span>
cat<span class="w"> </span>/sys/devices/system/cpu/cpu0/cpufreq/scaling_governor

<span class="c1"># ì‚¬ìš© ê°€ëŠ¥í•œ governor</span>
cat<span class="w"> </span>/sys/devices/system/cpu/cpu0/cpufreq/scaling_available_governors
<span class="c1"># performance, powersave, userspace, ondemand, conservative, schedutil</span>

<span class="c1"># Governor ë³€ê²½</span>
<span class="nb">echo</span><span class="w"> </span>performance<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

<span class="c1"># cpupower ì‚¬ìš©</span>
cpupower<span class="w"> </span>frequency-set<span class="w"> </span>-g<span class="w"> </span>performance

<span class="c1"># ì˜êµ¬ ì„¤ì • (Ubuntu)</span>
<span class="c1"># /etc/default/cpufrequtils</span>
<span class="nv">GOVERNOR</span><span class="o">=</span><span class="s2">&quot;performance&quot;</span>
</code></pre></div>

<h3 id="23">2.3 í”„ë¡œì„¸ìŠ¤ ìš°ì„ ìˆœìœ„<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># nice ê°’ (-20 ~ 19, ë‚®ì„ìˆ˜ë¡ ë†’ì€ ìš°ì„ ìˆœìœ„)</span>
nice<span class="w"> </span>-n<span class="w"> </span>-10<span class="w"> </span>./high-priority-task
renice<span class="w"> </span>-n<span class="w"> </span>-10<span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;

<span class="c1"># ì‹¤ì‹œê°„ ìŠ¤ì¼€ì¤„ë§</span>
chrt<span class="w"> </span>-f<span class="w"> </span><span class="m">50</span><span class="w"> </span>./realtime-task<span class="w">  </span><span class="c1"># FIFO, ìš°ì„ ìˆœìœ„ 50</span>
chrt<span class="w"> </span>-r<span class="w"> </span><span class="m">50</span><span class="w"> </span>./realtime-task<span class="w">  </span><span class="c1"># Round Robin</span>

<span class="c1"># CPU ì¹œí™”ì„± (affinity)</span>
taskset<span class="w"> </span>-c<span class="w"> </span><span class="m">0</span>,1<span class="w"> </span>./my-program<span class="w">  </span><span class="c1"># CPU 0, 1ì—ì„œë§Œ ì‹¤í–‰</span>
taskset<span class="w"> </span>-cp<span class="w"> </span><span class="m">0</span>-3<span class="w"> </span>&lt;PID&gt;<span class="w">        </span><span class="c1"># ì‹¤í–‰ ì¤‘ í”„ë¡œì„¸ìŠ¤ ë³€ê²½</span>

<span class="c1"># cgroupsë¡œ CPU ì œí•œ</span>
<span class="c1"># /sys/fs/cgroup/cpu/mygroup/</span>
mkdir<span class="w"> </span>/sys/fs/cgroup/cpu/mygroup
<span class="nb">echo</span><span class="w"> </span><span class="m">50000</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/cpu/mygroup/cpu.cfs_quota_us<span class="w">  </span><span class="c1"># 50% ì œí•œ</span>
<span class="nb">echo</span><span class="w"> </span>&lt;PID&gt;<span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/cpu/mygroup/cgroup.procs
</code></pre></div>

<h3 id="24-cpu-sysctl">2.4 CPU ê´€ë ¨ sysctl<a class="header-link" href="#24-cpu-sysctl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/sysctl.d/99-cpu.conf</span>

<span class="c1"># ìŠ¤ì¼€ì¤„ëŸ¬ íŠœë‹</span>
kernel.sched_min_granularity_ns<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10000000</span>
kernel.sched_wakeup_granularity_ns<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15000000</span>
kernel.sched_migration_cost_ns<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5000000</span>

<span class="c1"># ì›Œí¬ë¡œë“œë³„ ìµœì í™”</span>
<span class="c1"># ì„œë²„ ì›Œí¬ë¡œë“œ (ì²˜ë¦¬ëŸ‰ ì¤‘ì‹¬)</span>
kernel.sched_autogroup_enabled<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>

<span class="c1"># ë°ìŠ¤í¬í†± ì›Œí¬ë¡œë“œ (ì‘ë‹µì„± ì¤‘ì‹¬)</span>
kernel.sched_autogroup_enabled<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
</code></pre></div>

<hr />
<h2 id="3">3. ë©”ëª¨ë¦¬ íŠœë‹<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ë©”ëª¨ë¦¬ ì •ë³´ í™•ì¸<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</span>
free<span class="w"> </span>-h
cat<span class="w"> </span>/proc/meminfo

<span class="c1"># í”„ë¡œì„¸ìŠ¤ë³„ ë©”ëª¨ë¦¬</span>
ps<span class="w"> </span>aux<span class="w"> </span>--sort<span class="o">=</span>-%mem<span class="w"> </span><span class="p">|</span><span class="w"> </span>head
pmap<span class="w"> </span>-x<span class="w"> </span>&lt;PID&gt;

<span class="c1"># í˜ì´ì§€ ìºì‹œ ìƒíƒœ</span>
cat<span class="w"> </span>/proc/meminfo<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;Cached|Buffers|Dirty&quot;</span>

<span class="c1"># NUMA ë©”ëª¨ë¦¬</span>
numastat
</code></pre></div>

<h3 id="32-swap">3.2 Swap íŠœë‹<a class="header-link" href="#32-swap" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># swappiness (0-100, ë‚®ì„ìˆ˜ë¡ swap ëœ ì‚¬ìš©)</span>
sysctl<span class="w"> </span>-w<span class="w"> </span>vm.swappiness<span class="o">=</span><span class="m">10</span><span class="w">  </span><span class="c1"># ì„œë²„: 10, ë°ìŠ¤í¬í†±: 60</span>

<span class="c1"># Swap íŒŒì¼ ìƒì„±</span>
dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>/dev/zero<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/swapfile<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>1G<span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">4</span>
chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/swapfile
mkswap<span class="w"> </span>/swapfile
swapon<span class="w"> </span>/swapfile

<span class="c1"># /etc/fstabì— ì¶”ê°€</span>
<span class="c1"># /swapfile none swap sw 0 0</span>

<span class="c1"># Swap ìƒíƒœ</span>
swapon<span class="w"> </span>--show
cat<span class="w"> </span>/proc/swaps
</code></pre></div>

<h3 id="33-sysctl">3.3 ë©”ëª¨ë¦¬ ê´€ë ¨ sysctl<a class="header-link" href="#33-sysctl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/sysctl.d/99-memory.conf</span>

<span class="c1"># Swap ì‚¬ìš© ì¤„ì´ê¸°</span>
vm.swappiness<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>

<span class="c1"># ë”í‹° í˜ì´ì§€ ë¹„ìœ¨ (ì“°ê¸° ì§€ì—°)</span>
vm.dirty_ratio<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="w">              </span><span class="c1"># ì „ì²´ ë©”ëª¨ë¦¬ì˜ 20%ê¹Œì§€ ë”í‹° í—ˆìš©</span>
vm.dirty_background_ratio<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="w">    </span><span class="c1"># 5%ì—ì„œ ë°±ê·¸ë¼ìš´ë“œ í”ŒëŸ¬ì‹œ ì‹œì‘</span>

<span class="c1"># ë˜ëŠ” ì ˆëŒ€ê°’ìœ¼ë¡œ</span>
vm.dirty_bytes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1073741824</span><span class="w">      </span><span class="c1"># 1GB</span>
vm.dirty_background_bytes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">268435456</span><span class="w">  </span><span class="c1"># 256MB</span>

<span class="c1"># ìºì‹œ ì••ë°•</span>
vm.vfs_cache_pressure<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="w">       </span><span class="c1"># ê¸°ë³¸ 100, ë‚®ìœ¼ë©´ ìºì‹œ ìœ ì§€</span>

<span class="c1"># OOM Killer íŠœë‹</span>
vm.overcommit_memory<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">         </span><span class="c1"># 0=íœ´ë¦¬ìŠ¤í‹±, 1=í•­ìƒ í—ˆìš©, 2=ì œí•œ</span>
vm.overcommit_ratio<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="w">         </span><span class="c1"># overcommit_memory=2ì¼ ë•Œ ì‚¬ìš©</span>

<span class="c1"># ë©”ëª¨ë¦¬ ì••ì¶•</span>
vm.compaction_proactiveness<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>

<span class="c1"># Transparent Huge Pages</span>
<span class="c1"># /sys/kernel/mm/transparent_hugepage/enabled</span>
<span class="c1"># [always] madvise never</span>
</code></pre></div>

<h3 id="34">3.4 ìºì‹œ ê´€ë¦¬<a class="header-link" href="#34" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># í˜ì´ì§€ ìºì‹œ ë¹„ìš°ê¸° (í”„ë¡œë•ì…˜ì—ì„œ ì£¼ì˜!)</span>
sync
<span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&gt;<span class="w"> </span>/proc/sys/vm/drop_caches<span class="w">  </span><span class="c1"># í˜ì´ì§€ ìºì‹œ</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>&gt;<span class="w"> </span>/proc/sys/vm/drop_caches<span class="w">  </span><span class="c1"># dentries, inodes</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">3</span><span class="w"> </span>&gt;<span class="w"> </span>/proc/sys/vm/drop_caches<span class="w">  </span><span class="c1"># ëª¨ë‘</span>

<span class="c1"># íŠ¹ì • íŒŒì¼ ìºì‹œ í™•ì¸</span>
vmtouch<span class="w"> </span>-v<span class="w"> </span>/path/to/file
fincore<span class="w"> </span>/path/to/file

<span class="c1"># í”„ë¡œì„¸ìŠ¤ë³„ ìºì‹œ ì‚¬ìš©</span>
cat<span class="w"> </span>/proc/&lt;PID&gt;/smaps<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;^(Rss|Shared|Private)&quot;</span>
</code></pre></div>

<hr />
<h2 id="4-io">4. I/O íŠœë‹<a class="header-link" href="#4-io" title="Permanent link">&para;</a></h2>
<h3 id="41-io">4.1 I/O ìŠ¤ì¼€ì¤„ëŸ¬<a class="header-link" href="#41-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># í˜„ì¬ ìŠ¤ì¼€ì¤„ëŸ¬ í™•ì¸</span>
cat<span class="w"> </span>/sys/block/sda/queue/scheduler
<span class="c1"># [mq-deadline] kyber bfq none</span>

<span class="c1"># ìŠ¤ì¼€ì¤„ëŸ¬ ì¢…ë¥˜</span>
<span class="c1"># - none: NVMe SSDìš© (NOOP)</span>
<span class="c1"># - mq-deadline: ë°ë“œë¼ì¸ ê¸°ë°˜, ì„œë²„ ê¸°ë³¸ê°’</span>
<span class="c1"># - bfq: Budget Fair Queueing, ë°ìŠ¤í¬í†±ìš©</span>
<span class="c1"># - kyber: ë¹ ë¥¸ ì¥ì¹˜ìš©</span>

<span class="c1"># ìŠ¤ì¼€ì¤„ëŸ¬ ë³€ê²½</span>
<span class="nb">echo</span><span class="w"> </span>mq-deadline<span class="w"> </span>&gt;<span class="w"> </span>/sys/block/sda/queue/scheduler

<span class="c1"># ì˜êµ¬ ì„¤ì • (GRUB)</span>
<span class="c1"># /etc/default/grub</span>
<span class="c1"># GRUB_CMDLINE_LINUX=&quot;elevator=mq-deadline&quot;</span>
<span class="c1"># update-grub</span>

<span class="c1"># udev ê·œì¹™ìœ¼ë¡œ ì„¤ì •</span>
<span class="c1"># /etc/udev/rules.d/60-scheduler.rules</span>
<span class="c1"># ACTION==&quot;add|change&quot;, KERNEL==&quot;sd[a-z]&quot;, ATTR{queue/scheduler}=&quot;mq-deadline&quot;</span>
<span class="c1"># ACTION==&quot;add|change&quot;, KERNEL==&quot;nvme[0-9]*&quot;, ATTR{queue/scheduler}=&quot;none&quot;</span>
</code></pre></div>

<h3 id="42-io">4.2 ë””ìŠ¤í¬ I/O íŠœë‹<a class="header-link" href="#42-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì½ê¸° ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸° (readahead)</span>
cat<span class="w"> </span>/sys/block/sda/queue/read_ahead_kb<span class="w">  </span><span class="c1"># ê¸°ë³¸ 128</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">256</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/block/sda/queue/read_ahead_kb

<span class="c1"># í ê¹Šì´</span>
cat<span class="w"> </span>/sys/block/sda/queue/nr_requests
<span class="nb">echo</span><span class="w"> </span><span class="m">256</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/block/sda/queue/nr_requests

<span class="c1"># ìµœëŒ€ ì„¹í„°</span>
cat<span class="w"> </span>/sys/block/sda/queue/max_sectors_kb

<span class="c1"># SSD TRIM í™œì„±í™”</span>
fstrim<span class="w"> </span>-v<span class="w"> </span>/
<span class="c1"># ë˜ëŠ” ìë™ TRIM (ë§ˆìš´íŠ¸ ì˜µì…˜: discard)</span>
<span class="c1"># /dev/sda1 / ext4 defaults,discard 0 1</span>

<span class="c1"># ì •ê¸° TRIM (ê¶Œì¥)</span>
systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>fstrim.timer
</code></pre></div>

<h3 id="43">4.3 íŒŒì¼ì‹œìŠ¤í…œ íŠœë‹<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ext4 ë§ˆìš´íŠ¸ ì˜µì…˜</span>
<span class="c1"># /etc/fstab</span>
<span class="c1"># noatime    - ì ‘ê·¼ ì‹œê°„ ê¸°ë¡ ì•ˆ í•¨ (ì„±ëŠ¥ í–¥ìƒ)</span>
<span class="c1"># nodiratime - ë””ë ‰í† ë¦¬ ì ‘ê·¼ ì‹œê°„ ê¸°ë¡ ì•ˆ í•¨</span>
<span class="c1"># data=writeback - ì €ë„ë§ ëª¨ë“œ (ìœ„í—˜í•˜ì§€ë§Œ ë¹ ë¦„)</span>
<span class="c1"># barrier=0  - ì“°ê¸° ì¥ë²½ ë¹„í™œì„±í™” (ìœ„í—˜)</span>
<span class="c1"># commit=60  - ì»¤ë°‹ ê°„ê²© (ì´ˆ)</span>

<span class="c1"># XFS íŠœë‹</span>
<span class="c1"># logbufs=8 - ë¡œê·¸ ë²„í¼ ìˆ˜</span>
<span class="c1"># logbsize=256k - ë¡œê·¸ ë²„í¼ í¬ê¸°</span>

<span class="c1"># íŒŒì¼ì‹œìŠ¤í…œ ì •ë³´</span>
tune2fs<span class="w"> </span>-l<span class="w"> </span>/dev/sda1<span class="w">  </span><span class="c1"># ext4</span>
xfs_info<span class="w"> </span>/dev/sda1<span class="w">    </span><span class="c1"># XFS</span>
</code></pre></div>

<h3 id="44-io">4.4 I/O ìš°ì„ ìˆœìœ„<a class="header-link" href="#44-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ionice - I/O ìš°ì„ ìˆœìœ„</span>
ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="nb">command</span><span class="w">        </span><span class="c1"># Idle</span>
ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-n<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="nb">command</span><span class="w">   </span><span class="c1"># Best-effort, ë†’ì€ ìš°ì„ ìˆœìœ„</span>
ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="nb">command</span><span class="w">        </span><span class="c1"># Realtime (rootë§Œ)</span>

<span class="c1"># ì‹¤í–‰ ì¤‘ í”„ë¡œì„¸ìŠ¤ ë³€ê²½</span>
ionice<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-n<span class="w"> </span><span class="m">7</span><span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;<span class="w">  </span><span class="c1"># ë‚®ì€ ìš°ì„ ìˆœìœ„ë¡œ</span>

<span class="c1"># í˜„ì¬ I/O ìš°ì„ ìˆœìœ„ í™•ì¸</span>
ionice<span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;
</code></pre></div>

<hr />
<h2 id="5">5. ë„¤íŠ¸ì›Œí¬ íŠœë‹<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ë„¤íŠ¸ì›Œí¬ ì •ë³´ í™•ì¸<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì¸í„°í˜ì´ìŠ¤ ì •ë³´</span>
ip<span class="w"> </span>link<span class="w"> </span>show
ethtool<span class="w"> </span>eth0

<span class="c1"># ë„¤íŠ¸ì›Œí¬ í†µê³„</span>
ss<span class="w"> </span>-s
netstat<span class="w"> </span>-s
cat<span class="w"> </span>/proc/net/netstat

<span class="c1"># ì—°ê²° ìƒíƒœ</span>
ss<span class="w"> </span>-tuln<span class="w">   </span><span class="c1"># ë¦¬ìŠ¤ë‹ í¬íŠ¸</span>
ss<span class="w"> </span>-tupn<span class="w">   </span><span class="c1"># ëª¨ë“  ì—°ê²°</span>
conntrack<span class="w"> </span>-L<span class="w">  </span><span class="c1"># ì—°ê²° ì¶”ì  í…Œì´ë¸”</span>
</code></pre></div>

<h3 id="52-tcp">5.2 TCP íŠœë‹<a class="header-link" href="#52-tcp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/sysctl.d/99-network.conf</span>

<span class="c1"># TCP ë²„í¼ í¬ê¸°</span>
net.core.rmem_max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16777216</span>
net.core.wmem_max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16777216</span>
net.core.rmem_default<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1048576</span>
net.core.wmem_default<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1048576</span>

<span class="c1"># TCP ì†Œì¼“ ë²„í¼ (min, default, max)</span>
net.ipv4.tcp_rmem<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span><span class="m">1048576</span><span class="w"> </span><span class="m">16777216</span>
net.ipv4.tcp_wmem<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span><span class="m">1048576</span><span class="w"> </span><span class="m">16777216</span>

<span class="c1"># TCP ë°±ë¡œê·¸</span>
net.core.somaxconn<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>
net.ipv4.tcp_max_syn_backlog<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>
net.core.netdev_max_backlog<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>

<span class="c1"># TIME_WAIT ìµœì í™”</span>
net.ipv4.tcp_fin_timeout<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span>
net.ipv4.tcp_tw_reuse<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>

<span class="c1"># TCP Keepalive</span>
net.ipv4.tcp_keepalive_time<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span>
net.ipv4.tcp_keepalive_intvl<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">60</span>
net.ipv4.tcp_keepalive_probes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>

<span class="c1"># TCP í˜¼ì¡ ì œì–´</span>
net.ipv4.tcp_congestion_control<span class="w"> </span><span class="o">=</span><span class="w"> </span>bbr<span class="w">  </span><span class="c1"># ë˜ëŠ” cubic</span>
net.core.default_qdisc<span class="w"> </span><span class="o">=</span><span class="w"> </span>fq

<span class="c1"># í¬íŠ¸ ë²”ìœ„</span>
net.ipv4.ip_local_port_range<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1024</span><span class="w"> </span><span class="m">65535</span>

<span class="c1"># SYN ì¿ í‚¤ (SYN flood ë°©ì–´)</span>
net.ipv4.tcp_syncookies<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
</code></pre></div>

<h3 id="53">5.3 ê³ ì„±ëŠ¥ ì›¹ ì„œë²„ ì„¤ì •<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/sysctl.d/99-webserver.conf</span>

<span class="c1"># íŒŒì¼ í•¸ë“¤ ì œí•œ</span>
fs.file-max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2097152</span>
fs.nr_open<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2097152</span>

<span class="c1"># ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒ</span>
net.core.somaxconn<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>
net.ipv4.tcp_max_tw_buckets<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2000000</span>
net.ipv4.tcp_max_syn_backlog<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>
net.core.netdev_max_backlog<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">65535</span>

<span class="c1"># ë²„í¼</span>
net.core.rmem_max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16777216</span>
net.core.wmem_max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16777216</span>
net.ipv4.tcp_rmem<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span><span class="m">12582912</span><span class="w"> </span><span class="m">16777216</span>
net.ipv4.tcp_wmem<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span><span class="m">12582912</span><span class="w"> </span><span class="m">16777216</span>

<span class="c1"># TCP ìµœì í™”</span>
net.ipv4.tcp_slow_start_after_idle<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
net.ipv4.tcp_tw_reuse<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
net.ipv4.tcp_fin_timeout<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span>
net.ipv4.tcp_mtu_probing<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>

<span class="c1"># BBR</span>
net.ipv4.tcp_congestion_control<span class="w"> </span><span class="o">=</span><span class="w"> </span>bbr
net.core.default_qdisc<span class="w"> </span><span class="o">=</span><span class="w"> </span>fq
</code></pre></div>

<h3 id="54">5.4 ì—°ê²° ì œí•œ<a class="header-link" href="#54" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì‹œìŠ¤í…œ ì œí•œ</span>
<span class="nb">ulimit</span><span class="w"> </span>-n<span class="w">        </span><span class="c1"># í˜„ì¬ ì œí•œ</span>
<span class="nb">ulimit</span><span class="w"> </span>-n<span class="w"> </span><span class="m">65535</span><span class="w">  </span><span class="c1"># ë³€ê²½</span>

<span class="c1"># /etc/security/limits.conf</span>
<span class="c1"># * soft nofile 65535</span>
<span class="c1"># * hard nofile 65535</span>

<span class="c1"># systemd ì„œë¹„ìŠ¤ ì œí•œ</span>
<span class="c1"># [Service]</span>
<span class="c1"># LimitNOFILE=65535</span>
</code></pre></div>

<hr />
<h2 id="6">6. í”„ë¡œíŒŒì¼ë§ ë„êµ¬<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-perf">6.1 perf ê¸°ë³¸<a class="header-link" href="#61-perf" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># perf ì„¤ì¹˜</span>
apt<span class="w"> </span>install<span class="w"> </span>linux-tools-common<span class="w"> </span>linux-tools-<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>

<span class="c1"># CPU í”„ë¡œíŒŒì¼ë§</span>
perf<span class="w"> </span>stat<span class="w"> </span>./my-program
perf<span class="w"> </span>stat<span class="w"> </span>-d<span class="w"> </span>./my-program<span class="w">  </span><span class="c1"># ìƒì„¸</span>

<span class="c1"># ìƒ˜í”Œë§</span>
perf<span class="w"> </span>record<span class="w"> </span>-g<span class="w"> </span>./my-program
perf<span class="w"> </span>record<span class="w"> </span>-g<span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;<span class="w"> </span>--<span class="w"> </span>sleep<span class="w"> </span><span class="m">30</span>

<span class="c1"># ê²°ê³¼ ë¶„ì„</span>
perf<span class="w"> </span>report
perf<span class="w"> </span>report<span class="w"> </span>--stdio

<span class="c1"># ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</span>
perf<span class="w"> </span>top
perf<span class="w"> </span>top<span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;

<span class="c1"># ì‹œìŠ¤í…œ ì „ì²´</span>
perf<span class="w"> </span>record<span class="w"> </span>-a<span class="w"> </span>-g<span class="w"> </span>--<span class="w"> </span>sleep<span class="w"> </span><span class="m">10</span>
</code></pre></div>

<h3 id="62-flamegraph">6.2 Flamegraph<a class="header-link" href="#62-flamegraph" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># FlameGraph ë„êµ¬ ì„¤ì¹˜</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/brendangregg/FlameGraph

<span class="c1"># perfë¡œ ë°ì´í„° ìˆ˜ì§‘</span>
perf<span class="w"> </span>record<span class="w"> </span>-g<span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;<span class="w"> </span>--<span class="w"> </span>sleep<span class="w"> </span><span class="m">60</span>

<span class="c1"># Flamegraph ìƒì„±</span>
perf<span class="w"> </span>script<span class="w"> </span><span class="p">|</span><span class="w"> </span>./FlameGraph/stackcollapse-perf.pl<span class="w"> </span><span class="p">|</span><span class="w"> </span>./FlameGraph/flamegraph.pl<span class="w"> </span>&gt;<span class="w"> </span>flame.svg

<span class="c1"># ë˜ëŠ” í•œ ë²ˆì—</span>
perf<span class="w"> </span>record<span class="w"> </span>-F<span class="w"> </span><span class="m">99</span><span class="w"> </span>-a<span class="w"> </span>-g<span class="w"> </span>--<span class="w"> </span>sleep<span class="w"> </span><span class="m">60</span>
perf<span class="w"> </span>script<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>./FlameGraph/stackcollapse-perf.pl<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>./FlameGraph/flamegraph.pl<span class="w"> </span>&gt;<span class="w"> </span>flame.svg
</code></pre></div>

<h3 id="63-straceltrace">6.3 strace/ltrace<a class="header-link" href="#63-straceltrace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì‹œìŠ¤í…œ ì½œ ì¶”ì </span>
strace<span class="w"> </span>./my-program
strace<span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;

<span class="c1"># íŠ¹ì • ì‹œìŠ¤í…œ ì½œë§Œ</span>
strace<span class="w"> </span>-e<span class="w"> </span>open,read,write<span class="w"> </span>./my-program

<span class="c1"># ì‹œê°„ ì¸¡ì •</span>
strace<span class="w"> </span>-T<span class="w"> </span>./my-program<span class="w">    </span><span class="c1"># ê° syscall ì‹œê°„</span>
strace<span class="w"> </span>-c<span class="w"> </span>./my-program<span class="w">    </span><span class="c1"># ìš”ì•½ í†µê³„</span>

<span class="c1"># ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½œ ì¶”ì </span>
ltrace<span class="w"> </span>./my-program
</code></pre></div>

<h3 id="64">6.4 ê¸°íƒ€ ë„êµ¬<a class="header-link" href="#64" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># bpftrace - eBPF ê¸°ë°˜ ì¶”ì </span>
bpftrace<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;tracepoint:syscalls:sys_enter_open { printf(&quot;%s %s\n&quot;, comm, str(args-&gt;filename)); }&#39;</span>

<span class="c1"># ë©”ëª¨ë¦¬ í”„ë¡œíŒŒì¼ë§ (Valgrind)</span>
valgrind<span class="w"> </span>--tool<span class="o">=</span>massif<span class="w"> </span>./my-program
ms_print<span class="w"> </span>massif.out.*

<span class="c1"># CPU í”„ë¡œíŒŒì¼ë§ (Valgrind)</span>
valgrind<span class="w"> </span>--tool<span class="o">=</span>callgrind<span class="w"> </span>./my-program
kcachegrind<span class="w"> </span>callgrind.out.*

<span class="c1"># ë²¤ì¹˜ë§ˆí‚¹</span>
stress-ng<span class="w"> </span>--cpu<span class="w"> </span><span class="m">4</span><span class="w"> </span>--timeout<span class="w"> </span>60s
fio<span class="w"> </span>--name<span class="o">=</span>random-write<span class="w"> </span>--ioengine<span class="o">=</span>libaio<span class="w"> </span>--iodepth<span class="o">=</span><span class="m">32</span><span class="w"> </span>--rw<span class="o">=</span>randwrite<span class="w"> </span>--bs<span class="o">=</span>4k<span class="w"> </span>--direct<span class="o">=</span><span class="m">1</span><span class="w"> </span>--size<span class="o">=</span>1G<span class="w"> </span>--numjobs<span class="o">=</span><span class="m">4</span><span class="w"> </span>--runtime<span class="o">=</span><span class="m">60</span>
</code></pre></div>

<h3 id="65">6.5 ì„±ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸<a class="header-link" href="#65" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># performance-check.sh</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;=== ì‹œìŠ¤í…œ ì •ë³´ ===&quot;</span>
uname<span class="w"> </span>-a
uptime

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== CPU ===&quot;</span>
lscpu<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;^(CPU\(s\)|Thread|Core|Model name)&quot;</span>
mpstat<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== ë©”ëª¨ë¦¬ ===&quot;</span>
free<span class="w"> </span>-h
cat<span class="w"> </span>/proc/meminfo<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;^(MemTotal|MemFree|Buffers|Cached|SwapTotal|SwapFree)&quot;</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== ë””ìŠ¤í¬ I/O ===&quot;</span>
iostat<span class="w"> </span>-x<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== ë„¤íŠ¸ì›Œí¬ ===&quot;</span>
ss<span class="w"> </span>-s
cat<span class="w"> </span>/proc/net/netstat<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;^(Tcp|Udp)&quot;</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== ë¡œë“œ í‰ê·  ===&quot;</span>
cat<span class="w"> </span>/proc/loadavg

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== Top í”„ë¡œì„¸ìŠ¤ (CPU) ===&quot;</span>
ps<span class="w"> </span>aux<span class="w"> </span>--sort<span class="o">=</span>-%cpu<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-5

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== Top í”„ë¡œì„¸ìŠ¤ (Memory) ===&quot;</span>
ps<span class="w"> </span>aux<span class="w"> </span>--sort<span class="o">=</span>-%mem<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-5

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== ì—´ë¦° íŒŒì¼ ìˆ˜ ===&quot;</span>
cat<span class="w"> </span>/proc/sys/fs/file-nr

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n=== ë„¤íŠ¸ì›Œí¬ ì—°ê²° ===&quot;</span>
ss<span class="w"> </span>-s
</code></pre></div>

<hr />
<h2 id="7">7. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="1_1">ì—°ìŠµ 1: ì›¹ ì„œë²„ íŠœë‹<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. ë™ì‹œ ì—°ê²° 10ë§Œ ì§€ì›</span>
<span class="c1"># 2. TCP ìµœì í™” (BBR, keepalive)</span>
<span class="c1"># 3. íŒŒì¼ í•¸ë“¤ ì œí•œ ì¦ê°€</span>
<span class="c1"># 4. ì ì ˆí•œ I/O ìŠ¤ì¼€ì¤„ëŸ¬ ì„ íƒ</span>

<span class="c1"># sysctl ì„¤ì • ì‘ì„±:</span>
</code></pre></div>

<h3 id="2">ì—°ìŠµ 2: ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ íŠœë‹<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. ë©”ëª¨ë¦¬ ìµœì í™” (ë‚®ì€ swappiness)</span>
<span class="c1"># 2. ë””ìŠ¤í¬ I/O ìµœì í™”</span>
<span class="c1"># 3. ë”í‹° í˜ì´ì§€ ê´€ë¦¬</span>
<span class="c1"># 4. CPU ì¹œí™”ì„± ì„¤ì •</span>

<span class="c1"># ì„¤ì • ë° ëª…ë ¹ì–´ ì‘ì„±:</span>
</code></pre></div>

<h3 id="3_1">ì—°ìŠµ 3: ì„±ëŠ¥ ë¬¸ì œ ì§„ë‹¨<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì‹œë‚˜ë¦¬ì˜¤:</span>
<span class="c1"># ì„œë²„ê°€ ëŠë ¤ì¡Œì„ ë•Œ ìˆœì°¨ì ìœ¼ë¡œ í™•ì¸í•  í•­ëª© ì‘ì„±</span>

<span class="c1"># ì§„ë‹¨ ëª…ë ¹ì–´ ëª©ë¡:</span>
</code></pre></div>

<h3 id="4-flamegraph">ì—°ìŠµ 4: Flamegraph ë¶„ì„<a class="header-link" href="#4-flamegraph" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. CPU ì§‘ì•½ì ì¸ í”„ë¡œê·¸ë¨ ì‘ì„± ë˜ëŠ” ì„ íƒ</span>
<span class="c1"># 2. perfë¡œ í”„ë¡œíŒŒì¼ë§</span>
<span class="c1"># 3. Flamegraph ìƒì„±</span>
<span class="c1"># 4. ë³‘ëª© ì§€ì  ë¶„ì„</span>

<span class="c1"># ëª…ë ¹ì–´ ë° ë¶„ì„ ë°©ë²•:</span>
</code></pre></div>

<hr />
<h2 id="_3">ë‹¤ìŒ ë‹¨ê³„<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="15_ì»¨í…Œì´ë„ˆ_ë‚´ë¶€_êµ¬ì¡°.md">15_ì»¨í…Œì´ë„ˆ_ë‚´ë¶€_êµ¬ì¡°</a> - cgroups, namespaces</li>
<li><a href="16_ì €ì¥ì†Œ_ê´€ë¦¬.md">16_ì €ì¥ì†Œ_ê´€ë¦¬</a> - LVM, RAID</li>
<li><a href="https://www.brendangregg.com/">Brendan Gregg's Blog</a></li>
</ul>
<h2 id="_4">ì°¸ê³  ìë£Œ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.brendangregg.com/linuxperf.html">Linux Performance</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status_and_performance/index">Red Hat Performance Tuning Guide</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/sysctl/">kernel.org sysctl Documentation</a></li>
<li><a href="https://www.brendangregg.com/perf.html">perf Examples</a></li>
</ul>
<hr />
<p><a href="13_systemd_ì‹¬í™”.md">â† ì´ì „: systemd ì‹¬í™”</a> | <a href="15_ì»¨í…Œì´ë„ˆ_ë‚´ë¶€_êµ¬ì¡°.md">ë‹¤ìŒ: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ êµ¬ì¡° â†’</a> | <a href="00_Overview.md">ëª©ì°¨</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Linux/13_Systemd_Advanced.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. systemd ì‹¬í™”</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Linux/15_Container_Internals.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ êµ¬ì¡°</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}