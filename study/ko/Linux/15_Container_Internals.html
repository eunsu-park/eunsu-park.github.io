{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ êµ¬ì¡° - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Linux/">Linux</a>
    <span class="separator">/</span>
    <span class="current">15. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ êµ¬ì¡°</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>15. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ êµ¬ì¡°</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Linux/14_Performance_Tuning.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">14. Linux ì„±ëŠ¥ íŠœë‹</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Linux/16_Storage_Management.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">16. ì €ì¥ì†Œ ê´€ë¦¬</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1">1. ì»¨í…Œì´ë„ˆ ê¸°ì´ˆ</a><ul>
<li><a href="#11-vs">1.1 ì»¨í…Œì´ë„ˆ vs ê°€ìƒë¨¸ì‹ </a></li>
<li><a href="#12">1.2 ì»¨í…Œì´ë„ˆ í•µì‹¬ ê¸°ìˆ </a></li>
</ul>
</li>
<li><a href="#2-linux-namespaces">2. Linux Namespaces</a><ul>
<li><a href="#21-namespace">2.1 Namespace ì¢…ë¥˜</a></li>
<li><a href="#22-unshare-namespace">2.2 unshareë¡œ namespace ìƒì„±</a></li>
<li><a href="#23-nsenter-namespace">2.3 nsenterë¡œ namespace ì§„ì…</a></li>
<li><a href="#24-namespace-c">2.4 Namespace C ì˜ˆì œ</a></li>
</ul>
</li>
<li><a href="#3-control-groups-cgroups">3. Control Groups (cgroups)</a><ul>
<li><a href="#31-cgroups-v2">3.1 cgroups v2 êµ¬ì¡°</a></li>
<li><a href="#32-cgroups">3.2 cgroups ê¸°ë³¸ ëª…ë ¹</a></li>
<li><a href="#33-cpu">3.3 CPU ì œí•œ</a></li>
<li><a href="#34">3.4 ë©”ëª¨ë¦¬ ì œí•œ</a></li>
<li><a href="#35-io">3.5 I/O ì œí•œ</a></li>
<li><a href="#36-systemd-cgroups">3.6 systemdì™€ cgroups</a></li>
</ul>
</li>
<li><a href="#4-union-filesystem">4. Union Filesystem</a><ul>
<li><a href="#41-overlayfs">4.1 OverlayFS ê°œë…</a></li>
<li><a href="#42-overlayfs">4.2 OverlayFS ì‚¬ìš©</a></li>
<li><a href="#43-docker">4.3 Docker ì´ë¯¸ì§€ ë ˆì´ì–´</a></li>
</ul>
</li>
<li><a href="#5">5. ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„</a><ul>
<li><a href="#51">5.1 ëŸ°íƒ€ì„ ê³„ì¸µ</a></li>
<li><a href="#52">5.2 ìˆ˜ë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ë§Œë“¤ê¸°</a></li>
<li><a href="#53-runc">5.3 runc ì‚¬ìš©</a></li>
<li><a href="#54-rootless">5.4 Rootless ì»¨í…Œì´ë„ˆ</a></li>
</ul>
</li>
<li><a href="#6">6. ë³´ì•ˆ</a><ul>
<li><a href="#61-capabilities">6.1 Capabilities</a></li>
<li><a href="#62-seccomp">6.2 Seccomp</a></li>
<li><a href="#63-apparmorselinux">6.3 AppArmor/SELinux</a></li>
<li><a href="#64">6.4 ì½ê¸° ì „ìš© ë£¨íŠ¸</a></li>
</ul>
</li>
<li><a href="#7">7. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-namespace">ì—°ìŠµ 1: namespace ì‹¤ìŠµ</a></li>
<li><a href="#2-cgroups">ì—°ìŠµ 2: cgroups ë¦¬ì†ŒìŠ¤ ì œí•œ</a></li>
<li><a href="#3">ì—°ìŠµ 3: ìˆ˜ë™ ì»¨í…Œì´ë„ˆ ìƒì„±</a></li>
<li><a href="#4">ì—°ìŠµ 4: ë³´ì•ˆ ê°•í™” ì»¨í…Œì´ë„ˆ</a></li>
</ul>
</li>
<li><a href="#_3">ë‹¤ìŒ ë‹¨ê³„</a></li>
<li><a href="#_4">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="15">15. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ êµ¬ì¡°<a class="header-link" href="#15" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>Linux ì»¨í…Œì´ë„ˆ ê²©ë¦¬ ê¸°ìˆ  ì´í•´</li>
<li>namespacesë¡œ ë¦¬ì†ŒìŠ¤ ê²©ë¦¬</li>
<li>cgroupsë¡œ ë¦¬ì†ŒìŠ¤ ì œí•œ</li>
<li>ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ë™ì‘ ì›ë¦¬</li>
</ul>
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ì»¨í…Œì´ë„ˆ-ê¸°ì´ˆ">ì»¨í…Œì´ë„ˆ ê¸°ì´ˆ</a></li>
<li><a href="#2-linux-namespaces">Linux Namespaces</a></li>
<li><a href="#3-control-groups-cgroups">Control Groups (cgroups)</a></li>
<li><a href="#4-union-filesystem">Union Filesystem</a></li>
<li><a href="#5-ì»¨í…Œì´ë„ˆ-ëŸ°íƒ€ì„">ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„</a></li>
<li><a href="#6-ë³´ì•ˆ">ë³´ì•ˆ</a></li>
<li><a href="#7-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<hr />
<h2 id="1">1. ì»¨í…Œì´ë„ˆ ê¸°ì´ˆ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11-vs">1.1 ì»¨í…Œì´ë„ˆ vs ê°€ìƒë¨¸ì‹ <a class="header-link" href="#11-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ê°€ìƒë¨¸ì‹  vs ì»¨í…Œì´ë„ˆ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ê°€ìƒë¨¸ì‹  (Virtual Machine)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  App A  â”‚ â”‚  App B  â”‚ â”‚  App C  â”‚                       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
â”‚  â”‚ Guest OSâ”‚ â”‚ Guest OSâ”‚ â”‚ Guest OSâ”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚           Hypervisor                â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚            Host OS                  â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â”‚  ì»¨í…Œì´ë„ˆ (Container)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  App A  â”‚ â”‚  App B  â”‚ â”‚  App C  â”‚                       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
â”‚  â”‚ Bins/   â”‚ â”‚ Bins/   â”‚ â”‚ Bins/   â”‚                       â”‚
â”‚  â”‚ Libs    â”‚ â”‚ Libs    â”‚ â”‚ Libs    â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚        Container Runtime            â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚          Host OS (ì»¤ë„ ê³µìœ )         â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="12">1.2 ì»¨í…Œì´ë„ˆ í•µì‹¬ ê¸°ìˆ <a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ì»¨í…Œì´ë„ˆ í•µì‹¬ ê¸°ìˆ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Namespaces - ê²©ë¦¬ (Isolation)                          â”‚
â”‚     â€¢ PID namespace    - í”„ë¡œì„¸ìŠ¤ ID ê²©ë¦¬                  â”‚
â”‚     â€¢ Network namespace - ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒ ê²©ë¦¬               â”‚
â”‚     â€¢ Mount namespace  - íŒŒì¼ì‹œìŠ¤í…œ ê²©ë¦¬                   â”‚
â”‚     â€¢ UTS namespace    - í˜¸ìŠ¤íŠ¸ëª… ê²©ë¦¬                     â”‚
â”‚     â€¢ IPC namespace    - í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹  ê²©ë¦¬             â”‚
â”‚     â€¢ User namespace   - ì‚¬ìš©ì/ê·¸ë£¹ ID ê²©ë¦¬               â”‚
â”‚     â€¢ Cgroup namespace - cgroup ë£¨íŠ¸ ê²©ë¦¬                  â”‚
â”‚                                                             â”‚
â”‚  2. Cgroups - ë¦¬ì†ŒìŠ¤ ì œí•œ (Resource Limiting)              â”‚
â”‚     â€¢ CPU, ë©”ëª¨ë¦¬, I/O, ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ ì œí•œ               â”‚
â”‚     â€¢ í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹ ê´€ë¦¬                                    â”‚
â”‚                                                             â”‚
â”‚  3. Union Filesystem - ë ˆì´ì–´ ì´ë¯¸ì§€                       â”‚
â”‚     â€¢ OverlayFS, AUFS                                      â”‚
â”‚     â€¢ Copy-on-Write                                        â”‚
â”‚                                                             â”‚
â”‚  4. Capabilities - ê¶Œí•œ ë¶„ë¦¬                               â”‚
â”‚     â€¢ root ê¶Œí•œ ì„¸ë¶„í™”                                      â”‚
â”‚                                                             â”‚
â”‚  5. Seccomp - ì‹œìŠ¤í…œ ì½œ í•„í„°ë§                             â”‚
â”‚     â€¢ í—ˆìš©ëœ syscallë§Œ ì‹¤í–‰                                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2-linux-namespaces">2. Linux Namespaces<a class="header-link" href="#2-linux-namespaces" title="Permanent link">&para;</a></h2>
<h3 id="21-namespace">2.1 Namespace ì¢…ë¥˜<a class="header-link" href="#21-namespace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># í˜„ì¬ í”„ë¡œì„¸ìŠ¤ì˜ namespace í™•ì¸</span>
ls<span class="w"> </span>-la<span class="w"> </span>/proc/<span class="nv">$$</span>/ns/
<span class="c1"># cgroup -&gt; &#39;cgroup:[4026531835]&#39;</span>
<span class="c1"># ipc -&gt; &#39;ipc:[4026531839]&#39;</span>
<span class="c1"># mnt -&gt; &#39;mnt:[4026531840]&#39;</span>
<span class="c1"># net -&gt; &#39;net:[4026531992]&#39;</span>
<span class="c1"># pid -&gt; &#39;pid:[4026531836]&#39;</span>
<span class="c1"># user -&gt; &#39;user:[4026531837]&#39;</span>
<span class="c1"># uts -&gt; &#39;uts:[4026531838]&#39;</span>

<span class="c1"># ì‹œìŠ¤í…œì˜ ëª¨ë“  namespace</span>
lsns

<span class="c1"># íŠ¹ì • í”„ë¡œì„¸ìŠ¤ì˜ namespace</span>
lsns<span class="w"> </span>-p<span class="w"> </span>&lt;PID&gt;
</code></pre></div>

<h3 id="22-unshare-namespace">2.2 unshareë¡œ namespace ìƒì„±<a class="header-link" href="#22-unshare-namespace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># UTS namespace (í˜¸ìŠ¤íŠ¸ëª… ê²©ë¦¬)</span>
unshare<span class="w"> </span>--uts<span class="w"> </span>/bin/bash
hostname<span class="w"> </span>container-test
hostname<span class="w">  </span><span class="c1"># container-test</span>
<span class="nb">exit</span>
hostname<span class="w">  </span><span class="c1"># ì›ë˜ í˜¸ìŠ¤íŠ¸ëª…</span>

<span class="c1"># PID namespace (í”„ë¡œì„¸ìŠ¤ ê²©ë¦¬)</span>
unshare<span class="w"> </span>--pid<span class="w"> </span>--fork<span class="w"> </span>--mount-proc<span class="w"> </span>/bin/bash
ps<span class="w"> </span>aux<span class="w">  </span><span class="c1"># ê²©ë¦¬ëœ í”„ë¡œì„¸ìŠ¤ë§Œ ë³´ì„</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$$</span><span class="w">  </span><span class="c1"># PID 1</span>
<span class="nb">exit</span>

<span class="c1"># Mount namespace (íŒŒì¼ì‹œìŠ¤í…œ ê²©ë¦¬)</span>
unshare<span class="w"> </span>--mount<span class="w"> </span>/bin/bash
mount<span class="w"> </span>--bind<span class="w"> </span>/tmp<span class="w"> </span>/mnt
ls<span class="w"> </span>/mnt<span class="w">  </span><span class="c1"># í˜¸ìŠ¤íŠ¸ì˜ /mntì—ëŠ” ì˜í–¥ ì—†ìŒ</span>
<span class="nb">exit</span>

<span class="c1"># Network namespace (ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬)</span>
unshare<span class="w"> </span>--net<span class="w"> </span>/bin/bash
ip<span class="w"> </span>a<span class="w">  </span><span class="c1"># loë§Œ ì¡´ì¬</span>
<span class="nb">exit</span>

<span class="c1"># User namespace (ì‚¬ìš©ì ê²©ë¦¬)</span>
unshare<span class="w"> </span>--user<span class="w"> </span>--map-root-user<span class="w"> </span>/bin/bash
id<span class="w">  </span><span class="c1"># uid=0(root) gid=0(root)</span>
<span class="c1"># ì‹¤ì œë¡œëŠ” ì¼ë°˜ ì‚¬ìš©ì</span>
<span class="nb">exit</span>

<span class="c1"># ëª¨ë‘ ì¡°í•© (ì»¨í…Œì´ë„ˆì™€ ìœ ì‚¬)</span>
unshare<span class="w"> </span>--mount<span class="w"> </span>--uts<span class="w"> </span>--ipc<span class="w"> </span>--net<span class="w"> </span>--pid<span class="w"> </span>--fork<span class="w"> </span>--user<span class="w"> </span>--map-root-user<span class="w"> </span>/bin/bash
</code></pre></div>

<h3 id="23-nsenter-namespace">2.3 nsenterë¡œ namespace ì§„ì…<a class="header-link" href="#23-nsenter-namespace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì˜ namespaceë¡œ ì§„ì…</span>
nsenter<span class="w"> </span>-t<span class="w"> </span>&lt;PID&gt;<span class="w"> </span>--all<span class="w"> </span>/bin/bash

<span class="c1"># íŠ¹ì • namespaceë§Œ</span>
nsenter<span class="w"> </span>-t<span class="w"> </span>&lt;PID&gt;<span class="w"> </span>--net<span class="w"> </span>/bin/bash
nsenter<span class="w"> </span>-t<span class="w"> </span>&lt;PID&gt;<span class="w"> </span>--pid<span class="w"> </span>--mount<span class="w"> </span>/bin/bash

<span class="c1"># Docker ì»¨í…Œì´ë„ˆì˜ namespace ì§„ì…</span>
docker<span class="w"> </span>inspect<span class="w"> </span>--format<span class="w"> </span><span class="s1">&#39;{{.State.Pid}}&#39;</span><span class="w"> </span>&lt;container_id&gt;
nsenter<span class="w"> </span>-t<span class="w"> </span>&lt;PID&gt;<span class="w"> </span>--all<span class="w"> </span>/bin/bash
</code></pre></div>

<h3 id="24-namespace-c">2.4 Namespace C ì˜ˆì œ<a class="header-link" href="#24-namespace-c" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// simple_container.c</span>
<span class="cp">#define _GNU_SOURCE</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sched.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/wait.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>

<span class="cp">#define STACK_SIZE (1024 * 1024)</span>

<span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">child_stack</span><span class="p">[</span><span class="n">STACK_SIZE</span><span class="p">];</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">child_fn</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">arg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// í˜¸ìŠ¤íŠ¸ëª… ë³€ê²½</span>
<span class="w">    </span><span class="n">sethostname</span><span class="p">(</span><span class="s">&quot;container&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// ìƒˆ root íŒŒì¼ì‹œìŠ¤í…œìœ¼ë¡œ chroot (ì¤€ë¹„ëœ ê²½ìš°)</span>
<span class="w">    </span><span class="c1">// chroot(&quot;/path/to/rootfs&quot;);</span>
<span class="w">    </span><span class="c1">// chdir(&quot;/&quot;);</span>

<span class="w">    </span><span class="c1">// ì‰˜ ì‹¤í–‰</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;/bin/bash&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>
<span class="w">    </span><span class="n">execv</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ìƒˆ namespaceì™€ í•¨ê»˜ ìì‹ í”„ë¡œì„¸ìŠ¤ ìƒì„±</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CLONE_NEWUTS</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="c1">// UTS namespace</span>
<span class="w">                </span><span class="n">CLONE_NEWPID</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="c1">// PID namespace</span>
<span class="w">                </span><span class="n">CLONE_NEWNS</span><span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="c1">// Mount namespace</span>
<span class="w">                </span><span class="n">CLONE_NEWNET</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="c1">// Network namespace</span>
<span class="w">                </span><span class="n">SIGCHLD</span><span class="p">;</span>

<span class="w">    </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clone</span><span class="p">(</span><span class="n">child_fn</span><span class="p">,</span><span class="w"> </span><span class="n">child_stack</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">STACK_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pid</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;clone&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">waitpid</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># ì»´íŒŒì¼ ë° ì‹¤í–‰</span>
gcc<span class="w"> </span>-o<span class="w"> </span>simple_container<span class="w"> </span>simple_container.c
sudo<span class="w"> </span>./simple_container
</code></pre></div>

<hr />
<h2 id="3-control-groups-cgroups">3. Control Groups (cgroups)<a class="header-link" href="#3-control-groups-cgroups" title="Permanent link">&para;</a></h2>
<h3 id="31-cgroups-v2">3.1 cgroups v2 êµ¬ì¡°<a class="header-link" href="#31-cgroups-v2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    cgroups v2 ê³„ì¸µ êµ¬ì¡°                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  /sys/fs/cgroup/ (cgroup2 ë£¨íŠ¸)                            â”‚
â”‚  â”œâ”€â”€ cgroup.controllers      # ì‚¬ìš© ê°€ëŠ¥í•œ ì»¨íŠ¸ë¡¤ëŸ¬        â”‚
â”‚  â”œâ”€â”€ cgroup.subtree_control  # ìì‹ì—ê²Œ ìœ„ì„í•  ì»¨íŠ¸ë¡¤ëŸ¬    â”‚
â”‚  â”œâ”€â”€ cgroup.procs            # ì´ cgroupì˜ í”„ë¡œì„¸ìŠ¤        â”‚
â”‚  â”‚                                                          â”‚
â”‚  â”œâ”€â”€ system.slice/           # systemd ì‹œìŠ¤í…œ ì„œë¹„ìŠ¤       â”‚
â”‚  â”‚   â”œâ”€â”€ cgroup.procs                                      â”‚
â”‚  â”‚   â”œâ”€â”€ cpu.max                                           â”‚
â”‚  â”‚   â””â”€â”€ memory.max                                        â”‚
â”‚  â”‚                                                          â”‚
â”‚  â”œâ”€â”€ user.slice/             # ì‚¬ìš©ì ì„¸ì…˜                 â”‚
â”‚  â”‚   â””â”€â”€ user-1000.slice/                                  â”‚
â”‚  â”‚                                                          â”‚
â”‚  â””â”€â”€ mygroup/                # ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹            â”‚
â”‚      â”œâ”€â”€ cgroup.procs                                      â”‚
â”‚      â”œâ”€â”€ cpu.max             # CPU ì œí•œ                    â”‚
â”‚      â”œâ”€â”€ cpu.stat            # CPU í†µê³„                    â”‚
â”‚      â”œâ”€â”€ memory.max          # ë©”ëª¨ë¦¬ ì œí•œ                 â”‚
â”‚      â”œâ”€â”€ memory.current      # í˜„ì¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰          â”‚
â”‚      â””â”€â”€ io.max              # I/O ì œí•œ                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="32-cgroups">3.2 cgroups ê¸°ë³¸ ëª…ë ¹<a class="header-link" href="#32-cgroups" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># cgroups v2 í™•ì¸</span>
mount<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>cgroup2
cat<span class="w"> </span>/sys/fs/cgroup/cgroup.controllers
<span class="c1"># cpuset cpu io memory hugetlb pids rdma misc</span>

<span class="c1"># ìƒˆ cgroup ìƒì„±</span>
mkdir<span class="w"> </span>/sys/fs/cgroup/mygroup

<span class="c1"># ì»¨íŠ¸ë¡¤ëŸ¬ í™œì„±í™”</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;+cpu +memory +io&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/cgroup.subtree_control

<span class="c1"># í”„ë¡œì„¸ìŠ¤ ì¶”ê°€</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$$</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/cgroup.procs

<span class="c1"># í”„ë¡œì„¸ìŠ¤ í™•ì¸</span>
cat<span class="w"> </span>/sys/fs/cgroup/mygroup/cgroup.procs

<span class="c1"># cgroup ì‚­ì œ (í”„ë¡œì„¸ìŠ¤ ì—†ì–´ì•¼ í•¨)</span>
rmdir<span class="w"> </span>/sys/fs/cgroup/mygroup
</code></pre></div>

<h3 id="33-cpu">3.3 CPU ì œí•œ<a class="header-link" href="#33-cpu" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># CPU ì œí•œ (quota / period)</span>
<span class="c1"># cpu.max: &quot;quota period&quot; (ë§ˆì´í¬ë¡œì´ˆ)</span>
<span class="c1"># 50% CPU ì œí•œ</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;50000 100000&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/cpu.max

<span class="c1"># íŠ¹ì • CPUë§Œ ì‚¬ìš©</span>
<span class="c1"># cpuset.cpus: ì‚¬ìš©í•  CPU</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;0-1&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/cpuset.cpus

<span class="c1"># CPU ê°€ì¤‘ì¹˜ (1-10000, ê¸°ë³¸ 100)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;50&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/cpu.weight

<span class="c1"># í†µê³„ í™•ì¸</span>
cat<span class="w"> </span>/sys/fs/cgroup/mygroup/cpu.stat
<span class="c1"># usage_usec 12345</span>
<span class="c1"># user_usec 10000</span>
<span class="c1"># system_usec 2345</span>
</code></pre></div>

<h3 id="34">3.4 ë©”ëª¨ë¦¬ ì œí•œ<a class="header-link" href="#34" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë©”ëª¨ë¦¬ ì œí•œ</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;512M&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/memory.max
<span class="c1"># ë˜ëŠ” ë°”ì´íŠ¸ë¡œ</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;536870912&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/memory.max

<span class="c1"># ë©”ëª¨ë¦¬ + swap ì œí•œ</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;1G&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/memory.swap.max

<span class="c1"># OOM ì„¤ì •</span>
<span class="c1"># memory.oom.group: 1ì´ë©´ ê·¸ë£¹ ì „ì²´ kill</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/memory.oom.group

<span class="c1"># í˜„ì¬ ì‚¬ìš©ëŸ‰</span>
cat<span class="w"> </span>/sys/fs/cgroup/mygroup/memory.current
cat<span class="w"> </span>/sys/fs/cgroup/mygroup/memory.stat
</code></pre></div>

<h3 id="35-io">3.5 I/O ì œí•œ<a class="header-link" href="#35-io" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì¥ì¹˜ í™•ì¸</span>
lsblk
<span class="c1"># ì˜ˆ: sda -&gt; 8:0</span>

<span class="c1"># I/O ëŒ€ì—­í­ ì œí•œ (ë°”ì´íŠ¸/ì´ˆ)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;8:0 rbps=10485760 wbps=10485760&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/io.max
<span class="c1"># 10MB/s ì½ê¸°/ì“°ê¸° ì œí•œ</span>

<span class="c1"># IOPS ì œí•œ</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;8:0 riops=1000 wiops=1000&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/io.max

<span class="c1"># I/O ê°€ì¤‘ì¹˜</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;8:0 100&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/fs/cgroup/mygroup/io.weight

<span class="c1"># í†µê³„</span>
cat<span class="w"> </span>/sys/fs/cgroup/mygroup/io.stat
</code></pre></div>

<h3 id="36-systemd-cgroups">3.6 systemdì™€ cgroups<a class="header-link" href="#36-systemd-cgroups" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># systemd-cgls - cgroup íŠ¸ë¦¬ ë³´ê¸°</span>
systemd-cgls

<span class="c1"># íŠ¹ì • ìŠ¬ë¼ì´ìŠ¤</span>
systemd-cgls<span class="w"> </span>/system.slice

<span class="c1"># systemd-cgtop - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</span>
systemd-cgtop

<span class="c1"># ì„œë¹„ìŠ¤ ë¦¬ì†ŒìŠ¤ ì œí•œ (ìœ ë‹› íŒŒì¼)</span>
<span class="c1"># [Service]</span>
<span class="c1"># CPUQuota=50%</span>
<span class="c1"># MemoryMax=512M</span>
<span class="c1"># IOWriteBandwidthMax=/dev/sda 10M</span>

<span class="c1"># ëŸ°íƒ€ì„ì— ì œí•œ ë³€ê²½</span>
systemctl<span class="w"> </span>set-property<span class="w"> </span>nginx.service<span class="w"> </span><span class="nv">CPUQuota</span><span class="o">=</span><span class="m">50</span>%
systemctl<span class="w"> </span>set-property<span class="w"> </span>nginx.service<span class="w"> </span><span class="nv">MemoryMax</span><span class="o">=</span>512M
</code></pre></div>

<hr />
<h2 id="4-union-filesystem">4. Union Filesystem<a class="header-link" href="#4-union-filesystem" title="Permanent link">&para;</a></h2>
<h3 id="41-overlayfs">4.1 OverlayFS ê°œë…<a class="header-link" href="#41-overlayfs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="n">OverlayFS</span><span class="w"> </span><span class="n">êµ¬ì¡°</span><span class="w">                            </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="n">Merged</span><span class="w"> </span><span class="p">(</span><span class="n">í†µí•©</span><span class="w"> </span><span class="n">ë·°</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ì»¨í…Œì´ë„ˆê°€</span><span class="w"> </span><span class="n">ë³´ëŠ”</span><span class="w"> </span><span class="n">íŒŒì¼ì‹œìŠ¤í…œ</span><span class="w">              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">/</span><span class="n">merged</span><span class="w">                                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”‚</span><span class="w">                                                       </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="o">[</span><span class="n">Upperì—ì„œ</span><span class="o">]</span><span class="w">     </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="o">[</span><span class="n">Lowerì—ì„œ</span><span class="o">]</span><span class="w">     </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">     </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="o">[</span><span class="n">Lowerì—ì„œ</span><span class="o">]</span><span class="w">     </span><span class="err">â”‚</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="nf">Upper</span><span class="w"> </span><span class="n">Layer</span><span class="w">      </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">ì“°ê¸°</span><span class="w"> </span><span class="n">ê°€ëŠ¥</span><span class="w"> </span><span class="p">(</span><span class="n">ì»¨í…Œì´ë„ˆ</span><span class="w"> </span><span class="n">ë³€ê²½</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">    </span><span class="o">/</span><span class="nf">upper</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">           </span><span class="err">â†‘</span><span class="w">                                                 </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="nf">Lower</span><span class="w"> </span><span class="n">Layer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â†</span><span class="w"> </span><span class="n">ì½ê¸°</span><span class="w"> </span><span class="n">ì „ìš©</span><span class="w"> </span><span class="p">(</span><span class="n">ì´ë¯¸ì§€</span><span class="w"> </span><span class="n">ë ˆì´ì–´</span><span class="p">)</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="o">/</span><span class="n">lower1</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="o">/</span><span class="n">lower2</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">   </span><span class="o">/</span><span class="n">lower3</span><span class="w">           </span><span class="err">â”‚</span><span class="w">                                    </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="k">Work</span><span class="w"> </span><span class="n">Directory</span><span class="w">                                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">/</span><span class="k">work</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">OverlayFS</span><span class="w"> </span><span class="n">ë‚´ë¶€</span><span class="w"> </span><span class="n">ì‘ì—…ìš©</span><span class="w">                             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                             </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="42-overlayfs">4.2 OverlayFS ì‚¬ìš©<a class="header-link" href="#42-overlayfs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># OverlayFS ë§ˆìš´íŠ¸</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>/lower<span class="w"> </span>/upper<span class="w"> </span>/work<span class="w"> </span>/merged

<span class="c1"># lowerì— ê¸°ë³¸ íŒŒì¼ ìƒì„±</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;from lower&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/lower/file1.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;will be overwritten&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/lower/file2.txt

<span class="c1"># upperì— íŒŒì¼ ìƒì„±</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;from upper&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/upper/file2.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;only in upper&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/upper/file3.txt

<span class="c1"># OverlayFS ë§ˆìš´íŠ¸</span>
mount<span class="w"> </span>-t<span class="w"> </span>overlay<span class="w"> </span>overlay<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="nv">lowerdir</span><span class="o">=</span>/lower,upperdir<span class="o">=</span>/upper,workdir<span class="o">=</span>/work<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>/merged

<span class="c1"># ê²°ê³¼ í™•ì¸</span>
ls<span class="w"> </span>/merged/
<span class="c1"># file1.txt  file2.txt  file3.txt</span>

cat<span class="w"> </span>/merged/file1.txt<span class="w">  </span><span class="c1"># from lower</span>
cat<span class="w"> </span>/merged/file2.txt<span class="w">  </span><span class="c1"># from upper (ë®ì–´ì”€)</span>
cat<span class="w"> </span>/merged/file3.txt<span class="w">  </span><span class="c1"># only in upper</span>

<span class="c1"># ìƒˆ íŒŒì¼ ì“°ê¸°</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;new file&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/merged/file4.txt
ls<span class="w"> </span>/upper/<span class="w">  </span><span class="c1"># file4.txtê°€ upperì— ìƒì„±ë¨</span>

<span class="c1"># íŒŒì¼ ì‚­ì œ (whiteout)</span>
rm<span class="w"> </span>/merged/file1.txt
ls<span class="w"> </span>-la<span class="w"> </span>/upper/
<span class="c1"># c--------- ... file1.txt  (whiteout íŒŒì¼)</span>

<span class="c1"># ì–¸ë§ˆìš´íŠ¸</span>
umount<span class="w"> </span>/merged
</code></pre></div>

<h3 id="43-docker">4.3 Docker ì´ë¯¸ì§€ ë ˆì´ì–´<a class="header-link" href="#43-docker" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Docker ì´ë¯¸ì§€ ë ˆì´ì–´ í™•ì¸</span>
docker<span class="w"> </span>image<span class="w"> </span>inspect<span class="w"> </span>ubuntu:22.04<span class="w"> </span>--format<span class="w"> </span><span class="s1">&#39;{{.RootFS.Layers}}&#39;</span>

<span class="c1"># ë ˆì´ì–´ ì €ì¥ ìœ„ì¹˜</span>
ls<span class="w"> </span>/var/lib/docker/overlay2/

<span class="c1"># íŠ¹ì • ì»¨í…Œì´ë„ˆì˜ ë§ˆìš´íŠ¸ ì •ë³´</span>
docker<span class="w"> </span>inspect<span class="w"> </span>&lt;container_id&gt;<span class="w"> </span>--format<span class="w"> </span><span class="s1">&#39;{{.GraphDriver.Data}}&#39;</span>
<span class="c1"># LowerDir, UpperDir, MergedDir, WorkDir í™•ì¸</span>
</code></pre></div>

<hr />
<h2 id="5">5. ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ëŸ°íƒ€ì„ ê³„ì¸µ<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ê³„ì¸µ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  High-Level Runtime (ì»¨í…Œì´ë„ˆ ì—”ì§„)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Docker Engine / Podman / containerd                â”‚   â”‚
â”‚  â”‚  â€¢ ì´ë¯¸ì§€ ê´€ë¦¬ (pull, push, build)                  â”‚   â”‚
â”‚  â”‚  â€¢ ë„¤íŠ¸ì›Œí‚¹                                          â”‚   â”‚
â”‚  â”‚  â€¢ ë³¼ë¥¨ ê´€ë¦¬                                         â”‚   â”‚
â”‚  â”‚  â€¢ API ì œê³µ                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚  Low-Level Runtime (OCI Runtime)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  runc / crun / kata-containers                      â”‚   â”‚
â”‚  â”‚  â€¢ ì‹¤ì œ ì»¨í…Œì´ë„ˆ ìƒì„±                                â”‚   â”‚
â”‚  â”‚  â€¢ namespace, cgroups ì„¤ì •                          â”‚   â”‚
â”‚  â”‚  â€¢ OCI ìŠ¤í™ ì¤€ìˆ˜                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚  Linux Kernel                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  namespaces, cgroups, seccomp, capabilities        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="52">5.2 ìˆ˜ë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ë§Œë“¤ê¸°<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># manual_container.sh</span>

<span class="c1"># 1. rootfs ì¤€ë¹„</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>/tmp/mycontainer/<span class="o">{</span>rootfs,upper,work,merged<span class="o">}</span>

<span class="c1"># ê¸°ë³¸ rootfs ë‹¤ìš´ë¡œë“œ (Alpine)</span>
curl<span class="w"> </span>-o<span class="w"> </span>/tmp/alpine.tar.gz<span class="w"> </span>https://dl-cdn.alpinelinux.org/alpine/v3.18/releases/x86_64/alpine-minirootfs-3.18.0-x86_64.tar.gz
tar<span class="w"> </span>-xzf<span class="w"> </span>/tmp/alpine.tar.gz<span class="w"> </span>-C<span class="w"> </span>/tmp/mycontainer/rootfs

<span class="c1"># 2. OverlayFS ë§ˆìš´íŠ¸</span>
mount<span class="w"> </span>-t<span class="w"> </span>overlay<span class="w"> </span>overlay<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-o<span class="w"> </span><span class="nv">lowerdir</span><span class="o">=</span>/tmp/mycontainer/rootfs,upperdir<span class="o">=</span>/tmp/mycontainer/upper,workdir<span class="o">=</span>/tmp/mycontainer/work<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>/tmp/mycontainer/merged

<span class="c1"># 3. í•„ìˆ˜ ë§ˆìš´íŠ¸</span>
mount<span class="w"> </span>-t<span class="w"> </span>proc<span class="w"> </span>proc<span class="w"> </span>/tmp/mycontainer/merged/proc
mount<span class="w"> </span>-t<span class="w"> </span>sysfs<span class="w"> </span>sysfs<span class="w"> </span>/tmp/mycontainer/merged/sys
mount<span class="w"> </span>-o<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>/dev<span class="w"> </span>/tmp/mycontainer/merged/dev

<span class="c1"># 4. ìƒˆ namespaceë¡œ chroot</span>
unshare<span class="w"> </span>--mount<span class="w"> </span>--uts<span class="w"> </span>--ipc<span class="w"> </span>--net<span class="w"> </span>--pid<span class="w"> </span>--fork<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>chroot<span class="w"> </span>/tmp/mycontainer/merged<span class="w"> </span>/bin/sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">    hostname mycontainer</span>
<span class="s1">    mount -t proc proc /proc</span>
<span class="s1">    exec /bin/sh</span>
<span class="s1">  &#39;</span>

<span class="c1"># ì •ë¦¬</span>
umount<span class="w"> </span>/tmp/mycontainer/merged/<span class="o">{</span>proc,sys,dev<span class="o">}</span>
umount<span class="w"> </span>/tmp/mycontainer/merged
</code></pre></div>

<h3 id="53-runc">5.3 runc ì‚¬ìš©<a class="header-link" href="#53-runc" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># runc ì„¤ì¹˜</span>
apt<span class="w"> </span>install<span class="w"> </span>runc

<span class="c1"># OCI ë²ˆë“¤ êµ¬ì¡°</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>bundle/rootfs
<span class="nb">cd</span><span class="w"> </span>bundle

<span class="c1"># rootfs ì¤€ë¹„ (Dockerì—ì„œ ì¶”ì¶œ)</span>
docker<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>create<span class="w"> </span>alpine<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tar<span class="w"> </span>-C<span class="w"> </span>rootfs<span class="w"> </span>-xf<span class="w"> </span>-

<span class="c1"># config.json ìƒì„±</span>
runc<span class="w"> </span>spec

<span class="c1"># config.json ìˆ˜ì • (terminal: trueë¡œ ë³€ê²½)</span>

<span class="c1"># ì»¨í…Œì´ë„ˆ ì‹¤í–‰</span>
runc<span class="w"> </span>run<span class="w"> </span>mycontainer

<span class="c1"># ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ</span>
runc<span class="w"> </span>list
runc<span class="w"> </span>state<span class="w"> </span>mycontainer
runc<span class="w"> </span><span class="nb">kill</span><span class="w"> </span>mycontainer
runc<span class="w"> </span>delete<span class="w"> </span>mycontainer
</code></pre></div>

<h3 id="54-rootless">5.4 Rootless ì»¨í…Œì´ë„ˆ<a class="header-link" href="#54-rootless" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Podman rootless</span>
podman<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>alpine<span class="w"> </span>sh

<span class="c1"># ì‚¬ìš©ì namespace ë§¤í•‘ í™•ì¸</span>
cat<span class="w"> </span>/proc/self/uid_map
cat<span class="w"> </span>/proc/self/gid_map

<span class="c1"># subuid/subgid ì„¤ì •</span>
<span class="c1"># /etc/subuid</span>
<span class="c1"># username:100000:65536</span>
<span class="c1"># /etc/subgid</span>
<span class="c1"># username:100000:65536</span>

<span class="c1"># Rootless Docker</span>
dockerd-rootless-setuptool.sh<span class="w"> </span>install
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/home/<span class="nv">$USER</span>/bin:<span class="nv">$PATH</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DOCKER_HOST</span><span class="o">=</span>unix://<span class="nv">$XDG_RUNTIME_DIR</span>/docker.sock
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>hello-world
</code></pre></div>

<hr />
<h2 id="6">6. ë³´ì•ˆ<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-capabilities">6.1 Capabilities<a class="header-link" href="#61-capabilities" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># í”„ë¡œì„¸ìŠ¤ capabilities í™•ì¸</span>
cat<span class="w"> </span>/proc/<span class="nv">$$</span>/status<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Cap
getpcaps<span class="w"> </span><span class="nv">$$</span>

<span class="c1"># Capabilities ëª©ë¡</span>
capsh<span class="w"> </span>--print

<span class="c1"># íŠ¹ì • capabilityë§Œ ë¶€ì—¬</span>
docker<span class="w"> </span>run<span class="w"> </span>--cap-drop<span class="w"> </span>ALL<span class="w"> </span>--cap-add<span class="w"> </span>NET_BIND_SERVICE<span class="w"> </span>nginx

<span class="c1"># ì£¼ìš” capabilities:</span>
<span class="c1"># CAP_NET_ADMIN - ë„¤íŠ¸ì›Œí¬ ì„¤ì •</span>
<span class="c1"># CAP_NET_BIND_SERVICE - 1024 ë¯¸ë§Œ í¬íŠ¸ ë°”ì¸ë”©</span>
<span class="c1"># CAP_SYS_ADMIN - ì‹œìŠ¤í…œ ê´€ë¦¬ (ìœ„í—˜)</span>
<span class="c1"># CAP_SYS_PTRACE - í”„ë¡œì„¸ìŠ¤ ì¶”ì </span>
<span class="c1"># CAP_MKNOD - íŠ¹ìˆ˜ íŒŒì¼ ìƒì„±</span>
</code></pre></div>

<h3 id="62-seccomp">6.2 Seccomp<a class="header-link" href="#62-seccomp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ê¸°ë³¸ seccomp í”„ë¡œíŒŒì¼ í™•ì¸</span>
docker<span class="w"> </span>info<span class="w"> </span>--format<span class="w"> </span><span class="s1">&#39;{{.SecurityOptions}}&#39;</span>

<span class="c1"># ì»¤ìŠ¤í…€ seccomp í”„ë¡œíŒŒì¼</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>seccomp.json<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
<span class="s">{</span>
<span class="s">  &quot;defaultAction&quot;: &quot;SCMP_ACT_ERRNO&quot;,</span>
<span class="s">  &quot;architectures&quot;: [&quot;SCMP_ARCH_X86_64&quot;],</span>
<span class="s">  &quot;syscalls&quot;: [</span>
<span class="s">    {</span>
<span class="s">      &quot;names&quot;: [&quot;read&quot;, &quot;write&quot;, &quot;exit&quot;, &quot;exit_group&quot;],</span>
<span class="s">      &quot;action&quot;: &quot;SCMP_ACT_ALLOW&quot;</span>
<span class="s">    }</span>
<span class="s">  ]</span>
<span class="s">}</span>
<span class="s">EOF</span>

<span class="c1"># í”„ë¡œíŒŒì¼ ì ìš©</span>
docker<span class="w"> </span>run<span class="w"> </span>--security-opt<span class="w"> </span><span class="nv">seccomp</span><span class="o">=</span>seccomp.json<span class="w"> </span>alpine<span class="w"> </span>sh

<span class="c1"># seccomp ì—†ì´ ì‹¤í–‰ (ë¹„ê¶Œì¥)</span>
docker<span class="w"> </span>run<span class="w"> </span>--security-opt<span class="w"> </span><span class="nv">seccomp</span><span class="o">=</span>unconfined<span class="w"> </span>alpine<span class="w"> </span>sh
</code></pre></div>

<h3 id="63-apparmorselinux">6.3 AppArmor/SELinux<a class="header-link" href="#63-apparmorselinux" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># AppArmor ìƒíƒœ</span>
aa-status

<span class="c1"># Docker AppArmor í”„ë¡œíŒŒì¼</span>
cat<span class="w"> </span>/etc/apparmor.d/docker

<span class="c1"># ì»¤ìŠ¤í…€ í”„ë¡œíŒŒì¼ ì ìš©</span>
docker<span class="w"> </span>run<span class="w"> </span>--security-opt<span class="w"> </span><span class="nv">apparmor</span><span class="o">=</span>my-profile<span class="w"> </span>alpine

<span class="c1"># SELinux (RHEL/CentOS)</span>
getenforce
<span class="c1"># docker run --security-opt label=type:my_container_t alpine</span>
</code></pre></div>

<h3 id="64">6.4 ì½ê¸° ì „ìš© ë£¨íŠ¸<a class="header-link" href="#64" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì½ê¸° ì „ìš© ë£¨íŠ¸ íŒŒì¼ì‹œìŠ¤í…œ</span>
docker<span class="w"> </span>run<span class="w"> </span>--read-only<span class="w"> </span>alpine<span class="w"> </span>sh

<span class="c1"># ì„ì‹œ ë””ë ‰í† ë¦¬ í—ˆìš©</span>
docker<span class="w"> </span>run<span class="w"> </span>--read-only<span class="w"> </span>--tmpfs<span class="w"> </span>/tmp<span class="w"> </span>alpine<span class="w"> </span>sh

<span class="c1"># ë³¼ë¥¨ìœ¼ë¡œ ì“°ê¸° í—ˆìš©</span>
docker<span class="w"> </span>run<span class="w"> </span>--read-only<span class="w"> </span>-v<span class="w"> </span>/data<span class="w"> </span>alpine<span class="w"> </span>sh
</code></pre></div>

<hr />
<h2 id="7">7. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="1-namespace">ì—°ìŠµ 1: namespace ì‹¤ìŠµ<a class="header-link" href="#1-namespace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. ëª¨ë“  namespace ìœ í˜•ì„ ì‚¬ìš©í•˜ì—¬ ê²©ë¦¬ëœ í™˜ê²½ ìƒì„±</span>
<span class="c1"># 2. í˜¸ìŠ¤íŠ¸ì™€ ê²©ë¦¬ í™•ì¸ (hostname, PID, network)</span>
<span class="c1"># 3. nsenterë¡œ namespace ì§„ì…</span>

<span class="c1"># ëª…ë ¹ì–´ ì‘ì„±:</span>
</code></pre></div>

<h3 id="2-cgroups">ì—°ìŠµ 2: cgroups ë¦¬ì†ŒìŠ¤ ì œí•œ<a class="header-link" href="#2-cgroups" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. CPU 25% ì œí•œ</span>
<span class="c1"># 2. ë©”ëª¨ë¦¬ 256MB ì œí•œ</span>
<span class="c1"># 3. I/O 1MB/s ì œí•œ</span>
<span class="c1"># 4. stress ë„êµ¬ë¡œ í…ŒìŠ¤íŠ¸</span>

<span class="c1"># ì„¤ì • ë° ëª…ë ¹ì–´ ì‘ì„±:</span>
</code></pre></div>

<h3 id="3">ì—°ìŠµ 3: ìˆ˜ë™ ì»¨í…Œì´ë„ˆ ìƒì„±<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. rootfs ì¤€ë¹„ (Alpine)</span>
<span class="c1"># 2. OverlayFS ì„¤ì •</span>
<span class="c1"># 3. namespace ê²©ë¦¬</span>
<span class="c1"># 4. cgroups ì œí•œ</span>
<span class="c1"># 5. ì‰˜ ì‹¤í–‰</span>

<span class="c1"># ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±:</span>
</code></pre></div>

<h3 id="4">ì—°ìŠµ 4: ë³´ì•ˆ ê°•í™” ì»¨í…Œì´ë„ˆ<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ìš”êµ¬ì‚¬í•­:</span>
<span class="c1"># 1. ìµœì†Œ capabilitiesë§Œ ë¶€ì—¬</span>
<span class="c1"># 2. seccomp í”„ë¡œíŒŒì¼ ì ìš©</span>
<span class="c1"># 3. ì½ê¸° ì „ìš© ë£¨íŠ¸</span>
<span class="c1"># 4. non-root ì‚¬ìš©ì</span>

<span class="c1"># docker run ëª…ë ¹ì–´ ì‘ì„±:</span>
</code></pre></div>

<hr />
<h2 id="_3">ë‹¤ìŒ ë‹¨ê³„<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="16_ì €ì¥ì†Œ_ê´€ë¦¬.md">16_ì €ì¥ì†Œ_ê´€ë¦¬</a> - LVM, RAID</li>
<li><a href="https://docs.docker.com/">Docker ë¬¸ì„œ</a></li>
<li><a href="https://github.com/opencontainers/runtime-spec">OCI Runtime Spec</a></li>
</ul>
<h2 id="_4">ì°¸ê³  ìë£Œ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://man7.org/linux/man-pages/man7/namespaces.7.html">Linux Namespaces</a></li>
<li><a href="https://docs.kernel.org/admin-guide/cgroup-v2.html">cgroups v2</a></li>
<li><a href="https://docs.kernel.org/filesystems/overlayfs.html">OverlayFS</a></li>
<li><a href="https://github.com/opencontainers/runc">runc</a></li>
<li><a href="https://docs.docker.com/engine/security/">Container Security</a></li>
</ul>
<hr />
<p><a href="14_ì„±ëŠ¥_íŠœë‹.md">â† ì´ì „: ì„±ëŠ¥ íŠœë‹</a> | <a href="16_ì €ì¥ì†Œ_ê´€ë¦¬.md">ë‹¤ìŒ: ì €ì¥ì†Œ ê´€ë¦¬ â†’</a> | <a href="00_Overview.md">ëª©ì°¨</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Linux/14_Performance_Tuning.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">14. Linux ì„±ëŠ¥ íŠœë‹</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Linux/16_Storage_Management.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">16. ì €ì¥ì†Œ ê´€ë¦¬</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}