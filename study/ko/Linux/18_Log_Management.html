{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œê·¸ ê´€ë¦¬ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Linux/">Linux</a>
    <span class="separator">/</span>
    <span class="current">ë¡œê·¸ ê´€ë¦¬</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ë¡œê·¸ ê´€ë¦¬</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Linux/17_SELinux_AppArmor.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">SELinuxì™€ AppArmor</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Linux/19_Backup_Recovery.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë°±ì—… ë° ë³µêµ¬</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_3">ëª©ì°¨</a></li>
<li><a href="#1-linux">1. Linux ë¡œê·¸ ì‹œìŠ¤í…œ ê°œìš”</a><ul>
<li><a href="#_4">ë¡œê·¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</a></li>
<li><a href="#_5">ì£¼ìš” ë¡œê·¸ íŒŒì¼</a></li>
<li><a href="#severity">ë¡œê·¸ ìš°ì„ ìˆœìœ„ (Severity)</a></li>
</ul>
</li>
<li><a href="#2-systemd-journald">2. systemd-journald</a><ul>
<li><a href="#journald">journald ì„¤ì •</a></li>
<li><a href="#_6">ì˜êµ¬ ì €ì¥ í™œì„±í™”</a></li>
<li><a href="#_7">ì €ë„ ìƒíƒœ í™•ì¸</a></li>
</ul>
</li>
<li><a href="#3-journalctl">3. journalctl ê³ ê¸‰ ì‚¬ìš©ë²•</a><ul>
<li><a href="#_8">ê¸°ë³¸ ì¡°íšŒ</a></li>
<li><a href="#_9">ì‹œê°„ ê¸°ë°˜ í•„í„°ë§</a></li>
<li><a href="#_10">ì„œë¹„ìŠ¤/ìœ ë‹› í•„í„°ë§</a></li>
<li><a href="#_11">ìš°ì„ ìˆœìœ„ í•„í„°ë§</a></li>
<li><a href="#_12">ì¶œë ¥ í˜•ì‹</a></li>
<li><a href="#_13">ë³µí•© ì¿¼ë¦¬</a></li>
<li><a href="#_14">ì €ë„ ìœ ì§€ë³´ìˆ˜</a></li>
</ul>
</li>
<li><a href="#4-rsyslog">4. rsyslog ì„¤ì •</a><ul>
<li><a href="#rsyslog">rsyslog ê¸°ë³¸ ì„¤ì •</a></li>
<li><a href="#_15">í•„í„° ë¬¸ë²•</a></li>
<li><a href="#_16">ê³ ê¸‰ í•„í„°ë§</a></li>
<li><a href="#_17">í…œí”Œë¦¿ ì‚¬ìš©</a></li>
<li><a href="#_18">ì¡°ê±´ë¶€ ì²˜ë¦¬</a></li>
</ul>
</li>
<li><a href="#5-logrotate">5. logrotate</a><ul>
<li><a href="#_19">ê¸°ë³¸ ì„¤ì •</a></li>
<li><a href="#_20">ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ì„¤ì •</a></li>
<li><a href="#_21">ê³ ê¸‰ ì˜µì…˜</a></li>
<li><a href="#logrotate">logrotate í…ŒìŠ¤íŠ¸</a></li>
</ul>
</li>
<li><a href="#6">6. ì›ê²© ë¡œê·¸ ìˆ˜ì§‘</a><ul>
<li><a href="#rsyslog_1">rsyslog ì„œë²„ ì„¤ì •</a></li>
<li><a href="#rsyslog_2">rsyslog í´ë¼ì´ì–¸íŠ¸ ì„¤ì •</a></li>
<li><a href="#tls">TLS ì•”í˜¸í™” ì„¤ì •</a></li>
<li><a href="#_22">ë°©í™”ë²½ ì„¤ì •</a></li>
</ul>
</li>
<li><a href="#7">7. ë¡œê·¸ ë¶„ì„ ë„êµ¬</a><ul>
<li><a href="#lnav-log-navigator">lnav (Log Navigator)</a></li>
<li><a href="#multitail">multitail</a></li>
<li><a href="#goaccess">GoAccess (ì›¹ ë¡œê·¸ ë¶„ì„)</a></li>
<li><a href="#_23">ê°„ë‹¨í•œ ë¶„ì„ ëª…ë ¹ì–´</a></li>
</ul>
</li>
<li><a href="#_24">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-journalctl">ë¬¸ì œ 1: journalctl ì¿¼ë¦¬</a></li>
<li><a href="#2-rsyslog">ë¬¸ì œ 2: rsyslog í•„í„°</a></li>
<li><a href="#3-logrotate">ë¬¸ì œ 3: logrotate ì„¤ì •</a></li>
</ul>
</li>
<li><a href="#_25">ì •ë‹µ</a><ul>
<li><a href="#1">ë¬¸ì œ 1 ì •ë‹µ</a></li>
<li><a href="#2">ë¬¸ì œ 2 ì •ë‹µ</a></li>
<li><a href="#3">ë¬¸ì œ 3 ì •ë‹µ</a></li>
</ul>
</li>
<li><a href="#_26">ë‹¤ìŒ ë‹¨ê³„</a></li>
<li><a href="#_27">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">ë¡œê·¸ ê´€ë¦¬<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>ì´ ë¬¸ì„œë¥¼ í†µí•´ ë‹¤ìŒì„ í•™ìŠµí•©ë‹ˆë‹¤:</p>
<ul>
<li>systemd-journaldì˜ ì„¤ì •ê³¼ í™œìš©</li>
<li>rsyslog ì„¤ì • ë° í•„í„°ë§</li>
<li>logrotateë¥¼ í†µí•œ ë¡œê·¸ ìˆœí™˜</li>
<li>ì›ê²© ë¡œê·¸ ìˆ˜ì§‘ êµ¬ì„±</li>
</ul>
<p><strong>ë‚œì´ë„</strong>: â­â­â­ (ì¤‘ê¸‰-ê³ ê¸‰)</p>
<hr />
<h2 id="_3">ëª©ì°¨<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-linux-ë¡œê·¸-ì‹œìŠ¤í…œ-ê°œìš”">Linux ë¡œê·¸ ì‹œìŠ¤í…œ ê°œìš”</a></li>
<li><a href="#2-systemd-journald">systemd-journald</a></li>
<li><a href="#3-journalctl-ê³ ê¸‰-ì‚¬ìš©ë²•">journalctl ê³ ê¸‰ ì‚¬ìš©ë²•</a></li>
<li><a href="#4-rsyslog-ì„¤ì •">rsyslog ì„¤ì •</a></li>
<li><a href="#5-logrotate">logrotate</a></li>
<li><a href="#6-ì›ê²©-ë¡œê·¸-ìˆ˜ì§‘">ì›ê²© ë¡œê·¸ ìˆ˜ì§‘</a></li>
<li><a href="#7-ë¡œê·¸-ë¶„ì„-ë„êµ¬">ë¡œê·¸ ë¶„ì„ ë„êµ¬</a></li>
</ol>
<hr />
<h2 id="1-linux">1. Linux ë¡œê·¸ ì‹œìŠ¤í…œ ê°œìš”<a class="header-link" href="#1-linux" title="Permanent link">&para;</a></h2>
<h3 id="_4">ë¡œê·¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">                    </span><span class="err">ì• í”Œë¦¬ì¼€ì´ì…˜</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="err">ì„œë¹„ìŠ¤</span><span class="w">                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="w">                </span><span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="w">                </span><span class="err">â–¼</span><span class="w">                         </span><span class="err">â–¼</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">    </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="w">       </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">    </span><span class="n">rsyslog</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">syslog</span><span class="o">-</span><span class="n">ng</span><span class="w">      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">    </span><span class="p">(</span><span class="err">ë°”ì´ë„ˆë¦¬</span><span class="w"> </span><span class="err">ì €ë„</span><span class="p">)</span><span class="w">         </span><span class="err">â”‚â”€â”€â–¶â”‚</span><span class="w">    </span><span class="p">(</span><span class="err">í…ìŠ¤íŠ¸</span><span class="w"> </span><span class="err">ë¡œê·¸</span><span class="w"> </span><span class="err">íŒŒì¼</span><span class="p">)</span><span class="w">        </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="w">                </span><span class="err">â”‚</span><span class="w">                         </span><span class="err">â”‚</span>
<span class="w">                </span><span class="err">â–¼</span><span class="w">                         </span><span class="err">â–¼</span>
<span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span><span class="w">        </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/*.</span><span class="n">log</span><span class="w">             </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span><span class="w">        </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span><span class="w">  </span><span class="err">ì›ê²©</span><span class="w"> </span><span class="err">ì„œë²„</span><span class="w">                   </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="_5">ì£¼ìš” ë¡œê·¸ íŒŒì¼<a class="header-link" href="#_5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>íŒŒì¼</th>
<th>ë‚´ìš©</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/var/log/messages</code></td>
<td>ì¼ë°˜ ì‹œìŠ¤í…œ ë©”ì‹œì§€ (RHEL/CentOS)</td>
</tr>
<tr>
<td><code>/var/log/syslog</code></td>
<td>ì¼ë°˜ ì‹œìŠ¤í…œ ë©”ì‹œì§€ (Ubuntu/Debian)</td>
</tr>
<tr>
<td><code>/var/log/auth.log</code></td>
<td>ì¸ì¦ ê´€ë ¨ ë¡œê·¸ (Ubuntu)</td>
</tr>
<tr>
<td><code>/var/log/secure</code></td>
<td>ì¸ì¦ ê´€ë ¨ ë¡œê·¸ (RHEL)</td>
</tr>
<tr>
<td><code>/var/log/kern.log</code></td>
<td>ì»¤ë„ ë©”ì‹œì§€</td>
</tr>
<tr>
<td><code>/var/log/dmesg</code></td>
<td>ë¶€íŒ… ì‹œ ì»¤ë„ ë©”ì‹œì§€</td>
</tr>
<tr>
<td><code>/var/log/cron</code></td>
<td>í¬ë¡  ì‘ì—… ë¡œê·¸</td>
</tr>
<tr>
<td><code>/var/log/maillog</code></td>
<td>ë©”ì¼ ì„œë²„ ë¡œê·¸</td>
</tr>
</tbody>
</table>
<h3 id="severity">ë¡œê·¸ ìš°ì„ ìˆœìœ„ (Severity)<a class="header-link" href="#severity" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ë ˆë²¨</th>
<th>ì´ë¦„</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>emerg</td>
<td>ì‹œìŠ¤í…œ ì‚¬ìš© ë¶ˆê°€</td>
</tr>
<tr>
<td>1</td>
<td>alert</td>
<td>ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš”</td>
</tr>
<tr>
<td>2</td>
<td>crit</td>
<td>ì‹¬ê°í•œ ì˜¤ë¥˜</td>
</tr>
<tr>
<td>3</td>
<td>err</td>
<td>ì—ëŸ¬</td>
</tr>
<tr>
<td>4</td>
<td>warning</td>
<td>ê²½ê³ </td>
</tr>
<tr>
<td>5</td>
<td>notice</td>
<td>ì •ìƒì´ì§€ë§Œ ì£¼ëª©í•  ë§Œí•œ ìƒí™©</td>
</tr>
<tr>
<td>6</td>
<td>info</td>
<td>ì •ë³´ì„± ë©”ì‹œì§€</td>
</tr>
<tr>
<td>7</td>
<td>debug</td>
<td>ë””ë²„ê·¸ ë©”ì‹œì§€</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-systemd-journald">2. systemd-journald<a class="header-link" href="#2-systemd-journald" title="Permanent link">&para;</a></h2>
<h3 id="journald">journald ì„¤ì •<a class="header-link" href="#journald" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì„¤ì • íŒŒì¼</span>
sudo<span class="w"> </span>vi<span class="w"> </span>/etc/systemd/journald.conf
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># /etc/systemd/journald.conf</span>
<span class="k">[Journal]</span>
<span class="c1"># ì €ì¥ ë°©ì‹: volatile(ë©”ëª¨ë¦¬), persistent(ë””ìŠ¤í¬), auto, none</span>
<span class="na">Storage</span><span class="o">=</span><span class="s">persistent</span>

<span class="c1"># ìµœëŒ€ í¬ê¸° (ë””ìŠ¤í¬ ì €ì¥ ì‹œ)</span>
<span class="na">SystemMaxUse</span><span class="o">=</span><span class="s">500M</span>
<span class="na">SystemKeepFree</span><span class="o">=</span><span class="s">1G</span>
<span class="na">SystemMaxFileSize</span><span class="o">=</span><span class="s">50M</span>
<span class="na">SystemMaxFiles</span><span class="o">=</span><span class="s">100</span>

<span class="c1"># ëŸ°íƒ€ì„ ì €ì¥ì†Œ (ë©”ëª¨ë¦¬)</span>
<span class="na">RuntimeMaxUse</span><span class="o">=</span><span class="s">50M</span>

<span class="c1"># ë¡œê·¸ ì••ì¶•</span>
<span class="na">Compress</span><span class="o">=</span><span class="s">yes</span>

<span class="c1"># ë´‰ì¸ (tamper-evident)</span>
<span class="na">Seal</span><span class="o">=</span><span class="s">yes</span>

<span class="c1"># rsyslogë¡œ ì „ë‹¬</span>
<span class="na">ForwardToSyslog</span><span class="o">=</span><span class="s">yes</span>

<span class="c1"># ì½˜ì†” ì¶œë ¥</span>
<span class="na">ForwardToConsole</span><span class="o">=</span><span class="s">no</span>

<span class="c1"># ìµœëŒ€ ë³´ì¡´ ê¸°ê°„</span>
<span class="na">MaxRetentionSec</span><span class="o">=</span><span class="s">1month</span>

<span class="c1"># ì†ë„ ì œí•œ</span>
<span class="na">RateLimitIntervalSec</span><span class="o">=</span><span class="s">30s</span>
<span class="na">RateLimitBurst</span><span class="o">=</span><span class="s">10000</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># ì„¤ì • ì ìš©</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>systemd-journald
</code></pre></div>

<h3 id="_6">ì˜êµ¬ ì €ì¥ í™œì„±í™”<a class="header-link" href="#_6" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì €ë„ ë””ë ‰í† ë¦¬ ìƒì„± (persistent storage)</span>
sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/log/journal
sudo<span class="w"> </span>systemd-tmpfiles<span class="w"> </span>--create<span class="w"> </span>--prefix<span class="w"> </span>/var/log/journal

<span class="c1"># ê¶Œí•œ ì„¤ì •</span>
sudo<span class="w"> </span>chown<span class="w"> </span>root:systemd-journal<span class="w"> </span>/var/log/journal
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">2755</span><span class="w"> </span>/var/log/journal

<span class="c1"># journald ì¬ì‹œì‘</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>systemd-journald
</code></pre></div>

<h3 id="_7">ì €ë„ ìƒíƒœ í™•ì¸<a class="header-link" href="#_7" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰</span>
journalctl<span class="w"> </span>--disk-usage

<span class="c1"># ì €ë„ íŒŒì¼ í™•ì¸</span>
journalctl<span class="w"> </span>--header

<span class="c1"># ì €ë„ ë¬´ê²°ì„± ê²€ì¦</span>
journalctl<span class="w"> </span>--verify
</code></pre></div>

<hr />
<h2 id="3-journalctl">3. journalctl ê³ ê¸‰ ì‚¬ìš©ë²•<a class="header-link" href="#3-journalctl" title="Permanent link">&para;</a></h2>
<h3 id="_8">ê¸°ë³¸ ì¡°íšŒ<a class="header-link" href="#_8" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ëª¨ë“  ë¡œê·¸</span>
journalctl

<span class="c1"># ì—­ìˆœ (ìµœì‹  ë¨¼ì €)</span>
journalctl<span class="w"> </span>-r

<span class="c1"># ì‹¤ì‹œê°„ íŒ”ë¡œìš°</span>
journalctl<span class="w"> </span>-f

<span class="c1"># ë§ˆì§€ë§‰ Nì¤„</span>
journalctl<span class="w"> </span>-n<span class="w"> </span><span class="m">50</span>

<span class="c1"># í˜ì´ì € ì—†ì´ ì¶œë ¥</span>
journalctl<span class="w"> </span>--no-pager
</code></pre></div>

<h3 id="_9">ì‹œê°„ ê¸°ë°˜ í•„í„°ë§<a class="header-link" href="#_9" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì˜¤ëŠ˜ ë¡œê·¸</span>
journalctl<span class="w"> </span>--since<span class="w"> </span>today

<span class="c1"># ì–´ì œ ë¡œê·¸</span>
journalctl<span class="w"> </span>--since<span class="w"> </span>yesterday<span class="w"> </span>--until<span class="w"> </span>today

<span class="c1"># íŠ¹ì • ì‹œê°„ ë²”ìœ„</span>
journalctl<span class="w"> </span>--since<span class="w"> </span><span class="s2">&quot;2024-01-15 10:00:00&quot;</span><span class="w"> </span>--until<span class="w"> </span><span class="s2">&quot;2024-01-15 12:00:00&quot;</span>

<span class="c1"># ìƒëŒ€ì  ì‹œê°„</span>
journalctl<span class="w"> </span>--since<span class="w"> </span><span class="s2">&quot;1 hour ago&quot;</span>
journalctl<span class="w"> </span>--since<span class="w"> </span><span class="s2">&quot;30 minutes ago&quot;</span>

<span class="c1"># ë¶€íŒ… ê´€ë ¨</span>
journalctl<span class="w"> </span>-b<span class="w">          </span><span class="c1"># í˜„ì¬ ë¶€íŒ…</span>
journalctl<span class="w"> </span>-b<span class="w"> </span>-1<span class="w">       </span><span class="c1"># ì´ì „ ë¶€íŒ…</span>
journalctl<span class="w"> </span>--list-boots<span class="w"> </span><span class="c1"># ë¶€íŒ… ëª©ë¡</span>
</code></pre></div>

<h3 id="_10">ì„œë¹„ìŠ¤/ìœ ë‹› í•„í„°ë§<a class="header-link" href="#_10" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># íŠ¹ì • ì„œë¹„ìŠ¤</span>
journalctl<span class="w"> </span>-u<span class="w"> </span>nginx.service
journalctl<span class="w"> </span>-u<span class="w"> </span>nginx<span class="w"> </span>-u<span class="w"> </span>php-fpm

<span class="c1"># ì»¤ë„ ë©”ì‹œì§€</span>
journalctl<span class="w"> </span>-k

<span class="c1"># íŠ¹ì • PID</span>
journalctl<span class="w"> </span><span class="nv">_PID</span><span class="o">=</span><span class="m">1234</span>

<span class="c1"># íŠ¹ì • ì‹¤í–‰ íŒŒì¼</span>
journalctl<span class="w"> </span>/usr/bin/bash

<span class="c1"># íŠ¹ì • ì‚¬ìš©ì</span>
journalctl<span class="w"> </span><span class="nv">_UID</span><span class="o">=</span><span class="m">1000</span>
</code></pre></div>

<h3 id="_11">ìš°ì„ ìˆœìœ„ í•„í„°ë§<a class="header-link" href="#_11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì—ëŸ¬ ì´ìƒ</span>
journalctl<span class="w"> </span>-p<span class="w"> </span>err

<span class="c1"># ê²½ê³  ì´ìƒ</span>
journalctl<span class="w"> </span>-p<span class="w"> </span>warning

<span class="c1"># ë²”ìœ„ ì§€ì •</span>
journalctl<span class="w"> </span>-p<span class="w"> </span>err..crit

<span class="c1"># ìˆ«ìë¡œ ì§€ì •</span>
journalctl<span class="w"> </span>-p<span class="w"> </span><span class="m">3</span>
</code></pre></div>

<h3 id="_12">ì¶œë ¥ í˜•ì‹<a class="header-link" href="#_12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># JSON í˜•ì‹</span>
journalctl<span class="w"> </span>-o<span class="w"> </span>json
journalctl<span class="w"> </span>-o<span class="w"> </span>json-pretty

<span class="c1"># ìƒì„¸ ì¶œë ¥</span>
journalctl<span class="w"> </span>-o<span class="w"> </span>verbose

<span class="c1"># ê°„ë‹¨í•œ ì¶œë ¥</span>
journalctl<span class="w"> </span>-o<span class="w"> </span>short
journalctl<span class="w"> </span>-o<span class="w"> </span>short-precise<span class="w">  </span><span class="c1"># ë§ˆì´í¬ë¡œì´ˆ í¬í•¨</span>

<span class="c1"># cat ìŠ¤íƒ€ì¼ (ë©”ì‹œì§€ë§Œ)</span>
journalctl<span class="w"> </span>-o<span class="w"> </span>cat

<span class="c1"># ë‚´ë³´ë‚´ê¸° í˜•ì‹</span>
journalctl<span class="w"> </span>-o<span class="w"> </span><span class="nb">export</span>
</code></pre></div>

<h3 id="_13">ë³µí•© ì¿¼ë¦¬<a class="header-link" href="#_13" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì¡°í•© (AND)</span>
journalctl<span class="w"> </span>-u<span class="w"> </span>nginx<span class="w"> </span>-p<span class="w"> </span>err<span class="w"> </span>--since<span class="w"> </span>today

<span class="c1"># ì»¤ìŠ¤í…€ í•„ë“œ</span>
journalctl<span class="w"> </span><span class="nv">_SYSTEMD_UNIT</span><span class="o">=</span>sshd.service<span class="w"> </span><span class="nv">_PID</span><span class="o">=</span><span class="m">1234</span>

<span class="c1"># ë©”ì‹œì§€ ê²€ìƒ‰</span>
journalctl<span class="w"> </span>-g<span class="w"> </span><span class="s2">&quot;error|fail|critical&quot;</span>

<span class="c1"># í•„ë“œ ëª©ë¡ ë³´ê¸°</span>
journalctl<span class="w"> </span>-F<span class="w"> </span>_SYSTEMD_UNIT
journalctl<span class="w"> </span>-F<span class="w"> </span>PRIORITY
</code></pre></div>

<h3 id="_14">ì €ë„ ìœ ì§€ë³´ìˆ˜<a class="header-link" href="#_14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì˜¤ë˜ëœ ë¡œê·¸ ì‚­ì œ (ì‹œê°„ ê¸°ì¤€)</span>
sudo<span class="w"> </span>journalctl<span class="w"> </span>--vacuum-time<span class="o">=</span>30d

<span class="c1"># ì˜¤ë˜ëœ ë¡œê·¸ ì‚­ì œ (í¬ê¸° ê¸°ì¤€)</span>
sudo<span class="w"> </span>journalctl<span class="w"> </span>--vacuum-size<span class="o">=</span>500M

<span class="c1"># íŒŒì¼ ìˆ˜ ê¸°ì¤€ ì‚­ì œ</span>
sudo<span class="w"> </span>journalctl<span class="w"> </span>--vacuum-files<span class="o">=</span><span class="m">10</span>

<span class="c1"># ëª¨ë“  ì €ë„ ì‚­ì œ</span>
sudo<span class="w"> </span>journalctl<span class="w"> </span>--rotate
sudo<span class="w"> </span>journalctl<span class="w"> </span>--vacuum-time<span class="o">=</span>1s
</code></pre></div>

<hr />
<h2 id="4-rsyslog">4. rsyslog ì„¤ì •<a class="header-link" href="#4-rsyslog" title="Permanent link">&para;</a></h2>
<h3 id="rsyslog">rsyslog ê¸°ë³¸ ì„¤ì •<a class="header-link" href="#rsyslog" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë©”ì¸ ì„¤ì • íŒŒì¼</span>
sudo<span class="w"> </span>vi<span class="w"> </span>/etc/rsyslog.conf
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># /etc/rsyslog.conf (ì£¼ìš” ì„¹ì…˜)</span>

<span class="c1"># ëª¨ë“ˆ ë¡œë“œ</span>
module<span class="o">(</span><span class="nv">load</span><span class="o">=</span><span class="s2">&quot;imuxsock&quot;</span><span class="o">)</span><span class="w">    </span><span class="c1"># ë¡œì»¬ ì‹œìŠ¤í…œ ë¡œê·¸</span>
module<span class="o">(</span><span class="nv">load</span><span class="o">=</span><span class="s2">&quot;imjournal&quot;</span><span class="o">)</span><span class="w">   </span><span class="c1"># journald í†µí•©</span>
module<span class="o">(</span><span class="nv">load</span><span class="o">=</span><span class="s2">&quot;imklog&quot;</span><span class="o">)</span><span class="w">      </span><span class="c1"># ì»¤ë„ ë¡œê·¸</span>

<span class="c1"># ì „ì—­ ì„¤ì •</span>
global<span class="o">(</span>
<span class="w">    </span><span class="nv">workDirectory</span><span class="o">=</span><span class="s2">&quot;/var/lib/rsyslog&quot;</span>
<span class="w">    </span><span class="nv">maxMessageSize</span><span class="o">=</span><span class="s2">&quot;64k&quot;</span>
<span class="o">)</span>

<span class="c1"># ê¸°ë³¸ ê·œì¹™</span>
*.info<span class="p">;</span>mail.none<span class="p">;</span>authpriv.none<span class="p">;</span>cron.none<span class="w">    </span>/var/log/messages
authpriv.*<span class="w">                                   </span>/var/log/secure
mail.*<span class="w">                                       </span>-/var/log/maillog
cron.*<span class="w">                                       </span>/var/log/cron
*.emerg<span class="w">                                      </span>:omusrmsg:*
</code></pre></div>

<h3 id="_15">í•„í„° ë¬¸ë²•<a class="header-link" href="#_15" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ê¸°ë³¸ ë¬¸ë²•: facility.priority  action</span>

<span class="c1"># facility: auth, authpriv, cron, daemon, kern, mail, user, local0-7, *</span>
<span class="c1"># priority: emerg, alert, crit, err, warning, notice, info, debug, none, *</span>

<span class="c1"># ì˜ˆì‹œ</span>
kern.*<span class="w">                      </span>/var/log/kern.log<span class="w">        </span><span class="c1"># ëª¨ë“  ì»¤ë„ ë©”ì‹œì§€</span>
*.crit<span class="w">                      </span>/var/log/critical.log<span class="w">    </span><span class="c1"># ëª¨ë“  ì‹¬ê°í•œ ì—ëŸ¬</span>
mail.err<span class="w">                    </span>/var/log/mail-err.log<span class="w">    </span><span class="c1"># ë©”ì¼ ì—ëŸ¬</span>
*.info<span class="p">;</span>mail.none<span class="w">            </span>/var/log/messages<span class="w">        </span><span class="c1"># info ì´ìƒ, ë©”ì¼ ì œì™¸</span>
</code></pre></div>

<h3 id="_16">ê³ ê¸‰ í•„í„°ë§<a class="header-link" href="#_16" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/rsyslog.d/custom.conf</span>

<span class="c1"># ì†ì„± ê¸°ë°˜ í•„í„°</span>
:programname,<span class="w"> </span>isequal,<span class="w"> </span><span class="s2">&quot;nginx&quot;</span><span class="w"> </span>/var/log/nginx/access.log
:programname,<span class="w"> </span>startswith,<span class="w"> </span><span class="s2">&quot;postfix&quot;</span><span class="w"> </span>/var/log/mail/postfix.log

<span class="c1"># ë©”ì‹œì§€ ë‚´ìš© ê¸°ë°˜</span>
:msg,<span class="w"> </span>contains,<span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="w"> </span>/var/log/errors.log
:msg,<span class="w"> </span>regex,<span class="w"> </span><span class="s2">&quot;failed.*authentication&quot;</span><span class="w"> </span>/var/log/auth-failures.log

<span class="c1"># ë³µí•© ì¡°ê±´</span>
<span class="k">if</span><span class="w"> </span><span class="nv">$programname</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;sshd&#39;</span><span class="w"> </span>and<span class="w"> </span><span class="nv">$msg</span><span class="w"> </span>contains<span class="w"> </span><span class="s1">&#39;Failed&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>action<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;omfile&quot;</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;/var/log/ssh-failures.log&quot;</span><span class="o">)</span>
<span class="w">    </span>stop
<span class="o">}</span>
</code></pre></div>

<h3 id="_17">í…œí”Œë¦¿ ì‚¬ìš©<a class="header-link" href="#_17" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì»¤ìŠ¤í…€ ë¡œê·¸ í˜•ì‹</span>
template<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;CustomFormat&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="nv">string</span><span class="o">=</span><span class="s2">&quot;%timegenerated% %HOSTNAME% %syslogtag%%msg%\n&quot;</span><span class="o">)</span>

<span class="c1"># JSON í˜•ì‹</span>
template<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;JsonFormat&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;list&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>constant<span class="o">(</span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;{&quot;</span><span class="o">)</span>
<span class="w">    </span>constant<span class="o">(</span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;\&quot;timestamp\&quot;:\&quot;&quot;</span><span class="o">)</span><span class="w">     </span>property<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;timereported&quot;</span><span class="w"> </span><span class="nv">dateFormat</span><span class="o">=</span><span class="s2">&quot;rfc3339&quot;</span><span class="o">)</span>
<span class="w">    </span>constant<span class="o">(</span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;\&quot;,\&quot;host\&quot;:\&quot;&quot;</span><span class="o">)</span><span class="w">       </span>property<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;hostname&quot;</span><span class="o">)</span>
<span class="w">    </span>constant<span class="o">(</span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;\&quot;,\&quot;program\&quot;:\&quot;&quot;</span><span class="o">)</span><span class="w">    </span>property<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;programname&quot;</span><span class="o">)</span>
<span class="w">    </span>constant<span class="o">(</span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;\&quot;,\&quot;severity\&quot;:\&quot;&quot;</span><span class="o">)</span><span class="w">   </span>property<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;syslogseverity-text&quot;</span><span class="o">)</span>
<span class="w">    </span>constant<span class="o">(</span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;\&quot;,\&quot;message\&quot;:\&quot;&quot;</span><span class="o">)</span><span class="w">    </span>property<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;msg&quot;</span><span class="w"> </span><span class="nv">format</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="o">)</span>
<span class="w">    </span>constant<span class="o">(</span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;\&quot;}\n&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1"># í…œí”Œë¦¿ ì ìš©</span>
*.*<span class="w"> </span>action<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;omfile&quot;</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;/var/log/json.log&quot;</span><span class="w"> </span><span class="nv">template</span><span class="o">=</span><span class="s2">&quot;JsonFormat&quot;</span><span class="o">)</span>
</code></pre></div>

<h3 id="_18">ì¡°ê±´ë¶€ ì²˜ë¦¬<a class="header-link" href="#_18" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># RainerScript ë¬¸ë²•</span>
<span class="k">if</span><span class="w"> </span><span class="nv">$programname</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;nginx&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">$syslogseverity</span><span class="w"> </span>&lt;<span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="c1"># ì—ëŸ¬ ì´ìƒì€ ë³„ë„ íŒŒì¼</span>
<span class="w">        </span>action<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;omfile&quot;</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;/var/log/nginx/error.log&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="o">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="c1"># ë‚˜ë¨¸ì§€ëŠ” ì¼ë°˜ ë¡œê·¸</span>
<span class="w">        </span>action<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;omfile&quot;</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;/var/log/nginx/access.log&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span>stop
<span class="o">}</span>
</code></pre></div>

<hr />
<h2 id="5-logrotate">5. logrotate<a class="header-link" href="#5-logrotate" title="Permanent link">&para;</a></h2>
<h3 id="_19">ê¸°ë³¸ ì„¤ì •<a class="header-link" href="#_19" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì „ì—­ ì„¤ì •</span>
sudo<span class="w"> </span>vi<span class="w"> </span>/etc/logrotate.conf
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># /etc/logrotate.conf</span>

<span class="c1"># ìˆœí™˜ ì£¼ê¸°: daily, weekly, monthly</span>
weekly

<span class="c1"># ë³´ê´€í•  ë¡œê·¸ ìˆ˜</span>
rotate<span class="w"> </span><span class="m">4</span>

<span class="c1"># ìƒˆ ë¡œê·¸ íŒŒì¼ ìƒì„±</span>
create

<span class="c1"># ë‚ ì§œ í™•ì¥ì ì‚¬ìš©</span>
dateext

<span class="c1"># ì••ì¶•</span>
compress
delaycompress

<span class="c1"># ë¹ˆ ë¡œê·¸ íŒŒì¼ ë¬´ì‹œ</span>
notifempty

<span class="c1"># ê°œë³„ ì„¤ì • í¬í•¨</span>
include<span class="w"> </span>/etc/logrotate.d
</code></pre></div>

<h3 id="_20">ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ì„¤ì •<a class="header-link" href="#_20" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/logrotate.d/nginx</span>
/var/log/nginx/*.log<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>daily
<span class="w">    </span>missingok
<span class="w">    </span>rotate<span class="w"> </span><span class="m">14</span>
<span class="w">    </span>compress
<span class="w">    </span>delaycompress
<span class="w">    </span>notifempty
<span class="w">    </span>create<span class="w"> </span><span class="m">0640</span><span class="w"> </span>www-data<span class="w"> </span>adm
<span class="w">    </span>sharedscripts
<span class="w">    </span>postrotate
<span class="w">        </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>/var/run/nginx.pid<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-USR1<span class="w"> </span><span class="sb">`</span>cat<span class="w"> </span>/var/run/nginx.pid<span class="sb">`</span>
<span class="w">    </span>endscript
<span class="o">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># /etc/logrotate.d/mysql</span>
/var/log/mysql/*.log<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>daily
<span class="w">    </span>rotate<span class="w"> </span><span class="m">7</span>
<span class="w">    </span>missingok
<span class="w">    </span>create<span class="w"> </span><span class="m">640</span><span class="w"> </span>mysql<span class="w"> </span>adm
<span class="w">    </span>compress
<span class="w">    </span>sharedscripts
<span class="w">    </span>postrotate
<span class="w">        </span><span class="nb">test</span><span class="w"> </span>-x<span class="w"> </span>/usr/bin/mysqladmin<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>/root/.my.cnf<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>/usr/bin/mysqladmin<span class="w"> </span>flush-logs
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span>endscript
<span class="o">}</span>
</code></pre></div>

<h3 id="_21">ê³ ê¸‰ ì˜µì…˜<a class="header-link" href="#_21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/logrotate.d/custom-app</span>
/var/log/myapp/*.log<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1"># ìˆœí™˜ ì£¼ê¸°</span>
<span class="w">    </span>daily

<span class="w">    </span><span class="c1"># ë³´ê´€ ê°œìˆ˜</span>
<span class="w">    </span>rotate<span class="w"> </span><span class="m">30</span>

<span class="w">    </span><span class="c1"># í¬ê¸° ê¸°ë°˜ ìˆœí™˜</span>
<span class="w">    </span>size<span class="w"> </span>100M

<span class="w">    </span><span class="c1"># ìµœì†Œ í¬ê¸° (ì´ë³´ë‹¤ ì‘ìœ¼ë©´ ìˆœí™˜ ì•ˆ í•¨)</span>
<span class="w">    </span>minsize<span class="w"> </span>10M

<span class="w">    </span><span class="c1"># ìµœëŒ€ ë³´ê´€ ê¸°ê°„</span>
<span class="w">    </span>maxage<span class="w"> </span><span class="m">365</span>

<span class="w">    </span><span class="c1"># ì••ì¶• ì„¤ì •</span>
<span class="w">    </span>compress
<span class="w">    </span>compresscmd<span class="w"> </span>/usr/bin/xz
<span class="w">    </span>compressoptions<span class="w"> </span>-9
<span class="w">    </span>compressext<span class="w"> </span>.xz
<span class="w">    </span>delaycompress

<span class="w">    </span><span class="c1"># íŒŒì¼ ì—†ì–´ë„ ì—ëŸ¬ ì•„ë‹˜</span>
<span class="w">    </span>missingok

<span class="w">    </span><span class="c1"># ë¹ˆ íŒŒì¼ ìˆœí™˜ ì•ˆ í•¨</span>
<span class="w">    </span>notifempty

<span class="w">    </span><span class="c1"># ìƒˆ íŒŒì¼ ìƒì„±</span>
<span class="w">    </span>create<span class="w"> </span><span class="m">0644</span><span class="w"> </span>root<span class="w"> </span>root

<span class="w">    </span><span class="c1"># ë˜ëŠ” ê¸°ì¡´ íŒŒì¼ ìœ ì§€</span>
<span class="w">    </span><span class="c1"># copytruncate</span>

<span class="w">    </span><span class="c1"># ìŠ¤í¬ë¦½íŠ¸</span>
<span class="w">    </span>prerotate
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;About to rotate logs&quot;</span>
<span class="w">    </span>endscript

<span class="w">    </span>postrotate
<span class="w">        </span>systemctl<span class="w"> </span>reload<span class="w"> </span>myapp
<span class="w">    </span>endscript

<span class="w">    </span>firstaction
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting log rotation batch&quot;</span>
<span class="w">    </span>endscript

<span class="w">    </span>lastaction
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Finished log rotation batch&quot;</span>
<span class="w">    </span>endscript
<span class="o">}</span>
</code></pre></div>

<h3 id="logrotate">logrotate í…ŒìŠ¤íŠ¸<a class="header-link" href="#logrotate" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ë“œë¼ì´ëŸ° (ì‹¤ì œ ì‹¤í–‰ ì•ˆ í•¨)</span>
sudo<span class="w"> </span>logrotate<span class="w"> </span>-d<span class="w"> </span>/etc/logrotate.d/nginx

<span class="c1"># ê°•ì œ ì‹¤í–‰</span>
sudo<span class="w"> </span>logrotate<span class="w"> </span>-f<span class="w"> </span>/etc/logrotate.d/nginx

<span class="c1"># ìƒì„¸ ì¶œë ¥</span>
sudo<span class="w"> </span>logrotate<span class="w"> </span>-v<span class="w"> </span>/etc/logrotate.conf

<span class="c1"># ìƒíƒœ íŒŒì¼ í™•ì¸</span>
cat<span class="w"> </span>/var/lib/logrotate/status
</code></pre></div>

<hr />
<h2 id="6">6. ì›ê²© ë¡œê·¸ ìˆ˜ì§‘<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="rsyslog_1">rsyslog ì„œë²„ ì„¤ì •<a class="header-link" href="#rsyslog_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/rsyslog.conf (ì„œë²„)</span>

<span class="c1"># UDP ìˆ˜ì‹  í™œì„±í™”</span>
module<span class="o">(</span><span class="nv">load</span><span class="o">=</span><span class="s2">&quot;imudp&quot;</span><span class="o">)</span>
input<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;imudp&quot;</span><span class="w"> </span><span class="nv">port</span><span class="o">=</span><span class="s2">&quot;514&quot;</span><span class="o">)</span>

<span class="c1"># TCP ìˆ˜ì‹  í™œì„±í™”</span>
module<span class="o">(</span><span class="nv">load</span><span class="o">=</span><span class="s2">&quot;imtcp&quot;</span><span class="o">)</span>
input<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;imtcp&quot;</span><span class="w"> </span><span class="nv">port</span><span class="o">=</span><span class="s2">&quot;514&quot;</span><span class="o">)</span>

<span class="c1"># í˜¸ìŠ¤íŠ¸ë³„ ë¡œê·¸ ë¶„ë¦¬</span>
<span class="nv">$template</span><span class="w"> </span>RemoteLogs,<span class="s2">&quot;/var/log/remote/%HOSTNAME%/%PROGRAMNAME%.log&quot;</span>
*.*<span class="w"> </span>?RemoteLogs

<span class="c1"># ë˜ëŠ” RainerScript ì‚¬ìš©</span>
template<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;RemoteLogsByHost&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="nv">string</span><span class="o">=</span><span class="s2">&quot;/var/log/remote/%HOSTNAME%/%</span><span class="nv">$YEAR</span><span class="s2">%-%</span><span class="nv">$MONTH</span><span class="s2">%-%</span><span class="nv">$DAY</span><span class="s2">%.log&quot;</span><span class="o">)</span>

<span class="k">if</span><span class="w"> </span><span class="nv">$fromhost</span>-ip<span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>action<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;omfile&quot;</span><span class="w"> </span><span class="nv">dynaFile</span><span class="o">=</span><span class="s2">&quot;RemoteLogsByHost&quot;</span><span class="o">)</span>
<span class="w">    </span>stop
<span class="o">}</span>
</code></pre></div>

<h3 id="rsyslog_2">rsyslog í´ë¼ì´ì–¸íŠ¸ ì„¤ì •<a class="header-link" href="#rsyslog_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/rsyslog.d/remote.conf (í´ë¼ì´ì–¸íŠ¸)</span>

<span class="c1"># UDPë¡œ ì „ì†¡ (@)</span>
*.*<span class="w"> </span>@logserver.example.com:514

<span class="c1"># TCPë¡œ ì „ì†¡ (@@)</span>
*.*<span class="w"> </span>@@logserver.example.com:514

<span class="c1"># íŠ¹ì • ë¡œê·¸ë§Œ ì „ì†¡</span>
auth.*<span class="w"> </span>@@logserver.example.com:514
*.err<span class="w"> </span>@@logserver.example.com:514

<span class="c1"># í ì„¤ì • (ì•ˆì •ì  ì „ì†¡)</span>
action<span class="o">(</span>
<span class="w">    </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;omfwd&quot;</span>
<span class="w">    </span><span class="nv">target</span><span class="o">=</span><span class="s2">&quot;logserver.example.com&quot;</span>
<span class="w">    </span><span class="nv">port</span><span class="o">=</span><span class="s2">&quot;514&quot;</span>
<span class="w">    </span><span class="nv">protocol</span><span class="o">=</span><span class="s2">&quot;tcp&quot;</span>
<span class="w">    </span>queue.type<span class="o">=</span><span class="s2">&quot;LinkedList&quot;</span>
<span class="w">    </span>queue.filename<span class="o">=</span><span class="s2">&quot;remote_queue&quot;</span>
<span class="w">    </span>queue.saveOnShutdown<span class="o">=</span><span class="s2">&quot;on&quot;</span>
<span class="w">    </span>queue.maxDiskSpace<span class="o">=</span><span class="s2">&quot;1g&quot;</span>
<span class="w">    </span>action.resumeRetryCount<span class="o">=</span><span class="s2">&quot;-1&quot;</span>
<span class="o">)</span>
</code></pre></div>

<h3 id="tls">TLS ì•”í˜¸í™” ì„¤ì •<a class="header-link" href="#tls" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì„œë²„ ì„¤ì •</span>
module<span class="o">(</span><span class="nv">load</span><span class="o">=</span><span class="s2">&quot;imtcp&quot;</span>
<span class="w">    </span>StreamDriver.Name<span class="o">=</span><span class="s2">&quot;gtls&quot;</span>
<span class="w">    </span>StreamDriver.Mode<span class="o">=</span><span class="s2">&quot;1&quot;</span>
<span class="w">    </span>StreamDriver.AuthMode<span class="o">=</span><span class="s2">&quot;x509/name&quot;</span>
<span class="o">)</span>

global<span class="o">(</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriver</span><span class="o">=</span><span class="s2">&quot;gtls&quot;</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriverCAFile</span><span class="o">=</span><span class="s2">&quot;/etc/rsyslog.d/ca.pem&quot;</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriverCertFile</span><span class="o">=</span><span class="s2">&quot;/etc/rsyslog.d/server-cert.pem&quot;</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriverKeyFile</span><span class="o">=</span><span class="s2">&quot;/etc/rsyslog.d/server-key.pem&quot;</span>
<span class="o">)</span>

input<span class="o">(</span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;imtcp&quot;</span><span class="w"> </span><span class="nv">port</span><span class="o">=</span><span class="s2">&quot;6514&quot;</span><span class="o">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># í´ë¼ì´ì–¸íŠ¸ ì„¤ì •</span>
global<span class="o">(</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriver</span><span class="o">=</span><span class="s2">&quot;gtls&quot;</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriverCAFile</span><span class="o">=</span><span class="s2">&quot;/etc/rsyslog.d/ca.pem&quot;</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriverCertFile</span><span class="o">=</span><span class="s2">&quot;/etc/rsyslog.d/client-cert.pem&quot;</span>
<span class="w">    </span><span class="nv">DefaultNetstreamDriverKeyFile</span><span class="o">=</span><span class="s2">&quot;/etc/rsyslog.d/client-key.pem&quot;</span>
<span class="o">)</span>

action<span class="o">(</span>
<span class="w">    </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;omfwd&quot;</span>
<span class="w">    </span><span class="nv">target</span><span class="o">=</span><span class="s2">&quot;logserver.example.com&quot;</span>
<span class="w">    </span><span class="nv">port</span><span class="o">=</span><span class="s2">&quot;6514&quot;</span>
<span class="w">    </span><span class="nv">protocol</span><span class="o">=</span><span class="s2">&quot;tcp&quot;</span>
<span class="w">    </span><span class="nv">StreamDriver</span><span class="o">=</span><span class="s2">&quot;gtls&quot;</span>
<span class="w">    </span><span class="nv">StreamDriverMode</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>
<span class="w">    </span><span class="nv">StreamDriverAuthMode</span><span class="o">=</span><span class="s2">&quot;x509/name&quot;</span>
<span class="o">)</span>
</code></pre></div>

<h3 id="_22">ë°©í™”ë²½ ì„¤ì •<a class="header-link" href="#_22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># RHEL/CentOS (firewalld)</span>
sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--permanent<span class="w"> </span>--add-port<span class="o">=</span><span class="m">514</span>/tcp
sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--permanent<span class="w"> </span>--add-port<span class="o">=</span><span class="m">514</span>/udp
sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--reload

<span class="c1"># Ubuntu (ufw)</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">514</span>/tcp
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">514</span>/udp
</code></pre></div>

<hr />
<h2 id="7">7. ë¡œê·¸ ë¶„ì„ ë„êµ¬<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="lnav-log-navigator">lnav (Log Navigator)<a class="header-link" href="#lnav-log-navigator" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì„¤ì¹˜</span>
<span class="c1"># Ubuntu/Debian</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>lnav

<span class="c1"># RHEL/CentOS</span>
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>epel-release
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>lnav

<span class="c1"># ì‚¬ìš©</span>
lnav<span class="w"> </span>/var/log/syslog
lnav<span class="w"> </span>/var/log/nginx/*.log

<span class="c1"># ì›ê²© ë¡œê·¸ (SSH)</span>
lnav<span class="w"> </span>ssh://user@server/var/log/syslog

<span class="c1"># í•„í„°ë§ (ë‚´ë¶€ ëª…ë ¹)</span>
:filter-in<span class="w"> </span>error
:filter-out<span class="w"> </span>debug
</code></pre></div>

<h3 id="multitail">multitail<a class="header-link" href="#multitail" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì„¤ì¹˜</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>multitail<span class="w">  </span><span class="c1"># Ubuntu</span>
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>multitail<span class="w">  </span><span class="c1"># RHEL</span>

<span class="c1"># ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ëª¨ë‹ˆí„°ë§</span>
multitail<span class="w"> </span>/var/log/syslog<span class="w"> </span>/var/log/auth.log

<span class="c1"># ìƒ‰ìƒ êµ¬ë¶„</span>
multitail<span class="w"> </span>-ci<span class="w"> </span>green<span class="w"> </span>/var/log/access.log<span class="w"> </span>-ci<span class="w"> </span>red<span class="w"> </span>/var/log/error.log
</code></pre></div>

<h3 id="goaccess">GoAccess (ì›¹ ë¡œê·¸ ë¶„ì„)<a class="header-link" href="#goaccess" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì„¤ì¹˜</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>goaccess<span class="w">  </span><span class="c1"># Ubuntu</span>
sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>goaccess<span class="w">  </span><span class="c1"># RHEL</span>

<span class="c1"># í„°ë¯¸ë„ì—ì„œ ì‹¤ì‹œê°„ ë¶„ì„</span>
goaccess<span class="w"> </span>/var/log/nginx/access.log<span class="w"> </span>-c

<span class="c1"># HTML ë³´ê³ ì„œ ìƒì„±</span>
goaccess<span class="w"> </span>/var/log/nginx/access.log<span class="w"> </span>-o<span class="w"> </span>report.html<span class="w"> </span>--log-format<span class="o">=</span>COMBINED

<span class="c1"># ì‹¤ì‹œê°„ HTML ëŒ€ì‹œë³´ë“œ</span>
goaccess<span class="w"> </span>/var/log/nginx/access.log<span class="w"> </span>-o<span class="w"> </span>/var/www/html/report.html<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--log-format<span class="o">=</span>COMBINED<span class="w"> </span>--real-time-html
</code></pre></div>

<h3 id="_23">ê°„ë‹¨í•œ ë¶„ì„ ëª…ë ¹ì–´<a class="header-link" href="#_23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ê°€ì¥ ë§ì€ ìš”ì²­ IP</span>
awk<span class="w"> </span><span class="s1">&#39;{print $1}&#39;</span><span class="w"> </span>/var/log/nginx/access.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-rn<span class="w"> </span><span class="p">|</span><span class="w"> </span>head

<span class="c1"># HTTP ìƒíƒœ ì½”ë“œ ë¶„í¬</span>
awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="w"> </span>/var/log/nginx/access.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-rn

<span class="c1"># ì‹œê°„ëŒ€ë³„ ìš”ì²­ ìˆ˜</span>
awk<span class="w"> </span><span class="s1">&#39;{print $4}&#39;</span><span class="w"> </span>/var/log/nginx/access.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d:<span class="w"> </span>-f2<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c

<span class="c1"># ì—ëŸ¬ ë©”ì‹œì§€ ë¹ˆë„</span>
grep<span class="w"> </span>-i<span class="w"> </span>error<span class="w"> </span>/var/log/syslog<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $5}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-rn<span class="w"> </span><span class="p">|</span><span class="w"> </span>head

<span class="c1"># ì‹¤íŒ¨í•œ SSH ë¡œê·¸ì¸</span>
grep<span class="w"> </span><span class="s2">&quot;Failed password&quot;</span><span class="w"> </span>/var/log/auth.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $11}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-rn
</code></pre></div>

<hr />
<h2 id="_24">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_24" title="Permanent link">&para;</a></h2>
<h3 id="1-journalctl">ë¬¸ì œ 1: journalctl ì¿¼ë¦¬<a class="header-link" href="#1-journalctl" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ì¡°ê±´ì˜ ë¡œê·¸ë¥¼ ì¡°íšŒí•˜ëŠ” ëª…ë ¹ì„ ì‘ì„±í•˜ì„¸ìš”:
1. nginx ì„œë¹„ìŠ¤ì˜ ì—ëŸ¬ ë¡œê·¸ë§Œ (ì˜¤ëŠ˜)
2. íŠ¹ì • PID(1234)ì˜ ë¡œê·¸ë¥¼ JSONìœ¼ë¡œ ì¶œë ¥
3. ì§€ë‚œ 1ì‹œê°„ ë™ì•ˆì˜ ì»¤ë„ ê²½ê³  ì´ìƒ ë©”ì‹œì§€</p>
<h3 id="2-rsyslog">ë¬¸ì œ 2: rsyslog í•„í„°<a class="header-link" href="#2-rsyslog" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ëŠ” rsyslog ê·œì¹™ì„ ì‘ì„±í•˜ì„¸ìš”:
- ëª¨ë“  auth ë©”ì‹œì§€ë¥¼ <code>/var/log/auth-all.log</code>ì— ì €ì¥
- "Failed" ë¬¸ìì—´ì´ í¬í•¨ëœ ë©”ì‹œì§€ëŠ” <code>/var/log/failures.log</code>ì—ë„ ì €ì¥
- ì›ê²© ì„œë²„ <code>192.168.1.100</code>ìœ¼ë¡œ ì—ëŸ¬ ì´ìƒ ë¡œê·¸ ì „ì†¡</p>
<h3 id="3-logrotate">ë¬¸ì œ 3: logrotate ì„¤ì •<a class="header-link" href="#3-logrotate" title="Permanent link">&para;</a></h3>
<p><code>/var/log/myapp/</code> ë””ë ‰í† ë¦¬ì˜ ë¡œê·¸ì— ëŒ€í•´:
- ë§¤ì¼ ìˆœí™˜
- 30ì¼ ë³´ê´€
- 100MB ì´ˆê³¼ ì‹œ ìˆœí™˜
- xz ì••ì¶•
- ìˆœí™˜ í›„ ì• í”Œë¦¬ì¼€ì´ì…˜ì— SIGHUP ì „ì†¡</p>
<hr />
<h2 id="_25">ì •ë‹µ<a class="header-link" href="#_25" title="Permanent link">&para;</a></h2>
<h3 id="1">ë¬¸ì œ 1 ì •ë‹µ<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. nginx ì—ëŸ¬ ë¡œê·¸ (ì˜¤ëŠ˜)</span>
journalctl<span class="w"> </span>-u<span class="w"> </span>nginx<span class="w"> </span>-p<span class="w"> </span>err<span class="w"> </span>--since<span class="w"> </span>today

<span class="c1"># 2. PID 1234 JSON ì¶œë ¥</span>
journalctl<span class="w"> </span><span class="nv">_PID</span><span class="o">=</span><span class="m">1234</span><span class="w"> </span>-o<span class="w"> </span>json-pretty

<span class="c1"># 3. ì»¤ë„ ê²½ê³  ì´ìƒ (1ì‹œê°„)</span>
journalctl<span class="w"> </span>-k<span class="w"> </span>-p<span class="w"> </span>warning<span class="w"> </span>--since<span class="w"> </span><span class="s2">&quot;1 hour ago&quot;</span>
</code></pre></div>

<h3 id="2">ë¬¸ì œ 2 ì •ë‹µ<a class="header-link" href="#2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/rsyslog.d/custom.conf</span>

<span class="c1"># auth ë¡œê·¸</span>
auth.*<span class="w">  </span>/var/log/auth-all.log

<span class="c1"># Failed í¬í•¨ ë©”ì‹œì§€</span>
:msg,<span class="w"> </span>contains,<span class="w"> </span><span class="s2">&quot;Failed&quot;</span><span class="w"> </span>/var/log/failures.log

<span class="c1"># ì›ê²© ì „ì†¡ (ì—ëŸ¬ ì´ìƒ)</span>
*.err<span class="w"> </span>@@192.168.1.100:514
</code></pre></div>

<h3 id="3">ë¬¸ì œ 3 ì •ë‹µ<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/logrotate.d/myapp</span>
/var/log/myapp/*.log<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>daily
<span class="w">    </span>rotate<span class="w"> </span><span class="m">30</span>
<span class="w">    </span>size<span class="w"> </span>100M
<span class="w">    </span>compress
<span class="w">    </span>compresscmd<span class="w"> </span>/usr/bin/xz
<span class="w">    </span>compressext<span class="w"> </span>.xz
<span class="w">    </span>delaycompress
<span class="w">    </span>missingok
<span class="w">    </span>notifempty
<span class="w">    </span>create<span class="w"> </span><span class="m">0644</span><span class="w"> </span>root<span class="w"> </span>root
<span class="w">    </span>postrotate
<span class="w">        </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>/var/run/myapp.pid<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-HUP<span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span>/var/run/myapp.pid<span class="k">)</span>
<span class="w">    </span>endscript
<span class="o">}</span>
</code></pre></div>

<hr />
<h2 id="_26">ë‹¤ìŒ ë‹¨ê³„<a class="header-link" href="#_26" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="./19_Backup_Recovery.md">19_Backup_Recovery.md</a> - rsync, Borg Backup, ì¬í•´ë³µêµ¬ ì „ëµ</li>
</ul>
<hr />
<h2 id="_27">ì°¸ê³  ìë£Œ<a class="header-link" href="#_27" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.freedesktop.org/software/systemd/man/systemd-journald.service.html">systemd Journal</a></li>
<li><a href="https://www.rsyslog.com/doc/">rsyslog Documentation</a></li>
<li><a href="https://linux.die.net/man/8/logrotate">logrotate Manual</a></li>
<li><code>man journalctl</code>, <code>man rsyslog.conf</code>, <code>man logrotate</code></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Linux/17_SELinux_AppArmor.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">SELinuxì™€ AppArmor</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Linux/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Linux/19_Backup_Recovery.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">ë°±ì—… ë° ë³µêµ¬</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}