{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5. 자기 재결합 이론 - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">5. 자기 재결합 이론</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>5. 자기 재결합 이론</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/04_Current_Driven_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">4. 전류 구동 불안정성</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/06_Reconnection_Applications.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">6. 재결합 응용</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">학습 목표</a></li>
<li><a href="#1">1. 자기 재결합 소개</a><ul>
<li><a href="#11">1.1 자기 재결합이란 무엇인가?</a></li>
<li><a href="#12">1.2 재결합이 중요한 이유</a></li>
<li><a href="#13">1.3 동결 자기장 정리와 그 붕괴</a></li>
</ul>
</li>
<li><a href="#2-sweet-parker">2. Sweet-Parker 재결합</a><ul>
<li><a href="#21">2.1 모델 설정</a></li>
<li><a href="#22">2.2 재결합률 유도</a></li>
<li><a href="#23-sweet-parker">2.3 Sweet-Parker 문제</a></li>
<li><a href="#24-sweet-parker">2.4 Sweet-Parker의 한계</a></li>
</ul>
</li>
<li><a href="#3-petschek">3. Petschek 재결합</a><ul>
<li><a href="#31-petschek">3.1 Petschek 모델</a></li>
<li><a href="#32-mhd">3.2 느린 모드 MHD 충격파</a></li>
<li><a href="#33-petschek">3.3 Petschek 재결합률</a></li>
<li><a href="#34-petschek">3.4 Petschek 재결합의 안정성</a></li>
</ul>
</li>
<li><a href="#4-hall-mhd">4. Hall MHD 및 무충돌 재결합</a><ul>
<li><a href="#41-hall">4.1 Hall 항</a></li>
<li><a href="#42-hall-mhd">4.2 Hall MHD 방정식</a></li>
<li><a href="#43-hall">4.3 Hall 재결합의 구조</a></li>
<li><a href="#44-hall">4.4 Hall 재결합률</a></li>
<li><a href="#45-gem">4.5 GEM 재결합 챌린지</a></li>
</ul>
</li>
<li><a href="#5-x-">5. X-점 기하학 및 자기 위상 구조</a><ul>
<li><a href="#51-x-">5.1 X-점 구성</a></li>
<li><a href="#52">5.2 자기 위상 구조 및 위상 변화</a></li>
<li><a href="#53">5.3 분리선 및 자기 섬</a></li>
<li><a href="#54">5.4 벡터 포텐셜 및 자속 함수</a></li>
</ul>
</li>
<li><a href="#6">6. 재결합률 측정</a><ul>
<li><a href="#61">6.1 무차원 재결합률</a></li>
<li><a href="#62">6.2 재결합 전기장</a></li>
<li><a href="#63">6.3 자속 전달률</a></li>
<li><a href="#64">6.4 관측적 측정</a></li>
</ul>
</li>
<li><a href="#7-python">7. Python 예제</a><ul>
<li><a href="#71-sweet-parker-vs-petschek">7.1 Sweet-Parker vs Petschek 스케일링</a></li>
<li><a href="#72-x-">7.2 X-점 자기장 구조</a></li>
<li><a href="#73-sweet-parker">7.3 Sweet-Parker 확산 영역 종횡비</a></li>
<li><a href="#74-hall">7.4 Hall 재결합 사중극 자기장</a></li>
<li><a href="#75">7.5 재결합률 진화</a></li>
</ul>
</li>
<li><a href="#_2">요약</a></li>
<li><a href="#_3">연습 문제</a></li>
<li><a href="#_4">네비게이션</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="5">5. 자기 재결합 이론<a class="header-link" href="#5" title="Permanent link">&para;</a></h1>
<h2 id="_1">학습 목표<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>이 레슨을 마치면 다음을 할 수 있어야 합니다:</p>
<ol>
<li>자기 재결합이 플라즈마 물리학 및 천체물리학에서 중요한 이유 설명하기</li>
<li>Sweet-Parker 재결합률 유도하고 그 한계 이해하기</li>
<li>Petschek 모델을 분석하고 더 빠른 재결합을 달성하는 방법 설명하기</li>
<li>무충돌 재결합에서 Hall 물리학의 역할 이해하기</li>
<li>X-점 기하학과 재결합 영역의 구조 설명하기</li>
<li>무차원 재결합률 계산 및 해석하기</li>
<li>재결합률 스케일링의 수치 모델 구현하기</li>
</ol>
<h2 id="1">1. 자기 재결합 소개<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 자기 재결합이란 무엇인가?<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>자기 재결합은 자기장 위상 구조가 변화하고 자기 에너지가 플라즈마 운동 및 열 에너지로 빠르게 변환되는 기본적인 플라즈마 과정입니다. 이 과정은 우주에서 가장 폭발적인 현상들을 일으킵니다.</p>
<div class="highlight"><pre><span></span><code>핵심 개념: 이상 MHD에서 자기장 선은 플라즈마에 &quot;동결&quot;되어 있습니다
(자속 동결). 재결합은 이 제약을 깨뜨려 자기장 선이 끊어지고
다른 구성으로 재결합할 수 있게 합니다.
</code></pre></div>

<p>이 과정은 비이상 효과(저항, Hall 물리학 또는 운동학적 효과)로 인해 동결 조건이 무너지는 얇은 전류 시트에서 발생합니다. 변화하는 위상 구조는 자기 에너지가 종종 폭발적으로 방출되도록 합니다.</p>
<h3 id="12">1.2 재결합이 중요한 이유<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>자기 재결합은 다음을 이해하는 데 중요합니다:</p>
<p><strong>태양 물리학:</strong>
- 태양 플레어: 수 분 내에 ~10³²–10³³ erg의 에너지 방출
- 코로나 질량 방출(CME): 수십억 톤의 플라즈마 분출
- 코로나 가열: 100만도 코로나 유지</p>
<p><strong>우주 물리학:</strong>
- 자기권 서브스톰: 오로라 밝아짐 이벤트
- 태양풍-자기권 결합: 자기권계면에서의 에너지 전달
- 입자 가속: 비열적 입자 생성</p>
<p><strong>실험실 플라즈마:</strong>
- 토카막 톱니파 충돌: 급격한 중심 온도 하락
- 붕괴: 가두기의 재앙적 상실
- Spheromak 및 RFP 이완: 자기 자기조직화</p>
<p><strong>천체물리학:</strong>
- 펄서 자기권: 고에너지 복사
- 강착원반 코로나: X선 방출
- 감마선 폭발 제트: 상대론적 유출</p>
<p>재결합 이론을 발전시킨 핵심 퍼즐: 단순 추정치가 매우 느린 속도를 예측할 때, 어떻게 재결합이 관측을 설명할 만큼 충분히 빠를 수 있는가?</p>
<h3 id="13">1.3 동결 자기장 정리와 그 붕괴<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<p>이상 MHD에서 전기장은:</p>
<p>$$\mathbf{E} = -\mathbf{v} \times \mathbf{B}$$</p>
<p>이것은 동결 자속 정리로 이어집니다: 플라즈마와 함께 움직이는 임의의 닫힌 루프를 통과하는 자기 자속이 보존됩니다. 자기장 선은 플라즈마와 함께 움직인다고 생각할 수 있습니다.</p>
<p>저항이 포함되면 Ohm의 법칙은:</p>
<p>$$\mathbf{E} = -\mathbf{v} \times \mathbf{B} + \eta \mathbf{J}$$</p>
<p>여기서 $\eta$는 저항률이고 $\mathbf{J}$는 전류 밀도입니다. 저항 항은 자기장 선이 플라즈마를 통해 "미끄러질" 수 있게 합니다. 그러나 앞으로 보겠지만, 고전적 저항만으로는 관측된 재결합률을 설명하기에는 너무 작습니다.</p>
<p>유도 방정식은:</p>
<p>$$\frac{\partial \mathbf{B}}{\partial t} = \nabla \times (\mathbf{v} \times \mathbf{B}) + \eta \nabla^2 \mathbf{B}$$</p>
<p>이상 항과 저항 항의 상대적 중요성은 자기 Reynolds 수로 측정됩니다:</p>
<p>$$R_m = \frac{Lv_A}{\eta}$$</p>
<p>여기서 $L$은 특성 길이 척도이고 $v_A = B/\sqrt{\mu_0 \rho}$는 Alfvén 속도입니다. 대부분의 천체물리학 및 우주 플라즈마에서 $R_m \gg 1$이므로 재결합은 어려운 문제입니다.</p>
<h2 id="2-sweet-parker">2. Sweet-Parker 재결합<a class="header-link" href="#2-sweet-parker" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 모델 설정<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>Sweet(1958)과 Parker(1957)가 독립적으로 개발한 Sweet-Parker 모델은 자기 재결합의 첫 정량적 이론이었습니다. 가정:</p>
<ol>
<li><strong>정상 상태</strong>: 시간 독립적 구성</li>
<li><strong>2차원 기하학</strong>: 전류 방향을 따라 불변</li>
<li><strong>얇은 전류 시트</strong>: 길이 $L \gg$ 폭 $\delta$</li>
<li><strong>대칭 유입</strong>: 양쪽에서 플라즈마 유입</li>
<li><strong>고전적 저항</strong>: $\eta$는 상수</li>
</ol>
<div class="highlight"><pre><span></span><code>                    Inflow v_in
                        ↓
                        ↓
        B_in ←  ←  ←  ←┼→  →  →  → B_in
                        ↓
        ================╋================ Current sheet
                        ↓                 (length L, width δ)
        B_in ←  ←  ←  ←┼→  →  →  → B_in
                        ↓
                        ↓ Outflow v_out
</code></pre></div>

<p>재결합하는 자기장은 반평행: 시트 위쪽에서 $\mathbf{B} = B_{in} \hat{x}$, 아래쪽에서 $\mathbf{B} = -B_{in} \hat{x}$입니다. 재결합 전기장 $E_z$는 균일하고 지면 밖을 향합니다.</p>
<h3 id="22">2.2 재결합률 유도<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>확산 영역에 보존 법칙을 적용하여 재결합률을 유도합니다.</p>
<p><strong>질량 보존:</strong></p>
<p>질량 유입률은 질량 유출률과 같아야 합니다:</p>
<p>$$\rho v_{in} L \approx \rho v_{out} \delta$$</p>
<p>따라서:</p>
<p>$$v_{out} \approx v_{in} \frac{L}{\delta}$$</p>
<p><strong>운동량 보존:</strong></p>
<p>자기 압력이 유출을 구동합니다. 자기 압력과 동적 압력의 균형:</p>
<p>$$\frac{B_{in}^2}{2\mu_0} \approx \rho v_{out}^2$$</p>
<p>이것은 유출 속도가 대략 Alfvén 속도임을 줍니다:</p>
<p>$$v_{out} \approx v_A = \frac{B_{in}}{\sqrt{\mu_0 \rho}}$$</p>
<p><strong>X-점에서의 Ohm 법칙:</strong></p>
<p>확산 영역 중심에서 재결합 전기장은:</p>
<p>$$E_z = \eta J_z$$</p>
<p>여기서 Ampère 법칙으로부터 $J_z \approx B_{in}/(\mu_0 \delta)$입니다. 확산 영역 밖(이상 영역)에서 Ohm 법칙은:</p>
<p>$$E_z = v_{in} B_{in}$$</p>
<p>이들을 같다고 놓으면:</p>
<p>$$v_{in} B_{in} = \eta \frac{B_{in}}{\mu_0 \delta}$$</p>
<p>폭을 구하면:</p>
<p>$$\delta = \frac{\eta}{\mu_0 v_{in}}$$</p>
<p><strong>$v_{in}$ 구하기:</strong></p>
<p>$v_{out} = v_{in} L/\delta$와 $v_{out} = v_A$ 및 $\delta$에 대한 식을 결합:</p>
<p>$$v_A = v_{in} \frac{L}{\eta/(\mu_0 v_{in})} = v_{in} \frac{L \mu_0 v_{in}}{\eta}$$</p>
<p>$$v_A = \frac{L \mu_0 v_{in}^2}{\eta}$$</p>
<p>$$v_{in} = \sqrt{\frac{\eta v_A}{L \mu_0}} = v_A \sqrt{\frac{\eta}{L v_A \mu_0}}$$</p>
<p><strong>무차원 재결합률:</strong></p>
<p>Lundquist 수를 정의:</p>
<p>$$S = \frac{L v_A \mu_0}{\eta} = \frac{L v_A}{\eta/\mu_0}$$</p>
<p>이것은 시트 길이를 기반으로 한 자기 Reynolds 수입니다. 무차원 재결합률은:</p>
<p>$$M_A = \frac{v_{in}}{v_A} = S^{-1/2}$$</p>
<p>또한 종횡비는:</p>
<p>$$\frac{\delta}{L} = S^{-1}$$</p>
<h3 id="23-sweet-parker">2.3 Sweet-Parker 문제<a class="header-link" href="#23-sweet-parker" title="Permanent link">&para;</a></h3>
<p>태양 플레어의 경우 전형적인 매개변수:</p>
<ul>
<li>$L \sim 10^9$ m (10,000 km)</li>
<li>$B \sim 0.01$ T (100 G)</li>
<li>$n \sim 10^{16}$ m⁻³</li>
<li>$T \sim 10^7$ K</li>
<li>Spitzer 저항: $\eta \sim 10^{-4}$ Ω·m</li>
</ul>
<p>이것은 다음을 제공합니다:</p>
<p>$$v_A \sim 10^6 \text{ m/s}$$</p>
<p>$$S \sim \frac{10^9 \times 10^6}{10^{-4}/\mu_0} \sim 10^{14}$$</p>
<p>$$M_A \sim 10^{-7}$$</p>
<p>$$v_{in} \sim 10^{-1} \text{ m/s}$$</p>
<p><strong>문제:</strong> 이 속도로 자기장을 재결합하는 데 걸리는 시간:</p>
<p>$$t \sim \frac{L}{v_{in}} \sim 10^{10} \text{ s} \sim 300 \text{ years}$$</p>
<p>그러나 태양 플레어는 <strong>수 분에서 수 시간</strong> 안에 에너지를 방출합니다! 관측된 재결합률은 $M_A \sim 0.01$–$0.1$로, Sweet-Parker가 예측하는 것보다 약 100,000배 빠릅니다.</p>
<p>이것이 <strong>재결합률 문제</strong>입니다: Sweet-Parker 재결합은 관측을 설명하기에는 너무 느립니다.</p>
<h3 id="24-sweet-parker">2.4 Sweet-Parker의 한계<a class="header-link" href="#24-sweet-parker" title="Permanent link">&para;</a></h3>
<p>Sweet-Parker 모델에는 몇 가지 한계가 있습니다:</p>
<ol>
<li>
<p><strong>너무 느림</strong>: 위에서 보았듯이, $M_A \sim S^{-1/2}$는 큰 $S$에 대해 비현실적으로 느린 속도를 제공합니다.</p>
</li>
<li>
<p><strong>균일한 저항 가정</strong>: 실제로 저항은 비정상 과정(난류, 파동)에 의해 증가될 수 있습니다.</p>
</li>
<li>
<p><strong>정상 상태</strong>: 실제 재결합은 종종 시간 의존적이고 버스트성입니다.</p>
</li>
<li>
<p><strong>2D</strong>: 3차원 효과가 중요할 수 있습니다.</p>
</li>
<li>
<p><strong>고전적 저항</strong>: 무충돌 플라즈마는 운동학적 물리학이 필요합니다.</p>
</li>
</ol>
<p>이러한 한계에도 불구하고 Sweet-Parker는 유용한 벤치마크로 남아 있으며 특정 영역에서 재결합의 일부 측면을 설명합니다.</p>
<h2 id="3-petschek">3. Petschek 재결합<a class="header-link" href="#3-petschek" title="Permanent link">&para;</a></h2>
<h3 id="31-petschek">3.1 Petschek 모델<a class="header-link" href="#31-petschek" title="Permanent link">&para;</a></h3>
<p>Petschek(1964)은 급진적인 수정을 제안했습니다: 긴 확산 영역 대신, 재결합은 X-점 근처의 작은 저항 영역에서 발생하며, 대부분의 에너지 변환은 확장된 느린 모드 MHD 충격파에서 일어납니다.</p>
<div class="highlight"><pre><span></span><code><span class="w">                    </span><span class="n">Inflow</span>
<span class="w">                      </span><span class="err">↓</span>
<span class="w">         </span><span class="err">╲</span><span class="w">            </span><span class="err">↓</span><span class="w">            </span><span class="err">╱</span>
<span class="w">          </span><span class="err">╲</span><span class="w">           </span><span class="err">↓</span><span class="w">           </span><span class="err">╱</span><span class="w">   </span><span class="n">Slow</span><span class="w"> </span><span class="n">shock</span>
<span class="w">           </span><span class="err">╲</span><span class="w">          </span><span class="err">↓</span><span class="w">          </span><span class="err">╱</span>
<span class="w">            </span><span class="err">╲</span><span class="w">         </span><span class="err">↓</span><span class="w">         </span><span class="err">╱</span>
<span class="w">             </span><span class="err">╲</span><span class="w">        </span><span class="err">↓</span><span class="w">        </span><span class="err">╱</span>
<span class="w">              </span><span class="err">╲</span><span class="w">      </span><span class="err">┏━┓</span><span class="w">      </span><span class="err">╱</span>
<span class="w">               </span><span class="err">╲</span><span class="w">     </span><span class="err">┃</span><span class="w"> </span><span class="err">┃</span><span class="w">     </span><span class="err">╱</span><span class="w">        </span><span class="n">Small</span><span class="w"> </span><span class="n">diffusion</span>
<span class="w">        </span><span class="err">════════╲════┃</span><span class="n">X</span><span class="err">┃════╱═══════</span><span class="w">  </span><span class="n">region</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="err">δ</span><span class="p">)</span>
<span class="w">                 </span><span class="err">╲</span><span class="w">   </span><span class="err">┃</span><span class="w"> </span><span class="err">┃</span><span class="w">   </span><span class="err">╱</span>
<span class="w">                  </span><span class="err">╲</span><span class="w">  </span><span class="err">┗━┛</span><span class="w">  </span><span class="err">╱</span>
<span class="w">                   </span><span class="err">╲</span><span class="w">  </span><span class="err">↓</span><span class="w">  </span><span class="err">╱</span>
<span class="w">                    </span><span class="err">╲</span><span class="w"> </span><span class="err">↓</span><span class="w"> </span><span class="err">╱</span>
<span class="w">                     </span><span class="err">╲↓╱</span>
<span class="w">                      </span><span class="err">↓</span><span class="w"> </span><span class="n">Outflow</span>
</code></pre></div>

<p><strong>핵심 특징:</strong></p>
<ol>
<li><strong>작은 확산 영역</strong>: 크기 ~$\delta \sim \eta/(v_A \mu_0)$, $L$과 독립적</li>
<li><strong>느린 MHD 충격파</strong>: 확산 영역에서 거리 ~$L$까지 확장</li>
<li><strong>빠른 재결합</strong>: 속도는 $S$에 로그적으로만 의존</li>
</ol>
<h3 id="32-mhd">3.2 느린 모드 MHD 충격파<a class="header-link" href="#32-mhd" title="Permanent link">&para;</a></h3>
<p>느린 모드 충격파는 세 가지 유형의 MHD 충격파(빠름, 느림, 중간) 중 하나입니다. 특성:</p>
<ul>
<li><strong>속도 점프</strong>: 충격파를 가로질러 유동이 가속됨</li>
<li><strong>자기장</strong>: $B_{\perp}$ 감소, $B_{\parallel}$는 증가하거나 감소할 수 있음</li>
<li><strong>밀도</strong>: 충격파를 가로질러 증가(압축)</li>
<li><strong>온도</strong>: 증가(엔트로피 생성)</li>
</ul>
<p>느린 충격파는 자기 에너지를 열 및 운동 에너지로 변환합니다. 충격파는 전류 시트와 각도 $\psi$를 만듭니다:</p>
<p>$$\psi \sim \frac{\delta}{L} \sim \frac{\eta}{L v_A \mu_0}$$</p>
<h3 id="33-petschek">3.3 Petschek 재결합률<a class="header-link" href="#33-petschek" title="Permanent link">&para;</a></h3>
<p>Petschek의 분석은 재결합률을 제공합니다:</p>
<p>$$M_A \sim \frac{\pi}{8 \ln S}$$</p>
<p>$S = 10^{14}$의 경우:</p>
<p>$$M_A \sim \frac{\pi}{8 \ln(10^{14})} \sim \frac{3.14}{8 \times 32} \sim 0.012$$</p>
<p>이것은 관측된 속도와 놀랍도록 가깝습니다! $S$에 대한 로그 의존성은 큰 $S$에서 속도를 저항률과 거의 독립적으로 만듭니다.</p>
<p><strong>유도 스케치:</strong></p>
<p>재결합 전기장은 $E_z = v_{in} B_{in}$입니다. 확산 영역에서:</p>
<p>$$E_z = \eta J_z \sim \eta \frac{B_{in}}{\mu_0 \delta}$$</p>
<p>같다고 놓으면:</p>
<p>$$v_{in} B_{in} \sim \eta \frac{B_{in}}{\mu_0 \delta}$$</p>
<p>$$v_{in} \sim \frac{\eta}{\mu_0 \delta}$$</p>
<p>확산 영역 크기는 국소 물리학으로 설정됩니다:</p>
<p>$$\delta \sim \frac{\eta}{\mu_0 v_A}$$</p>
<p>따라서:</p>
<p>$$v_{in} \sim \frac{\eta}{\mu_0 \eta/(\mu_0 v_A)} = v_A$$</p>
<p>그러나 이것은 $M_A = 1$을 줄 것인데, 너무 빠릅니다(인과율 위반). 제약은 느린 충격파 각도를 확산 영역 크기에 맞추는 것에서 나옵니다:</p>
<p>$$\psi \sim \frac{1}{\ln S}$$</p>
<p>재결합률은:</p>
<p>$$M_A \sim \frac{1}{\ln S}$$</p>
<p>자세한 충격파 분석으로부터 수치 계수 $\pi/8$가 나옵니다.</p>
<h3 id="34-petschek">3.4 Petschek 재결합의 안정성<a class="header-link" href="#34-petschek" title="Permanent link">&para;</a></h3>
<p>Biskamp(1986)이 발견한 주요 문제: <strong>균일한 저항에 대해 Petschek 재결합은 불안정합니다</strong>.</p>
<p>수치 시뮬레이션은 균일한 $\eta$로 시스템이 Petschek 구성이 아닌 Sweet-Parker 구성으로 진화함을 보여주었습니다. 느린 충격파는 형성되지 않습니다.</p>
<p><strong>Petschek이 작동하는 경우:</strong></p>
<p>Petschek 재결합은 다음 경우에 발생할 수 있습니다:</p>
<ol>
<li><strong>국소화된 저항</strong>: X-점 근처에서 $\eta$ 증가(예: 비정상 저항에 의해)</li>
<li><strong>시간 의존적</strong>: Sweet-Parker로 진화하기 전 과도적 빠른 재결합</li>
<li><strong>운동학적 효과</strong>: 무충돌 재결합(Hall MHD, 이유체, 운동학적)</li>
</ol>
<p>균일한 $\eta$를 갖는 저항 MHD에서 Sweet-Parker는 안정적인 정상 상태입니다. 그러나 자연은 균일한 저항을 거의 제공하지 않으며, 무충돌 효과가 많은 플라즈마에서 지배적입니다.</p>
<h2 id="4-hall-mhd">4. Hall MHD 및 무충돌 재결합<a class="header-link" href="#4-hall-mhd" title="Permanent link">&para;</a></h2>
<h3 id="41-hall">4.1 Hall 항<a class="header-link" href="#41-hall" title="Permanent link">&para;</a></h3>
<p>무충돌 플라즈마에서 이온과 전자는 이온 관성 길이(이온 표피 깊이)보다 작은 척도에서 독립적으로 움직일 수 있습니다:</p>
<p>$$d_i = \frac{c}{\omega_{pi}} = \frac{1}{\sqrt{\mu_0 n e^2 / m_i}} \approx 2.28 \times 10^7 \sqrt{\frac{10^6 \text{ cm}^{-3}}{n}} \text{ cm}$$</p>
<p>전형적인 태양 코로나 매개변수($n \sim 10^{10}$ cm⁻³)의 경우, $d_i \sim 70$ km로, 전체 척도 $L \sim 10^4$ km보다 훨씬 작습니다.</p>
<p>$d_i$보다 작은 척도에서 일반화된 Ohm 법칙의 Hall 항이 중요해집니다:</p>
<p>$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \eta \mathbf{J} + \frac{1}{ne} \mathbf{J} \times \mathbf{B} + \text{other terms}$$</p>
<p>Hall 항은 $\mathbf{J} \times \mathbf{B}/(ne)$입니다.</p>
<p><strong>물리적 해석:</strong></p>
<ul>
<li>척도 $\gg d_i$: 전자와 이온이 함께 움직임(단일 유체 MHD)</li>
<li>척도 $\sim d_i$: 이온이 자기장으로부터 분리</li>
<li>척도 $< d_i$: 전자가 전류를 운반하고 동역학 제어</li>
</ul>
<h3 id="42-hall-mhd">4.2 Hall MHD 방정식<a class="header-link" href="#42-hall-mhd" title="Permanent link">&para;</a></h3>
<p>Hall MHD는 다음으로 구성됩니다:</p>
<p><strong>연속:</strong></p>
<p>$$\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0$$</p>
<p><strong>운동량:</strong></p>
<p>$$\rho \frac{d\mathbf{v}}{dt} = -\nabla p + \mathbf{J} \times \mathbf{B}$$</p>
<p><strong>유도(Hall 항 포함):</strong></p>
<p>$$\frac{\partial \mathbf{B}}{\partial t} = \nabla \times (\mathbf{v} \times \mathbf{B}) - \nabla \times \left( \frac{1}{ne} \mathbf{J} \times \mathbf{B} \right) + \eta \nabla^2 \mathbf{B}$$</p>
<p><strong>Ampère 법칙:</strong></p>
<p>$$\mathbf{J} = \frac{1}{\mu_0} \nabla \times \mathbf{B}$$</p>
<p>Hall 항은 다음과 같이 재작성될 수 있습니다:</p>
<p>$$\nabla \times \left( \frac{1}{ne} \mathbf{J} \times \mathbf{B} \right) = \nabla \times \left( \frac{1}{\mu_0 ne} (\nabla \times \mathbf{B}) \times \mathbf{B} \right)$$</p>
<p>이온 표피 깊이 $d_i = c/\omega_{pi}$를 정의하면, 이 항은 $v_A B/d_i$로 스케일링됩니다.</p>
<h3 id="43-hall">4.3 Hall 재결합의 구조<a class="header-link" href="#43-hall" title="Permanent link">&para;</a></h3>
<p>Hall 재결합은 <strong>2-척도 구조</strong>를 가집니다:</p>
<ol>
<li><strong>외부 영역</strong> ($r > d_i$): 이온 제어, 표준 MHD를 따름</li>
<li>이온과 전자가 자기장에 동결</li>
<li>
<p>척도: $L \sim 100 d_i$ 이상</p>
</li>
<li>
<p><strong>내부 확산 영역</strong> ($r \sim d_i$): 전자 제어</p>
</li>
<li>이온이 분리되고, 전자가 자기장에 동결</li>
<li>면외(Hall) 자기장 생성</li>
<li>전자가 전류를 운반</li>
</ol>
<p><strong>사중극 Hall 자기장:</strong></p>
<p>Hall 항은 사중극 대칭을 갖는 면외(가이드 자기장 방향) 자기장을 생성합니다:</p>
<div class="highlight"><pre><span></span><code>        B_z &gt; 0  |  B_z &lt; 0
                 |
      ━━━━━━━━━━X━━━━━━━━━━
                 |
        B_z &lt; 0  |  B_z &gt; 0
</code></pre></div>

<p>이 사중극 $B_z$ 구조는 Hall 재결합의 <strong>결정적 증거</strong>로, 다음에서 관측됩니다:
- 자기꼬리 재결합(Cluster, MMS 위성)
- 실험실 재결합 실험(MRX, VTF)
- 시뮬레이션(GEM Challenge)</p>
<h3 id="44-hall">4.4 Hall 재결합률<a class="header-link" href="#44-hall" title="Permanent link">&para;</a></h3>
<p>핵심 결과: <strong>Hall 재결합은 큰 $S$에 대해 저항률과 독립적인 빠른 속도를 제공합니다</strong>.</p>
<p><strong>스케일링 논증:</strong></p>
<p>이온 확산 영역에서 재결합 전기장은:</p>
<p>$$E_z \sim v_{in} B_{in}$$</p>
<p>전자 확산 영역(크기 $\delta_e \sim d_e$, 전자 표피 깊이)에서 전자 물리학이 지배적입니다. 재결합률은 전자 동역학으로 설정되어:</p>
<p>$$v_{in} \sim 0.1 v_A$$</p>
<p>속도 $M_A \sim 0.1$은 많은 Hall MHD 시뮬레이션에서 관측되며 $S$와 독립적입니다($S$가 $d_i < L$이 되도록 충분히 크다면).</p>
<p><strong>왜 빠른가?</strong></p>
<p>이온 분리는 훨씬 짧은 확산 영역($\delta \sim d_i$ 대신 $\delta \sim L/S^{1/2}$)을 허용합니다. 종횡비는:</p>
<p>$$\frac{\delta}{L} \sim \frac{d_i}{L}$$</p>
<p>$1/S$가 아니므로, 재결합률은 저항률과 독립적이 됩니다.</p>
<h3 id="45-gem">4.5 GEM 재결합 챌린지<a class="header-link" href="#45-gem" title="Permanent link">&para;</a></h3>
<p>GEM(Geospace Environmental Modeling) 자기 재결합 챌린지(Birn et al. 2001)는 재결합 시뮬레이션을 벤치마크하기 위한 커뮤니티 노력이었습니다.</p>
<p><strong>설정:</strong></p>
<ul>
<li>Harris 전류 시트 평형</li>
<li>2D 주기적 영역</li>
<li>다양한 코드: Hall MHD, 이유체, 하이브리드, 완전 PIC</li>
<li>재결합률, 구조, 시간 진화 비교</li>
</ul>
<p><strong>핵심 결과:</strong></p>
<ol>
<li><strong>빠른 재결합</strong>: 모든 코드가 큰 $S$에 대해 $\eta$와 독립적인 $M_A \sim 0.1$을 발견</li>
<li><strong>사중극 Hall 자기장</strong>: 모든 Hall/운동학적 모델에서 확인</li>
<li><strong>2-척도 구조</strong>: 이온 및 전자 확산 영역이 명확히 분리</li>
<li><strong>전자 가열</strong>: X-점 근처에서 온도 비등방성 발생</li>
<li><strong>플라스모이드 형성</strong>: 매우 큰 $S$에서 2차 섬 형성(레슨 7 참조)</li>
</ol>
<p>GEM 챌린지는 무충돌 재결합이 일반적으로 빠르다는 것을 확립하여 우주 플라즈마에 대한 재결합률 문제를 해결했습니다.</p>
<h2 id="5-x-">5. X-점 기하학 및 자기 위상 구조<a class="header-link" href="#5-x-" title="Permanent link">&para;</a></h2>
<h3 id="51-x-">5.1 X-점 구성<a class="header-link" href="#51-x-" title="Permanent link">&para;</a></h3>
<p>X-점은 $\mathbf{B} = 0$인 <strong>자기 영점</strong>입니다. 2D에서 X-점 근처에서 자기장은 Taylor 전개될 수 있습니다:</p>
<p>$$B_x \approx B_0 \frac{x}{L}$$</p>
<p>$$B_y \approx -B_0 \frac{y}{L}$$</p>
<p>여기서 $B_0$와 $L$은 특성 자기장 강도 및 길이 척도입니다.</p>
<p>X-점 근처의 <strong>자기장 선</strong>은 쌍곡선입니다:</p>
<p>$$xy = \text{const}$$</p>
<p><strong>분리선</strong>은 X-점을 통과하는 자기장 선입니다(const = 0):
- $x = 0$: 수직 분리선
- $y = 0$: 수평 분리선</p>
<p>이들은 서로 다른 자기 위상 구조의 영역을 분리합니다.</p>
<h3 id="52">5.2 자기 위상 구조 및 위상 변화<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<p><strong>자기 위상 구조</strong>는 자기장 선의 연결성을 의미합니다. 2D에서 위상 구조는 다음으로 특징지어집니다:
- 어떤 자기장 선이 어떤 경계와 연결되는지
- X-점(영점) 및 O-점(극값)의 위치</p>
<p><strong>이상 MHD는 위상 구조를 보존합니다:</strong></p>
<p>이상 MHD에서 동결 정리는 자기장 선 연결성이 보존됨을 보장합니다. 두 플라즈마 요소가 처음에 같은 자기장 선에 있으면, 계속 같은 자기장 선에 남습니다.</p>
<p><strong>재결합은 위상 구조를 변화시킵니다:</strong></p>
<p>재결합은 자기장 선이 끊어지고 재결합하여 연결성을 변경할 수 있게 합니다. 이것이 재결합의 본질입니다.</p>
<div class="highlight"><pre><span></span><code>재결합 전:                  재결합 후:

    A ════════════ B            A ════╗
                                      ║
         X (no flow)                  X (reconnection)
                                      ║
    C ════════════ D            C ════╝

    A는 B에 연결                A는 D에 연결
    C는 D에 연결                C는 B에 연결
</code></pre></div>

<p>위상 구조 변화 속도는 재결합 전기장 $E_z$로 측정됩니다.</p>
<h3 id="53">5.3 분리선 및 자기 섬<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<p><strong>분리선</strong>은 서로 다른 위상 구조의 영역을 나눕니다. 분리선을 가로지르는 플라즈마는 자기장 선 연결을 변경합니다.</p>
<p><strong>자기 섬(O-점):</strong></p>
<p>재결합이 완전하지 않을 때, 닫힌 자기장 선이 형성되어 자기 섬(플라스모이드)을 생성할 수 있습니다. O-점은 자속 함수 $\psi$의 국소 최대/최소입니다.</p>
<p>전류 시트에서 여러 X-점과 O-점이 형성될 수 있습니다:</p>
<div class="highlight"><pre><span></span><code>    ────────O────X────O────X────O────
</code></pre></div>

<p>이 체인 구조는 난류 또는 고$S$ 재결합에서 중요합니다(플라스모이드 불안정성, 레슨 7).</p>
<h3 id="54">5.4 벡터 포텐셜 및 자속 함수<a class="header-link" href="#54" title="Permanent link">&para;</a></h3>
<p>2D에서 자기장은 자속 함수 $\psi$로 표현될 수 있습니다:</p>
<p>$$\mathbf{B} = \nabla \psi \times \hat{z}$$</p>
<p>또는 성분으로:</p>
<p>$$B_x = \frac{\partial \psi}{\partial y}, \quad B_y = -\frac{\partial \psi}{\partial x}$$</p>
<p>자기장 선은 $\psi$의 등고선입니다. X-점은 $\psi$의 안장점이고, O-점은 국소 극값입니다.</p>
<p>유도 방정식은 $\psi$에 대한 진화 방정식이 됩니다:</p>
<p>$$\frac{\partial \psi}{\partial t} = -E_z + \eta J_z$$</p>
<p>여기서 $J_z = -\nabla^2 \psi / \mu_0$입니다.</p>
<p>X-점에서 $\nabla \psi = 0$($\mathbf{B} = 0$이므로)이므로:</p>
<p>$$\left( \frac{\partial \psi}{\partial t} \right)_{X} = -E_z$$</p>
<p>재결합 전기장은 X-점에서 자속 변화율을 직접 측정합니다.</p>
<h2 id="6">6. 재결합률 측정<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 무차원 재결합률<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>표준 측정은 <strong>Alfvénic Mach 수</strong>입니다:</p>
<p>$$M_A = \frac{v_{in}}{v_A}$$</p>
<p>여기서 $v_{in}$은 확산 영역으로의 유입 속도이고 $v_A = B_{in}/\sqrt{\mu_0 \rho}$는 상류 자기장을 기반으로 한 Alfvén 속도입니다.</p>
<p><strong>전형적인 값:</strong></p>
<ul>
<li>Sweet-Parker: $M_A \sim S^{-1/2} \sim 10^{-7}$ (태양 코로나의 경우)</li>
<li>Petschek: $M_A \sim (\ln S)^{-1} \sim 0.01$</li>
<li>Hall/무충돌: $M_A \sim 0.1$</li>
</ul>
<h3 id="62">6.2 재결합 전기장<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p>동등한 측정은 재결합 전기장 $E_{rec}$입니다:</p>
<p>$$E_{rec} = v_{in} B_{in}$$</p>
<p>특성 전기장 $v_A B_{in}$으로 정규화:</p>
<p>$$\tilde{E} = \frac{E_{rec}}{v_A B_{in}} = M_A$$</p>
<p>정상 상태에서 $E_{rec}$는 재결합 영역 전체에서 균일합니다.</p>
<h3 id="63">6.3 자속 전달률<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<p>단위 시간당 재결합되는 자기 자속의 속도(3차원의 단위 길이당):</p>
<p>$$\frac{d\Phi}{dt} = E_{rec} \cdot (\text{length in } z)$$</p>
<p>2D 시뮬레이션에서 이것은 재결합 단계를 진단하기 위해 시간의 함수로 종종 플롯됩니다.</p>
<h3 id="64">6.4 관측적 측정<a class="header-link" href="#64" title="Permanent link">&para;</a></h3>
<p>관측(예: 우주선 데이터)에서 재결합률은 다음으로부터 추론됩니다:</p>
<ol>
<li><strong>유입 속도</strong>: Doppler 이동 또는 입자 기기로 측정</li>
<li><strong>유출 속도</strong>: 종종 $v_A$ 근처, Alfvénic 재결합 확인</li>
<li><strong>Hall 자기장</strong>: 사중극 $B_z$ 신호(MMS 관측)</li>
<li><strong>에너지 입자</strong>: 가속된 입자는 재결합을 나타냄</li>
</ol>
<p>태양 플레어의 경우, 재결합률은 다음으로부터 추정됩니다:</p>
<p>$$M_A \sim \frac{v_{up}}{v_A}$$</p>
<p>여기서 $v_{up}$는 위쪽으로 움직이는 플레어 리본의 속도(재결합 발자국 추적)로, 일반적으로 $\sim 10$–100 km/s이며, $M_A \sim 0.01$–$0.1$을 제공합니다.</p>
<h2 id="7-python">7. Python 예제<a class="header-link" href="#7-python" title="Permanent link">&para;</a></h2>
<h3 id="71-sweet-parker-vs-petschek">7.1 Sweet-Parker vs Petschek 스케일링<a class="header-link" href="#71-sweet-parker-vs-petschek" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Lundquist number range</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Sweet-Parker reconnection rate</span>
<span class="n">M_SP</span> <span class="o">=</span> <span class="n">S</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Petschek reconnection rate</span>
<span class="n">M_P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>

<span class="c1"># Hall reconnection rate (approximately constant)</span>
<span class="n">M_Hall</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">M_SP</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sweet-Parker ($S^{-1/2}$)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">M_P</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Petschek ($\pi/(8\ln S)$)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">M_Hall</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hall (collisionless)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Mark typical regimes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Laboratory&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1e14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e14</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Solar corona&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lundquist number $S$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A = v_</span><span class="si">{in}</span><span class="s1">/v_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reconnection Rate Scaling&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1e16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reconnection_rate_scaling.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print example values</span>
<span class="n">S_examples</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="mf">1e14</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reconnection rates for different regimes:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;S&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Sweet-Parker&#39;</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Petschek&#39;</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Hall&#39;</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">S_examples</span><span class="p">:</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="n">s</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">&gt;10.1e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sp</span><span class="si">:</span><span class="s2">&gt;15.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">&gt;15.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">&gt;15.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="72-x-">7.2 X-점 자기장 구조<a class="header-link" href="#72-x-" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Create grid</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Magnetic field components for X-point (normalized)</span>
<span class="n">Bx</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">By</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span>

<span class="c1"># Field magnitude</span>
<span class="n">B_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create figure with field lines and strength</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Left panel: Field lines</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Plot field lines using streamplot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">B_mag</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
              <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X-point&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Separatrices&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;X-Point Magnetic Field Lines&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Right panel: Field strength</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">B_mag</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">B_mag</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;wx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$|</span><span class="se">\\</span><span class="s1">mathbf</span><span class="si">{B}</span><span class="s1">|/B_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnetic Field Strength&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;xpoint_structure.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot hyperbolic field lines explicitly</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Field lines are xy = const</span>
<span class="n">constants</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constants</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x_pos</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">y_pos</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">x_pos</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">y_pos</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">x_pos</span><span class="p">,</span> <span class="o">-</span><span class="n">y_pos</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x_neg</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">y_neg</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">x_neg</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_neg</span><span class="p">,</span> <span class="n">y_neg</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">x_neg</span><span class="p">,</span> <span class="o">-</span><span class="n">y_neg</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Separatrices</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Separatrices&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X-point (null)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hyperbolic Field Lines Near X-Point&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;xpoint_hyperbolic.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="73-sweet-parker">7.3 Sweet-Parker 확산 영역 종횡비<a class="header-link" href="#73-sweet-parker" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Lundquist number</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Sweet-Parker aspect ratio</span>
<span class="n">delta_over_L</span> <span class="o">=</span> <span class="n">S</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Sheet length to width ratio</span>
<span class="n">L_over_delta</span> <span class="o">=</span> <span class="n">S</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Left: aspect ratio</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">delta_over_L</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">delta/L = 0.1$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">delta/L = 0.01$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Lundquist number $S$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Aspect ratio $</span><span class="se">\\</span><span class="s1">delta/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sweet-Parker Diffusion Region Aspect Ratio&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Right: reconnection rate vs aspect ratio</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">M_A</span> <span class="o">=</span> <span class="n">S</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">delta_over_L</span><span class="p">,</span> <span class="n">M_A</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Aspect ratio $</span><span class="se">\\</span><span class="s1">delta/L$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$M_A$ vs $</span><span class="se">\\</span><span class="s1">delta/L$ (Sweet-Parker)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="c1"># Add scaling annotation</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s1">&#39;$M_A = </span><span class="se">\\</span><span class="s1">delta/L = S^{-1/2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sweet_parker_aspect_ratio.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print examples</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sweet-Parker diffusion region properties:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;S&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;δ/L&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;L/δ&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;M_A&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">S_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="mf">1e12</span><span class="p">,</span> <span class="mf">1e14</span><span class="p">]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">S_vals</span><span class="p">:</span>
    <span class="n">d_L</span> <span class="o">=</span> <span class="n">s</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">L_d</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">s</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">&gt;12.0e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">d_L</span><span class="si">:</span><span class="s2">&gt;12.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">L_d</span><span class="si">:</span><span class="s2">&gt;12.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">M</span><span class="si">:</span><span class="s2">&gt;12.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="74-hall">7.4 Hall 재결합 사중극 자기장<a class="header-link" href="#74-hall" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Grid</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># In-plane reconnecting field (X-point)</span>
<span class="n">Bx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="n">By</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">X</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Out-of-plane Hall field (quadrupolar)</span>
<span class="c1"># Model: Bz proportional to xy near origin, decaying with distance</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Bz</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Current sheet profile</span>
<span class="n">J_z</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Panel 1: In-plane field</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;In-Plane Magnetic Field ($B_x$, $B_y$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Panel 2: Out-of-plane Hall field</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bz</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bz</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$B_z/B_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Out-of-Plane Hall Field ($B_z$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Panel 3: Current density</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">J_z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">J_z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$J_z/J_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Current Density ($J_z$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Panel 4: Line plot of Bz along x-axis</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_cuts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">y_cut</span> <span class="ow">in</span> <span class="n">y_cuts</span><span class="p">:</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_cut</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Bz</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$y/d_i = </span><span class="si">{</span><span class="n">y_cut</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x/d_i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$B_z/B_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hall Field Profile Along $x$ (Quadrupolar Structure)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hall_reconnection_field.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Schematic of two-scale structure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Outer ion diffusion region</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_ion</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y_ion</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x_ion</span><span class="p">,</span> <span class="n">y_ion</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ion diffusion region ($</span><span class="se">\\</span><span class="s1">sim d_i$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_ion</span><span class="p">,</span> <span class="n">y_ion</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Inner electron diffusion region</span>
<span class="n">x_elec</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y_elec</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x_elec</span><span class="p">,</span> <span class="n">y_elec</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Electron diffusion region ($</span><span class="se">\\</span><span class="s1">sim d_e$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_elec</span><span class="p">,</span> <span class="n">y_elec</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># X-point</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Separatrices</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Inflow/outflow arrows</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Inflow&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;Outflow&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Two-Scale Structure of Hall Reconnection&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hall_two_scale_structure.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="75">7.5 재결합률 진화<a class="header-link" href="#75" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Time array</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># Sweet-Parker approach to steady state (slow)</span>
<span class="n">M_SP</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mi">30</span><span class="p">))</span>

<span class="c1"># Petschek burst (faster)</span>
<span class="n">M_P</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Hall reconnection (fast, sustained)</span>
<span class="n">M_Hall</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Combined example: onset, burst, quasi-steady</span>
<span class="n">M_combined</span> <span class="o">=</span> <span class="n">M_SP</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">M_combined</span> <span class="o">+=</span> <span class="n">M_P</span>
<span class="n">M_combined</span> <span class="o">+=</span> <span class="n">M_Hall</span> <span class="o">*</span> <span class="mf">0.5</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Panel 1: Individual models</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_SP</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sweet-Parker (slow)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_P</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Petschek burst&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_Hall</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hall (fast)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time ($t v_A / L$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Idealized Reconnection Rate Profiles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>

<span class="c1"># Panel 2: Combined realistic scenario</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M_combined</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Typical Hall rate (~0.1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Typical Petschek rate (~0.01)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">M_combined</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>

<span class="c1"># Annotate phases</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Onset&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Burst&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Quasi-steady&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time ($t v_A / L$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection rate $M_A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Realistic Time-Dependent Reconnection&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reconnection_rate_evolution.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="_2">요약<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>자기 재결합은 자기 위상 구조를 변화시키고 자기 에너지를 플라즈마 에너지로 변환하는 기본 과정입니다. 다음을 다루었습니다:</p>
<ol>
<li>
<p><strong>Sweet-Parker 모델</strong>: 길고 얇은 전류 시트에서의 정상 상태 재결합. 속도 $M_A \sim S^{-1/2}$는 $S \sim 10^{14}$일 때 천체물리학 응용에는 너무 느립니다.</p>
</li>
<li>
<p><strong>Petschek 모델</strong>: 느린 MHD 충격파를 동반한 재결합으로, 속도 $M_A \sim (\ln S)^{-1} \sim 0.01$을 제공합니다. 그러나 이것은 국소화된 저항을 필요로 하며 균일한 $\eta$에서는 불안정합니다.</p>
</li>
<li>
<p><strong>Hall MHD 재결합</strong>: 무충돌 플라즈마에서 이온은 $\sim d_i$(이온 표피 깊이) 척도에서 분리되어 2-척도 구조로 이어집니다. 재결합률은 빠르며($M_A \sim 0.1$) 저항률과 독립적입니다. 사중극 Hall 자기장은 핵심 관측 신호입니다.</p>
</li>
<li>
<p><strong>X-점 기하학</strong>: $\mathbf{B} = 0$인 자기 영점으로, 쌍곡선 자기장 선 구조를 가집니다. 분리선은 서로 다른 위상 구조의 영역을 나눕니다. 재결합은 자기장 선 연결성을 변경합니다.</p>
</li>
<li>
<p><strong>재결합률 측정</strong>: 무차원 속도 $M_A = v_{in}/v_A$가 표준 측정입니다. 태양 플레어 및 자기권 서브스톰에서 관측된 속도는 $\sim 0.01$–$0.1$로, Petschek 및 Hall 재결합과 일치합니다.</p>
</li>
</ol>
<p>재결합률 문제의 해결은 무충돌 효과(Hall 물리학, 운동학적 효과)가 대부분의 자연 플라즈마에서 지배적이며, 고전적 저항과 독립적인 빠른 재결합을 가능하게 한다는 인식에서 나왔습니다. GEM 챌린지는 운동학적 재결합이 일반적으로 $M_A \sim 0.1$을 제공함을 확인했습니다.</p>
<h2 id="_3">연습 문제<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Sweet-Parker 스케일링</strong>:
   a) 질량 보존, 운동량 균형 및 Ohm 법칙으로부터 Sweet-Parker 재결합률을 유도하세요.
   b) 지구 자기꼬리($L = 10^7$ m, $B = 20$ nT, $n = 10^6$ m⁻³, $\eta = 10^{-2}$ Ω·m)에 대해 $S$와 $M_A$를 계산하세요.
   c) 재결합 시간 척도를 추정하세요. 이것이 관측된 서브스톰 시작 시간(~1시간)과 일치합니까?</p>
</li>
<li>
<p><strong>Petschek vs Sweet-Parker</strong>:
   a) 어떤 Lundquist 수에서 Petschek 속도가 Sweet-Parker 속도를 초과합니까?
   b) $S = 10^2$에서 $10^{16}$까지 $S$의 함수로 비율 $M_P / M_{SP}$를 플롯하세요.
   c) Petschek이 더 빠른 이유를 물리적으로 설명하세요.</p>
</li>
<li>
<p><strong>Hall 재결합</strong>:
   a) 태양 코로나 매개변수($n = 10^{16}$ m⁻³)에 대해 이온 표피 깊이 $d_i$를 계산하세요.
   b) 전체 척도가 $L = 10^9$ m이면 척도 분리 $L/d_i$는 얼마입니까?
   c) 2-척도 구조(이온 및 전자 확산 영역)를 스케치하세요.</p>
</li>
<li>
<p><strong>X-점 자기장</strong>:
   a) 자기장 $\mathbf{B} = B_0 (x \hat{x} - y \hat{y})/L$에 대해 자기장 선($\psi$의 등고선)을 찾으세요.
   b) 위치의 함수로 자기장 강도 $|\mathbf{B}|$를 계산하세요.
   c) $|\mathbf{B}|$가 최대인 곳은? 최소인 곳은?</p>
</li>
<li>
<p><strong>재결합 전기장</strong>:
   a) $v_{in} = 0.1 v_A$이고 $B_{in} = 0.01$ T이면 재결합 전기장 $E_{rec}$는 얼마입니까?
   b) Alfvén 속도가 $v_A = 10^6$ m/s이면 $E_{rec}$를 V/m로 계산하세요.
   c) $z$ 방향의 1000 km 길이에 걸쳐 초당 얼마나 많은 자기 자속이 재결합됩니까?</p>
</li>
<li>
<p><strong>사중극 Hall 자기장</strong>:
   a) Hall 항 $\mathbf{J} \times \mathbf{B}/(ne)$가 면외 자기장을 생성하는 이유를 물리적으로 설명하세요.
   b) $xy$-평면의 X-점에 대한 사중극 $B_z$ 구조를 스케치하세요.
   c) 확산 영역을 가로지르는 우주선이 이 자기장을 어떻게 관측할 것입니까?</p>
</li>
<li>
<p><strong>시뮬레이션 분석</strong>:
   a) 2D MHD 시뮬레이션에서 재결합 단계 동안 $v_{in} = 0.05 v_A$를 측정합니다. $M_A$는 얼마입니까?
   b) 시뮬레이션이 $\eta = 10^{-4}$(코드 단위), $L = 10$, $v_A = 1$을 가지면 $S$를 계산하세요.
   c) 이 재결합률은 Sweet-Parker, Petschek 또는 Hall 재결합과 일치합니까?</p>
</li>
<li>
<p><strong>에너지 변환</strong>:
   a) 단위 부피당 자기 에너지 유입률은 $\sim v_{in} B^2/(2\mu_0)$입니다. $M_A = 0.1$이면 이것을 $v_A$와 $B$로 표현하세요.
   b) 자기 에너지 유입률을 운동 에너지 유출률 $\sim \rho v_{out}^3 / 2$와 비교하세요.
   c) "누락된" 에너지는 어디로 갑니까?</p>
</li>
<li>
<p><strong>GEM 챌린지</strong>:
   a) GEM 재결합 챌린지 설정(Harris 시트, 섭동, 경계 조건)을 조사하세요.
   b) 서로 다른 코드의 재결합률에 관한 핵심 발견은 무엇이었습니까?
   c) 저항 MHD 결과가 Hall MHD 및 운동학적 결과와 어떻게 달랐습니까?</p>
</li>
<li>
<p><strong>관측적 신호</strong>:
    a) 자기꼬리에서 자기 재결합의 세 가지 관측적 신호를 나열하세요.
    b) MMS(Magnetospheric Multiscale) 임무는 Hall 자기장을 어떻게 측정합니까?
    c) 우주선이 이온 확산 영역을 가로지르지만 전자 확산 영역은 가로지르지 않으면 무엇을 관측할 것으로 예상합니까?</p>
</li>
</ol>
<h2 id="_4">네비게이션<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<p>이전: <a href="./04_Current_Driven_Instabilities.md">전류 구동 불안정성</a> | 다음: <a href="./06_Reconnection_Applications.md">재결합 응용</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/04_Current_Driven_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">4. 전류 구동 불안정성</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/06_Reconnection_Applications.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">6. 재결합 응용</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}