{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10. 난류 Dynamo - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">10. 난류 Dynamo</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>10. 난류 Dynamo</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/09_Dynamo_Theory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">9. Dynamo Theory</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/11_Solar_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">11. 태양 MHD</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">학습 목표</a></li>
<li><a href="#1-dynamos">1. 난류 Dynamos 소개</a><ul>
<li><a href="#11">1.1 난류 구동 자기장 생성</a></li>
<li><a href="#12-dynamos">1.2 소규모 대 대규모 Dynamos</a></li>
</ul>
</li>
<li><a href="#2-dynamo">2. 소규모 Dynamo 이론</a><ul>
<li><a href="#21-kazantsev-1968">2.1 Kazantsev 이론 (1968)</a></li>
<li><a href="#22-reynolds">2.2 임계 자기 Reynolds 수</a></li>
<li><a href="#23">2.3 연신 메커니즘</a></li>
<li><a href="#24">2.4 포화와 비선형 영역</a></li>
</ul>
</li>
<li><a href="#3-dynamo">3. 난류에서의 대규모 Dynamo</a><ul>
<li><a href="#31-helicity">3.1 자기 Helicity의 역 캐스케이드</a></li>
<li><a href="#32-dynamo-helicity">3.2 대규모 Dynamo에 대한 Helicity 제약</a></li>
<li><a href="#33-dynamo">3.3 평균장 난류 Dynamo</a></li>
</ul>
</li>
<li><a href="#4-prandtl">4. 자기 Prandtl 수 효과</a><ul>
<li><a href="#41">4.1 정의와 영역</a></li>
<li><a href="#42-pm-dynamo">4.2 높은 Pm 영역의 Dynamo</a></li>
<li><a href="#43-pm-dynamo">4.3 낮은 Pm 영역의 Dynamo</a></li>
</ul>
</li>
<li><a href="#5-dynamos">5. 난류 Dynamos의 수치 시뮬레이션</a><ul>
<li><a href="#51-dns">5.1 직접 수치 시뮬레이션(DNS)</a></li>
<li><a href="#52-large-eddy-simulation-les">5.2 Large Eddy Simulation (LES)</a></li>
<li><a href="#53">5.3 강제와 경계 조건</a></li>
<li><a href="#54">5.4 분석 도구</a></li>
</ul>
</li>
<li><a href="#6-dynamo">6. 난류 Dynamo의 응용</a><ul>
<li><a href="#61-ism">6.1 성간 매질(ISM)</a></li>
<li><a href="#62">6.2 은하단</a></li>
<li><a href="#63">6.3 강착 원반</a></li>
<li><a href="#64">6.4 초기 우주</a></li>
</ul>
</li>
<li><a href="#7-python">7. Python 구현</a><ul>
<li><a href="#71-kazantsev">7.1 Kazantsev 스펙트럼 모델</a></li>
<li><a href="#72-dynamo">7.2 소규모 Dynamo 성장 시뮬레이션</a></li>
<li><a href="#73-helicity">7.3 자기 Helicity 진화</a></li>
<li><a href="#74-dynamo">7.4 Dynamo가 있는 난류 캐스케이드</a></li>
<li><a href="#75-dynamo-pm">7.5 Dynamo 시작의 Pm 의존성</a></li>
</ul>
</li>
<li><a href="#8">8. 요약</a></li>
<li><a href="#_2">연습 문제</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="10-dynamo">10. 난류 Dynamo<a class="header-link" href="#10-dynamo" title="Permanent link">&para;</a></h1>
<h2 id="_1">학습 목표<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>이 레슨을 마치면 다음을 할 수 있어야 합니다:</p>
<ul>
<li>소규모(변동) 및 대규모(평균장) 난류 dynamos 구별하기</li>
<li>Kazantsev 이론과 난류에서 자기장의 kinematic 성장 이해하기</li>
<li>Dynamo 작용에서 자기 Prandtl 수(Pm)의 역할 설명하기</li>
<li>자기 helicity 보존과 대규모 dynamo 성장에 대한 제약 분석하기</li>
<li>포화 메커니즘과 kinematic에서 dynamic 영역으로의 전환 설명하기</li>
<li>MHD 난류를 위한 수치 시뮬레이션 접근법(DNS, LES) 이해하기</li>
<li>소규모 dynamo 성장과 helicity 진화 모델 구현하기</li>
</ul>
<h2 id="1-dynamos">1. 난류 Dynamos 소개<a class="header-link" href="#1-dynamos" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 난류 구동 자기장 생성<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>많은 천체물리학 환경—항성 내부, 강착 원반, 성간 매질, 은하단—에서 흐름은 고도로 <strong>난류</strong>입니다. 난류 dynamos는 층류 dynamos와 몇 가지 핵심 방식에서 다릅니다:</p>
<ol>
<li>
<p><strong>광범위한 스케일 스펙트럼:</strong> 난류는 에너지 주입 스케일 <code>L</code>부터 소산 스케일(Kolmogorov 스케일 <code>η_K</code> 또는 저항 스케일 <code>η_R</code>)까지 광범위한 길이 스케일에 걸친 운동을 포함합니다.</p>
</li>
<li>
<p><strong>확률론적 특성:</strong> 난류 흐름은 혼돈적이고 시간 의존적이어서 통계적 설명이 필요합니다.</p>
</li>
<li>
<p><strong>다중 dynamo 메커니즘:</strong> <strong>소규모 dynamo</strong>(변동 장)와 <strong>대규모 dynamo</strong>(평균 장) 모두 동시에 작동할 수 있습니다.</p>
</li>
</ol>
<p><strong>핵심 질문:</strong>
- Dynamo 시작을 위한 임계 자기 Reynolds 수 <code>Rm_c</code>는 무엇인가?
- 자기장은 어떻게 포화되는가?
- 자기장의 구조는 무엇인가(간헐적, 필라멘트형, 평활)?
- 자기 에너지 스펙트럼 <code>E_B(k)</code>는 운동 에너지 스펙트럼 <code>E_K(k)</code>와 어떻게 비교되는가?</p>
<h3 id="12-dynamos">1.2 소규모 대 대규모 Dynamos<a class="header-link" href="#12-dynamos" title="Permanent link">&para;</a></h3>
<p><strong>소규모(변동) dynamo:</strong>
- 난류 강제 스케일과 <strong>비슷하거나 더 작은</strong> 스케일에서 자기장 증폭
- 난류 연신과 접기에 의해 구동
- Helicity나 대규모 전단 불필요
- 얽힌, 간헐적 자기 구조 생성
- 관련성: ISM, 은하단, 초기 우주</p>
<p><strong>대규모(평균장) dynamo:</strong>
- 난류 강제 스케일<strong>보다 큰</strong> 스케일에서 자기장 생성
- Helicity(예: 회전과 성층으로부터) 또는 대규모 전단 필요
- 결맞는, 조직화된 장 생성(예: 은하 나선, 태양 쌍극)
- 자기 helicity 보존에 의해 제약
- 관련성: 은하, 항성, 행성</p>
<p>둘 다 동시에 작동할 수 있지만, 대규모 dynamo가 더 제약되고 느립니다.</p>
<h2 id="2-dynamo">2. 소규모 Dynamo 이론<a class="header-link" href="#2-dynamo" title="Permanent link">&para;</a></h2>
<h3 id="21-kazantsev-1968">2.1 Kazantsev 이론 (1968)<a class="header-link" href="#21-kazantsev-1968" title="Permanent link">&para;</a></h3>
<p><strong>Kazantsev</strong>는 무작위, 짧은 상관(시간에서) 속도장에서 자기장의 kinematic 성장에 대한 통계 이론을 개발했습니다.</p>
<p><strong>가정:</strong>
- 속도장 <code>v(x,t)</code>는 Gaussian 무작위장
- 상관 시간 <code>τ_c ≪ τ_η = ℓ²/η</code> (짧은 상관, 또는 시간에서 델타 상관)
- 속도 상관 함수:</p>
<div class="highlight"><pre><span></span><code>⟨v_i(x,t) v_j(x&#39;,t&#39;)⟩ = δ(t - t&#39;) K_{ij}(x - x&#39;)
</code></pre></div>

<ul>
<li>등방성, 균질 난류</li>
</ul>
<p><strong>유도 방정식:</strong></p>
<div class="highlight"><pre><span></span><code>∂B/∂t = ∇×(v×B) + η∇²B
</code></pre></div>

<p>Kinematic 영역에서, <code>v</code>는 주어진 것입니다.</p>
<p><strong>자기장 상관자:</strong></p>
<p>2점 자기 상관 텐서를 정의:</p>
<div class="highlight"><pre><span></span><code>M_{ij}(r,t) = ⟨B_i(x,t) B_j(x+r,t)⟩
</code></pre></div>

<p>등방성 난류에서, <code>M_{ij}</code>는 <code>|r|</code>에만 의존하며 다음으로 분해할 수 있습니다:</p>
<div class="highlight"><pre><span></span><code>M_{ij}(r,t) = M_N(r,t) (δ_{ij} - r_i r_j / r²) + M_L(r,t) r_i r_j / r²
</code></pre></div>

<p>여기서 <code>M_N</code>과 <code>M_L</code>은 횡방향 및 종방향 상관 함수입니다.</p>
<p><strong>Kazantsev 방정식:</strong></p>
<p>스칼라 상관 함수 <code>M(r,t) = ⟨B(x,t)·B(x+r,t)⟩</code>에 대해, Kazantsev는 <code>r</code>-공간에서 확산형 방정식을 유도했습니다(델타 상관 속도의 경우):</p>
<div class="highlight"><pre><span></span><code>∂M/∂t = (1/r^{d-1}) ∂/∂r [r^{d-1} (D(r) ∂M/∂r - v(r) M)]
</code></pre></div>

<p>여기서:
- <code>d</code>는 공간 차원(보통 <code>d=3</code>)
- <code>D(r)</code>는 <code>r</code>-공간의 확산 계수, 속도 상관과 관련
- <code>v(r)</code>는 drift 항</p>
<p>짧은 상관 시간과 <code>r → 0</code> 한계에서:</p>
<div class="highlight"><pre><span></span><code>D(r) ≈ D₀ r²
v(r) ≈ v₀ r
</code></pre></div>

<p>여기서 <code>D₀</code>와 <code>v₀</code>는 속도 스펙트럼에 의존하는 상수입니다.</p>
<p><strong>지수 성장:</strong></p>
<p>해 <code>M(r,t) ~ exp(γt) m(r)</code>를 구합니다. <code>r ≪ η_K</code>(작은 스케일)의 경우, 해는:</p>
<div class="highlight"><pre><span></span><code>γ ~ (u_rms / ℓ) × (Rm / Rm_c)^{1/2}   for Rm &gt; Rm_c
</code></pre></div>

<p>여기서:
- <code>ℓ</code>은 난류 상관 스케일
- <code>u_rms</code>는 RMS 속도
- <code>Rm = u_rms ℓ / η</code>
- <code>Rm_c</code>는 임계 자기 Reynolds 수(일반적으로 <code>Rm_c ~ 50-200</code>)</p>
<p><strong>자기 에너지 스펙트럼:</strong></p>
<p>Kinematic 성장 단계에서, 작은 스케일의 자기 에너지 스펙트럼은:</p>
<div class="highlight"><pre><span></span><code>E_B(k) ∝ k^{3/2}   (Kazantsev spectrum)
</code></pre></div>

<p>이것은 Kolmogorov 운동 스펙트럼 <code>E_K(k) ∝ k^{-5/3}</code>보다 <strong>더 가파르며</strong>, 자기 에너지가 작은 스케일에 집중됨(간헐적 구조)을 나타냅니다.</p>
<h3 id="22-reynolds">2.2 임계 자기 Reynolds 수<a class="header-link" href="#22-reynolds" title="Permanent link">&para;</a></h3>
<p>소규모 dynamo 시작은 다음을 요구합니다:</p>
<div class="highlight"><pre><span></span><code>Rm &gt; Rm_c
</code></pre></div>

<p><strong>Pm에 대한 의존성:</strong></p>
<p>임계 <code>Rm_c</code>는 <strong>자기 Prandtl 수</strong>에 의존합니다:</p>
<div class="highlight"><pre><span></span><code>Pm = ν / η
</code></pre></div>

<p>여기서:
- <code>ν</code>는 운동 점성계수
- <code>η</code>는 자기 확산도</p>
<p>수치 시뮬레이션(예: Schekochihin et al., 2004; Brandenburg &amp; Subramanian, 2005)은 다음을 발견합니다:</p>
<ul>
<li><strong>높은 Pm 영역(<code>Pm ≫ 1</code>):</strong> <code>Rm_c ~ 100</code> (Pm에 약하게 의존)</li>
<li>점성 차단이 저항 차단 아래: <code>η_K ≪ η_R</code></li>
<li>
<p>Dynamo가 <code>η_K</code>와 <code>η_R</code> 사이의 스케일에서 작동</p>
</li>
<li>
<p><strong>낮은 Pm 영역(<code>Pm ≪ 1</code>):</strong> Pm이 감소함에 따라 <code>Rm_c</code> 증가</p>
</li>
<li>저항 차단이 점성 차단 아래: <code>η_R ≪ η_K</code></li>
<li>Dynamo가 작은 스케일에서 저항 확산에 의해 억제됨</li>
<li>
<p>확산을 극복하기 위해 속도장에 더 많은 파워 필요</p>
</li>
<li>
<p><strong>Pm ~ 1:</strong> <code>Rm_c ~ 50-100</code></p>
</li>
</ul>
<p><strong>천체물리학적 관련성:</strong>
- <strong>항성:</strong> <code>Pm ~ 10^{-5} - 10^{-7}</code> (매우 작음, 시뮬레이션 어려움)
- <strong>ISM, 은하단:</strong> <code>Pm ≫ 1</code> (dynamo 더 쉬움)
- <strong>실험실 플라즈마:</strong> <code>Pm ~ 10^{-6}</code> (도전적)</p>
<h3 id="23">2.3 연신 메커니즘<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<p>소규모 dynamo의 근본적 구동력은 난류 변형률에 의한 <strong>자기력선의 연신</strong>입니다.</p>
<p><strong>변형률 텐서:</strong></p>
<div class="highlight"><pre><span></span><code>S_{ij} = (1/2)(∂v_i/∂x_j + ∂v_j/∂x_i)
</code></pre></div>

<p><strong>자기장 연신:</strong></p>
<p><code>B</code>와 정렬된 자기력선 요소 <code>δℓ</code>의 진화는 다음을 따릅니다:</p>
<div class="highlight"><pre><span></span><code>d(ln|δℓ|)/dt = S_{ij} (δℓ_i δℓ_j) / |δℓ|²
</code></pre></div>

<p>양의 <strong>Lyapunov 지수</strong> <code>λ &gt; 0</code>를 가진 혼돈 흐름의 경우, 선 요소가 지수적으로 연신됩니다:</p>
<div class="highlight"><pre><span></span><code>|δℓ(t)| ~ exp(λt)
</code></pre></div>

<p>자기장 강도가 <code>B ~ B₀ (|δℓ| / |δℓ₀|)</code> (flux freezing)로 스케일링되므로:</p>
<div class="highlight"><pre><span></span><code>B(t) ~ B₀ exp(λt)
</code></pre></div>

<p>이것이 소규모 dynamo의 kinematic 성장입니다.</p>
<p><strong>Anti-dynamo 제약:</strong></p>
<p>그러나 연신만으로는 충분하지 않습니다. 장선이 흐름과 정렬될 수도 있어(<code>S_{ij}</code>의 주 고유벡터를 따라), <strong>포화</strong> 또는 <strong>억제</strong>로 이어집니다. Dynamo는 다음을 요구합니다:</p>
<ol>
<li><strong>지속적인 연신:</strong> 흐름이 지속적으로 새로운 장 방향을 생성해야 함</li>
<li><strong>접기:</strong> 재연결 또는 위상 재배열이 한 방향으로의 무한정 연신을 방지</li>
</ol>
<h3 id="24">2.4 포화와 비선형 영역<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<p><strong>Kinematic 영역</strong>에서, 자기장은 지수적으로 성장합니다:</p>
<div class="highlight"><pre><span></span><code>B²(t) ~ B₀² exp(2γt)
</code></pre></div>

<p>결국, Lorentz 힘이 중요해집니다:</p>
<div class="highlight"><pre><span></span><code>J × B / (ρv·∇v) ~ B² / (μ₀ρv²) ~ 1
</code></pre></div>

<p>이것이 <strong>비선형(dynamic) 영역</strong>으로의 전환을 표시합니다.</p>
<p><strong>포화 수준:</strong></p>
<p>차원 분석은 다음을 시사합니다:</p>
<div class="highlight"><pre><span></span><code>B_sat² / (2μ₀) ~ ε_B × (1/2) ρ v²
</code></pre></div>

<p>여기서 <code>ε_B</code>는 포화에서의 자기-운동 에너지 비입니다.</p>
<p>시뮬레이션은 다음을 발견합니다:
- <strong>높은 Pm:</strong> <code>ε_B ~ 0.1 - 1</code> (거의 동등분배)
- <strong>낮은 Pm:</strong> <code>ε_B ≪ 1</code> (동등분배 이하, 작은 스케일이 점성에 의해 억제되기 때문)</p>
<p><strong>장 구조:</strong></p>
<p>포화에서:
- 자기장이 고도로 <strong>간헐적</strong>(시트, 필라멘트에 집중)
- <strong>자기 Reynolds 응력</strong> <code>B_iB_j / μ₀</code>가 속도에 역반응
- 작은 스케일에서 난류 운동 에너지의 효과적 감소
- 자기 에너지 스펙트럼 평탄화: <code>E_B(k) ~ k^{-1}</code> to <code>k^{-3/2}</code> (Kazantsev보다 덜 가파름)</p>
<h2 id="3-dynamo">3. 난류에서의 대규모 Dynamo<a class="header-link" href="#3-dynamo" title="Permanent link">&para;</a></h2>
<h3 id="31-helicity">3.1 자기 Helicity의 역 캐스케이드<a class="header-link" href="#31-helicity" title="Permanent link">&para;</a></h3>
<p>소규모 dynamo가 작은 스케일에서 장을 증폭하는 반면, <strong>대규모 dynamo</strong>는 강제보다 큰 스케일에서 결맞는 장을 생성합니다.</p>
<p><strong>핵심 개념:</strong> <strong>자기 helicity</strong>는 보존량(이상 MHD에서)으로 작용하여 제약을 제공합니다.</p>
<p><strong>자기 helicity:</strong></p>
<div class="highlight"><pre><span></span><code>H_B = ∫ A·B dV
</code></pre></div>

<p>여기서 <code>B = ∇×A</code>입니다.</p>
<p><strong>Helicity 보존:</strong></p>
<p>이상 MHD(<code>η → 0</code>)에서, helicity는 보존됩니다:</p>
<div class="highlight"><pre><span></span><code>dH_B/dt = 0   (ideal MHD)
</code></pre></div>

<p>유한 저항도에서:</p>
<div class="highlight"><pre><span></span><code>dH_B/dt = -2η ∫ J·B dV ≈ -2η/ℓ² H_B
</code></pre></div>

<p>따라서 helicity는 저항 시간 척도 <code>τ_η = ℓ²/η</code>에서 붕괴합니다.</p>
<p><strong>역 캐스케이드:</strong></p>
<p>3D MHD 난류에서, 자기 helicity는 <strong>대규모로 캐스케이드</strong>되는 경향이 있고(역 캐스케이드), 자기 에너지는 작은 스케일로 캐스케이드됩니다(순방향 캐스케이드).</p>
<p><strong>Dynamo에 대한 함의:</strong></p>
<ul>
<li>소규모 dynamo가 <strong>소규모 helicity</strong>를 가진 소규모 자기장을 생성</li>
<li>자기 helicity 역 캐스케이드 → <strong>대규모 helicity</strong> 축적</li>
<li>대규모 helicity → 결맞는 대규모 자기장</li>
</ul>
<p>이 메커니즘은 평균장 언어에서 때때로 <strong>α²-dynamo</strong>라고 불립니다.</p>
<h3 id="32-dynamo-helicity">3.2 대규모 Dynamo에 대한 Helicity 제약<a class="header-link" href="#32-dynamo-helicity" title="Permanent link">&para;</a></h3>
<p><strong>문제:</strong> 닫힌(주기적 또는 제한된) 시스템에서, 총 자기 helicity가 보존됩니다. 대규모 장이 성장함에 따라, 대규모 helicity를 축적합니다. 총 helicity를 보존하기 위해, 소규모 helicity가 <strong>반대 부호</strong>로 성장해야 합니다. 이 소규모 helicity는 재앙적 quenching을 통해 α-효과를 억제합니다.</p>
<p><strong>재앙적 α-quenching 재고:</strong></p>
<p>평균장 이론에서, α-효과는 대규모 장에 의해 quench됩니다:</p>
<div class="highlight"><pre><span></span><code>α(B) = α₀ / (1 + Rm (B/B_eq)²)
</code></pre></div>

<p>높은 <code>Rm</code>에서, 이것은 <code>α ~ α₀/Rm → 0</code>로 이어져 dynamo를 차단합니다.</p>
<p><strong>해결책: Helicity 플럭스</strong></p>
<p>경계가 <strong>열려</strong> 있으면(예: 항성 표면, 은하 헤일로), 자기 helicity가 경계를 통해 <strong>탈출</strong>할 수 있습니다:</p>
<div class="highlight"><pre><span></span><code>dH_B/dt = -2η ∫ J·B dV - ∫ (E × A)·dS
</code></pre></div>

<p>여기서 표면 적분은 부피 밖으로의 helicity 플럭스를 나타냅니다.</p>
<p>Helicity 플럭스가 있으면, 제약이 완화됩니다:
- 소규모 helicity가 방출됨
- 대규모 장이 재앙적 quenching 없이 성장 가능
- 포화는 helicity 생성 ~ helicity 플럭스 + 저항 소산일 때 발생</p>
<p><strong>천체물리학적 응용:</strong>
- <strong>태양 dynamo:</strong> 태양풍과 코로나 질량 방출에 의해 운반되는 Helicity
- <strong>은하 dynamo:</strong> 은하풍을 통해 은하간 매질로의 helicity 탈출
- <strong>강착 원반 dynamo:</strong> 안쪽으로 이류되거나 유출에서 방출되는 Helicity</p>
<h3 id="33-dynamo">3.3 평균장 난류 Dynamo<a class="header-link" href="#33-dynamo" title="Permanent link">&para;</a></h3>
<p><strong>대규모 장 진화:</strong></p>
<p>평균장 이론을 상기:</p>
<div class="highlight"><pre><span></span><code>∂⟨B⟩/∂t = ∇×(⟨v⟩×⟨B⟩) + ∇×(α⟨B⟩) + (η + β)∇²⟨B⟩
</code></pre></div>

<p>여기서:
- <code>α ~ -(1/3)τ_c⟨u·(∇×u)⟩</code> (helicity 효과)
- <code>β ~ (1/3)τ_c u²</code> (난류 확산도)</p>
<p><strong>Dynamo 수:</strong></p>
<p>크기 <code>L</code>의 영역에서 α² dynamo의 경우:</p>
<div class="highlight"><pre><span></span><code>D_α = α L / (η + β)
</code></pre></div>

<p>Dynamo 시작: <code>|D_α| ≳ 10</code>.</p>
<p><strong>Helicity 주입:</strong></p>
<p>회전하는, 성층화된 난류(예: 항성 대류 영역)에서:
- <strong>Coriolis 힘</strong> + <strong>밀도 성층</strong> → cyclonic 소용돌이
- Cyclonic 소용돌이가 순 helicity를 가짐: <code>⟨u·(∇×u)⟩ ≠ 0</code>
- Helicity의 부호는 반구에 의존(북과 남에서 반대)</p>
<p><strong>성장률:</strong></p>
<p>Kinematic 영역에서:</p>
<div class="highlight"><pre><span></span><code>γ ~ α² / (η_eff L)
</code></pre></div>

<p>소규모 dynamo 성장률 <code>γ ~ u/ℓ</code>보다 훨씬 <strong>느림</strong>.</p>
<p><strong>포화:</strong></p>
<p>대규모 dynamo는 다음 때 포화됩니다:
- Lorentz 힘이 흐름을 수정(α 감소)
- Helicity 균형: 생성 ≈ 플럭스 + 소산</p>
<h2 id="4-prandtl">4. 자기 Prandtl 수 효과<a class="header-link" href="#4-prandtl" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 정의와 영역<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p><strong>자기 Prandtl 수:</strong></p>
<div class="highlight"><pre><span></span><code>Pm = ν / η = (운동량의 분자 확산) / (자기 확산)
</code></pre></div>

<p><strong>Reynolds 수:</strong></p>
<div class="highlight"><pre><span></span><code>Re = UL / ν    (흐름의 Reynolds 수)
Rm = UL / η    (자기 Reynolds 수)

Pm = Rm / Re
</code></pre></div>

<p><strong>천체물리학적 값:</strong></p>
<ul>
<li><strong>항성 내부:</strong> <code>Pm ~ 10^{-7} - 10^{-5}</code></li>
<li>높은 전도도(낮은 <code>η</code>), 낮은 점성(분자 의미의 높은 <code>ν</code>, 하지만 난류 <code>ν_t</code>는 클 수 있음)</li>
<li><strong>액체 금속(실험):</strong> <code>Pm ~ 10^{-6} - 10^{-5}</code></li>
<li><strong>성간 매질:</strong> <code>Pm ≫ 1</code> (무충돌 플라즈마, 자기 확산이 점성을 지배)</li>
<li><strong>은하단:</strong> <code>Pm ≫ 1</code></li>
</ul>
<p><strong>스케일 분리:</strong></p>
<ul>
<li><strong>Kolmogorov 스케일:</strong> <code>η_K = (ν³/ε)^{1/4}</code> (운동 에너지가 소산되는 최소 스케일)</li>
<li><strong>저항 스케일:</strong> <code>η_R = (η³/ε)^{1/4}</code> (자기 에너지가 소산되는 최소 스케일)</li>
</ul>
<p>비:</p>
<div class="highlight"><pre><span></span><code>η_R / η_K = Pm^{-3/4}
</code></pre></div>

<ul>
<li><code>Pm ≫ 1</code>: <code>η_R ≪ η_K</code> (더 작은 스케일에서 자기 소산)</li>
<li><code>Pm ≪ 1</code>: <code>η_R ≫ η_K</code> (더 작은 스케일에서 점성 소산)</li>
</ul>
<h3 id="42-pm-dynamo">4.2 높은 Pm 영역의 Dynamo<a class="header-link" href="#42-pm-dynamo" title="Permanent link">&para;</a></h3>
<p><strong>특성:</strong>
- 저항 스케일이 점성 스케일 아래: <code>η_R ≪ η_K</code>
- 자기장이 <code>η_K</code>와 <code>η_R</code> 사이의 스케일에서 여기될 수 있음
- 자기장을 위한 <strong>넓은 관성 범위</strong></p>
<p><strong>Dynamo 메커니즘:</strong>
- 소규모 dynamo가 효율적으로 작동
- 임계 <code>Rm_c ~ 100</code> (상대적으로 낮음)
- 동등분배 근처 포화: <code>B² / (2μ₀) ~ ρv²/2</code></p>
<p><strong>응용:</strong>
- <strong>성간 매질:</strong> 난류 구름에서 자기장 증폭
- <strong>은하단:</strong> ICM 난류가 <code>μG</code> 장 생성</p>
<h3 id="43-pm-dynamo">4.3 낮은 Pm 영역의 Dynamo<a class="header-link" href="#43-pm-dynamo" title="Permanent link">&para;</a></h3>
<p><strong>특성:</strong>
- 점성 스케일이 저항 스케일 아래: <code>η_K ≪ η_R</code>
- 자기장이 최소 속도 스케일에 도달하기 전에 소산
- 자기장을 위한 <strong>좁은 관성 범위</strong></p>
<p><strong>Dynamo 메커니즘:</strong>
- 소규모 dynamo가 억제됨(더 높은 <code>Rm_c</code>)
- 포화가 <strong>동등분배 이하</strong>: <code>B²/(2μ₀) ≪ ρv²/2</code>
- 비가 <code>B²/(μ₀ρv²) ~ Pm^{1/2}</code>로 스케일링(Schekochihin et al.)</p>
<p><strong>도전:</strong>
- 낮은 Pm에서의 수치 시뮬레이션은 <code>η_K</code>와 <code>η_R</code> 둘 다의 해상도 필요 → 계산적으로 비용이 큼
- 대부분의 천체물리학 시스템이 <code>Pm ≪ 1</code>을 가지지만, 시뮬레이션은 종종 <code>Pm ~ 1</code> 이상 사용</p>
<p><strong>응용:</strong>
- <strong>항성 dynamos:</strong> 진정한 <code>Pm ~ 10^{-6}</code>, 하지만 효과적 난류 <code>Pm_t</code>는 1에 더 가까울 수 있음
- <strong>액체 금속 실험:</strong> VKS (von Kármán Sodium) 실험, Riga dynamo</p>
<h2 id="5-dynamos">5. 난류 Dynamos의 수치 시뮬레이션<a class="header-link" href="#5-dynamos" title="Permanent link">&para;</a></h2>
<h3 id="51-dns">5.1 직접 수치 시뮬레이션(DNS)<a class="header-link" href="#51-dns" title="Permanent link">&para;</a></h3>
<p><strong>DNS</strong>는 에너지 주입 스케일 <code>L</code>부터 소산 스케일(<code>η_K</code>와 <code>η_R</code>)까지 모든 스케일을 해상합니다.</p>
<p><strong>MHD 방정식(비압축성):</strong></p>
<div class="highlight"><pre><span></span><code>∂v/∂t + v·∇v = -∇p + J×B + ν∇²v + f
∂B/∂t = ∇×(v×B) + η∇²B
∇·v = 0
∇·B = 0
</code></pre></div>

<p>여기서 <code>f</code>는 강제 항(대규모에서 난류를 구동)입니다.</p>
<p><strong>공간 해상도 요구사항:</strong></p>
<p>소산 스케일을 해상하려면:</p>
<div class="highlight"><pre><span></span><code>N_x ≥ (L / η_K)  for velocity
N_x ≥ (L / η_R)  for magnetic field
</code></pre></div>

<p><code>Re = 10⁴</code>와 <code>Pm = 1</code>의 경우:</p>
<div class="highlight"><pre><span></span><code>η_K ~ L / Re^{3/4} ~ L / 100
η_R ~ L / Rm^{3/4} ~ L / 100

N_x ≥ 100  →  N_total = 100³ = 10^6 grid points (3D)
</code></pre></div>

<p>더 높은 <code>Re</code> 또는 낮은 <code>Pm</code>의 경우, 해상도 요구사항이 폭발합니다.</p>
<p><strong>스펙트럼 방법:</strong></p>
<p>일반적으로 <strong>Fourier pseudospectral</strong> 방법 사용:</p>
<ol>
<li>Fourier 공간에서 장 표현: <code>v(x) ↔ v̂(k)</code></li>
<li>실공간에서 비선형 항 <code>v·∇v</code>, <code>v×B</code> 계산(FFT를 통해)</li>
<li>Fourier 공간에서 도함수 계산: <code>∇ → ik</code></li>
<li><code>∇·v = 0</code> 강제: solenoidal 부공간으로 투영</li>
</ol>
<p><strong>시간 적분:</strong></p>
<ul>
<li><strong>명시적(RK3, RK4):</strong> 간단하지만 CFL 제약: <code>Δt ≤ C Δx / |v|_max</code></li>
<li><strong>암시적(Crank-Nicolson):</strong> 확산 항에 대해, 더 큰 <code>Δt</code> 허용</li>
<li><strong>IMEX (Implicit-Explicit):</strong> 이류를 명시적으로, 확산을 암시적으로 처리</li>
</ul>
<h3 id="52-large-eddy-simulation-les">5.2 Large Eddy Simulation (LES)<a class="header-link" href="#52-large-eddy-simulation-les" title="Permanent link">&para;</a></h3>
<p>매우 높은 Reynolds 수(DNS 도달 범위를 넘어서)의 경우, <strong>LES</strong> 사용:</p>
<p><strong>개념:</strong>
- 큰 스케일만 해상(일부 차단 <code>k_c</code>까지)
- 해상되지 않은 작은 스케일의 효과 모델링(서브그리드 스케일, SGS)</p>
<p><strong>필터링:</strong></p>
<p>폭 <code>Δ</code>의 공간 필터 적용:</p>
<div class="highlight"><pre><span></span><code>⟨v⟩(x) = ∫ G(x - x&#39;, Δ) v(x&#39;) dx&#39;
</code></pre></div>

<p>여기서 <code>G</code>는 필터 커널(예: Gaussian, box, spectral cutoff)입니다.</p>
<p><strong>필터링된 MHD 방정식:</strong></p>
<div class="highlight"><pre><span></span><code>∂⟨v⟩/∂t + ⟨v⟩·∇⟨v⟩ = -∇⟨p⟩ + ⟨J⟩×⟨B⟩ + ν∇²⟨v⟩ - ∇·τ_SGS
∂⟨B⟩/∂t = ∇×(⟨v⟩×⟨B⟩) + η∇²⟨B⟩ + ∇×ε_SGS
</code></pre></div>

<p>여기서:
- <code>τ_SGS = ⟨vv⟩ - ⟨v⟩⟨v⟩</code> (SGS 응력)
- <code>ε_SGS = ⟨v×B⟩ - ⟨v⟩×⟨B⟩</code> (SGS EMF)</p>
<p><strong>서브그리드 모델:</strong></p>
<ol>
<li><strong>Eddy 점성/저항도:</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>τ_SGS ≈ -ν_t(∇⟨v⟩ + (∇⟨v⟩)^T)
ε_SGS ≈ -η_t ∇×⟨B⟩
</code></pre></div>

<p>여기서 <code>ν_t</code>, <code>η_t</code>는 난류 점성/저항도(예: Smagorinsky 모델)입니다.</p>
<ol>
<li><strong>Gradient 모델:</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>τ_SGS ≈ C Δ² ∇⟨v⟩·∇⟨v⟩
</code></pre></div>

<ol>
<li><strong>Dynamic 모델:</strong> 해상된 스케일로부터 <code>C</code>를 동적으로 계산(Germano identity).</li>
</ol>
<p><strong>MHD LES의 도전:</strong>
- SGS 자기장이 강한 역반응을 가질 수 있음(작은 스케일의 dynamo)
- 표준 eddy 점성 모델이 helicity의 역 캐스케이드를 포착하지 못할 수 있음
- 활발한 연구 분야</p>
<h3 id="53">5.3 강제와 경계 조건<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<p><strong>강제:</strong></p>
<p>통계적으로 정상 난류를 유지하기 위해, 대규모에서 에너지 주입:</p>
<div class="highlight"><pre><span></span><code>f(x,t) = F(k, t)  for k in band [k_min, k_max]
</code></pre></div>

<p>일반적 방식:
- <strong>확률론적 강제:</strong> 무작위 위상, Gaussian 통계
- <strong>ABC 강제:</strong> Arnold-Beltrami-Childress 흐름(나선형)
- <strong>속도 강제:</strong> 특정 모드에 대해 <code>|v̂(k)|</code> 고정, 위상 무작위화</p>
<p><strong>경계 조건:</strong></p>
<ul>
<li><strong>주기적:</strong> 가장 간단, 많은 연구에 사용</li>
<li>문제: helicity 보존(플럭스 없음), 재앙적 quenching</li>
<li><strong>열림(유출):</strong> Helicity 플럭스 허용</li>
<li>구현: 경계에서 외삽 또는 제로 구배</li>
<li><strong>전도 벽:</strong> <code>B_n</code> 연속, <code>E_t = 0</code> (또는 접선 방향으로 <code>v×B = 0</code>)</li>
</ul>
<h3 id="54">5.4 분석 도구<a class="header-link" href="#54" title="Permanent link">&para;</a></h3>
<p><strong>에너지 스펙트럼:</strong></p>
<div class="highlight"><pre><span></span><code>E_K(k) = (1/2) Σ_{|k&#39;| ≈ k} |v̂(k&#39;)|²
E_B(k) = (1/2μ₀) Σ_{|k&#39;| ≈ k} |B̂(k&#39;)|²
</code></pre></div>

<p><strong>Helicity 스펙트럼:</strong></p>
<div class="highlight"><pre><span></span><code>H_K(k) = Σ_{|k&#39;| ≈ k} Re(v̂*(k&#39;)·(ik&#39; × v̂(k&#39;)))
H_B(k) = Σ_{|k&#39;| ≈ k} Re(Â*(k&#39;)·B̂(k&#39;))
</code></pre></div>

<p><strong>구조 함수:</strong></p>
<div class="highlight"><pre><span></span><code>S_p(r) = ⟨|v(x+r) - v(x)|^p⟩
</code></pre></div>

<p>간헐성 측정: Kolmogorov의 경우, <code>S_p(r) ~ r^{ζ_p}</code>이고 <code>ζ_p = p/3</code>; 이탈은 간헐성을 나타냄.</p>
<p><strong>자기장 PDF:</strong></p>
<div class="highlight"><pre><span></span><code>P(B) = probability distribution of field strength
</code></pre></div>

<p>일반적으로 <strong>비Gaussian</strong>, 지수 또는 stretched-지수 꼬리(간헐성).</p>
<h2 id="6-dynamo">6. 난류 Dynamo의 응용<a class="header-link" href="#6-dynamo" title="Permanent link">&para;</a></h2>
<h3 id="61-ism">6.1 성간 매질(ISM)<a class="header-link" href="#61-ism" title="Permanent link">&para;</a></h3>
<p><strong>맥락:</strong>
- ISM은 고도로 난류: 초신성 폭발, 항성풍, 열 불안정성
- 관측된 자기장: <code>B ~ μG</code>
- <code>Pm ≫ 1</code> (무충돌 플라즈마)</p>
<p><strong>Dynamo 메커니즘:</strong>
- <strong>소규모 dynamo:</strong> 씨앗 장을 <code>μG</code> 수준으로 증폭
- 난류 운동 에너지와 거의 동등분배에서 포화
- 자기장 구조: 필라멘트형, 간헐적</p>
<p><strong>관측 테스트:</strong>
- Faraday 회전 측정(RM): 시선을 따라 자기장 탐사
- Synchrotron 방출: 총 강도와 편광
- Zeeman 분리: 직접 B 측정(밀집 영역에 제한)</p>
<p><strong>수치 발견:</strong>
- 소규모 dynamo가 일반적 ISM 난류에 대해 <code>B ~ 3-10 μG</code>에서 포화
- 나선 팔, 별 형성 영역의 관측과 일치</p>
<h3 id="62">6.2 은하단<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p><strong>맥락:</strong>
- 은하단간 매질(ICM): 뜨겁고 희박한 플라즈마
- 합병, AGN 피드백에 의해 구동되는 난류
- 관측된 자기장: <code>B ~ μG</code> (RM, 전파 헤일로로부터)</p>
<p><strong>Dynamo 메커니즘:</strong>
- 소규모 dynamo가 은하단 형성 동안 씨앗 장 증폭
- <code>Pm ≫ 1</code> (무충돌)
- 빠른 성장: <code>τ_dyn ~ Gyr</code></p>
<p><strong>도전:</strong>
- 전도가 소규모 변동을 억제할 수 있음(Braginski 점성)
- 우주선이 dynamo에 영향을 미칠 수 있음</p>
<p><strong>시뮬레이션:</strong>
- Vazza et al., Miniati, Ryu: MHD를 가진 은하단 형성 시뮬레이션
- Dynamo로부터 <code>B ~ 0.1 - 1 μG</code> 발견</p>
<h3 id="63">6.3 강착 원반<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<p><strong>맥락:</strong>
- Magnetorotational 불안정성(MRI)이 난류 생성(Lesson 12 참조)
- 난류 dynamo가 자기장 증폭 및 유지</p>
<p><strong>Dynamo 메커니즘:</strong>
- 소규모(MRI 난류)와 대규모(MRI 구동 α-효과로부터의 dynamo) 모두
- 원반을 관통하는 수직 장이 증폭될 수 있음
- 원시행성 원반(dead zones)에서 <code>Pm ≪ 1</code>, 뜨거운 원반에서 <code>Pm ~ 1</code></p>
<p><strong>포화:</strong>
- 자기 응력: <code>⟨B_rB_φ⟩/μ₀ ~ α ⟨p⟩</code>이고 <code>α ~ 0.01 - 0.1</code>
- <code>B ~ √(αp)</code> → 열 압력 이하에 해당</p>
<p><strong>관측 함의:</strong>
- 제트 발사: 대규모 극성 장 필요(dynamo + 이류)
- 원반 바람: 환상 장의 압력</p>
<h3 id="64">6.4 초기 우주<a class="header-link" href="#64" title="Permanent link">&para;</a></h3>
<p><strong>맥락:</strong>
- 원시 플라즈마의 씨앗 자기장
- 상전이, 원시 밀도 변동으로부터의 난류</p>
<p><strong>Dynamo:</strong>
- 복사 시대(재결합 전) 동안 소규모 dynamo
- 증폭 인자: 약한 씨앗 장으로부터 <code>10^{30}</code> 도달 가능
- 자기장 결맞음 길이: 지평선 또는 감쇠 스케일에 의해 제한</p>
<p><strong>관련성:</strong>
- 공백과 높은 적색편이 은하에서 관측된 <code>nG</code> 장 설명
- 구조 형성에 영향(자기 압력 지지)</p>
<h2 id="7-python">7. Python 구현<a class="header-link" href="#7-python" title="Permanent link">&para;</a></h2>
<h3 id="71-kazantsev">7.1 Kazantsev 스펙트럼 모델<a class="header-link" href="#71-kazantsev" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kazantsev_spectrum</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model magnetic energy spectrum in small-scale dynamo.</span>

<span class="sd">    Kazantsev prediction: E_B(k) ∝ k^{3/2} in kinematic regime.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Wavenumber range</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Kinetic energy spectrum (Kolmogorov)</span>
    <span class="n">E_K</span> <span class="o">=</span> <span class="n">k</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Magnetic energy spectrum (Kazantsev kinematic)</span>
    <span class="n">E_B_kinematic</span> <span class="o">=</span> <span class="n">k</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Magnetic energy spectrum (saturated, example: k^{-3/2})</span>
    <span class="n">E_B_saturated</span> <span class="o">=</span> <span class="n">k</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Normalize</span>
    <span class="n">E_K</span> <span class="o">/=</span> <span class="n">E_K</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">E_K</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">E_B_kinematic</span> <span class="o">/=</span> <span class="n">E_B_kinematic</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">E_B_kinematic</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">E_B_saturated</span> <span class="o">/=</span> <span class="n">E_B_saturated</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">E_B_saturated</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">E_K</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_K(k) \propto k^{-5/3}$ (Kolmogorov)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">E_B_kinematic</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_B(k) \propto k^{3/2}$ (Kazantsev kinematic)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">E_B_saturated</span><span class="p">,</span> <span class="s1">&#39;g-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_B(k) \propto k^{-3/2}$ (Saturated)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber $k$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy spectrum $E(k)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Kazantsev Spectrum: Small-Scale Dynamo&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;kazantsev_spectrum.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">kazantsev_spectrum</span><span class="p">()</span>
</code></pre></div>

<h3 id="72-dynamo">7.2 소규모 Dynamo 성장 시뮬레이션<a class="header-link" href="#72-dynamo" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>

<span class="k">def</span><span class="w"> </span><span class="nf">small_scale_dynamo_growth</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate kinematic growth of magnetic energy in small-scale dynamo.</span>

<span class="sd">    Model:</span>
<span class="sd">      dE_B/dt = 2γ E_B - (E_B/τ_η)</span>

<span class="sd">    where:</span>
<span class="sd">      γ = growth rate from turbulent stretching</span>
<span class="sd">      τ_η = resistive dissipation timescale</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="n">u_rms</span> <span class="o">=</span> <span class="mf">1.0</span>       <span class="c1"># RMS velocity</span>
    <span class="n">ell</span> <span class="o">=</span> <span class="mf">1.0</span>         <span class="c1"># Correlation scale</span>
    <span class="n">eta_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]</span>  <span class="c1"># Magnetic diffusivity</span>

    <span class="c1"># Time array</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">eta</span> <span class="ow">in</span> <span class="n">eta_vals</span><span class="p">:</span>
        <span class="n">Rm</span> <span class="o">=</span> <span class="n">u_rms</span> <span class="o">*</span> <span class="n">ell</span> <span class="o">/</span> <span class="n">eta</span>
        <span class="n">Rm_c</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># Critical magnetic Reynolds number</span>

        <span class="k">if</span> <span class="n">Rm</span> <span class="o">&gt;</span> <span class="n">Rm_c</span><span class="p">:</span>
            <span class="c1"># Growth rate (simplified Kazantsev)</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">u_rms</span> <span class="o">/</span> <span class="n">ell</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">Rm</span> <span class="o">-</span> <span class="n">Rm_c</span><span class="p">)</span> <span class="o">/</span> <span class="n">Rm_c</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># No dynamo</span>

        <span class="c1"># Resistive timescale</span>
        <span class="n">tau_eta</span> <span class="o">=</span> <span class="n">ell</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">eta</span>

        <span class="c1"># Differential equation: dE_B/dt = 2*gamma*E_B - E_B/tau_eta</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">dE_dt</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">E</span> <span class="o">-</span> <span class="n">E</span> <span class="o">/</span> <span class="n">tau_eta</span>

        <span class="c1"># Initial condition</span>
        <span class="n">E0</span> <span class="o">=</span> <span class="mf">1e-6</span>

        <span class="c1"># Solve ODE</span>
        <span class="n">E_B</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dE_dt</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">E_B</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Rm=</span><span class="si">{</span><span class="n">Rm</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">, γ=</span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time $t$ (in $\ell/u_</span><span class="si">{rms}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnetic Energy $E_B$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Small-Scale Dynamo: Kinematic Growth&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;small_scale_dynamo_growth.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">small_scale_dynamo_growth</span><span class="p">()</span>
</code></pre></div>

<h3 id="73-helicity">7.3 자기 Helicity 진화<a class="header-link" href="#73-helicity" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">magnetic_helicity_evolution</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate evolution of magnetic helicity in a turbulent dynamo.</span>

<span class="sd">    Model helicity production, dissipation, and flux:</span>
<span class="sd">      dH_B/dt = Production - Dissipation - Flux</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>           <span class="c1"># Domain size</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.01</span>        <span class="c1"># Magnetic diffusivity</span>
    <span class="n">alpha0</span> <span class="o">=</span> <span class="mf">0.1</span>      <span class="c1"># Alpha effect (helicity production rate coefficient)</span>
    <span class="n">flux_rate</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Helicity flux rate (if boundaries are open)</span>

    <span class="c1"># Time array</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Two scenarios: closed vs open boundaries</span>
    <span class="n">scenarios</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Closed (no flux)&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;Open (with flux)&#39;</span><span class="p">:</span> <span class="n">flux_rate</span>
    <span class="p">}</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">flux</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scenarios</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="c1"># Initialize</span>
        <span class="n">H_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="n">B_rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

        <span class="n">H_B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">B_rms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span>

        <span class="c1"># Time evolution</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Helicity production (from alpha effect and field growth)</span>
            <span class="n">production</span> <span class="o">=</span> <span class="n">alpha0</span> <span class="o">*</span> <span class="n">B_rms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>

            <span class="c1"># Resistive dissipation</span>
            <span class="n">dissipation</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">eta</span> <span class="o">/</span> <span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">H_B</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

            <span class="c1"># Helicity flux (for open boundaries)</span>
            <span class="n">flux_term</span> <span class="o">=</span> <span class="n">flux</span> <span class="o">*</span> <span class="n">H_B</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

            <span class="c1"># Update helicity</span>
            <span class="n">dH_dt</span> <span class="o">=</span> <span class="n">production</span> <span class="o">-</span> <span class="n">dissipation</span> <span class="o">-</span> <span class="n">flux_term</span>
            <span class="n">H_B</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">H_B</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dt</span>

            <span class="c1"># Simple model for field growth with helicity constraint</span>
            <span class="c1"># α-quenching: α_eff = α0 / (1 + |H_B| / H_sat)</span>
            <span class="n">H_sat</span> <span class="o">=</span> <span class="mf">0.1</span>
            <span class="n">alpha_eff</span> <span class="o">=</span> <span class="n">alpha0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_B</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">/</span> <span class="n">H_sat</span><span class="p">)</span>

            <span class="c1"># Field growth (simplified)</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="n">alpha_eff</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">/</span> <span class="n">L</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">dB_dt</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">B_rms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="n">B_rms</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">B_rms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dB_dt</span>

        <span class="c1"># Plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">H_B</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">B_rms</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time $t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnetic Helicity $H_B$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnetic Helicity Evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time $t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RMS Magnetic Field $B_</span><span class="si">{rms}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnetic Field Evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;helicity_evolution.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">magnetic_helicity_evolution</span><span class="p">()</span>
</code></pre></div>

<h3 id="74-dynamo">7.4 Dynamo가 있는 난류 캐스케이드<a class="header-link" href="#74-dynamo" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">turbulent_cascade_with_dynamo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate energy cascade in MHD turbulence with dynamo.</span>

<span class="sd">    Model shell-averaged energy equations:</span>
<span class="sd">      dE_K(k)/dt = T_K(k) + F_K(k) - ν k² E_K(k) - M(k)</span>
<span class="sd">      dE_B(k)/dt = T_B(k) + Dynamo(k) - η k² E_B(k) + M(k)</span>

<span class="sd">    where:</span>
<span class="sd">      T_K, T_B: nonlinear transfer (cascade)</span>
<span class="sd">      F_K: forcing</span>
<span class="sd">      M: magnetic-kinetic energy exchange</span>
<span class="sd">      Dynamo: energy input from stretching</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Wavenumber bins (logarithmic)</span>
    <span class="n">N_bins</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N_bins</span><span class="p">)</span>
    <span class="n">dk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="n">dk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dk</span><span class="p">,</span> <span class="n">dk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Parameters</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="mf">0.01</span>      <span class="c1"># Viscosity</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.005</span>    <span class="c1"># Magnetic diffusivity</span>
    <span class="n">forcing_k</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Forcing wavenumber index</span>

    <span class="c1"># Time stepping</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="mi">5000</span>

    <span class="c1"># Initialize</span>
    <span class="n">E_K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_bins</span><span class="p">)</span>
    <span class="n">E_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_bins</span><span class="p">)</span>

    <span class="c1"># Initial kinetic energy (inject at large scales)</span>
    <span class="n">E_K</span><span class="p">[</span><span class="n">forcing_k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># Storage</span>
    <span class="n">E_K_hist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">E_B_hist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="p">):</span>
        <span class="c1"># Forcing</span>
        <span class="n">F_K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_bins</span><span class="p">)</span>
        <span class="n">F_K</span><span class="p">[</span><span class="n">forcing_k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Constant energy injection</span>

        <span class="c1"># Nonlinear transfer (simplified cascade model)</span>
        <span class="c1"># T_K(k) ~ -d/dk(k² E_K)  (dimensional, forward cascade)</span>
        <span class="n">T_K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_bins</span><span class="p">)</span>
        <span class="n">T_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_bins</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_bins</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Forward cascade for kinetic</span>
            <span class="n">T_K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">E_K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">E_K</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Forward cascade for magnetic (Iroshnikov-Kraichnan)</span>
            <span class="n">T_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span> <span class="o">*</span> <span class="p">(</span><span class="n">E_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">E_B</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># Dynamo effect: kinetic energy → magnetic energy at small scales</span>
        <span class="n">Dynamo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_bins</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_bins</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">[</span><span class="n">forcing_k</span><span class="p">]:</span>
                <span class="c1"># Stretching proportional to strain rate ~ k E_K^{1/2}</span>
                <span class="n">Dynamo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E_K</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">E_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">E_K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">))</span>

        <span class="c1"># Magnetic-kinetic coupling (Lorentz force back-reaction)</span>
        <span class="n">M</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">E_B</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E_K</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span>

        <span class="c1"># Dissipation</span>
        <span class="n">D_K</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">E_K</span>
        <span class="n">D_B</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">E_B</span>

        <span class="c1"># Update</span>
        <span class="n">dE_K_dt</span> <span class="o">=</span> <span class="n">T_K</span> <span class="o">+</span> <span class="n">F_K</span> <span class="o">-</span> <span class="n">D_K</span> <span class="o">-</span> <span class="n">M</span>
        <span class="n">dE_B_dt</span> <span class="o">=</span> <span class="n">T_B</span> <span class="o">+</span> <span class="n">Dynamo</span> <span class="o">-</span> <span class="n">D_B</span> <span class="o">+</span> <span class="n">M</span>

        <span class="n">E_K</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dE_K_dt</span>
        <span class="n">E_B</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dE_B_dt</span>

        <span class="c1"># Prevent negative energies</span>
        <span class="n">E_K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">E_K</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">E_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">E_B</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Store snapshots</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">E_K_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_K</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="n">E_B_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_B</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="c1"># Plot final spectra</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">E_K</span><span class="p">,</span> <span class="s1">&#39;b-o&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic $E_K(k)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">E_B</span><span class="p">,</span> <span class="s1">&#39;r-s&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetic $E_B(k)$&#39;</span><span class="p">)</span>

    <span class="c1"># Reference slopes</span>
    <span class="n">k_ref</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k_ref</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">k_ref</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$k^{-5/3}$ (Kolmogorov)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k_ref</span><span class="p">,</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">k_ref</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$k^{-3/2}$ (IK or saturated dynamo)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber $k$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy $E(k)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Energy Spectra in MHD Turbulence with Dynamo&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;turbulent_cascade_dynamo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Animate evolution</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">E_K_hist</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">E_K_hist</span><span class="p">)</span><span class="o">//</span><span class="mi">10</span><span class="p">)):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">E_K_hist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;b-o&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">E_B_hist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;r-s&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetic&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber $k$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy $E(k)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Energy Spectra (t = </span><span class="si">{</span><span class="n">i</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">dt</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">turbulent_cascade_with_dynamo</span><span class="p">()</span>
</code></pre></div>

<h3 id="75-dynamo-pm">7.5 Dynamo 시작의 Pm 의존성<a class="header-link" href="#75-dynamo-pm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">Pm_dependence_dynamo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot critical Rm vs Pm for small-scale dynamo onset.</span>

<span class="sd">    Empirical fits from simulations:</span>
<span class="sd">      - High Pm: Rm_c ~ 100 (const)</span>
<span class="sd">      - Low Pm: Rm_c ~ C * Pm^{-α} (increases as Pm decreases)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Pm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Empirical model (Schekochihin et al.)</span>
    <span class="n">Rm_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Pm</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Pm</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pm</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># High Pm regime</span>
            <span class="n">Rm_c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Low Pm regime (example: Rm_c ~ 100 * Pm^{-1/2})</span>
            <span class="n">Rm_c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">pm</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Pm</span><span class="p">,</span> <span class="n">Rm_c</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Critical $Rm_c(Pm)$&#39;</span><span class="p">)</span>

    <span class="c1"># Reference lines</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Rm_c </span><span class="se">\\</span><span class="s1">approx 100$ (High Pm)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Pm</span><span class="p">[</span><span class="n">Pm</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">Pm</span><span class="p">[</span><span class="n">Pm</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Rm_c \propto Pm^{-1/2}$ (Low Pm)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Magnetic Prandtl Number $Pm = </span><span class="se">\\</span><span class="s1">nu/</span><span class="se">\\</span><span class="s1">eta$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Critical Magnetic Reynolds Number $Rm_c$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Dynamo Onset: Dependence on Magnetic Prandtl Number&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Pm_dependence_dynamo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">Pm_dependence_dynamo</span><span class="p">()</span>
</code></pre></div>

<h2 id="8">8. 요약<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<p><strong>난류 dynamos</strong>는 광범위한 천체물리학 시스템에서 자기장 생성을 이해하는 데 필수적입니다:</p>
<ol>
<li><strong>소규모 dynamo:</strong></li>
<li>난류 강제 스케일 ≤ 스케일에서 자기장 증폭</li>
<li>난류 연신에 의해 구동(Lyapunov 지수)</li>
<li><strong>Kazantsev 이론:</strong> <code>Rm &gt; Rm_c</code>에 대해 kinematic 성장률 <code>γ ~ (u/ℓ) (Rm/Rm_c)^{1/2}</code></li>
<li><strong>Kazantsev 스펙트럼:</strong> <code>E_B(k) ∝ k^{3/2}</code> (kinematic), 포화 시 평탄화</li>
<li>
<p>임계 <code>Rm_c ~ 50-200</code>, <strong>Pm</strong>에 의존</p>
</li>
<li>
<p><strong>자기 Prandtl 수(Pm = ν/η):</strong></p>
</li>
<li><strong>높은 Pm(<code>Pm ≫ 1</code>):</strong> 효율적 dynamo, 거의 동등분배 포화</li>
<li><strong>낮은 Pm(<code>Pm ≪ 1</code>):</strong> 더 높은 <code>Rm_c</code>, 동등분배 이하 포화</li>
<li>
<p>대부분의 천체물리학 플라즈마가 <code>Pm ≪ 1</code>을 가지지만, 효과적 난류 Pm은 <code>~ 1</code>일 수 있음</p>
</li>
<li>
<p><strong>대규모 dynamo:</strong></p>
</li>
<li>강제 &gt; 스케일에서 장을 생성하기 위해 <strong>helicity</strong>(운동 또는 자기) 필요</li>
<li>자기 helicity의 <strong>역 캐스케이드</strong>가 결맞는 대규모 장 구축</li>
<li><strong>Helicity 제약:</strong> 닫힌 시스템에서, helicity 보존이 <strong>재앙적 α-quenching</strong>으로 이어짐</li>
<li>
<p><strong>해결책:</strong> 열린 경계 → helicity 플럭스가 quenching 완화</p>
</li>
<li>
<p><strong>포화 메커니즘:</strong></p>
</li>
<li>Lorentz 힘 역반응이 난류 연신 감소</li>
<li>평균장 그림에서 <strong>α-quenching</strong></li>
<li>
<p>균형: dynamo 생성 ≈ 저항 소산 + helicity 플럭스</p>
</li>
<li>
<p><strong>수치 시뮬레이션:</strong></p>
</li>
<li><strong>DNS:</strong> 모든 스케일 해상, <code>Re, Rm ≲ 10^4</code>로 제한</li>
<li><strong>LES:</strong> 서브그리드 스케일 모델, 더 높은 <code>Re, Rm</code> 도달</li>
<li>
<p>도전: 낮은 Pm은 <code>η_K</code>와 <code>η_R</code> 둘 다의 해상 필요</p>
</li>
<li>
<p><strong>응용:</strong></p>
</li>
<li><strong>ISM:</strong> 소규모 dynamo → <code>μG</code> 장(관측됨)</li>
<li><strong>은하단:</strong> 합병 동안 소규모 dynamo</li>
<li><strong>강착 원반:</strong> MRI 구동 난류 dynamo</li>
<li><strong>초기 우주:</strong> 씨앗 장 증폭</li>
</ol>
<p>난류 dynamos는 포화, helicity 플럭스, 그리고 소규모에서 대규모 dynamos로의 전환을 이해하는 데 있어 진행 중인 연구가 있는 활발한 연구 분야입니다.</p>
<h2 id="_2">연습 문제<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Kazantsev 성장률:</strong> <code>u_rms = 10 m/s</code>, <code>ℓ = 10⁶ m</code>, <code>η = 10⁴ m²/s</code>인 난류의 경우, <code>Rm</code>을 계산하고 <code>Rm_c = 100</code>이라고 가정하여 성장률을 추정하십시오.</p>
</li>
<li>
<p><strong>낮은 Pm에 대한 임계 Rm:</strong> <code>Pm &lt; 1</code>에 대해 <code>Rm_c ~ 100 Pm^{-1/2}</code>인 경우, <code>Pm = 10^{-5}</code>인 액체 나트륨에 대해 <code>Rm_c</code>는 무엇입니까?</p>
</li>
<li>
<p><strong>저항 스케일:</strong> <code>Re = 10⁴</code>와 <code>Pm = 0.01</code>의 경우, 비 <code>η_R / η_K</code>를 계산하십시오. 어느 것이 더 작은 스케일에서 소산됩니까?</p>
</li>
<li>
<p><strong>동등분배 장:</strong> <code>ρ = 10^{-21} kg/m³</code>, <code>v = 10 km/s</code>인 ISM에서, 동등분배 자기장을 Gauss로 계산하십시오.</p>
</li>
<li>
<p><strong>Helicity 소산:</strong> <code>L = 1 kpc</code>와 <code>η = 10^{26} cm²/s</code>(ISM)인 영역의 경우, 자기 helicity의 저항 붕괴 시간 척도를 추정하십시오.</p>
</li>
<li>
<p><strong>Kazantsev 스펙트럼:</strong> Kinematic 소규모 dynamo에 대해 예상되는 <code>E_B(k)</code>를 그리고 <code>E_B(k) ∝ k^{-3/2}</code>인 포화 상태와 비교하십시오. 어떤 파수에서 교차합니까?</p>
</li>
<li>
<p><strong>Pm 스케일링:</strong> 낮은 Pm에 대해 포화 장 강도가 <code>B_sat ∝ Pm^{1/2}</code>로 스케일링되는 경우, <code>Pm = 1</code>에서 <code>Pm = 10^{-6}</code>로 갈 때 <code>B_sat</code>는 얼마나 감소합니까?</p>
</li>
<li>
<p><strong>Python 연습:</strong> 소규모 dynamo 성장 코드를 수정하여 <code>γ(B) = γ₀(1 - B²/B_eq²)</code>를 통해 포화를 포함하십시오. 지수 성장 → 포화 전환을 관찰하십시오.</p>
</li>
<li>
<p><strong>Helicity 플럭스:</strong> 자기 helicity 진화 코드에서, 플럭스율을 증가시키고 자기장의 포화 수준에 어떻게 영향을 미치는지 관찰하십시오.</p>
</li>
<li>
<p><strong>고급:</strong> Dynamo가 있는 MHD 난류를 위한 간단한 shell-모델을 구현하십시오. 로그적으로 간격을 둔 파수 shells를 사용하고 shells 사이의 비선형 전달을 모델링하십시오. <code>Rm</code>이 변함에 따라 에너지 캐스케이드와 dynamo 시작을 연구하십시오.</p>
</li>
</ol>
<hr />
<p><strong>이전:</strong> <a href="./09_Dynamo_Theory.md">Dynamo Theory</a> | <strong>다음:</strong> <a href="./11_Solar_MHD.md">Solar MHD</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/09_Dynamo_Theory.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">9. Dynamo Theory</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/11_Solar_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">11. 태양 MHD</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}