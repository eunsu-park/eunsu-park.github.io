{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11. 태양 MHD - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">11. 태양 MHD</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>11. 태양 MHD</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/10_Turbulent_Dynamo.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. 난류 Dynamo</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/12_Accretion_Disk_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. 강착 원반 MHD</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">학습 목표</a></li>
<li><a href="#1">1. 태양 구조 및 자기장</a><ul>
<li><a href="#11">1.1 태양의 층</a></li>
<li><a href="#12">1.2 관측 기법</a></li>
</ul>
</li>
<li><a href="#2">2. 자기 플럭스 튜브 및 흑점</a><ul>
<li><a href="#21">2.1 얇은 플럭스 튜브 근사</a></li>
<li><a href="#22">2.2 자기 부력 및 플럭스 출현</a></li>
<li><a href="#23">2.3 흑점</a></li>
</ul>
</li>
<li><a href="#3">3. 태양 다이나모</a><ul>
<li><a href="#31">3.1 관측 제약 조건</a></li>
<li><a href="#32">3.2 차등 회전 프로파일</a></li>
<li><a href="#33-">3.3 α-Ω 다이나모 메커니즘</a></li>
<li><a href="#34-babcock-leighton">3.4 Babcock-Leighton 메커니즘</a></li>
<li><a href="#35">3.5 플럭스 수송 다이나모</a></li>
<li><a href="#36">3.6 다이나모 포화 및 자기 활동</a></li>
</ul>
</li>
<li><a href="#4">4. 코로나 가열 문제</a><ul>
<li><a href="#41">4.1 문제</a></li>
<li><a href="#42">4.2 파동 가열 메커니즘</a></li>
<li><a href="#43">4.3 자기 재결합 및 나노플레어</a></li>
<li><a href="#44">4.4 현재 이해</a></li>
</ul>
</li>
<li><a href="#5">5. 태양풍</a><ul>
<li><a href="#51-parker-1958">5.1 Parker의 태양풍 모델 (1958)</a></li>
<li><a href="#52">5.2 비등온 모델</a></li>
<li><a href="#53">5.3 빠른 태양풍과 느린 태양풍</a></li>
<li><a href="#54">5.4 태양풍 난류</a></li>
</ul>
</li>
<li><a href="#6-python">6. Python 구현</a><ul>
<li><a href="#61-parker">6.1 Parker 태양풍 해</a></li>
<li><a href="#62">6.2 플럭스 튜브 상승 계산</a></li>
<li><a href="#63">6.3 합성 데이터로부터의 나비 다이어그램</a></li>
</ul>
</li>
<li><a href="#7">7. 요약</a></li>
<li><a href="#_2">연습 문제</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="11-mhd">11. 태양 MHD<a class="header-link" href="#11-mhd" title="Permanent link">&para;</a></h1>
<h2 id="_1">학습 목표<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>이 강의를 마치면 다음을 할 수 있어야 합니다:</p>
<ul>
<li>태양 구조와 각 층에서 자기장의 역할 설명</li>
<li>자기 플럭스 튜브와 흑점의 물리학 이해</li>
<li>태양 다이나모 메커니즘과 11/22년 태양 주기 설명</li>
<li>코로나 가열 문제 및 제안된 해결책 분석</li>
<li>Parker의 태양풍 모델 유도 및 적용</li>
<li>태양풍 난류 특성화 및 그 성질 파악</li>
<li>태양 현상의 수치 모델 구현 (Parker 태양풍, 플럭스 튜브, 나비 다이어그램)</li>
</ul>
<h2 id="1">1. 태양 구조 및 자기장<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 태양의 층<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>태양은 밀도, 온도, 자기장 강도에서 여러 차수의 크기를 걸쳐 층화된 복잡한 플라즈마 시스템입니다.</p>
<p><strong>내부:</strong></p>
<ol>
<li><strong>핵(Core)</strong> (r &lt; 0.25 R☉):</li>
<li>온도: <code>T ~ 1.5 × 10⁷ K</code></li>
<li>밀도: <code>ρ ~ 150 g/cm³</code></li>
<li>핵융합: <code>4 ¹H → ⁴He + 에너지</code></li>
<li>
<p>에너지 수송: 복사 (광자 확산)</p>
</li>
<li>
<p><strong>복사층(Radiative zone)</strong> (0.25 R☉ &lt; r &lt; 0.7 R☉):</p>
</li>
<li>온도: <code>T ~ 10⁷ - 10⁶ K</code></li>
<li>복사 확산이 지배적</li>
<li>안정적 층화 (대류 없음)</li>
<li>
<p>차등 회전 확립</p>
</li>
<li>
<p><strong>타코클라인(Tachocline)</strong> (r ~ 0.7 R☉):</p>
</li>
<li>얇은 전단층 (~0.05 R☉)</li>
<li>복사층(강체 회전)에서 대류층(차등 회전)으로의 전이</li>
<li>강한 <strong>Ω-효과</strong> 발생 위치 (toroidal 장 생성)</li>
<li>
<p>태양 다이나모에 중요</p>
</li>
<li>
<p><strong>대류층(Convection zone)</strong> (0.7 R☉ &lt; r &lt; 1.0 R☉):</p>
</li>
<li>온도: <code>T ~ 10⁶ - 6000 K</code></li>
<li>밀도: <code>ρ ~ 1 - 10⁻⁷ g/cm³</code></li>
<li>대류 에너지 수송 (세포, 초세포)</li>
<li><strong>α-효과</strong> 발생원 (나선형 난류)</li>
<li>차등 회전: 적도가 극보다 빠름</li>
</ol>
<p><strong>대기:</strong></p>
<ol>
<li><strong>광구(Photosphere)</strong> (표면, r ~ R☉):</li>
<li>온도: <code>T ~ 5800 K</code> (가시 표면)</li>
<li>밀도: <code>ρ ~ 10⁻⁷ g/cm³</code></li>
<li>광학 깊이 <code>τ ~ 1</code></li>
<li>
<p>흑점, 백반, 세포 가시</p>
</li>
<li>
<p><strong>채층(Chromosphere)</strong> (R☉ &lt; r &lt; R☉ + 2000 km):</p>
</li>
<li>온도: <code>T ~ 6000 - 20000 K</code> (고도 증가)</li>
<li>밀도: <code>ρ ~ 10⁻⁹ - 10⁻¹¹ g/cm³</code></li>
<li>방출선 (Hα, Ca II K)</li>
<li>
<p>스피큘, 플라주</p>
</li>
<li>
<p><strong>전이 영역(Transition region)</strong> (r ~ R☉ + 2000 km):</p>
</li>
<li>급격한 온도 증가: <code>T ~ 10⁴ → 10⁶ K</code> ~100 km 이상</li>
<li>
<p>밀도 급격히 감소</p>
</li>
<li>
<p><strong>코로나(Corona)</strong> (r &gt; R☉ + 2000 km):</p>
</li>
<li>온도: <code>T ~ 1-3 × 10⁶ K</code> (신비롭게 뜨거움!)</li>
<li>밀도: <code>ρ ~ 10⁻¹² - 10⁻¹⁶ g/cm³</code></li>
<li>고도로 이온화 (Fe XIV 등)</li>
<li>닫힌 자기 루프와 열린 장선</li>
<li>태양풍 발생원</li>
</ol>
<p><strong>자기장:</strong></p>
<ul>
<li><strong>내부 (대류층):</strong> <code>B ~ 10-100 G</code> (난류 다이나모)</li>
<li><strong>타코클라인:</strong> <code>B ~ 10⁴ G</code> (강한 toroidal 장)</li>
<li><strong>광구 (조용한 태양):</strong> <code>B ~ 1-10 G</code></li>
<li><strong>광구 (흑점):</strong> <code>B ~ 3000 G</code> (0.3 T!)</li>
<li><strong>코로나:</strong> <code>B ~ 1-10 G</code> (큰 규모로 확장)</li>
</ul>
<h3 id="12">1.2 관측 기법<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p><strong>자기 사진술(Magnetography):</strong></p>
<ul>
<li><strong>제만 효과(Zeeman effect):</strong> 자기장에서 스펙트럼선 분리</li>
<li>선 분리: <code>Δλ ∝ B</code> (종방향 성분)</li>
<li>원형 편광 (Stokes V): 종방향 장</li>
<li>
<p>선형 편광 (Stokes Q, U): 횡방향 장</p>
</li>
<li>
<p><strong>기기:</strong></p>
</li>
<li><strong>SOHO (Solar and Heliospheric Observatory):</strong> MDI (Michelson Doppler Imager)</li>
<li><strong>SDO (Solar Dynamics Observatory):</strong> HMI (Helioseismic and Magnetic Imager)<ul>
<li>45초마다 전체 원반 자기 사진</li>
<li>벡터 자기장 지도</li>
</ul>
</li>
<li><strong>Hinode:</strong> SOT (Solar Optical Telescope) — 고해상도</li>
<li><strong>Daniel K. Inouye Solar Telescope (DKIST):</strong> 4m 구경, 최고 해상도</li>
</ul>
<p><strong>태양 지진학(Helioseismology):</strong></p>
<ul>
<li>태양 진동 연구 (5분 진동, p-모드, g-모드)</li>
<li>내부 구조 추론: 회전 프로파일, 음속, 자기장 (간접적)</li>
<li><strong>주요 결과:</strong> 차등 회전 프로파일을 통한 타코클라인 발견</li>
</ul>
<p><strong>코로나그래프 및 EUV 영상:</strong></p>
<ul>
<li>SOHO/LASCO: 백색광 코로나그래프 (코로나 물질 방출)</li>
<li>SDO/AIA: 다중 파장에서 극자외선 영상 (다른 온도)</li>
<li>Hinode/XRT: X선 영상 (뜨거운 코로나 루프)</li>
</ul>
<h2 id="2">2. 자기 플럭스 튜브 및 흑점<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 얇은 플럭스 튜브 근사<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p><strong>자기 플럭스 튜브(Magnetic flux tube)</strong>는 자기장선의 다발로, 종종 장이 없는 플라즈마에 묻혀 있는 가는 튜브로 근사됩니다.</p>
<p><strong>가정:</strong></p>
<ol>
<li>튜브 반경 <code>a ≪ L</code> (변화의 길이 척도)</li>
<li>내부 장 <code>B_i</code>는 축 방향, 외부 장 <code>B_e = 0</code> (또는 약함)</li>
<li>튜브 경계에서 압력 균형</li>
</ol>
<p><strong>압력 균형:</strong></p>
<p>튜브 내부와 외부에서 총 압력이 균형을 이루어야 합니다:</p>
<div class="highlight"><pre><span></span><code>p_i + B_i² / (2μ₀) = p_e
</code></pre></div>

<p><code>B_e = 0</code>이면:</p>
<div class="highlight"><pre><span></span><code>p_i = p_e - B_i² / (2μ₀)
</code></pre></div>

<p><code>p_i &lt; p_e</code>이므로, 내부 기체는 <strong>더 차갑거나 밀도가 낮습니다</strong> (이상 기체의 경우, <code>p = ρkT/m</code>).</p>
<p><strong>부력(Buoyancy):</strong></p>
<p>튜브가 층화된 대기에서 정수압 평형 상태인 경우:</p>
<div class="highlight"><pre><span></span><code>dp/dz = -ρg
</code></pre></div>

<p>외부 매질의 경우:</p>
<div class="highlight"><pre><span></span><code>dp_e/dz = -ρ_e g
</code></pre></div>

<p>튜브의 경우:</p>
<div class="highlight"><pre><span></span><code>dp_i/dz = -ρ_i g
</code></pre></div>

<p>빼면:</p>
<div class="highlight"><pre><span></span><code>d/dz(p_i - p_e) = -(ρ_i - ρ_e)g
</code></pre></div>

<p><code>p_i - p_e = -B_i²/(2μ₀)</code>로:</p>
<div class="highlight"><pre><span></span><code>-d/dz(B_i²/(2μ₀)) = -(ρ_i - ρ_e)g
</code></pre></div>

<p><code>ρ_i &lt; ρ_e</code>이면 (튜브가 덜 조밀함), 튜브는 <strong>부력</strong>을 경험합니다:</p>
<div class="highlight"><pre><span></span><code>F_buoy = (ρ_e - ρ_i) g V
</code></pre></div>

<p>이것이 <strong>자기 부력 불안정성(Magnetic buoyancy instability)</strong>을 구동하여 플럭스 튜브가 대류층을 통해 상승합니다.</p>
<h3 id="22">2.2 자기 부력 및 플럭스 출현<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p><strong>자기 부력 불안정성:</strong></p>
<p>층화된 층의 수평 자기 플럭스 튜브는 다음과 같은 경우 기복에 불안정합니다:</p>
<div class="highlight"><pre><span></span><code>B² / (2μ₀ρ) &gt; c_s² H_p / γ
</code></pre></div>

<p>여기서:
- <code>c_s</code> = 음속
- <code>H_p = p/(ρg)</code> = 압력 스케일 높이
- <code>γ</code> = 단열 지수</p>
<p>대류층의 강한 장의 경우, 이 조건이 만족됩니다 → 플럭스 튜브 상승.</p>
<p><strong>상승 역학:</strong></p>
<p>플럭스 튜브의 상승 속도는 부력과 저항의 균형을 이룹니다:</p>
<div class="highlight"><pre><span></span><code>ρ_e (dv_z/dt) = (ρ_e - ρ_i) g - C_D (1/2) ρ_e v_z²
</code></pre></div>

<p>여기서 <code>C_D</code>는 저항 계수입니다.</p>
<p>대류층에서:
- 시간 척도: <code>τ_rise ~ H_p / v_z ~ 몇 개월</code>
- 타코클라인에서 생성된 <code>B ~ 10⁴ G</code>를 가진 튜브가 표면으로 상승</p>
<p><strong>광구에서의 출현:</strong></p>
<p>광구에 도달하면, 플럭스 튜브는 <strong>양극 활동 영역</strong>으로 출현합니다:
- 선행 흑점 (한 극성)
- 후행 흑점 (반대 극성)
- 표면 위의 자기 루프로 연결됨</p>
<h3 id="23">2.3 흑점<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<p><strong>구조:</strong></p>
<ul>
<li><strong>본영(Umbra):</strong> 어두운 중앙 영역</li>
<li>온도: <code>T ~ 4000 K</code> (조용한 태양의 5800 K에 비해)</li>
<li>자기장: <code>B ~ 3000 G</code>, 거의 수직</li>
<li>
<p>어두움은 억제된 대류 때문 (자기 압력이 운동을 억제)</p>
</li>
<li>
<p><strong>반영(Penumbra):</strong> 방사상 필라멘트가 있는 주변 영역</p>
</li>
<li>온도: <code>T ~ 5000 K</code></li>
<li>자기장: <code>B ~ 1500 G</code>, 기울어짐</li>
<li><strong>에버셰드 흐름(Evershed flow):</strong> <code>v ~ 1-2 km/s</code>의 방사상 유출 (기울어진 장을 따라)</li>
</ul>
<p><strong>흑점 주기:</strong></p>
<ul>
<li>흑점 수는 ~11년 주기로 변화</li>
<li>태양 활동과 상관 (플레어, CME)</li>
<li>각 주기마다 자기 극성이 반전 → 22년 자기 주기</li>
</ul>
<p><strong>헤일의 극성 법칙(Hale's polarity law):</strong></p>
<p>주어진 주기에서:
- 북반구 선행 흑점: 한 극성
- 남반구 선행 흑점: 반대 극성
- 다음 주기에서 반전</p>
<p><strong>조이의 법칙(Joy's law):</strong></p>
<p>양극 활동 영역은 기울어져 있습니다:
- 선행 흑점이 적도에 더 가까움
- 후행 흑점이 극을 향함
- 기울기 각도는 위도에 따라 증가</p>
<p>이 기울기는 <strong>Babcock-Leighton 메커니즘</strong>에 중요합니다 (다이나모 섹션 참조).</p>
<h2 id="3">3. 태양 다이나모<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 관측 제약 조건<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>태양 다이나모는 다음을 설명해야 합니다:</p>
<ol>
<li><strong>11년 흑점 주기</strong> (22년 자기 주기)</li>
<li><strong>나비 다이어그램(Butterfly diagram):</strong> 흑점은 주기 시작 시 중위도(~30°)에 나타나 적도로 이동</li>
<li><strong>헤일의 법칙:</strong> 11년마다 극성 반전</li>
<li><strong>극 장 반전:</strong> 극 장은 ~11년에 반전, 적도와 동상</li>
<li><strong>차등 회전:</strong> 태양 지진학으로부터의 Ω(위도, 반경)</li>
<li><strong>타코클라인:</strong> 대류층 기저에서 강한 반경 전단 <code>∂Ω/∂r</code></li>
</ol>
<h3 id="32">3.2 차등 회전 프로파일<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>태양 지진학(예: GONG, SOHO/MDI, SDO/HMI)으로부터:</p>
<p><strong>표면 (광구):</strong></p>
<div class="highlight"><pre><span></span><code>Ω(θ) ≈ Ω_eq (1 - a₂ cos²θ - a₄ cos⁴θ)
</code></pre></div>

<p>여기서:
- <code>Ω_eq ≈ 2π / 25일</code> (적도 회전)
- <code>a₂ ≈ 0.14</code>, <code>a₄ ≈ 0.17</code>
- 극은 적도보다 ~30% 느리게 회전</p>
<p><strong>내부:</strong></p>
<ul>
<li><strong>복사층 (r &lt; 0.7 R☉):</strong> 거의 <strong>강체 회전</strong> Ω ~ 상수</li>
<li><strong>대류층:</strong> 위도 의존적 회전, 반경선에서 대략 일정 (원통형 회전)</li>
<li><strong>타코클라인 (r ~ 0.7 R☉):</strong> 급격한 전이</li>
<li>강한 <strong>반경 전단</strong> <code>∂Ω/∂r</code></li>
<li>toroidal 장이 증폭되는 곳 (Ω-효과)</li>
</ul>
<h3 id="33-">3.3 α-Ω 다이나모 메커니즘<a class="header-link" href="#33-" title="Permanent link">&para;</a></h3>
<p>고전적인 <strong>α-Ω 다이나모</strong>는 두 단계로 작동합니다:</p>
<p><strong>1. Ω-효과 (Toroidal 장 생성):</strong></p>
<p>차등 회전이 poloidal 장 <code>B_p</code>를 toroidal 장 <code>B_φ</code>로 전단합니다:</p>
<div class="highlight"><pre><span></span><code>∂B_φ/∂t ≈ r sin θ (B_r ∂Ω/∂r + B_θ / r ∂Ω/∂θ)
</code></pre></div>

<p>타코클라인에서 <code>∂Ω/∂r</code>이 큼 → 강한 증폭:</p>
<div class="highlight"><pre><span></span><code>B_φ ~ B_p × (Ω_cycle × τ_cycle) ~ B_p × (10⁻⁶ rad/s × 10⁸ s) ~ 100 B_p
</code></pre></div>

<p><code>B_p ~ 10 G</code>에서 시작하여 <code>B_φ ~ 10³-10⁴ G</code>를 생성합니다.</p>
<p><strong>2. α-효과 (Poloidal 장 재생성):</strong></p>
<p>대류층의 나선형 대류 난류가 toroidal → poloidal로 변환합니다:</p>
<div class="highlight"><pre><span></span><code>∂B_p/∂t ≈ ∇ × (α B_φ e_φ)
</code></pre></div>

<p>α의 소스:
- <strong>사이클론 대류:</strong> 상승/하강 플룸에 작용하는 코리올리 힘 → 나선형 운동
- <strong>운동 나선성(Kinetic helicity):</strong> 회전하고 층화된 유체에서 <code>⟨u·(∇×u)⟩ ≠ 0</code></p>
<p><strong>피드백 루프:</strong></p>
<div class="highlight"><pre><span></span><code>B_p → (Ω-효과) → B_φ → (α-효과) → B_p&#39;
</code></pre></div>

<p>주기당 증폭이 확산을 초과하면 장이 성장합니다.</p>
<h3 id="34-babcock-leighton">3.4 Babcock-Leighton 메커니즘<a class="header-link" href="#34-babcock-leighton" title="Permanent link">&para;</a></h3>
<p>난류 α-효과의 대안:</p>
<p><strong>메커니즘:</strong></p>
<ol>
<li>타코클라인의 강한 toroidal 장 <code>B_φ</code>가 부력 불안정해짐</li>
<li>플럭스 튜브가 상승하여 <strong>기울어진 양극 활동 영역</strong>으로 출현 (조이의 법칙)</li>
<li>표면에서 후행 흑점 (극방향)이 선행 흑점과 반대 극성을 가짐</li>
<li>표면 흐름 (자오선 순환, 확산)이 플럭스 수송:</li>
<li>후행 극성 플럭스의 극방향 이동 → 극 장 소멸 및 반전</li>
<li>이것이 toroidal로부터 poloidal 장을 재생성하는 것과 동등</li>
</ol>
<p><strong>Poloidal 장 소스:</strong></p>
<div class="highlight"><pre><span></span><code>소스 ∝ B_φ × sin(기울기 각도) × (표면 플럭스 수송)
</code></pre></div>

<p>이것은 벌크가 아닌 표면에서 작동하는 <strong>비국소적 α-효과</strong>입니다.</p>
<p><strong>장점:</strong></p>
<ul>
<li>직접 관측 가능 (기울기, 출현)</li>
<li>극 장 반전 설명</li>
<li>플럭스 수송 다이나모 모델이 나비 다이어그램을 잘 재현</li>
</ul>
<h3 id="35">3.5 플럭스 수송 다이나모<a class="header-link" href="#35" title="Permanent link">&para;</a></h3>
<p>현대 태양 다이나모 모델은 다음을 결합합니다:</p>
<ul>
<li><strong>Ω-효과</strong> 타코클라인에서</li>
<li><strong>Babcock-Leighton α-효과</strong> 표면에서</li>
<li><strong>자오선 순환(Meridional circulation):</strong> 표면에서 극방향, 기저에서 적도방향 (컨베이어 벨트)</li>
<li>속도: <code>v_m ~ 10-20 m/s</code></li>
<li>주기: <code>τ_m ~ R☉ / v_m ~ 10년</code> (주기와 비슷!)</li>
<li><strong>난류 확산:</strong> 대류층에서, <code>η_t ~ 10^{10-11} cm²/s</code></li>
</ul>
<p><strong>주기:</strong></p>
<ol>
<li>Toroidal 장 <code>B_φ</code>가 타코클라인에서 축적 (Ω-효과)</li>
<li>플럭스 출현 → 중위도의 기울어진 활동 영역</li>
<li>표면 확산 + 자오선 흐름 → 극방향 플럭스 이동, 극 장 반전</li>
<li>자오선 흐름이 극에서 표면 poloidal 장을 아래로 이송</li>
<li>타코클라인에서 poloidal 장이 Ω에 의해 전단됨 → 새로운 toroidal 장 (반대 부호)</li>
<li>주기 반복</li>
</ol>
<p><strong>주기:</strong></p>
<div class="highlight"><pre><span></span><code>P ~ 2π √(D/α_eff Ω_eff)  또는  P ~ 순환 시간
</code></pre></div>

<p>매개변수 조정 (확산도, 순환 속도)으로 11년 주기를 재현합니다.</p>
<h3 id="36">3.6 다이나모 포화 및 자기 활동<a class="header-link" href="#36" title="Permanent link">&para;</a></h3>
<p><strong>포화:</strong></p>
<ul>
<li>자기장이 무한정 성장할 수 없음</li>
<li><strong>자기 부력:</strong> <code>B_φ ~ 10⁴ G</code>일 때, 튜브가 부력을 가짐 → 상승 및 출현 → 타코클라인에서 플럭스 제거</li>
<li><strong>로렌츠 힘:</strong> 강한 장이 흐름을 변경 (전단, α-효과 감소)</li>
</ul>
<p><strong>주기적 행동:</strong></p>
<p>포화는 정상 다이나모보다는 <strong>진동 해</strong>로 이어집니다:
- Poloidal 및 toroidal 장이 위상차로 진동
- 나비 다이어그램: 다이나모 파동 전파 또는 플럭스 수송으로 인한 적도방향 이동</p>
<p><strong>그랜드 미니마(Grand minima) (마운더 극소기):</strong></p>
<ul>
<li>매우 낮은 흑점 활동의 역사적 기간 (예: 1645-1715)</li>
<li>가능한 원인:</li>
<li>α-효과의 확률적 변동</li>
<li>자오선 순환의 변화</li>
<li>다이나모 모드 간 전이</li>
</ul>
<p>확률적 강제가 있는 모델은 불규칙한 주기와 그랜드 미니마를 재현할 수 있습니다.</p>
<h2 id="4">4. 코로나 가열 문제<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 문제<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p><strong>관측:</strong></p>
<ul>
<li>광구: <code>T ~ 5800 K</code></li>
<li>채층: <code>T ~ 10⁴ K</code></li>
<li>코로나: <code>T ~ 10⁶ K</code></li>
</ul>
<p>이것은 <strong>순진한 기대를 위배합니다</strong> (온도는 열원으로부터의 거리에 따라 감소해야 함).</p>
<p><strong>에너지 수지:</strong></p>
<p>복사 및 전도 손실에 대해 코로나 온도를 유지하려면:</p>
<div class="highlight"><pre><span></span><code>에너지 입력 ≈ 10² - 10³ W/m² (활동 영역에서)
             ≈ 10-100 W/m² (조용한 태양)
</code></pre></div>

<p>총 코로나 가열 전력: <code>L_corona ~ 10²⁷ erg/s ~ 10²⁰ W</code> (태양 광도 <code>L_☉ ~ 4×10²⁶ W</code>와 비교, 코로나는 <code>~0.01% L_☉</code>).</p>
<p><strong>가능한 에너지 소스:</strong></p>
<ul>
<li>광구 운동 (대류, 세포): <code>~ kW/m²</code> (충분한 에너지!)</li>
<li>질문: 이 에너지가 <strong>코로나로 수송</strong>되고 열로 <strong>소산</strong>되는 방법은?</li>
</ul>
<h3 id="42">4.2 파동 가열 메커니즘<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p><strong>음파:</strong></p>
<ul>
<li>대류 운동이 음파를 생성</li>
<li>파동이 위로 전파, 충격파로 급해짐 (밀도 감소로 인해)</li>
<li>충격 소산 → 가열</li>
</ul>
<p><strong>문제:</strong> 음파는 대부분 급격한 온도 기울기(채층/전이 영역)에서 <strong>반사</strong>됨 → 코로나에 도달하는 플럭스 불충분.</p>
<p><strong>알벤 파동(Alfvén waves):</strong></p>
<p>자기장선은 <strong>알벤 파동</strong>을 지지할 수 있는 현과 같습니다:</p>
<div class="highlight"><pre><span></span><code>v_A = B / √(μ₀ ρ)
</code></pre></div>

<p>코로나에서 <code>B ~ 10 G</code>, <code>ρ ~ 10^{-12} g/cm³</code> → <code>v_A ~ 1000 km/s</code>.</p>
<p><strong>파동 생성:</strong></p>
<ul>
<li>광구 운동 (세포)이 자기장선을 흔듦</li>
<li>알벤 파동 여기 (횡방향 진동)</li>
<li>파동이 장선을 따라 코로나로 전파</li>
</ul>
<p><strong>소산 메커니즘:</strong></p>
<ol>
<li><strong>위상 혼합(Phase mixing):</strong></li>
<li>다른 장선들이 다른 <code>v_A</code>를 가짐 → 인접한 선의 파동이 위상이 어긋남</li>
<li>
<p>횡방향 기울기 생성 → 점성/저항 소산</p>
</li>
<li>
<p><strong>공명 흡수(Resonant absorption):</strong></p>
</li>
<li>층화된 코로나에서 국소 알벤 주파수가 변화</li>
<li>
<p>파동이 국소화된 진동에 공명적으로 결합 → 향상된 소산</p>
</li>
<li>
<p><strong>난류 캐스케이드(Turbulent cascade):</strong></p>
</li>
<li>비선형 상호작용 → 에너지가 작은 척도로 캐스케이드</li>
<li>작은 척도에서 저항 또는 점성을 통해 소산</li>
</ol>
<p><strong>에너지 플럭스:</strong></p>
<p>알벤 파동 에너지 플럭스:</p>
<div class="highlight"><pre><span></span><code>F_A = (1/2) ρ v_A δv²
</code></pre></div>

<p>여기서 <code>δv</code>는 파동 진폭입니다. <code>δv ~ 10 km/s</code>, <code>ρ ~ 10^{-7} g/cm³</code> (채층), <code>v_A ~ 100 km/s</code>의 경우:</p>
<div class="highlight"><pre><span></span><code>F_A ~ 10³ W/m²  (코로나 가열에 충분!)
</code></pre></div>

<p><strong>관측 지원:</strong></p>
<ul>
<li>코로나에서 알벤 변동 관측 (CoMP 기기, Parker Solar Probe)</li>
<li>코로나 루프를 따라 전파하는 파동 관찰</li>
<li>가열 요구사항과 일치하는 감쇠 시간 척도</li>
</ul>
<h3 id="43">4.3 자기 재결합 및 나노플레어<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<p><strong>Parker의 나노플레어 가설 (1988):</strong></p>
<ul>
<li>광구 운동이 코로나 자기장을 지속적으로 얽음</li>
<li>소규모 <strong>전류 시트</strong> 형성</li>
<li>이러한 시트에서 자기 재결합이 버스트로 에너지 방출 (<strong>나노플레어</strong>)</li>
<li>많은 작은 사건 (각 <code>E ~ 10²⁴ erg</code>, 대형 플레어의 <code>10^{32}</code> erg에 비해) → 통계적 가열</li>
</ul>
<p><strong>에너지 방출:</strong></p>
<p>재결합은 자기 에너지를 운동 및 열 에너지로 변환합니다:</p>
<div class="highlight"><pre><span></span><code>에너지 ~ B² / (2μ₀) × 부피
</code></pre></div>

<p>크기 <code>L ~ 100 km</code>, <code>B ~ 10 G</code>의 전류 시트의 경우:</p>
<div class="highlight"><pre><span></span><code>E ~ (10⁻³ T)² / (2×4π×10⁻⁷) × (10⁵ m)³ ~ 10²⁴ erg  (나노플레어)
</code></pre></div>

<p><strong>빈도:</strong></p>
<p>코로나에 <code>10²⁰ W</code>를 공급하려면:</p>
<div class="highlight"><pre><span></span><code>N × E / τ ~ 10²⁰ W
N ~ 10²⁰ W × τ / 10²⁴ erg ~ 10⁶ 사건/s  (τ ~ 100 s인 경우)
</code></pre></div>

<p><strong>과제:</strong></p>
<ul>
<li>개별 나노플레어는 검출 임계값 이하</li>
<li><strong>통계적 신호</strong>를 관측해야 함 (예: 비열 방출, 가열률 분포)</li>
</ul>
<p><strong>관측 증거:</strong></p>
<ul>
<li>EUV 밝기가 나노플레어 통계와 일치</li>
<li>활동 영역의 고온 (&gt; 3 MK) 플라즈마는 충동적 가열을 시사</li>
<li>그러나 개별 나노플레어의 직접 관측은 여전히 어려움</li>
</ul>
<h3 id="44">4.4 현재 이해<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<p>두 메커니즘 모두 <strong>기여</strong>할 가능성이 높습니다:</p>
<ul>
<li><strong>파동 가열:</strong> 조용한 태양, 열린 장 영역 (코로나 홀)에서</li>
<li>알벤 파동이 바깥쪽으로 전파, 소산</li>
<li>
<p>느리고 빠른 태양풍 가속과 관련</p>
</li>
<li>
<p><strong>재결합/나노플레어:</strong> 활동 영역, 닫힌 루프에서</p>
</li>
<li>복잡한 자기 구조에서 꼬임 및 재결합</li>
<li>고온 방출 설명</li>
</ul>
<p><strong>진행 중인 연구:</strong></p>
<ul>
<li>고해상도 관측 (DKIST, Solar Orbiter, Parker Solar Probe)</li>
<li>현실적인 코로나 자기장의 MHD 시뮬레이션</li>
<li>파동 전파 및 소산 모델링</li>
<li>소규모 재결합 사건의 통계</li>
</ul>
<h2 id="5">5. 태양풍<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-parker-1958">5.1 Parker의 태양풍 모델 (1958)<a class="header-link" href="#51-parker-1958" title="Permanent link">&para;</a></h3>
<p>Eugene Parker는 코로나가 <strong>정수압 평형</strong>에 있지 않고 대신 성간 공간으로 초음속 팽창한다고 제안했습니다.</p>
<p><strong>가정:</strong></p>
<ol>
<li><strong>정상, 구대칭, 반경 흐름</strong></li>
<li><strong>등온 코로나:</strong> <code>T = T_c = 상수</code> (단순화)</li>
<li><strong>이상 기체:</strong> <code>p = ρkT/m</code></li>
<li><strong>에너지 방정식:</strong> 가열/냉각 무시 (또는 균형 가정)</li>
</ol>
<p><strong>방정식:</strong></p>
<p><strong>질량 보존:</strong></p>
<div class="highlight"><pre><span></span><code>d/dr (ρ v r²) = 0  →  ρ v r² = 상수 = Ṁ/(4π)
</code></pre></div>

<p>여기서 <code>Ṁ</code>는 질량 손실률입니다.</p>
<p><strong>운동량 방정식:</strong></p>
<div class="highlight"><pre><span></span><code>ρ v dv/dr = -dp/dr - GMρ/r²
</code></pre></div>

<p><strong>이상 기체:</strong></p>
<div class="highlight"><pre><span></span><code>p = ρ c_s²
</code></pre></div>

<p>여기서 <code>c_s² = kT/m</code>는 음속 제곱입니다.</p>
<p><strong>결합:</strong></p>
<p><code>ρ = Ṁ/(4πr²v)</code> 및 <code>p = (Ṁ/(4πr²v)) c_s²</code>를 대입:</p>
<div class="highlight"><pre><span></span><code>v dv/dr = -c_s² (1/v dv/dr + 2/r) - GM/r²
</code></pre></div>

<p>재정리:</p>
<div class="highlight"><pre><span></span><code>(v² - c_s²) (1/v dv/dr) = -(2c_s²/r + GM/r²)
</code></pre></div>

<p><strong>임계점:</strong></p>
<p><code>r = r_c</code>에서 <code>v = c_s</code> (음속점), 우변이 사라져야 합니다:</p>
<div class="highlight"><pre><span></span><code><span class="mf">2</span><span class="n">c_s²</span><span class="o">/</span><span class="n">r_c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GM</span><span class="o">/</span><span class="n">r_c²</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w">  </span><span class="err">→</span><span class="w">  </span><span class="n">r_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GM</span><span class="o">/</span><span class="p">(</span><span class="mf">2</span><span class="n">c_s²</span><span class="p">)</span>
</code></pre></div>

<p><code>T_c = 10⁶ K</code>인 태양의 경우, <code>c_s ~ 100 km/s</code>:</p>
<div class="highlight"><pre><span></span><code>r_c ~ (6.67×10⁻¹¹ × 2×10³⁰) / (2 × (10⁵)²) ~ 7×10⁹ m ~ 10 R☉
</code></pre></div>

<p><strong>해:</strong></p>
<p><strong>천이음속 해</strong>는 임계점을 통과합니다:
- <code>r &lt; r_c</code>에서 <strong>아음속</strong> (태양 근처)
- <code>r = r_c</code>에서 <strong>음속</strong>
- <code>r &gt; r_c</code>에서 <strong>초음속</strong> (성간 공간)</p>
<p>지구 궤도 (1 AU ~ 215 R☉)에서:
- 속도: <code>v ~ 400 km/s</code>
- 밀도: <code>n ~ 5 cm⁻³</code>
- 온도: <code>T ~ 10⁵ K</code></p>
<p>이것들은 관측과 일치 → Parker의 모델 확인!</p>
<h3 id="52">5.2 비등온 모델<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<p><strong>등온 모델의 문제:</strong></p>
<p>에너지 보존이 만족되지 않음 (<code>T = 상수</code>를 유지하려면 지속적인 가열 필요).</p>
<p><strong>다변 모델(Polytropic model):</strong></p>
<p><code>p ∝ ρ^γ</code> 가정:</p>
<div class="highlight"><pre><span></span><code>p = K ρ^γ
</code></pre></div>

<p>여기서 <code>γ</code>는 다변 지수입니다 (γ=1 등온, γ=5/3 단열).</p>
<p><code>γ &lt; 3/2</code>의 경우, 천이음속 해가 존재합니다.</p>
<p><strong>에너지 방정식:</strong></p>
<p>더 현실적인 모델은 다음을 포함합니다:
- <strong>열 전도:</strong> <code>q = -κ dT/dr</code>
- <strong>복사 냉각</strong>
- <strong>코로나 가열</strong> (임의 함수 또는 파동 소산)
- <strong>중력 일</strong></p>
<p>전체 에너지 방정식:</p>
<div class="highlight"><pre><span></span><code>d/dr (r² ρ v [v²/2 + γ/(γ-1) p/ρ - GM/r]) = r² (Q_heat - Q_cool + Q_cond)
</code></pre></div>

<p>수치 해는 다음을 찾습니다:
- <code>r ~ 1-2 R☉</code> 근처 온도 피크, 그 다음 감소
- 종단 속도는 코로나 온도 및 가열 프로파일에 의존</p>
<h3 id="53">5.3 빠른 태양풍과 느린 태양풍<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<p><strong>관측 (Ulysses, Helios, Wind, ACE, Parker Solar Probe):</strong></p>
<p>두 가지 유형의 태양풍:</p>
<p><strong>느린 태양풍:</strong>
- 속도: <code>v ~ 300-400 km/s</code>
- 밀도: 1 AU에서 <code>n ~ 10 cm⁻³</code>
- 온도: <code>T ~ 10⁵ K</code>
- 조성: 광구와 유사하지만 낮은 FIP 원소가 풍부
- 소스: 태양 적도 근처 <strong>스트리머 벨트</strong> (닫힌 장 영역)</p>
<p><strong>빠른 태양풍:</strong>
- 속도: <code>v ~ 700-800 km/s</code>
- 밀도: 1 AU에서 <code>n ~ 3 cm⁻³</code>
- 온도: <code>T ~ 2×10⁵ K</code>
- 조성: 광구에 더 가까움
- 소스: <strong>코로나 홀</strong> (극의 열린 장 영역)</p>
<p><strong>가속 메커니즘:</strong></p>
<ul>
<li><strong>느린 바람:</strong> 스트리머 상단의 재결합, 또는 복잡한 장의 파동에서 가능</li>
<li><strong>빠른 바람:</strong> 알벤 파동 압력 (파동 에너지 밀도가 유효 압력으로 작용)</li>
</ul>
<p><strong>알벤 파동 구동 모델:</strong></p>
<p>파동 압력 기울기가 바람을 가속합니다:</p>
<div class="highlight"><pre><span></span><code>F_wave ~ -d/dr (B δB / μ₀)
</code></pre></div>

<p>여기서 <code>δB</code>는 파동 진폭입니다. 이것은 관측된 속도로 빠른 바람을 구동할 수 있습니다.</p>
<h3 id="54">5.4 태양풍 난류<a class="header-link" href="#54" title="Permanent link">&para;</a></h3>
<p><strong>관측:</strong></p>
<ul>
<li>자기장 및 속도 변동이 매우 난류적</li>
<li>전력 스펙트럼: MHD 척도에서 <code>E(f) ∝ f^{-5/3}</code> (콜모고로프 유사)</li>
<li>운동 척도 (이온 자이로 반경, 관성 길이)에서 급해짐</li>
</ul>
<p><strong>특성:</strong></p>
<ul>
<li><strong>알벤 상관관계:</strong> <code>δv ~ ±δB/√(μ₀ρ)</code> (바깥쪽/안쪽 전파 알벤 파동)</li>
<li><strong>비등방성:</strong> 변동이 평균 장에 수직으로 우선적</li>
<li><strong>간헐성:</strong> 비가우스 통계, 일관된 구조 (전류 시트, 플럭스 로프)</li>
</ul>
<p><strong>에너지 캐스케이드:</strong></p>
<ul>
<li>큰 척도에서 주입 (1 AU에서 &gt; 10⁶ km)</li>
<li>관성 범위: <code>E(k) ∝ k^{-5/3}</code> (또는 <code>k^{-3/2}</code> Iroshnikov-Kraichnan)</li>
<li><code>k ρ_i ~ 1</code> (이온 자이로 척도) 또는 <code>k λ_i ~ 1</code> (이온 관성 길이)에서 소산</li>
</ul>
<p><strong>가열:</strong></p>
<p>난류 소산이 태양풍을 가열합니다:
- 양성자 온도가 단열보다 느리게 감소 (<code>T ∝ r^{-α}</code>, <code>α ~ 0.5</code> 대 단열 <code>α ~ 4/3</code>)
- 수직 이온 가열 (온도 비등방성)
- 작은 척도에서 전자 가열</p>
<p><strong>시사점:</strong></p>
<ul>
<li>태양풍은 무충돌 플라즈마 난류의 자연 실험실</li>
<li>천체물리 플라즈마와 관련 (ISM, 은하단, 강착 흐름)</li>
</ul>
<h2 id="6-python">6. Python 구현<a class="header-link" href="#6-python" title="Permanent link">&para;</a></h2>
<h3 id="61-parker">6.1 Parker 태양풍 해<a class="header-link" href="#61-parker" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">fsolve</span>

<span class="k">def</span><span class="w"> </span><span class="nf">parker_solar_wind</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parker의 등온 태양풍 모델을 풉니다.</span>

<span class="sd">    방정식:</span>
<span class="sd">      질량: ρ v r² = 상수</span>
<span class="sd">      운동량: v dv/dr = -c_s²/ρ dρ/dr - GM/r²</span>

<span class="sd">    결합:</span>
<span class="sd">      (v² - c_s²) (1/v dv/dr) = -(2c_s²/r + GM/r²)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 상수</span>
    <span class="n">G</span> <span class="o">=</span> <span class="mf">6.674e-11</span>      <span class="c1"># m^3 kg^-1 s^-2</span>
    <span class="n">M_sun</span> <span class="o">=</span> <span class="mf">1.989e30</span>   <span class="c1"># kg</span>
    <span class="n">R_sun</span> <span class="o">=</span> <span class="mf">6.96e8</span>     <span class="c1"># m</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-23</span>     <span class="c1"># J/K</span>
    <span class="n">m_p</span> <span class="o">=</span> <span class="mf">1.67e-27</span>     <span class="c1"># kg (양성자 질량)</span>

    <span class="c1"># 코로나 온도</span>
    <span class="n">T_corona</span> <span class="o">=</span> <span class="mf">1.5e6</span>   <span class="c1"># K</span>
    <span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T_corona</span> <span class="o">/</span> <span class="n">m_p</span><span class="p">)</span>  <span class="c1"># 음속</span>

    <span class="c1"># 임계 반경</span>
    <span class="n">r_c</span> <span class="o">=</span> <span class="n">G</span> <span class="o">*</span> <span class="n">M_sun</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">c_s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;음속: </span><span class="si">{</span><span class="n">c_s</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;임계 반경: </span><span class="si">{</span><span class="n">r_c</span><span class="o">/</span><span class="n">R_sun</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> R_sun&quot;</span><span class="p">)</span>

    <span class="c1"># 반경 격자</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_sun</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">215</span><span class="o">*</span><span class="n">R_sun</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 1 R_sun에서 1 AU</span>

    <span class="c1"># ODE 정의: dv/dr</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dv_dr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c_s</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">r</span> <span class="o">+</span> <span class="n">G</span><span class="o">*</span><span class="n">M_sun</span> <span class="o">/</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c_s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># 임계점 근처</span>
        <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span>

    <span class="c1"># 임계점 해 찾기</span>
    <span class="c1"># r_c를 약간 지나서 약간 초음속으로 시작</span>
    <span class="n">r_start_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_c</span> <span class="o">*</span> <span class="mf">1.01</span><span class="p">))</span>
    <span class="n">r_start</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">r_start_idx</span><span class="p">]</span>
    <span class="n">v_start</span> <span class="o">=</span> <span class="n">c_s</span> <span class="o">*</span> <span class="mf">1.01</span>

    <span class="c1"># r_c에서 바깥쪽으로 적분</span>
    <span class="n">r_out</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">r_start_idx</span><span class="p">:]</span>
    <span class="n">v_out</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dv_dr</span><span class="p">,</span> <span class="n">v_start</span><span class="p">,</span> <span class="n">r_out</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="c1"># r_c에서 안쪽으로 적분</span>
    <span class="n">r_in</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:</span><span class="n">r_start_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">v_in_rev</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dv_dr</span><span class="p">,</span> <span class="n">c_s</span> <span class="o">*</span> <span class="mf">0.99</span><span class="p">,</span> <span class="n">r_in</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">v_in</span> <span class="o">=</span> <span class="n">v_in_rev</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># 결합</span>
    <span class="n">r_sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">r_in</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_out</span><span class="p">])</span>
    <span class="n">v_sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">v_in</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">v_out</span><span class="p">])</span>

    <span class="c1"># 질량 보존으로부터 밀도</span>
    <span class="c1"># ρ v r² = ρ_c c_s r_c²</span>
    <span class="n">rho_c</span> <span class="o">=</span> <span class="mf">1e-12</span>  <span class="c1"># kg/m^3 (임의 정규화)</span>
    <span class="n">rho_sol</span> <span class="o">=</span> <span class="n">rho_c</span> <span class="o">*</span> <span class="n">c_s</span> <span class="o">*</span> <span class="n">r_c</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">v_sol</span> <span class="o">*</span> <span class="n">r_sol</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># 수밀도</span>
    <span class="n">n_sol</span> <span class="o">=</span> <span class="n">rho_sol</span> <span class="o">/</span> <span class="n">m_p</span>  <span class="c1"># m^-3</span>

    <span class="c1"># 플롯</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># 속도</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_sol</span><span class="o">/</span><span class="n">R_sun</span><span class="p">,</span> <span class="n">v_sol</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">c_s</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;음속&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">r_c</span><span class="o">/</span><span class="n">R_sun</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;임계 반경&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">215</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 AU&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;반경 ($R_</span><span class="se">\\</span><span class="s1">odot$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;속도 (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Parker 태양풍: 속도 프로파일&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># 밀도</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">r_sol</span><span class="o">/</span><span class="n">R_sun</span><span class="p">,</span> <span class="n">n_sol</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># cm^-3</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">r_c</span><span class="o">/</span><span class="n">R_sun</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">215</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;반경 ($R_</span><span class="se">\\</span><span class="s1">odot$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;수밀도 (cm$^{-3}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Parker 태양풍: 밀도 프로파일&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># 마하 수</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">v_sol</span> <span class="o">/</span> <span class="n">c_s</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_sol</span><span class="o">/</span><span class="n">R_sun</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M = 1&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">r_c</span><span class="o">/</span><span class="n">R_sun</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">215</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;반경 ($R_</span><span class="se">\\</span><span class="s1">odot$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;마하 수&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Parker 태양풍: 마하 수&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;parker_solar_wind.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># 1 AU에서의 값 출력</span>
    <span class="n">idx_1AU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_sol</span> <span class="o">-</span> <span class="mi">215</span><span class="o">*</span><span class="n">R_sun</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1 AU에서:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  속도: </span><span class="si">{</span><span class="n">v_sol</span><span class="p">[</span><span class="n">idx_1AU</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  밀도: </span><span class="si">{</span><span class="n">n_sol</span><span class="p">[</span><span class="n">idx_1AU</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> cm^-3&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  마하 수: </span><span class="si">{</span><span class="n">M</span><span class="p">[</span><span class="n">idx_1AU</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">parker_solar_wind</span><span class="p">()</span>
</code></pre></div>

<h3 id="62">6.2 플럭스 튜브 상승 계산<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">flux_tube_rise</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    태양 대류층을 통한 자기 플럭스 튜브의 상승을 계산합니다.</span>

<span class="sd">    부력 방정식:</span>
<span class="sd">      dv_z/dt = (Δρ/ρ_e) g - C_D v_z² / (2H_p)</span>

<span class="sd">    여기서 Δρ = ρ_e - ρ_i (밀도 결핍).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 태양 매개변수</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mi">274</span>  <span class="c1"># m/s^2 (표면 중력)</span>
    <span class="n">R_sun</span> <span class="o">=</span> <span class="mf">6.96e8</span>  <span class="c1"># m</span>
    <span class="n">M_sun</span> <span class="o">=</span> <span class="mf">1.989e30</span>  <span class="c1"># kg</span>

    <span class="c1"># 대류층</span>
    <span class="n">r_bottom</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">R_sun</span>  <span class="c1"># 기저 (타코클라인)</span>
    <span class="n">r_top</span> <span class="o">=</span> <span class="n">R_sun</span>           <span class="c1"># 광구</span>

    <span class="c1"># 층화 (단순화된 지수)</span>
    <span class="n">H_p</span> <span class="o">=</span> <span class="mf">5e7</span>  <span class="c1"># 압력 스케일 높이 ~ 50 Mm</span>
    <span class="n">rho_0</span> <span class="o">=</span> <span class="mf">1e-1</span>  <span class="c1"># kg/m^3 (r_bottom에서, 근사)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rho_ext</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;외부 밀도 (층화된 대기).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">rho_0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_bottom</span><span class="p">)</span> <span class="o">/</span> <span class="n">H_p</span><span class="p">)</span>

    <span class="c1"># 자기장 강도</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mf">3e4</span> <span class="o">*</span> <span class="mf">1e-4</span>  <span class="c1"># Tesla로 30 kG</span>

    <span class="c1"># 내부 밀도: 압력 균형</span>
    <span class="c1"># p_i + B²/(2μ₀) = p_e</span>
    <span class="c1"># 등온 가정: p = ρ c_s²</span>
    <span class="n">c_s</span> <span class="o">=</span> <span class="mf">1e4</span>  <span class="c1"># m/s (음속)</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rho_int</span><span class="p">(</span><span class="n">rho_e</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;압력 균형으로부터 내부 밀도.&quot;&quot;&quot;</span>
        <span class="n">p_e</span> <span class="o">=</span> <span class="n">rho_e</span> <span class="o">*</span> <span class="n">c_s</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">p_i</span> <span class="o">=</span> <span class="n">p_e</span> <span class="o">-</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu_0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p_i</span> <span class="o">/</span> <span class="n">c_s</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># 저항 계수</span>
    <span class="n">C_D</span> <span class="o">=</span> <span class="mf">0.5</span>

    <span class="c1"># 시간 진화</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 초</span>
    <span class="n">t_max</span> <span class="o">=</span> <span class="mf">1e7</span>  <span class="c1"># 초 (~100일)</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

    <span class="c1"># 배열</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>  <span class="c1"># r_bottom 위의 높이</span>
    <span class="n">v_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>

    <span class="c1"># 초기 조건</span>
    <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e6</span>  <span class="c1"># 타코클라인 위 1 Mm에서 시작</span>
    <span class="n">v_z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># 적분</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r_bottom</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="n">rho_e</span> <span class="o">=</span> <span class="n">rho_ext</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">rho_i</span> <span class="o">=</span> <span class="n">rho_int</span><span class="p">(</span><span class="n">rho_e</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>

        <span class="n">Delta_rho</span> <span class="o">=</span> <span class="n">rho_e</span> <span class="o">-</span> <span class="n">rho_i</span>

        <span class="c1"># 부력 가속도</span>
        <span class="n">a_buoy</span> <span class="o">=</span> <span class="p">(</span><span class="n">Delta_rho</span> <span class="o">/</span> <span class="n">rho_e</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>

        <span class="c1"># 저항</span>
        <span class="n">a_drag</span> <span class="o">=</span> <span class="o">-</span><span class="n">C_D</span> <span class="o">*</span> <span class="n">v_z</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">H_p</span><span class="p">)</span>

        <span class="c1"># 속도 업데이트</span>
        <span class="n">dv_dt</span> <span class="o">=</span> <span class="n">a_buoy</span> <span class="o">+</span> <span class="n">a_drag</span>
        <span class="n">v_z</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_z</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dv_dt</span>

        <span class="c1"># 위치 업데이트</span>
        <span class="n">z</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">v_z</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># 시간 저장</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span>

        <span class="c1"># 표면 도달 시 중지</span>
        <span class="k">if</span> <span class="n">z</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">r_top</span> <span class="o">-</span> <span class="n">r_bottom</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="p">[:</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">v_z</span> <span class="o">=</span> <span class="n">v_z</span><span class="p">[:</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="c1"># Mm 및 일로 변환</span>
    <span class="n">z_Mm</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="mf">1e6</span>
    <span class="n">t_days</span> <span class="o">=</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">86400</span>
    <span class="n">v_km_s</span> <span class="o">=</span> <span class="n">v_z</span> <span class="o">/</span> <span class="mf">1e3</span>

    <span class="c1"># 플롯</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_days</span><span class="p">,</span> <span class="n">z_Mm</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">((</span><span class="n">r_top</span> <span class="o">-</span> <span class="n">r_bottom</span><span class="p">)</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;광구&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;시간 (일)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;타코클라인 위 높이 (Mm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;플럭스 튜브 상승: 높이 대 시간&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_days</span><span class="p">,</span> <span class="n">v_km_s</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;시간 (일)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;상승 속도 (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;플럭스 튜브 상승: 속도 대 시간&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;flux_tube_rise.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;광구까지 상승 시간: </span><span class="si">{</span><span class="n">t_days</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> 일&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;최종 속도: </span><span class="si">{</span><span class="n">v_km_s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>

<span class="n">flux_tube_rise</span><span class="p">()</span>
</code></pre></div>

<h3 id="63">6.3 합성 데이터로부터의 나비 다이어그램<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">butterfly_diagram_synthetic</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    합성 태양 나비 다이어그램을 생성합니다.</span>

<span class="sd">    모델:</span>
<span class="sd">      - 흑점 위도: λ(t) = λ_max cos(2π t / P) exp(-t / τ_decay)</span>
<span class="sd">      - 주기에 따른 적도방향 이동</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 매개변수</span>
    <span class="n">P</span> <span class="o">=</span> <span class="mi">11</span>  <span class="c1"># 년 (주기)</span>
    <span class="n">N_cycles</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="c1"># 시간 배열</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_cycles</span> <span class="o">*</span> <span class="n">P</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># 나비 패턴 생성</span>
    <span class="c1"># 흑점 출현 위도</span>
    <span class="n">lambda_max</span> <span class="o">=</span> <span class="mi">35</span>  <span class="c1"># 도 (최대 위도)</span>
    <span class="n">tau_decay</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># 감쇠 시간 척도</span>

    <span class="c1"># 각 주기에 대해</span>
    <span class="n">latitudes_N</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">latitudes_S</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cycles</span><span class="p">):</span>
        <span class="n">t_cycle</span> <span class="o">=</span> <span class="n">t</span><span class="p">[(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="n">cycle</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">cycle</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">P</span><span class="p">)]</span> <span class="o">-</span> <span class="n">cycle</span><span class="o">*</span><span class="n">P</span>

        <span class="c1"># 위도가 주기 동안 λ_max에서 ~5°로 감소</span>
        <span class="n">lambda_t</span> <span class="o">=</span> <span class="n">lambda_max</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t_cycle</span> <span class="o">/</span> <span class="n">P</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>

        <span class="c1"># 산란 추가</span>
        <span class="n">N_spots</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="n">t_spots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">N_spots</span><span class="p">)</span>
        <span class="n">lambda_spots</span> <span class="o">=</span> <span class="n">lambda_max</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t_spots</span> <span class="o">/</span> <span class="n">P</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">N_spots</span><span class="p">)</span>

        <span class="c1"># 극성이 각 주기마다 반전</span>
        <span class="k">if</span> <span class="n">cycle</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">latitudes_N</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lambda_spots</span><span class="p">)</span>
            <span class="n">latitudes_S</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="o">-</span><span class="n">lambda_spots</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">latitudes_N</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="o">-</span><span class="n">lambda_spots</span><span class="p">)</span>
            <span class="n">latitudes_S</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lambda_spots</span><span class="p">)</span>

        <span class="n">times</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">t_spots</span> <span class="o">+</span> <span class="n">cycle</span> <span class="o">*</span> <span class="n">P</span><span class="p">)</span>

    <span class="c1"># 결합</span>
    <span class="n">latitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">latitudes_N</span><span class="p">,</span> <span class="n">latitudes_S</span><span class="p">])</span>
    <span class="n">times_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">times</span><span class="p">,</span> <span class="n">times</span><span class="p">])</span>

    <span class="c1"># 플롯</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">times_all</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cycles</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">cycle</span> <span class="o">*</span> <span class="n">P</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;시간 (년)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;위도 (도)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;합성 태양 나비 다이어그램&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;butterfly_diagram_synthetic.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">butterfly_diagram_synthetic</span><span class="p">()</span>
</code></pre></div>

<h2 id="7">7. 요약<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<p><strong>태양 MHD</strong>는 자기장에 의해 구동되는 다양한 현상을 포함합니다:</p>
<ol>
<li><strong>태양 구조:</strong></li>
<li>대류층 (다이나모), 타코클라인 (toroidal 장 생성), 코로나 (신비롭게 뜨거움)</li>
<li>
<p>자기장은 ~1 G (조용한 태양)에서 ~3000 G (흑점)까지 범위</p>
</li>
<li>
<p><strong>자기 플럭스 튜브 및 흑점:</strong></p>
</li>
<li><strong>얇은 플럭스 튜브:</strong> 압력 균형 <code>p_i + B²/(2μ₀) = p_e</code></li>
<li><strong>자기 부력:</strong> 밀도가 낮은 튜브가 대류층을 통해 상승</li>
<li>
<p><strong>흑점:</strong> 강한 수직 장의 집중, 대류 억제 → 더 차갑고 어두움</p>
</li>
<li>
<p><strong>태양 다이나모:</strong></p>
</li>
<li><strong>α-Ω 메커니즘:</strong> 차등 회전 (Ω) + 나선형 난류 (α) → 주기적 장 생성</li>
<li><strong>Babcock-Leighton:</strong> 기울어진 양극 영역으로부터의 표면 poloidal 소스</li>
<li><strong>플럭스 수송 다이나모:</strong> 자오선 순환이 핵심 역할</li>
<li>
<p><strong>11년 주기:</strong> 나비 다이어그램 (적도방향 이동), 극 장 반전</p>
</li>
<li>
<p><strong>코로나 가열:</strong></p>
</li>
<li><strong>문제:</strong> 코로나가 ~10⁶ K, 광구보다 훨씬 위</li>
<li><strong>파동 가열:</strong> 알벤 파동 (위상 혼합, 공명 흡수, 난류)</li>
<li><strong>나노플레어:</strong> 많은 작은 재결합 사건 (Parker의 가설)</li>
<li>
<p>두 가지 모두의 조합 가능성</p>
</li>
<li>
<p><strong>태양풍:</strong></p>
</li>
<li><strong>Parker 모델:</strong> 뜨거운 코로나로부터의 천이음속 팽창</li>
<li><strong>임계점:</strong> <code>r_c ~ 10 R☉</code>, 흐름이 초음속이 됨</li>
<li><strong>빠른 바람:</strong> 코로나 홀로부터 (~700 km/s)</li>
<li><strong>느린 바람:</strong> 스트리머 벨트로부터 (~400 km/s)</li>
<li><strong>난류:</strong> 알벤 변동, 캐스케이드, 가열</li>
</ol>
<p>태양은 MHD 과정을 연구하는 자연 실험실로, 다른 별, 강착 원반, 행성 자기권에 응용됩니다.</p>
<h2 id="_2">연습 문제<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>압력 균형:</strong> 흑점이 <code>B = 3000 G</code>를 가집니다. 외부 기체 압력이 <code>p_e = 10⁴ Pa</code>인 경우, 내부 기체 압력 <code>p_i</code>는 얼마입니까?</p>
</li>
<li>
<p><strong>자기 부력:</strong> <code>ρ_e = 0.1 g/cm³</code>, <code>c_s = 10 km/s</code>인 대류층에서 <code>B = 10 kG</code>를 가진 플럭스 튜브의 경우, 등온 압력 균형을 가정하여 밀도 결핍 <code>Δρ = ρ_e - ρ_i</code>를 계산하세요.</p>
</li>
<li>
<p><strong>상승 시간:</strong> 문제 2의 밀도 결핍과 <code>g = 274 m/s²</code>를 사용하여 부력 가속도를 추정하세요. 종단 속도에 도달하면 200 Mm (대류층의 두께)를 상승하는 데 얼마나 걸립니까?</p>
</li>
<li>
<p><strong>태양 다이나모 수:</strong> <code>α = 0.1 m/s</code>, <code>ΔΩ = 10⁻⁶ rad/s</code>, <code>R = 5×10⁸ m</code>, <code>η_eff = 10¹⁰ cm²/s</code>에 대해 <code>D_αΩ</code>를 계산하세요.</p>
</li>
<li>
<p><strong>코로나의 알벤 속도:</strong> <code>B = 5 G</code>, <code>n = 10⁸ cm⁻³</code> (양성자)에 대해 알벤 속도를 km/s로 계산하세요.</p>
</li>
<li>
<p><strong>임계 반경:</strong> 코로나 온도 <code>T = 2×10⁶ K</code>에 대해 임계 반경 <code>r_c</code>를 <code>R☉</code> 단위로 계산하세요.</p>
</li>
<li>
<p><strong>1 AU에서의 태양풍:</strong> <code>T = 1.5×10⁶ K</code>인 Parker 모델을 사용하여 1 AU (215 R☉)에서의 속도를 추정하세요. 관측된 ~400 km/s와 비교하세요.</p>
</li>
<li>
<p><strong>나노플레어 에너지:</strong> 크기 <code>L = 100 km</code>, <code>B = 10 G</code>인 전류 시트가 재결합합니다. erg 단위로 방출되는 에너지를 추정하세요.</p>
</li>
<li>
<p><strong>Python 연습:</strong> Parker 태양풍 코드를 등온 대신 다변 관계 <code>p ∝ ρ^{1.2}</code>를 포함하도록 수정하세요. 종단 속도가 어떻게 변합니까?</p>
</li>
<li>
<p><strong>심화:</strong> 타코클라인의 Ω-효과와 표면의 Babcock-Leighton α-효과를 가진 간단한 1D 플럭스 수송 다이나모 모델을 구현하세요. 자오선 순환과 확산을 포함하세요. 나비 다이어그램을 재현하세요.</p>
</li>
</ol>
<hr />
<p><strong>이전</strong>: <a href="./10_Turbulent_Dynamo.md">난류 다이나모</a> | <strong>다음</strong>: <a href="./12_Accretion_Disk_MHD.md">강착 원반 MHD</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/10_Turbulent_Dynamo.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. 난류 Dynamo</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/12_Accretion_Disk_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. 강착 원반 MHD</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}