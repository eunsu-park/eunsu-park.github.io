{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14. 우주 기상 MHD - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">14. 우주 기상 MHD</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>14. 우주 기상 MHD</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/13_Fusion_MHD.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. 핵융합 MHD</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/15_2D_MHD_Solver.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. 2D MHD 솔버</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">학습 목표</a></li>
<li><a href="#1">1. 우주 기상 소개</a><ul>
<li><a href="#11-">1.1 태양-지구 물리</a></li>
<li><a href="#12">1.2 태양풍 매개변수</a></li>
<li><a href="#13">1.3 우주 기상 위험</a></li>
</ul>
</li>
<li><a href="#2">2. 지구 자기권</a><ul>
<li><a href="#21">2.1 쌍극자 자기장</a></li>
<li><a href="#22-magnetopause">2.2 Magnetopause</a></li>
<li><a href="#23-magnetopause-standoff">2.3 Magnetopause Standoff 거리</a></li>
<li><a href="#24-chapman-ferraro">2.4 Chapman-Ferraro 전류 시스템</a></li>
<li><a href="#25-bow-shock">2.5 Bow Shock</a></li>
<li><a href="#26-magnetotail">2.6 Magnetotail</a></li>
</ul>
</li>
<li><a href="#3-dungey-cycle">3. Dungey Cycle 및 자기 재결합</a><ul>
<li><a href="#31">3.1 개방 자기권 개념</a></li>
<li><a href="#32-magnetopause">3.2 Magnetopause에서의 자기 재결합</a></li>
<li><a href="#33">3.3 자기권 대류</a></li>
<li><a href="#34-substorms">3.4 Substorms</a></li>
</ul>
</li>
<li><a href="#4">4. 자기 폭풍</a><ul>
<li><a href="#41-ring-current">4.1 Ring Current</a></li>
<li><a href="#42-dst-index">4.2 Dst Index</a></li>
<li><a href="#43-dst-">4.3 Dst-태양풍 결합</a></li>
<li><a href="#44">4.4 폭풍 영향</a></li>
</ul>
</li>
<li><a href="#5-cmes">5. 코로나 질량 방출 (CMEs)</a><ul>
<li><a href="#51-cme">5.1 CME 특성</a></li>
<li><a href="#52-cme-icme">5.2 행성간 CME (ICME)</a></li>
<li><a href="#53-cme">5.3 CME 전파 모델</a></li>
<li><a href="#54-mhd">5.4 MHD 시뮬레이션 모델</a></li>
<li><a href="#55-cme">5.5 CME 방향 및 지구효과성</a></li>
</ul>
</li>
<li><a href="#6-gic">6. 지자기 유도 전류 (GIC)</a><ul>
<li><a href="#61">6.1 물리적 메커니즘</a></li>
<li><a href="#62">6.2 지면 전도도</a></li>
<li><a href="#63-gic">6.3 전력망의 GIC</a></li>
<li><a href="#64-gic">6.4 GIC 크기 추정</a></li>
<li><a href="#65-gic">6.5 GIC 완화</a></li>
</ul>
</li>
<li><a href="#7">7. 우주 기상 예보</a><ul>
<li><a href="#71">7.1 관측 자산</a></li>
<li><a href="#72">7.2 예보 워크플로</a></li>
<li><a href="#73">7.3 예보 기술</a></li>
<li><a href="#74">7.4 운영 센터</a></li>
</ul>
</li>
<li><a href="#8-python">8. Python 구현</a><ul>
<li><a href="#81-magnetopause-standoff">8.1 Magnetopause Standoff 거리</a></li>
<li><a href="#82-bow-shock">8.2 Bow Shock 특성</a></li>
<li><a href="#83-dst-index-model-burton">8.3 Dst Index Model (Burton)</a></li>
<li><a href="#84-cme-transit-time">8.4 CME Transit Time</a></li>
<li><a href="#85-gic">8.5 GIC 추정</a></li>
<li><a href="#86-reconnection-electric-field">8.6 Reconnection Electric Field</a></li>
</ul>
</li>
<li><a href="#9">9. 요약</a></li>
<li><a href="#_2">연습 문제</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="14-mhd">14. 우주 기상 MHD<a class="header-link" href="#14-mhd" title="Permanent link">&para;</a></h1>
<h2 id="_1">학습 목표<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>지구 자기권 구조 및 태양풍 상호작용 이해</li>
<li>Magnetopause standoff 거리 및 bow shock 형성 분석</li>
<li>Dungey cycle 및 자기 재결합 과정 설명</li>
<li>자기 폭풍 및 Dst index 모델링</li>
<li>CME 전파, 행성간 충격파 및 도착 예측 연구</li>
<li>지자기 유도 전류 (GIC) 및 우주 기상 영향 평가</li>
<li>자기권 물리 및 우주 기상 예보를 위한 Python 모델 구현</li>
</ul>
<h2 id="1">1. 우주 기상 소개<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<p>우주 기상은 우주 기반 및 지상 기반 기술 시스템의 성능과 신뢰성에 영향을 미치고 인간의 생명이나 건강을 위협할 수 있는 태양 및 우주의 가변적인 조건을 의미합니다.</p>
<h3 id="11-">1.1 태양-지구 물리<a class="header-link" href="#11-" title="Permanent link">&para;</a></h3>
<p>태양-지구 시스템은 태양 코로나 ($T \sim 10^6$ K, $B \sim 1-100$ G)에서 지구 자기권 ($B \sim 0.01-1$ G) 및 전리층 ($n_e \sim 10^{11}$ m$^{-3}$)까지 걸친 결합된 MHD 시스템입니다.</p>
<p><strong>주요 구성요소:</strong>
- <strong>태양풍</strong>: 태양으로부터의 초음속, super-Alfvénic 플라즈마 흐름
- <strong>행성간 자기장 (IMF)</strong>: 태양풍에 의해 운반되는 frozen-in 자기장
- <strong>지구 자기권</strong>: 지구 자기장이 지배하는 영역
- <strong>Magnetopause</strong>: 태양풍과 자기권 사이의 경계
- <strong>Bow shock</strong>: 태양풍이 자기권을 만나는 충격파</p>
<h3 id="12">1.2 태양풍 매개변수<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>1 AU (지구 궤도)에서의 일반적인 태양풍 조건:</p>
<div class="highlight"><pre><span></span><code><span class="err">속도</span><span class="o">:</span><span class="w">          </span><span class="n">v_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">300</span><span class="o">-</span><span class="mi">800</span><span class="w"> </span><span class="n">km</span><span class="sr">/s (느린/</span><span class="err">빠른</span><span class="w"> </span><span class="err">풍</span><span class="o">)</span>
<span class="err">밀도</span><span class="o">:</span><span class="w">          </span><span class="n">n_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">5</span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="n">cm</span><span class="o">^-</span><span class="mi">3</span>
<span class="err">온도</span><span class="o">:</span><span class="w">          </span><span class="n">T_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="w"> </span><span class="n">K</span>
<span class="err">자기장</span><span class="o">:</span><span class="w">        </span><span class="n">B_sw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">nT</span>
<span class="err">동압</span><span class="o">:</span><span class="w">          </span><span class="n">P_dyn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">ρ</span><span class="w"> </span><span class="n">v²</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="w"> </span><span class="n">nPa</span>
</code></pre></div>

<p>태양풍은 특히 태양 폭풍 동안 매우 가변적입니다.</p>
<h3 id="13">1.3 우주 기상 위험<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<p><strong>영향:</strong>
1. <strong>위성 운영</strong>: 복사 손상, 표면 충전, 열권 가열로 인한 항력
2. <strong>통신</strong>: HF 라디오 블랙아웃, GPS 오류
3. <strong>전력망</strong>: 지자기 유도 전류 (GIC)가 변압기 손상 가능
4. <strong>항공</strong>: 고고도에서의 복사 노출, 통신 중단
5. <strong>인간 건강</strong>: 우주 비행사 복사 노출</p>
<p>주요 사건:
- <strong>Carrington Event (1859)</strong>: 기록된 최대 지자기 폭풍
- <strong>Quebec 정전 (1989)</strong>: GIC 유도 전력 정전으로 수백만 명 영향
- <strong>Halloween storms (2003)</strong>: 위성 이상, 전력망 교란
- <strong>Bastille Day storm (2000)</strong>: 통신 중단</p>
<h2 id="2">2. 지구 자기권<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 쌍극자 자기장<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>지구의 고유 자기장은 대략 자기 쌍극자입니다:</p>
<div class="highlight"><pre><span></span><code>B_r = -2 B_0 (R_E/r)³ cos θ
B_θ = -B_0 (R_E/r)³ sin θ
</code></pre></div>

<p>여기서:
- $B_0 \approx 3.12 \times 10^{-5}$ T (적도 표면 장)
- $R_E = 6371$ km (지구 반경)
- $r$은 방사 거리, $\theta$는 자기 여위도</p>
<p>쌍극자 모멘트:</p>
<div class="highlight"><pre><span></span><code>M_E ≈ 8 × 10^{22} A m²
</code></pre></div>

<p>태양풍이 없으면 쌍극자 장은 무한대까지 확장됩니다. 그러나 태양풍 압력은 낮 쪽에서 장을 압축하고 밤 쪽에서 늘립니다.</p>
<h3 id="22-magnetopause">2.2 Magnetopause<a class="header-link" href="#22-magnetopause" title="Permanent link">&para;</a></h3>
<p><strong>Magnetopause</strong>는 태양풍 동압이 지구장의 자기 압력과 균형을 이루는 경계입니다.</p>
<p><strong>압력 균형:</strong></p>
<div class="highlight"><pre><span></span><code>P_dyn = B²/(2 μ₀)
</code></pre></div>

<p>여기서 $B$는 magnetopause에서의 자기권 장입니다.</p>
<p>Subsolar point (자기권의 nose)의 경우:</p>
<div class="highlight"><pre><span></span><code>ρ_sw v_sw² = B_mp²/(2 μ₀)
</code></pre></div>

<h3 id="23-magnetopause-standoff">2.3 Magnetopause Standoff 거리<a class="header-link" href="#23-magnetopause-standoff" title="Permanent link">&para;</a></h3>
<p>Standoff 거리 $r_{mp}$ (지구 중심에서 subsolar magnetopause까지의 거리)는 압력 균형을 통해 찾아집니다.</p>
<p>단순 쌍극자 모델 사용:</p>
<div class="highlight"><pre><span></span><code>B_mp ≈ B_0 (R_E/r_mp)³
</code></pre></div>

<p>압력 균형:</p>
<div class="highlight"><pre><span></span><code>ρ_sw v_sw² = B_0² (R_E/r_mp)⁶ / (2 μ₀)
</code></pre></div>

<p>$r_{mp}$에 대해 풀기:</p>
<div class="highlight"><pre><span></span><code>r_mp = R_E (B_0² / (2 μ₀ ρ_sw v_sw²))^(1/6)
</code></pre></div>

<p>일반적인 태양풍 조건 ($\rho_{sw} v_{sw}^2 \sim 2$ nPa)의 경우:</p>
<div class="highlight"><pre><span></span><code>r_mp ~ 10-12 R_E
</code></pre></div>

<p>강한 태양풍 압력 (CME 도착) 동안 $r_{mp}$는 $< 8 R_E$로 압축될 수 있습니다.</p>
<h3 id="24-chapman-ferraro">2.4 Chapman-Ferraro 전류 시스템<a class="header-link" href="#24-chapman-ferraro" title="Permanent link">&para;</a></h3>
<p>Magnetopause는 $B$의 불연속이 아니라 자기권 장을 태양풍으로부터 차폐하는 얇은 전류 시트 (<strong>Chapman-Ferraro 전류</strong>)입니다.</p>
<p>$\nabla \times B = \mu_0 j$로부터 표면 전류 밀도:</p>
<div class="highlight"><pre><span></span><code>K = (1/μ₀) ∫ j dl ≈ (B_in - B_out) / μ₀
</code></pre></div>

<p>여기서 $B_{in}$은 자기권 장이고 $B_{out}$는 magnetosheath 장 (bow shock 바로 안쪽)입니다.</p>
<p>전류는 magnetopause 주위를 흘러 지구 장을 가두는 폐루프를 생성합니다.</p>
<h3 id="25-bow-shock">2.5 Bow Shock<a class="header-link" href="#25-bow-shock" title="Permanent link">&para;</a></h3>
<p>태양풍은 초음속 ($M_s > 1$)이고 super-Alfvénic ($M_A > 1$)이므로, 초음속 항공기 앞의 충격파와 유사하게 magnetopause 상류에 <strong>bow shock</strong>이 형성됩니다.</p>
<p>충격파를 가로지르는 <strong>점프 조건</strong> (Rankine-Hugoniot 관계):</p>
<div class="highlight"><pre><span></span><code>[ρ v_n] = 0  (질량 보존)
[ρ v_n² + p + B_t²/(2μ₀)] = 0  (운동량)
[v_n (E + p/ρ) + (v×B)_n · B_t/μ₀] = 0  (에너지)
[v_n B_t - v_t B_n] = 0  (자기장)
</code></pre></div>

<p>여기서 $v_n, v_t$는 normal 및 tangential 속도, $B_n, B_t$는 normal 및 tangential 장입니다.</p>
<p>수직 충격파 ($B \perp v$)의 경우 압축비:</p>
<div class="highlight"><pre><span></span><code>ρ₂/ρ₁ = (γ+1) M_s² / ((γ-1) M_s² + 2)
</code></pre></div>

<p>$\gamma = 5/3$이고 강한 충격파 ($M_s \gg 1$)의 경우:</p>
<div class="highlight"><pre><span></span><code>ρ₂/ρ₁ → 4
</code></pre></div>

<p><strong>Magnetosheath</strong>는 bow shock과 magnetopause 사이의 영역으로, 충격을 받고 압축되고 가열된 태양풍 플라즈마를 포함합니다.</p>
<h3 id="26-magnetotail">2.6 Magnetotail<a class="header-link" href="#26-magnetotail" title="Permanent link">&para;</a></h3>
<p>밤 쪽에서 태양풍은 지구 장을 수백 $R_E$ 하류로 확장되는 긴 <strong>magnetotail</strong>로 늘립니다.</p>
<p>Magnetotail은 다음으로 구성됩니다:
- <strong>Tail lobes</strong>: 지구로부터 떨어져 가는 (북쪽 lobe) 그리고 지구를 향한 (남쪽 lobe) 거의 평행한 자기장선
- <strong>Plasma sheet</strong>: lobes를 분리하는 얇은 전류 시트로, 뜨거운 플라즈마 포함
- <strong>Neutral sheet</strong>: plasma sheet 중심에서 $B_z = 0$인 표면</p>
<p>Tail 전류 ($\pm y$ 방향으로 흐름)가 lobe 장을 유지합니다.</p>
<h2 id="3-dungey-cycle">3. Dungey Cycle 및 자기 재결합<a class="header-link" href="#3-dungey-cycle" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 개방 자기권 개념<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p><strong>폐쇄 자기권</strong> 모델에서는 태양풍이 magnetopause를 관통하지 않고 지구 주위를 흐릅니다. 그러나 IMF가 남쪽 성분 ($B_z < 0$)을 가질 때, <strong>자기 재결합</strong>이 낮 쪽 magnetopause에서 발생하여 태양풍 플라즈마가 자기권으로 들어갈 수 있게 합니다.</p>
<p><strong>Dungey cycle</strong> (남쪽 IMF의 경우):</p>
<ol>
<li><strong>낮 쪽 재결합</strong>: IMF와 자기권 자기장선이 subsolar magnetopause에서 재결합</li>
<li><strong>대류</strong>: 재결합된 자기장선이 태양풍에 의해 극관 위로 쓸려감</li>
<li><strong>Tail 저장</strong>: 자기장선이 magnetotail에 축적되어 에너지 저장</li>
<li><strong>밤 쪽 재결합</strong>: Tail 자기장선이 plasma sheet에서 재결합</li>
<li><strong>복귀 흐름</strong>: 폐쇄된 자기장선이 낮 쪽을 향해 대류하여 플라즈마 복귀</li>
</ol>
<h3 id="32-magnetopause">3.2 Magnetopause에서의 자기 재결합<a class="header-link" href="#32-magnetopause" title="Permanent link">&para;</a></h3>
<p>재결합이 발생하려면 magnetopause의 반대쪽 자기장이 반평행 성분을 가져야 합니다.</p>
<p><strong>재결합 속도:</strong></p>
<p>재결합 전기장 $E_{rec}$는 플럭스가 전달되는 속도를 결정합니다:</p>
<div class="highlight"><pre><span></span><code>E_rec ~ 0.1 v_sw B_sw sin²(θ/2)
</code></pre></div>

<p>여기서 $\theta$는 IMF clock angle ($yz$ 평면에서 IMF와 북쪽 방향 사이의 각도)입니다.</p>
<p>최대 재결합은 남쪽 IMF ($B_z < 0$, $\theta = 180°$)에서 발생합니다.</p>
<p><strong>Flux transfer events (FTEs):</strong></p>
<p>버스트 재결합은 magnetopause를 따라 이동하는 상호 연결된 자기장선의 플럭스 튜브를 생성합니다. 이들은 자기장 크기 및 방향의 갑작스런 펄스로 관찰됩니다.</p>
<h3 id="33">3.3 자기권 대류<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<p>재결합은 자기권에서 대규모 플라즈마 순환을 구동합니다:</p>
<ul>
<li><strong>낮 쪽</strong>: 플라즈마와 자기장선이 극쪽으로 이동</li>
<li><strong>극관</strong>: 극 위로 antisunward 흐름</li>
<li><strong>밤 쪽</strong>: plasma sheet에서 sunward 복귀 흐름</li>
<li><strong>Ring current</strong>: 지구 주위의 에너지 입자의 방위각 drift</li>
</ul>
<p>대류와 관련된 전기장:</p>
<div class="highlight"><pre><span></span><code>E_conv = -v × B
</code></pre></div>

<p>일반적인 대류 속도: 100-1000 m/s, $E_{conv} \sim 0.01-0.1$ mV/m 제공.</p>
<h3 id="34-substorms">3.4 Substorms<a class="header-link" href="#34-substorms" title="Permanent link">&para;</a></h3>
<p><strong>자기권 substorm</strong>은 tail이 자기 플럭스로 과부하될 때 발생하는 magnetotail의 일시적 에너지 방출입니다.</p>
<p><strong>Substorm 단계:</strong></p>
<ol>
<li><strong>성장 단계</strong> (30-60 분): 낮 쪽 재결합이 tail에 에너지 저장, tail lobes 확장, plasma sheet 얇아짐</li>
<li><strong>확장 단계</strong> (10-30 분): 폭발적 방출, 밤 쪽 재결합 (약 10-15 $R_E$ 근처), 오로라 밝아짐, dipolarization (tail 장이 더 쌍극자처럼 됨)</li>
<li><strong>회복 단계</strong> (30-60 분): 시스템이 substorm 전 상태로 이완</li>
</ol>
<p><strong>오로라 signature:</strong></p>
<p>Substorm 시작은 오로라의 갑작스런 밝아짐 및 확장으로 표시되며, 자기장선을 따라 전리층으로 낙하하는 에너지 전자에 의해 발생합니다.</p>
<h2 id="4">4. 자기 폭풍<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<p><strong>지자기 폭풍</strong>은 종종 CME 도착와 관련된 남쪽 IMF의 장기간에 의해 구동되는 지구 자기권의 주요 교란입니다.</p>
<h3 id="41-ring-current">4.1 Ring Current<a class="header-link" href="#41-ring-current" title="Permanent link">&para;</a></h3>
<p>폭풍 동안 향상된 자기권 대류는 많은 수의 에너지 이온 (10-200 keV)을 내부 자기권으로 주입합니다. 이러한 입자는 기울기 및 곡률 drift로 인해 지구 주위를 방위각으로 drift합니다:</p>
<div class="highlight"><pre><span></span><code>v_drift = (m v_⊥² + v_∥²) / (q B²) (B × ∇B) + (m v_∥²) / (q B³) B × (b · ∇)b
</code></pre></div>

<p>이온의 경우: 서쪽으로 drift; 전자의 경우: 동쪽으로 drift.</p>
<p>순 결과는 지구 쌍극자 장에 반대하는 2-7 $R_E$ 고도의 서쪽 <strong>ring current</strong>입니다.</p>
<h3 id="42-dst-index">4.2 Dst Index<a class="header-link" href="#42-dst-index" title="Permanent link">&para;</a></h3>
<p><strong>Dst (Disturbance storm time)</strong> index는 적도 지상 관측소에서 자기장의 수평 성분 감소를 측정하여 ring current 강도의 전역 척도를 제공합니다.</p>
<div class="highlight"><pre><span></span><code>Dst = (4개 적도 관측소의 H 성분 편차 합) / 4
</code></pre></div>

<p><strong>일반적인 값:</strong>
- 조용한 조건: $Dst \sim 0$ nT
- 중간 폭풍: $Dst < -50$ nT
- 강한 폭풍: $Dst < -100$ nT
- Super-storm: $Dst < -250$ nT</p>
<p>Carrington event (1859)는 $Dst \sim -1600$ nT에 도달한 것으로 추정됩니다.</p>
<p><strong>폭풍 단계:</strong></p>
<ol>
<li><strong>초기 단계</strong> (몇 시간): Magnetopause 압축, 장의 약간 증가 ($Dst > 0$)</li>
<li><strong>주요 단계</strong> (몇 시간): Ring current 주입, $Dst$의 급격한 감소</li>
<li><strong>회복 단계</strong> (며칠): 전하 교환 및 강수를 통한 ring current 감쇠</li>
</ol>
<h3 id="43-dst-">4.3 Dst-태양풍 결합<a class="header-link" href="#43-dst-" title="Permanent link">&para;</a></h3>
<p>경험적 공식 (Burton et al. 1975):</p>
<div class="highlight"><pre><span></span><code>dDst/dt = Q(E_sw) - Dst/τ
</code></pre></div>

<p>여기서:
- $Q(E_{sw})$는 태양풍 전기장 $E_{sw} = v_{sw} B_s$에 의존하는 주입 함수
- $B_s$는 IMF의 남쪽 성분 ($B_z < 0$이면 $B_s = -B_z$, 그렇지 않으면 0)
- $\tau \sim 8$ 시간은 감쇠 시간 척도</p>
<p><strong>Burton 공식:</strong></p>
<div class="highlight"><pre><span></span><code>Q = a (v_sw B_s - b)  if v_sw B_s &gt; b, else 0
</code></pre></div>

<p>여기서 $a \sim 10^{-3}$ nT/(mV/m)이고 $b \sim 0.5$ mV/m는 경험적 상수입니다.</p>
<p>이 단순 모델은 주요 특징을 포착합니다: 더 높은 $v_{sw}$와 남쪽 $B_z$에 대해 더 강한 폭풍.</p>
<h3 id="44">4.4 폭풍 영향<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<p><strong>복사 벨트 향상:</strong></p>
<p>폭풍은 외부 복사 벨트 (L=4-7)의 전자를 에너지화하여 위성에 위험을 생성합니다.</p>
<p><strong>전리층 교란:</strong></p>
<p>향상된 전류 및 입자 강수가 전리층을 교란하여 라디오 통신 및 GPS 정확도에 영향을 줍니다.</p>
<p><strong>오로라 확장:</strong></p>
<p>오로라는 주요 폭풍 동안 중위도 (40-50° 위도)로 확장될 수 있습니다.</p>
<h2 id="5-cmes">5. 코로나 질량 방출 (CMEs)<a class="header-link" href="#5-cmes" title="Permanent link">&para;</a></h2>
<h3 id="51-cme">5.1 CME 특성<a class="header-link" href="#51-cme" title="Permanent link">&para;</a></h3>
<p><strong>코로나 질량 방출 (CME)</strong>은 태양 코로나로부터의 플라즈마와 자기장의 분출로, 200-3000 km/s의 속도로 $10^{12}-10^{13}$ kg의 물질을 방출합니다.</p>
<p><strong>트리거 메커니즘:</strong>
- 자기 플럭스 로프 분출
- 코로나 자기장의 shearing 및 twisting
- 평형 상실 (예: torus 불안정성)</p>
<p><strong>CME 구조:</strong>
- <strong>Leading edge</strong>: Coronagraph 이미지의 밝은 가장자리
- <strong>Cavity</strong>: 어두운 영역 (낮은 밀도)
- <strong>Core</strong>: 밝은 코어 (prominence 물질)</p>
<h3 id="52-cme-icme">5.2 행성간 CME (ICME)<a class="header-link" href="#52-cme-icme" title="Permanent link">&para;</a></h3>
<p>CME가 행성간 공간으로 전파되면 <strong>ICME</strong>라고 합니다. 지구 (1 AU)에서 ICMEs는 특징적인 signatures를 가집니다:</p>
<p><strong>Magnetic cloud:</strong></p>
<p>~1일 동안 자기장 벡터의 부드러운 회전, 낮은 플라즈마 beta ($\beta < 1$), 그리고 낮은 온도를 가진 ICMEs의 부분집합. 이것은 플럭스 로프 구조를 나타냅니다.</p>
<p><strong>Sheath:</strong></p>
<p>CME가 빠른 경우 ($v > v_{sw}$), 앞에 충격파를 구동합니다. 충격파와 플럭스 로프 사이의 영역은 <strong>sheath</strong>로, 압축되고 난류적인 태양풍을 포함합니다.</p>
<h3 id="53-cme">5.3 CME 전파 모델<a class="header-link" href="#53-cme" title="Permanent link">&para;</a></h3>
<p><strong>Drag 기반 모델:</strong></p>
<p>CME는 태양풍에서 공기역학적 drag를 경험합니다:</p>
<div class="highlight"><pre><span></span><code>dv/dt = -γ (v - v_sw)
</code></pre></div>

<p>여기서 $\gamma$는 drag 계수입니다:</p>
<div class="highlight"><pre><span></span><code>γ ≈ C_d A / (2 M)
</code></pre></div>

<ul>
<li>$C_d \sim 1$은 drag 계수</li>
<li>$A$는 CME 단면적</li>
<li>$M$은 CME 질량</li>
</ul>
<p><strong>해석적 해:</strong></p>
<div class="highlight"><pre><span></span><code>v(t) = v_sw + (v_0 - v_sw) exp(-γ t)
</code></pre></div>

<p>여기서 $v_0$는 초기 CME 속도입니다.</p>
<p>이동한 거리:</p>
<div class="highlight"><pre><span></span><code>r(t) = r_0 + v_sw t + (v_0 - v_sw)/γ (1 - exp(-γ t))
</code></pre></div>

<p><strong>지구까지의 전송 시간:</strong></p>
<p>$r(t_{arr}) = 1$ AU로 설정하고 $t_{arr}$에 대해 풀기.</p>
<p>일반적인 매개변수 ($v_0 = 1000$ km/s, $v_{sw} = 400$ km/s, $\gamma^{-1} = 1$ day)의 경우:</p>
<div class="highlight"><pre><span></span><code>t_arr ~ 2-3 days
</code></pre></div>

<p>더 빠른 CMEs는 1-2일에 도착; 더 느린 CMEs는 3-5일.</p>
<h3 id="54-mhd">5.4 MHD 시뮬레이션 모델<a class="header-link" href="#54-mhd" title="Permanent link">&para;</a></h3>
<p>고급 우주 기상 예보는 3D MHD 코드를 사용하여 CME 전파를 시뮬레이션합니다:</p>
<p><strong>ENLIL</strong> (NOAA):
- 태양에서 2 AU까지의 3D MHD 모델
- SOHO, ACE의 태양풍 데이터 사용
- 도착 시간, 속도, 밀도 예보 제공</p>
<p><strong>SUSANOO</strong> (일본):
- 적응 메시 개선을 사용한 전역 MHD 시뮬레이션
- CME-태양풍 상호작용 모델링</p>
<p><strong>기타 모델:</strong>
- WSA-ENLIL (결합된 코로나-태양권 모델)
- EUHFORIA (유럽 태양권 모델)</p>
<p>이러한 모델은 일반적으로 ~6-12시간 정확도로 도착 시간을 예측합니다.</p>
<h3 id="55-cme">5.5 CME 방향 및 지구효과성<a class="header-link" href="#55-cme" title="Permanent link">&para;</a></h3>
<p>CME의 <strong>지구효과성</strong>은 자기장의 방향에 결정적으로 의존합니다.</p>
<p><strong>남쪽 장 ($B_z < 0$):</strong>
- 강한 낮 쪽 재결합
- 자기권으로의 효율적인 에너지 전달
- 강한 폭풍 (큰 음의 $Dst$)</p>
<p><strong>북쪽 장 ($B_z > 0$):</strong>
- 약한 또는 없는 낮 쪽 재결합
- 최소 지자기 활동</p>
<p>CME 장 방향은 L1 (지구로부터 150만 km, ~1시간 경고)에 도착할 때만 측정할 수 있으므로 폭풍 강도 예보는 어렵습니다.</p>
<h2 id="6-gic">6. 지자기 유도 전류 (GIC)<a class="header-link" href="#6-gic" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 물리적 메커니즘<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>자기권 자기장의 급격한 변화 (폭풍 또는 substorms 동안)는 Faraday's law를 통해 전도성 지구에 전기장을 유도합니다:</p>
<div class="highlight"><pre><span></span><code>∇ × E = -∂B/∂t
</code></pre></div>

<p>지면에서 공간적으로 균일한 시간 변화 장 $B(t)$의 경우:</p>
<div class="highlight"><pre><span></span><code>E ~ -L ∂B/∂t
</code></pre></div>

<p>여기서 $L$은 특성 길이 척도입니다.</p>
<p>이러한 전기장은 전도체: 전력선, 파이프라인, 철도 선로 등에서 전류를 구동합니다.</p>
<h3 id="62">6.2 지면 전도도<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p>유도된 전기장은 지면 전도도 구조에 의존합니다:</p>
<div class="highlight"><pre><span></span><code>E(ω) = Z(ω) · H(ω)
</code></pre></div>

<p>여기서 $Z(\omega)$는 <strong>표면 임피던스</strong> (지면 전도도 프로파일에 의존)이고 $H$는 수평 자기장 섭동입니다.</p>
<p>높은 저항률을 가진 영역 (예: 캐나다, 스칸디나비아의 Precambrian shield 암석)은 큰 GIC에 더 취약합니다.</p>
<h3 id="63-gic">6.3 전력망의 GIC<a class="header-link" href="#63-gic" title="Permanent link">&para;</a></h3>
<p>GIC는 준-DC 전류로 변압기로 흘러들어 다음을 유발합니다:</p>
<ol>
<li><strong>Half-cycle saturation</strong>: DC 전류가 변압기 코어를 편향시켜 비대칭 자화로 이어짐</li>
<li><strong>증가된 무효 전력 수요</strong></li>
<li><strong>가열</strong>: 과도한 가열이 변압기 손상 가능</li>
<li><strong>고조파</strong>: AC 파형 왜곡</li>
<li><strong>전압 불안정성</strong>: cascading failures 유발 가능</li>
</ol>
<p><strong>Quebec 정전 (1989년 3월 13일):</strong></p>
<p>주요 지자기 폭풍이 Hydro-Québec 전력망에 GIC를 유도했습니다. 90초 이내에 전체 전력망이 붕괴하여 600만 명이 최대 9시간 동안 전력 없이 지냈습니다.</p>
<h3 id="64-gic">6.4 GIC 크기 추정<a class="header-link" href="#64-gic" title="Permanent link">&para;</a></h3>
<p>경험적 스케일링:</p>
<div class="highlight"><pre><span></span><code>GIC ~ (dB/dt) / R_earth
</code></pre></div>

<p>여기서 $R_{earth}$는 지구의 유효 저항 (지면 전도도에 의존)입니다.</p>
<p>$dB/dt \sim 1000$ nT/min이고 저항률 $\rho \sim 1000$ Ω·m인 폭풍의 경우:</p>
<div class="highlight"><pre><span></span><code>E ~ 1-10 V/km
</code></pre></div>

<p>100 km 송전선에 걸쳐:</p>
<div class="highlight"><pre><span></span><code>V ~ 100-1000 V
</code></pre></div>

<p>선 저항 $R \sim 0.1$ Ω의 경우:</p>
<div class="highlight"><pre><span></span><code>GIC ~ 100-1000 A
</code></pre></div>

<p>이것은 AC 전력망에 겹쳐진 준-DC입니다.</p>
<h3 id="65-gic">6.5 GIC 완화<a class="header-link" href="#65-gic" title="Permanent link">&para;</a></h3>
<p><strong>전략:</strong>
1. <strong>운영 절차</strong>: 폭풍 동안 부하 감소
2. <strong>중성점 차단 장치</strong>: DC를 차단하면서 AC를 통과시키는 커패시터 삽입
3. <strong>네트워크 재구성</strong>: 취약한 연결 개방
4. <strong>개선된 예보</strong>: 사전 경고를 통해 운영자가 준비 가능</p>
<p>최근 초점: 전력망 복원력 계획을 위한 100년 및 500년 GIC 사건 이해.</p>
<h2 id="7">7. 우주 기상 예보<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 관측 자산<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<p><strong>태양 관측:</strong>
- <strong>SOHO, SDO</strong>: 태양 이미징 (EUV, coronagraph)
- <strong>STEREO</strong>: 3D CME 구조</p>
<p><strong>태양풍 모니터:</strong>
- <strong>ACE, DSCOVR</strong>: L1 (태양쪽 150만 km)에 위치, ~30-60분 경고 제공
- 지구에 도달하기 전에 태양풍의 $v, n, B$ 측정</p>
<p><strong>자기권 모니터링:</strong>
- <strong>지상 자력계</strong>: 전역 네트워크 (SuperMAG)
- <strong>위성</strong>: GOES, THEMIS, MMS</p>
<h3 id="72">7.2 예보 워크플로<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>태양 모니터링</strong>: 플레어, CMEs 감지</li>
<li><strong>CME 전파 모델</strong>: MHD 또는 경험적 모델을 사용하여 도착 시간 추정</li>
<li><strong>L1 데이터 동화</strong>: ICME가 L1에 도달할 때 예측 개선</li>
<li><strong>지자기 지수</strong>: 태양풍 결합 함수를 기반으로 Kp, Dst 예측</li>
<li><strong>영향 평가</strong>: GIC, 복사 벨트, 전리층 효과 추정</li>
</ol>
<h3 id="73">7.3 예보 기술<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<p><strong>도착 시간</strong>: 일반적으로 CMEs에 대해 ±6-12시간
<strong>강도 (Dst)</strong>: 상관관계 ~0.7-0.8 (알 수 없는 CME $B_z$ 방향에 의해 제한됨)
<strong>확률적 예보</strong>: 앙상블 방법이 신뢰성 개선</p>
<h3 id="74">7.4 운영 센터<a class="header-link" href="#74" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>NOAA Space Weather Prediction Center (SWPC)</strong>: 미국 운영 예보</li>
<li><strong>ESA Space Situational Awareness (SSA)</strong>: 유럽 예보</li>
<li><strong>UKMO Space Weather Operations Centre (MOSWOC)</strong>: 영국 예보</li>
<li><strong>ISES (International Space Environment Service)</strong>: 전역 조정</li>
</ul>
<h2 id="8-python">8. Python 구현<a class="header-link" href="#8-python" title="Permanent link">&para;</a></h2>
<h3 id="81-magnetopause-standoff">8.1 Magnetopause Standoff 거리<a class="header-link" href="#81-magnetopause-standoff" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">magnetopause_standoff</span><span class="p">(</span><span class="n">v_sw</span><span class="p">,</span> <span class="n">n_sw</span><span class="p">,</span> <span class="n">B_0</span><span class="o">=</span><span class="mf">3.12e-5</span><span class="p">,</span> <span class="n">R_E</span><span class="o">=</span><span class="mf">6371e3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate magnetopause standoff distance.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    n_sw : solar wind density (m^-3)</span>
<span class="sd">    B_0 : Earth&#39;s equatorial surface field (T)</span>
<span class="sd">    R_E : Earth radius (m)</span>

<span class="sd">    Returns:</span>
<span class="sd">    r_mp : magnetopause standoff distance (R_E)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-7</span>
    <span class="n">m_p</span> <span class="o">=</span> <span class="mf">1.673e-27</span>  <span class="c1"># proton mass (kg)</span>

    <span class="c1"># Dynamic pressure</span>
    <span class="n">rho_sw</span> <span class="o">=</span> <span class="n">n_sw</span> <span class="o">*</span> <span class="n">m_p</span>
    <span class="n">P_dyn</span> <span class="o">=</span> <span class="n">rho_sw</span> <span class="o">*</span> <span class="n">v_sw</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Standoff distance</span>
    <span class="n">r_mp</span> <span class="o">=</span> <span class="n">R_E</span> <span class="o">*</span> <span class="p">(</span><span class="n">B_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu_0</span> <span class="o">*</span> <span class="n">P_dyn</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r_mp</span> <span class="o">/</span> <span class="n">R_E</span>  <span class="c1"># Return in Earth radii</span>

<span class="c1"># Typical solar wind conditions</span>
<span class="n">v_typical</span> <span class="o">=</span> <span class="mf">400e3</span>  <span class="c1"># m/s</span>
<span class="n">n_typical</span> <span class="o">=</span> <span class="mf">5e6</span>    <span class="c1"># m^-3</span>

<span class="n">r_mp_typical</span> <span class="o">=</span> <span class="n">magnetopause_standoff</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="n">n_typical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Typical solar wind: v = </span><span class="si">{</span><span class="n">v_typical</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s, n = </span><span class="si">{</span><span class="n">n_typical</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> cm^-3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Magnetopause standoff: r_mp = </span><span class="si">{</span><span class="n">r_mp_typical</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> R_E&quot;</span><span class="p">)</span>

<span class="c1"># CME impact (enhanced pressure)</span>
<span class="n">v_cme</span> <span class="o">=</span> <span class="mf">800e3</span>  <span class="c1"># m/s</span>
<span class="n">n_cme</span> <span class="o">=</span> <span class="mf">20e6</span>   <span class="c1"># m^-3</span>

<span class="n">r_mp_cme</span> <span class="o">=</span> <span class="n">magnetopause_standoff</span><span class="p">(</span><span class="n">v_cme</span><span class="p">,</span> <span class="n">n_cme</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CME arrival: v = </span><span class="si">{</span><span class="n">v_cme</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s, n = </span><span class="si">{</span><span class="n">n_cme</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> cm^-3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Magnetopause standoff: r_mp = </span><span class="si">{</span><span class="n">r_mp_cme</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> R_E (compressed!)&quot;</span><span class="p">)</span>

<span class="c1"># Parametric study: vary solar wind speed</span>
<span class="n">v_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">300e3</span><span class="p">,</span> <span class="mf">1000e3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">r_mp_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">magnetopause_standoff</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n_typical</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_scan</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">r_mp_scan</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">r_mp_typical</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Typical conditions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Geosynchronous orbit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Solar Wind Speed (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnetopause Standoff Distance (R$_E$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnetopause Position vs Solar Wind Speed&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;magnetopause_standoff.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="82-bow-shock">8.2 Bow Shock 특성<a class="header-link" href="#82-bow-shock" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bow_shock_jump</span><span class="p">(</span><span class="n">M_s</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate density compression ratio across bow shock.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    M_s : sonic Mach number</span>
<span class="sd">    gamma : adiabatic index</span>

<span class="sd">    Returns:</span>
<span class="sd">    r : compression ratio (ρ₂/ρ₁)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M_s</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M_s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sonic_mach_number</span><span class="p">(</span><span class="n">v_sw</span><span class="p">,</span> <span class="n">T_sw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate sonic Mach number of solar wind.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    T_sw : solar wind temperature (K)</span>

<span class="sd">    Returns:</span>
<span class="sd">    M_s : sonic Mach number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.381e-23</span>  <span class="c1"># J/K</span>
    <span class="n">m_p</span> <span class="o">=</span> <span class="mf">1.673e-27</span>  <span class="c1"># kg</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>

    <span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_sw</span> <span class="o">/</span> <span class="n">m_p</span><span class="p">)</span>
    <span class="n">M_s</span> <span class="o">=</span> <span class="n">v_sw</span> <span class="o">/</span> <span class="n">c_s</span>

    <span class="k">return</span> <span class="n">M_s</span>

<span class="c1"># Typical solar wind</span>
<span class="n">T_sw</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># K</span>
<span class="n">M_s_typical</span> <span class="o">=</span> <span class="n">sonic_mach_number</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="n">T_sw</span><span class="p">)</span>
<span class="n">r_typical</span> <span class="o">=</span> <span class="n">bow_shock_jump</span><span class="p">(</span><span class="n">M_s_typical</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bow shock (typical solar wind):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sonic Mach number: M_s = </span><span class="si">{</span><span class="n">M_s_typical</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Density compression: ρ₂/ρ₁ = </span><span class="si">{</span><span class="n">r_typical</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Fast solar wind (CME)</span>
<span class="n">M_s_cme</span> <span class="o">=</span> <span class="n">sonic_mach_number</span><span class="p">(</span><span class="n">v_cme</span><span class="p">,</span> <span class="n">T_sw</span><span class="p">)</span>
<span class="n">r_cme</span> <span class="o">=</span> <span class="n">bow_shock_jump</span><span class="p">(</span><span class="n">M_s_cme</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bow shock (CME):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sonic Mach number: M_s = </span><span class="si">{</span><span class="n">M_s_cme</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Density compression: ρ₂/ρ₁ = </span><span class="si">{</span><span class="n">r_cme</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Mach number scan</span>
<span class="n">M_s_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">r_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">bow_shock_jump</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">M_s_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M_s_scan</span><span class="p">,</span> <span class="n">r_scan</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Strong shock limit (r=4)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sonic Mach Number $M_s$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density Compression Ratio&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bow Shock Density Jump vs Mach Number&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bow_shock_jump.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="83-dst-index-model-burton">8.3 Dst Index Model (Burton)<a class="header-link" href="#83-dst-index-model-burton" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dst_evolution</span><span class="p">(</span><span class="n">Dst_0</span><span class="p">,</span> <span class="n">v_sw_series</span><span class="p">,</span> <span class="n">B_z_series</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="mi">3600</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evolve Dst index using Burton model.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    Dst_0 : initial Dst (nT)</span>
<span class="sd">    v_sw_series : solar wind speed time series (m/s)</span>
<span class="sd">    B_z_series : IMF Bz time series (T)</span>
<span class="sd">    dt : timestep (s)</span>
<span class="sd">    a : injection parameter (nT/(mV/m))</span>
<span class="sd">    b : threshold (mV/m)</span>
<span class="sd">    tau : decay timescale (s)</span>

<span class="sd">    Returns:</span>
<span class="sd">    Dst_series : Dst evolution (nT)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v_sw_series</span><span class="p">)</span>
    <span class="n">Dst_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">Dst</span> <span class="o">=</span> <span class="n">Dst_0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">Dst_series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dst</span>

        <span class="c1"># Solar wind electric field (in mV/m)</span>
        <span class="n">B_s</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">B_z_series</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e9</span>  <span class="c1"># Convert to nT, take southward component</span>
        <span class="n">E_sw</span> <span class="o">=</span> <span class="n">v_sw_series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">B_s</span> <span class="o">/</span> <span class="mf">1e6</span>  <span class="c1"># mV/m</span>

        <span class="c1"># Injection function</span>
        <span class="k">if</span> <span class="n">E_sw</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">E_sw</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Burton equation</span>
        <span class="n">dDst_dt</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">-</span> <span class="n">Dst</span> <span class="o">/</span> <span class="n">tau</span>

        <span class="n">Dst</span> <span class="o">+=</span> <span class="n">dDst_dt</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="k">return</span> <span class="n">Dst_series</span>

<span class="c1"># Simulate a magnetic storm</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>  <span class="c1"># 5 days</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># 10 min</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">t_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="mi">3600</span>  <span class="c1"># hours</span>

<span class="c1"># Solar wind scenario: CME arrival at t=12 hours</span>
<span class="n">v_sw_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">400e3</span>  <span class="c1"># m/s</span>
<span class="n">B_z_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2e-9</span>  <span class="c1"># T (northward)</span>

<span class="c1"># CME arrival: 12-36 hours, enhanced speed and southward field</span>
<span class="n">t_cme_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">t_cme_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">36</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">v_sw_series</span><span class="p">[</span><span class="n">t_cme_start</span><span class="p">:</span><span class="n">t_cme_end</span><span class="p">]</span> <span class="o">=</span> <span class="mf">600e3</span>  <span class="c1"># m/s</span>
<span class="n">B_z_series</span><span class="p">[</span><span class="n">t_cme_start</span><span class="p">:</span><span class="n">t_cme_end</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">15e-9</span>  <span class="c1"># T (strongly southward)</span>

<span class="c1"># Evolve Dst</span>
<span class="n">Dst_0</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># nT (quiet conditions)</span>
<span class="n">Dst_series</span> <span class="o">=</span> <span class="n">dst_evolution</span><span class="p">(</span><span class="n">Dst_0</span><span class="p">,</span> <span class="n">v_sw_series</span><span class="p">,</span> <span class="n">B_z_series</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dst storm simulation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum Dst: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Dst_series</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> nT at t = </span><span class="si">{</span><span class="n">t_series</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">Dst_series</span><span class="p">)]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> hours&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">v_sw_series</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Solar Wind Speed (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnetic Storm Simulation (Burton Dst Model)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">B_z_series</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;IMF $B_z$ (nT)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_series</span><span class="p">,</span> <span class="n">Dst_series</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Moderate storm&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Intense storm&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hours)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Dst (nT)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dst_storm_simulation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="84-cme-transit-time">8.4 CME Transit Time<a class="header-link" href="#84-cme-transit-time" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cme_transit_time</span><span class="p">(</span><span class="n">v_0</span><span class="p">,</span> <span class="n">v_sw</span><span class="o">=</span><span class="mf">400e3</span><span class="p">,</span> <span class="n">gamma_inv</span><span class="o">=</span><span class="mi">86400</span><span class="p">,</span> <span class="n">r_target</span><span class="o">=</span><span class="mf">1.496e11</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate CME arrival time using drag model.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_0 : initial CME speed (m/s)</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    gamma_inv : inverse drag coefficient (s)</span>
<span class="sd">    r_target : target distance (m, default 1 AU)</span>

<span class="sd">    Returns:</span>
<span class="sd">    t_arr : arrival time (hours)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Solve r(t) = r_target for t</span>
    <span class="c1"># r(t) = v_sw * t + (v_0 - v_sw) * gamma_inv * (1 - exp(-t/gamma_inv))</span>
    <span class="c1"># Iterative solution</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># 10 min</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">r_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">r_target</span>  <span class="c1"># Start at 0.1 AU (close to Sun)</span>

    <span class="k">while</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">r_target</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v_sw</span> <span class="o">+</span> <span class="p">(</span><span class="n">v_0</span> <span class="o">-</span> <span class="n">v_sw</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="n">gamma_inv</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>

    <span class="k">return</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">3600</span>  <span class="c1"># Convert to hours</span>

<span class="c1"># CME scenarios</span>
<span class="n">v_0_slow</span> <span class="o">=</span> <span class="mf">500e3</span>  <span class="c1"># m/s</span>
<span class="n">v_0_fast</span> <span class="o">=</span> <span class="mf">1200e3</span>  <span class="c1"># m/s</span>

<span class="n">t_arr_slow</span> <span class="o">=</span> <span class="n">cme_transit_time</span><span class="p">(</span><span class="n">v_0_slow</span><span class="p">)</span>
<span class="n">t_arr_fast</span> <span class="o">=</span> <span class="n">cme_transit_time</span><span class="p">(</span><span class="n">v_0_fast</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CME transit time to Earth (1 AU):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slow CME (v₀ = </span><span class="si">{</span><span class="n">v_0_slow</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s): </span><span class="si">{</span><span class="n">t_arr_slow</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> hours (</span><span class="si">{</span><span class="n">t_arr_slow</span><span class="o">/</span><span class="mi">24</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> days)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast CME (v₀ = </span><span class="si">{</span><span class="n">v_0_fast</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> km/s): </span><span class="si">{</span><span class="n">t_arr_fast</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> hours (</span><span class="si">{</span><span class="n">t_arr_fast</span><span class="o">/</span><span class="mi">24</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> days)&quot;</span><span class="p">)</span>

<span class="c1"># Parametric study</span>
<span class="n">v_0_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">400e3</span><span class="p">,</span> <span class="mf">2000e3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">t_arr_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">cme_transit_time</span><span class="p">(</span><span class="n">v_0</span><span class="p">)</span> <span class="k">for</span> <span class="n">v_0</span> <span class="ow">in</span> <span class="n">v_0_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_0_scan</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_arr_scan</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Initial CME Speed (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Transit Time to 1 AU (days)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;CME Arrival Time vs Initial Speed (Drag Model)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cme_transit_time.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="85-gic">8.5 GIC 추정<a class="header-link" href="#85-gic" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gic_estimate</span><span class="p">(</span><span class="n">dB_dt</span><span class="p">,</span> <span class="n">rho_earth</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mf">100e3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate geomagnetically induced current.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    dB_dt : magnetic field time derivative (nT/min)</span>
<span class="sd">    rho_earth : Earth resistivity (Ω·m)</span>
<span class="sd">    L : transmission line length (m)</span>

<span class="sd">    Returns:</span>
<span class="sd">    E : induced electric field (V/km)</span>
<span class="sd">    GIC : induced current (A, assuming 0.1 Ω line resistance)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-7</span>

    <span class="c1"># Induced electric field (rough estimate)</span>
    <span class="c1"># E ~ (dB/dt) * sqrt(ρ/(2πμ₀f))</span>
    <span class="c1"># For quasi-DC, use simplified scaling</span>
    <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="n">dB_dt</span> <span class="o">*</span> <span class="mf">1e-9</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rho_earth</span> <span class="o">/</span> <span class="n">mu_0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># V/km</span>

    <span class="c1"># Voltage over line</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="mf">1e3</span>  <span class="c1"># V</span>

    <span class="c1"># Current (assuming line resistance R ~ 0.1 Ω)</span>
    <span class="n">R_line</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Ω</span>
    <span class="n">GIC</span> <span class="o">=</span> <span class="n">V</span> <span class="o">/</span> <span class="n">R_line</span>  <span class="c1"># A</span>

    <span class="k">return</span> <span class="n">E</span><span class="p">,</span> <span class="n">GIC</span>

<span class="c1"># Quebec blackout scenario</span>
<span class="n">dB_dt_quebec</span> <span class="o">=</span> <span class="mi">480</span>  <span class="c1"># nT/min (observed)</span>

<span class="n">E_quebec</span><span class="p">,</span> <span class="n">GIC_quebec</span> <span class="o">=</span> <span class="n">gic_estimate</span><span class="p">(</span><span class="n">dB_dt_quebec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Quebec blackout (1989-03-13):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dB/dt = </span><span class="si">{</span><span class="n">dB_dt_quebec</span><span class="si">}</span><span class="s2"> nT/min&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Induced electric field: E ~ </span><span class="si">{</span><span class="n">E_quebec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> V/km&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GIC (100 km line): ~ </span><span class="si">{</span><span class="n">GIC_quebec</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> A&quot;</span><span class="p">)</span>

<span class="c1"># Carrington event estimate</span>
<span class="n">dB_dt_carrington</span> <span class="o">=</span> <span class="mi">5000</span>  <span class="c1"># nT/min (estimated)</span>

<span class="n">E_carrington</span><span class="p">,</span> <span class="n">GIC_carrington</span> <span class="o">=</span> <span class="n">gic_estimate</span><span class="p">(</span><span class="n">dB_dt_carrington</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Carrington event (1859, estimated):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dB/dt = </span><span class="si">{</span><span class="n">dB_dt_carrington</span><span class="si">}</span><span class="s2"> nT/min&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Induced electric field: E ~ </span><span class="si">{</span><span class="n">E_carrington</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> V/km&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GIC (100 km line): ~ </span><span class="si">{</span><span class="n">GIC_carrington</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> A&quot;</span><span class="p">)</span>

<span class="c1"># Parametric study</span>
<span class="n">dB_dt_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">GIC_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">gic_estimate</span><span class="p">(</span><span class="n">dB_dt</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">dB_dt</span> <span class="ow">in</span> <span class="n">dB_dt_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dB_dt_scan</span><span class="p">,</span> <span class="n">GIC_scan</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Concern level (~100 A)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dB_dt_quebec</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Quebec 1989&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dB/dt (nT/min)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;GIC (A)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Geomagnetically Induced Current vs dB/dt&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gic_estimate.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="86-reconnection-electric-field">8.6 Reconnection Electric Field<a class="header-link" href="#86-reconnection-electric-field" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reconnection_electric_field</span><span class="p">(</span><span class="n">v_sw</span><span class="p">,</span> <span class="n">B_sw</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate reconnection electric field at magnetopause.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    v_sw : solar wind speed (m/s)</span>
<span class="sd">    B_sw : IMF magnitude (T)</span>
<span class="sd">    theta : IMF clock angle (degrees, 0=northward, 180=southward)</span>

<span class="sd">    Returns:</span>
<span class="sd">    E_rec : reconnection electric field (mV/m)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">E_rec</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">v_sw</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">B_sw</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_rad</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># mV/m</span>
    <span class="k">return</span> <span class="n">E_rec</span>

<span class="c1"># Northward IMF</span>
<span class="n">E_rec_north</span> <span class="o">=</span> <span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reconnection electric field:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Northward IMF (θ=0°): E_rec = </span><span class="si">{</span><span class="n">E_rec_north</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> mV/m (minimal reconnection)&quot;</span><span class="p">)</span>

<span class="c1"># Southward IMF</span>
<span class="n">E_rec_south</span> <span class="o">=</span> <span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Southward IMF (θ=180°): E_rec = </span><span class="si">{</span><span class="n">E_rec_south</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> mV/m (strong reconnection)&quot;</span><span class="p">)</span>

<span class="c1"># Strong southward IMF (CME)</span>
<span class="n">E_rec_cme</span> <span class="o">=</span> <span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_cme</span><span class="p">,</span> <span class="mf">20e-9</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CME with southward field: E_rec = </span><span class="si">{</span><span class="n">E_rec_cme</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> mV/m (very strong!)&quot;</span><span class="p">)</span>

<span class="c1"># Clock angle scan</span>
<span class="n">theta_scan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">E_rec_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">reconnection_electric_field</span><span class="p">(</span><span class="n">v_typical</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_scan</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_scan</span><span class="p">,</span> <span class="n">E_rec_scan</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;IMF Clock Angle (degrees)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reconnection E-field (mV/m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnetopause Reconnection vs IMF Orientation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reconnection_efield.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="9">9. 요약<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<p>이 강의는 우주 기상의 MHD 물리를 다루었습니다:</p>
<ol>
<li><strong>지구 자기권</strong>: 태양풍에 의해 압축된 쌍극자 장, magnetopause, bow shock, magnetotail 형성</li>
<li><strong>Magnetopause</strong>: 압력 균형이 standoff 거리 결정 ($r_{mp} \sim 10 R_E$)</li>
<li><strong>Bow shock</strong>: 태양풍을 초음속에서 아음속으로 충격, 밀도를 약 4배 압축</li>
<li><strong>Dungey cycle</strong>: 자기 재결합이 자기권 대류 및 substorms 구동</li>
<li><strong>자기 폭풍</strong>: Ring current 형성이 Dst index 감소시킴, 남쪽 IMF에 의해 구동됨</li>
<li><strong>CMEs</strong>: 태양 플라즈마/장의 분출적 방출, 1-5일에 지구로 전파</li>
<li><strong>GIC</strong>: 급격한 B 변화로부터 전력망의 유도 전류, 정전 유발 가능</li>
<li><strong>예보</strong>: 태양 관측, MHD 모델, L1 모니터의 조합</li>
</ol>
<p>우주 기상 MHD는 태양에서 지구까지의 규모를 연결하며, 중요한 인프라를 보호하기 위해 전역 모델링 및 실시간 예보를 필요로 합니다.</p>
<h2 id="_2">연습 문제<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Magnetopause 압축</strong>: CME 동안 태양풍 속도가 $v_{sw} = 900$ km/s로 증가하고 밀도가 $n_{sw} = 30$ cm$^{-3}$로 증가합니다. Magnetopause standoff 거리를 계산하세요. 이것이 geosynchronous orbit (6.6 $R_E$) 안쪽으로 압축됩니까?</p>
</li>
<li>
<p><strong>Bow shock</strong>: $v_{sw} = 600$ km/s, $T_{sw} = 10^5$ K인 태양풍의 경우, sonic Mach number 및 bow shock를 가로지르는 밀도 압축비를 계산하세요.</p>
</li>
<li>
<p><strong>Dst 예측</strong>: Burton 모델을 사용하여 6시간 동안 유지되는 태양풍 전기장 $E_{sw} = v_{sw} B_s = 5$ mV/m인 폭풍의 최소 Dst를 추정하세요. 초기 $Dst_0 = 0$, $a = 10^{-3}$ nT/(mV/m), $b = 0.5$ mV/m, $\tau = 8$ 시간을 가정하세요. 폭풍을 분류하세요 (중간: $< -50$ nT; 강한: $< -100$ nT).</p>
</li>
<li>
<p><strong>CME transit</strong>: CME가 $v_0 = 1500$ km/s로 발사됩니다. $v_{sw} = 400$ km/s이고 $\gamma^{-1} = 1$ day인 drag 모델을 사용하여 지구 (1 AU = 1.5 × 10$^{11}$ m)까지의 도착 시간을 추정하세요. 시간과 일로 표현하세요.</p>
</li>
<li>
<p><strong>재결합 속도</strong>: (a) 북쪽 IMF: $v_{sw} = 400$ km/s, $B_{sw} = 5$ nT, $\theta = 0°$; (b) 남쪽 IMF: 동일한 매개변수, $\theta = 180°$에 대한 재결합 전기장을 계산하세요. 재결합 효율을 비교하세요.</p>
</li>
<li>
<p><strong>GIC 위험</strong>: 폭풍 동안 $dB/dt = 1000$ nT/min입니다. 200 km 송전선에서 유도된 전기장 및 GIC를 추정하세요 ($\rho_{earth} = 1000$ Ω·m, $R_{line} = 0.2$ Ω 가정). 이것이 전력망에 우려됩니까?</p>
</li>
<li>
<p><strong>Substorm 에너지</strong>: substorm이 30분 동안 $10^{15}$ J의 에너지를 방출합니다. 이 에너지가 100 km 고도의 $10^{12}$ m$^2$ 면적에 걸쳐 전리층에 증착되면 에너지 플럭스 (W/m$^2$)를 추정하세요. 태양 상수 (1360 W/m$^2$)와 비교하세요.</p>
</li>
<li>
<p><strong>Ring current</strong>: Dst index 감소는 ring current 에너지에 비례합니다: $Dst \sim -E_{ring} / (4 \times 10^{14} \text{ J/nT})$. $Dst = -150$ nT의 경우, ring current 에너지를 추정하세요. 줄로 표현하세요.</p>
</li>
<li>
<p><strong>CME magnetic cloud</strong>: magnetic cloud가 $B \sim 30$ nT, $n \sim 10$ cm$^{-3}$, $T \sim 10^4$ K를 가집니다. 플라즈마 beta $\beta = 2 \mu_0 p / B^2$를 계산하세요. 이것이 플럭스 로프 구조 ($\beta < 1$)와 일치합니까?</p>
</li>
<li>
<p><strong>우주 기상 예보</strong>: CME 도착 시간이 ~12시간 전에 예측될 수 있지만 폭풍 강도 (Dst 최소값)는 CME가 L1에 도달할 때까지 불확실한 이유를 설명하세요. 중요한 누락 정보는 무엇입니까?</p>
</li>
</ol>
<hr />
<p><strong>이전</strong>: <a href="./13_Fusion_MHD.md">Fusion MHD</a> | <strong>다음</strong>: <a href="./15_2D_MHD_Solver.md">2D MHD Solver</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/13_Fusion_MHD.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. 핵융합 MHD</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/15_2D_MHD_Solver.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. 2D MHD 솔버</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}