{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>16. ìƒëŒ€ë¡ ì  MHD - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/MHD/">MHD</a>
    <span class="separator">/</span>
    <span class="current">16. ìƒëŒ€ë¡ ì  MHD</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>16. ìƒëŒ€ë¡ ì  MHD</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/15_2D_MHD_Solver.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">15. 2D MHD ì†”ë²„</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/17_Spectral_Methods.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">17. ìŠ¤í™íŠ¸ëŸ´ ë° ê³ ê¸‰ ë°©ë²•</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1-mhd">1. ìƒëŒ€ë¡ ì  MHD ì†Œê°œ</a><ul>
<li><a href="#11-mhd">1.1 ìƒëŒ€ë¡ ì  MHDê°€ í•„ìš”í•œ ê²½ìš°</a></li>
<li><a href="#12-mhd">1.2 ë¹„ìƒëŒ€ë¡ ì  MHDì™€ì˜ ì£¼ìš” ì°¨ì´ì </a></li>
</ul>
</li>
<li><a href="#2-mhd-srmhd">2. íŠ¹ìˆ˜ ìƒëŒ€ë¡ ì  MHD (SRMHD)</a><ul>
<li><a href="#21">2.1 ê³µë³€ ì •ì‹í™”</a></li>
<li><a href="#22-maxwell">2.2 ê³µë³€ í˜•íƒœì˜ Maxwell ë°©ì •ì‹</a></li>
<li><a href="#23-">2.3 ì‘ë ¥-ì—ë„ˆì§€ í…ì„œ</a></li>
<li><a href="#24">2.4 ë³´ì¡´ ë²•ì¹™</a></li>
</ul>
</li>
<li><a href="#3-srmhd">3. ì´ìƒ SRMHD</a><ul>
<li><a href="#31">3.1 ì´ìƒ ì¡°ê±´</a></li>
<li><a href="#32-31">3.2 3+1 ë¶„í•´</a></li>
<li><a href="#33">3.3 ì›ì‹œ ë³€ìˆ˜ ë³µì›</a></li>
</ul>
</li>
<li><a href="#4-srmhd">4. SRMHDì˜ íŒŒë™ êµ¬ì¡°</a><ul>
<li><a href="#41">4.1 ê³ ìœ êµ¬ì¡°</a></li>
<li><a href="#42-riemann">4.2 ìƒëŒ€ë¡ ì  Riemann ë¬¸ì œ</a></li>
</ul>
</li>
<li><a href="#5-srmhd">5. SRMHDì˜ ì‘ìš©</a><ul>
<li><a href="#51">5.1 ìƒëŒ€ë¡ ì  ì œíŠ¸</a></li>
<li><a href="#52">5.2 í„ì„œ ìê¸°ê¶Œ</a></li>
<li><a href="#53">5.3 ë¸”ë™í™€ ê°•ì°©</a></li>
</ul>
</li>
<li><a href="#6-mhd-grmhd">6. ì¼ë°˜ ìƒëŒ€ë¡ ì  MHD (GRMHD)</a><ul>
<li><a href="#61">6.1 ê³¡ì„  ì‹œê³µê°„ ì •ì‹í™”</a></li>
<li><a href="#62-harm">6.2 HARM ì½”ë“œ ì •ì‹í™”</a></li>
<li><a href="#63">6.3 ì§€í‰ì„  ê²½ê³„ ì¡°ê±´</a></li>
</ul>
</li>
<li><a href="#7-srmhd">7. SRMHDì˜ ìˆ˜ì¹˜ ë°©ë²•</a><ul>
<li><a href="#71-godunov">7.1 Godunoví˜• ë°©ì‹</a></li>
<li><a href="#72">7.2 ì ì‘í˜• íƒ€ì„ìŠ¤í…</a></li>
<li><a href="#73">7.3 í”Œë¡œì–´ì™€ ìƒí•œ</a></li>
</ul>
</li>
<li><a href="#8-python-1d-srmhd">8. Python êµ¬í˜„: 1D SRMHD ì¶©ê²©íŒŒ íŠœë¸Œ</a><ul>
<li><a href="#81">8.1 ë¬¸ì œ ì„¤ì •</a></li>
<li><a href="#82">8.2 ì½”ë“œ êµ¬ì¡°</a></li>
<li><a href="#83">8.3 ì˜ˆìƒ ì¶œë ¥</a></li>
</ul>
</li>
<li><a href="#9-alfven">9. ìƒëŒ€ë¡ ì  AlfvÃ©n ì†ë„</a><ul>
<li><a href="#91-vs">9.1 ë¹„êµ: ë¹„ìƒëŒ€ë¡ ì  vs ìƒëŒ€ë¡ ì </a></li>
</ul>
</li>
<li><a href="#10-light-cylinder">10. Light Cylinder ì‹œê°í™”</a></li>
<li><a href="#_2">ìš”ì•½</a></li>
<li><a href="#_3">ì—°ìŠµ ë¬¸ì œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="16-mhd">16. ìƒëŒ€ë¡ ì  MHD<a class="header-link" href="#16-mhd" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>ì´ ë ˆìŠ¨ì„ ë§ˆì¹˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<ul>
<li>ê³µë³€ í‘œê¸°ë²•ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ìˆ˜ ìƒëŒ€ë¡ ì  MHD(SRMHD) ë°©ì •ì‹ì„ ì •ì‹í™”í•˜ê¸°</li>
<li>SRMHDì—ì„œ ì‘ë ¥-ì—ë„ˆì§€ í…ì„œì™€ ì „ìê¸°ì¥ í…ì„œ ì´í•´í•˜ê¸°</li>
<li>ìˆ˜ì¹˜ êµ¬í˜„ì„ ìœ„í•œ SRMHD ë°©ì •ì‹ì˜ 3+1 ë¶„í•´ ìœ ë„í•˜ê¸°</li>
<li>ìƒëŒ€ë¡ ì  ì›ì‹œ ë³€ìˆ˜ ë³µì› ë¬¸ì œ í•´ê²°í•˜ê¸°</li>
<li>ìƒëŒ€ë¡ ì  MHDì˜ íŒŒë™ êµ¬ì¡°(fast, slow, AlfvÃ©n) ë¶„ì„í•˜ê¸°</li>
<li>ìƒëŒ€ë¡ ì  ì œíŠ¸, í„ì„œ ìê¸°ê¶Œ, ë¸”ë™í™€ ê°•ì°©ì— SRMHD ì ìš©í•˜ê¸°</li>
<li>Pythonìœ¼ë¡œ 1D SRMHD ì¶©ê²©íŒŒ íŠœë¸Œ ì†”ë²„ êµ¬í˜„í•˜ê¸°</li>
<li>ì¼ë°˜ ìƒëŒ€ë¡ ì  MHD(GRMHD)ì˜ ê¸°ì´ˆì™€ ì‘ìš© ì´í•´í•˜ê¸°</li>
</ul>
<hr />
<h2 id="1-mhd">1. ìƒëŒ€ë¡ ì  MHD ì†Œê°œ<a class="header-link" href="#1-mhd" title="Permanent link">&para;</a></h2>
<h3 id="11-mhd">1.1 ìƒëŒ€ë¡ ì  MHDê°€ í•„ìš”í•œ ê²½ìš°<a class="header-link" href="#11-mhd" title="Permanent link">&para;</a></h3>
<p>ë¹„ìƒëŒ€ë¡ ì  MHDëŠ” $v \ll c$ë¥¼ ê°€ì •í•˜ê³  ë‹¤ìŒì„ ë¬´ì‹œí•©ë‹ˆë‹¤:
- ì „ìê¸°ì¥ì˜ Lorentz ìˆ˜ì¶•
- Maxwell ë°©ì •ì‹ì˜ ë³€ìœ„ ì „ë¥˜
- ìƒëŒ€ë¡ ì  ì§ˆëŸ‰-ì—ë„ˆì§€ ë“±ê°€ì„±</p>
<p>ìƒëŒ€ë¡ ì  MHD(RMHD)ëŠ” ë‹¤ìŒì˜ ê²½ìš° í•„ìˆ˜ì ì…ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code>â€¢ ìœ ì†ì´ cì— ê·¼ì ‘: v/c ~ 0.1-1
  - ìƒëŒ€ë¡ ì  ì œíŠ¸: AGN, GRB (Î“ ~ 10-100)
  - í„ì„œ ë°”ëŒ (Î“ ~ 10â´-10â¶)
  - ê°•ì°© ë””ìŠ¤í¬ ë‚´ë¶€ ì˜ì—­ (ISCOì—ì„œ v ~ 0.3c)

â€¢ ìê¸° ì••ë ¥ì´ ì§€ë°°: Ïƒ = BÂ²/(4Ï€ÏcÂ²) â‰« 1
  - Magnetar ìê¸°ê¶Œ: B ~ 10Â¹âµ G
  - í„ì„œ ê·¹ê´€

â€¢ ê°•í•œ ì¤‘ë ¥ì¥:
  - ë¸”ë™í™€ ê°•ì°© (r ~ 2-10 GM/cÂ²)
  - ì¤‘ì„±ìë³„ ë³‘í•©
</code></pre></div>

<h3 id="12-mhd">1.2 ë¹„ìƒëŒ€ë¡ ì  MHDì™€ì˜ ì£¼ìš” ì°¨ì´ì <a class="header-link" href="#12-mhd" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì¸¡ë©´</th>
<th>ë¹„ìƒëŒ€ë¡ ì </th>
<th>ìƒëŒ€ë¡ ì </th>
</tr>
</thead>
<tbody>
<tr>
<td>ì „ê¸°ì¥</td>
<td>$\mathbf{E} = -\mathbf{v} \times \mathbf{B}/c$</td>
<td>$\mathbf{E}$ëŠ” ë…ë¦½ì ì¸ ë™ì  ë³€ìˆ˜</td>
</tr>
<tr>
<td>ë³€ìœ„ ì „ë¥˜</td>
<td>ë¬´ì‹œë¨</td>
<td>$\partial \mathbf{E}/\partial t$ í¬í•¨</td>
</tr>
<tr>
<td>ë³´ì¡´ ë²•ì¹™</td>
<td>ì§ˆëŸ‰, ìš´ë™ëŸ‰, ì—ë„ˆì§€ ë¶„ë¦¬</td>
<td>$\partial_\mu T^{\mu\nu} = 0$ì—ì„œ í†µí•©</td>
</tr>
<tr>
<td>íŒŒë™ ì†ë„</td>
<td>$v$ì™€ ë¬´ê´€</td>
<td>Lorentz ì¸ì $W$ì— ì˜í•´ ìˆ˜ì •</td>
</tr>
<tr>
<td>ì›ì‹œë³€ìˆ˜ ë³µì›</td>
<td>ëŒ€ìˆ˜ì </td>
<td>ì•”ë¬µì  ê·¼ì°¾ê¸° í•„ìš”</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-mhd-srmhd">2. íŠ¹ìˆ˜ ìƒëŒ€ë¡ ì  MHD (SRMHD)<a class="header-link" href="#2-mhd-srmhd" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ê³µë³€ ì •ì‹í™”<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p><strong>ê³„ëŸ‰ê³¼ 4-ë²¡í„°:</strong></p>
<p>Minkowski ê³„ëŸ‰ (ë¶€í˜¸ $-,+,+,+$):
$$
\eta_{\mu\nu} = \text{diag}(-1, 1, 1, 1)
$$</p>
<p>4-ì†ë„:
$$
u^\mu = W(c, \mathbf{v}), \quad u^\mu u_\mu = -c^2
$$
ì—¬ê¸°ì„œ $W = 1/\sqrt{1 - v^2/c^2}$ëŠ” Lorentz ì¸ìì…ë‹ˆë‹¤.</p>
<p><strong>ì „ìê¸°ì¥ í…ì„œ:</strong>
$$
F^{\mu\nu} = \begin{pmatrix}
0 & -E_x/c & -E_y/c & -E_z/c \\
E_x/c & 0 & -B_z & B_y \\
E_y/c & B_z & 0 & -B_x \\
E_z/c & -B_y & B_x & 0
\end{pmatrix}
$$</p>
<p>ìŒëŒ€ í…ì„œ:
$$
F^{*\mu\nu} = \frac{1}{2} \epsilon^{\mu\nu\alpha\beta} F_{\alpha\beta}
$$
ì—¬ê¸°ì„œ $\epsilon^{\mu\nu\alpha\beta}$ëŠ” Levi-Civita í…ì„œì…ë‹ˆë‹¤.</p>
<h3 id="22-maxwell">2.2 ê³µë³€ í˜•íƒœì˜ Maxwell ë°©ì •ì‹<a class="header-link" href="#22-maxwell" title="Permanent link">&para;</a></h3>
<p><strong>ì†ŒìŠ¤ ì—†ëŠ” Maxwell ë°©ì •ì‹:</strong>
$$
\partial_\mu F^{*\mu\nu} = 0 \quad \Rightarrow \quad \nabla \cdot \mathbf{B} = 0, \quad \nabla \times \mathbf{E} + \frac{\partial \mathbf{B}}{\partial t} = 0
$$</p>
<p><strong>ì „ë¥˜ í¬í•¨ (ì €í•­ì„± RMHD):</strong>
$$
\partial_\mu F^{\mu\nu} = \frac{4\pi}{c} J^\nu
$$
ì—¬ê¸°ì„œ $J^\mu = (c\rho_e, \mathbf{J})$ëŠ” 4-ì „ë¥˜ì…ë‹ˆë‹¤.</p>
<h3 id="23-">2.3 ì‘ë ¥-ì—ë„ˆì§€ í…ì„œ<a class="header-link" href="#23-" title="Permanent link">&para;</a></h3>
<p><strong>ì´ ì‘ë ¥-ì—ë„ˆì§€ í…ì„œ:</strong>
$$
T^{\mu\nu} = T^{\mu\nu}_{\text{fluid}} + T^{\mu\nu}_{\text{EM}}
$$</p>
<p><strong>ìœ ì²´ ê¸°ì—¬:</strong>
$$
T^{\mu\nu}_{\text{fluid}} = (\rho h + u_m) u^\mu u^\nu + (p + p_m) \eta^{\mu\nu}
$$
ì—¬ê¸°ì„œ:
- $\rho$ = ì •ì§€ ì§ˆëŸ‰ ë°€ë„
- $h = 1 + \epsilon + p/(\rho c^2)$ = ë¹„ì—”íƒˆí”¼
- $\epsilon$ = ë¹„ë‚´ë¶€ ì—ë„ˆì§€
- $u_m = b^2/(8\pi)$ = ê³µë™ ì¢Œí‘œê³„ì˜ ìê¸° ì—ë„ˆì§€ ë°€ë„
- $p_m = b^2/(8\pi)$ = ìê¸° ì••ë ¥ (ë“±ë°©ì„± ë¶€ë¶„)</p>
<p><strong>ì „ìê¸° ê¸°ì—¬:</strong>
$$
T^{\mu\nu}_{\text{EM}} = \frac{1}{4\pi} \left( F^{\mu\alpha} F^\nu_{\ \alpha} - \frac{1}{4} \eta^{\mu\nu} F^{\alpha\beta} F_{\alpha\beta} \right)
$$</p>
<p><strong>4-ìê¸°ì¥ (ê³µë™ ì¢Œí‘œê³„):</strong>
$$
b^\mu = \frac{1}{c} F^{*\mu\nu} u_\nu = W(\mathbf{v} \cdot \mathbf{B}/c, \mathbf{B}/W + W(\mathbf{v} \cdot \mathbf{B})\mathbf{v}/c^2)
$$</p>
<p>$b^\mu u_\mu = 0$ (ì§êµì„±)ì„ ë§Œì¡±í•˜ë©°, $b^2 = b^\mu b_\mu = (B^2 + (v \times B)^2/c^2)/W^2$ì…ë‹ˆë‹¤.</p>
<h3 id="24">2.4 ë³´ì¡´ ë²•ì¹™<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<p><strong>ì—ë„ˆì§€-ìš´ë™ëŸ‰ ë³´ì¡´:</strong>
$$
\partial_\mu T^{\mu\nu} = 0
$$</p>
<p>ë‹¤ìŒìœ¼ë¡œ í™•ì¥ë©ë‹ˆë‹¤:
- $\nu = 0$: ì—ë„ˆì§€ ë³´ì¡´
- $\nu = i$: ìš´ë™ëŸ‰ ë³´ì¡´</p>
<p><strong>ì§ˆëŸ‰ ë³´ì¡´:</strong>
$$
\partial_\mu (\rho u^\mu) = 0
$$</p>
<hr />
<h2 id="3-srmhd">3. ì´ìƒ SRMHD<a class="header-link" href="#3-srmhd" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ì´ìƒ ì¡°ê±´<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>ì´ìƒ SRMHDì—ì„œ ì „ê¸°ì¥ì€ ê³µë™ ì¢Œí‘œê³„ì—ì„œ ì‚¬ë¼ì§‘ë‹ˆë‹¤:
$$
F^{\mu\nu} u_\nu = 0
$$</p>
<p>ì´ëŠ” ë‹¤ìŒì„ ì œê³µí•©ë‹ˆë‹¤:
$$
\mathbf{E} = -\frac{\mathbf{v} \times \mathbf{B}}{c} \frac{1}{1 - v^2/c^2}
$$</p>
<p>ìê¸°ì¥ì€ í”Œë¼ì¦ˆë§ˆì— <strong>ë™ê²°</strong>ë©ë‹ˆë‹¤ (ìƒëŒ€ë¡ ì  ë²„ì „).</p>
<h3 id="32-31">3.2 3+1 ë¶„í•´<a class="header-link" href="#32-31" title="Permanent link">&para;</a></h3>
<p>ìˆ˜ì¹˜ êµ¬í˜„ì„ ìœ„í•´ ì‹¤í—˜ì‹¤ ì¢Œí‘œê³„ (3+1) ë³€ìˆ˜ë¡œ ë¶„í•´í•©ë‹ˆë‹¤.</p>
<p><strong>ë³´ì¡´ ë³€ìˆ˜:</strong>
$$
\mathbf{U} = \begin{pmatrix} D \\ \mathbf{S} \\ \tau \\ \mathbf{B} \end{pmatrix}
$$
ì—¬ê¸°ì„œ:
- $D = \rho W$ (ë³´ì¡´ ë°€ë„)
- $\mathbf{S} = (\rho h + b^2) W^2 \mathbf{v} - (\mathbf{v} \cdot \mathbf{B})\mathbf{B}/(4\pi)$ (ìš´ë™ëŸ‰ ë°€ë„)
- $\tau = (\rho h + b^2) W^2 - p - b^2/2 - D c^2$ (ì—ë„ˆì§€ ë°€ë„)
- $\mathbf{B}$ (ìê¸°ì¥)</p>
<p><strong>í”ŒëŸ­ìŠ¤ í•¨ìˆ˜:</strong>
$$
\mathbf{F}(\mathbf{U}) = \begin{pmatrix}
D v_x \\
S_x v_x + p_{\text{tot}} - B_x^2/(4\pi) \\
S_y v_x - B_x B_y/(4\pi) \\
S_z v_x - B_x B_z/(4\pi) \\
\tau v_x + p_{\text{tot}} v_x - (\mathbf{v} \cdot \mathbf{B}) B_x/(4\pi) \\
0 \\
B_y v_x - B_x v_y \\
B_z v_x - B_x v_z
\end{pmatrix}
$$
ì—¬ê¸°ì„œ $p_{\text{tot}} = p + B^2/(8\pi)$ì…ë‹ˆë‹¤.</p>
<p><strong>ë³´ì¡´ í˜•íƒœ:</strong>
$$
\frac{\partial \mathbf{U}}{\partial t} + \nabla \cdot \mathbf{F}(\mathbf{U}) = 0
$$</p>
<h3 id="33">3.3 ì›ì‹œ ë³€ìˆ˜ ë³µì›<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<p><strong>ë¬¸ì œ:</strong> ë³´ì¡´ ë³€ìˆ˜ $(\mathbf{U})$ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ì›ì‹œ ë³€ìˆ˜ $(\rho, \mathbf{v}, p, \mathbf{B})$ë¥¼ ë³µì›í•©ë‹ˆë‹¤.</p>
<p><strong>ëŒ€ìˆ˜ì  ì œì•½:</strong>
$$
\begin{aligned}
D &= \rho W \\
\mathbf{B} &= \text{(ì•Œë ¤ì§)} \\
\mathbf{S} &= (\rho h + b^2) W^2 \mathbf{v} - (\mathbf{v} \cdot \mathbf{B})\mathbf{B}/(4\pi) \\
\tau &= (\rho h + b^2) W^2 - p - b^2/2 - D c^2
\end{aligned}
$$</p>
<p><strong>ë¬¸ì œ:</strong> $W$, $p$, $\rho$, $\mathbf{v}$ë¥¼ ê²°í•©í•˜ëŠ” ë¹„ì„ í˜• ì‹œìŠ¤í…œ.</p>
<p><strong>í‘œì¤€ ì ‘ê·¼ë²• (2D Newton-Raphson):</strong></p>
<ol>
<li>ë¯¸ì§€ìˆ˜ ì„ íƒ: $z = W$, $w = p$</li>
<li>ì—­ë³€í™˜:
   $$
   v^2 = 1 - \frac{1}{z^2}
   $$</li>
<li>$\mathbf{S}$ì™€ ìš´ë™ëŸ‰ ë°©ì •ì‹ìœ¼ë¡œë¶€í„° $\rho$, $h$ í•´ê²°</li>
<li>EOS ì‚¬ìš©: $p = p(\rho, \epsilon)$</li>
<li>ìˆ˜ë ´í•  ë•Œê¹Œì§€ ë°˜ë³µ</li>
</ol>
<p><strong>ëŒ€ì•ˆ (1D ê·¼ì°¾ê¸°):</strong></p>
<p>ì••ë ¥ $p$ë¥¼ ë…ë¦½ ë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ì—¬ í•´ê²°:
$$
f(p) = \tau + p - \frac{(\mathbf{S} \cdot \mathbf{B})^2}{(\tau + p + D c^2 + B^2/(4\pi))^2 - (\mathbf{S}^2 + (\mathbf{S} \cdot \mathbf{B})^2/(B^2))} - D c^2 = 0
$$</p>
<p><strong>ë„ì „ ê³¼ì œ:</strong>
- ì—¬ëŸ¬ ê·¼ì´ ê°€ëŠ¥
- $W \gg 1$ì— ëŒ€í•œ ìˆ˜ì¹˜ì  stiffness
- ì§„ê³µ ê·¼ì²˜ì—ì„œ ë¶•ê´´ ($\rho \to 0$)</p>
<p><strong>ëª¨ë²” ì‚¬ë¡€:</strong>
- ê²¬ê³ í•œ ê·¼ì°¾ê¸° ì‚¬ìš© (Brent ë°©ë²•)
- ì¢‹ì€ ì´ˆê¸° ì¶”ì¸¡ (ì´ì „ íƒ€ì„ìŠ¤í…ìœ¼ë¡œë¶€í„°)
- $\rho$, $p$ì— ëŒ€í•œ í”Œë¡œì–´ ê°’</p>
<hr />
<h2 id="4-srmhd">4. SRMHDì˜ íŒŒë™ êµ¬ì¡°<a class="header-link" href="#4-srmhd" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ê³ ìœ êµ¬ì¡°<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>SRMHD ì‹œìŠ¤í…œì€ <strong>7ê°œì˜ íŒŒë™</strong>ì„ ê°–ìŠµë‹ˆë‹¤ (1D):
$$
\lambda_{1,7} = \alpha_{\pm}^{\text{fast}}, \quad \lambda_{2,6} = \alpha_{\pm}^{\text{slow}}, \quad \lambda_{3,5} = \alpha_{\pm}^{\text{Alf}}, \quad \lambda_4 = v_x
$$</p>
<p><strong>ìƒëŒ€ë¡ ì  íŒŒë™ ì†ë„:</strong></p>
<p>ì •ì˜:
$$
c_s^2 = \frac{\partial p}{\partial \rho h} \quad \text{(ìƒëŒ€ë¡ ì  ìŒì†)}
$$
$$
v_A^2 = \frac{B^2/(4\pi)}{\rho h + B^2/(4\pi)} \quad \text{(ìƒëŒ€ë¡ ì  AlfvÃ©n ì†ë„)}
$$</p>
<p>Fast magnetosonic ì†ë„:
$$
\alpha_{\pm}^{\text{fast}} = \frac{v_x \pm c_{\text{fast}}}{1 \pm v_x c_{\text{fast}}/c^2}
$$
ì—¬ê¸°ì„œ:
$$
c_{\text{fast}}^2 = \frac{c_s^2 + v_A^2 - c_s^2 v_A^2}{1 - c_s^2 v_A^2}
$$</p>
<p>Slow magnetosonic ë° AlfvÃ©n ì†ë„ë„ ìˆ˜ì •ëœ ë¶„ì‚° ê´€ê³„ë¡œ ìœ ì‚¬í•˜ê²Œ ì •ì˜ë©ë‹ˆë‹¤.</p>
<p><strong>ë¹„ìƒëŒ€ë¡ ì ê³¼ì˜ ì£¼ìš” ì°¨ì´ì :</strong>
- ëª¨ë“  íŒŒë™ ì†ë„ &lt; $c$ (ì¸ê³¼ì„±)
- Lorentz ì¸ì $W$ê°€ ë¶„ì‚° ê´€ê³„ì— í¬í•¨
- $v \to c$ì¼ ë•Œ, íŒŒë™ì´ ìœ ë™ì„ ë”°ë¼ì¡ì„ ìˆ˜ ì—†ìŒ (bunching)</p>
<h3 id="42-riemann">4.2 ìƒëŒ€ë¡ ì  Riemann ë¬¸ì œ<a class="header-link" href="#42-riemann" title="Permanent link">&para;</a></h3>
<p><strong>SRMHDìš© HLLC ì†”ë²„:</strong></p>
<p>íŒŒë™ ì†ë„ ì¶”ì •:
$$
\lambda_L = \min(\lambda_L^{\text{fast}}, \lambda_R^{\text{fast}}), \quad \lambda_R = \max(\lambda_L^{\text{fast}}, \lambda_R^{\text{fast}})
$$</p>
<p>ì ‘ì´‰íŒŒ ì†ë„ $\lambda_*$ëŠ” ìš´ë™ëŸ‰ ì í”„ ì¡°ê±´ìœ¼ë¡œë¶€í„°.</p>
<p><strong>HLLD ì†”ë²„:</strong></p>
<p>5ê°œì˜ ëª¨ë“  íŒŒë™ í¬í•¨ (fast, AlfvÃ©n, contact). ë” ì •í™•í•˜ì§€ë§Œ ë³µì¡í•¨.</p>
<p><strong>ìƒëŒ€ë¡ ì  Brio-Wu ì¶©ê²©íŒŒ íŠœë¸Œ:</strong></p>
<p>ì´ˆê¸° ì¡°ê±´:
$$
(\rho, v_x, v_y, v_z, p, B_y) = \begin{cases}
(1, 0, 0, 0, 1, 1) & x < 0.5 \\
(0.125, 0, 0, 0, 0.1, -1) & x > 0.5
\end{cases}
$$
$B_x = 0.5$ ìƒìˆ˜.</p>
<p>ì˜ˆìƒ êµ¬ì¡°: left fast â†’ compound â†’ contact â†’ slow â†’ right fast.</p>
<hr />
<h2 id="5-srmhd">5. SRMHDì˜ ì‘ìš©<a class="header-link" href="#5-srmhd" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ìƒëŒ€ë¡ ì  ì œíŠ¸<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p><strong>ì²œì²´ë¬¼ë¦¬í•™ì  ë§¥ë½:</strong>
- Active Galactic Nuclei (AGN): ì´ˆëŒ€ì§ˆëŸ‰ ë¸”ë™í™€ì˜ ì œíŠ¸ (Lorentz ì¸ì $\Gamma \sim 10-30$)
- Gamma-Ray Bursts (GRB): í•­ì„± ì§ˆëŸ‰ ë¸”ë™í™€ì˜ ì œíŠ¸ ($\Gamma \sim 100-1000$)
- Microquasar: Xì„  ìŒì„±ê³„ì˜ ì œíŠ¸ ($\Gamma \sim 2-10$)</p>
<p><strong>ë¬¼ë¦¬í•™:</strong>
- <strong>ê°€ì†:</strong> ìê¸° ì••ë ¥ì´ ìš´ë™ ì—ë„ˆì§€ë¡œ ë³€í™˜ ($\sigma \to 0$)
- <strong>ì¤€ì§:</strong> ìê¸° hoop stressê°€ ì œíŠ¸ ì œí•œ
- <strong>ë¶ˆì•ˆì •ì„±:</strong> Kelvin-Helmholtz (ì œíŠ¸-ì£¼ë³€ ê²½ê³„ë©´), ì „ë¥˜ êµ¬ë™ kink</p>
<p><strong>Light cylinder:</strong></p>
<p>ê°ì†ë„ $\Omega$ë¡œ íšŒì „í•˜ëŠ” ìê¸°ê¶Œì˜ ê²½ìš°:
$$
R_L = \frac{c}{\Omega}
$$</p>
<p>$R_L$ ë‚´ë¶€: corotation ê°€ëŠ¥. ì™¸ë¶€: ìê¸°ì¥ì´ ì—´ë¦¬ê³ , ë°”ëŒ ë°œì‚¬.</p>
<p><strong>ìˆ˜ì¹˜ì  ë„ì „ ê³¼ì œ:</strong>
- í° Lorentz ì¸ì: $W \sim 100$ â†’ stiff ì›ì‹œë³€ìˆ˜ ë³µì›
- ìí™” ë§¤ê°œë³€ìˆ˜ $\sigma = B^2/(4\pi \rho h W^2)$ê°€ ìˆ˜ì‹­ ë…„ì— ê±¸ì³ ë³€í™”
- $\sigma \gg 1$ì¼ ë•Œ ê·¸ë¦¬ë“œ ìŠ¤ì¼€ì¼ ë¶ˆì•ˆì •ì„±</p>
<h3 id="52">5.2 í„ì„œ ìê¸°ê¶Œ<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<p><strong>ê²½ì‚¬ íšŒì „ì:</strong>
- íšŒì „ ìê¸° ìŒê·¹ì: $\mathbf{m}$ì´ $\boldsymbol{\Omega}$ì— ê°ë„ $\alpha$ë¡œ ê¸°ìš¸ì–´ì§
- ì—´ë¦° ì¥ ì„ : $\theta < \theta_{\text{pc}}$ (ê·¹ê´€ ê°ë„)
- ë‹«íŒ ì¥ ì„ : corotating í”Œë¼ì¦ˆë§ˆ</p>
<p><strong>Force-free electrodynamics (FFE):</strong></p>
<p>$\sigma \gg 1$ì¼ ë•Œ, í”Œë¼ì¦ˆë§ˆ ê´€ì„± ë¬´ì‹œ ê°€ëŠ¥:
$$
\rho_e \mathbf{E} + \frac{\mathbf{J} \times \mathbf{B}}{c} = 0, \quad \mathbf{E} \cdot \mathbf{B} = 0
$$</p>
<p>ê²½ê³„ ì¡°ê±´ì´ ì£¼ì–´ì§„ $\mathbf{E}$, $\mathbf{B}$ í•´ê²° (ì¤‘ì„±ìë³„ í‘œë©´, ë¬´í•œëŒ€).</p>
<p><strong>í„ì„œ ë°”ëŒ:</strong>
- ì—´ë¦° ì¥ ì„ ì„ ë”°ë¼ ì…ì ê°€ì†
- light cylinderì—ì„œ ìí™” $\sigma \sim 10^4$
- ì¢…ê²° ì¶©ê²©íŒŒì—ì„œ ì†Œì‚° (í„ì„œ ë°”ëŒ ì„±ìš´)</p>
<p><strong>SRMHD vs FFE:</strong>
- FFE: $\sigma \gg 1$ì— ëŒ€í•´ ìœ íš¨, ì†Œì‚° ì—†ìŒ
- SRMHD: ê´€ì„±, ì¬ê²°í•©, ì…ì ê°€ì—´ í¬í•¨</p>
<h3 id="53">5.3 ë¸”ë™í™€ ê°•ì°©<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<p><strong>Innermost Stable Circular Orbit (ISCO):</strong>
- Schwarzschild: $r_{\text{ISCO}} = 6 GM/c^2$
- Kerr (ê·¹ë‹¨ì ): $r_{\text{ISCO}} = GM/c^2$ (ìˆœí–‰)</p>
<p>ISCOì—ì„œì˜ ê¶¤ë„ ì†ë„:
$$
v_{\text{ISCO}} \sim 0.5c \quad \text{(Schwarzschild)} \quad \text{to} \quad 0.7c \quad \text{(Kerr, ìˆœí–‰)}
$$</p>
<p><strong>ì œíŠ¸ ë°œì‚¬:</strong></p>
<p>Blandford-Znajek ë©”ì»¤ë‹ˆì¦˜ (íšŒì „ ë¸”ë™í™€):
- ìê¸°ì¥ì´ ì§€í‰ì„ ì„ ê´€í†µ
- Frame dragging: $\Omega_H$ (ì§€í‰ì„  ê°ì†ë„)
- Poynting í”ŒëŸ­ìŠ¤ ì¶”ì¶œ: $L_{\text{BZ}} \sim \Omega_H^2 B_H^2 r_H^4 / c$</p>
<p><strong>ì¼ë°˜ ìƒëŒ€ë¡ ì  MHD</strong> (GRMHD) í•„ìš”.</p>
<p><strong>Magnetically Arrested Disk (MAD):</strong></p>
<p>ìê¸° í”ŒëŸ­ìŠ¤ê°€ ì¶•ì ë  ë•Œ:
$$
\phi \sim \sqrt{\dot{M} r_g c} \quad \Rightarrow \quad \text{ìê¸°ì ìœ¼ë¡œ ì§€ë°°ë¨}
$$</p>
<p>ê²°ê³¼:
- ì–µì œëœ ê°•ì°© (í”ŒëŸ­ìŠ¤ ì¥ë²½)
- í–¥ìƒëœ ì œíŠ¸ íŒŒì›Œ
- ì‹œê°„ ë³€ë™ ìœ ë™</p>
<hr />
<h2 id="6-mhd-grmhd">6. ì¼ë°˜ ìƒëŒ€ë¡ ì  MHD (GRMHD)<a class="header-link" href="#6-mhd-grmhd" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ê³¡ì„  ì‹œê³µê°„ ì •ì‹í™”<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p><strong>Kerr ê³„ëŸ‰ (Boyer-Lindquist ì¢Œí‘œ):</strong>
$$
ds^2 = -\alpha^2 dt^2 + \gamma_{ij} (dx^i + \beta^i dt)(dx^j + \beta^j dt)
$$
ì—¬ê¸°ì„œ:
- $\alpha$ = lapse í•¨ìˆ˜
- $\beta^i$ = shift ë²¡í„°
- $\gamma_{ij}$ = ê³µê°„ ê³„ëŸ‰</p>
<p><strong>ì‘ë ¥-ì—ë„ˆì§€ í…ì„œ:</strong>
$$
\nabla_\mu T^{\mu\nu} = 0
$$
ì—¬ê¸°ì„œ $\nabla_\mu$ëŠ” ê³µë³€ ë¯¸ë¶„ (Christoffel ê¸°í˜¸ í¬í•¨).</p>
<p><strong>3+1 ADM í˜•íƒœ:</strong></p>
<p>$$
\frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{F}^i}{\partial x^i} = \mathbf{S}
$$</p>
<p>ì—¬ê¸°ì„œ $\mathbf{S}$ëŠ” ê³„ëŸ‰ ì†ŒìŠ¤ í•­ (ì‹œê³µê°„ ê³¡ë¥ ) í¬í•¨.</p>
<h3 id="62-harm">6.2 HARM ì½”ë“œ ì •ì‹í™”<a class="header-link" href="#62-harm" title="Permanent link">&para;</a></h3>
<p><strong>HARM</strong> (High Accuracy Relativistic Magnetohydrodynamics) ì½”ë“œëŠ” ì‚¬ìš©í•©ë‹ˆë‹¤:</p>
<ul>
<li>ë³´ì¡´ ë³€ìˆ˜: $\sqrt{-g} (\rho u^t, T^t_{\ i}, \sqrt{-g} B^i)$</li>
<li>Flux-conservative ë°©ì‹</li>
<li>ë°œì‚° ì—†ëŠ” $\mathbf{B}$ë¥¼ ìœ„í•œ Flux-CT</li>
<li>ê³¡ì„  ì‹œê³µê°„ì—ì„œ ì›ì‹œë³€ìˆ˜ ë³µì›</li>
</ul>
<p><strong>ê³„ëŸ‰:</strong>
ìˆ˜ì •ëœ Kerr-Schild ì¢Œí‘œ (ì§€í‰ì„  ê´€í†µ).</p>
<p><strong>ì‘ìš©:</strong>
- ë¸”ë™í™€ ê°•ì°© ë””ìŠ¤í¬ (Sgr A*, M87)
- ì¤‘ì„±ìë³„ ë³‘í•©
- ì œíŠ¸ ë°œì‚¬ ì‹œë®¬ë ˆì´ì…˜</p>
<h3 id="63">6.3 ì§€í‰ì„  ê²½ê³„ ì¡°ê±´<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<p><strong>Excision:</strong>
- ì§€í‰ì„  ë‚´ë¶€ ì  ì œê±° (ì¸ê³¼ì ìœ¼ë¡œ ë‹¨ì ˆë¨)
- ìœ ì¶œ ê²½ê³„ ì¡°ê±´</p>
<p><strong>ìœ ì… í‰í˜•:</strong>
- ë¬¼ì§ˆì´ ìœ ì… ì†ë„ë¡œ ì•ˆìª½ìœ¼ë¡œ ë–¨ì–´ì§€ë„ë¡ ê°•ì œ
- ì •ìƒ ë””ìŠ¤í¬ í”„ë¡œíŒŒì¼ ìœ ì§€</p>
<hr />
<h2 id="7-srmhd">7. SRMHDì˜ ìˆ˜ì¹˜ ë°©ë²•<a class="header-link" href="#7-srmhd" title="Permanent link">&para;</a></h2>
<h3 id="71-godunov">7.1 Godunoví˜• ë°©ì‹<a class="header-link" href="#71-godunov" title="Permanent link">&para;</a></h3>
<p><strong>HLLC í”ŒëŸ­ìŠ¤:</strong></p>
<p>$$
\mathbf{F}_{\text{HLLC}} = \begin{cases}
\mathbf{F}_L & \lambda_L \geq 0 \\
\mathbf{F}_L^* & \lambda_L < 0 \leq \lambda_* \\
\mathbf{F}_R^* & \lambda_* < 0 \leq \lambda_R \\
\mathbf{F}_R & \lambda_R < 0
\end{cases}
$$</p>
<p>Star ìƒíƒœ $\mathbf{U}_L^*$, $\mathbf{U}_R^*$ëŠ” Rankine-Hugoniot ì í”„ ì¡°ê±´ìœ¼ë¡œë¶€í„°.</p>
<p><strong>ì‹œê°„ ë‹¨ê³„:</strong></p>
<ul>
<li>RK2 ë˜ëŠ” RK3 (TVD)</li>
<li>CFL ì¡°ê±´:
$$
\Delta t \leq C \min_i \frac{\Delta x_i}{c_{\text{fast}, i} + |v_i|}
$$
ì—¬ê¸°ì„œ $C \sim 0.4-0.5$ (ë¹„ìƒëŒ€ë¡ ì ë³´ë‹¤ ë” ì œí•œì ).</li>
</ul>
<h3 id="72">7.2 ì ì‘í˜• íƒ€ì„ìŠ¤í…<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<p>ë†’ì€ Lorentz ì¸ì ($W \gg 1$)ì— ëŒ€í•´ ë¡œì»¬ íƒ€ì„ìŠ¤í…ì´ ì•„ì£¼ ì‘ì„ ìˆ˜ ìˆìŒ. ì‚¬ìš©:</p>
<ul>
<li>ê³„ì¸µì  íƒ€ì„ìŠ¤í…í•‘ (AMR ì½”ë“œ)</li>
<li>Implicit-explicit (IMEX) ë°©ì‹ (stiff í•­ ì•”ë¬µì )</li>
</ul>
<h3 id="73">7.3 í”Œë¡œì–´ì™€ ìƒí•œ<a class="header-link" href="#73" title="Permanent link">&para;</a></h3>
<p><strong>ë°€ë„ í”Œë¡œì–´:</strong>
$$
\rho \geq \rho_{\min} = 10^{-6} \rho_{\text{max}}
$$</p>
<p><strong>ì˜¨ë„ ìƒí•œ:</strong>
$$
T \leq T_{\max} = 10^{13} \, \text{K} \quad \text{(ìŒìƒì„± ë°©ì§€)}
$$</p>
<p><strong>ìí™” ìƒí•œ:</strong>
$$
\sigma \leq \sigma_{\max} \sim 100 \quad \text{(ìˆ˜ì¹˜ì  ë¶ˆì•ˆì •ì„± ë°©ì§€)}
$$</p>
<hr />
<h2 id="8-python-1d-srmhd">8. Python êµ¬í˜„: 1D SRMHD ì¶©ê²©íŒŒ íŠœë¸Œ<a class="header-link" href="#8-python-1d-srmhd" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ë¬¸ì œ ì„¤ì •<a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>ìƒëŒ€ë¡ ì  Brio-Wu í…ŒìŠ¤íŠ¸:
$$
(\rho, v_x, p, B_y) = \begin{cases}
(1.0, 0.0, 1.0, 1.0) & x < 0.5 \\
(0.125, 0.0, 0.1, -1.0) & x \geq 0.5
\end{cases}
$$
$B_x = 0.5$ (ìƒìˆ˜), $\Gamma = 5/3$ (ì´ìƒ ê¸°ì²´).</p>
<p>ì˜ì—­: $x \in [0, 1]$, $t \in [0, 0.4]$.</p>
<h3 id="82">8.2 ì½”ë“œ êµ¬ì¡°<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Constants</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Speed of light</span>
<span class="n">GAMMA</span> <span class="o">=</span> <span class="mf">5.0</span><span class="o">/</span><span class="mf">3.0</span>  <span class="c1"># Adiabatic index</span>

<span class="c1"># Grid</span>
<span class="n">NX</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">XL</span><span class="p">,</span> <span class="n">XR</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">XR</span> <span class="o">-</span> <span class="n">XL</span><span class="p">)</span> <span class="o">/</span> <span class="n">NX</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">XL</span> <span class="o">+</span> <span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">XR</span> <span class="o">-</span> <span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NX</span><span class="p">)</span>

<span class="c1"># Primitive variables: [rho, vx, vy, vz, p, Bx, By, Bz]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">initial_conditions</span><span class="p">():</span>
    <span class="n">prim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NX</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">Bx_const</span> <span class="o">=</span> <span class="mf">0.5</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">prim</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">Bx_const</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prim</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">Bx_const</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">prim</span>

<span class="c1"># Lorentz factor</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lorentz_factor</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">):</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vz</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">v2</span> <span class="o">/</span> <span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Primitive to conserved</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prim2cons</span><span class="p">(</span><span class="n">prim</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">prim</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">=</span> <span class="n">prim</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>

    <span class="n">W</span> <span class="o">=</span> <span class="n">lorentz_factor</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vz</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">B2</span> <span class="o">=</span> <span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Bz</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">vdotB</span> <span class="o">=</span> <span class="n">vx</span><span class="o">*</span><span class="n">Bx</span> <span class="o">+</span> <span class="n">vy</span><span class="o">*</span><span class="n">By</span> <span class="o">+</span> <span class="n">vz</span><span class="o">*</span><span class="n">Bz</span>

    <span class="c1"># Specific enthalpy</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="o">/</span><span class="n">rho</span>

    <span class="c1"># Comoving magnetic field</span>
    <span class="n">b0</span> <span class="o">=</span> <span class="n">W</span> <span class="o">*</span> <span class="n">vdotB</span> <span class="o">/</span> <span class="n">C</span>
    <span class="n">bx</span> <span class="o">=</span> <span class="n">Bx</span><span class="o">/</span><span class="n">W</span> <span class="o">+</span> <span class="n">W</span><span class="o">*</span><span class="n">vx</span><span class="o">*</span><span class="n">vdotB</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">by</span> <span class="o">=</span> <span class="n">By</span><span class="o">/</span><span class="n">W</span> <span class="o">+</span> <span class="n">W</span><span class="o">*</span><span class="n">vy</span><span class="o">*</span><span class="n">vdotB</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">bz</span> <span class="o">=</span> <span class="n">Bz</span><span class="o">/</span><span class="n">W</span> <span class="o">+</span> <span class="n">W</span><span class="o">*</span><span class="n">vz</span><span class="o">*</span><span class="n">vdotB</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="p">(</span><span class="n">B2</span> <span class="o">+</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">W</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Conserved variables</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">W</span>
    <span class="n">Sx</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vx</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">Bx</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">Sy</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vy</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">By</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">Sz</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vz</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">Bz</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="n">b2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">D</span><span class="o">*</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D</span><span class="p">,</span> <span class="n">Sx</span><span class="p">,</span> <span class="n">Sy</span><span class="p">,</span> <span class="n">Sz</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">Bz</span><span class="p">])</span>

<span class="c1"># Conserved to primitive (simplified 1D Newton-Raphson)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">cons2prim</span><span class="p">(</span><span class="n">cons</span><span class="p">,</span> <span class="n">prim_guess</span><span class="p">):</span>
    <span class="n">D</span><span class="p">,</span> <span class="n">Sx</span><span class="p">,</span> <span class="n">Sy</span><span class="p">,</span> <span class="n">Sz</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">cons</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">=</span> <span class="n">cons</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>

    <span class="c1"># Initial guess</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">prim_guess</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="c1"># Newton-Raphson iteration (simplified)</span>
    <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-10</span>

    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">lorentz_factor</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="o">/</span><span class="n">rho</span>

        <span class="n">vdotB</span> <span class="o">=</span> <span class="n">vx</span><span class="o">*</span><span class="n">Bx</span> <span class="o">+</span> <span class="n">vy</span><span class="o">*</span><span class="n">By</span> <span class="o">+</span> <span class="n">vz</span><span class="o">*</span><span class="n">Bz</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Bz</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">W</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Residuals</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">D</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">W</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">Sx</span> <span class="o">-</span> <span class="p">((</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vx</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">Bx</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
        <span class="n">f3</span> <span class="o">=</span> <span class="n">tau</span> <span class="o">-</span> <span class="p">((</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="n">b2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">D</span><span class="o">*</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c1"># Simple update (damped)</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">D</span> <span class="o">/</span> <span class="n">W</span>
        <span class="n">p_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">tau</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="n">b2</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">-</span> <span class="n">b2</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">p_new</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>

        <span class="c1"># Update velocity (simplified)</span>
        <span class="n">S2</span> <span class="o">=</span> <span class="n">Sx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Sy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Sz</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">S</span> <span class="o">&gt;</span> <span class="mf">1e-12</span><span class="p">:</span>
            <span class="n">vx</span> <span class="o">=</span> <span class="n">Sx</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">vy</span> <span class="o">=</span> <span class="n">Sy</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">vz</span> <span class="o">=</span> <span class="n">Sz</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Limit velocity</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vz</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">C</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.99</span> <span class="o">*</span> <span class="n">C</span> <span class="o">/</span> <span class="n">v</span>
            <span class="n">vx</span> <span class="o">*=</span> <span class="n">scale</span>
            <span class="n">vy</span> <span class="o">*=</span> <span class="n">scale</span>
            <span class="n">vz</span> <span class="o">*=</span> <span class="n">scale</span>

    <span class="c1"># Apply floors</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rho</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">Bz</span><span class="p">])</span>

<span class="c1"># Flux function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">flux</span><span class="p">(</span><span class="n">prim</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">prim</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">=</span> <span class="n">prim</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>

    <span class="n">W</span> <span class="o">=</span> <span class="n">lorentz_factor</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span>
    <span class="n">vdotB</span> <span class="o">=</span> <span class="n">vx</span><span class="o">*</span><span class="n">Bx</span> <span class="o">+</span> <span class="n">vy</span><span class="o">*</span><span class="n">By</span> <span class="o">+</span> <span class="n">vz</span><span class="o">*</span><span class="n">Bz</span>
    <span class="n">B2</span> <span class="o">=</span> <span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Bz</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="p">(</span><span class="n">B2</span> <span class="o">+</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">W</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="o">/</span><span class="n">rho</span>

    <span class="n">ptot</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">B2</span><span class="o">/</span><span class="p">(</span><span class="mf">8.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">W</span> <span class="o">*</span> <span class="n">vx</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vx</span><span class="o">*</span><span class="n">vx</span> <span class="o">+</span> <span class="n">ptot</span> <span class="o">-</span> <span class="n">Bx</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">Bx</span><span class="o">*</span><span class="n">vx</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vx</span><span class="o">*</span><span class="n">vy</span> <span class="o">-</span> <span class="n">Bx</span><span class="o">*</span><span class="n">By</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">Bx</span><span class="o">*</span><span class="n">vy</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vx</span><span class="o">*</span><span class="n">vz</span> <span class="o">-</span> <span class="n">Bx</span><span class="o">*</span><span class="n">Bz</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">Bx</span><span class="o">*</span><span class="n">vz</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">*</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="n">b2</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">vx</span> <span class="o">+</span> <span class="n">ptot</span><span class="o">*</span><span class="n">vx</span> <span class="o">-</span> <span class="p">(</span><span class="n">vdotB</span><span class="p">)</span><span class="o">*</span><span class="n">Bx</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Bx constant</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">By</span><span class="o">*</span><span class="n">vx</span> <span class="o">-</span> <span class="n">Bx</span><span class="o">*</span><span class="n">vy</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bz</span><span class="o">*</span><span class="n">vx</span> <span class="o">-</span> <span class="n">Bx</span><span class="o">*</span><span class="n">vz</span>

    <span class="k">return</span> <span class="n">F</span>

<span class="c1"># HLLC Riemann solver (simplified HLL for SRMHD)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hll_flux</span><span class="p">(</span><span class="n">pL</span><span class="p">,</span> <span class="n">pR</span><span class="p">):</span>
    <span class="c1"># Estimate wave speeds (very simplified)</span>
    <span class="n">rhoL</span><span class="p">,</span> <span class="n">vxL</span><span class="p">,</span> <span class="n">pL_val</span> <span class="o">=</span> <span class="n">pL</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pL</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">rhoR</span><span class="p">,</span> <span class="n">vxR</span><span class="p">,</span> <span class="n">pR_val</span> <span class="o">=</span> <span class="n">pR</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pR</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pR</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="c1"># Sound speed</span>
    <span class="n">csL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">GAMMA</span> <span class="o">*</span> <span class="n">pL_val</span> <span class="o">/</span> <span class="p">(</span><span class="n">rhoL</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">pL_val</span><span class="o">/</span><span class="n">rhoL</span><span class="p">)))</span>
    <span class="n">csR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">GAMMA</span> <span class="o">*</span> <span class="n">pR_val</span> <span class="o">/</span> <span class="p">(</span><span class="n">rhoR</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">pR_val</span><span class="o">/</span><span class="n">rhoR</span><span class="p">)))</span>

    <span class="n">WL</span> <span class="o">=</span> <span class="n">lorentz_factor</span><span class="p">(</span><span class="n">pL</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pL</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pL</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">WR</span> <span class="o">=</span> <span class="n">lorentz_factor</span><span class="p">(</span><span class="n">pR</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pR</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pR</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># Fast magnetosonic speed estimate (crude)</span>
    <span class="n">BxL</span><span class="p">,</span> <span class="n">ByL</span><span class="p">,</span> <span class="n">BzL</span> <span class="o">=</span> <span class="n">pL</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
    <span class="n">BxR</span><span class="p">,</span> <span class="n">ByR</span><span class="p">,</span> <span class="n">BzR</span> <span class="o">=</span> <span class="n">pR</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
    <span class="n">B2L</span> <span class="o">=</span> <span class="n">BxL</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ByL</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">BzL</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">B2R</span> <span class="o">=</span> <span class="n">BxR</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ByR</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">BzR</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">hL</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">pL_val</span><span class="o">/</span><span class="n">rhoL</span>
    <span class="n">hR</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">pR_val</span><span class="o">/</span><span class="n">rhoR</span>

    <span class="n">vAL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">B2L</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">rhoL</span><span class="o">*</span><span class="n">hL</span> <span class="o">+</span> <span class="n">B2L</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))))</span>
    <span class="n">vAR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">B2R</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">rhoR</span><span class="o">*</span><span class="n">hR</span> <span class="o">+</span> <span class="n">B2R</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))))</span>

    <span class="n">cfL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">csL</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vAL</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">csL</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vAL</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">csL</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vAL</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">cfR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">csR</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vAR</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">csR</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vAR</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">csR</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vAR</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># Wave speeds (relativistic addition)</span>
    <span class="n">lamL</span> <span class="o">=</span> <span class="p">(</span><span class="n">vxL</span> <span class="o">-</span> <span class="n">cfL</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">vxL</span><span class="o">*</span><span class="n">cfL</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">lamR</span> <span class="o">=</span> <span class="p">(</span><span class="n">vxR</span> <span class="o">+</span> <span class="n">cfR</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">vxR</span><span class="o">*</span><span class="n">cfR</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># HLL flux</span>
    <span class="n">consL</span> <span class="o">=</span> <span class="n">prim2cons</span><span class="p">(</span><span class="n">pL</span><span class="p">)</span>
    <span class="n">consR</span> <span class="o">=</span> <span class="n">prim2cons</span><span class="p">(</span><span class="n">pR</span><span class="p">)</span>
    <span class="n">FL</span> <span class="o">=</span> <span class="n">flux</span><span class="p">(</span><span class="n">pL</span><span class="p">)</span>
    <span class="n">FR</span> <span class="o">=</span> <span class="n">flux</span><span class="p">(</span><span class="n">pR</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lamL</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FL</span>
    <span class="k">elif</span> <span class="n">lamR</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FR</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F_hll</span> <span class="o">=</span> <span class="p">(</span><span class="n">lamR</span><span class="o">*</span><span class="n">FL</span> <span class="o">-</span> <span class="n">lamL</span><span class="o">*</span><span class="n">FR</span> <span class="o">+</span> <span class="n">lamL</span><span class="o">*</span><span class="n">lamR</span><span class="o">*</span><span class="p">(</span><span class="n">consR</span> <span class="o">-</span> <span class="n">consL</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">lamR</span> <span class="o">-</span> <span class="n">lamL</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">F_hll</span>

<span class="c1"># Main evolution</span>
<span class="k">def</span><span class="w"> </span><span class="nf">evolve_srmhd</span><span class="p">():</span>
    <span class="n">prim</span> <span class="o">=</span> <span class="n">initial_conditions</span><span class="p">()</span>
    <span class="n">cons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">prim2cons</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prim</span><span class="p">])</span>

    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">t_end</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">CFL</span> <span class="o">=</span> <span class="mf">0.4</span>

    <span class="n">snapshots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_end</span><span class="p">:</span>
        <span class="c1"># Compute dt</span>
        <span class="n">v_max</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="p">):</span>
            <span class="n">rho</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">prim</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">=</span> <span class="n">prim</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">:]</span>

            <span class="n">cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">GAMMA</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="n">rho</span><span class="p">)))</span>
            <span class="n">B2</span> <span class="o">=</span> <span class="n">Bx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">By</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Bz</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="n">rho</span>
            <span class="n">vA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">B2</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">B2</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))))</span>
            <span class="n">cf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">cs</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vA</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">cs</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vA</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

            <span class="n">W</span> <span class="o">=</span> <span class="n">lorentz_factor</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">)</span>
            <span class="n">v_signal</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">vx</span> <span class="o">+</span> <span class="n">cf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">vx</span><span class="o">*</span><span class="n">cf</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
                          <span class="nb">abs</span><span class="p">((</span><span class="n">vx</span> <span class="o">-</span> <span class="n">cf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">vx</span><span class="o">*</span><span class="n">cf</span><span class="o">/</span><span class="n">C</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">v_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v_max</span><span class="p">,</span> <span class="n">v_signal</span><span class="p">)</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="n">CFL</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">v_max</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">&gt;</span> <span class="n">t_end</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">t_end</span> <span class="o">-</span> <span class="n">t</span>

        <span class="c1"># RK2 time integration</span>
        <span class="c1"># Stage 1</span>
        <span class="n">flux_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flux</span><span class="p">(</span><span class="n">prim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">NX</span><span class="p">:</span>
                <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flux</span><span class="p">(</span><span class="n">prim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hll_flux</span><span class="p">(</span><span class="n">prim</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">prim</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">cons_1</span> <span class="o">=</span> <span class="n">cons</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="p">):</span>
            <span class="n">cons_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">dt</span><span class="o">/</span><span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># Recover primitives</span>
        <span class="n">prim_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cons2prim</span><span class="p">(</span><span class="n">cons_1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">prim</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="p">)])</span>

        <span class="c1"># Stage 2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flux</span><span class="p">(</span><span class="n">prim_1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">NX</span><span class="p">:</span>
                <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flux</span><span class="p">(</span><span class="n">prim_1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hll_flux</span><span class="p">(</span><span class="n">prim_1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">prim_1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">cons_2</span> <span class="o">=</span> <span class="n">cons_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="p">):</span>
            <span class="n">cons_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">dt</span><span class="o">/</span><span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">flux_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">cons</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">cons</span> <span class="o">+</span> <span class="n">cons_2</span><span class="p">)</span>
        <span class="n">prim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cons2prim</span><span class="p">(</span><span class="n">cons</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">prim_1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NX</span><span class="p">)])</span>

        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">snapshots</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">snapshots</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_end</span> <span class="o">/</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">prim</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span>

    <span class="k">return</span> <span class="n">prim</span><span class="p">,</span> <span class="n">snapshots</span>

<span class="c1"># Run simulation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running SRMHD shock tube...&quot;</span><span class="p">)</span>
<span class="n">prim_final</span><span class="p">,</span> <span class="n">snapshots</span> <span class="o">=</span> <span class="n">evolve_srmhd</span><span class="p">()</span>

<span class="c1"># Plot results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">vars_to_plot</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Velocity vx&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;By&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Lorentz Factor&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Energy Density&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">var_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vars_to_plot</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">var_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prim_final</span><span class="p">[:,</span> <span class="n">var_idx</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=0.4&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Lorentz&#39;</span> <span class="ow">in</span> <span class="n">var_name</span><span class="p">:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lorentz_factor</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prim_final</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;Energy&#39;</span> <span class="ow">in</span> <span class="n">var_name</span><span class="p">:</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="n">prim_final</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">GAMMA</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s1"> at t=0.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;srmhd_shock_tube.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot saved: srmhd_shock_tube.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Plot wave structure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">prim_snap</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snapshots</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prim_snap</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SRMHD Shock Tube: Density Evolution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;srmhd_evolution.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot saved: srmhd_evolution.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="83">8.3 ì˜ˆìƒ ì¶œë ¥<a class="header-link" href="#83" title="Permanent link">&para;</a></h3>
<p>ì½”ë“œëŠ” ë‹¤ìŒì„ ìƒì„±í•©ë‹ˆë‹¤:
- ì¶©ê²©íŒŒì—ì„œì˜ ë°€ë„ ì í”„
- í¬ë°•í™” íŒ¬
- ì ‘ì´‰ ë¶ˆì—°ì†
- ìê¸°ì¥ ë°˜ì „
- ì œíŠ¸í˜• íŠ¹ì§•ì—ì„œ Lorentz ì¸ì í”¼í¬</p>
<p><strong>ë„ì „ ê³¼ì œ:</strong>
- ì´ˆê¸° ì¶”ì¸¡ì´ ì¢‹ì§€ ì•Šìœ¼ë©´ ì›ì‹œë³€ìˆ˜ ë³µì› ì‹¤íŒ¨ ê°€ëŠ¥
- Newton ë°˜ë³µì—ì„œ ê°ì‡  í•„ìš”
- í”Œë¡œì–´ê°€ ë¹„ë¬¼ë¦¬ì  ìƒíƒœ ë°©ì§€</p>
<hr />
<h2 id="9-alfven">9. ìƒëŒ€ë¡ ì  AlfvÃ©n ì†ë„<a class="header-link" href="#9-alfven" title="Permanent link">&para;</a></h2>
<h3 id="91-vs">9.1 ë¹„êµ: ë¹„ìƒëŒ€ë¡ ì  vs ìƒëŒ€ë¡ ì <a class="header-link" href="#91-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Parameters</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">B_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">GAMMA</span> <span class="o">=</span> <span class="mf">5.0</span><span class="o">/</span><span class="mf">3.0</span>

<span class="c1"># Non-relativistic Alfven speed</span>
<span class="n">vA_nr</span> <span class="o">=</span> <span class="n">B_range</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rho</span><span class="p">)</span>

<span class="c1"># Relativistic Alfven speed</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">GAMMA</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="o">/</span><span class="n">rho</span>
<span class="n">vA_r</span> <span class="o">=</span> <span class="n">B_range</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">B_range</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">B_range</span><span class="p">,</span> <span class="n">vA_nr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Non-relativistic&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">B_range</span><span class="p">,</span> <span class="n">vA_r</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Relativistic&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Speed of light c=1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Magnetic Field B&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AlfvÃ©n Speed $v_A$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AlfvÃ©n Speed: Non-Relativistic vs Relativistic&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;alfven_speed_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot saved: alfven_speed_comparison.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p><strong>í•µì‹¬ ê´€ì°°:</strong>
- ë¹„ìƒëŒ€ë¡ ì  $v_A$ëŠ” í° $B$ì— ëŒ€í•´ $c$ë¥¼ ì´ˆê³¼ ê°€ëŠ¥ (ë¹„ë¬¼ë¦¬ì )
- ìƒëŒ€ë¡ ì  $v_A < c$ í•­ìƒ ($B \to \infty$ì¼ ë•Œ í¬í™”)</p>
<hr />
<h2 id="10-light-cylinder">10. Light Cylinder ì‹œê°í™”<a class="header-link" href="#10-light-cylinder" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Pulsar parameters</span>
<span class="n">R_NS</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Neutron star radius</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Angular velocity</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">R_L</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">Omega</span>  <span class="c1"># Light cylinder radius</span>

<span class="c1"># Grid</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">R_NS</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">R_L</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

<span class="c1"># Corotation velocity</span>
<span class="n">v_corot</span> <span class="o">=</span> <span class="n">Omega</span> <span class="o">*</span> <span class="n">R</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;polar&#39;</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Velocity field (normalized)</span>
<span class="n">v_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">v_corot</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">cf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">v_norm</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">)</span>

<span class="c1"># Light cylinder</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">R_L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Light Cylinder&#39;</span><span class="p">)</span>

<span class="c1"># Neutron star</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R_NS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neutron Star&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">R_L</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pulsar Magnetosphere: Corotation Velocity</span><span class="se">\n</span><span class="s1">(Dashed = Light Cylinder)&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v_</span><span class="si">{corot}</span><span class="s1">/c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;light_cylinder.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot saved: light_cylinder.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p>$R_L$ ë‚´ë¶€: corotation ê°€ëŠ¥ ($v < c$).
$R_L$ ì™¸ë¶€: ì¥ ì„ ì´ ì—´ë¦¬ê³ , ì…ì íƒˆì¶œ (í„ì„œ ë°”ëŒ).</p>
<hr />
<h2 id="_2">ìš”ì•½<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>ìƒëŒ€ë¡ ì  MHDëŠ” ê³ ì „ MHDë¥¼ $v \sim c$ ì˜ì—­ìœ¼ë¡œ í™•ì¥í•©ë‹ˆë‹¤:</p>
<ol>
<li><strong>SRMHD ì •ì‹í™”:</strong> ê³µë³€ 4-í…ì„œ ì ‘ê·¼ë²•, ì‘ë ¥-ì—ë„ˆì§€ í…ì„œ, ë™ê²° ì¡°ê±´</li>
<li><strong>3+1 ë¶„í•´:</strong> ìˆ˜ì¹˜ êµ¬í˜„ì„ ìœ„í•œ ì‹¤í—˜ì‹¤ ì¢Œí‘œê³„ ë³´ì¡´ ë³€ìˆ˜</li>
<li><strong>ì›ì‹œë³€ìˆ˜ ë³µì›:</strong> ë¹„ì„ í˜• ì•”ë¬µì  í•´ê²° (ì£¼ìš” ìˆ˜ì¹˜ì  ë„ì „)</li>
<li><strong>íŒŒë™ êµ¬ì¡°:</strong> 7ê°œì˜ íŒŒë™, ìƒëŒ€ë¡ ì  ë¶„ì‚° (ëª¨ë“  ì†ë„ &lt; $c$)</li>
<li><strong>ì‘ìš©:</strong> ìƒëŒ€ë¡ ì  ì œíŠ¸, í„ì„œ ìê¸°ê¶Œ, ë¸”ë™í™€ ê°•ì°©</li>
<li><strong>GRMHD:</strong> ê³¡ì„  ì‹œê³µê°„, Kerr ê³„ëŸ‰, ì§€í‰ì„  ê´€í†µ ì¢Œí‘œ</li>
<li><strong>ìˆ˜ì¹˜ ë°©ë²•:</strong> HLLC/HLLD Riemann ì†”ë²„, ì ì‘í˜• íƒ€ì„ìŠ¤í…í•‘, í”Œë¡œì–´</li>
</ol>
<p><strong>ì£¼ìš” ë„ì „ ê³¼ì œ:</strong>
- ì›ì‹œë³€ìˆ˜ ë³µì› ê²¬ê³ ì„±
- ë†’ì€ Lorentz ì¸ì ì²˜ë¦¬ ($W \gg 1$)
- ìˆ˜ì‹­ ë…„ì— ê±¸ì³ ë³€í™”í•˜ëŠ” ìí™” ë§¤ê°œë³€ìˆ˜ $\sigma$
- ë³µì‚¬, ìŒìƒì„±ê³¼ì˜ ê²°í•© (ì´ìƒ MHDë¥¼ ë„˜ì–´ì„œ)</p>
<p>ìƒëŒ€ë¡ ì  MHDëŠ” ìš°ì£¼ì—ì„œ ê°€ì¥ ì—ë„ˆì§€ê°€ ë†’ì€ í˜„ìƒ ì´í•´ì— í•„ìˆ˜ì ì…ë‹ˆë‹¤: ì œíŠ¸, í„ì„œ, ë¸”ë™í™€, ì¤‘ì„±ìë³„ ë³‘í•©.</p>
<hr />
<h2 id="_3">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Lorentz ë³€í™˜:</strong>
   ì‹¤í—˜ì‹¤ ì¢Œí‘œê³„ì—ì„œ $\mathbf{E} = (1, 0, 0)$, $\mathbf{B} = (0, 1, 0)$ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, $\mathbf{v} = (0.5c, 0, 0)$ë¡œ ì›€ì§ì´ëŠ” ì¢Œí‘œê³„ì—ì„œ $\mathbf{E}'$ì™€ $\mathbf{B}'$ë¥¼ ê³„ì‚°í•˜ì„¸ìš”. $\mathbf{E}' \cdot \mathbf{B}' = \mathbf{E} \cdot \mathbf{B}$ (Lorentz ë¶ˆë³€ëŸ‰) í™•ì¸í•˜ì„¸ìš”.</p>
</li>
<li>
<p><strong>ì›ì‹œë³€ìˆ˜ ë³µì›:</strong>
   1D Newton-Raphson ì›ì‹œë³€ìˆ˜ ë³µì› ë£¨í‹´ì„ êµ¬í˜„í•˜ì„¸ìš”. í…ŒìŠ¤íŠ¸: $D = 2.0$, $S_x = 1.0$, $\tau = 3.0$, $B_x = 0.5$, $B_y = 1.0$. ì´ˆê¸° ì¶”ì¸¡: $\rho = 1.0$, $v_x = 0.3$, $p = 1.0$. ìˆ˜ë ´í•©ë‹ˆê¹Œ? ëª‡ ë²ˆ ë°˜ë³µí•©ë‹ˆê¹Œ?</p>
</li>
<li>
<p><strong>ìƒëŒ€ë¡ ì  Brio-Wu:</strong>
   ì¶©ê²©íŒŒ íŠœë¸Œ ì½”ë“œë¥¼ $B_x = 0$ (ìˆœìˆ˜ íš¡ë°©í–¥ ì¥)ìœ¼ë¡œ ìˆ˜ì •í•˜ì„¸ìš”. íŒŒë™ ì†ë„ì™€ êµ¬ì¡°ë¥¼ $B_x = 0.5$ ê²½ìš°ì™€ ë¹„êµí•˜ì„¸ìš”. ì™œ í•´ê°€ ë‹¤ë¦…ë‹ˆê¹Œ?</p>
</li>
<li>
<p><strong>ìí™” ë§¤ê°œë³€ìˆ˜:</strong>
   $B = 10^{12}$ G, $\rho = 10^7$ g/cmÂ³, $\Gamma = 10$ì¸ í„ì„œì— ëŒ€í•´ $\sigma = B^2/(4\pi \rho h W^2 c^2)$ë¥¼ ê³„ì‚°í•˜ì„¸ìš”. $h \approx 1$ë¡œ ê°€ì •í•˜ì„¸ìš”. ì´ê²ƒì€ force-free ($\sigma \gg 1$)ì…ë‹ˆê¹Œ, ìœ ì²´ ì§€ë°°ì…ë‹ˆê¹Œ?</p>
</li>
<li>
<p><strong>Light Cylinder:</strong>
   Crab í„ì„œ ($P = 33$ ms)ì— ëŒ€í•´ $R_L$ì„ ê³„ì‚°í•˜ì„¸ìš”. ì–´ëŠ ë°˜ê²½ì—ì„œ corotation ì†ë„ê°€ $c$ì™€ ê°™ìŠµë‹ˆê¹Œ? í„ì„œ ë°˜ê²½ $R_{NS} \sim 10$ kmì™€ ë¹„êµí•˜ì„¸ìš”.</p>
</li>
<li>
<p><strong>ISCO ì†ë„:</strong>
   Schwarzschild ë¸”ë™í™€ì— ëŒ€í•´ ISCO ($r = 6GM/c^2$)ì—ì„œ ê¶¤ë„ ì†ë„ë¥¼ ê³„ì‚°í•˜ì„¸ìš”. Lorentz ì¸ì $W$ëŠ” ì–¼ë§ˆì…ë‹ˆê¹Œ? $a = 0.998$ (ê±°ì˜ ê·¹ë‹¨ì )ì¸ Kerr ë¸”ë™í™€ì˜ ìˆœí–‰ ISCOì—ì„œ ë°˜ë³µí•˜ì„¸ìš”.</p>
</li>
<li>
<p><strong>AlfvÃ©n ì†ë„ í¬í™”:</strong>
   ê³ ì •ëœ $\rho = 1$, $p = 0.1$, $\Gamma = 4/3$ì— ëŒ€í•´ ìƒëŒ€ë¡ ì  AlfvÃ©n ì†ë„ $v_A = B/\sqrt{4\pi(\rho h + B^2/(4\pi))}$ vs $B$ë¥¼ ê·¸ë¦¬ì„¸ìš”. $B \to \infty$ì¼ ë•Œ $v_A \to c$ì´ì§€ë§Œ $c$ë¥¼ ì ˆëŒ€ ì´ˆê³¼í•˜ì§€ ì•ŠìŒì„ ë³´ì´ì„¸ìš”.</p>
</li>
<li>
<p><strong>HARM íƒ€ì„ìŠ¤í…:</strong>
   ë¸”ë™í™€ ì§€í‰ì„  ê·¼ì²˜ì˜ GRMHDì—ì„œ lapse í•¨ìˆ˜ $\alpha \to 0$ì…ë‹ˆë‹¤. ì™œ ë” ì‘ì€ íƒ€ì„ìŠ¤í…ì´ í•„ìš”í•©ë‹ˆê¹Œ? $\Delta r = 0.01 GM/c^2$ì¸ ë°©ì‚¬í˜• ê·¸ë¦¬ë“œì— ëŒ€í•´ $r = 2.01 GM/c^2$ ê·¼ì²˜ì˜ CFL íƒ€ì„ìŠ¤í…ì„ ì¶”ì •í•˜ì„¸ìš”.</p>
</li>
</ol>
<hr />
<p><strong>ì´ì „:</strong> <a href="./15_2D_MHD_Solver.md">2D MHD ì†”ë²„</a> | <strong>ë‹¤ìŒ:</strong> <a href="./17_Spectral_Methods.md">ìŠ¤í™íŠ¸ëŸ´ ë° ê³ ê¸‰ ë°©ë²•</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/MHD/15_2D_MHD_Solver.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">15. 2D MHD ì†”ë²„</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/MHD/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/MHD/17_Spectral_Methods.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">17. ìŠ¤í™íŠ¸ëŸ´ ë° ê³ ê¸‰ ë°©ë²•</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}