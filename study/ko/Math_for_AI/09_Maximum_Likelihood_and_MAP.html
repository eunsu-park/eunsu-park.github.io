{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>09. ìµœëŒ€ìš°ë„ì¶”ì •ê³¼ MAP (Maximum Likelihood and MAP) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Math_for_AI/">Math for AI</a>
    <span class="separator">/</span>
    <span class="current">09. ìµœëŒ€ìš°ë„ì¶”ì •ê³¼ MAP (Maximum Likelihood and MAP)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>09. ìµœëŒ€ìš°ë„ì¶”ì •ê³¼ MAP (Maximum Likelihood and MAP)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Math_for_AI/08_Probability_for_ML.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">08. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ í™•ë¥ ë¡  (Probability for Machine Learning)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Math_for_AI/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Math_for_AI/10_Information_Theory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">10. ì •ë³´ ì´ë¡  (Information Theory)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1-likelihood-function">1. ìš°ë„ í•¨ìˆ˜ (Likelihood Function)</a><ul>
<li><a href="#11-vs">1.1 ìš°ë„ vs í™•ë¥ </a></li>
<li><a href="#12-log-likelihood">1.2 ë¡œê·¸ ìš°ë„ (Log-Likelihood)</a></li>
<li><a href="#13-iid">1.3 i.i.d. ê°€ì •ê³¼ ê³±â†’í•© ë³€í™˜</a></li>
</ul>
</li>
<li><a href="#2-mle">2. ìµœëŒ€ìš°ë„ì¶”ì • (MLE)</a><ul>
<li><a href="#21-mle">2.1 MLE ì •ì˜</a></li>
<li><a href="#22-mle">2.2 ì •ê·œë¶„í¬ì˜ MLE</a></li>
<li><a href="#23-mle">2.3 ë² ë¥´ëˆ„ì´ ë¶„í¬ì˜ MLE</a></li>
<li><a href="#24-mle">2.4 MLEì˜ ì„±ì§ˆ</a></li>
</ul>
</li>
<li><a href="#3-map-maximum-a-posteriori">3. MAP ì¶”ì • (Maximum A Posteriori)</a><ul>
<li><a href="#31">3.1 ë² ì´ì¦ˆ ì •ë¦¬ì™€ ì‚¬í›„ ë¶„í¬</a></li>
<li><a href="#32-map">3.2 MAP ì •ì˜</a></li>
<li><a href="#33-mle-vs-map">3.3 MLE vs MAP ë¹„êµ</a></li>
<li><a href="#34">3.4 ì‚¬ì „ë¶„í¬ì˜ ì—­í• </a></li>
</ul>
</li>
<li><a href="#4">4. ì •ê·œí™” = ì‚¬ì „ë¶„í¬</a><ul>
<li><a href="#41-l2">4.1 L2 ì •ê·œí™”ì™€ ê°€ìš°ì‹œì•ˆ ì‚¬ì „ë¶„í¬</a></li>
<li><a href="#42-l1">4.2 L1 ì •ê·œí™”ì™€ ë¼í”Œë¼ìŠ¤ ì‚¬ì „ë¶„í¬</a></li>
</ul>
</li>
<li><a href="#5-em-expectation-maximization">5. EM ì•Œê³ ë¦¬ì¦˜ (Expectation-Maximization)</a><ul>
<li><a href="#51">5.1 ì ì¬ ë³€ìˆ˜ ë¬¸ì œ</a></li>
<li><a href="#52-elbo-em">5.2 ELBOì™€ EM ìœ ë„</a></li>
<li><a href="#53-gmm">5.3 ê°€ìš°ì‹œì•ˆ í˜¼í•© ëª¨ë¸ (GMM)</a></li>
</ul>
</li>
<li><a href="#6">6. ë¨¸ì‹ ëŸ¬ë‹ ì‘ìš©</a><ul>
<li><a href="#61-mle">6.1 ë¡œì§€ìŠ¤í‹± íšŒê·€ = ë² ë¥´ëˆ„ì´ MLE</a></li>
<li><a href="#62-mle">6.2 ì‹ ê²½ë§ í•™ìŠµ = MLE</a></li>
<li><a href="#63">6.3 ë² ì´ì§€ì•ˆ ì‹ ê²½ë§ ì†Œê°œ</a></li>
</ul>
</li>
<li><a href="#_2">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-mle">ë¬¸ì œ 1: ì§€ìˆ˜ë¶„í¬ì˜ MLE</a></li>
<li><a href="#2-map-with-different-priors">ë¬¸ì œ 2: MAP with Different Priors</a></li>
<li><a href="#3-em-for-coin-toss">ë¬¸ì œ 3: EM for Coin Toss</a></li>
<li><a href="#4-fisher-information">ë¬¸ì œ 4: Fisher Information</a></li>
<li><a href="#5-em-for-mixture-of-exponentials">ë¬¸ì œ 5: EM for Mixture of Exponentials</a></li>
</ul>
</li>
<li><a href="#_3">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="09-map-maximum-likelihood-and-map">09. ìµœëŒ€ìš°ë„ì¶”ì •ê³¼ MAP (Maximum Likelihood and MAP)<a class="header-link" href="#09-map-maximum-likelihood-and-map" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ìš°ë„ í•¨ìˆ˜ì™€ í™•ë¥ ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ê³ , ë¡œê·¸ ìš°ë„ì˜ ì—­í• ì„ íŒŒì•…í•œë‹¤</li>
<li>ìµœëŒ€ìš°ë„ì¶”ì •(MLE)ì˜ ì •ì˜ì™€ ë‹¤ì–‘í•œ í™•ë¥ ë¶„í¬ì— ëŒ€í•œ MLEë¥¼ ìœ ë„í•  ìˆ˜ ìˆë‹¤</li>
<li>MAP ì¶”ì •ì˜ ì›ë¦¬ë¥¼ ì´í•´í•˜ê³  MLEì™€ì˜ ì°¨ì´ì ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</li>
<li>ì •ê·œí™” í•­ì´ ì‚¬ì „ë¶„í¬ì™€ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€ ìˆ˜í•™ì ìœ¼ë¡œ ìœ ë„í•  ìˆ˜ ìˆë‹¤</li>
<li>EM ì•Œê³ ë¦¬ì¦˜ì˜ ì›ë¦¬ë¥¼ ì´í•´í•˜ê³  ì ì¬ ë³€ìˆ˜ê°€ ìˆëŠ” ëª¨ë¸ì— ì ìš©í•  ìˆ˜ ìˆë‹¤</li>
<li>ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ MLEì™€ MAPê°€ ì–´ë–»ê²Œ í™œìš©ë˜ëŠ”ì§€ ì‹¤ì œ ì˜ˆì œë¥¼ í†µí•´ í•™ìŠµí•œë‹¤</li>
</ul>
<hr />
<h2 id="1-likelihood-function">1. ìš°ë„ í•¨ìˆ˜ (Likelihood Function)<a class="header-link" href="#1-likelihood-function" title="Permanent link">&para;</a></h2>
<h3 id="11-vs">1.1 ìš°ë„ vs í™•ë¥ <a class="header-link" href="#11-vs" title="Permanent link">&para;</a></h3>
<p><strong>í™•ë¥ (Probability)</strong>ê³¼ <strong>ìš°ë„(Likelihood)</strong>ëŠ” ê°™ì€ ì‹ìœ¼ë¡œ ê³„ì‚°ë˜ì§€ë§Œ, ì˜ë¯¸ê°€ ë‹¤ë¦…ë‹ˆë‹¤.</p>
<ul>
<li>
<p><strong>í™•ë¥ </strong>: íŒŒë¼ë¯¸í„° $\theta$ê°€ ê³ ì •ë˜ì–´ ìˆì„ ë•Œ, ë°ì´í„° $D$ê°€ ë°œìƒí•  í™•ë¥ 
  $$P(D|\theta)$$</p>
</li>
<li>
<p><strong>ìš°ë„</strong>: ë°ì´í„° $D$ê°€ ê´€ì¸¡ëœ í›„, íŒŒë¼ë¯¸í„° $\theta$ì— ëŒ€í•œ í•¨ìˆ˜
  $$\mathcal{L}(\theta|D) = P(D|\theta)$$</p>
</li>
</ul>
<p><strong>í•µì‹¬ ì°¨ì´ì </strong>:
- í™•ë¥ : $\theta$ ê³ ì •, $D$ ë³€ìˆ˜ â†’ $\sum_D P(D|\theta) = 1$
- ìš°ë„: $D$ ê³ ì •, $\theta$ ë³€ìˆ˜ â†’ $\int \mathcal{L}(\theta|D) d\theta \neq 1$ (ì¼ë°˜ì ìœ¼ë¡œ)</p>
<p><strong>ì˜ˆì œ</strong>: ë™ì „ ë˜ì§€ê¸°
- ë™ì „ì˜ ì•ë©´ í™•ë¥ ì´ $\theta = 0.7$ì¼ ë•Œ, 10ë²ˆ ë˜ì ¸ì„œ 7ë²ˆ ì•ë©´ì´ ë‚˜ì˜¬ <strong>í™•ë¥ </strong>
- 10ë²ˆ ë˜ì ¸ì„œ 7ë²ˆ ì•ë©´ì´ ê´€ì¸¡ë˜ì—ˆì„ ë•Œ, $\theta$ê°€ 0.7ì¼ <strong>ìš°ë„</strong></p>
<h3 id="12-log-likelihood">1.2 ë¡œê·¸ ìš°ë„ (Log-Likelihood)<a class="header-link" href="#12-log-likelihood" title="Permanent link">&para;</a></h3>
<p>ì‹¤ì œ ê³„ì‚°ì—ì„œëŠ” <strong>ë¡œê·¸ ìš°ë„</strong>ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>
<p>$$\ell(\theta|D) = \log \mathcal{L}(\theta|D) = \log P(D|\theta)$$</p>
<p><strong>ë¡œê·¸ ìš°ë„ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ </strong>:</p>
<ol>
<li><strong>ìˆ˜ì¹˜ì  ì•ˆì •ì„±</strong>: í™•ë¥ ì˜ ê³±ì€ ë§¤ìš° ì‘ì€ ê°’ì´ ë˜ì–´ underflow ë°œìƒ</li>
<li><strong>ê³±ì„ í•©ìœ¼ë¡œ ë³€í™˜</strong>: $\log(ab) = \log a + \log b$</li>
<li><strong>ë¯¸ë¶„ ê³„ì‚° ìš©ì´</strong>: ì§€ìˆ˜ í•¨ìˆ˜ì˜ ë¯¸ë¶„ì´ ê°„ë‹¨í•´ì§</li>
<li><strong>ìµœì í™” ë™ì¼</strong>: $\log$ëŠ” ë‹¨ì¡°ì¦ê°€ í•¨ìˆ˜ì´ë¯€ë¡œ argmaxëŠ” ë™ì¼</li>
</ol>
<h3 id="13-iid">1.3 i.i.d. ê°€ì •ê³¼ ê³±â†’í•© ë³€í™˜<a class="header-link" href="#13-iid" title="Permanent link">&para;</a></h3>
<p>ë°ì´í„° $D = \{x_1, x_2, \ldots, x_n\}$ì´ <strong>ë…ë¦½ í•­ë“± ë¶„í¬(i.i.d.)</strong>ë¥¼ ë”°ë¥¸ë‹¤ë©´:</p>
<p>$$P(D|\theta) = \prod_{i=1}^n P(x_i|\theta)$$</p>
<p>ë¡œê·¸ë¥¼ ì·¨í•˜ë©´:</p>
<p>$$\ell(\theta|D) = \log \prod_{i=1}^n P(x_i|\theta) = \sum_{i=1}^n \log P(x_i|\theta)$$</p>
<p>ì´ ë³€í™˜ì´ MLEì˜ í•µì‹¬ì…ë‹ˆë‹¤.</p>
<h2 id="2-mle">2. ìµœëŒ€ìš°ë„ì¶”ì • (MLE)<a class="header-link" href="#2-mle" title="Permanent link">&para;</a></h2>
<h3 id="21-mle">2.1 MLE ì •ì˜<a class="header-link" href="#21-mle" title="Permanent link">&para;</a></h3>
<p><strong>ìµœëŒ€ìš°ë„ì¶”ì •(Maximum Likelihood Estimation, MLE)</strong>ì€ ê´€ì¸¡ëœ ë°ì´í„°ì˜ ìš°ë„ë¥¼ ìµœëŒ€í™”í•˜ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ëŠ” ë°©ë²•ì…ë‹ˆë‹¤:</p>
<p>$$\theta_{\text{MLE}} = \arg\max_{\theta} \mathcal{L}(\theta|D) = \arg\max_{\theta} \log P(D|\theta)$$</p>
<p><strong>ê³„ì‚° ë°©ë²•</strong>:
1. ìš°ë„ í•¨ìˆ˜ $\mathcal{L}(\theta|D)$ ì‘ì„±
2. ë¡œê·¸ ìš°ë„ $\ell(\theta|D)$ ê³„ì‚°
3. $\frac{\partial \ell}{\partial \theta} = 0$ í’€ê¸°
4. 2ì°¨ ë¯¸ë¶„ìœ¼ë¡œ ìµœëŒ€ê°’ í™•ì¸</p>
<h3 id="22-mle">2.2 ì •ê·œë¶„í¬ì˜ MLE<a class="header-link" href="#22-mle" title="Permanent link">&para;</a></h3>
<p><strong>ë¬¸ì œ</strong>: $n$ê°œì˜ ë°ì´í„° $\{x_1, \ldots, x_n\}$ì´ $\mathcal{N}(\mu, \sigma^2)$ë¥¼ ë”°ë¥¼ ë•Œ, $\mu$ì™€ $\sigma^2$ì˜ MLEë¥¼ êµ¬í•˜ì‹œì˜¤.</p>
<p><strong>í•´ê²°</strong>:</p>
<p>ë¡œê·¸ ìš°ë„:
$$\ell(\mu, \sigma^2) = \sum_{i=1}^n \log \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(x_i-\mu)^2}{2\sigma^2}\right)$$</p>
<p>$$= -\frac{n}{2}\log(2\pi) - \frac{n}{2}\log(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^n (x_i-\mu)^2$$</p>
<p><strong>$\mu$ì— ëŒ€í•œ ìµœì í™”</strong>:</p>
<p>$$\frac{\partial \ell}{\partial \mu} = \frac{1}{\sigma^2}\sum_{i=1}^n (x_i - \mu) = 0$$</p>
<p>$$\Rightarrow \mu_{\text{MLE}} = \frac{1}{n}\sum_{i=1}^n x_i$$</p>
<p><strong>$\sigma^2$ì— ëŒ€í•œ ìµœì í™”</strong>:</p>
<p>$$\frac{\partial \ell}{\partial \sigma^2} = -\frac{n}{2\sigma^2} + \frac{1}{2(\sigma^2)^2}\sum_{i=1}^n (x_i-\mu)^2 = 0$$</p>
<p>$$\Rightarrow \sigma^2_{\text{MLE}} = \frac{1}{n}\sum_{i=1}^n (x_i - \mu_{\text{MLE}})^2$$</p>
<p><strong>ê²°ê³¼</strong>: í‘œë³¸ í‰ê· ê³¼ í‘œë³¸ ë¶„ì‚°!</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># ë°ì´í„° ìƒì„±</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">true_mu</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">true_sigma</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">true_mu</span><span class="p">,</span> <span class="n">true_sigma</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>

<span class="c1"># MLE ê³„ì‚°</span>
<span class="n">mu_mle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sigma2_mle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># ddof=0: MLE (biased)</span>
<span class="n">sigma_mle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2_mle</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True parameters: Î¼=</span><span class="si">{</span><span class="n">true_mu</span><span class="si">}</span><span class="s2">, Ïƒ=</span><span class="si">{</span><span class="n">true_sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MLE estimates: Î¼=</span><span class="si">{</span><span class="n">mu_mle</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Ïƒ=</span><span class="si">{</span><span class="n">sigma_mle</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ë¡œê·¸ ìš°ë„ í•¨ìˆ˜ ì‹œê°í™”</span>
<span class="k">def</span><span class="w"> </span><span class="nf">log_likelihood</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> \
           <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">data</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Î¼ì— ëŒ€í•œ ë¡œê·¸ ìš°ë„</span>
<span class="n">mu_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ll_mu</span> <span class="o">=</span> <span class="p">[</span><span class="n">log_likelihood</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">true_sigma</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mu_range</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mu_range</span><span class="p">,</span> <span class="n">ll_mu</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mu_mle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MLE=</span><span class="si">{</span><span class="n">mu_mle</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Î¼&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Log-Likelihood&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Log-Likelihood vs Î¼&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ïƒì— ëŒ€í•œ ë¡œê·¸ ìš°ë„</span>
<span class="n">sigma_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ll_sigma</span> <span class="o">=</span> <span class="p">[</span><span class="n">log_likelihood</span><span class="p">(</span><span class="n">true_mu</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sigma_range</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sigma_range</span><span class="p">,</span> <span class="n">ll_sigma</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">sigma_mle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MLE=</span><span class="si">{</span><span class="n">sigma_mle</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ïƒ&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Log-Likelihood&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Log-Likelihood vs Ïƒ&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># íˆìŠ¤í† ê·¸ë¨ê³¼ MLE ë¶„í¬</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_mle</span><span class="p">,</span> <span class="n">sigma_mle</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MLE fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Data vs MLE Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mle_gaussian.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="23-mle">2.3 ë² ë¥´ëˆ„ì´ ë¶„í¬ì˜ MLE<a class="header-link" href="#23-mle" title="Permanent link">&para;</a></h3>
<p><strong>ë¬¸ì œ</strong>: $n$ë²ˆì˜ ë™ì „ ë˜ì§€ê¸°ì—ì„œ $k$ë²ˆ ì•ë©´ì´ ë‚˜ì™”ì„ ë•Œ, ì•ë©´ í™•ë¥  $\theta$ì˜ MLEëŠ”?</p>
<p><strong>í•´ê²°</strong>:</p>
<p>$$\mathcal{L}(\theta) = \theta^k (1-\theta)^{n-k}$$</p>
<p>$$\ell(\theta) = k \log \theta + (n-k) \log(1-\theta)$$</p>
<p>$$\frac{d\ell}{d\theta} = \frac{k}{\theta} - \frac{n-k}{1-\theta} = 0$$</p>
<p>$$\Rightarrow \theta_{\text{MLE}} = \frac{k}{n}$$</p>
<p><strong>ì§ê´€</strong>: ê´€ì¸¡ëœ ìƒëŒ€ ë¹ˆë„!</p>
<h3 id="24-mle">2.4 MLEì˜ ì„±ì§ˆ<a class="header-link" href="#24-mle" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>ì¼ì¹˜ì„±(Consistency)</strong>: $n \to \infty$ì¼ ë•Œ, $\theta_{\text{MLE}} \to \theta_{\text{true}}$ (í™•ë¥ ì ìœ¼ë¡œ)</p>
</li>
<li>
<p><strong>ì ê·¼ ì •ê·œì„±(Asymptotic Normality)</strong>:
   $$\sqrt{n}(\theta_{\text{MLE}} - \theta_{\text{true}}) \xrightarrow{d} \mathcal{N}(0, I(\theta)^{-1})$$
   ì—¬ê¸°ì„œ $I(\theta)$ëŠ” Fisher ì •ë³´ í–‰ë ¬</p>
</li>
<li>
<p><strong>ë¶ˆí¸ì„±ì€ ë³´ì¥ë˜ì§€ ì•ŠìŒ</strong>: ì˜ˆë¥¼ ë“¤ì–´, $\sigma^2_{\text{MLE}}$ëŠ” í¸í–¥ ì¶”ì •ëŸ‰ (ddof=0)</p>
</li>
<li>
<p><strong>ë³€í™˜ ë¶ˆë³€ì„±</strong>: $\theta_{\text{MLE}}$ê°€ $\theta$ì˜ MLEì´ë©´, $g(\theta_{\text{MLE}})$ëŠ” $g(\theta)$ì˜ MLE</p>
</li>
</ol>
<h2 id="3-map-maximum-a-posteriori">3. MAP ì¶”ì • (Maximum A Posteriori)<a class="header-link" href="#3-map-maximum-a-posteriori" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ë² ì´ì¦ˆ ì •ë¦¬ì™€ ì‚¬í›„ ë¶„í¬<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>ë² ì´ì¦ˆ ì •ë¦¬:</p>
<p>$$P(\theta|D) = \frac{P(D|\theta)P(\theta)}{P(D)}$$</p>
<ul>
<li>$P(\theta|D)$: ì‚¬í›„ ë¶„í¬ (posterior)</li>
<li>$P(D|\theta)$: ìš°ë„ (likelihood)</li>
<li>$P(\theta)$: ì‚¬ì „ ë¶„í¬ (prior)</li>
<li>$P(D)$: ì¦ê±° (evidence), ì •ê·œí™” ìƒìˆ˜</li>
</ul>
<h3 id="32-map">3.2 MAP ì •ì˜<a class="header-link" href="#32-map" title="Permanent link">&para;</a></h3>
<p><strong>MAP ì¶”ì •(Maximum A Posteriori)</strong>ì€ ì‚¬í›„ ë¶„í¬ë¥¼ ìµœëŒ€í™”í•˜ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ìŠµë‹ˆë‹¤:</p>
<p>$$\theta_{\text{MAP}} = \arg\max_{\theta} P(\theta|D)$$</p>
<p>$$= \arg\max_{\theta} P(D|\theta)P(\theta)$$</p>
<p>$$= \arg\max_{\theta} \left[\log P(D|\theta) + \log P(\theta)\right]$$</p>
<p><strong>MLEì™€ì˜ ê´€ê³„</strong>:
- MLE: $\arg\max_{\theta} \log P(D|\theta)$
- MAP: $\arg\max_{\theta} \left[\log P(D|\theta) + \log P(\theta)\right]$</p>
<p>MAP = MLE + prior term</p>
<h3 id="33-mle-vs-map">3.3 MLE vs MAP ë¹„êµ<a class="header-link" href="#33-mle-vs-map" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># ë°ì´í„°: 10ë²ˆ ì¤‘ 8ë²ˆ ì•ë©´</span>
<span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span>

<span class="c1"># ìš°ë„ í•¨ìˆ˜</span>
<span class="n">theta_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta_range</span><span class="p">)</span>

<span class="c1"># MLE</span>
<span class="n">theta_mle</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="n">n</span>

<span class="c1"># MAP with Beta prior (Î±, Î²)</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>  <span class="c1"># ì•½í•œ ì‚¬ì „ë¶„í¬</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">posterior</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="n">theta_range</span><span class="p">)</span>  <span class="c1"># ì •ê·œí™”</span>
<span class="n">theta_map</span> <span class="o">=</span> <span class="n">theta_range</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">posterior</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># ìš°ë„</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">likelihood</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">likelihood</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Likelihood&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">theta_mle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MLE=</span><span class="si">{</span><span class="n">theta_mle</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Likelihood&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Likelihood Function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ì‚¬ì „ë¶„í¬</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Beta(</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prior Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ì‚¬í›„ë¶„í¬</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_range</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Posterior&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">theta_mle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MLE=</span><span class="si">{</span><span class="n">theta_mle</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">theta_map</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MAP=</span><span class="si">{</span><span class="n">theta_map</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posterior Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mle_vs_map.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ë°ì´í„°ê°€ ì ì„ ë•Œì˜ ì°¨ì´</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ë°ì´í„°ê°€ ì ì„ ë•Œ (n=10, k=8):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MLE: </span><span class="si">{</span><span class="n">theta_mle</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAP: </span><span class="si">{</span><span class="n">theta_map</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ë°ì´í„°ê°€ ë§ì„ ë•Œ</span>
<span class="n">n2</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">800</span>
<span class="n">theta_mle2</span> <span class="o">=</span> <span class="n">k2</span> <span class="o">/</span> <span class="n">n2</span>
<span class="n">likelihood2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">theta_range</span><span class="p">)</span>
<span class="n">posterior2</span> <span class="o">=</span> <span class="n">likelihood2</span> <span class="o">*</span> <span class="n">prior</span>
<span class="n">theta_map2</span> <span class="o">=</span> <span class="n">theta_range</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">posterior2</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ë°ì´í„°ê°€ ë§ì„ ë•Œ (n=1000, k=800):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MLE: </span><span class="si">{</span><span class="n">theta_mle2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAP: </span><span class="si">{</span><span class="n">theta_map2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;â†’ ë°ì´í„°ê°€ ë§ìœ¼ë©´ MLEì™€ MAPê°€ ìˆ˜ë ´&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="34">3.4 ì‚¬ì „ë¶„í¬ì˜ ì—­í• <a class="header-link" href="#34" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ë°ì´í„°ê°€ ì ì„ ë•Œ</strong>: ì‚¬ì „ë¶„í¬ì˜ ì˜í–¥ì´ í¼ (ì •ê·œí™” íš¨ê³¼)</li>
<li><strong>ë°ì´í„°ê°€ ë§ì„ ë•Œ</strong>: ìš°ë„ê°€ ì§€ë°°ì , MAP â‰ˆ MLE</li>
<li><strong>ì ì ˆí•œ ì‚¬ì „ë¶„í¬</strong>: ë„ë©”ì¸ ì§€ì‹ ë°˜ì˜, ê³¼ì í•© ë°©ì§€</li>
<li><strong>ë¬´ì •ë³´ ì‚¬ì „ë¶„í¬</strong>: $P(\theta) \propto 1$ â†’ MAP = MLE</li>
</ul>
<h2 id="4">4. ì •ê·œí™” = ì‚¬ì „ë¶„í¬<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-l2">4.1 L2 ì •ê·œí™”ì™€ ê°€ìš°ì‹œì•ˆ ì‚¬ì „ë¶„í¬<a class="header-link" href="#41-l2" title="Permanent link">&para;</a></h3>
<p><strong>ì„ í˜• íšŒê·€ì˜ L2 ì •ê·œí™”</strong> (Ridge):</p>
<p>$$\min_w \left[\frac{1}{2}\sum_{i=1}^n (y_i - w^T x_i)^2 + \frac{\lambda}{2}\|w\|^2\right]$$</p>
<p>ì´ëŠ” ë‹¤ìŒ MAPì™€ ë™ì¼í•©ë‹ˆë‹¤:</p>
<p><strong>ì‚¬ì „ë¶„í¬</strong>: $w \sim \mathcal{N}(0, \sigma_w^2 I)$</p>
<p>$$\log P(w) = -\frac{1}{2\sigma_w^2}\|w\|^2 + \text{const}$$</p>
<p><strong>ìš°ë„</strong> (ê°€ìš°ì‹œì•ˆ ë…¸ì´ì¦ˆ): $y|x,w \sim \mathcal{N}(w^T x, \sigma^2)$</p>
<p>$$\log P(D|w) = -\frac{1}{2\sigma^2}\sum_{i=1}^n (y_i - w^T x_i)^2 + \text{const}$$</p>
<p><strong>ì‚¬í›„ë¶„í¬ ë¡œê·¸</strong>:</p>
<p>$$\log P(w|D) = \log P(D|w) + \log P(w)$$</p>
<p>$$= -\frac{1}{2\sigma^2}\sum_{i=1}^n (y_i - w^T x_i)^2 - \frac{1}{2\sigma_w^2}\|w\|^2 + \text{const}$$</p>
<p><strong>ìµœëŒ€í™” = ìµœì†Œí™”</strong>:</p>
<p>$$\arg\max_w \log P(w|D) = \arg\min_w \left[\sum_{i=1}^n (y_i - w^T x_i)^2 + \frac{\sigma^2}{\sigma_w^2}\|w\|^2\right]$$</p>
<p>ë”°ë¼ì„œ $\lambda = \frac{\sigma^2}{\sigma_w^2}$</p>
<p><strong>ê²°ë¡ </strong>: L2 ì •ê·œí™” = ê°€ìš°ì‹œì•ˆ ì‚¬ì „ë¶„í¬ë¥¼ ê°€ì§„ MAP</p>
<h3 id="42-l1">4.2 L1 ì •ê·œí™”ì™€ ë¼í”Œë¼ìŠ¤ ì‚¬ì „ë¶„í¬<a class="header-link" href="#42-l1" title="Permanent link">&para;</a></h3>
<p><strong>Lasso íšŒê·€</strong>:</p>
<p>$$\min_w \left[\frac{1}{2}\sum_{i=1}^n (y_i - w^T x_i)^2 + \lambda\|w\|_1\right]$$</p>
<p><strong>ë¼í”Œë¼ìŠ¤ ì‚¬ì „ë¶„í¬</strong>: $P(w_j) = \frac{1}{2b}\exp\left(-\frac{|w_j|}{b}\right)$</p>
<p>$$\log P(w) = -\frac{1}{b}\|w\|_1 + \text{const}$$</p>
<p>ë”°ë¼ì„œ $\lambda = \frac{\sigma^2}{b}$</p>
<p><strong>ê²°ë¡ </strong>: L1 ì •ê·œí™” = ë¼í”Œë¼ìŠ¤ ì‚¬ì „ë¶„í¬ë¥¼ ê°€ì§„ MAP</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># ì‚¬ì „ë¶„í¬ ì‹œê°í™”</span>
<span class="n">w_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># ê°€ìš°ì‹œì•ˆ ì‚¬ì „ë¶„í¬ (L2)</span>
<span class="n">sigma_w</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">gaussian_prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma_w</span><span class="p">)</span>
<span class="n">log_gaussian</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma_w</span><span class="p">)</span>

<span class="c1"># ë¼í”Œë¼ìŠ¤ ì‚¬ì „ë¶„í¬ (L1)</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">laplace_prior</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">laplace</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">log_laplace</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">laplace</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="n">gaussian_prior</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian (L2)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="n">laplace_prior</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Laplace (L1)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prior Distributions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="n">log_gaussian</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;log Gaussian&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="n">log_laplace</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;log Laplace&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Log Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Log Prior (Regularization Term)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="o">-</span><span class="n">w_range</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma_w</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
         <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$-\frac{w^2}{2\sigma_w^2}$ (L2)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_range</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$-\frac{|w|}</span><span class="si">{b}</span><span class="s1">$ (L1)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Regularization Penalty&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Penalty Terms&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;regularization_prior.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;L2 (Gaussian)ëŠ” í° ê°€ì¤‘ì¹˜ì— quadratic penalty&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;L1 (Laplace)ëŠ” ëª¨ë“  ê°€ì¤‘ì¹˜ì— linear penalty â†’ í¬ì†Œì„±&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="5-em-expectation-maximization">5. EM ì•Œê³ ë¦¬ì¦˜ (Expectation-Maximization)<a class="header-link" href="#5-em-expectation-maximization" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ì ì¬ ë³€ìˆ˜ ë¬¸ì œ<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p><strong>ê´€ì¸¡ ë³€ìˆ˜</strong> $X$ì™€ <strong>ì ì¬ ë³€ìˆ˜</strong> $Z$ê°€ ìˆì„ ë•Œ:</p>
<p>$$P(X|\theta) = \sum_Z P(X, Z|\theta)$$</p>
<p>ì§ì ‘ ìµœëŒ€í™”í•˜ê¸° ì–´ë ¤ì›€ (sum ì•ˆì˜ log).</p>
<p><strong>EM ì•Œê³ ë¦¬ì¦˜</strong>ì€ ë°˜ë³µì ìœ¼ë¡œ í•˜í•œì„ ìµœëŒ€í™”í•©ë‹ˆë‹¤.</p>
<h3 id="52-elbo-em">5.2 ELBOì™€ EM ìœ ë„<a class="header-link" href="#52-elbo-em" title="Permanent link">&para;</a></h3>
<p>Jensen ë¶€ë“±ì‹ì„ ì‚¬ìš©í•˜ì—¬:</p>
<p>$$\log P(X|\theta) = \log \sum_Z P(X, Z|\theta)$$</p>
<p>$$= \log \sum_Z Q(Z) \frac{P(X, Z|\theta)}{Q(Z)}$$</p>
<p>$$\geq \sum_Z Q(Z) \log \frac{P(X, Z|\theta)}{Q(Z)}$$</p>
<p>$$= \mathbb{E}_{Q(Z)} [\log P(X, Z|\theta)] + H(Q)$$</p>
<p>ì´ë¥¼ <strong>ELBO</strong> (Evidence Lower BOund)ë¼ê³  í•©ë‹ˆë‹¤.</p>
<p><strong>E-step</strong>: $Q(Z)$ë¥¼ í˜„ì¬ $\theta^{(t)}$ì— ëŒ€í•´ ìµœì í™”
$$Q^{(t+1)}(Z) = P(Z|X, \theta^{(t)})$$</p>
<p><strong>M-step</strong>: $\theta$ë¥¼ í˜„ì¬ $Q^{(t+1)}$ì— ëŒ€í•´ ìµœì í™”
$$\theta^{(t+1)} = \arg\max_{\theta} \mathbb{E}_{Q^{(t+1)}(Z)} [\log P(X, Z|\theta)]$$</p>
<h3 id="53-gmm">5.3 ê°€ìš°ì‹œì•ˆ í˜¼í•© ëª¨ë¸ (GMM)<a class="header-link" href="#53-gmm" title="Permanent link">&para;</a></h3>
<p><strong>ëª¨ë¸</strong>:
- $K$ê°œì˜ ê°€ìš°ì‹œì•ˆ ì»´í¬ë„ŒíŠ¸
- ì ì¬ ë³€ìˆ˜ $z_i \in \{1, \ldots, K\}$: ë°ì´í„° $x_i$ì˜ ì»´í¬ë„ŒíŠ¸
- íŒŒë¼ë¯¸í„°: $\pi_k$ (í˜¼í•© ë¹„ìœ¨), $\mu_k, \Sigma_k$ (ê° ê°€ìš°ì‹œì•ˆì˜ í‰ê· , ê³µë¶„ì‚°)</p>
<p><strong>ìƒì„± ê³¼ì •</strong>:
1. $z_i \sim \text{Categorical}(\pi)$
2. $x_i | z_i=k \sim \mathcal{N}(\mu_k, \Sigma_k)$</p>
<p><strong>E-step</strong>: ì±…ì„ë„(responsibility) ê³„ì‚°</p>
<p>$$\gamma_{ik} = P(z_i=k | x_i, \theta^{(t)}) = \frac{\pi_k \mathcal{N}(x_i|\mu_k, \Sigma_k)}{\sum_{j=1}^K \pi_j \mathcal{N}(x_i|\mu_j, \Sigma_j)}$$</p>
<p><strong>M-step</strong>: íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸</p>
<p>$$\pi_k^{\text{new}} = \frac{1}{n}\sum_{i=1}^n \gamma_{ik}$$</p>
<p>$$\mu_k^{\text{new}} = \frac{\sum_{i=1}^n \gamma_{ik} x_i}{\sum_{i=1}^n \gamma_{ik}}$$</p>
<p>$$\Sigma_k^{\text{new}} = \frac{\sum_{i=1}^n \gamma_{ik} (x_i - \mu_k^{\text{new}})(x_i - \mu_k^{\text{new}})^T}{\sum_{i=1}^n \gamma_{ik}}$$</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GMM</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="n">K</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="n">max_iter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="n">tol</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># ì´ˆê¸°í™”: k-means++</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span>
        <span class="c1"># ëœë¤ ì´ˆê¸°í™”</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">)])</span>

        <span class="n">log_likelihood_old</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">):</span>
            <span class="c1"># E-step</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_e_step</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

            <span class="c1"># M-step</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_m_step</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

            <span class="c1"># ë¡œê·¸ ìš°ë„ ê³„ì‚°</span>
            <span class="n">log_likelihood</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_log_likelihood</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">iteration</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">: log-likelihood = </span><span class="si">{</span><span class="n">log_likelihood</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># ìˆ˜ë ´ í™•ì¸</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">log_likelihood</span> <span class="o">-</span> <span class="n">log_likelihood_old</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converged at iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="n">log_likelihood_old</span> <span class="o">=</span> <span class="n">log_likelihood</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_e_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">):</span>
            <span class="n">gamma</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span>
                <span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="c1"># ì •ê·œí™”</span>
        <span class="n">gamma</span> <span class="o">/=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gamma</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_m_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Effective number of points assigned to each cluster</span>
        <span class="n">Nk</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># í˜¼í•© ë¹„ìœ¨ ì—…ë°ì´íŠ¸</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">Nk</span> <span class="o">/</span> <span class="n">n</span>

        <span class="c1"># í‰ê·  ì—…ë°ì´íŠ¸</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nk</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

        <span class="c1"># ê³µë¶„ì‚° ì—…ë°ì´íŠ¸</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">):</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span><span class="p">[:,</span> <span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">diff</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">Nk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># ìˆ˜ì¹˜ ì•ˆì •ì„±</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compute_log_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">log_likelihood</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">):</span>
                <span class="n">prob</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span>
                    <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">log_likelihood</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">log_likelihood</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_e_step</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># í…ŒìŠ¤íŠ¸: 3ê°œì˜ ê°€ìš°ì‹œì•ˆ í˜¼í•©</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">300</span>

<span class="c1"># 3ê°œì˜ í´ëŸ¬ìŠ¤í„° ìƒì„±</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">X3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">])</span>

<span class="c1"># GMM í•™ìŠµ</span>
<span class="n">gmm</span> <span class="o">=</span> <span class="n">GMM</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># ì˜ˆì¸¡</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># ì‹œê°í™”</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">gmm</span><span class="o">.</span><span class="n">K</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">gmm</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">gmm</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;GMM Clustering&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ê²°ì • ê²½ê³„</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Decision Boundaries&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;gmm_em.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="6">6. ë¨¸ì‹ ëŸ¬ë‹ ì‘ìš©<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-mle">6.1 ë¡œì§€ìŠ¤í‹± íšŒê·€ = ë² ë¥´ëˆ„ì´ MLE<a class="header-link" href="#61-mle" title="Permanent link">&para;</a></h3>
<p><strong>ëª¨ë¸</strong>: $P(y=1|x,w) = \sigma(w^T x)$, ì—¬ê¸°ì„œ $\sigma(z) = \frac{1}{1+e^{-z}}$</p>
<p><strong>ë¡œê·¸ ìš°ë„</strong>:</p>
<p>$$\ell(w) = \sum_{i=1}^n \left[y_i \log \sigma(w^T x_i) + (1-y_i) \log(1-\sigma(w^T x_i))\right]$$</p>
<p>ì´ëŠ” ë² ë¥´ëˆ„ì´ ë¶„í¬ì˜ ë¡œê·¸ ìš°ë„ì…ë‹ˆë‹¤!</p>
<p><strong>ìµœì í™”</strong>: ê²½ì‚¬ í•˜ê°•ë²•</p>
<p>$$\nabla_w \ell = \sum_{i=1}^n (y_i - \sigma(w^T x_i)) x_i$$</p>
<h3 id="62-mle">6.2 ì‹ ê²½ë§ í•™ìŠµ = MLE<a class="header-link" href="#62-mle" title="Permanent link">&para;</a></h3>
<p><strong>ë¶„ë¥˜ ë¬¸ì œ</strong>ì˜ ì‹ ê²½ë§ ì¶œë ¥ì„ softmaxë¡œ í•´ì„:</p>
<p>$$P(y=k|x,\theta) = \frac{\exp(f_k(x;\theta))}{\sum_j \exp(f_j(x;\theta))}$$</p>
<p><strong>êµì°¨ ì—”íŠ¸ë¡œí”¼ ì†ì‹¤</strong> = <strong>ìŒì˜ ë¡œê·¸ ìš°ë„</strong>:</p>
<p>$$\mathcal{L}(\theta) = -\sum_{i=1}^n \log P(y_i|x_i, \theta)$$</p>
<p>ë”°ë¼ì„œ ì‹ ê²½ë§ í•™ìŠµ = MLE!</p>
<h3 id="63">6.3 ë² ì´ì§€ì•ˆ ì‹ ê²½ë§ ì†Œê°œ<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<p><strong>ë¬¸ì œ</strong>: ì‹ ê²½ë§ì€ ì  ì¶”ì •ë§Œ ì œê³µ, ë¶ˆí™•ì‹¤ì„±ì„ ëª¨ë¦„</p>
<p><strong>ë² ì´ì§€ì•ˆ ì‹ ê²½ë§</strong>: ê°€ì¤‘ì¹˜ì— ëŒ€í•œ ì‚¬í›„ ë¶„í¬ ì¶”ë¡ </p>
<p>$$P(\theta|D) = \frac{P(D|\theta)P(\theta)}{P(D)}$$</p>
<p><strong>ì˜ˆì¸¡</strong>: ì‚¬í›„ ë¶„í¬ì— ëŒ€í•œ ì ë¶„</p>
<p>$$P(y|x, D) = \int P(y|x, \theta) P(\theta|D) d\theta$$</p>
<p><strong>ë„ì „ ê³¼ì œ</strong>: ê³ ì°¨ì› ì ë¶„ ê³„ì‚° â†’ ë³€ë¶„ ì¶”ë¡ , MCMC í•„ìš”</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">optim</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ê°„ë‹¨í•œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ì˜ˆì œ</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># ë°ì´í„° ìƒì„±</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitsLoss</span><span class="p">()</span>  <span class="c1"># ì´ì§„ êµì°¨ ì—”íŠ¸ë¡œí”¼ = ë² ë¥´ëˆ„ì´ MLE</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># í•™ìŠµ</span>
<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">y_tensor</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

<span class="c1"># ì‹œê°í™”</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Loss (Negative Log-Likelihood)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training Loss = -Log-Likelihood&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Class 1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ê²°ì • ê²½ê³„</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Class 1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;P(y=1|x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MLE Decision Boundary&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;logistic_mle.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Learned weights: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Learned bias: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_2">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1-mle">ë¬¸ì œ 1: ì§€ìˆ˜ë¶„í¬ì˜ MLE<a class="header-link" href="#1-mle" title="Permanent link">&para;</a></h3>
<p>ì§€ìˆ˜ë¶„í¬ $\text{Exp}(\lambda)$ì˜ PDFëŠ” $p(x|\lambda) = \lambda e^{-\lambda x}$ (for $x \geq 0$)ì…ë‹ˆë‹¤.</p>
<p>$n$ê°œì˜ i.i.d. ìƒ˜í”Œ $\{x_1, \ldots, x_n\}$ì´ ì£¼ì–´ì¡Œì„ ë•Œ:</p>
<p>(a) ë¡œê·¸ ìš°ë„ í•¨ìˆ˜ë¥¼ ìœ ë„í•˜ì‹œì˜¤.
(b) $\lambda$ì˜ MLEë¥¼ êµ¬í•˜ì‹œì˜¤.
(c) Pythonìœ¼ë¡œ ê²€ì¦í•˜ì‹œì˜¤ (ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ìƒì„± í›„ MLE ê³„ì‚°).</p>
<h3 id="2-map-with-different-priors">ë¬¸ì œ 2: MAP with Different Priors<a class="header-link" href="#2-map-with-different-priors" title="Permanent link">&para;</a></h3>
<p>ì„ í˜• íšŒê·€ ë¬¸ì œì—ì„œ:
- ë°ì´í„°: $(x_1, y_1), \ldots, (x_n, y_n)$
- ëª¨ë¸: $y = wx + b + \epsilon$, $\epsilon \sim \mathcal{N}(0, \sigma^2)$</p>
<p>ë‹¤ìŒ ë‘ ê²½ìš°ì˜ MAPë¥¼ ë¹„êµí•˜ì‹œì˜¤:</p>
<p>(a) ê°€ìš°ì‹œì•ˆ ì‚¬ì „ë¶„í¬: $w \sim \mathcal{N}(0, \sigma_w^2)$ â†’ L2 ì •ê·œí™”
(b) ë¼í”Œë¼ìŠ¤ ì‚¬ì „ë¶„í¬: $p(w) \propto \exp(-|w|/b)$ â†’ L1 ì •ê·œí™”</p>
<p>ê°ê°ì˜ ìµœì í™” ë¬¸ì œë¥¼ ì‘ì„±í•˜ê³ , Pythonìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ ì°¨ì´ë¥¼ ì‹œê°í™”í•˜ì‹œì˜¤.</p>
<h3 id="3-em-for-coin-toss">ë¬¸ì œ 3: EM for Coin Toss<a class="header-link" href="#3-em-for-coin-toss" title="Permanent link">&para;</a></h3>
<p>ë‘ ê°œì˜ ë™ì „ Aì™€ Bê°€ ìˆê³ , ì•ë©´ í™•ë¥ ì´ ê°ê° $\theta_A, \theta_B$ì…ë‹ˆë‹¤.</p>
<p>ì‹¤í—˜:
- 5ë²ˆì˜ ì‹œí–‰ì—ì„œ, ê° ì‹œí–‰ë§ˆë‹¤ ë™ì „ì„ ëœë¤í•˜ê²Œ ì„ íƒ (ê´€ì¸¡ ë¶ˆê°€)
- ê²°ê³¼: {H, T, T, H, H}</p>
<p>EM ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ $\theta_A, \theta_B$ë¥¼ ì¶”ì •í•˜ì‹œì˜¤:</p>
<p>(a) E-step: ê° ì‹œí–‰ì—ì„œ ë™ì „ Aì¼ í™•ë¥  ê³„ì‚°
(b) M-step: $\theta_A, \theta_B$ ì—…ë°ì´íŠ¸
(c) Pythonìœ¼ë¡œ êµ¬í˜„í•˜ê³  ìˆ˜ë ´ ê³¼ì •ì„ ì‹œê°í™”í•˜ì‹œì˜¤</p>
<h3 id="4-fisher-information">ë¬¸ì œ 4: Fisher Information<a class="header-link" href="#4-fisher-information" title="Permanent link">&para;</a></h3>
<p>Fisher ì •ë³´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ë©ë‹ˆë‹¤:</p>
<p>$$I(\theta) = -\mathbb{E}\left[\frac{\partial^2 \log p(X|\theta)}{\partial \theta^2}\right]$$</p>
<p>ë² ë¥´ëˆ„ì´ ë¶„í¬ $p(x|\theta) = \theta^x (1-\theta)^{1-x}$ì— ëŒ€í•´:</p>
<p>(a) Fisher ì •ë³´ $I(\theta)$ë¥¼ ê³„ì‚°í•˜ì‹œì˜¤.
(b) CramÃ©r-Rao í•˜í•œ $\text{Var}(\hat{\theta}) \geq \frac{1}{nI(\theta)}$ì„ í™•ì¸í•˜ì‹œì˜¤.
(c) MLE $\hat{\theta} = \frac{k}{n}$ì˜ ë¶„ì‚°ì´ ì´ í•˜í•œì— ë„ë‹¬í•¨ì„ ë³´ì´ì‹œì˜¤.</p>
<h3 id="5-em-for-mixture-of-exponentials">ë¬¸ì œ 5: EM for Mixture of Exponentials<a class="header-link" href="#5-em-for-mixture-of-exponentials" title="Permanent link">&para;</a></h3>
<p>ì§€ìˆ˜ë¶„í¬ì˜ í˜¼í•© ëª¨ë¸:</p>
<p>$$p(x) = \pi \lambda_1 e^{-\lambda_1 x} + (1-\pi) \lambda_2 e^{-\lambda_2 x}$$</p>
<p>EM ì•Œê³ ë¦¬ì¦˜ì„ ìœ ë„í•˜ê³  Pythonìœ¼ë¡œ êµ¬í˜„í•˜ì‹œì˜¤:</p>
<p>(a) E-stepì˜ ì±…ì„ë„ ê³µì‹ ìœ ë„
(b) M-stepì˜ $\pi, \lambda_1, \lambda_2$ ì—…ë°ì´íŠ¸ ê³µì‹ ìœ ë„
(c) ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°ë¡œ ê²€ì¦ (ì§„ì§œ íŒŒë¼ë¯¸í„°ë¥¼ ì•Œê³  ìˆëŠ” ìƒíƒœì—ì„œ ë³µì›)</p>
<h2 id="_3">ì°¸ê³  ìë£Œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Bishop, C. M. (2006).</strong> <em>Pattern Recognition and Machine Learning</em>. Chapter 9 (EM Algorithm).</li>
<li><strong>Murphy, K. P. (2022).</strong> <em>Probabilistic Machine Learning: An Introduction</em>. Chapter 8 (MLE), Chapter 10 (MAP).</li>
<li><strong>Deisenroth, M. P., Faisal, A. A., &amp; Ong, C. S. (2020).</strong> <em>Mathematics for Machine Learning</em>. Chapter 8.</li>
<li><strong>MacKay, D. J. C. (2003).</strong> <em>Information Theory, Inference, and Learning Algorithms</em>. Chapter 22 (EM).</li>
<li><strong>ë…¼ë¬¸</strong>: Dempster, A. P., Laird, N. M., &amp; Rubin, D. B. (1977). "Maximum Likelihood from Incomplete Data via the EM Algorithm". <em>Journal of the Royal Statistical Society</em>.</li>
<li><strong>scikit-learn ë¬¸ì„œ</strong>: Gaussian Mixture Models - https://scikit-learn.org/stable/modules/mixture.html</li>
<li><strong>PyTorch ë¬¸ì„œ</strong>: Loss Functions - https://pytorch.org/docs/stable/nn.html#loss-functions</li>
</ol>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Math_for_AI/08_Probability_for_ML.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">08. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ í™•ë¥ ë¡  (Probability for Machine Learning)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Math_for_AI/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Math_for_AI/10_Information_Theory.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">10. ì •ë³´ ì´ë¡  (Information Theory)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}