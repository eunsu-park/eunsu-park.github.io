{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08. ìœ í•œì°¨ë¶„ë²• ê¸°ì´ˆ (Finite Difference Method Basics) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Numerical_Simulation/">Numerical Simulation</a>
    <span class="separator">/</span>
    <span class="current">08. ìœ í•œì°¨ë¶„ë²• ê¸°ì´ˆ (Finite Difference Method Basics)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>08. ìœ í•œì°¨ë¶„ë²• ê¸°ì´ˆ (Finite Difference Method Basics)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/07_PDE_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">07. í¸ë¯¸ë¶„ë°©ì •ì‹ ê°œìš” (Partial Differential Equations Overview)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/09_Heat_Equation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">09. ì—´ë°©ì •ì‹ (Heat Equation)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ìœ í•œì°¨ë¶„ë²• ì†Œê°œ</a><ul>
<li><a href="#11">1.1 ê¸°ë³¸ ì•„ì´ë””ì–´</a></li>
<li><a href="#12">1.2 ì™œ ìœ í•œì°¨ë¶„ë²•ì¸ê°€?</a></li>
</ul>
</li>
<li><a href="#2">2. ê²©ì/ë©”ì‰¬ ìƒì„±</a><ul>
<li><a href="#21-1d">2.1 1D ê· ë“± ê²©ì</a></li>
<li><a href="#22-2d">2.2 2D ê· ë“± ê²©ì</a></li>
<li><a href="#23">2.3 ì‹œê³µê°„ ê²©ì</a></li>
<li><a href="#24">2.4 ê²©ì ì‹œê°í™”</a></li>
</ul>
</li>
<li><a href="#3">3. ì°¨ë¶„ ê³µì‹ ìœ ë„</a><ul>
<li><a href="#31">3.1 í…Œì¼ëŸ¬ ì „ê°œ ê¸°ë°˜ ìœ ë„</a></li>
<li><a href="#32">3.2 ì°¨ë¶„ ê³µì‹ ìš”ì•½</a><ul>
<li><a href="#1-ux">1ì°¨ ë¯¸ë¶„ (âˆ‚u/âˆ‚x)</a></li>
<li><a href="#2-2ux2">2ì°¨ ë¯¸ë¶„ (âˆ‚Â²u/âˆ‚xÂ²)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4-truncation-error-analysis">4. ì ˆë‹¨ì˜¤ì°¨ ë¶„ì„ (Truncation Error Analysis)</a><ul>
<li><a href="#41">4.1 ì ˆë‹¨ì˜¤ì°¨ë€?</a></li>
<li><a href="#42">4.2 ì˜¤ì°¨ ìˆ˜ë ´ ì‹œê°í™”</a></li>
</ul>
</li>
<li><a href="#5-cfl-courant-friedrichs-lewy-condition">5. CFL ì¡°ê±´ (Courant-Friedrichs-Lewy Condition)</a><ul>
<li><a href="#51-cfl">5.1 CFL ì¡°ê±´ì´ë€?</a></li>
<li><a href="#52-cfl">5.2 CFL ì¡°ê±´ ê³„ì‚°ê¸°</a></li>
</ul>
</li>
<li><a href="#6-von-neumann">6. von Neumann ì•ˆì •ì„± ë¶„ì„</a><ul>
<li><a href="#61">6.1 ë¶„ì„ ì›ë¦¬</a></li>
<li><a href="#62">6.2 ì¦í­ì¸ì ì‹œê°í™”</a></li>
<li><a href="#63">6.3 ìˆ˜ì¹˜ ì‹¤í—˜ìœ¼ë¡œ í™•ì¸</a></li>
</ul>
</li>
<li><a href="#7">7. ê³ ì°¨ ì •í™•ë„ ì°¨ë¶„ ê³µì‹</a><ul>
<li><a href="#71-4">7.1 4ì°¨ ì •í™•ë„ ê³µì‹</a></li>
<li><a href="#72">7.2 ì°¨ë¶„ ê³„ìˆ˜ ìƒì„±ê¸°</a></li>
</ul>
</li>
<li><a href="#8">8. í¬ì†Œ í–‰ë ¬ì„ ì´ìš©í•œ íš¨ìœ¨ì  êµ¬í˜„</a><ul>
<li><a href="#81-scipysparse">8.1 scipy.sparse ì‚¬ìš©</a></li>
<li><a href="#82-2d">8.2 2D ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬</a></li>
<li><a href="#83">8.3 í¬ì†Œ í–‰ë ¬ ì‹œê°í™”</a></li>
</ul>
</li>
<li><a href="#9">9. ì¢…í•© ì˜ˆì œ: í¬ì•„ì†¡ ë°©ì •ì‹ í’€ì´</a></li>
<li><a href="#10">10. ìš”ì•½</a><ul>
<li><a href="#_2">í•µì‹¬ ê°œë… ì •ë¦¬</a></li>
<li><a href="#_3">ì£¼ìš” ê³µì‹</a></li>
<li><a href="#_4">ë‹¤ìŒ ë‹¨ê³„</a></li>
</ul>
</li>
<li><a href="#_5">ì—°ìŠµë¬¸ì œ</a><ul>
<li><a href="#1_1">ì—°ìŠµ 1: ì°¨ë¶„ ì •í™•ë„ í™•ì¸</a></li>
<li><a href="#2-2">ì—°ìŠµ 2: 2ì°¨ ë¯¸ë¶„ ìˆ˜ì¹˜í•´</a></li>
<li><a href="#3-cfl">ì—°ìŠµ 3: CFL ì¡°ê±´ ê³„ì‚°</a></li>
<li><a href="#4">ì—°ìŠµ 4: í¬ì†Œ í–‰ë ¬ í¬ì•„ì†¡ ë°©ì •ì‹</a></li>
</ul>
</li>
<li><a href="#_6">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="08-finite-difference-method-basics">08. ìœ í•œì°¨ë¶„ë²• ê¸°ì´ˆ (Finite Difference Method Basics)<a class="header-link" href="#08-finite-difference-method-basics" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ìœ í•œì°¨ë¶„ë²•ì˜ ê¸°ë³¸ ì›ë¦¬ ì´í•´</li>
<li>ê²©ì/ë©”ì‰¬ ìƒì„± ë°©ë²• í•™ìŠµ</li>
<li>ì „ë°©/í›„ë°©/ì¤‘ì‹¬ ì°¨ë¶„ì˜ ìœ ë„ì™€ ì •í™•ë„ ë¶„ì„</li>
<li>ì ˆë‹¨ì˜¤ì°¨(Truncation Error) ê°œë… ì´í•´</li>
<li>CFL ì¡°ê±´ê³¼ von Neumann ì•ˆì •ì„± ë¶„ì„</li>
</ul>
<hr />
<h2 id="1">1. ìœ í•œì°¨ë¶„ë²• ì†Œê°œ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ê¸°ë³¸ ì•„ì´ë””ì–´<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ìœ í•œì°¨ë¶„ë²•(Finite Difference Method, FDM)ì€ ë¯¸ë¶„ì„ ìœ í•œí•œ ì°¨ë¶„ìœ¼ë¡œ ê·¼ì‚¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>ë¯¸ë¶„ì˜ ì •ì˜:
f&#39;(x) = lim[hâ†’0] (f(x+h) - f(x)) / h

ìœ í•œì°¨ë¶„ ê·¼ì‚¬ (hê°€ ì‘ì€ ìœ í•œê°’):
f&#39;(x) â‰ˆ (f(x+h) - f(x)) / h
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">finite_difference_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìœ í•œì°¨ë¶„ ê¸°ë³¸ ê°œë… ì‹œì—°&quot;&quot;&quot;</span>

    <span class="c1"># í…ŒìŠ¤íŠ¸ í•¨ìˆ˜: f(x) = sin(x)</span>
    <span class="c1"># ì •í™•í•œ ë¯¸ë¶„: f&#39;(x) = cos(x)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">f_exact</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1"># í…ŒìŠ¤íŠ¸ ì </span>
    <span class="n">h_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í…ŒìŠ¤íŠ¸ í•¨ìˆ˜: f(x) = sin(x), x = Ï€/4&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì •í™•í•œ ë¯¸ë¶„ê°’: f&#39;(Ï€/4) = cos(Ï€/4) = </span><span class="si">{</span><span class="n">f_exact</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;h&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;ì „ë°©ì°¨ë¶„&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;í›„ë°©ì°¨ë¶„&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;ì¤‘ì‹¬ì°¨ë¶„&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">55</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h_values</span><span class="p">:</span>
        <span class="c1"># ì „ë°©ì°¨ë¶„ (Forward Difference)</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">h</span>

        <span class="c1"># í›„ë°©ì°¨ë¶„ (Backward Difference)</span>
        <span class="n">backward</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="n">h</span>

        <span class="c1"># ì¤‘ì‹¬ì°¨ë¶„ (Central Difference)</span>
        <span class="n">central</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">&lt;10.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">forward</span><span class="si">:</span><span class="s2">&lt;15.10f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">backward</span><span class="si">:</span><span class="s2">&lt;15.10f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">central</span><span class="si">:</span><span class="s2">&lt;15.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ê´€ì°°: ì¤‘ì‹¬ì°¨ë¶„ì´ ê°€ì¥ ì •í™•í•©ë‹ˆë‹¤ (2ì°¨ ì •í™•ë„)&quot;</span><span class="p">)</span>

<span class="n">finite_difference_demo</span><span class="p">()</span>
</code></pre></div>

<h3 id="12">1.2 ì™œ ìœ í•œì°¨ë¶„ë²•ì¸ê°€?<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ì¥ì </th>
<th>ë‹¨ì </th>
</tr>
</thead>
<tbody>
<tr>
<td>êµ¬í˜„ì´ ê°„ë‹¨í•¨</td>
<td>ë³µì¡í•œ ê¸°í•˜í˜•ìƒì— ë¶€ì í•©</td>
</tr>
<tr>
<td>ì§ê´€ì  ì´í•´ ê°€ëŠ¥</td>
<td>ë¶ˆê·œì¹™ ê²©ì ì²˜ë¦¬ ì–´ë ¤ì›€</td>
</tr>
<tr>
<td>ê³„ì‚° íš¨ìœ¨ì </td>
<td>êµ­ì†Œ í•´ìƒë„ ì¡°ì ˆ ì œí•œ</td>
</tr>
<tr>
<td>ê³ ì°¨ ì •í™•ë„ ê°€ëŠ¥</td>
<td>ê²½ê³„ì¡°ê±´ ì²˜ë¦¬ ë³µì¡í•  ìˆ˜ ìˆìŒ</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. ê²©ì/ë©”ì‰¬ ìƒì„±<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-1d">2.1 1D ê· ë“± ê²©ì<a class="header-link" href="#21-1d" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_1d_grid</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">nx</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D ê· ë“± ê²©ì ìƒì„±</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    x_min : float - ì‹œì‘ì </span>
<span class="sd">    x_max : float - ëì </span>
<span class="sd">    nx : int - ê²©ìì  ìˆ˜</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    x : array - ê²©ìì  ì¢Œí‘œ</span>
<span class="sd">    dx : float - ê²©ì ê°„ê²©</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span>

<span class="c1"># ì˜ˆì‹œ</span>
<span class="n">x</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">create_1d_grid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²©ìì : </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²©ì ê°„ê²© dx = </span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë‚´ë¶€ ê²©ìì  ìˆ˜: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># ê²½ê³„ ì œì™¸</span>
</code></pre></div>

<h3 id="22-2d">2.2 2D ê· ë“± ê²©ì<a class="header-link" href="#22-2d" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_2d_grid</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2D ê· ë“± ê²©ì ìƒì„±</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    x_range : tuple - (x_min, x_max)</span>
<span class="sd">    y_range : tuple - (y_min, y_max)</span>
<span class="sd">    nx, ny : int - ê° ë°©í–¥ ê²©ìì  ìˆ˜</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    X, Y : 2D arrays - ê²©ìì  ì¢Œí‘œ</span>
<span class="sd">    dx, dy : float - ê²©ì ê°„ê²©</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ny</span><span class="p">)</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>

<span class="c1"># ì˜ˆì‹œ</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">create_2d_grid</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²©ì í¬ê¸°: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dx = </span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">, dy = </span><span class="si">{</span><span class="n">dy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="23">2.3 ì‹œê³µê°„ ê²©ì<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_spacetime_grid</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">t_range</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">nt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì‹œê³µê°„ ê²©ì ìƒì„± (1D ê³µê°„ + ì‹œê°„)</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    x_range : tuple - (x_min, x_max)</span>
<span class="sd">    t_range : tuple - (t_start, t_end)</span>
<span class="sd">    nx : int - ê³µê°„ ê²©ìì  ìˆ˜</span>
<span class="sd">    nt : int - ì‹œê°„ ìŠ¤í… ìˆ˜</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    x, t : arrays - ì¢Œí‘œ</span>
<span class="sd">    dx, dt : float - ê°„ê²©</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">nt</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span>

<span class="c1"># ì˜ˆì‹œ</span>
<span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">create_spacetime_grid</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê³µê°„ ê²©ìì : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">, dx = </span><span class="si">{</span><span class="n">dx</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì‹œê°„ ìŠ¤í…: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="24">2.4 ê²©ì ì‹œê°í™”<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">visualize_grids</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê²©ì ì‹œê°í™”&quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># 1D ê²©ì</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">create_1d_grid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$x_</span><span class="se">{{</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1D ê· ë“± ê²©ì&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;dx = </span><span class="si">{</span><span class="n">dx</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># 2D ê²©ì</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">create_2d_grid</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;2D ê· ë“± ê²©ì&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># ì‹œê³µê°„ ê²©ì</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x_st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">t_st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">X_st</span><span class="p">,</span> <span class="n">T_st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_st</span><span class="p">,</span> <span class="n">t_st</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_st</span><span class="p">,</span> <span class="n">T_st</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_st</span><span class="p">)):</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">t_st</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_st</span><span class="p">)):</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_st</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì‹œê³µê°„ ê²©ì&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (ê³µê°„)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;t (ì‹œê°„)&#39;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°„ ì§„í–‰ ë°©í–¥ í‘œì‹œ</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s1">&#39;ì‹œê°„ ì§„í–‰&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;grids.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># visualize_grids()</span>
</code></pre></div>

<hr />
<h2 id="3">3. ì°¨ë¶„ ê³µì‹ ìœ ë„<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 í…Œì¼ëŸ¬ ì „ê°œ ê¸°ë°˜ ìœ ë„<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>í…Œì¼ëŸ¬ ê¸‰ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì°¨ë¶„ ê³µì‹ì„ ìœ ë„í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>f(x+h) = f(x) + hÂ·f&#39;(x) + (hÂ²/2!)Â·f&#39;&#39;(x) + (hÂ³/3!)Â·f&#39;&#39;&#39;(x) + O(hâ´)
f(x-h) = f(x) - hÂ·f&#39;(x) + (hÂ²/2!)Â·f&#39;&#39;(x) - (hÂ³/3!)Â·f&#39;&#39;&#39;(x) + O(hâ´)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">derive_difference_formulas</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì°¨ë¶„ ê³µì‹ ìœ ë„ ê³¼ì •&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì°¨ë¶„ ê³µì‹ ìœ ë„ (í…Œì¼ëŸ¬ ì „ê°œ)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="c1"># ì „ë°©ì°¨ë¶„ ìœ ë„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[1] ì „ë°©ì°¨ë¶„ (Forward Difference)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f(x+h) = f(x) + hÂ·f&#39;(x) + (hÂ²/2)Â·f&#39;&#39;(x) + O(hÂ³)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì •ë¦¬í•˜ë©´:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f&#39;(x) = [f(x+h) - f(x)] / h - (h/2)Â·f&#39;&#39;(Î¾)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â‰ˆ [f(x+h) - f(x)] / h + O(h)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â†’ 1ì°¨ ì •í™•ë„ (First-order accurate)&quot;</span><span class="p">)</span>

    <span class="c1"># í›„ë°©ì°¨ë¶„ ìœ ë„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[2] í›„ë°©ì°¨ë¶„ (Backward Difference)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f(x-h) = f(x) - hÂ·f&#39;(x) + (hÂ²/2)Â·f&#39;&#39;(x) + O(hÂ³)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì •ë¦¬í•˜ë©´:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f&#39;(x) = [f(x) - f(x-h)] / h + (h/2)Â·f&#39;&#39;(Î¾)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â‰ˆ [f(x) - f(x-h)] / h + O(h)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â†’ 1ì°¨ ì •í™•ë„&quot;</span><span class="p">)</span>

    <span class="c1"># ì¤‘ì‹¬ì°¨ë¶„ ìœ ë„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[3] ì¤‘ì‹¬ì°¨ë¶„ (Central Difference)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f(x+h) - f(x-h) = 2hÂ·f&#39;(x) + (2hÂ³/6)Â·f&#39;&#39;&#39;(x) + O(hâµ)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì •ë¦¬í•˜ë©´:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f&#39;(x) = [f(x+h) - f(x-h)] / 2h - (hÂ²/6)Â·f&#39;&#39;&#39;(Î¾)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â‰ˆ [f(x+h) - f(x-h)] / 2h + O(hÂ²)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â†’ 2ì°¨ ì •í™•ë„ (Second-order accurate)&quot;</span><span class="p">)</span>

    <span class="c1"># 2ì°¨ ë¯¸ë¶„ ì¤‘ì‹¬ì°¨ë¶„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[4] 2ì°¨ ë¯¸ë¶„ ì¤‘ì‹¬ì°¨ë¶„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f(x+h) + f(x-h) = 2f(x) + hÂ²Â·f&#39;&#39;(x) + (hâ´/12)Â·f&#39;&#39;&#39;&#39;(x) + O(hâ¶)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì •ë¦¬í•˜ë©´:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f&#39;&#39;(x) = [f(x+h) - 2f(x) + f(x-h)] / hÂ² + O(hÂ²)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â†’ 2ì°¨ ì •í™•ë„&quot;</span><span class="p">)</span>

<span class="n">derive_difference_formulas</span><span class="p">()</span>
</code></pre></div>

<h3 id="32">3.2 ì°¨ë¶„ ê³µì‹ ìš”ì•½<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<h4 id="1-ux">1ì°¨ ë¯¸ë¶„ (âˆ‚u/âˆ‚x)<a class="header-link" href="#1-ux" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ì´ë¦„</th>
<th>ê³µì‹</th>
<th>ì •í™•ë„</th>
<th>ìŠ¤í…ì‹¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>ì „ë°©ì°¨ë¶„</td>
<td>(u_{i+1} - u_i) / Î”x</td>
<td>O(Î”x)</td>
<td>[i, i+1]</td>
</tr>
<tr>
<td>í›„ë°©ì°¨ë¶„</td>
<td>(u_i - u_{i-1}) / Î”x</td>
<td>O(Î”x)</td>
<td>[i-1, i]</td>
</tr>
<tr>
<td>ì¤‘ì‹¬ì°¨ë¶„</td>
<td>(u_{i+1} - u_{i-1}) / 2Î”x</td>
<td>O(Î”xÂ²)</td>
<td>[i-1, i+1]</td>
</tr>
</tbody>
</table>
<h4 id="2-2ux2">2ì°¨ ë¯¸ë¶„ (âˆ‚Â²u/âˆ‚xÂ²)<a class="header-link" href="#2-2ux2" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ì´ë¦„</th>
<th>ê³µì‹</th>
<th>ì •í™•ë„</th>
</tr>
</thead>
<tbody>
<tr>
<td>ì¤‘ì‹¬ì°¨ë¶„</td>
<td>(u_{i+1} - 2u_i + u_{i-1}) / Î”xÂ²</td>
<td>O(Î”xÂ²)</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">difference_operators</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì°¨ë¶„ ì—°ì‚°ì êµ¬í˜„&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward_diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì „ë°©ì°¨ë¶„: âˆ‚u/âˆ‚x â‰ˆ (u[i+1] - u[i]) / dx&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">backward_diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;í›„ë°©ì°¨ë¶„: âˆ‚u/âˆ‚x â‰ˆ (u[i] - u[i-1]) / dx&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">central_diff_1st</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì¤‘ì‹¬ì°¨ë¶„ (1ì°¨ ë¯¸ë¶„): âˆ‚u/âˆ‚x â‰ˆ (u[i+1] - u[i-1]) / (2*dx)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">central_diff_2nd</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì¤‘ì‹¬ì°¨ë¶„ (2ì°¨ ë¯¸ë¶„): âˆ‚Â²u/âˆ‚xÂ² â‰ˆ (u[i+1] - 2*u[i] + u[i-1]) / dxÂ²&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">return</span> <span class="n">forward_diff</span><span class="p">,</span> <span class="n">backward_diff</span><span class="p">,</span> <span class="n">central_diff_1st</span><span class="p">,</span> <span class="n">central_diff_2nd</span>

<span class="c1"># ë²¡í„°í™”ëœ ë²„ì „</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_diff_operators</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dx</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì „ì²´ ë°°ì—´ì— ì°¨ë¶„ ì—°ì‚°ì ì ìš©&quot;&quot;&quot;</span>

    <span class="c1"># 1ì°¨ ë¯¸ë¶„ (ì¤‘ì‹¬ì°¨ë¶„, ë‚´ë¶€ì )</span>
    <span class="n">du_dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">du_dx</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>
    <span class="c1"># ê²½ê³„: ì „ë°©/í›„ë°© ì°¨ë¶„</span>
    <span class="n">du_dx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
    <span class="n">du_dx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>

    <span class="c1"># 2ì°¨ ë¯¸ë¶„ (ì¤‘ì‹¬ì°¨ë¶„, ë‚´ë¶€ì )</span>
    <span class="n">d2u_dx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">d2u_dx2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">return</span> <span class="n">du_dx</span><span class="p">,</span> <span class="n">d2u_dx2</span>

<span class="c1"># í…ŒìŠ¤íŠ¸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># u = sin(x)</span>

<span class="n">du_dx</span><span class="p">,</span> <span class="n">d2u_dx2</span> <span class="o">=</span> <span class="n">apply_diff_operators</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>

<span class="c1"># ë¹„êµ</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ìœ„ì¹˜ x = Ï€/2ì—ì„œ:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìˆ˜ì¹˜ âˆ‚u/âˆ‚x = </span><span class="si">{</span><span class="n">du_dx</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, ì •í™•ê°’ = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">50</span><span class="p">])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìˆ˜ì¹˜ âˆ‚Â²u/âˆ‚xÂ² = </span><span class="si">{</span><span class="n">d2u_dx2</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, ì •í™•ê°’ = </span><span class="si">{</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">50</span><span class="p">])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="4-truncation-error-analysis">4. ì ˆë‹¨ì˜¤ì°¨ ë¶„ì„ (Truncation Error Analysis)<a class="header-link" href="#4-truncation-error-analysis" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ì ˆë‹¨ì˜¤ì°¨ë€?<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>ì ˆë‹¨ì˜¤ì°¨ëŠ” ë¯¸ë¶„ì„ ì°¨ë¶„ìœ¼ë¡œ ê·¼ì‚¬í•  ë•Œ ì˜ë¼ë‚¸(truncate) ê³ ì°¨ í•­ë“¤ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">truncation_error_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì ˆë‹¨ì˜¤ì°¨ ë¶„ì„&quot;&quot;&quot;</span>

    <span class="c1"># f(x) = sin(x), f&#39;&#39;(x) = -sin(x)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">f_exact</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">f_2nd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">h_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.0125</span><span class="p">])</span>

    <span class="n">errors_forward</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">errors_central</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">h_values</span><span class="p">:</span>
        <span class="c1"># ì „ë°©ì°¨ë¶„ ì˜¤ì°¨</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">h</span>
        <span class="n">err_forward</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">forward</span> <span class="o">-</span> <span class="n">f_exact</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">errors_forward</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err_forward</span><span class="p">)</span>

        <span class="c1"># ì¤‘ì‹¬ì°¨ë¶„ ì˜¤ì°¨</span>
        <span class="n">central</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">err_central</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">central</span> <span class="o">-</span> <span class="n">f_exact</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">errors_central</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err_central</span><span class="p">)</span>

    <span class="n">errors_forward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">errors_forward</span><span class="p">)</span>
    <span class="n">errors_central</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">errors_central</span><span class="p">)</span>

    <span class="c1"># ìˆ˜ë ´ ì°¨ìˆ˜ ê³„ì‚°</span>
    <span class="n">order_forward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">errors_forward</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">errors_forward</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">order_central</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">errors_central</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">errors_central</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì ˆë‹¨ì˜¤ì°¨ ë¶„ì„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;h&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;ì „ë°©ì°¨ë¶„ ì˜¤ì°¨&#39;</span><span class="si">:</span><span class="s2">&lt;18</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;ì°¨ìˆ˜&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;ì¤‘ì‹¬ì°¨ë¶„ ì˜¤ì°¨&#39;</span><span class="si">:</span><span class="s2">&lt;18</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;ì°¨ìˆ˜&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">h_values</span><span class="p">):</span>
        <span class="n">order_f</span> <span class="o">=</span> <span class="n">order_forward</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span>
        <span class="n">order_c</span> <span class="o">=</span> <span class="n">order_central</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">&lt;12.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">errors_forward</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;18.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">order_f</span><span class="si">:</span><span class="s2">&lt;8.2f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">errors_central</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;18.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">order_c</span><span class="si">:</span><span class="s2">&lt;8.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">&lt;12.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">errors_forward</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;18.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">errors_central</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;18.2e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ê²°ë¡ :&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì „ë°©ì°¨ë¶„: O(h) - 1ì°¨ ì •í™•ë„ (hë¥¼ ë°˜ìœ¼ë¡œ ì¤„ì´ë©´ ì˜¤ì°¨ë„ ë°˜)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì¤‘ì‹¬ì°¨ë¶„: O(hÂ²) - 2ì°¨ ì •í™•ë„ (hë¥¼ ë°˜ìœ¼ë¡œ ì¤„ì´ë©´ ì˜¤ì°¨ê°€ 1/4)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">h_values</span><span class="p">,</span> <span class="n">errors_forward</span><span class="p">,</span> <span class="n">errors_central</span>

<span class="n">h_values</span><span class="p">,</span> <span class="n">errors_forward</span><span class="p">,</span> <span class="n">errors_central</span> <span class="o">=</span> <span class="n">truncation_error_analysis</span><span class="p">()</span>
</code></pre></div>

<h3 id="42">4.2 ì˜¤ì°¨ ìˆ˜ë ´ ì‹œê°í™”<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_convergence</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì˜¤ì°¨ ìˆ˜ë ´ ì‹œê°í™”&quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">h_values</span><span class="p">,</span> <span class="n">errors_forward</span><span class="p">,</span> <span class="n">errors_central</span> <span class="o">=</span> <span class="n">truncation_error_analysis</span><span class="p">()</span>

    <span class="c1"># ë¡œê·¸-ë¡œê·¸ í”Œë¡¯</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">errors_forward</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì „ë°©ì°¨ë¶„ (1ì°¨)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">errors_central</span><span class="p">,</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì¤‘ì‹¬ì°¨ë¶„ (2ì°¨)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="c1"># ê¸°ì¤€ì„ </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">h_values</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(h)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">h_values</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(hÂ²)&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;h (ê²©ì ê°„ê²©)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì˜¤ì°¨&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì°¨ë¶„ë²• ì ˆë‹¨ì˜¤ì°¨ ìˆ˜ë ´&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;truncation_error.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># plot_convergence()</span>
</code></pre></div>

<hr />
<h2 id="5-cfl-courant-friedrichs-lewy-condition">5. CFL ì¡°ê±´ (Courant-Friedrichs-Lewy Condition)<a class="header-link" href="#5-cfl-courant-friedrichs-lewy-condition" title="Permanent link">&para;</a></h2>
<h3 id="51-cfl">5.1 CFL ì¡°ê±´ì´ë€?<a class="header-link" href="#51-cfl" title="Permanent link">&para;</a></h3>
<p>CFL ì¡°ê±´ì€ ì‹œê°„ì— ì˜ì¡´í•˜ëŠ” PDEì˜ ìˆ˜ì¹˜í•´ë²•ì—ì„œ ì•ˆì •ì„±ì„ ë³´ì¥í•˜ëŠ” ì¡°ê±´ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>ë¬¼ë¦¬ì  ì˜ë¯¸:
- ìˆ˜ì¹˜ ì •ë³´ ì „íŒŒ ì†ë„ â‰¥ ë¬¼ë¦¬ì  ì •ë³´ ì „íŒŒ ì†ë„

ìˆ˜í•™ì  ì¡°ê±´:
- ì´ë¥˜ë°©ì •ì‹: cÂ·Î”t/Î”x â‰¤ 1 (Courant ìˆ˜ â‰¤ 1)
- ì—´ë°©ì •ì‹: Î±Â·Î”t/Î”xÂ² â‰¤ 1/2
- íŒŒë™ë°©ì •ì‹: cÂ·Î”t/Î”x â‰¤ 1
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cfl_condition_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CFL ì¡°ê±´ ì‹œì—°&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CFL ì¡°ê±´ (Courant-Friedrichs-Lewy)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="c1"># ì´ë¥˜ë°©ì •ì‹</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[1] ì´ë¥˜ë°©ì •ì‹: âˆ‚u/âˆ‚t + cÂ·âˆ‚u/âˆ‚x = 0&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    CFL ì¡°ê±´: C = cÂ·Î”t/Î”x â‰¤ 1&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    â†’ Courant ìˆ˜ Cê°€ 1ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì•„ì•¼ ì•ˆì •&quot;</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># ì „íŒŒì†ë„</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">dt_max</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">c</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ì˜ˆ: c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">, Î”x = </span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ìµœëŒ€ í—ˆìš© Î”t = </span><span class="si">{</span><span class="n">dt_max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì—´ë°©ì •ì‹</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[2] ì—´ë°©ì •ì‹: âˆ‚u/âˆ‚t = Î±Â·âˆ‚Â²u/âˆ‚xÂ² (FTCS)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    CFL ì¡°ê±´: r = Î±Â·Î”t/Î”xÂ² â‰¤ 1/2&quot;</span><span class="p">)</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># ì—´í™•ì‚°ê³„ìˆ˜</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">dt_max</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">alpha</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ì˜ˆ: Î± = </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, Î”x = </span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ìµœëŒ€ í—ˆìš© Î”t = </span><span class="si">{</span><span class="n">dt_max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># íŒŒë™ë°©ì •ì‹</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[3] íŒŒë™ë°©ì •ì‹: âˆ‚Â²u/âˆ‚tÂ² = cÂ²Â·âˆ‚Â²u/âˆ‚xÂ²&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    CFL ì¡°ê±´: C = cÂ·Î”t/Î”x â‰¤ 1&quot;</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">dt_max</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">c</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ì˜ˆ: c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">, Î”x = </span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    ìµœëŒ€ í—ˆìš© Î”t = </span><span class="si">{</span><span class="n">dt_max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">cfl_condition_demo</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-cfl">5.2 CFL ì¡°ê±´ ê³„ì‚°ê¸°<a class="header-link" href="#52-cfl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CFLCalculator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CFL ì¡°ê±´ ê³„ì‚° ë° ê²€ì¦&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">advection</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ì´ë¥˜ë°©ì •ì‹ CFL ìˆ˜ ê³„ì‚°</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        c : float - ì „íŒŒì†ë„</span>
<span class="sd">        dx : float - ê³µê°„ ê²©ì ê°„ê²©</span>
<span class="sd">        dt : float - ì‹œê°„ ê°„ê²©</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        C : float - Courant ìˆ˜</span>
<span class="sd">        stable : bool - ì•ˆì •ì„± ì—¬ë¶€</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">C</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">stable</span> <span class="o">=</span> <span class="n">C</span> <span class="o">&lt;=</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="n">C</span><span class="p">,</span> <span class="n">stable</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">heat_ftcs</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ì—´ë°©ì •ì‹ (FTCS) CFL ìˆ˜ ê³„ì‚°</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        alpha : float - ì—´í™•ì‚°ê³„ìˆ˜</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">stable</span> <span class="o">=</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">stable</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">wave</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;íŒŒë™ë°©ì •ì‹ CFL ìˆ˜ ê³„ì‚°&quot;&quot;&quot;</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">stable</span> <span class="o">=</span> <span class="n">C</span> <span class="o">&lt;=</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="n">C</span><span class="p">,</span> <span class="n">stable</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_dt_advection</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">safety</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì´ë¥˜ë°©ì •ì‹ ìµœëŒ€ í—ˆìš© dt ê³„ì‚°&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">safety</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_dt_heat</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">safety</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì—´ë°©ì •ì‹ (FTCS) ìµœëŒ€ í—ˆìš© dt ê³„ì‚°&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">safety</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">alpha</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_dt_wave</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">safety</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;íŒŒë™ë°©ì •ì‹ ìµœëŒ€ í—ˆìš© dt ê³„ì‚°&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">safety</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">c</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="n">cfl</span> <span class="o">=</span> <span class="n">CFLCalculator</span><span class="p">()</span>

<span class="c1"># ì—´ë°©ì •ì‹ ì˜ˆì‹œ</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="n">r</span><span class="p">,</span> <span class="n">stable</span> <span class="o">=</span> <span class="n">cfl</span><span class="o">.</span><span class="n">heat_ftcs</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì—´ë°©ì •ì‹ CFL ë¶„ì„:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Î± = </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, Î”x = </span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">, Î”t = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  r = Î±Â·Î”t/Î”xÂ² = </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì•ˆì •: </span><span class="si">{</span><span class="n">stable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê¶Œì¥ ìµœëŒ€ Î”t = </span><span class="si">{</span><span class="n">cfl</span><span class="o">.</span><span class="n">max_dt_heat</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6-von-neumann">6. von Neumann ì•ˆì •ì„± ë¶„ì„<a class="header-link" href="#6-von-neumann" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ë¶„ì„ ì›ë¦¬<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>von Neumann ì•ˆì •ì„± ë¶„ì„ì€ í‘¸ë¦¬ì— ëª¨ë“œì˜ ì‹œê°„ì— ë”°ë¥¸ ì„±ì¥ì„ ë¶„ì„í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="err">ê°€ì •</span><span class="o">:</span><span class="w"> </span><span class="n">u_j</span><span class="o">^</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">G</span><span class="o">^</span><span class="n">n</span><span class="w"> </span><span class="err">Â·</span><span class="w"> </span><span class="n">e</span><span class="o">^{</span><span class="n">i</span><span class="err">Â·</span><span class="n">k</span><span class="err">Â·</span><span class="n">j</span><span class="err">Â·Î”</span><span class="n">x</span><span class="o">}</span>

<span class="err">ì—¬ê¸°ì„œ</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">G</span><span class="o">:</span><span class="w"> </span><span class="err">ì¦í­ì¸ì</span><span class="w"> </span><span class="o">(</span><span class="n">amplification</span><span class="w"> </span><span class="n">factor</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="o">:</span><span class="w"> </span><span class="err">íŒŒìˆ˜</span><span class="w"> </span><span class="o">(</span><span class="n">wave</span><span class="w"> </span><span class="n">number</span><span class="o">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="err">ê³µê°„</span><span class="w"> </span><span class="err">ì¸ë±ìŠ¤</span>
<span class="o">-</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="err">ì‹œê°„</span><span class="w"> </span><span class="err">ìŠ¤í…</span>

<span class="err">ì•ˆì •</span><span class="w"> </span><span class="err">ì¡°ê±´</span><span class="o">:</span><span class="w"> </span><span class="o">|</span><span class="n">G</span><span class="o">|</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">(</span><span class="err">ëª¨ë“ </span><span class="w"> </span><span class="n">kì—</span><span class="w"> </span><span class="err">ëŒ€í•´</span><span class="o">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">von_neumann_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;von Neumann ì•ˆì •ì„± ë¶„ì„&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;von Neumann ì•ˆì •ì„± ë¶„ì„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="c1"># FTCS ì—´ë°©ì •ì‹ ë¶„ì„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[ì˜ˆì œ] FTCS ì—´ë°©ì •ì‹&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    u_j^{n+1} = u_j^n + rÂ·(u_{j+1}^n - 2Â·u_j^n + u_{j-1}^n)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì—¬ê¸°ì„œ r = Î±Â·Î”t/Î”xÂ²&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    u_j^n = G^nÂ·e^</span><span class="si">{ikjÎ”x}</span><span class="s2"> ëŒ€ì…:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    GÂ·e^</span><span class="si">{ikjÎ”x}</span><span class="s2"> = e^</span><span class="si">{ikjÎ”x}</span><span class="s2"> + rÂ·(e^{ik(j+1)Î”x} - 2Â·e^</span><span class="si">{ikjÎ”x}</span><span class="s2"> + e^{ik(j-1)Î”x})&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì–‘ë³€ì„ e^</span><span class="si">{ikjÎ”x}</span><span class="s2">ë¡œ ë‚˜ëˆ„ë©´:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    G = 1 + rÂ·(e^</span><span class="si">{ikÎ”x}</span><span class="s2"> + e^{-ikÎ”x} - 2)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      = 1 + rÂ·(2cos(kÎ”x) - 2)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      = 1 - 2rÂ·(1 - cos(kÎ”x))&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      = 1 - 4rÂ·sinÂ²(kÎ”x/2)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì•ˆì • ì¡°ê±´ |G| â‰¤ 1:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    -1 â‰¤ 1 - 4rÂ·sinÂ²(kÎ”x/2) â‰¤ 1&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì™¼ìª½ ë¶€ë“±ì‹ì—ì„œ:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    -2 â‰¤ -4rÂ·sinÂ²(kÎ”x/2)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    4rÂ·sinÂ²(kÎ”x/2) â‰¤ 2&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    sinÂ²(kÎ”x/2)ì˜ ìµœëŒ€ê°’ = 1 (kÎ”x = Ï€):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    4r â‰¤ 2&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    r â‰¤ 1/2&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ê²°ë¡ : FTCS ì—´ë°©ì •ì‹ì€ r = Î±Â·Î”t/Î”xÂ² â‰¤ 1/2 ì¼ ë•Œ ì•ˆì •&quot;</span><span class="p">)</span>

<span class="n">von_neumann_analysis</span><span class="p">()</span>
</code></pre></div>

<h3 id="62">6.2 ì¦í­ì¸ì ì‹œê°í™”<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_amplification_factor</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì¦í­ì¸ì ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># k*dx ë²”ìœ„</span>
    <span class="n">kh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># FTCS ì—´ë°©ì •ì‹ ì¦í­ì¸ì</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">r_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_values</span><span class="p">:</span>
        <span class="n">G</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">kh</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; (ë¶ˆì•ˆì •)&#39;</span> <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span> <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kh</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">kh</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì•ˆì • ì˜ì—­&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;kÎ”x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;G (ì¦í­ì¸ì)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FTCS ì—´ë°©ì •ì‹ ì¦í­ì¸ì</span><span class="se">\n</span><span class="s1">G = 1 - 4rÂ·sinÂ²(kÎ”x/2)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

    <span class="c1"># ì—¬ëŸ¬ ìŠ¤í‚´ ë¹„êµ (ì´ë¥˜ë°©ì •ì‹)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">C</span> <span class="o">=</span> <span class="mf">0.8</span>  <span class="c1"># Courant ìˆ˜</span>

    <span class="c1"># FTCS (ë¶ˆì•ˆì •)</span>
    <span class="n">G_ftcs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">C</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">kh</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kh</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">G_ftcs</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FTCS (ë¶ˆì•ˆì •)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># í’ìƒë²• (Upwind)</span>
    <span class="n">G_upwind</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">kh</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">C</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">kh</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kh</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">G_upwind</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Upwind&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Lax-Friedrichs</span>
    <span class="n">G_lax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">kh</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">C</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">kh</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kh</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">G_lax</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lax-Friedrichs&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì•ˆì • í•œê³„&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;kÎ”x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|G| (ì¦í­ì¸ì í¬ê¸°)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ì´ë¥˜ë°©ì •ì‹ ì¦í­ì¸ì ë¹„êµ (C = </span><span class="si">{</span><span class="n">C</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;amplification_factor.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># plot_amplification_factor()</span>
</code></pre></div>

<h3 id="63">6.3 ìˆ˜ì¹˜ ì‹¤í—˜ìœ¼ë¡œ í™•ì¸<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stability_experiment</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì•ˆì •ì„± ìˆ˜ì¹˜ ì‹¤í—˜&quot;&quot;&quot;</span>

    <span class="c1"># íŒŒë¼ë¯¸í„°</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="mi">51</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>

    <span class="c1"># ì´ˆê¸°ì¡°ê±´</span>
    <span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># FTCS ìŠ¤í‚´</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ftcs_step</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="n">u_new</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">u_new</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">u_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># ê²½ê³„ì¡°ê±´</span>
        <span class="n">u_new</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">u_new</span>

    <span class="c1"># ì—¬ëŸ¬ r ê°’ìœ¼ë¡œ ì‹¤í—˜</span>
    <span class="n">r_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
    <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r_values</span><span class="p">):</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">alpha</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">u0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì´ˆê¸°&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">ftcs_step</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">step</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">99</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;step </span><span class="si">{</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">stable</span> <span class="o">=</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;ì•ˆì •&quot;</span> <span class="k">if</span> <span class="n">stable</span> <span class="k">else</span> <span class="s2">&quot;ë¶ˆì•ˆì •&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">stable</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;stability_experiment.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># stability_experiment()</span>
</code></pre></div>

<hr />
<h2 id="7">7. ê³ ì°¨ ì •í™•ë„ ì°¨ë¶„ ê³µì‹<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-4">7.1 4ì°¨ ì •í™•ë„ ê³µì‹<a class="header-link" href="#71-4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">high_order_formulas</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê³ ì°¨ ì •í™•ë„ ì°¨ë¶„ ê³µì‹&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ê³ ì°¨ ì •í™•ë„ ì°¨ë¶„ ê³µì‹&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="c1"># 1ì°¨ ë¯¸ë¶„ 4ì°¨ ì •í™•ë„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[1] 1ì°¨ ë¯¸ë¶„ (4ì°¨ ì •í™•ë„)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f&#39;(x) â‰ˆ [-f(x+2h) + 8f(x+h) - 8f(x-h) + f(x-2h)] / 12h&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì ˆë‹¨ì˜¤ì°¨: O(hâ´)&quot;</span><span class="p">)</span>

    <span class="c1"># 2ì°¨ ë¯¸ë¶„ 4ì°¨ ì •í™•ë„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[2] 2ì°¨ ë¯¸ë¶„ (4ì°¨ ì •í™•ë„)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    f&#39;&#39;(x) â‰ˆ [-f(x+2h) + 16f(x+h) - 30f(x) + 16f(x-h) - f(x-2h)] / 12hÂ²&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì ˆë‹¨ì˜¤ì°¨: O(hâ´)&quot;</span><span class="p">)</span>

    <span class="c1"># ìˆ˜ì¹˜ ê²€ì¦</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">f_1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">f_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span>

    <span class="c1"># 1ì°¨ ë¯¸ë¶„</span>
    <span class="n">d1_2nd</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>  <span class="c1"># 2ì°¨ ì •í™•ë„</span>
    <span class="n">d1_4th</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>  <span class="c1"># 4ì°¨ ì •í™•ë„</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ìˆ˜ì¹˜ ê²€ì¦ (h = </span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì •í™•í•œ f&#39;(Ï€/4) = </span><span class="si">{</span><span class="n">f_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  2ì°¨ ì •í™•ë„: </span><span class="si">{</span><span class="n">d1_2nd</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">, ì˜¤ì°¨: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">d1_2nd</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  4ì°¨ ì •í™•ë„: </span><span class="si">{</span><span class="n">d1_4th</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">, ì˜¤ì°¨: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">d1_4th</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 2ì°¨ ë¯¸ë¶„</span>
    <span class="n">d2_2nd</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">d2_4th</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">30</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  ì •í™•í•œ f&#39;&#39;(Ï€/4) = </span><span class="si">{</span><span class="n">f_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  2ì°¨ ì •í™•ë„: </span><span class="si">{</span><span class="n">d2_2nd</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">, ì˜¤ì°¨: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">d2_2nd</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  4ì°¨ ì •í™•ë„: </span><span class="si">{</span><span class="n">d2_4th</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">, ì˜¤ì°¨: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">d2_4th</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">high_order_formulas</span><span class="p">()</span>
</code></pre></div>

<h3 id="72">7.2 ì°¨ë¶„ ê³„ìˆ˜ ìƒì„±ê¸°<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">factorial</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_fd_coefficients</span><span class="p">(</span><span class="n">derivative_order</span><span class="p">,</span> <span class="n">accuracy_order</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ìœ í•œì°¨ë¶„ ê³„ìˆ˜ ê³„ì‚°</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    derivative_order : int - ë¯¸ë¶„ ì°¨ìˆ˜ (1=1ì°¨ ë¯¸ë¶„, 2=2ì°¨ ë¯¸ë¶„, ...)</span>
<span class="sd">    accuracy_order : int - ì •í™•ë„ ì°¨ìˆ˜</span>
<span class="sd">    positions : list - ìŠ¤í…ì‹¤ ìœ„ì¹˜ (ê¸°ë³¸: ì¤‘ì‹¬ì°¨ë¶„)</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    coeffs : array - ì°¨ë¶„ ê³„ìˆ˜</span>
<span class="sd">    positions : array - ìŠ¤í…ì‹¤ ìœ„ì¹˜</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="k">if</span> <span class="n">positions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># ì¤‘ì‹¬ì°¨ë¶„ ìŠ¤í…ì‹¤</span>
        <span class="n">n_points</span> <span class="o">=</span> <span class="n">derivative_order</span> <span class="o">+</span> <span class="n">accuracy_order</span>
        <span class="k">if</span> <span class="n">n_points</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n_points</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">half</span> <span class="o">=</span> <span class="n">n_points</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">half</span><span class="p">,</span> <span class="n">half</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Vandermonde í–‰ë ¬ êµ¬ì„±</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">i</span>

    <span class="c1"># ìš°ë³€ ë²¡í„°</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">b</span><span class="p">[</span><span class="n">derivative_order</span><span class="p">]</span> <span class="o">=</span> <span class="n">factorial</span><span class="p">(</span><span class="n">derivative_order</span><span class="p">)</span>

    <span class="c1"># ê³„ìˆ˜ ê³„ì‚°</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">positions</span>

<span class="c1"># ì˜ˆì‹œ: 1ì°¨ ë¯¸ë¶„, 2ì°¨ ì •í™•ë„</span>
<span class="n">coeffs</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">compute_fd_coefficients</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1ì°¨ ë¯¸ë¶„ (2ì°¨ ì •í™•ë„):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìœ„ì¹˜: </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê³„ìˆ˜: </span><span class="si">{</span><span class="n">coeffs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê³µì‹: (</span><span class="si">{</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">Â·f[i-1] + </span><span class="si">{</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">Â·f[i] + </span><span class="si">{</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">Â·f[i+1]) / h&quot;</span><span class="p">)</span>

<span class="c1"># 2ì°¨ ë¯¸ë¶„, 2ì°¨ ì •í™•ë„</span>
<span class="n">coeffs</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">compute_fd_coefficients</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2ì°¨ ë¯¸ë¶„ (2ì°¨ ì •í™•ë„):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìœ„ì¹˜: </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê³„ìˆ˜: </span><span class="si">{</span><span class="n">coeffs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. í¬ì†Œ í–‰ë ¬ì„ ì´ìš©í•œ íš¨ìœ¨ì  êµ¬í˜„<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81-scipysparse">8.1 scipy.sparse ì‚¬ìš©<a class="header-link" href="#81-scipysparse" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">diags</span><span class="p">,</span> <span class="n">csr_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">spsolve</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_laplacian_1d</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">bc_type</span><span class="o">=</span><span class="s1">&#39;dirichlet&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ ìƒì„± (í¬ì†Œ í–‰ë ¬)</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    nx : int - ê²©ìì  ìˆ˜</span>
<span class="sd">    dx : float - ê²©ì ê°„ê²©</span>
<span class="sd">    bc_type : str - ê²½ê³„ì¡°ê±´ ìœ í˜•</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    L : sparse matrix - ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># ë‚´ë¶€ì  ìˆ˜ (ë””ë¦¬í´ë ˆ ê²½ê³„ì¡°ê±´)</span>

    <span class="c1"># ëŒ€ê°ì„  ìš”ì†Œ</span>
    <span class="n">main_diag</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">off_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># í¬ì†Œ í–‰ë ¬ ìƒì„±</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="n">off_diag</span><span class="p">,</span> <span class="n">main_diag</span><span class="p">,</span> <span class="n">off_diag</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">return</span> <span class="n">L</span>

<span class="c1"># ì˜ˆì‹œ</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">create_laplacian_1d</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ í¬ê¸°: </span><span class="si">{</span><span class="n">L</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¹„ì˜ ìš”ì†Œ ìˆ˜: </span><span class="si">{</span><span class="n">L</span><span class="o">.</span><span class="n">nnz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë°€ë„: </span><span class="si">{</span><span class="n">L</span><span class="o">.</span><span class="n">nnz</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í–‰ë ¬ ì¼ë¶€:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">toarray</span><span class="p">()[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>

<h3 id="82-2d">8.2 2D ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬<a class="header-link" href="#82-2d" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_laplacian_2d</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2D ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ ìƒì„± (5ì  ìŠ¤í…ì‹¤)</span>

<span class="sd">    dÂ²u/dxÂ² + dÂ²u/dyÂ² â‰ˆ (u_{i+1,j} - 2u_{i,j} + u_{i-1,j})/dxÂ²</span>
<span class="sd">                       + (u_{i,j+1} - 2u_{i,j} + u_{i,j-1})/dyÂ²</span>

<span class="sd">    í–‰ë ¬ ì¸ë±ì‹±: ë‚´ë¶€ì ì„ í–‰ ìš°ì„ ìœ¼ë¡œ 1Dë¡œ í¼ì¹¨</span>
<span class="sd">    k = (j-1)*(nx-2) + (i-1)  (i, jëŠ” 1-based ë‚´ë¶€ì  ì¸ë±ìŠ¤)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mx</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># x ë°©í–¥ ë‚´ë¶€ì  ìˆ˜</span>
    <span class="n">my</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># y ë°©í–¥ ë‚´ë¶€ì  ìˆ˜</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">mx</span> <span class="o">*</span> <span class="n">my</span>  <span class="c1"># ì´ ë‚´ë¶€ì  ìˆ˜</span>

    <span class="c1"># ê³„ìˆ˜</span>
    <span class="n">cx</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">cy</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">cy</span><span class="p">)</span>

    <span class="c1"># ëŒ€ê°ì„  êµ¬ì„±</span>
    <span class="n">main_diag</span> <span class="o">=</span> <span class="n">cc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">x_diag</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_diag</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">mx</span><span class="p">)</span>

    <span class="c1"># x ë°©í–¥ ì´ì›ƒ ì—°ê²° (í–‰ ê²½ê³„ì—ì„œ ëŠê¹€)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">my</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">my</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">x_diag</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">mx</span> <span class="o">+</span> <span class="n">mx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># í¬ì†Œ í–‰ë ¬ ìƒì„±</span>
    <span class="n">diagonals</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_diag</span><span class="p">,</span> <span class="n">x_diag</span><span class="p">,</span> <span class="n">main_diag</span><span class="p">,</span> <span class="n">x_diag</span><span class="p">,</span> <span class="n">y_diag</span><span class="p">]</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">mx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mx</span><span class="p">]</span>

    <span class="n">L</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">diagonals</span><span class="p">,</span> <span class="n">offsets</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">L</span>

<span class="c1"># ì˜ˆì‹œ</span>
<span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">create_laplacian_2d</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ í¬ê¸°: </span><span class="si">{</span><span class="n">L</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¹„ì˜ ìš”ì†Œ ìˆ˜: </span><span class="si">{</span><span class="n">L</span><span class="o">.</span><span class="n">nnz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë°€ë„: </span><span class="si">{</span><span class="n">L</span><span class="o">.</span><span class="n">nnz</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="83">8.3 í¬ì†Œ í–‰ë ¬ ì‹œê°í™”<a class="header-link" href="#83" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_sparse_matrices</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;í¬ì†Œ í–‰ë ¬ êµ¬ì¡° ì‹œê°í™”&quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># 1D ë¼í”Œë¼ì‹œì•ˆ</span>
    <span class="n">L1d</span> <span class="o">=</span> <span class="n">create_laplacian_1d</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">L1d</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;1D ë¼í”Œë¼ì‹œì•ˆ (n=</span><span class="si">{</span><span class="n">L1d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">ì‚¼ì¤‘ ëŒ€ê° êµ¬ì¡°&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="c1"># 2D ë¼í”Œë¼ì‹œì•ˆ (ì‘ì€ í¬ê¸°)</span>
    <span class="n">L2d</span> <span class="o">=</span> <span class="n">create_laplacian_2d</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">L2d</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;2D ë¼í”Œë¼ì‹œì•ˆ (</span><span class="si">{</span><span class="n">L2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">L2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">5ì¤‘ ëŒ€ê° êµ¬ì¡°&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="c1"># í¬ì†Œì„± ë¹„êµ</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">161</span><span class="p">]</span>
    <span class="n">densities_1d</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">densities_2d</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">:</span>
        <span class="n">L1</span> <span class="o">=</span> <span class="n">create_laplacian_1d</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">densities_1d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L1</span><span class="o">.</span><span class="n">nnz</span> <span class="o">/</span> <span class="p">(</span><span class="n">L1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

        <span class="n">L2</span> <span class="o">=</span> <span class="n">create_laplacian_2d</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">densities_2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L2</span><span class="o">.</span><span class="n">nnz</span> <span class="o">/</span> <span class="p">(</span><span class="n">L2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">densities_1d</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1D ë¼í”Œë¼ì‹œì•ˆ&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">densities_2d</span><span class="p">,</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2D ë¼í”Œë¼ì‹œì•ˆ&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ê²©ì í¬ê¸° n&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;í–‰ë ¬ ë°€ë„ (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;í¬ì†Œ í–‰ë ¬ ë°€ë„</span><span class="se">\n</span><span class="s1">(ê²©ì í¬ê¸°ì— ë”°ë¥¸ ë³€í™”)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sparse_matrices.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># visualize_sparse_matrices()</span>
</code></pre></div>

<hr />
<h2 id="9">9. ì¢…í•© ì˜ˆì œ: í¬ì•„ì†¡ ë°©ì •ì‹ í’€ì´<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">diags</span><span class="p">,</span> <span class="n">csr_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">spsolve</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_poisson_1d</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D í¬ì•„ì†¡ ë°©ì •ì‹ í’€ì´</span>

<span class="sd">    -dÂ²u/dxÂ² = f(x), 0 &lt; x &lt; 1</span>
<span class="sd">    ê²½ê³„ì¡°ê±´: u(0) = 0, u(1) = 0</span>
<span class="sd">    ì†ŒìŠ¤í•­: f(x) = Ï€Â²Â·sin(Ï€x)</span>
<span class="sd">    í•´ì„í•´: u(x) = sin(Ï€x)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># íŒŒë¼ë¯¸í„°</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="mi">101</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>

    <span class="c1"># ì†ŒìŠ¤í•­ (ë‚´ë¶€ì ë§Œ)</span>
    <span class="n">x_inner</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_inner</span><span class="p">)</span>

    <span class="c1"># ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ (-dÂ²/dxÂ²)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">main_diag</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">off_diag</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="n">off_diag</span><span class="p">,</span> <span class="n">main_diag</span><span class="p">,</span> <span class="n">off_diag</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># ì„ í˜• ì‹œìŠ¤í…œ í’€ì´</span>
    <span class="n">u_inner</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="c1"># ì „ì²´ í•´ (ê²½ê³„ì¡°ê±´ í¬í•¨)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_inner</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># ë””ë¦¬í´ë ˆ BC</span>
    <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># í•´ì„í•´</span>
    <span class="n">u_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># ì˜¤ì°¨</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1D í¬ì•„ì†¡ ë°©ì •ì‹ í’€ì´&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê²©ìì : </span><span class="si">{</span><span class="n">nx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìµœëŒ€ ì˜¤ì°¨: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u_exact</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í•´ì„í•´&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ìˆ˜ì¹˜í•´&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;u(x)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1D í¬ì•„ì†¡ ë°©ì •ì‹ í•´&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|ì˜¤ì°¨|&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ìˆ˜ì¹˜í•´ ì˜¤ì°¨ (ìµœëŒ€: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;poisson_1d.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">u_exact</span>

<span class="c1"># x, u, u_exact = solve_poisson_1d()</span>
</code></pre></div>

<hr />
<h2 id="10">10. ìš”ì•½<a class="header-link" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="_2">í•µì‹¬ ê°œë… ì •ë¦¬<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ê°œë…</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td>ìœ í•œì°¨ë¶„ë²•</td>
<td>ë¯¸ë¶„ì„ ìœ í•œí•œ ì°¨ë¶„ìœ¼ë¡œ ê·¼ì‚¬</td>
</tr>
<tr>
<td>ì „ë°©ì°¨ë¶„</td>
<td>(u_{i+1} - u_i)/Î”x, O(Î”x)</td>
</tr>
<tr>
<td>í›„ë°©ì°¨ë¶„</td>
<td>(u_i - u_{i-1})/Î”x, O(Î”x)</td>
</tr>
<tr>
<td>ì¤‘ì‹¬ì°¨ë¶„</td>
<td>(u_{i+1} - u_{i-1})/(2Î”x), O(Î”xÂ²)</td>
</tr>
<tr>
<td>ì ˆë‹¨ì˜¤ì°¨</td>
<td>í…Œì¼ëŸ¬ ì „ê°œì—ì„œ ì˜ë¦° ê³ ì°¨ í•­</td>
</tr>
<tr>
<td>CFL ì¡°ê±´</td>
<td>ìˆ˜ì¹˜ ì•ˆì •ì„±ì„ ìœ„í•œ Î”t/Î”x ì œí•œ</td>
</tr>
<tr>
<td>von Neumann ë¶„ì„</td>
<td>í‘¸ë¦¬ì— ëª¨ë“œ ì¦í­ì¸ì ë¶„ì„</td>
</tr>
<tr>
<td>í¬ì†Œ í–‰ë ¬</td>
<td>ëŒ€ê·œëª¨ ì‹œìŠ¤í…œì˜ íš¨ìœ¨ì  ì €ì¥/ê³„ì‚°</td>
</tr>
</tbody>
</table>
<h3 id="_3">ì£¼ìš” ê³µì‹<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">1</span><span class="n">ì°¨</span><span class="w"> </span><span class="n">ë¯¸ë¶„</span><span class="w"> </span><span class="p">(</span><span class="n">ì¤‘ì‹¬</span><span class="p">):</span><span class="w"> </span><span class="n">f</span><span class="err">&#39;</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">â‰ˆ</span><span class="w"> </span><span class="err">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="err">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">2</span><span class="n">h</span><span class="p">)</span>
<span class="mf">2</span><span class="n">ì°¨</span><span class="w"> </span><span class="n">ë¯¸ë¶„</span><span class="w"> </span><span class="p">(</span><span class="n">ì¤‘ì‹¬</span><span class="p">):</span><span class="w"> </span><span class="n">f</span><span class="err">&#39;&#39;</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">â‰ˆ</span><span class="w"> </span><span class="err">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="err">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">hÂ²</span>

<span class="n">CFL</span><span class="w"> </span><span class="n">ì¡°ê±´</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">ì´ë¥˜ë°©ì •ì‹</span><span class="p">:</span><span class="w"> </span><span class="n">c</span><span class="err">Â·</span><span class="n">Î”t</span><span class="o">/</span><span class="n">Î”x</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="mf">1</span>
<span class="o">-</span><span class="w"> </span><span class="n">ì—´ë°©ì •ì‹</span><span class="w"> </span><span class="p">(</span><span class="n">FTCS</span><span class="p">):</span><span class="w"> </span><span class="n">Î±</span><span class="err">Â·</span><span class="n">Î”t</span><span class="o">/</span><span class="n">Î”xÂ²</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="mf">0.5</span>
<span class="o">-</span><span class="w"> </span><span class="n">íŒŒë™ë°©ì •ì‹</span><span class="p">:</span><span class="w"> </span><span class="n">c</span><span class="err">Â·</span><span class="n">Î”t</span><span class="o">/</span><span class="n">Î”x</span><span class="w"> </span><span class="err">â‰¤</span><span class="w"> </span><span class="mf">1</span>
</code></pre></div>

<h3 id="_4">ë‹¤ìŒ ë‹¨ê³„<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>09ì¥</strong>: ì—´ë°©ì •ì‹ - FTCS, BTCS, Crank-Nicolson</li>
<li><strong>10ì¥</strong>: íŒŒë™ë°©ì •ì‹ - CTCS, ê²½ê³„ì¡°ê±´ ì²˜ë¦¬</li>
<li><strong>11ì¥</strong>: ë¼í”Œë¼ìŠ¤/í¬ì•„ì†¡ - ë°˜ë³µë²•</li>
<li><strong>12ì¥</strong>: ì´ë¥˜ë°©ì •ì‹ - í’ìƒë²•, ìˆ˜ì¹˜ í™•ì‚°</li>
</ol>
<hr />
<h2 id="_5">ì—°ìŠµë¬¸ì œ<a class="header-link" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="1_1">ì—°ìŠµ 1: ì°¨ë¶„ ì •í™•ë„ í™•ì¸<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>f(x) = e^xì— ëŒ€í•´ x = 1ì—ì„œ ì „ë°©/í›„ë°©/ì¤‘ì‹¬ ì°¨ë¶„ì„ ê³„ì‚°í•˜ê³ , h = 0.1, 0.01, 0.001ì—ì„œ ì˜¤ì°¨ë¥¼ ë¹„êµí•˜ì‹œì˜¤.</p>
<h3 id="2-2">ì—°ìŠµ 2: 2ì°¨ ë¯¸ë¶„ ìˆ˜ì¹˜í•´<a class="header-link" href="#2-2" title="Permanent link">&para;</a></h3>
<p>f(x) = xâ´ì— ëŒ€í•´ ì¤‘ì‹¬ì°¨ë¶„ìœ¼ë¡œ f''(x)ë¥¼ ê³„ì‚°í•˜ê³  ì •í™•ê°’ 12xÂ²ì™€ ë¹„êµí•˜ì‹œì˜¤.</p>
<h3 id="3-cfl">ì—°ìŠµ 3: CFL ì¡°ê±´ ê³„ì‚°<a class="header-link" href="#3-cfl" title="Permanent link">&para;</a></h3>
<p>ì—´í™•ì‚°ê³„ìˆ˜ Î± = 0.05, ê²©ì ê°„ê²© Î”x = 0.01ì¼ ë•Œ, FTCS ë°©ë²•ì´ ì•ˆì •í•˜ê¸° ìœ„í•œ ìµœëŒ€ ì‹œê°„ ê°„ê²© Î”të¥¼ êµ¬í•˜ì‹œì˜¤.</p>
<h3 id="4">ì—°ìŠµ 4: í¬ì†Œ í–‰ë ¬ í¬ì•„ì†¡ ë°©ì •ì‹<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>ìœ„ì˜ 1D í¬ì•„ì†¡ ì˜ˆì œë¥¼ ìˆ˜ì •í•˜ì—¬ f(x) = 1 (ìƒìˆ˜)ì¸ ê²½ìš°ì˜ í•´ë¥¼ êµ¬í•˜ì‹œì˜¤. (í•´ì„í•´: u(x) = x(1-x)/2)</p>
<hr />
<h2 id="_6">ì°¸ê³  ìë£Œ<a class="header-link" href="#_6" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>êµì¬</strong>:</li>
<li>LeVeque, "Finite Difference Methods for Ordinary and Partial Differential Equations"</li>
<li>
<p>Strikwerda, "Finite Difference Schemes and Partial Differential Equations"</p>
</li>
<li>
<p><strong>Python ë¼ì´ë¸ŒëŸ¬ë¦¬</strong>:</p>
</li>
<li>scipy.sparse: í¬ì†Œ í–‰ë ¬ ì—°ì‚°</li>
<li>
<p>numpy: ë°°ì—´ ì—°ì‚°</p>
</li>
<li>
<p><strong>ì˜¨ë¼ì¸</strong>:</p>
</li>
<li>MIT OCW 18.336: Numerical Methods for PDEs</li>
</ol>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/07_PDE_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">07. í¸ë¯¸ë¶„ë°©ì •ì‹ ê°œìš” (Partial Differential Equations Overview)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/09_Heat_Equation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">09. ì—´ë°©ì •ì‹ (Heat Equation)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}