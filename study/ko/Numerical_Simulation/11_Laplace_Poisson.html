{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11. ë¼í”Œë¼ìŠ¤ì™€ í¬ì•„ì†¡ ë°©ì •ì‹ (Laplace and Poisson Equations) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Numerical_Simulation/">Numerical Simulation</a>
    <span class="separator">/</span>
    <span class="current">11. ë¼í”Œë¼ìŠ¤ì™€ í¬ì•„ì†¡ ë°©ì •ì‹ (Laplace and Poisson Equations)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>11. ë¼í”Œë¼ìŠ¤ì™€ í¬ì•„ì†¡ ë°©ì •ì‹ (Laplace and Poisson Equations)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/10_Wave_Equation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. íŒŒë™ë°©ì •ì‹ (Wave Equation)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/12_Advection_Equation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. ì´ë¥˜ë°©ì •ì‹ (Advection Equation)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ë¼í”Œë¼ìŠ¤/í¬ì•„ì†¡ ë°©ì •ì‹ ì´ë¡ </a><ul>
<li><a href="#11">1.1 ì •ì˜</a></li>
<li><a href="#12">1.2 ë¬¼ë¦¬ì  ì‘ìš©</a></li>
<li><a href="#13">1.3 ìµœëŒ€ê°’ ì›ë¦¬</a></li>
</ul>
</li>
<li><a href="#2-5-five-point-stencil">2. 5ì  ìŠ¤í…ì‹¤ (Five-Point Stencil)</a><ul>
<li><a href="#21">2.1 ì´ì‚°í™”</a></li>
<li><a href="#22">2.2 ìŠ¤í…ì‹¤ ì‹œê°í™”</a></li>
<li><a href="#23">2.3 í–‰ë ¬ í˜•íƒœ</a></li>
</ul>
</li>
<li><a href="#3">3. ì§ì ‘ í’€ì´ë²•</a><ul>
<li><a href="#31">3.1 í¬ì†Œ í–‰ë ¬ ì§ì ‘ í’€ì´</a></li>
</ul>
</li>
<li><a href="#4-iterative-methods">4. ë°˜ë³µë²• (Iterative Methods)</a><ul>
<li><a href="#41">4.1 ë°˜ë³µë²• ê°œìš”</a></li>
<li><a href="#42-jacobi">4.2 Jacobi ë°˜ë³µë²•</a></li>
<li><a href="#43-gauss-seidel">4.3 Gauss-Seidel ë°˜ë³µë²•</a></li>
<li><a href="#44-sor-successive-over-relaxation">4.4 SOR (Successive Over-Relaxation)</a></li>
</ul>
</li>
<li><a href="#5">5. ìˆ˜ë ´ ë¶„ì„</a><ul>
<li><a href="#51">5.1 ì´ë¡ ì  ìˆ˜ë ´ë¥ </a></li>
<li><a href="#52">5.2 ê²©ì í¬ê¸°ë³„ ë¹„êµ</a></li>
</ul>
</li>
<li><a href="#6">6. ì‹¤ì „ ì‘ìš© ì˜ˆì œ</a><ul>
<li><a href="#61">6.1 ì—´ì „ë„ ë¬¸ì œ</a></li>
<li><a href="#62">6.2 ì •ì „ê¸° ë¬¸ì œ</a></li>
</ul>
</li>
<li><a href="#7">7. ìš”ì•½</a><ul>
<li><a href="#_2">ë°˜ë³µë²• ë¹„êµ</a></li>
<li><a href="#_3">ìµœì  ì™„í™” íŒŒë¼ë¯¸í„°</a></li>
<li><a href="#_4">ë‹¤ìŒ ë‹¨ê³„</a></li>
</ul>
</li>
<li><a href="#_5">ì—°ìŠµë¬¸ì œ</a><ul>
<li><a href="#1-sor">ì—°ìŠµ 1: SOR ìµœì  Ï‰ íƒìƒ‰</a></li>
<li><a href="#2-l">ì—°ìŠµ 2: Lìí˜• ì˜ì—­</a></li>
<li><a href="#3_1">ì—°ìŠµ 3: ë¹„ê· ì§ˆ ì†ŒìŠ¤</a></li>
<li><a href="#4-red-black-gauss-seidel">ì—°ìŠµ 4: Red-Black Gauss-Seidel</a></li>
</ul>
</li>
<li><a href="#_6">ì°¸ê³  ìë£Œ</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="11-laplace-and-poisson-equations">11. ë¼í”Œë¼ìŠ¤ì™€ í¬ì•„ì†¡ ë°©ì •ì‹ (Laplace and Poisson Equations)<a class="header-link" href="#11-laplace-and-poisson-equations" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>íƒ€ì›í˜• PDEì˜ íŠ¹ì„± ì´í•´</li>
<li>5ì  ìŠ¤í…ì‹¤ ìœ í•œì°¨ë¶„ë²• êµ¬í˜„</li>
<li>ë°˜ë³µë²• (Jacobi, Gauss-Seidel, SOR) í•™ìŠµ</li>
<li>ìˆ˜ë ´ ë¶„ì„ ë° ìµœì í™”</li>
<li>scipy.sparseë¥¼ ì´ìš©í•œ íš¨ìœ¨ì  êµ¬í˜„</li>
</ul>
<hr />
<h2 id="1">1. ë¼í”Œë¼ìŠ¤/í¬ì•„ì†¡ ë°©ì •ì‹ ì´ë¡ <a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ì •ì˜<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ë¼í”Œë¼ìŠ¤ ë°©ì •ì‹ (ë™ì°¨):
âˆ‡Â²u = âˆ‚Â²u/âˆ‚xÂ² + âˆ‚Â²u/âˆ‚yÂ² = 0

í¬ì•„ì†¡ ë°©ì •ì‹ (ë¹„ë™ì°¨):
âˆ‡Â²u = âˆ‚Â²u/âˆ‚xÂ² + âˆ‚Â²u/âˆ‚yÂ² = f(x, y)
</code></pre></div>

<h3 id="12">1.2 ë¬¼ë¦¬ì  ì‘ìš©<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ë¶„ì•¼</th>
<th>ë°©ì •ì‹</th>
<th>uì˜ ì˜ë¯¸</th>
</tr>
</thead>
<tbody>
<tr>
<td>ì •ìƒ ì—´ì „ë„</td>
<td>âˆ‡Â²T = 0</td>
<td>ì˜¨ë„</td>
</tr>
<tr>
<td>ì •ì „ê¸°í•™</td>
<td>âˆ‡Â²Ï† = -Ï/Îµ</td>
<td>ì „ìœ„</td>
</tr>
<tr>
<td>ìœ ì²´ ì—­í•™</td>
<td>âˆ‡Â²Ïˆ = -Ï‰</td>
<td>ìœ ë™í•¨ìˆ˜</td>
</tr>
<tr>
<td>ì¤‘ë ¥ì¥</td>
<td>âˆ‡Â²Ï† = 4Ï€GÏ</td>
<td>ì¤‘ë ¥ í¼í…ì…œ</td>
</tr>
<tr>
<td>ë§‰ì˜ ë³€í˜•</td>
<td>âˆ‡Â²w = p/T</td>
<td>ë³€ìœ„</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>

<span class="k">def</span><span class="w"> </span><span class="nf">elliptic_pde_examples</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;íƒ€ì›í˜• PDE ì˜ˆì œ&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;íƒ€ì›í˜• PDE (ë¼í”Œë¼ìŠ¤/í¬ì•„ì†¡) ì‘ìš©&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[1] ì •ìƒ ì—´ì „ë„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    -kâˆ‡Â²T = Q (ì—´ì›)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ê²½ê³„ì—ì„œ ì˜¨ë„ê°€ ê³ ì •ë˜ë©´ ë‚´ë¶€ ì˜¨ë„ ë¶„í¬ ê²°ì •&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[2] ì •ì „ê¸°í•™&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    âˆ‡Â²Ï† = -Ï/Îµâ‚€&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ì „í•˜ ë¶„í¬ê°€ ì£¼ì–´ì§€ë©´ ì „ìœ„ Ï† ê²°ì •&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[3] íƒ„ì„± ë§‰&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Tâˆ‡Â²w = -p (w: ë³€ìœ„, T: ì¥ë ¥, p: ì••ë ¥)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    ê²½ê³„ê°€ ê³ ì •ëœ ë§‰ì— ê· ì¼ ì••ë ¥ ì ìš©&quot;</span><span class="p">)</span>

<span class="n">elliptic_pde_examples</span><span class="p">()</span>
</code></pre></div>

<h3 id="13">1.3 ìµœëŒ€ê°’ ì›ë¦¬<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<p>ë¼í”Œë¼ìŠ¤ ë°©ì •ì‹ì˜ í•´ëŠ” ì˜ì—­ ë‚´ë¶€ì—ì„œ ê·¹ê°’ì„ ê°€ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.
(ìµœëŒ€/ìµœì†ŒëŠ” ê²½ê³„ì—ì„œë§Œ ë°œìƒ)</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">maximum_principle_demo</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìµœëŒ€ê°’ ì›ë¦¬ ì‹œì—°&quot;&quot;&quot;</span>
    <span class="c1"># í•´ì„í•´: u(x,y) = xÂ² - yÂ² (ì¡°í™” í•¨ìˆ˜)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># ë¼í”Œë¼ì‹œì•ˆ = 0</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ë“±ê³ ì„ ë„</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;u(x,y) = xÂ² - yÂ² (ì¡°í™” í•¨ìˆ˜)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># ê²½ê³„ì™€ ë‚´ë¶€ ê°’ ë¹„êµ</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># ê²½ê³„ ê°’ë“¤</span>
    <span class="n">boundary_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># ìœ„/ì•„ë˜ ê²½ê³„</span>
    <span class="n">boundary_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">boundary_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="c1"># ì¢Œ/ìš° ê²½ê³„</span>
    <span class="n">boundary_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">boundary_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="c1"># ë‚´ë¶€ ê°’ë“¤</span>
    <span class="n">interior_values</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">interior_values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë‚´ë¶€&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">boundary_values</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ê²½ê³„ ìµœì†Œ: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">boundary_values</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">boundary_values</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ê²½ê³„ ìµœëŒ€: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">boundary_values</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;u ê°’&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë¹ˆë„&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìµœëŒ€ê°’ ì›ë¦¬: ë‚´ë¶€ê°’ì€ ê²½ê³„ê°’ ì‚¬ì´&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;maximum_principle.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê²½ê³„ ê°’ ë²”ìœ„: [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">boundary_values</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">boundary_values</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë‚´ë¶€ ê°’ ë²”ìœ„: [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">interior_values</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">interior_values</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="c1"># maximum_principle_demo()</span>
</code></pre></div>

<hr />
<h2 id="2-5-five-point-stencil">2. 5ì  ìŠ¤í…ì‹¤ (Five-Point Stencil)<a class="header-link" href="#2-5-five-point-stencil" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ì´ì‚°í™”<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>2D ë¼í”Œë¼ì‹œì•ˆì˜ ì¤‘ì‹¬ì°¨ë¶„:</p>
<div class="highlight"><pre><span></span><code>âˆ‡Â²u â‰ˆ (u_{i+1,j} - 2u_{i,j} + u_{i-1,j})/Î”xÂ²
     + (u_{i,j+1} - 2u_{i,j} + u_{i,j-1})/Î”yÂ²

ë“±ê°„ê²© ê²©ì (Î”x = Î”y = h):
âˆ‡Â²u â‰ˆ (u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4u_{i,j}) / hÂ²
</code></pre></div>

<h3 id="22">2.2 ìŠ¤í…ì‹¤ ì‹œê°í™”<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>           [i, j+1]
              |
              |
  [i-1, j]---[i, j]---[i+1, j]
              |
              |
           [i, j-1]

ê³„ìˆ˜: ì´ì›ƒ 4ê°œ = 1, ì¤‘ì‹¬ = -4
</code></pre></div>

<h3 id="23">2.3 í–‰ë ¬ í˜•íƒœ<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<p>í¬ì•„ì†¡ ë°©ì •ì‹ âˆ‡Â²u = fë¥¼ ì´ì‚°í™”í•˜ë©´ ì„ í˜• ì‹œìŠ¤í…œ Au = bë¥¼ ì–»ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">diags</span><span class="p">,</span> <span class="n">kron</span><span class="p">,</span> <span class="n">eye</span><span class="p">,</span> <span class="n">csr_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">spsolve</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_laplacian_2d</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2D ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ ìƒì„±</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    nx, ny : int - ê° ë°©í–¥ ê²©ìì  ìˆ˜ (ê²½ê³„ í¬í•¨)</span>
<span class="sd">    dx, dy : float - ê²©ì ê°„ê²©</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    A : sparse matrix - ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ (ë‚´ë¶€ì ì— ëŒ€í•´)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ë‚´ë¶€ì  ìˆ˜</span>
    <span class="n">mx</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">my</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">mx</span> <span class="o">*</span> <span class="n">my</span>

    <span class="c1"># 1D ë¼í”Œë¼ì‹œì•ˆ ì—°ì‚°ì</span>
    <span class="c1"># dÂ²/dxÂ² â‰ˆ (1, -2, 1) / dxÂ²</span>
    <span class="n">Dxx</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span> <span class="n">mx</span><span class="p">))</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">Dyy</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">my</span><span class="p">,</span> <span class="n">my</span><span class="p">))</span> <span class="o">/</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># 2D ë¼í”Œë¼ì‹œì•ˆ: í¬ë¡œë„¤ì»¤ ê³±</span>
    <span class="c1"># âˆ‡Â² = dÂ²/dxÂ² âŠ— I_y + I_x âŠ— dÂ²/dyÂ²</span>
    <span class="n">Ix</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>
    <span class="n">Iy</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="n">my</span><span class="p">)</span>

    <span class="n">L</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="n">Iy</span><span class="p">,</span> <span class="n">Dxx</span><span class="p">)</span> <span class="o">+</span> <span class="n">kron</span><span class="p">(</span><span class="n">Dyy</span><span class="p">,</span> <span class="n">Ix</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">L</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_laplacian_2d_explicit</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2D ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ (ëª…ì‹œì  êµ¬ì„±, ë“±ê°„ê²©)</span>

<span class="sd">    ë‚´ë¶€ì  ì¸ë±ì‹±: k = (j-1)*mx + (i-1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mx</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">my</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">mx</span> <span class="o">*</span> <span class="n">my</span>

    <span class="c1"># COO í˜•ì‹ìœ¼ë¡œ êµ¬ì„±</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">my</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mx</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="n">mx</span> <span class="o">+</span> <span class="n">i</span>  <span class="c1"># í˜„ì¬ ì ì˜ 1D ì¸ë±ìŠ¤</span>

            <span class="c1"># ì¤‘ì‹¬ì : -4</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">4.0</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

            <span class="c1"># ì™¼ìª½ ì´ì›ƒ (i-1, j)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

            <span class="c1"># ì˜¤ë¥¸ìª½ ì´ì›ƒ (i+1, j)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

            <span class="c1"># ì•„ë˜ ì´ì›ƒ (i, j-1)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">mx</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

            <span class="c1"># ìœ„ ì´ì›ƒ (i, j+1)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">my</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="n">mx</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">coo_matrix</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">A</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>


<span class="c1"># í…ŒìŠ¤íŠ¸</span>
<span class="n">nx</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">A1</span> <span class="o">=</span> <span class="n">create_laplacian_2d</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">create_laplacian_2d_explicit</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ í¬ê¸°: </span><span class="si">{</span><span class="n">A1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ë¹„ì˜ ìš”ì†Œ ìˆ˜: </span><span class="si">{</span><span class="n">A1</span><span class="o">.</span><span class="n">nnz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">í–‰ë ¬ ë¹„êµ ì˜¤ì°¨: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A2</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="3">3. ì§ì ‘ í’€ì´ë²•<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 í¬ì†Œ í–‰ë ¬ ì§ì ‘ í’€ì´<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">diags</span><span class="p">,</span> <span class="n">kron</span><span class="p">,</span> <span class="n">eye</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">spsolve</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PoissonSolverDirect</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2D í¬ì•„ì†¡ ë°©ì •ì‹ ì§ì ‘ í’€ì´</span>

<span class="sd">    âˆ‡Â²u = f(x, y)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        Lx, Ly : float - ì˜ì—­ í¬ê¸°</span>
<span class="sd">        nx, ny : int - ê²©ìì  ìˆ˜</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span> <span class="o">=</span> <span class="n">Lx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span> <span class="o">=</span> <span class="n">Ly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">ny</span>

        <span class="c1"># ê²©ì ìƒì„±</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="c1"># ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">create_laplacian_2d</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;í¬ì•„ì†¡ ì§ì ‘ í’€ì´ê¸° ì„¤ì •&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ê²©ì: </span><span class="si">{</span><span class="n">nx</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="n">ny</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ë‚´ë¶€ì  ìˆ˜: </span><span class="si">{</span><span class="p">(</span><span class="n">nx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ny</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_func</span><span class="p">,</span> <span class="n">bc_func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        í¬ì•„ì†¡ ë°©ì •ì‹ í’€ì´</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        f_func : callable - ì†ŒìŠ¤í•­ f(x, y)</span>
<span class="sd">        bc_func : callable - ê²½ê³„ì¡°ê±´ u(x, y) at boundary</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        u : 2D array - í•´</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="n">my</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">2</span>

        <span class="c1"># ì†ŒìŠ¤í•­ (ë‚´ë¶€ì )</span>
        <span class="n">X_inner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Y_inner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">f_func</span><span class="p">(</span><span class="n">X_inner</span><span class="p">,</span> <span class="n">Y_inner</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="c1"># ê²½ê³„ì¡°ê±´ ê¸°ì—¬</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># ê²½ê³„ì¡°ê±´ ì ìš©</span>
        <span class="n">u_bc</span> <span class="o">=</span> <span class="n">bc_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span>

        <span class="c1"># ì•„ë˜ ê²½ê³„ (j=0)</span>
        <span class="n">b</span><span class="p">[:</span><span class="n">mx</span><span class="p">]</span> <span class="o">-=</span> <span class="n">u_bc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># ìœ„ ê²½ê³„ (j=ny-1)</span>
        <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="n">mx</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># ì¢Œì¸¡ ê²½ê³„ (i=0)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">my</span><span class="p">):</span>
            <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="o">*</span><span class="n">mx</span><span class="p">]</span> <span class="o">-=</span> <span class="n">u_bc</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># ìš°ì¸¡ ê²½ê³„ (i=nx-1)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">my</span><span class="p">):</span>
            <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="o">*</span><span class="n">mx</span> <span class="o">+</span> <span class="n">mx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">u_bc</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># ì„ í˜• ì‹œìŠ¤í…œ í’€ì´</span>
        <span class="n">u_inner</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

        <span class="c1"># ì „ì²´ í•´ ì¬êµ¬ì„±</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_inner</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">my</span><span class="p">,</span> <span class="n">mx</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">u</span>


<span class="k">def</span><span class="w"> </span><span class="nf">demo_poisson_direct</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;í¬ì•„ì†¡ ì§ì ‘ í’€ì´ ë°ëª¨&quot;&quot;&quot;</span>
    <span class="c1"># ë¬¸ì œ: âˆ‡Â²u = -2Ï€Â²sin(Ï€x)sin(Ï€y)</span>
    <span class="c1"># ê²½ê³„ì¡°ê±´: u = 0</span>
    <span class="c1"># í•´ì„í•´: u(x,y) = sin(Ï€x)sin(Ï€y)</span>

    <span class="n">solver</span> <span class="o">=</span> <span class="n">PoissonSolverDirect</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">f_func</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">Y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bc_func</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f_func</span><span class="p">,</span> <span class="n">bc_func</span><span class="p">)</span>

    <span class="c1"># í•´ì„í•´</span>
    <span class="n">u_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span>

    <span class="c1"># ì˜¤ì°¨</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ìµœëŒ€ ì˜¤ì°¨: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="n">c1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆ˜ì¹˜í•´&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">c2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u_exact</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;í•´ì„í•´&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">c3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ì˜¤ì°¨ (ìµœëŒ€: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;poisson_direct.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">solver</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">u_exact</span>

<span class="c1"># solver, u, u_exact = demo_poisson_direct()</span>
</code></pre></div>

<hr />
<h2 id="4-iterative-methods">4. ë°˜ë³µë²• (Iterative Methods)<a class="header-link" href="#4-iterative-methods" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ë°˜ë³µë²• ê°œìš”<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>ëŒ€ê·œëª¨ ì‹œìŠ¤í…œì—ì„œ ì§ì ‘ í’€ì´ë³´ë‹¤ ë°˜ë³µë²•ì´ íš¨ìœ¨ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>Au = b ë¥¼ u^(k+1) = Mu^(k) + c í˜•íƒœë¡œ ë³€í™˜

ìˆ˜ë ´ ì¡°ê±´: ë°˜ë³µ í–‰ë ¬ Mì˜ ìŠ¤í™íŠ¸ëŸ¼ ë°˜ê²½ Ï(M) &lt; 1
</code></pre></div>

<h3 id="42-jacobi">4.2 Jacobi ë°˜ë³µë²•<a class="header-link" href="#42-jacobi" title="Permanent link">&para;</a></h3>
<p>ê° ì ì˜ ìƒˆ ê°’ì„ ì´ì›ƒë“¤ì˜ ì´ì „ ê°’ìœ¼ë¡œ ê³„ì‚°:</p>
<div class="highlight"><pre><span></span><code>u_{i,j}^(k+1) = (1/4) Â· (u_{i+1,j}^(k) + u_{i-1,j}^(k) + u_{i,j+1}^(k) + u_{i,j-1}^(k) - hÂ²f_{i,j})
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">JacobiSolver</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Jacobi ë°˜ë³µë²•ìœ¼ë¡œ í¬ì•„ì†¡/ë¼í”Œë¼ìŠ¤ ë°©ì •ì‹ í’€ì´</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span> <span class="o">=</span> <span class="n">Lx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span> <span class="o">=</span> <span class="n">Ly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">ny</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="c1"># ë“±ê°„ê²© ê°€ì •</span>
        <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="s2">&quot;ë“±ê°„ê²© ê²©ì í•„ìš”&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Jacobi ë°˜ë³µë²• ì‹¤í–‰</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        f : 2D array - ì†ŒìŠ¤í•­</span>
<span class="sd">        u_bc : 2D array - ê²½ê³„ì¡°ê±´ì´ ì„¤ì •ëœ ì´ˆê¸°ê°’</span>
<span class="sd">        tol : float - ìˆ˜ë ´ í—ˆìš© ì˜¤ì°¨</span>
<span class="sd">        max_iter : int - ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        u : 2D array - í•´</span>
<span class="sd">        residuals : list - ë°˜ë³µë³„ ì”ì°¨</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">u_new</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
            <span class="c1"># Jacobi ì—…ë°ì´íŠ¸ (ë‚´ë¶€ì ë§Œ)</span>
            <span class="n">u_new</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>  <span class="c1"># ì¢Œìš° ì´ì›ƒ</span>
                <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span>  <span class="c1"># ìƒí•˜ ì´ì›ƒ</span>
                <span class="n">h2</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>            <span class="c1"># ì†ŒìŠ¤í•­</span>
            <span class="p">)</span>

            <span class="c1"># ì”ì°¨ ê³„ì‚°</span>
            <span class="n">residual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u_new</span> <span class="o">-</span> <span class="n">u</span><span class="p">))</span>
            <span class="n">residuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residual</span><span class="p">)</span>

            <span class="c1"># ìˆ˜ë ´ í™•ì¸</span>
            <span class="k">if</span> <span class="n">residual</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jacobi ìˆ˜ë ´: </span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> ë°˜ë³µ, ì”ì°¨ = </span><span class="si">{</span><span class="n">residual</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">residuals</span>

            <span class="n">u</span> <span class="o">=</span> <span class="n">u_new</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jacobi: ìµœëŒ€ ë°˜ë³µ ë„ë‹¬, ì”ì°¨ = </span><span class="si">{</span><span class="n">residuals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">residuals</span>


<span class="k">def</span><span class="w"> </span><span class="nf">demo_jacobi</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Jacobi ë°˜ë³µë²• ë°ëª¨&quot;&quot;&quot;</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">JacobiSolver</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">)</span>

    <span class="c1"># ë¼í”Œë¼ìŠ¤ ë°©ì •ì‹ (f = 0)</span>
    <span class="c1"># ê²½ê³„ì¡°ê±´: ìœ„ìª½ ì˜¨ë„ 100, ë‚˜ë¨¸ì§€ 0</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">solver</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>

    <span class="n">u_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">solver</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># ìœ„ìª½ ê²½ê³„</span>

    <span class="n">u</span><span class="p">,</span> <span class="n">residuals</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># í•´</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì˜¨ë„&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¼í”Œë¼ìŠ¤ ë°©ì •ì‹ í•´ (Jacobi)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># ìˆ˜ë ´ ì´ë ¥</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ë°˜ë³µ íšŸìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì”ì°¨&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Jacobi ìˆ˜ë ´ (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span><span class="si">}</span><span class="s1"> ë°˜ë³µ)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;jacobi_demo.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">solver</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">residuals</span>

<span class="c1"># solver, u, residuals = demo_jacobi()</span>
</code></pre></div>

<h3 id="43-gauss-seidel">4.3 Gauss-Seidel ë°˜ë³µë²•<a class="header-link" href="#43-gauss-seidel" title="Permanent link">&para;</a></h3>
<p>ìƒˆë¡œ ê³„ì‚°ëœ ê°’ì„ ì¦‰ì‹œ ì‚¬ìš©:</p>
<div class="highlight"><pre><span></span><code>u_{i,j}^(k+1) = (1/4) Â· (u_{i+1,j}^(k) + u_{i-1,j}^(k+1) + u_{i,j+1}^(k) + u_{i,j-1}^(k+1) - hÂ²f_{i,j})
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GaussSeidelSolver</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gauss-Seidel ë°˜ë³µë²•</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span> <span class="o">=</span> <span class="n">Lx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span> <span class="o">=</span> <span class="n">Ly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">ny</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gauss-Seidel ë°˜ë³µë²• ì‹¤í–‰</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
            <span class="n">max_change</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># Gauss-Seidel ì—…ë°ì´íŠ¸ (ìˆœì„œëŒ€ë¡œ ì¦‰ì‹œ ì—…ë°ì´íŠ¸)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">u_old</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                    <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>  <span class="c1"># ì¢Œìš°</span>
                        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>  <span class="c1"># ìƒí•˜</span>
                        <span class="n">h2</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">max_change</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_change</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u_old</span><span class="p">))</span>

            <span class="n">residuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_change</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">max_change</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gauss-Seidel ìˆ˜ë ´: </span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> ë°˜ë³µ, ì”ì°¨ = </span><span class="si">{</span><span class="n">max_change</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">residuals</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gauss-Seidel: ìµœëŒ€ ë°˜ë³µ ë„ë‹¬, ì”ì°¨ = </span><span class="si">{</span><span class="n">residuals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">residuals</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compare_jacobi_gs</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Jacobi vs Gauss-Seidel ë¹„êµ&quot;&quot;&quot;</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">51</span>

    <span class="c1"># ë™ì¼í•œ ë¬¸ì œ ì„¤ì •</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    <span class="n">u_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="c1"># Jacobi</span>
    <span class="n">jacobi</span> <span class="o">=</span> <span class="n">JacobiSolver</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">)</span>
    <span class="n">u_jacobi</span><span class="p">,</span> <span class="n">res_jacobi</span> <span class="o">=</span> <span class="n">jacobi</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Gauss-Seidel</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GaussSeidelSolver</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">)</span>
    <span class="n">u_gs</span><span class="p">,</span> <span class="n">res_gs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jacobi: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">res_jacobi</span><span class="p">)</span><span class="si">}</span><span class="s2"> ë°˜ë³µ&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gauss-Seidel: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">res_gs</span><span class="p">)</span><span class="si">}</span><span class="s2"> ë°˜ë³µ&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì†ë„ í–¥ìƒ: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">res_jacobi</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">res_gs</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">ë°°&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">res_jacobi</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Jacobi (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">res_jacobi</span><span class="p">)</span><span class="si">}</span><span class="s1"> iter)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">res_gs</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Gauss-Seidel (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">res_gs</span><span class="p">)</span><span class="si">}</span><span class="s1"> iter)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ë°˜ë³µ íšŸìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì”ì°¨&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Jacobi vs Gauss-Seidel ìˆ˜ë ´ ë¹„êµ&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;jacobi_vs_gs.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">res_jacobi</span><span class="p">,</span> <span class="n">res_gs</span>

<span class="c1"># res_jacobi, res_gs = compare_jacobi_gs()</span>
</code></pre></div>

<h3 id="44-sor-successive-over-relaxation">4.4 SOR (Successive Over-Relaxation)<a class="header-link" href="#44-sor-successive-over-relaxation" title="Permanent link">&para;</a></h3>
<p>ê³¼ì™„í™” íŒŒë¼ë¯¸í„° Ï‰ë¥¼ ë„ì…í•˜ì—¬ ìˆ˜ë ´ ê°€ì†:</p>
<div class="highlight"><pre><span></span><code>u_{i,j}^(k+1) = (1-Ï‰)Â·u_{i,j}^(k) + Ï‰Â·(Gauss-Seidel ê°’)

ìµœì  Ï‰ â‰ˆ 2 / (1 + sin(Ï€h))  (h: ê²©ì ê°„ê²©, ì •ì‚¬ê° ì˜ì—­)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SORSolver</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SOR (Successive Over-Relaxation) ë°©ë²•</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span> <span class="o">=</span> <span class="n">Lx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span> <span class="o">=</span> <span class="n">Ly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">ny</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span>

        <span class="c1"># ìµœì  ì™„í™” íŒŒë¼ë¯¸í„° (ì •ì‚¬ê° ì˜ì—­)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega_opt</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SOR ìµœì  Ï‰ = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">omega_opt</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SOR ë°˜ë³µë²• ì‹¤í–‰</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        omega : float - ì™„í™” íŒŒë¼ë¯¸í„° (Noneì´ë©´ ìµœì ê°’ ì‚¬ìš©)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">omega</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega_opt</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
            <span class="n">max_change</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">u_old</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>

                    <span class="c1"># Gauss-Seidel ê°’</span>
                    <span class="n">u_gs</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">h2</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                    <span class="p">)</span>

                    <span class="c1"># SOR ì—…ë°ì´íŠ¸</span>
                    <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">u_old</span> <span class="o">+</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">u_gs</span>

                    <span class="n">max_change</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_change</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u_old</span><span class="p">))</span>

            <span class="n">residuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_change</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">max_change</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SOR (Ï‰=</span><span class="si">{</span><span class="n">omega</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) ìˆ˜ë ´: </span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> ë°˜ë³µ, ì”ì°¨ = </span><span class="si">{</span><span class="n">max_change</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">residuals</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SOR: ìµœëŒ€ ë°˜ë³µ ë„ë‹¬, ì”ì°¨ = </span><span class="si">{</span><span class="n">residuals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">residuals</span>


<span class="k">def</span><span class="w"> </span><span class="nf">demo_sor</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;SOR ë°ëª¨: ë‹¤ì–‘í•œ Ï‰ ê°’ ë¹„êµ&quot;&quot;&quot;</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">51</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    <span class="n">u_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">sor_solver</span> <span class="o">=</span> <span class="n">SORSolver</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">)</span>

    <span class="n">omega_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="n">sor_solver</span><span class="o">.</span><span class="n">omega_opt</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">omega</span> <span class="ow">in</span> <span class="n">omega_values</span><span class="p">:</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">sor_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="n">omega</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ï‰ = </span><span class="si">{</span><span class="n">omega</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="si">}</span><span class="s2"> ë°˜ë³µ&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">omega_values</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">omega</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">omega_values</span><span class="p">):</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">omega</span><span class="p">]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Ï‰ = </span><span class="si">{</span><span class="n">omega</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; (ìµœì )&#39;</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">omega</span> <span class="o">-</span> <span class="n">sor_solver</span><span class="o">.</span><span class="n">omega_opt</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="si">}</span><span class="s1"> iter&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ë°˜ë³µ íšŸìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì”ì°¨&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SOR: ì™„í™” íŒŒë¼ë¯¸í„° Ï‰ì— ë”°ë¥¸ ìˆ˜ë ´&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sor_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># results = demo_sor()</span>
</code></pre></div>

<hr />
<h2 id="5">5. ìˆ˜ë ´ ë¶„ì„<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ì´ë¡ ì  ìˆ˜ë ´ë¥ <a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ë°©ë²•</th>
<th>ë°˜ë³µ í–‰ë ¬ ìŠ¤í™íŠ¸ëŸ¼ ë°˜ê²½</th>
<th>ìˆ˜ë ´ë¥ </th>
</tr>
</thead>
<tbody>
<tr>
<td>Jacobi</td>
<td>cos(Ï€h)</td>
<td>ëŠë¦¼</td>
</tr>
<tr>
<td>Gauss-Seidel</td>
<td>cosÂ²(Ï€h)</td>
<td>2ë°° ë¹ ë¦„</td>
</tr>
<tr>
<td>SOR (ìµœì )</td>
<td>1 - 2Ï€h</td>
<td>í›¨ì”¬ ë¹ ë¦„</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convergence_rate_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìˆ˜ë ´ë¥  ì´ë¡  ë¶„ì„&quot;&quot;&quot;</span>
    <span class="n">h_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">80</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">160</span><span class="p">])</span>

    <span class="c1"># ì´ë¡ ì  ìŠ¤í™íŠ¸ëŸ¼ ë°˜ê²½</span>
    <span class="n">rho_jacobi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">h_values</span><span class="p">)</span>
    <span class="n">rho_gs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">h_values</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">omega_opt</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">h_values</span><span class="p">))</span>
    <span class="n">rho_sor</span> <span class="o">=</span> <span class="n">omega_opt</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># ìµœì  SOR</span>

    <span class="c1"># ìˆ˜ë ´ì— í•„ìš”í•œ ë°˜ë³µ íšŸìˆ˜ (ì”ì°¨ë¥¼ 1e-6ìœ¼ë¡œ ì¤„ì´ê¸°)</span>
    <span class="n">target_reduction</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>  <span class="c1"># ln(10^6)</span>

    <span class="n">iter_jacobi</span> <span class="o">=</span> <span class="n">target_reduction</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rho_jacobi</span><span class="p">))</span>
    <span class="n">iter_gs</span> <span class="o">=</span> <span class="n">target_reduction</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rho_gs</span><span class="p">))</span>
    <span class="n">iter_sor</span> <span class="o">=</span> <span class="n">target_reduction</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rho_sor</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ìˆ˜ë ´ ì´ë¡  ë¶„ì„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;h&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;n=1/h&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Jacobi&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;G-S&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;SOR&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">h_values</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">&lt;10.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">iter_jacobi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;12.0f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">iter_gs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;12.0f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">iter_sor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;12.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">n_values</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">h_values</span>

    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho_jacobi</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho_gs</span><span class="p">,</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gauss-Seidel&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho_sor</span><span class="p">,</span> <span class="s1">&#39;^-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOR (ìµœì )&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n = 1/h&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;1 - Ï (ìˆ˜ë ´ ì¸ì)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìŠ¤í™íŠ¸ëŸ¼ ë°˜ê²½&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="n">iter_jacobi</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="n">iter_gs</span><span class="p">,</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gauss-Seidel&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="n">iter_sor</span><span class="p">,</span> <span class="s1">&#39;^-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOR (ìµœì )&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="n">n_values</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(nÂ²)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="n">n_values</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(n)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n = 1/h&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;í•„ìš” ë°˜ë³µ íšŸìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆ˜ë ´ì— í•„ìš”í•œ ë°˜ë³µ&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;convergence_analysis.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># convergence_rate_analysis()</span>
</code></pre></div>

<h3 id="52">5.2 ê²©ì í¬ê¸°ë³„ ë¹„êµ<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">grid_size_comparison</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê²©ì í¬ê¸°ë³„ ë°˜ë³µë²• ë¹„êµ&quot;&quot;&quot;</span>
    <span class="n">grid_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;GS&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;SOR&#39;</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">grid_sizes</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">u_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="c1"># Jacobi</span>
        <span class="n">solver</span> <span class="o">=</span> <span class="n">JacobiSolver</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>

        <span class="c1"># Gauss-Seidel</span>
        <span class="n">solver</span> <span class="o">=</span> <span class="n">GaussSeidelSolver</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;GS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>

        <span class="c1"># SOR</span>
        <span class="n">solver</span> <span class="o">=</span> <span class="n">SORSolver</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;SOR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: Jacobi=</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, GS=</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;GS&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, SOR=</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;SOR&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">grid_sizes</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">grid_sizes</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;GS&#39;</span><span class="p">],</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gauss-Seidel&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">grid_sizes</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;SOR&#39;</span><span class="p">],</span> <span class="s1">&#39;^-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOR (ìµœì )&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="c1"># ê¸°ì¤€ì„ </span>
    <span class="n">n_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_sizes</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_ref</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">n_ref</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(nÂ²)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n_ref</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n_ref</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(n)&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ê²©ì í¬ê¸° n&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ë°˜ë³µ íšŸìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê²©ì í¬ê¸°ì— ë”°ë¥¸ ìˆ˜ë ´ ë¹„êµ&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;grid_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># results = grid_size_comparison()</span>
</code></pre></div>

<hr />
<h2 id="6">6. ì‹¤ì „ ì‘ìš© ì˜ˆì œ<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ì—´ì „ë„ ë¬¸ì œ<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">heat_conduction_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;2D ì •ìƒ ì—´ì „ë„ ë¬¸ì œ&quot;&quot;&quot;</span>
    <span class="c1"># ì •ì‚¬ê°í˜• íŒ, ê° ë³€ì˜ ì˜¨ë„ê°€ ë‹¤ë¦„</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">51</span>

    <span class="n">solver</span> <span class="o">=</span> <span class="n">SORSolver</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">)</span>

    <span class="c1"># ì†ŒìŠ¤í•­: ë‚´ë¶€ ì—´ì› ì—†ìŒ</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>

    <span class="c1"># ê²½ê³„ì¡°ê±´</span>
    <span class="n">u_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c1"># ì•„ë˜: 0Â°C</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># ìœ„: 100Â°C</span>
    <span class="n">u_bc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>     <span class="c1"># ì™¼ìª½: 50Â°C</span>
    <span class="n">u_bc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>    <span class="c1"># ì˜¤ë¥¸ìª½: 50Â°C</span>

    <span class="c1"># ëª¨ì„œë¦¬ ì²˜ë¦¬ (í‰ê· )</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">75</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">75</span>

    <span class="n">u</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u_bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ë“±ê³ ì„ </span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì˜¨ë„ (Â°C)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì •ìƒ ì—´ì „ë„ (ì˜¨ë„ ë¶„í¬)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># ì—´ìœ ì† ë²¡í„°</span>
    <span class="c1"># q = -kâˆ‡T</span>
    <span class="n">qx</span><span class="p">,</span> <span class="n">qy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span>
    <span class="n">qx</span> <span class="o">=</span> <span class="o">-</span><span class="n">qx</span>
    <span class="n">qy</span> <span class="o">=</span> <span class="o">-</span><span class="n">qy</span>

    <span class="n">skip</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
                   <span class="n">qx</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">qy</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
                   <span class="n">scale</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì—´ìœ ì† ë²¡í„°&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;heat_conduction.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">solver</span><span class="p">,</span> <span class="n">u</span>

<span class="c1"># solver, u = heat_conduction_example()</span>
</code></pre></div>

<h3 id="62">6.2 ì •ì „ê¸° ë¬¸ì œ<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">electrostatic_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì •ì „ê¸° ë¬¸ì œ: ë‘ ë„ì²´ ì‚¬ì´ì˜ ì „ìœ„&quot;&quot;&quot;</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">81</span>

    <span class="n">solver</span> <span class="o">=</span> <span class="n">SORSolver</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">)</span>

    <span class="c1"># ê²½ê³„ì¡°ê±´: ëª¨ë“  ì™¸ë¶€ ê²½ê³„ ì ‘ì§€ (0V)</span>
    <span class="n">u_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>

    <span class="c1"># ë‚´ë¶€ì— ë‘ ê°œì˜ ì›í˜• ë„ì²´</span>
    <span class="c1"># ë„ì²´ 1: ì¤‘ì‹¬ (0.3, 0.5), ë°˜ì§€ë¦„ 0.1, ì „ìœ„ +100V</span>
    <span class="c1"># ë„ì²´ 2: ì¤‘ì‹¬ (0.7, 0.5), ë°˜ì§€ë¦„ 0.1, ì „ìœ„ -100V</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_inside_conductor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">cx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">conductor1_mask</span> <span class="o">=</span> <span class="n">is_inside_conductor</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">)</span>
    <span class="n">conductor2_mask</span> <span class="o">=</span> <span class="n">is_inside_conductor</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">)</span>

    <span class="n">u_bc</span><span class="p">[</span><span class="n">conductor1_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">u_bc</span><span class="p">[</span><span class="n">conductor2_mask</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>

    <span class="c1"># ì†ŒìŠ¤í•­: ì „í•˜ ì—†ìŒ (ë¼í”Œë¼ìŠ¤)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>

    <span class="c1"># í’€ì´ (ë„ì²´ ë‚´ë¶€ëŠ” ê²½ê³„ì¡°ê±´ìœ¼ë¡œ ê³ ì •)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">u_bc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
        <span class="n">u_new</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># ë„ì²´ ë‚´ë¶€ëŠ” ê±´ë„ˆëœ€</span>
                <span class="k">if</span> <span class="n">conductor1_mask</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="n">conductor2_mask</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]:</span>
                    <span class="k">continue</span>

                <span class="n">u_new</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u_new</span> <span class="o">-</span> <span class="n">u</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">u_new</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># ì „ê¸°ì¥ ê³„ì‚°: E = -âˆ‡Ï†</span>
    <span class="n">Ey</span><span class="p">,</span> <span class="n">Ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">Ex</span> <span class="o">=</span> <span class="o">-</span><span class="n">Ex</span>
    <span class="n">Ey</span> <span class="o">=</span> <span class="o">-</span><span class="n">Ey</span>
    <span class="n">E_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ex</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Ey</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ì „ìœ„</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì „ìœ„ (V)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ë„ì²´ í‘œì‹œ</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.3</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.7</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „ìœ„ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># ì „ê¸°ì¥</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">E_mag</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
    <span class="n">skip</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.3</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.7</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „ê¸°ì¥ (ìœ ì„ )&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;electrostatic.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">solver</span><span class="p">,</span> <span class="n">u</span>

<span class="c1"># solver, u = electrostatic_example()</span>
</code></pre></div>

<hr />
<h2 id="7">7. ìš”ì•½<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="_2">ë°˜ë³µë²• ë¹„êµ<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ë°©ë²•</th>
<th>íŠ¹ì§•</th>
<th>ìˆ˜ë ´ ì†ë„</th>
<th>ë©”ëª¨ë¦¬</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jacobi</td>
<td>ë³‘ë ¬í™” ìš©ì´</td>
<td>O(nÂ²) ë°˜ë³µ</td>
<td>2ë°° ì €ì¥</td>
</tr>
<tr>
<td>Gauss-Seidel</td>
<td>ìˆœì°¨ ì—…ë°ì´íŠ¸</td>
<td>2ë°° ë¹ ë¦„</td>
<td>ì œìë¦¬</td>
</tr>
<tr>
<td>SOR</td>
<td>ê³¼ì™„í™” ê°€ì†</td>
<td>O(n) ë°˜ë³µ</td>
<td>ì œìë¦¬</td>
</tr>
<tr>
<td>ì§ì ‘ë²•</td>
<td>í•œ ë²ˆì— í’€ì´</td>
<td>-</td>
<td>O(nÂ²) ì €ì¥</td>
</tr>
</tbody>
</table>
<h3 id="_3">ìµœì  ì™„í™” íŒŒë¼ë¯¸í„°<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Ï‰_opt = 2 / (1 + sin(Ï€h))

ì˜ˆ: h = 1/50 â†’ Ï‰_opt â‰ˆ 1.937
</code></pre></div>

<h3 id="_4">ë‹¤ìŒ ë‹¨ê³„<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>12ì¥</strong>: ì´ë¥˜ë°©ì •ì‹ - 1ì°¨ ìŒê³¡ì„ í˜• PDE</li>
<li>ë‹¤ì¤‘ê²©ìë²• (Multigrid) - ë” ë¹ ë¥¸ ìˆ˜ë ´</li>
<li>ì¼¤ë ˆê¸°ìš¸ê¸°ë²• (CG) - ëŒ€ê·œëª¨ ì‹œìŠ¤í…œ</li>
</ol>
<hr />
<h2 id="_5">ì—°ìŠµë¬¸ì œ<a class="header-link" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="1-sor">ì—°ìŠµ 1: SOR ìµœì  Ï‰ íƒìƒ‰<a class="header-link" href="#1-sor" title="Permanent link">&para;</a></h3>
<p>ë‹¤ì–‘í•œ ê²©ì í¬ê¸°ì—ì„œ ì‹¤í—˜ì ìœ¼ë¡œ ìµœì  Ï‰ë¥¼ ì°¾ê³  ì´ë¡ ê°’ê³¼ ë¹„êµí•˜ì‹œì˜¤.</p>
<h3 id="2-l">ì—°ìŠµ 2: Lìí˜• ì˜ì—­<a class="header-link" href="#2-l" title="Permanent link">&para;</a></h3>
<p>Lìí˜• ì˜ì—­ì—ì„œ ë¼í”Œë¼ìŠ¤ ë°©ì •ì‹ì„ í’€ì–´ë³´ì‹œì˜¤.</p>
<h3 id="3_1">ì—°ìŠµ 3: ë¹„ê· ì§ˆ ì†ŒìŠ¤<a class="header-link" href="#3_1" title="Permanent link">&para;</a></h3>
<p>f(x,y) = sin(2Ï€x)Â·sin(2Ï€y)ì¸ í¬ì•„ì†¡ ë°©ì •ì‹ì„ í’€ê³  í•´ì„í•´ì™€ ë¹„êµí•˜ì‹œì˜¤.</p>
<h3 id="4-red-black-gauss-seidel">ì—°ìŠµ 4: Red-Black Gauss-Seidel<a class="header-link" href="#4-red-black-gauss-seidel" title="Permanent link">&para;</a></h3>
<p>ì²´ìŠ¤íŒ íŒ¨í„´ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” Red-Black G-Së¥¼ êµ¬í˜„í•˜ì‹œì˜¤.</p>
<hr />
<h2 id="_6">ì°¸ê³  ìë£Œ<a class="header-link" href="#_6" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>êµì¬</strong>: LeVeque, "Finite Difference Methods"</li>
<li><strong>ë°˜ë³µë²•</strong>: Saad, "Iterative Methods for Sparse Linear Systems"</li>
<li><strong>Python</strong>: scipy.sparse, scipy.sparse.linalg</li>
</ol>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/10_Wave_Equation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">10. íŒŒë™ë°©ì •ì‹ (Wave Equation)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/12_Advection_Equation.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">12. ì´ë¥˜ë°©ì •ì‹ (Advection Equation)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}