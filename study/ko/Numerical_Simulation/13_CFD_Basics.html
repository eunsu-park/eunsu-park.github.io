{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13. CFD ê¸°ì´ˆ (Computational Fluid Dynamics Basics) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Numerical_Simulation/">Numerical Simulation</a>
    <span class="separator">/</span>
    <span class="current">13. CFD ê¸°ì´ˆ (Computational Fluid Dynamics Basics)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>13. CFD ê¸°ì´ˆ (Computational Fluid Dynamics Basics)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/12_Advection_Equation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">12. ì´ë¥˜ë°©ì •ì‹ (Advection Equation)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/14_Incompressible_Flow.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">14. ë¹„ì••ì¶•ì„± ìœ ë™ (Incompressible Flow)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ìœ ì²´ì—­í•™ ê¸°ì´ˆ</a><ul>
<li><a href="#11">1.1 ì—°ì†ì²´ ê°€ì •</a></li>
<li><a href="#12">1.2 ê¸°ë³¸ ë¬¼ì„±ì¹˜</a></li>
<li><a href="#13-reynolds-number">1.3 ë ˆì´ë†€ì¦ˆ ìˆ˜ (Reynolds Number)</a></li>
</ul>
</li>
<li><a href="#2">2. ì§€ë°°ë°©ì •ì‹</a><ul>
<li><a href="#21-continuity-equation">2.1 ì—°ì† ë°©ì •ì‹ (Continuity Equation)</a></li>
<li><a href="#22-momentum-equation">2.2 ìš´ë™ëŸ‰ ë°©ì •ì‹ (Momentum Equation)</a></li>
<li><a href="#23-navier-stokes">2.3 Navier-Stokes ë°©ì •ì‹ ìœ ë„</a></li>
</ul>
</li>
<li><a href="#3-vs">3. ì••ì¶•ì„± vs ë¹„ì••ì¶•ì„± ìœ ë™</a><ul>
<li><a href="#31">3.1 ë§ˆí•˜ ìˆ˜ì™€ ì••ì¶•ì„±</a></li>
</ul>
</li>
<li><a href="#4">4. ê²½ê³„ì¸µ ì´ë¡ </a><ul>
<li><a href="#41">4.1 ê²½ê³„ì¸µ ê°œë…</a></li>
</ul>
</li>
<li><a href="#5-cfd-poiseuille">5. ê°„ë‹¨í•œ CFD ì˜ˆì œ: Poiseuille ìœ ë™</a><ul>
<li><a href="#51-2d-poiseuille-flow">5.1 2D ì±„ë„ ìœ ë™ (Poiseuille Flow)</a></li>
<li><a href="#52-cfd">5.2 ìœ í•œì°¨ë¶„ë²•ì„ ì´ìš©í•œ CFD êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#6-cfd">6. CFDì˜ ì£¼ìš” ê³¼ì œ</a><ul>
<li><a href="#61-mesh-generation">6.1 ê²©ì ìƒì„± (Mesh Generation)</a></li>
<li><a href="#62">6.2 ë‚œë¥˜ ëª¨ë¸ë§</a></li>
</ul>
</li>
<li><a href="#7">7. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1_1">ì—°ìŠµ 1: ë ˆì´ë†€ì¦ˆ ìˆ˜ ê³„ì‚°</a></li>
<li><a href="#2-poiseuille">ì—°ìŠµ 2: Poiseuille ìœ ë™</a></li>
<li><a href="#3">ì—°ìŠµ 3: ê²½ê³„ì¸µ ë‘ê»˜</a></li>
<li><a href="#4-cfd">ì—°ìŠµ 4: CFD ê²©ì ì˜ì¡´ì„±</a></li>
</ul>
</li>
<li><a href="#8">8. ì°¸ê³ ìë£Œ</a><ul>
<li><a href="#_2">í•µì‹¬ êµì¬</a></li>
<li><a href="#cfd">CFD ì†Œí”„íŠ¸ì›¨ì–´</a></li>
<li><a href="#_3">ì˜¨ë¼ì¸ ìë£Œ</a></li>
</ul>
</li>
<li><a href="#_4">ìš”ì•½</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="13-cfd-computational-fluid-dynamics-basics">13. CFD ê¸°ì´ˆ (Computational Fluid Dynamics Basics)<a class="header-link" href="#13-cfd-computational-fluid-dynamics-basics" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ìœ ì²´ì—­í•™ì˜ ê¸°ë³¸ ì›ë¦¬ì™€ ì§€ë°°ë°©ì •ì‹ ì´í•´</li>
<li>ë ˆì´ë†€ì¦ˆ ìˆ˜ì™€ ìœ ë™ íŠ¹ì„± ê´€ê³„ íŒŒì•…</li>
<li>Navier-Stokes ë°©ì •ì‹ì˜ ìœ ë„ì™€ ì˜ë¯¸ ì´í•´</li>
<li>ì••ì¶•ì„±/ë¹„ì••ì¶•ì„± ìœ ë™ êµ¬ë¶„</li>
<li>ê²½ê³„ì¸µ ê°œë… í•™ìŠµ</li>
<li>ê°„ë‹¨í•œ ì±„ë„ ìœ ë™ CFD êµ¬í˜„</li>
</ul>
<hr />
<h2 id="1">1. ìœ ì²´ì—­í•™ ê¸°ì´ˆ<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ì—°ì†ì²´ ê°€ì •<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ì—°ì†ì²´ ê°€ì • (Continuum Hypothesis):
- ìœ ì²´ë¥¼ ì—°ì†ì ì¸ ë§¤ì§ˆë¡œ ì·¨ê¸‰
- ê°œë³„ ë¶„ì ëŒ€ì‹  ìœ ì²´ ì…ì(fluid particle) ê°œë… ì‚¬ìš©
- Knudsen ìˆ˜ Kn = Î»/L &lt;&lt; 1 ì¼ ë•Œ ìœ íš¨
  (Î»: í‰ê·  ììœ  ê²½ë¡œ, L: íŠ¹ì„± ê¸¸ì´)
</code></pre></div>

<h3 id="12">1.2 ê¸°ë³¸ ë¬¼ì„±ì¹˜<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>

<span class="c1"># ìœ ì²´ ë¬¼ì„±ì¹˜ ì˜ˆì‹œ</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FluidProperties</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìœ ì²´ ë¬¼ì„±ì¹˜ í´ë˜ìŠ¤&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">        - name: ìœ ì²´ ì´ë¦„</span>
<span class="sd">        - rho: ë°€ë„ [kg/mÂ³]</span>
<span class="sd">        - mu: ë™ì ì„±ê³„ìˆ˜ [PaÂ·s]</span>
<span class="sd">        - k: ì—´ì „ë„ë„ [W/(mÂ·K)]</span>
<span class="sd">        - cp: ë¹„ì—´ [J/(kgÂ·K)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span>      <span class="c1"># ë°€ë„</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span>        <span class="c1"># ë™ì ì„±ê³„ìˆ˜ (dynamic viscosity)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>          <span class="c1"># ì—´ì „ë„ë„</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp</span> <span class="o">=</span> <span class="n">cp</span>        <span class="c1"># ì •ì••ë¹„ì—´</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ìš´ë™ì ì„±ê³„ìˆ˜ (kinematic viscosity)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì—´í™•ì‚°ê³„ìˆ˜ (thermal diffusivity)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Pr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;í”„ë€í‹€ ìˆ˜ (Prandtl number)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;FluidProperties(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">): rho=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="si">}</span><span class="s2">, mu=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="si">}</span><span class="s2">, nu=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nu</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># ì¼ë°˜ì ì¸ ìœ ì²´ë“¤</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">FluidProperties</span><span class="p">(</span><span class="s2">&quot;Water (20Â°C)&quot;</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">998</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">1.002e-3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.598</span><span class="p">,</span> <span class="n">cp</span><span class="o">=</span><span class="mi">4182</span><span class="p">)</span>
<span class="n">air</span> <span class="o">=</span> <span class="n">FluidProperties</span><span class="p">(</span><span class="s2">&quot;Air (20Â°C)&quot;</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mf">1.204</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">1.825e-5</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.0257</span><span class="p">,</span> <span class="n">cp</span><span class="o">=</span><span class="mi">1007</span><span class="p">)</span>
<span class="n">oil</span> <span class="o">=</span> <span class="n">FluidProperties</span><span class="p">(</span><span class="s2">&quot;Engine Oil (20Â°C)&quot;</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">880</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.29</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.145</span><span class="p">,</span> <span class="n">cp</span><span class="o">=</span><span class="mi">1880</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">water</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Prandtl number: </span><span class="si">{</span><span class="n">water</span><span class="o">.</span><span class="n">Pr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">air</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Prandtl number: </span><span class="si">{</span><span class="n">air</span><span class="o">.</span><span class="n">Pr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="13-reynolds-number">1.3 ë ˆì´ë†€ì¦ˆ ìˆ˜ (Reynolds Number)<a class="header-link" href="#13-reynolds-number" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ë ˆì´ë†€ì¦ˆ ìˆ˜ ì •ì˜:
Re = ÏUL/Î¼ = UL/Î½ = (ê´€ì„±ë ¥)/(ì ì„±ë ¥)

ì—¬ê¸°ì„œ:
- Ï: ìœ ì²´ ë°€ë„
- U: íŠ¹ì„± ì†ë„
- L: íŠ¹ì„± ê¸¸ì´
- Î¼: ë™ì ì„±ê³„ìˆ˜
- Î½ = Î¼/Ï: ìš´ë™ì ì„±ê³„ìˆ˜

ìœ ë™ íŠ¹ì„±:
- Re &lt; 2300: ì¸µë¥˜ (Laminar flow)
- 2300 &lt; Re &lt; 4000: ì²œì´ ì˜ì—­ (Transition)
- Re &gt; 4000: ë‚œë¥˜ (Turbulent flow)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reynolds_number_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë ˆì´ë†€ì¦ˆ ìˆ˜ì™€ ìœ ë™ íŠ¹ì„± ë¶„ì„&quot;&quot;&quot;</span>

    <span class="c1"># ê´€ ìœ ë™ ì˜ˆì œ</span>
    <span class="n">D</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># ê´€ ì§ê²½ [m]</span>
    <span class="n">U_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># ìœ ì† ë²”ìœ„ [m/s]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ë¬¼ì—ì„œì˜ ë ˆì´ë†€ì¦ˆ ìˆ˜</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Re_water</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">U_range</span> <span class="o">*</span> <span class="n">D</span> <span class="o">/</span> <span class="n">water</span><span class="o">.</span><span class="n">mu</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">U_range</span><span class="p">,</span> <span class="n">Re_water</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Transition start&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Turbulent&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">U_range</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2300</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Laminar&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">U_range</span><span class="p">,</span> <span class="mi">2300</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">U_range</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">Re_water</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Flow Velocity U [m/s]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reynolds Number Re&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Reynolds Number in Pipe Flow (D = </span><span class="si">{</span><span class="n">D</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s1"> cm, Water)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="c1"># ë‹¤ì–‘í•œ ìœ ì²´ ë¹„êµ</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">fluids</span> <span class="o">=</span> <span class="p">[</span><span class="n">water</span><span class="p">,</span> <span class="n">air</span><span class="p">,</span> <span class="n">oil</span><span class="p">]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">fluid</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fluids</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">Re</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">U_range</span> <span class="o">*</span> <span class="n">D</span> <span class="o">/</span> <span class="n">fluid</span><span class="o">.</span><span class="n">mu</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">U_range</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">fluid</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Flow Velocity U [m/s]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reynolds Number Re&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reynolds Number Comparison for Different Fluids&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;reynolds_number.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># ì‹¤ìš©ì  ì˜ˆì œ ê³„ì‚°</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== ì‹¤ìš©ì  ë ˆì´ë†€ì¦ˆ ìˆ˜ ê³„ì‚° ì˜ˆì œ ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ê´€ ì§ê²½ D = </span><span class="si">{</span><span class="n">D</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2"> cm&quot;</span><span class="p">)</span>

    <span class="n">test_velocities</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="n">test_velocities</span><span class="p">:</span>
        <span class="n">Re</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">U</span> <span class="o">*</span> <span class="n">D</span> <span class="o">/</span> <span class="n">water</span><span class="o">.</span><span class="n">mu</span>
        <span class="n">regime</span> <span class="o">=</span> <span class="s2">&quot;ì¸µë¥˜&quot;</span> <span class="k">if</span> <span class="n">Re</span> <span class="o">&lt;</span> <span class="mi">2300</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;ì²œì´&quot;</span> <span class="k">if</span> <span class="n">Re</span> <span class="o">&lt;</span> <span class="mi">4000</span> <span class="k">else</span> <span class="s2">&quot;ë‚œë¥˜&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  U = </span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2"> m/s -&gt; Re = </span><span class="si">{</span><span class="n">Re</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">regime</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># reynolds_number_analysis()</span>
</code></pre></div>

<hr />
<h2 id="2">2. ì§€ë°°ë°©ì •ì‹<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-continuity-equation">2.1 ì—°ì† ë°©ì •ì‹ (Continuity Equation)<a class="header-link" href="#21-continuity-equation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">ì§ˆëŸ‰</span><span class="w"> </span><span class="err">ë³´ì¡´</span><span class="w"> </span><span class="err">ë²•ì¹™</span><span class="p">:</span>
<span class="err">âˆ‚Ï</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">âˆ‡Â·</span><span class="p">(</span><span class="err">Ï</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="err">í…ì„œ</span><span class="w"> </span><span class="err">í‘œê¸°</span><span class="p">:</span>
<span class="err">âˆ‚Ï</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">âˆ‚</span><span class="p">(</span><span class="err">Ï</span><span class="n">uáµ¢</span><span class="p">)</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">xáµ¢</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="err">ë¹„ì••ì¶•ì„±</span><span class="w"> </span><span class="err">ìœ ë™</span><span class="w"> </span><span class="p">(</span><span class="err">Ï</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="p">):</span>
<span class="err">âˆ‡Â·</span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="err">ë˜ëŠ”</span><span class="p">:</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">u</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">v</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">w</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_continuity</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì—°ì† ë°©ì •ì‹ ì‹œê°í™” - ê²€ì‚¬ì²´ì  ì ‘ê·¼&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># ê²€ì‚¬ì²´ì  ê°œë…ë„</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># ê²€ì‚¬ì²´ì  (ì‚¬ê°í˜•)</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>

    <span class="c1"># ì§ˆëŸ‰ ìœ ì…/ìœ ì¶œ í™”ì‚´í‘œ</span>
    <span class="c1"># x ë°©í–¥</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho u A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho u A + \frac{\partial(\rho u)}{\partial x}\Delta x A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

    <span class="c1"># y ë°©í–¥</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho v A$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho v A + ...$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Delta V$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ê²€ì‚¬ì²´ì ê³¼ ì§ˆëŸ‰ í”ŒëŸ­ìŠ¤&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="c1"># ë¹„ì••ì¶•ì„± ìœ ë™ì¥ ì˜ˆì‹œ (div u = 0)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># ìœ ë™ì¥: u = y, v = -x (ì  ì†ŒìŠ¤ íšŒì „ ìœ ë™, div=0)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">Y</span>
    <span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span>

    <span class="c1"># ë°œì‚° ê³„ì‚° (ìˆ˜ì¹˜ì )</span>
    <span class="n">div</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">U</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">],</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ë¹„ì••ì¶•ì„± ìœ ë™ì¥ ì˜ˆì‹œ: $u=y, v=-x$ ($\nabla \cdot \mathbf</span><span class="si">{u}</span><span class="s1"> = 0$)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;continuity_equation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># visualize_continuity()</span>
</code></pre></div>

<h3 id="22-momentum-equation">2.2 ìš´ë™ëŸ‰ ë°©ì •ì‹ (Momentum Equation)<a class="header-link" href="#22-momentum-equation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Newtonì˜ ì œ2ë²•ì¹™ ì ìš©:
Ï(Du/Dt) = -âˆ‡p + Î¼âˆ‡Â²u + Ïg + f

ì—¬ê¸°ì„œ:
- Du/Dt = âˆ‚u/âˆ‚t + (uÂ·âˆ‡)u : ë¬¼ì§ˆ ë¯¸ë¶„
- âˆ‡p: ì••ë ¥ êµ¬ë°°
- Î¼âˆ‡Â²u: ì ì„±ë ¥
- Ïg: ì¤‘ë ¥
- f: ì™¸ë¶€ ì²´ì ë ¥

ì„±ë¶„ë³„ (ë¹„ì••ì¶•ì„±, 2D):
x: Ï(âˆ‚u/âˆ‚t + uâˆ‚u/âˆ‚x + vâˆ‚u/âˆ‚y) = -âˆ‚p/âˆ‚x + Î¼(âˆ‚Â²u/âˆ‚xÂ² + âˆ‚Â²u/âˆ‚yÂ²)
y: Ï(âˆ‚v/âˆ‚t + uâˆ‚v/âˆ‚x + vâˆ‚v/âˆ‚y) = -âˆ‚p/âˆ‚y + Î¼(âˆ‚Â²v/âˆ‚xÂ² + âˆ‚Â²v/âˆ‚yÂ²)
</code></pre></div>

<h3 id="23-navier-stokes">2.3 Navier-Stokes ë°©ì •ì‹ ìœ ë„<a class="header-link" href="#23-navier-stokes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">navier_stokes_derivation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Navier-Stokes ë°©ì •ì‹ì˜ ê° í•­ ì˜ë¯¸ ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Navier-Stokes ë°©ì •ì‹ ìœ ë„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="n">derivation</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    1. ì§ˆëŸ‰ ë³´ì¡´ (ì—°ì†ë°©ì •ì‹):</span>
<span class="s2">       âˆ‚Ï/âˆ‚t + âˆ‡Â·(Ïu) = 0</span>

<span class="s2">       ë¹„ì••ì¶•ì„±: âˆ‡Â·u = 0</span>

<span class="s2">    2. ìš´ë™ëŸ‰ ë³´ì¡´ (Newton ì œ2ë²•ì¹™):</span>

<span class="s2">       ë¬¼ì§ˆ ë¯¸ë¶„ (Lagrangian derivative):</span>
<span class="s2">       Du/Dt = âˆ‚u/âˆ‚t + (uÂ·âˆ‡)u</span>
<span class="s2">                â†‘         â†‘</span>
<span class="s2">           êµ­ì†Œê°€ì†ë„  ëŒ€ë¥˜ê°€ì†ë„</span>

<span class="s2">       í˜ì˜ ê· í˜•:</span>
<span class="s2">       Ï(Du/Dt) = âˆ‘F = -âˆ‡p + âˆ‡Â·Ï„ + Ïg</span>
<span class="s2">                   â†‘      â†‘     â†‘    â†‘</span>
<span class="s2">                ê´€ì„±ë ¥  ì••ë ¥ë ¥ ì ì„±ë ¥ ì²´ì ë ¥</span>

<span class="s2">       Newton ìœ ì²´ ê°€ì • (Ï„ = Î¼(âˆ‡u + âˆ‡uáµ€)):</span>
<span class="s2">       Ï(Du/Dt) = -âˆ‡p + Î¼âˆ‡Â²u + Ïg</span>

<span class="s2">    3. ë¹„ì••ì¶•ì„± Navier-Stokes ë°©ì •ì‹:</span>

<span class="s2">       âˆ‚u/âˆ‚t + (uÂ·âˆ‡)u = -1/Ï âˆ‡p + Î½âˆ‡Â²u + g</span>

<span class="s2">       ì—¬ê¸°ì„œ Î½ = Î¼/Ï (ìš´ë™ì ì„±ê³„ìˆ˜)</span>

<span class="s2">    4. ë¬´ì°¨ì›í™” (Dimensionless form):</span>

<span class="s2">       íŠ¹ì„± ìŠ¤ì¼€ì¼: L(ê¸¸ì´), U(ì†ë„), T=L/U(ì‹œê°„), P=ÏUÂ²(ì••ë ¥)</span>

<span class="s2">       âˆ‚u*/âˆ‚t* + (u*Â·âˆ‡*)u* = -âˆ‡*p* + (1/Re)âˆ‡*Â²u*</span>

<span class="s2">       ì—¬ê¸°ì„œ Re = UL/Î½ (ë ˆì´ë†€ì¦ˆ ìˆ˜)</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">derivation</span><span class="p">)</span>

    <span class="c1"># ê° í•­ì˜ ìƒëŒ€ì  í¬ê¸° ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">Re_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># ë¬´ì°¨ì› í¬ê¸° ë¹„êµ</span>
    <span class="n">inertia</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Re_range</span><span class="p">)</span>  <span class="c1"># O(1)</span>
    <span class="n">viscous</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Re_range</span>            <span class="c1"># O(1/Re)</span>
    <span class="n">pressure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Re_range</span><span class="p">)</span> <span class="c1"># O(1)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Re_range</span><span class="p">,</span> <span class="n">inertia</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê´€ì„±í•­ O(1)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Re_range</span><span class="p">,</span> <span class="n">viscous</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì ì„±í•­ O(1/Re)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Re_range</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì••ë ¥í•­ O(1)&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì¸µë¥˜-ë‚œë¥˜ ì²œì´&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Re_range</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">Re_range</span> <span class="o">&lt;</span> <span class="mi">2300</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì ì„± ì§€ë°°&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Re_range</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">Re_range</span> <span class="o">&gt;=</span> <span class="mi">2300</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê´€ì„± ì§€ë°°&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Reynolds Number Re&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Relative Magnitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Navier-Stokes ë°©ì •ì‹ ê° í•­ì˜ ìƒëŒ€ì  í¬ê¸°&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;navier_stokes_terms.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># navier_stokes_derivation()</span>
</code></pre></div>

<hr />
<h2 id="3-vs">3. ì••ì¶•ì„± vs ë¹„ì••ì¶•ì„± ìœ ë™<a class="header-link" href="#3-vs" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ë§ˆí•˜ ìˆ˜ì™€ ì••ì¶•ì„±<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ë§ˆí•˜ ìˆ˜ ì •ì˜:
Ma = U/a

ì—¬ê¸°ì„œ:
- U: ìœ ì²´ ì†ë„
- a: ìŒì† (ì´ìƒê¸°ì²´: a = âˆš(Î³RT))

ë¶„ë¥˜:
- Ma &lt; 0.3: ë¹„ì••ì¶•ì„±ìœ¼ë¡œ ì·¨ê¸‰ ê°€ëŠ¥ (ë°€ë„ ë³€í™” &lt; 5%)
- 0.3 &lt; Ma &lt; 0.8: ì•„ìŒì† (Subsonic)
- 0.8 &lt; Ma &lt; 1.2: ì²œìŒì† (Transonic)
- 1.2 &lt; Ma &lt; 5: ì´ˆìŒì† (Supersonic)
- Ma &gt; 5: ê·¹ì´ˆìŒì† (Hypersonic)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compressibility_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì••ì¶•ì„± íš¨ê³¼ ë¶„ì„&quot;&quot;&quot;</span>

    <span class="c1"># ë“±ì—”íŠ¸ë¡œí”¼ ë°€ë„ ë¹„</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">density_ratio</span><span class="p">(</span><span class="n">Ma</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.4</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ï/Ïâ‚€ = (1 + (Î³-1)/2 MaÂ²)^(-1/(Î³-1))&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># ì••ë ¥ ë¹„</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pressure_ratio</span><span class="p">(</span><span class="n">Ma</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.4</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;p/pâ‚€ = (1 + (Î³-1)/2 MaÂ²)^(-Î³/(Î³-1))&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">gamma</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">Ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="c1"># ë°€ë„ ë¹„</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rho_ratio</span> <span class="o">=</span> <span class="n">density_ratio</span><span class="p">(</span><span class="n">Ma</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ma</span><span class="p">,</span> <span class="n">rho_ratio</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ma=0.3 (ë¹„ì••ì¶•ì„± í•œê³„)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Ma</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rho_ratio</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">Ma</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë¹„ì••ì¶•ì„± ì˜ì—­&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Mach Number Ma&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Density Ratio $\rho/\rho_0$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë“±ì—”íŠ¸ë¡œí”¼ ìœ ë™ì—ì„œì˜ ë°€ë„ ë³€í™”&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

    <span class="c1"># ì••ì¶•ì„±/ë¹„ì••ì¶•ì„± ë°©ì •ì‹ ë¹„êµ</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">equations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ë¹„ì••ì¶•ì„±</span><span class="se">\n</span><span class="s1">(Incompressible)&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s1">&#39;$\nabla \cdot \mathbf</span><span class="si">{u}</span><span class="s1"> = 0$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\rho \frac{D\mathbf</span><span class="si">{u}</span><span class="s1">}</span><span class="si">{Dt}</span><span class="s1"> = -\nabla p + \mu \nabla^2 \mathbf</span><span class="si">{u}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;3ê°œ ë°©ì •ì‹, 4ê°œ ë¯¸ì§€ìˆ˜ (u,v,w,p)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ì••ë ¥: Poisson ë°©ì •ì‹ìœ¼ë¡œ ê²°ì •&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;ì••ì¶•ì„±</span><span class="se">\n</span><span class="s1">(Compressible)&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s1">&#39;$\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf</span><span class="si">{u}</span><span class="s1">) = 0$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\frac{\partial (\rho \mathbf</span><span class="si">{u}</span><span class="s1">)}{\partial t} + \nabla \cdot (\rho \mathbf</span><span class="si">{u}</span><span class="s1"> \otimes \mathbf</span><span class="si">{u}</span><span class="s1">) = -\nabla p + \nabla \cdot \tau$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\frac{\partial E}{\partial t} + \nabla \cdot ((E+p)\mathbf</span><span class="si">{u}</span><span class="s1">) = \nabla \cdot (k\nabla T + \tau \cdot \mathbf</span><span class="si">{u}</span><span class="s1">)$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;5ê°œ ë°©ì •ì‹, 5ê°œ ë¯¸ì§€ìˆ˜ (Ï,u,v,w,E) + ìƒíƒœë°©ì •ì‹&#39;</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s1">&#39;ë¹„ì••ì¶•ì„± (Ma &lt; 0.3)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s1">&#39;ì••ì¶•ì„± (Ma &gt; 0.3)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="n">y_pos</span> <span class="o">=</span> <span class="mf">0.85</span>
    <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">equations</span><span class="p">[</span><span class="s1">&#39;ë¹„ì••ì¶•ì„±</span><span class="se">\n</span><span class="s1">(Incompressible)&#39;</span><span class="p">]:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">y_pos</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">y_pos</span> <span class="o">-=</span> <span class="mf">0.12</span>

    <span class="n">y_pos</span> <span class="o">=</span> <span class="mf">0.85</span>
    <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">equations</span><span class="p">[</span><span class="s1">&#39;ì••ì¶•ì„±</span><span class="se">\n</span><span class="s1">(Compressible)&#39;</span><span class="p">]:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">y_pos</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">y_pos</span> <span class="o">-=</span> <span class="mf">0.12</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì§€ë°°ë°©ì •ì‹ ë¹„êµ&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;compressibility.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># compressibility_analysis()</span>
</code></pre></div>

<hr />
<h2 id="4">4. ê²½ê³„ì¸µ ì´ë¡ <a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ê²½ê³„ì¸µ ê°œë…<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ê²½ê³„ì¸µ (Boundary Layer):
<span class="k">-</span> ë²½ë©´ ê·¼ì²˜ì—ì„œ ì ì„± íš¨ê³¼ê°€ ì§€ë°°ì ì¸ ì˜ì—­
<span class="k">-</span> ë²½ë©´: no-slip ì¡°ê±´ (u = 0)
<span class="k">-</span> ê²½ê³„ì¸µ ì™¸ë¶€: ììœ ë¥˜ ì†ë„ Uâˆ

ê²½ê³„ì¸µ ë‘ê»˜ Î´:
<span class="k">-</span> ì†ë„ê°€ ììœ ë¥˜ì˜ 99%ê°€ ë˜ëŠ” ìœ„ì¹˜
<span class="k">-</span> ì¸µë¥˜ í‰íŒ: Î´ ~ x/âˆšRe_x (Blasius)
<span class="k">-</span> ë‚œë¥˜ í‰íŒ: Î´ ~ x/Re_x^(1/5)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">boundary_layer_theory</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê²½ê³„ì¸µ ì´ë¡  ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># (1) Blasius ì¸µë¥˜ ê²½ê³„ì¸µ í”„ë¡œíŒŒì¼</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Blasius ìœ ì‚¬í•´ (ê·¼ì‚¬)</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># ë¬´ì°¨ì› ì¢Œí‘œ Î· = yâˆš(Uâˆ/Î½x)</span>

    <span class="c1"># f&#39;(Î·) ê·¼ì‚¬ (ì‹¤ì œëŠ” Blasius ë°©ì •ì‹ ìˆ˜ì¹˜í•´)</span>
    <span class="c1"># ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•œ ê·¼ì‚¬ ì‚¬ìš©</span>
    <span class="n">u_U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">eta</span> <span class="o">/</span> <span class="mf">2.5</span><span class="p">)</span> <span class="o">**</span> <span class="mf">1.5</span>  <span class="c1"># ê·¼ì‚¬</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_U</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\delta_</span><span class="si">{99}</span><span class="s1">$ (Î· â‰ˆ 5)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u_U</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$u/U_\infty$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\eta = y\sqrt{U_\infty/\nu x}$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Blasius ì¸µë¥˜ ê²½ê³„ì¸µ ì†ë„ í”„ë¡œíŒŒì¼&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

    <span class="c1"># (2) ê²½ê³„ì¸µ ë‘ê»˜ ì„±ì¥</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">nu</span> <span class="o">=</span> <span class="mf">1.5e-5</span>  <span class="c1"># ê³µê¸° ìš´ë™ì ì„±ê³„ìˆ˜</span>
    <span class="n">U_inf</span> <span class="o">=</span> <span class="mi">10</span>   <span class="c1"># ììœ ë¥˜ ì†ë„ [m/s]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># í‰íŒ ìœ„ì¹˜ [m]</span>

    <span class="n">Re_x</span> <span class="o">=</span> <span class="n">U_inf</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">nu</span>

    <span class="c1"># ì¸µë¥˜ ê²½ê³„ì¸µ ë‘ê»˜ (Blasius)</span>
    <span class="n">delta_lam</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Re_x</span><span class="p">)</span>

    <span class="c1"># ë‚œë¥˜ ê²½ê³„ì¸µ ë‘ê»˜ (1/7ìŠ¹ ë²•ì¹™)</span>
    <span class="n">delta_turb</span> <span class="o">=</span> <span class="mf">0.37</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Re_x</span> <span class="o">**</span> <span class="mf">0.2</span>

    <span class="c1"># ì²œì´ ìœ„ì¹˜ (Re_x ~ 5Ã—10^5)</span>
    <span class="n">x_trans</span> <span class="o">=</span> <span class="mf">5e5</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">/</span> <span class="n">U_inf</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">delta_lam</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì¸µë¥˜&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">delta_turb</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë‚œë¥˜&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_trans</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ì²œì´ì  (x â‰ˆ </span><span class="si">{</span><span class="n">x_trans</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> mm)&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [mm]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta$ [mm]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ê²½ê³„ì¸µ ë‘ê»˜ ì„±ì¥ (Uâˆ = </span><span class="si">{</span><span class="n">U_inf</span><span class="si">}</span><span class="s1"> m/s, ê³µê¸°)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (3) ë²½ë©´ ì „ë‹¨ì‘ë ¥</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># ì¸µë¥˜ ë²½ë©´ ì „ë‹¨ì‘ë ¥ ê³„ìˆ˜</span>
    <span class="n">Cf_lam</span> <span class="o">=</span> <span class="mf">0.664</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Re_x</span><span class="p">)</span>

    <span class="c1"># ë‚œë¥˜ ë²½ë©´ ì „ë‹¨ì‘ë ¥ ê³„ìˆ˜</span>
    <span class="n">Cf_turb</span> <span class="o">=</span> <span class="mf">0.027</span> <span class="o">/</span> <span class="n">Re_x</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Re_x</span><span class="p">,</span> <span class="n">Cf_lam</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì¸µë¥˜ (Blasius)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Re_x</span><span class="p">,</span> <span class="n">Cf_turb</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë‚œë¥˜ (1/7ìŠ¹ ë²•ì¹™)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5e5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Re_x$&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$C_f = \tau_w / (0.5\rho U_\infty^2)$&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë²½ë©´ ë§ˆì°° ê³„ìˆ˜&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (4) ê²½ê³„ì¸µ ê°œë…ë„</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># í‰íŒ</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># ê²½ê³„ì¸µ</span>
    <span class="n">x_plate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">delta_vis</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_plate</span><span class="p">)</span>  <span class="c1"># ë‹¨ìˆœí™”ëœ ê²½ê³„ì¸µ</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_plate</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">delta_vis</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê²½ê³„ì¸µ&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plate</span><span class="p">,</span> <span class="n">delta_vis</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># ì†ë„ í”„ë¡œíŒŒì¼ í™”ì‚´í‘œ</span>
    <span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]:</span>
        <span class="n">y_arrows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">y_arrows</span><span class="p">:</span>
            <span class="n">u</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x0</span><span class="p">)))</span> <span class="k">if</span> <span class="n">x0</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">u</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>

    <span class="c1"># ììœ ë¥˜</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$U_\infty$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;ê²½ê³„ì¸µ&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;í‰íŒ ìœ„ ê²½ê³„ì¸µ ë°œë‹¬&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;boundary_layer.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># boundary_layer_theory()</span>
</code></pre></div>

<hr />
<h2 id="5-cfd-poiseuille">5. ê°„ë‹¨í•œ CFD ì˜ˆì œ: Poiseuille ìœ ë™<a class="header-link" href="#5-cfd-poiseuille" title="Permanent link">&para;</a></h2>
<h3 id="51-2d-poiseuille-flow">5.1 2D ì±„ë„ ìœ ë™ (Poiseuille Flow)<a class="header-link" href="#51-2d-poiseuille-flow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">ë¬¸ì œ</span><span class="w"> </span><span class="err">ì„¤ì •</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="err">ë‘</span><span class="w"> </span><span class="err">í‰í–‰</span><span class="w"> </span><span class="err">í‰íŒ</span><span class="w"> </span><span class="err">ì‚¬ì´ì˜</span><span class="w"> </span><span class="err">ì •ìƒ</span><span class="w"> </span><span class="err">ì¸µë¥˜</span><span class="w"> </span><span class="err">ìœ ë™</span>
<span class="o">-</span><span class="w"> </span><span class="err">ì••ë ¥</span><span class="w"> </span><span class="err">êµ¬ë°°ì—</span><span class="w"> </span><span class="err">ì˜í•´</span><span class="w"> </span><span class="err">êµ¬ë™</span>
<span class="o">-</span><span class="w"> </span><span class="err">í•´ì„í•´</span><span class="w"> </span><span class="err">ì¡´ì¬</span><span class="w"> </span><span class="p">(</span><span class="err">ê²€ì¦ìš©</span><span class="p">)</span>

<span class="err">ì§€ë°°ë°©ì •ì‹</span><span class="w"> </span><span class="p">(</span><span class="err">ì •ìƒ</span><span class="p">,</span><span class="w"> </span><span class="err">ì™„ì „ë°œë‹¬</span><span class="p">):</span>
<span class="n">dÂ²u</span><span class="o">/</span><span class="n">dyÂ²</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="err">Î¼</span><span class="p">)(</span><span class="n">dp</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span>

<span class="err">ê²½ê³„ì¡°ê±´</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="n">no</span><span class="o">-</span><span class="n">slip</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">:</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="n">no</span><span class="o">-</span><span class="n">slip</span><span class="p">)</span>

<span class="err">í•´ì„í•´</span><span class="p">:</span>
<span class="n">u</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="err">Î¼</span><span class="p">)(</span><span class="n">dp</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span><span class="n">y</span><span class="p">(</span><span class="n">H</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

<span class="err">ìµœëŒ€</span><span class="w"> </span><span class="err">ì†ë„</span><span class="w"> </span><span class="p">(</span><span class="err">ì¤‘ì‹¬</span><span class="p">):</span>
<span class="n">u_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">HÂ²</span><span class="o">/</span><span class="mi">8</span><span class="err">Î¼</span><span class="p">)</span><span class="o">|</span><span class="n">dp</span><span class="o">/</span><span class="n">dx</span><span class="o">|</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">poiseuille_flow_exact</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Poiseuille ìœ ë™ í•´ì„í•´&quot;&quot;&quot;</span>

    <span class="n">H</span> <span class="o">=</span> <span class="mf">1.0</span>       <span class="c1"># ì±„ë„ ë†’ì´ [m]</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">0.01</span>     <span class="c1"># ë™ì ì„±ê³„ìˆ˜ [PaÂ·s]</span>
    <span class="n">dpdx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>   <span class="c1"># ì••ë ¥ êµ¬ë°° [Pa/m] (ìŒìˆ˜ = ì–‘ì˜ x ë°©í–¥ ìœ ë™)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">u_exact</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span><span class="p">))</span> <span class="o">*</span> <span class="n">dpdx</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">H</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">u_max</span> <span class="o">=</span> <span class="n">H</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dpdx</span><span class="p">)</span>
    <span class="n">u_avg</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">u_max</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ì†ë„ í”„ë¡œíŒŒì¼</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_exact</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í•´ì„í•´&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">H</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">u_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;u_max = </span><span class="si">{</span><span class="n">u_max</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">u_avg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;u_avg = </span><span class="si">{</span><span class="n">u_avg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;u [m/s]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Poiseuille ìœ ë™ ì†ë„ í”„ë¡œíŒŒì¼&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ì „ë‹¨ì‘ë ¥ í”„ë¡œíŒŒì¼</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">u_exact</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$ [Pa]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì „ë‹¨ì‘ë ¥ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;poiseuille_exact.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">u_exact</span><span class="p">,</span> <span class="n">y</span>

<span class="c1"># u_exact, y = poiseuille_flow_exact()</span>
</code></pre></div>

<h3 id="52-cfd">5.2 ìœ í•œì°¨ë¶„ë²•ì„ ì´ìš©í•œ CFD êµ¬í˜„<a class="header-link" href="#52-cfd" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cfd_channel_flow</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2D ì±„ë„ ìœ ë™ CFD ì‹œë®¬ë ˆì´ì…˜</span>
<span class="sd">    - ë¹„ì •ìƒ Navier-Stokes ë°©ì •ì‹</span>
<span class="sd">    - ì •ìƒ ìƒíƒœê¹Œì§€ ì‹œê°„ ì „ì§„</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ê²©ì ì„¤ì •</span>
    <span class="n">Nx</span> <span class="o">=</span> <span class="mi">50</span>       <span class="c1"># x ë°©í–¥ ê²©ì ìˆ˜</span>
    <span class="n">Ny</span> <span class="o">=</span> <span class="mi">30</span>       <span class="c1"># y ë°©í–¥ ê²©ì ìˆ˜</span>
    <span class="n">Lx</span> <span class="o">=</span> <span class="mf">2.0</span>      <span class="c1"># ì±„ë„ ê¸¸ì´ [m]</span>
    <span class="n">Ly</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># ì±„ë„ ë†’ì´ [m]</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">Nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="p">(</span><span class="n">Ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Ny</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># ë¬¼ì„±ì¹˜</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1"># ë°€ë„ [kg/mÂ³]</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">0.01</span>     <span class="c1"># ë™ì ì„±ê³„ìˆ˜ [PaÂ·s]</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">rho</span>

    <span class="c1"># ì••ë ¥ êµ¬ë°° (ì²´ì ë ¥ìœ¼ë¡œ ëª¨ë¸ë§)</span>
    <span class="n">dpdx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>   <span class="c1"># [Pa/m]</span>

    <span class="c1"># ì‹œê°„ ì„¤ì •</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">2000</span>

    <span class="c1"># ì´ˆê¸°í™”</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span><span class="p">))</span>  <span class="c1"># x-ì†ë„</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span><span class="p">))</span>  <span class="c1"># y-ì†ë„</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span><span class="p">))</span>  <span class="c1"># ì••ë ¥</span>

    <span class="c1"># CFL ì¡°ê±´ í™•ì¸</span>
    <span class="n">u_max_expected</span> <span class="o">=</span> <span class="n">Ly</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dpdx</span><span class="p">)</span>
    <span class="n">CFL</span> <span class="o">=</span> <span class="n">u_max_expected</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ì˜ˆìƒ ìµœëŒ€ ì†ë„: </span><span class="si">{</span><span class="n">u_max_expected</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CFL ìˆ˜: </span><span class="si">{</span><span class="n">CFL</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># í•´ì„í•´ (ê²€ì¦ìš©)</span>
    <span class="n">u_exact</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span><span class="p">))</span> <span class="o">*</span> <span class="n">dpdx</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ly</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_boundary_conditions</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ê²½ê³„ì¡°ê±´ ì ìš©&quot;&quot;&quot;</span>
        <span class="c1"># ë²½ë©´ (no-slip)</span>
        <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># í•˜ë‹¨ ë²½</span>
        <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># ìƒë‹¨ ë²½</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># ì…êµ¬/ì¶œêµ¬ (ì£¼ê¸°ì  ë˜ëŠ” Neumann)</span>
        <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>    <span class="c1"># ì…êµ¬</span>
        <span class="n">u</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># ì¶œêµ¬</span>
        <span class="n">v</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">v</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_rhs</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dpdx</span><span class="p">,</span> <span class="n">rho</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ìš°ë³€ ê³„ì‚° (ìš´ë™ëŸ‰ ë°©ì •ì‹)&quot;&quot;&quot;</span>
        <span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">rhs_u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">rhs_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="c1"># ëŒ€ë¥˜í•­ (ì¤‘ì‹¬ì°¨ë¶„)</span>
                <span class="n">duudx</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>
                <span class="n">duvdy</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>

                <span class="n">dvudx</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>
                <span class="n">dvvdy</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>

                <span class="c1"># í™•ì‚°í•­ (ì¤‘ì‹¬ì°¨ë¶„)</span>
                <span class="n">d2udx2</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">d2udy2</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span>

                <span class="n">d2vdx2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">d2vdy2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span>

                <span class="c1"># ì••ë ¥í•­</span>
                <span class="n">dpdx_local</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="n">dpdy_local</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>

                <span class="c1"># ìš´ë™ëŸ‰ ë°©ì •ì‹ ìš°ë³€</span>
                <span class="n">rhs_u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">duudx</span> <span class="o">-</span> <span class="n">duvdy</span> <span class="o">-</span> <span class="n">dpdx_local</span><span class="o">/</span><span class="n">rho</span> <span class="o">+</span> <span class="n">nu</span> <span class="o">*</span> <span class="p">(</span><span class="n">d2udx2</span> <span class="o">+</span> <span class="n">d2udy2</span><span class="p">)</span> <span class="o">-</span> <span class="n">dpdx</span><span class="o">/</span><span class="n">rho</span>
                <span class="n">rhs_v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dvudx</span> <span class="o">-</span> <span class="n">dvvdy</span> <span class="o">-</span> <span class="n">dpdy_local</span><span class="o">/</span><span class="n">rho</span> <span class="o">+</span> <span class="n">nu</span> <span class="o">*</span> <span class="p">(</span><span class="n">d2vdx2</span> <span class="o">+</span> <span class="n">d2vdy2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rhs_u</span><span class="p">,</span> <span class="n">rhs_v</span>

    <span class="c1"># ì‹œê°„ ì „ì§„</span>
    <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        <span class="c1"># ê²½ê³„ì¡°ê±´</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">apply_boundary_conditions</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="c1"># RHS ê³„ì‚°</span>
        <span class="n">rhs_u</span><span class="p">,</span> <span class="n">rhs_v</span> <span class="o">=</span> <span class="n">compute_rhs</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dpdx</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>

        <span class="c1"># ì‹œê°„ ì „ì§„ (Euler)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">u</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">rhs_u</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">rhs_v</span>

        <span class="c1"># ìˆ˜ë ´ ì²´í¬</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">200</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">u_center</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="n">Nx</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u_center</span> <span class="o">-</span> <span class="n">u_exact</span><span class="p">))</span>
            <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: max error = </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, max u = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ê²°ê³¼ ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># (1) ì†ë„ì¥ (ë²¡í„°)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">skip</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">u</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">v</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì†ë„ ë²¡í„°ì¥&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># (2) u-ì†ë„ ë“±ê³ ì„ </span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">cf</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;u [m/s]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;u-ì†ë„ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># (3) í•´ì„í•´ì™€ ë¹„êµ</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">u_center</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="n">Nx</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_center</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CFD&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_exact</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í•´ì„í•´&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;u [m/s]&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì†ë„ í”„ë¡œíŒŒì¼ ë¹„êµ (x = L/2)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (4) ìˆ˜ë ´ ì´ë ¥</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">steps</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">u_maxs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">history</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="s1">&#39;b-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Max Error&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆ˜ë ´ ì´ë ¥&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cfd_channel_flow.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

<span class="c1"># u, v, p, X, Y = cfd_channel_flow()</span>
</code></pre></div>

<hr />
<h2 id="6-cfd">6. CFDì˜ ì£¼ìš” ê³¼ì œ<a class="header-link" href="#6-cfd" title="Permanent link">&para;</a></h2>
<h3 id="61-mesh-generation">6.1 ê²©ì ìƒì„± (Mesh Generation)<a class="header-link" href="#61-mesh-generation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mesh_types_visualization</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CFD ê²©ì ìœ í˜• ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># (1) êµ¬ì¡° ê²©ì (Structured)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;êµ¬ì¡° ê²©ì (Structured)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

    <span class="c1"># (2) ë¹„êµ¬ì¡° ê²©ì (Unstructured)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial</span><span class="w"> </span><span class="kn">import</span> <span class="n">Delaunay</span>

    <span class="c1"># ëœë¤ í¬ì¸íŠ¸</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>

    <span class="c1"># ê²½ê³„ í¬ì¸íŠ¸ ì¶”ê°€</span>
    <span class="n">boundary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">boundary</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">boundary</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span><span class="p">],</span> <span class="mi">8</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">points</span><span class="p">,</span> <span class="n">edge</span><span class="p">])</span>

    <span class="n">tri</span> <span class="o">=</span> <span class="n">Delaunay</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">triplot</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tri</span><span class="o">.</span><span class="n">simplices</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë¹„êµ¬ì¡° ê²©ì (Unstructured)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

    <span class="c1"># (3) O-ê²©ì (ì›í†µ ì£¼ìœ„)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">r_inner</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">r_outer</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">n_r</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">n_theta</span> <span class="o">=</span> <span class="mi">24</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">r_inner</span><span class="p">,</span> <span class="n">r_outer</span><span class="p">,</span> <span class="n">n_r</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
        <span class="n">x_circle</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">y_circle</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_circle</span><span class="p">,</span> <span class="n">y_circle</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">theta</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">x_radial</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
        <span class="n">y_radial</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_radial</span><span class="p">,</span> <span class="n">y_radial</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">X_o</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    <span class="n">Y_o</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_o</span><span class="p">,</span> <span class="n">Y_o</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;O-ê²©ì (ì›í†µ ì£¼ìœ„)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>

    <span class="c1"># (4) ê²½ê³„ì¸µ í”„ë¦¬ì¦˜ ê²©ì</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># ê²½ê³„ì¸µ ì˜ì—­ (í”„ë¦¬ì¦˜)</span>
    <span class="n">x_wall</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">y_layers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">yl</span> <span class="ow">in</span> <span class="n">y_layers</span><span class="p">:</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_wall</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x_wall</span><span class="p">,</span> <span class="n">yl</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># ì™¸ë¶€ ë¹„êµ¬ì¡° ê²©ì (ì‚¼ê°í˜•)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">outer_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">outer_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>
    <span class="n">outer_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">outer_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.4</span>

    <span class="n">tri_outer</span> <span class="o">=</span> <span class="n">Delaunay</span><span class="p">(</span><span class="n">outer_points</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">triplot</span><span class="p">(</span><span class="n">outer_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">outer_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tri_outer</span><span class="o">.</span><span class="n">simplices</span><span class="p">,</span>
               <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">ax4</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_wall</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ê²½ê³„ì¸µ (í”„ë¦¬ì¦˜)&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;í•˜ì´ë¸Œë¦¬ë“œ ê²©ì (í”„ë¦¬ì¦˜ + ì‚¼ê°í˜•)&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mesh_types.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># mesh_types_visualization()</span>
</code></pre></div>

<h3 id="62">6.2 ë‚œë¥˜ ëª¨ë¸ë§<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ì£¼ìš” ë‚œë¥˜ ëª¨ë¸:

1. RANS (Reynolds-Averaged Navier-Stokes):
   - k-Îµ ëª¨ë¸: ë²”ìš©, ì‚°ì—… í‘œì¤€
   - k-Ï‰ ëª¨ë¸: ë²½ë©´ ê·¼ì²˜ ì •í™•
   - SST ëª¨ë¸: k-Îµ + k-Ï‰ ì¥ì  ê²°í•©

2. LES (Large Eddy Simulation):
   - í° ì™€ë¥˜ëŠ” ì§ì ‘ ê³„ì‚°
   - ì‘ì€ ì™€ë¥˜ëŠ” ëª¨ë¸ë§ (SGS ëª¨ë¸)

3. DNS (Direct Numerical Simulation):
   - ëª¨ë“  ë‚œë¥˜ ìŠ¤ì¼€ì¼ ì§ì ‘ ê³„ì‚°
   - ReÂ³ì— ë¹„ë¡€í•˜ëŠ” ê³„ì‚° ë¹„ìš©

ì„ íƒ ê¸°ì¤€:
- ì •í™•ë„: DNS &gt; LES &gt; RANS
- ê³„ì‚° ë¹„ìš©: DNS &gt; LES &gt; RANS
- ì‹¤ìš©ì„±: RANS &gt; LES &gt; DNS
</code></pre></div>

<hr />
<h2 id="7">7. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="1_1">ì—°ìŠµ 1: ë ˆì´ë†€ì¦ˆ ìˆ˜ ê³„ì‚°<a class="header-link" href="#1_1" title="Permanent link">&para;</a></h3>
<p>ì§ê²½ 5cm ê´€ì—ì„œ ë¬¼(20Â°C)ì´ í‰ê·  ì†ë„ 2m/së¡œ íë¥¼ ë•Œ ë ˆì´ë†€ì¦ˆ ìˆ˜ë¥¼ ê³„ì‚°í•˜ê³  ìœ ë™ ìƒíƒœë¥¼ íŒë³„í•˜ì‹œì˜¤.</p>
<h3 id="2-poiseuille">ì—°ìŠµ 2: Poiseuille ìœ ë™<a class="header-link" href="#2-poiseuille" title="Permanent link">&para;</a></h3>
<p>Poiseuille ìœ ë™ì—ì„œ í‰ê·  ì†ë„ì™€ ìµœëŒ€ ì†ë„ì˜ ê´€ê³„ë¥¼ ìœ ë„í•˜ì‹œì˜¤.</p>
<h3 id="3">ì—°ìŠµ 3: ê²½ê³„ì¸µ ë‘ê»˜<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>ê³µê¸°(20Â°C)ê°€ 5m/së¡œ í‰íŒ ìœ„ë¥¼ íë¥¼ ë•Œ, ì„ ë‹¨ì—ì„œ 10cm ë–¨ì–´ì§„ ìœ„ì¹˜ì˜ ì¸µë¥˜ ê²½ê³„ì¸µ ë‘ê»˜ë¥¼ ê³„ì‚°í•˜ì‹œì˜¤.</p>
<h3 id="4-cfd">ì—°ìŠµ 4: CFD ê²©ì ì˜ì¡´ì„±<a class="header-link" href="#4-cfd" title="Permanent link">&para;</a></h3>
<p>ì±„ë„ ìœ ë™ CFD ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì—¬ ê²©ì ìˆ˜ë¥¼ ë³€í™”ì‹œí‚¤ë©´ì„œ ê²©ì ìˆ˜ë ´ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ì‹œì˜¤.</p>
<hr />
<h2 id="8">8. ì°¸ê³ ìë£Œ<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="_2">í•µì‹¬ êµì¬<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Versteeg &amp; Malalasekera, "An Introduction to Computational Fluid Dynamics"</li>
<li>Anderson, "Computational Fluid Dynamics: The Basics with Applications"</li>
<li>Ferziger &amp; Peric, "Computational Methods for Fluid Dynamics"</li>
</ul>
<h3 id="cfd">CFD ì†Œí”„íŠ¸ì›¨ì–´<a class="header-link" href="#cfd" title="Permanent link">&para;</a></h3>
<ul>
<li>OpenFOAM (ì˜¤í”ˆì†ŒìŠ¤)</li>
<li>ANSYS Fluent (ìƒìš©)</li>
<li>COMSOL Multiphysics (ìƒìš©)</li>
<li>SU2 (ì˜¤í”ˆì†ŒìŠ¤)</li>
</ul>
<h3 id="_3">ì˜¨ë¼ì¸ ìë£Œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<ul>
<li>NASA CFD Resources</li>
<li>CFD Online (í¬ëŸ¼, íŠœí† ë¦¬ì–¼)</li>
<li>LearnCAx (ë¬´ë£Œ ê°•ì¢Œ)</li>
</ul>
<hr />
<h2 id="_4">ìš”ì•½<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>CFD ê¸°ì´ˆ í•µì‹¬:

1. ì§€ë°°ë°©ì •ì‹:
   - ì—°ì†: âˆ‡Â·u = 0 (ë¹„ì••ì¶•ì„±)
   - ìš´ë™ëŸ‰: Ï(Du/Dt) = -âˆ‡p + Î¼âˆ‡Â²u
   - ì—ë„ˆì§€: (ì••ì¶•ì„± ìœ ë™)

2. ë¬´ì°¨ì› ìˆ˜:
   - Re = ÏUL/Î¼ (ê´€ì„±/ì ì„±)
   - Ma = U/a (ì••ì¶•ì„±)
   - Pr = Î½/Î± (ìš´ë™ëŸ‰/ì—´ í™•ì‚°)

3. CFD ì ˆì°¨:
   â‘  ê²©ì ìƒì„± (ì „ì²˜ë¦¬)
   â‘¡ ì´ì‚°í™” ë° ê³„ì‚° (ì†”ë²„)
   â‘¢ í›„ì²˜ë¦¬ (ì‹œê°í™”, ë¶„ì„)

4. ì£¼ìš” ê³ ë ¤ì‚¬í•­:
   - ê²©ì í’ˆì§ˆ ë° ìˆ˜ë ´
   - ê²½ê³„ì¡°ê±´ ì„¤ì •
   - ë‚œë¥˜ ëª¨ë¸ ì„ íƒ
   - ìˆ˜ì¹˜ ì•ˆì •ì„± (CFL ì¡°ê±´)
</code></pre></div>

<hr />
<p>ë‹¤ìŒ ë ˆìŠ¨ì—ì„œëŠ” ë¹„ì••ì¶•ì„± ìœ ë™ì˜ ëŒ€í‘œì  ë¬¸ì œì¸ Lid-Driven Cavityì™€ SIMPLE ì•Œê³ ë¦¬ì¦˜ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/12_Advection_Equation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">12. ì´ë¥˜ë°©ì •ì‹ (Advection Equation)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/14_Incompressible_Flow.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">14. ë¹„ì••ì¶•ì„± ìœ ë™ (Incompressible Flow)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}