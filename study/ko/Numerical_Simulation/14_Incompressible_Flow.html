{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14. ë¹„ì••ì¶•ì„± ìœ ë™ (Incompressible Flow) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Numerical_Simulation/">Numerical Simulation</a>
    <span class="separator">/</span>
    <span class="current">14. ë¹„ì••ì¶•ì„± ìœ ë™ (Incompressible Flow)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>14. ë¹„ì••ì¶•ì„± ìœ ë™ (Incompressible Flow)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/13_CFD_Basics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. CFD ê¸°ì´ˆ (Computational Fluid Dynamics Basics)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/15_Electromagnetics_Numerical.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. ì „ìê¸°í•™ ìˆ˜ì¹˜í•´ì„ (Computational Electromagnetics)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1-navier-stokes">1. ë¹„ì••ì¶•ì„± Navier-Stokes ë°©ì •ì‹</a><ul>
<li><a href="#11-primitive-variable-formulation">1.1 ì›ì‹œë³€ìˆ˜ ì •ì‹í™” (Primitive Variable Formulation)</a></li>
<li><a href="#12-poisson">1.2 ì••ë ¥ Poisson ë°©ì •ì‹</a></li>
</ul>
</li>
<li><a href="#2-stream-function-vorticity">2. ìœ ë™í•¨ìˆ˜-ì™€ë„ ì •ì‹í™” (Stream Function-Vorticity)</a><ul>
<li><a href="#21">2.1 ì •ì˜</a></li>
</ul>
</li>
<li><a href="#3-lid-driven-cavity">3. Lid-Driven Cavity ë¬¸ì œ</a><ul>
<li><a href="#31">3.1 ë¬¸ì œ ì •ì˜</a></li>
<li><a href="#32">3.2 ë ˆì´ë†€ì¦ˆ ìˆ˜ íš¨ê³¼</a></li>
</ul>
</li>
<li><a href="#4-staggered-grid">4. ì—‡ê°ˆë¦° ê²©ì (Staggered Grid)</a><ul>
<li><a href="#41">4.1 ë™ì¼ ìœ„ì¹˜ ê²©ìì˜ ë¬¸ì œì </a></li>
<li><a href="#42">4.2 ì—‡ê°ˆë¦° ê²©ì êµ¬ì¡°</a></li>
</ul>
</li>
<li><a href="#5-simple">5. SIMPLE ì•Œê³ ë¦¬ì¦˜</a><ul>
<li><a href="#51">5.1 ê°œë…</a></li>
<li><a href="#52-simple">5.2 SIMPLE ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#6-simple">6. SIMPLE ë³€í˜• ì•Œê³ ë¦¬ì¦˜</a><ul>
<li><a href="#61-simpler-simplec-piso">6.1 SIMPLER, SIMPLEC, PISO</a></li>
</ul>
</li>
<li><a href="#7">7. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-">ì—°ìŠµ 1: ìœ ë™í•¨ìˆ˜-ì™€ë„</a></li>
<li><a href="#2-lid-driven-cavity">ì—°ìŠµ 2: Lid-Driven Cavity</a></li>
<li><a href="#3-simple-under-relaxation">ì—°ìŠµ 3: SIMPLE Under-relaxation</a></li>
<li><a href="#4">ì—°ìŠµ 4: ê²©ì ìˆ˜ë ´</a></li>
</ul>
</li>
<li><a href="#8">8. ì°¸ê³ ìë£Œ</a><ul>
<li><a href="#_2">í•µì‹¬ ë…¼ë¬¸</a></li>
<li><a href="#_3">êµì¬</a></li>
<li><a href="#cfd">CFD ì½”ë“œ</a></li>
</ul>
</li>
<li><a href="#_4">ìš”ì•½</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="14-incompressible-flow">14. ë¹„ì••ì¶•ì„± ìœ ë™ (Incompressible Flow)<a class="header-link" href="#14-incompressible-flow" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ìœ ë™í•¨ìˆ˜-ì™€ë„ ì •ì‹í™” ì´í•´</li>
<li>Lid-Driven Cavity ë¬¸ì œ êµ¬í˜„</li>
<li>ì••ë ¥-ì†ë„ ê²°í•© ë¬¸ì œ ì´í•´</li>
<li>SIMPLE ì•Œê³ ë¦¬ì¦˜ ê¸°ì´ˆ í•™ìŠµ</li>
<li>ì—‡ê°ˆë¦° ê²©ì (Staggered Grid) ê°œë… íŒŒì•…</li>
</ul>
<hr />
<h2 id="1-navier-stokes">1. ë¹„ì••ì¶•ì„± Navier-Stokes ë°©ì •ì‹<a class="header-link" href="#1-navier-stokes" title="Permanent link">&para;</a></h2>
<h3 id="11-primitive-variable-formulation">1.1 ì›ì‹œë³€ìˆ˜ ì •ì‹í™” (Primitive Variable Formulation)<a class="header-link" href="#11-primitive-variable-formulation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ë¹„ì••ì¶•ì„± NS ë°©ì •ì‹ (ì›ì‹œë³€ìˆ˜: u, v, p):

ì—°ì†ë°©ì •ì‹:
âˆ‚u/âˆ‚x + âˆ‚v/âˆ‚y = 0

ìš´ë™ëŸ‰ ë°©ì •ì‹:
âˆ‚u/âˆ‚t + uâˆ‚u/âˆ‚x + vâˆ‚u/âˆ‚y = -1/Ï âˆ‚p/âˆ‚x + Î½(âˆ‚Â²u/âˆ‚xÂ² + âˆ‚Â²u/âˆ‚yÂ²)
âˆ‚v/âˆ‚t + uâˆ‚v/âˆ‚x + vâˆ‚v/âˆ‚y = -1/Ï âˆ‚p/âˆ‚y + Î½(âˆ‚Â²v/âˆ‚xÂ² + âˆ‚Â²v/âˆ‚yÂ²)

ë¬¸ì œì :
- 3ê°œ ë°©ì •ì‹, 3ê°œ ë¯¸ì§€ìˆ˜ (u, v, p)
- ì••ë ¥ì— ëŒ€í•œ ë…ë¦½ì  ë°©ì •ì‹ ì—†ìŒ
- ì••ë ¥-ì†ë„ ê²°í•© (coupling) ë¬¸ì œ
</code></pre></div>

<h3 id="12-poisson">1.2 ì••ë ¥ Poisson ë°©ì •ì‹<a class="header-link" href="#12-poisson" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">Normalize</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ì—°ì†ë°©ì •ì‹ì˜ ë°œì‚°ì„ ì·¨í•˜ë©´:</span>
<span class="sd">âˆ‡Â²p = -Ïâˆ‡Â·(uÂ·âˆ‡u)</span>

<span class="sd">ì •ìƒ ìƒíƒœì—ì„œ:</span>
<span class="sd">âˆ‡Â²p = Ï[(âˆ‚u/âˆ‚x)Â² + 2(âˆ‚u/âˆ‚y)(âˆ‚v/âˆ‚x) + (âˆ‚v/âˆ‚y)Â²]</span>

<span class="sd">ì´ ë°©ì •ì‹ìœ¼ë¡œ ì••ë ¥ì„ ê²°ì •í•  ìˆ˜ ìˆìŒ</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pressure_poisson_concept</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì••ë ¥ Poisson ë°©ì •ì‹ ê°œë… ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì••ë ¥-ì†ë„ ê²°í•© ë¬¸ì œ&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="n">explanation</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ë¹„ì••ì¶•ì„± ìœ ë™ì˜ í•µì‹¬ ë¬¸ì œ:</span>

<span class="s2">    1. ì••ë ¥ì˜ ì—­í• :</span>
<span class="s2">       - ì••ë ¥ì€ ì—°ì†ë°©ì •ì‹(âˆ‡Â·u = 0)ì„ ë§Œì¡±ì‹œí‚¤ê¸° ìœ„í•´ ì¡°ì •ë¨</span>
<span class="s2">       - ì••ë ¥íŒŒê°€ ë¬´í•œíˆ ë¹ ë¥´ê²Œ ì „íŒŒ (ë¹„ì••ì¶•ì„±)</span>
<span class="s2">       - ì••ë ¥ì— ëŒ€í•œ ë…ë¦½ì  ì§€ë°°ë°©ì •ì‹ ì—†ìŒ</span>

<span class="s2">    2. í•´ê²° ë°©ë²•:</span>
<span class="s2">       a) ìœ ë™í•¨ìˆ˜-ì™€ë„ ì •ì‹í™”:</span>
<span class="s2">          - ì—°ì†ë°©ì •ì‹ ìë™ ë§Œì¡±</span>
<span class="s2">          - 2D ìœ ë™ì—ë§Œ ì ìš© ê°€ëŠ¥</span>

<span class="s2">       b) ì••ë ¥ Poisson ë°©ì •ì‹:</span>
<span class="s2">          - ì—°ì†ë°©ì •ì‹ì—ì„œ ì••ë ¥ ë°©ì •ì‹ ìœ ë„</span>
<span class="s2">          - Projection/Fractional Step Method</span>

<span class="s2">       c) SIMPLE ê³„ì—´ ì•Œê³ ë¦¬ì¦˜:</span>
<span class="s2">          - ì••ë ¥-ì†ë„ ë°˜ë³µ ë³´ì •</span>
<span class="s2">          - ì‚°ì—…ê³„ í‘œì¤€</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">explanation</span><span class="p">)</span>

<span class="n">pressure_poisson_concept</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="2-stream-function-vorticity">2. ìœ ë™í•¨ìˆ˜-ì™€ë„ ì •ì‹í™” (Stream Function-Vorticity)<a class="header-link" href="#2-stream-function-vorticity" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ì •ì˜<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mf">2</span><span class="n">D</span><span class="w"> </span><span class="n">ë¹„ì••ì¶•ì„±</span><span class="w"> </span><span class="n">ìœ ë™</span><span class="p">:</span>

<span class="n">ìœ ë™í•¨ìˆ˜</span><span class="w"> </span><span class="n">Ïˆ</span><span class="w"> </span><span class="p">(</span><span class="n">Stream</span><span class="w"> </span><span class="n">Function</span><span class="p">):</span>
<span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">Ïˆ</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">y</span><span class="p">,</span><span class="w">  </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="err">âˆ‚</span><span class="n">Ïˆ</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">x</span>
<span class="err">â†’</span><span class="w"> </span><span class="n">ì—°ì†ë°©ì •ì‹</span><span class="w"> </span><span class="n">ìë™</span><span class="w"> </span><span class="n">ë§Œì¡±</span><span class="p">:</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">u</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">v</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span>

<span class="n">ì™€ë„</span><span class="w"> </span><span class="n">Ï‰</span><span class="w"> </span><span class="p">(</span><span class="n">Vorticity</span><span class="p">):</span>
<span class="n">Ï‰</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">v</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">âˆ‚</span><span class="n">u</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="err">âˆ‡</span><span class="n">Â²Ïˆ</span>

<span class="n">ì™€ë„</span><span class="w"> </span><span class="n">ìˆ˜ì†¡</span><span class="w"> </span><span class="n">ë°©ì •ì‹</span><span class="p">:</span>
<span class="err">âˆ‚</span><span class="n">Ï‰</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u</span><span class="err">âˆ‚</span><span class="n">Ï‰</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v</span><span class="err">âˆ‚</span><span class="n">Ï‰</span><span class="o">/</span><span class="err">âˆ‚</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Î½</span><span class="err">âˆ‡</span><span class="n">Â²Ï‰</span>

<span class="n">Poisson</span><span class="w"> </span><span class="n">ë°©ì •ì‹</span><span class="p">:</span>
<span class="err">âˆ‡</span><span class="n">Â²Ïˆ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">Ï‰</span>

<span class="n">ì¥ì </span><span class="p">:</span><span class="w"> </span><span class="n">ì••ë ¥í•­</span><span class="w"> </span><span class="n">ì œê±°</span><span class="p">,</span><span class="w"> </span><span class="n">ì—°ì†ë°©ì •ì‹</span><span class="w"> </span><span class="n">ìë™</span><span class="w"> </span><span class="n">ë§Œì¡±</span>
<span class="n">ë‹¨ì </span><span class="p">:</span><span class="w"> </span><span class="mf">2</span><span class="n">Dì—ë§Œ</span><span class="w"> </span><span class="n">ì ìš©</span><span class="p">,</span><span class="w"> </span><span class="n">ê²½ê³„ì¡°ê±´</span><span class="w"> </span><span class="n">ë³µì¡</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stream_function_vorticity_derivation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìœ ë™í•¨ìˆ˜-ì™€ë„ ì •ì‹í™” ìœ ë„&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># (1) ìœ ë™í•¨ìˆ˜ ê°œë…</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># ìœ ì„  (ë“± Ïˆ ì„ )</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># ì˜ˆ: ê· ì¼ ìœ ë™ + ì´ì¤‘ì  (Doublet)</span>
    <span class="n">U_inf</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># ì´ì¤‘ì  ê°•ë„</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.01</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">U_inf</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">-</span> <span class="n">kappa</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">r2</span>

    <span class="c1"># ì†ë„ì¥</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">U_inf</span> <span class="o">+</span> <span class="n">kappa</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">r2</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">kappa</span>
    <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">kappa</span> <span class="o">*</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">r2</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">kappa</span>

    <span class="c1"># ê°„ì†Œí™”ëœ ì†ë„ì¥</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ìœ ë™í•¨ìˆ˜ Ïˆ (ë“±Ïˆì„  = ìœ ì„ )&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># (2) ì™€ë„ ê°œë…</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># ì™€ë¥˜ (Vortex) ì˜ˆì œ</span>
    <span class="n">Gamma</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># ìˆœí™˜</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

    <span class="c1"># Rankine ì™€ë¥˜ (ì½”ì–´ ë°˜ê²½ = 0.5)</span>
    <span class="n">r_core</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">r_core</span><span class="p">,</span>
                    <span class="n">Gamma</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r_core</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># ê³ ì²´ íšŒì „</span>
                    <span class="mi">0</span><span class="p">)</span>  <span class="c1"># í¬í…ì…œ ìœ ë™</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\omega$ [1/s]&#39;</span><span class="p">)</span>

    <span class="c1"># ì†ë„ì¥ (ì ‘ì„ ë°©í–¥)</span>
    <span class="n">u_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">r_core</span><span class="p">,</span>
                      <span class="n">Gamma</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r_core</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
                      <span class="n">Gamma</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="p">))</span>
    <span class="n">u_vortex</span> <span class="o">=</span> <span class="o">-</span><span class="n">u_theta</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">v_vortex</span> <span class="o">=</span> <span class="n">u_theta</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">skip</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">u_vortex</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">v_vortex</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ì™€ë„ Ï‰ (Rankine ì™€ë¥˜)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;stream_vorticity.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># stream_function_vorticity_derivation()</span>
</code></pre></div>

<hr />
<h2 id="3-lid-driven-cavity">3. Lid-Driven Cavity ë¬¸ì œ<a class="header-link" href="#3-lid-driven-cavity" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ë¬¸ì œ ì •ì˜<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Lid-Driven Cavity:
<span class="k">-</span> ì •ì‚¬ê°í˜• ê³µë™ (cavity)
<span class="k">-</span> ìƒë‹¨ ë²½ë©´ì´ ì¼ì • ì†ë„ë¡œ ì´ë™
<span class="k">-</span> ë‚˜ë¨¸ì§€ ë²½ë©´ì€ ì •ì§€

ê²½ê³„ì¡°ê±´:
<span class="k">-</span> ìƒë‹¨ (y=H): u = U_lid, v = 0
<span class="k">-</span> í•˜ë‹¨ (y=0): u = v = 0
<span class="k">-</span> ì¢Œì¸¡ (x=0): u = v = 0
<span class="k">-</span> ìš°ì¸¡ (x=L): u = v = 0

íŠ¹ì„±:
<span class="k">-</span> ë ˆì´ë†€ì¦ˆ ìˆ˜ì— ë”°ë¥¸ ìœ ë™ íŒ¨í„´ ë³€í™”
<span class="k">-</span> Re ë‚®ìŒ: í•˜ë‚˜ì˜ ì£¼ ì™€ë¥˜
<span class="k">-</span> Re ë†’ìŒ: ì½”ë„ˆ ì™€ë¥˜ ë°œìƒ
<span class="k">-</span> CFD ì½”ë“œ ê²€ì¦ìš© í‘œì¤€ ë¬¸ì œ
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lid_driven_cavity_stream_vorticity</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lid-Driven Cavity ì‹œë®¬ë ˆì´ì…˜</span>
<span class="sd">    ìœ ë™í•¨ìˆ˜-ì™€ë„ ì •ì‹í™”</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ê²©ì ì„¤ì •</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">41</span>  <span class="c1"># ê²©ìì  ìˆ˜ (í™€ìˆ˜)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># ê³µë™ í¬ê¸°</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># ë¬¼ì„±ì¹˜ ë° ì„¤ì •</span>
    <span class="n">Re</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># ë ˆì´ë†€ì¦ˆ ìˆ˜</span>
    <span class="n">U_lid</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">U_lid</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="n">Re</span>

    <span class="c1"># ì‹œê°„ ì„¤ì •</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span>

    <span class="c1"># ì´ˆê¸°í™”</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>  <span class="c1"># ìœ ë™í•¨ìˆ˜</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>  <span class="c1"># ì™€ë„</span>

    <span class="c1"># CFL í™•ì¸</span>
    <span class="n">CFL</span> <span class="o">=</span> <span class="n">U_lid</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">h</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Re = </span><span class="si">{</span><span class="n">Re</span><span class="si">}</span><span class="s2">, N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">, h = </span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s2">, CFL = </span><span class="si">{</span><span class="n">CFL</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_bc_psi</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ìœ ë™í•¨ìˆ˜ ê²½ê³„ì¡°ê±´: Ïˆ = 0 on walls&quot;&quot;&quot;</span>
        <span class="n">psi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># í•˜ë‹¨</span>
        <span class="n">psi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># ìƒë‹¨</span>
        <span class="n">psi</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># ì¢Œì¸¡</span>
        <span class="n">psi</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># ìš°ì¸¡</span>
        <span class="k">return</span> <span class="n">psi</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_bc_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">U_lid</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ì™€ë„ ê²½ê³„ì¡°ê±´ (Thom&#39;s formula):</span>
<span class="sd">        ë²½ë©´ì—ì„œ Ï‰ = -2(Ïˆ_neighbor - Ïˆ_wall)/hÂ²</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># í•˜ë‹¨ (no-slip)</span>
        <span class="n">omega</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># ìƒë‹¨ (moving lid)</span>
        <span class="n">omega</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">U_lid</span> <span class="o">/</span> <span class="n">h</span>

        <span class="c1"># ì¢Œì¸¡</span>
        <span class="n">omega</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># ìš°ì¸¡</span>
        <span class="n">omega</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>

        <span class="k">return</span> <span class="n">omega</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_poisson</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Poisson ë°©ì •ì‹ í’€ì´: âˆ‡Â²Ïˆ = -Ï‰</span>
<span class="sd">        Gauss-Seidel ë°˜ë³µ</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
            <span class="n">psi_old</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span>
                                       <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                       <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

            <span class="c1"># ê²½ê³„ì¡°ê±´</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">apply_bc_psi</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>

            <span class="c1"># ìˆ˜ë ´ ì²´í¬</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span> <span class="o">-</span> <span class="n">psi_old</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">psi</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_velocity</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ìœ ë™í•¨ìˆ˜ì—ì„œ ì†ë„ ê³„ì‚°&quot;&quot;&quot;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>

        <span class="c1"># ë‚´ë¶€ì  (ì¤‘ì‹¬ì°¨ë¶„)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>
                <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">advect_diffuse_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì™€ë„ ìˆ˜ì†¡ ë°©ì •ì‹ ì‹œê°„ ì „ì§„&quot;&quot;&quot;</span>
        <span class="n">omega_new</span> <span class="o">=</span> <span class="n">omega</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="c1"># ëŒ€ë¥˜í•­ (í’ìƒì°¨ë¶„)</span>
                <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">domega_dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">domega_dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">domega_dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">domega_dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span>

                <span class="n">convection</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">domega_dx</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">domega_dy</span>

                <span class="c1"># í™•ì‚°í•­ (ì¤‘ì‹¬ì°¨ë¶„)</span>
                <span class="n">diffusion</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="p">((</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                                 <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">omega_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">convection</span> <span class="o">+</span> <span class="n">diffusion</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">omega_new</span>

    <span class="c1"># ì‹œê°„ ì „ì§„</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘...&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        <span class="c1"># 1. Poisson ë°©ì •ì‹ í’€ì´</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">solve_poisson</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

        <span class="c1"># 2. ì†ë„ ê³„ì‚°</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">compute_velocity</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

        <span class="c1"># 3. ì™€ë„ ê²½ê³„ì¡°ê±´</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="n">apply_bc_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">U_lid</span><span class="p">)</span>

        <span class="c1"># 4. ì™€ë„ ìˆ˜ì†¡</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="n">advect_diffuse_omega</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

        <span class="c1"># ì§„í–‰ ìƒí™© ì¶œë ¥</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: max|Ï‰| = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;max|Ïˆ| = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ!&quot;</span><span class="p">)</span>

    <span class="c1"># ìµœì¢… ì†ë„ì¥</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">compute_velocity</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

    <span class="c1"># ê²°ê³¼ ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># (1) ìœ ì„ </span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ìœ ì„  (Streamlines), Re = </span><span class="si">{</span><span class="n">Re</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># (2) ì™€ë„ ë¶„í¬</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.8</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                       <span class="n">vmin</span><span class="o">=-</span><span class="n">vmax</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\omega$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì™€ë„ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># (3) ì†ë„ ë²¡í„°</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">skip</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">u</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">v</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">speed</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì†ë„ ë²¡í„°ì¥&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># (4) ì¤‘ì‹¬ì„  ì†ë„ í”„ë¡œíŒŒì¼</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># ìˆ˜ì§ ì¤‘ì‹¬ì„  (x = 0.5)ì—ì„œ u ë¶„í¬</span>
    <span class="n">j_center</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">u_centerline</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="n">j_center</span><span class="p">]</span>

    <span class="c1"># Ghia et al. (1982) ì°¸ì¡°ê°’ (Re=100)</span>
    <span class="n">y_ghia</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0547</span><span class="p">,</span> <span class="mf">0.0625</span><span class="p">,</span> <span class="mf">0.0703</span><span class="p">,</span> <span class="mf">0.1016</span><span class="p">,</span> <span class="mf">0.1719</span><span class="p">,</span>
                      <span class="mf">0.2813</span><span class="p">,</span> <span class="mf">0.4531</span><span class="p">,</span> <span class="mf">0.5000</span><span class="p">,</span> <span class="mf">0.6172</span><span class="p">,</span> <span class="mf">0.7344</span><span class="p">,</span> <span class="mf">0.8516</span><span class="p">,</span> <span class="mf">0.9531</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">])</span>
    <span class="n">u_ghia</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0372</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0419</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0477</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0643</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1015</span><span class="p">,</span>
                      <span class="o">-</span><span class="mf">0.1566</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2109</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2058</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1364</span><span class="p">,</span> <span class="mf">0.0033</span><span class="p">,</span> <span class="mf">0.2315</span><span class="p">,</span> <span class="mf">0.6872</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">])</span>

    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_centerline</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Present&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_ghia</span><span class="p">,</span> <span class="n">y_ghia</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ghia et al. (1982)&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆ˜ì§ ì¤‘ì‹¬ì„  ì†ë„ í”„ë¡œíŒŒì¼ (x = 0.5)&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;lid_driven_cavity.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">psi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

<span class="c1"># psi, omega, u, v, X, Y = lid_driven_cavity_stream_vorticity()</span>
</code></pre></div>

<h3 id="32">3.2 ë ˆì´ë†€ì¦ˆ ìˆ˜ íš¨ê³¼<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reynolds_effect_cavity</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ë‹¤ì–‘í•œ ë ˆì´ë†€ì¦ˆ ìˆ˜ì—ì„œ Lid-Driven Cavity ë¹„êµ&quot;&quot;&quot;</span>

    <span class="n">reynolds_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">N</span> <span class="o">=</span> <span class="mi">51</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">Re</span> <span class="ow">in</span> <span class="n">reynolds_numbers</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Re = </span><span class="si">{</span><span class="n">Re</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>

        <span class="c1"># ì„¤ì •</span>
        <span class="n">U_lid</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">U_lid</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="n">Re</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">nu</span><span class="p">)</span>  <span class="c1"># í™•ì‚° ì•ˆì •ì„±</span>
        <span class="n">n_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>  <span class="c1"># ì¶©ë¶„í•œ ì‹œê°„</span>

        <span class="c1"># ì´ˆê¸°í™”</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>

        <span class="c1"># ê°„ëµí™”ëœ ì‹œë®¬ë ˆì´ì…˜ (ë¹ ë¥¸ ì‹¤í–‰)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)):</span>
            <span class="c1"># Poisson</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
                <span class="n">psi_old</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">psi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">psi</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                         <span class="n">psi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="n">psi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
                                         <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">psi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># ì†ë„</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
            <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
            <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">psi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>

            <span class="c1"># ì™€ë„ ê²½ê³„ì¡°ê±´</span>
            <span class="n">omega</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">omega</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">U_lid</span> <span class="o">/</span> <span class="n">h</span>
            <span class="n">omega</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">omega</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>

            <span class="c1"># ì™€ë„ ì „ì§„ (FTCS + í’ìƒ)</span>
            <span class="n">omega_new</span> <span class="o">=</span> <span class="n">omega</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">conv_x</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">h</span> <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">h</span>
                    <span class="n">conv_y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">h</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">h</span>
                    <span class="n">diff</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="p">((</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span>
                                <span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">/</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span>
                    <span class="n">omega_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">conv_x</span> <span class="o">-</span> <span class="n">conv_y</span> <span class="o">+</span> <span class="n">diff</span><span class="p">)</span>
            <span class="n">omega</span> <span class="o">=</span> <span class="n">omega_new</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Re</span><span class="p">,</span> <span class="n">psi</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">omega</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì™„ë£Œ: max|Ïˆ| = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ë¹„êµ ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">Re</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
        <span class="c1"># ìœ ì„ </span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">25</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Re = </span><span class="si">{</span><span class="n">Re</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

        <span class="c1"># ì™€ë„</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega</span><span class="p">)))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=-</span><span class="n">vmax</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ìœ ì„ &#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ì™€ë„&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;ë ˆì´ë†€ì¦ˆ ìˆ˜ì— ë”°ë¥¸ Lid-Driven Cavity ìœ ë™ íŒ¨í„´&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cavity_reynolds_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># reynolds_effect_cavity()</span>
</code></pre></div>

<hr />
<h2 id="4-staggered-grid">4. ì—‡ê°ˆë¦° ê²©ì (Staggered Grid)<a class="header-link" href="#4-staggered-grid" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ë™ì¼ ìœ„ì¹˜ ê²©ìì˜ ë¬¸ì œì <a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ë™ì¼ ìœ„ì¹˜ ê²©ì (Collocated Grid):
<span class="k">-</span> ëª¨ë“  ë³€ìˆ˜ (u, v, p)ê°€ ê°™ì€ ìœ„ì¹˜ì— ì €ì¥
<span class="k">-</span> ì••ë ¥ì˜ ì¤‘ì‹¬ì°¨ë¶„: (p_{i+1} - p_{i-1})/(2Î”x)
<span class="k">-</span> ë¬¸ì œ: ì²´ì»¤ë³´ë“œ (checkerboard) ë¶ˆì•ˆì •ì„±

ì²´ì»¤ë³´ë“œ í˜„ìƒ:
<span class="k">-</span> ì••ë ¥ ì§„ë™ì´ ìˆ˜ì¹˜í•´ì— ì˜í–¥ ì—†ìŒ
<span class="k">-</span> p(i) = p0 + (-1)^i * Îµ í˜•íƒœì˜ ì§„ë™
<span class="k">-</span> ì¤‘ì‹¬ì°¨ë¶„ì—ì„œ ì§„ë™ì´ ìƒì‡„ë¨
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">checkerboard_problem</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì²´ì»¤ë³´ë“œ ë¶ˆì•ˆì •ì„± ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># (1) ë™ì¼ ìœ„ì¹˜ ê²©ì</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;u,v,p&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë™ì¼ ìœ„ì¹˜ ê²©ì (Collocated)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (2) ì²´ì»¤ë³´ë“œ ì••ë ¥</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="n">Y</span><span class="p">)</span>  <span class="c1"># ì²´ì»¤ë³´ë“œ íŒ¨í„´</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">Y</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì²´ì»¤ë³´ë“œ ì••ë ¥ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

    <span class="c1"># ì••ë ¥ êµ¬ë°° (ì¤‘ì‹¬ì°¨ë¶„ = 0!)</span>
    <span class="n">dpdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">dpdx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># í•­ìƒ 0!</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ì¤‘ì‹¬ì°¨ë¶„ âˆ‚p/âˆ‚x = 0 (ì˜ëª»ë¨!)&#39;</span><span class="p">)</span>

    <span class="c1"># (3) ì—‡ê°ˆë¦° ê²©ì</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="c1"># ì••ë ¥ ì  (ì…€ ì¤‘ì‹¬)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;p&#39;</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># u-ì†ë„ ì  (ìˆ˜ì§ ë©´)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&gt;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;u&#39;</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># v-ì†ë„ ì  (ìˆ˜í‰ ë©´)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;g^&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># ê²©ìì„ </span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì—‡ê°ˆë¦° ê²©ì (Staggered)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;staggered_grid.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># checkerboard_problem()</span>
</code></pre></div>

<h3 id="42">4.2 ì—‡ê°ˆë¦° ê²©ì êµ¬ì¡°<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ì—‡ê°ˆë¦° ê²©ì (MAC Grid):

     v(i,j+1)
        â”‚
  â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€
  â”‚     â”‚     â”‚
  â”‚  p(i,j)   â”‚
u(i,j)â”€â”¼â”€â”€u(i+1,j)
  â”‚     â”‚     â”‚
  â”‚     â”‚     â”‚
  â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€
     v(i,j)

ì €ì¥ ìœ„ì¹˜:
- p: ì…€ ì¤‘ì‹¬ (i, j)
- u: ì…€ ë™ìª½ ë©´ (i+1/2, j)
- v: ì…€ ë¶ìª½ ë©´ (i, j+1/2)

ì¥ì :
- ì²´ì»¤ë³´ë“œ ë°©ì§€
- ì§ˆëŸ‰ ë³´ì¡´ ì •í™•
- ì••ë ¥-ì†ë„ ê²°í•© ìì—°ìŠ¤ëŸ¬ì›€
</code></pre></div>

<hr />
<h2 id="5-simple">5. SIMPLE ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#5-simple" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ê°œë…<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>SIMPLE (Semi-Implicit Method for Pressure-Linked Equations):

ê¸°ë³¸ ì•„ì´ë””ì–´:
1. ì¶”ì¸¡ ì••ë ¥ì¥ p* ì‚¬ìš©
2. ì¶”ì¸¡ ì†ë„ì¥ u*, v* ê³„ì‚° (ìš´ë™ëŸ‰ ë°©ì •ì‹)
3. ì••ë ¥ ë³´ì • p&#39; ê³„ì‚° (ì—°ì†ë°©ì •ì‹)
4. ì••ë ¥/ì†ë„ ê°±ì‹ : p = p* + p&#39;, u = u* + u&#39;
5. ìˆ˜ë ´ê¹Œì§€ ë°˜ë³µ

í•µì‹¬ ë°©ì •ì‹:
âˆ‡Â²p&#39; = Ï/Î”t Â· âˆ‡Â·u*

ì—¬ê¸°ì„œ p&#39; = p - p* (ì••ë ¥ ë³´ì •)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simple_algorithm_concept</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;SIMPLE ì•Œê³ ë¦¬ì¦˜ ê°œë… ì„¤ëª…&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPLE ì•Œê³ ë¦¬ì¦˜ íë¦„ë„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="n">flowchart</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚           ì´ˆê¸° ì¶”ì¸¡: p*, u*, v*           â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="s2">                        â”‚</span>
<span class="s2">                        â–¼</span>
<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚  Step 1: ìš´ë™ëŸ‰ ë°©ì •ì‹ í’€ì´               â”‚</span>
<span class="s2">    â”‚  â†’ ì¶”ì¸¡ ì†ë„ u*, v* ê³„ì‚°                  â”‚</span>
<span class="s2">    â”‚  (ì••ë ¥ p* ì‚¬ìš©)                           â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="s2">                        â”‚</span>
<span class="s2">                        â–¼</span>
<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚  Step 2: ì••ë ¥ ë³´ì • ë°©ì •ì‹ í’€ì´            â”‚</span>
<span class="s2">    â”‚  âˆ‡Â²p&#39; = (Ï/Î”t) âˆ‡Â·u*                      â”‚</span>
<span class="s2">    â”‚  (u*ì˜ ë°œì‚° = ì§ˆëŸ‰ ë¶ˆê· í˜•)                â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="s2">                        â”‚</span>
<span class="s2">                        â–¼</span>
<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚  Step 3: ì••ë ¥/ì†ë„ ë³´ì •                   â”‚</span>
<span class="s2">    â”‚  p = p* + Î±pÂ·p&#39;                          â”‚</span>
<span class="s2">    â”‚  u = u* - (Î”t/Ï)Â·âˆ‚p&#39;/âˆ‚x                  â”‚</span>
<span class="s2">    â”‚  v = v* - (Î”t/Ï)Â·âˆ‚p&#39;/âˆ‚y                  â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="s2">                        â”‚</span>
<span class="s2">                        â–¼</span>
<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚  ìˆ˜ë ´ í™•ì¸: |âˆ‡Â·u| &lt; Îµ ?                   â”‚</span>
<span class="s2">    â”‚                                          â”‚</span>
<span class="s2">    â”‚  No â†’ p* = p, u* = u, v* = v (ë°˜ë³µ)      â”‚</span>
<span class="s2">    â”‚  Yes â†’ ì¢…ë£Œ                               â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="s2">    Under-relaxation ê³„ìˆ˜:</span>
<span class="s2">    - Î±p ~ 0.3 (ì••ë ¥)</span>
<span class="s2">    - Î±u ~ 0.7 (ì†ë„)</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">flowchart</span><span class="p">)</span>

<span class="n">simple_algorithm_concept</span><span class="p">()</span>
</code></pre></div>

<h3 id="52-simple">5.2 SIMPLE ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„<a class="header-link" href="#52-simple" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simple_lid_driven_cavity</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SIMPLE ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ Lid-Driven Cavity í’€ì´</span>
<span class="sd">    ì—‡ê°ˆë¦° ê²©ì ì‚¬ìš©</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ê²©ì ì„¤ì •</span>
    <span class="n">Nx</span> <span class="o">=</span> <span class="mi">32</span>  <span class="c1"># ì…€ ìˆ˜ (x ë°©í–¥)</span>
    <span class="n">Ny</span> <span class="o">=</span> <span class="mi">32</span>  <span class="c1"># ì…€ ìˆ˜ (y ë°©í–¥)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">Nx</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">Ny</span>

    <span class="c1"># ë¬¼ì„±ì¹˜</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">Re</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="n">mu</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reynolds number: Re = </span><span class="si">{</span><span class="n">Re</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Under-relaxation</span>
    <span class="n">alpha_u</span> <span class="o">=</span> <span class="mf">0.7</span>
    <span class="n">alpha_p</span> <span class="o">=</span> <span class="mf">0.3</span>

    <span class="c1"># ë°°ì—´ ì´ˆê¸°í™” (ì—‡ê°ˆë¦° ê²©ì)</span>
    <span class="c1"># u: (Ny, Nx+1) - ìˆ˜ì§ ë©´</span>
    <span class="c1"># v: (Ny+1, Nx) - ìˆ˜í‰ ë©´</span>
    <span class="c1"># p: (Ny, Nx) - ì…€ ì¤‘ì‹¬</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Nx</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span><span class="p">))</span>
    <span class="n">p_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span><span class="p">))</span>

    <span class="c1"># ê²½ê³„ì¡°ê±´</span>
    <span class="n">U_lid</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_boundary_conditions</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ê²½ê³„ì¡°ê±´ ì ìš©&quot;&quot;&quot;</span>
        <span class="k">nonlocal</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>

        <span class="c1"># ìƒë‹¨ (lid): u = U_lid</span>
        <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">U_lid</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># ì„ í˜• ì™¸ì‚½ (ë²½ë©´ì—ì„œ U_lid)</span>

        <span class="c1"># í•˜ë‹¨: u = 0</span>
        <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># ì„ í˜• ì™¸ì‚½</span>

        <span class="c1"># ì¢Œ/ìš°: u = 0 (ì´ë¯¸ 0)</span>
        <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">u</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># v ê²½ê³„ì¡°ê±´</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># í•˜ë‹¨</span>
        <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># ìƒë‹¨</span>
        <span class="n">v</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">v</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>   <span class="c1"># ì¢Œì¸¡</span>
        <span class="n">v</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">v</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># ìš°ì¸¡</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_momentum</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ìš´ë™ëŸ‰ ë°©ì •ì‹ í’€ì´ (ì¶”ì¸¡ ì†ë„)&quot;&quot;&quot;</span>
        <span class="n">u_star</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">v_star</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># u-ìš´ë™ëŸ‰</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nx</span><span class="p">):</span>
                <span class="c1"># ëŒ€ë¥˜í•­ (í’ìƒ)</span>
                <span class="n">u_face</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">u_face</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">dudx</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dudx</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span> <span class="k">else</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>

                <span class="n">v_face</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span>
                                <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>

                <span class="k">if</span> <span class="n">v_face</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">dudy</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dudy</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span>

                <span class="c1"># í™•ì‚°í•­</span>
                <span class="n">d2udx2</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="n">d2udy2</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span>

                <span class="c1"># ì••ë ¥ êµ¬ë°°</span>
                <span class="n">dpdx</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span> <span class="o">/</span> <span class="n">dx</span>

                <span class="c1"># ì‹œê°„ ì „ì§„</span>
                <span class="n">conv</span> <span class="o">=</span> <span class="n">u_face</span> <span class="o">*</span> <span class="n">dudx</span> <span class="o">+</span> <span class="n">v_face</span> <span class="o">*</span> <span class="n">dudy</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">d2udx2</span> <span class="o">+</span> <span class="n">d2udy2</span><span class="p">)</span>
                <span class="n">u_star</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">conv</span> <span class="o">-</span> <span class="n">dpdx</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">+</span> <span class="n">diff</span><span class="p">)</span>

        <span class="c1"># v-ìš´ë™ëŸ‰ (ìœ ì‚¬í•˜ê²Œ)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ny</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">u_face</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="n">u</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">u_face</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">dvdx</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dvdx</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>

                <span class="n">v_face</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">v_face</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">dvdy</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dvdy</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">Ny</span> <span class="k">else</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span>

                <span class="n">d2vdx2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">d2vdy2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">Ny</span> <span class="k">else</span> <span class="mi">0</span>

                <span class="n">dpdy</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span>

                <span class="n">conv</span> <span class="o">=</span> <span class="n">u_face</span> <span class="o">*</span> <span class="n">dvdx</span> <span class="o">+</span> <span class="n">v_face</span> <span class="o">*</span> <span class="n">dvdy</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">d2vdx2</span> <span class="o">+</span> <span class="n">d2vdy2</span><span class="p">)</span>
                <span class="n">v_star</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">conv</span> <span class="o">-</span> <span class="n">dpdy</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">+</span> <span class="n">diff</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">u_star</span><span class="p">,</span> <span class="n">v_star</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_pressure_correction</span><span class="p">(</span><span class="n">u_star</span><span class="p">,</span> <span class="n">v_star</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì••ë ¥ ë³´ì • ë°©ì •ì‹ í’€ì´&quot;&quot;&quot;</span>
        <span class="n">p_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
            <span class="n">p_old</span> <span class="o">=</span> <span class="n">p_prime</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
                    <span class="c1"># ì§ˆëŸ‰ ë¶ˆê· í˜• (ë°œì‚°)</span>
                    <span class="n">div</span> <span class="o">=</span> <span class="p">((</span><span class="n">u_star</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u_star</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span> <span class="o">+</span>
                          <span class="p">(</span><span class="n">v_star</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">v_star</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span><span class="p">)</span>

                    <span class="c1"># ì´ì›ƒ ì••ë ¥</span>
                    <span class="n">p_E</span> <span class="o">=</span> <span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">p_W</span> <span class="o">=</span> <span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">p_N</span> <span class="o">=</span> <span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">p_S</span> <span class="o">=</span> <span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

                    <span class="c1"># Poisson ë°©ì •ì‹ ê³„ìˆ˜</span>
                    <span class="n">aE</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">aW</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">aN</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dy</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">aS</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dy</span><span class="o">**</span><span class="mi">2</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="n">aP</span> <span class="o">=</span> <span class="n">aE</span> <span class="o">+</span> <span class="n">aW</span> <span class="o">+</span> <span class="n">aN</span> <span class="o">+</span> <span class="n">aS</span>

                    <span class="k">if</span> <span class="n">aP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">aE</span><span class="o">*</span><span class="n">p_E</span> <span class="o">+</span> <span class="n">aW</span><span class="o">*</span><span class="n">p_W</span> <span class="o">+</span> <span class="n">aN</span><span class="o">*</span><span class="n">p_N</span> <span class="o">+</span> <span class="n">aS</span><span class="o">*</span><span class="n">p_S</span> <span class="o">-</span>
                                        <span class="n">rho</span><span class="o">/</span><span class="n">dt</span> <span class="o">*</span> <span class="n">div</span><span class="p">)</span> <span class="o">/</span> <span class="n">aP</span>

        <span class="k">return</span> <span class="n">p_prime</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">correct_velocity</span><span class="p">(</span><span class="n">u_star</span><span class="p">,</span> <span class="n">v_star</span><span class="p">,</span> <span class="n">p_prime</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">rho</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ì†ë„ ë³´ì •&quot;&quot;&quot;</span>
        <span class="n">u_new</span> <span class="o">=</span> <span class="n">u_star</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">v_new</span> <span class="o">=</span> <span class="n">v_star</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># u ë³´ì •</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nx</span><span class="p">):</span>
                <span class="n">dpdx</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
                <span class="n">u_new</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_star</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">dpdx</span>

        <span class="c1"># v ë³´ì •</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ny</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
                <span class="n">dpdy</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_prime</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span>
                <span class="n">v_new</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_star</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">dpdy</span>

        <span class="k">return</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span>

    <span class="c1"># ì‹œë®¬ë ˆì´ì…˜</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="n">n_outer</span> <span class="o">=</span> <span class="mi">500</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SIMPLE ì•Œê³ ë¦¬ì¦˜ ì‹œì‘...&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_outer</span><span class="p">):</span>
        <span class="n">apply_boundary_conditions</span><span class="p">()</span>

        <span class="c1"># 1. ìš´ë™ëŸ‰ ë°©ì •ì‹</span>
        <span class="n">u_star</span><span class="p">,</span> <span class="n">v_star</span> <span class="o">=</span> <span class="n">solve_momentum</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

        <span class="c1"># 2. ì••ë ¥ ë³´ì •</span>
        <span class="n">p_prime</span> <span class="o">=</span> <span class="n">solve_pressure_correction</span><span class="p">(</span><span class="n">u_star</span><span class="p">,</span> <span class="n">v_star</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>

        <span class="c1"># 3. ì†ë„/ì••ë ¥ ë³´ì •</span>
        <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span> <span class="o">=</span> <span class="n">correct_velocity</span><span class="p">(</span><span class="n">u_star</span><span class="p">,</span> <span class="n">v_star</span><span class="p">,</span> <span class="n">p_prime</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>
        <span class="n">p_new</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">alpha_p</span> <span class="o">*</span> <span class="n">p_prime</span>

        <span class="c1"># Under-relaxation</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">alpha_u</span> <span class="o">*</span> <span class="n">u_new</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha_u</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">alpha_u</span> <span class="o">*</span> <span class="n">v_new</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha_u</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p_new</span>

        <span class="c1"># ìˆ˜ë ´ ì²´í¬</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">div_max</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
                    <span class="n">div</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span> <span class="o">+</span>
                             <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dy</span><span class="p">)</span>
                    <span class="n">div_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">div_max</span><span class="p">,</span> <span class="n">div</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: max|div(u)| = </span><span class="si">{</span><span class="n">div_max</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì™„ë£Œ!&quot;</span><span class="p">)</span>

    <span class="c1"># ì…€ ì¤‘ì‹¬ ì†ë„ë¡œ ë³€í™˜</span>
    <span class="n">u_center</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
    <span class="n">v_center</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:])</span>

    <span class="c1"># ê²°ê³¼ ì‹œê°í™”</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Nx</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="n">dy</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ny</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># ì†ë„ ë²¡í„°</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u_center</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v_center</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">u_center</span><span class="p">,</span> <span class="n">v_center</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">speed</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span>
                  <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ìœ ì„  (SIMPLE), Re = </span><span class="si">{</span><span class="n">Re</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># ì••ë ¥ ë¶„í¬</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì••ë ¥ ë¶„í¬&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># ì¤‘ì‹¬ì„  ì†ë„</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">j_center</span> <span class="o">=</span> <span class="n">Nx</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_center</span><span class="p">[:,</span> <span class="n">j_center</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìˆ˜ì§ ì¤‘ì‹¬ì„  u-ì†ë„&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;simple_cavity.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span>

<span class="c1"># u, v, p = simple_lid_driven_cavity()</span>
</code></pre></div>

<hr />
<h2 id="6-simple">6. SIMPLE ë³€í˜• ì•Œê³ ë¦¬ì¦˜<a class="header-link" href="#6-simple" title="Permanent link">&para;</a></h2>
<h3 id="61-simpler-simplec-piso">6.1 SIMPLER, SIMPLEC, PISO<a class="header-link" href="#61-simpler-simplec-piso" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>SIMPLE ë³€í˜•:

1. SIMPLER (SIMPLE Revised):
   - ì••ë ¥ ì§ì ‘ ê³„ì‚° (ì¶”ì¸¡ ë¶ˆí•„ìš”)
   - ìˆ˜ë ´ ë¹ ë¦„
   - ê³„ì‚°ëŸ‰ ì¦ê°€

2. SIMPLEC (SIMPLE Consistent):
   - ì´ì›ƒ ì†ë„ ë³´ì •í•­ ê³ ë ¤
   - Under-relaxation ëœ í•„ìš”
   - ìˆ˜ë ´ ê°œì„ 

3. PISO (Pressure-Implicit with Splitting of Operators):
   - ë¹„ì •ìƒ ë¬¸ì œì— ì í•©
   - ì¶”ê°€ ì••ë ¥/ì†ë„ ë³´ì •
   - ì‹œê°„ ì •í™•ë„ í–¥ìƒ

ì„ íƒ ê°€ì´ë“œ:
- ì •ìƒ ë¬¸ì œ: SIMPLE ë˜ëŠ” SIMPLEC
- ë¹„ì •ìƒ ë¬¸ì œ: PISO
- ë¹ ë¥¸ ìˆ˜ë ´ í•„ìš”: SIMPLER
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">algorithm_comparison</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì•Œê³ ë¦¬ì¦˜ ë¹„êµ ê°œë…ë„&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPLE ê³„ì—´ ì•Œê³ ë¦¬ì¦˜ ë¹„êµ&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="n">comparison</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚  ì•Œê³ ë¦¬ì¦˜   â”‚   SIMPLE   â”‚  SIMPLEC   â”‚    PISO    â”‚</span>
<span class="s2">    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="s2">    â”‚ ì••ë ¥ ë³´ì •   â”‚    1íšŒ     â”‚    1íšŒ     â”‚   2+íšŒ     â”‚</span>
<span class="s2">    â”‚ ë°˜ë³µ/ì‹œê°„   â”‚   ë§ìŒ     â”‚   ì ìŒ     â”‚   ì ìŒ     â”‚</span>
<span class="s2">    â”‚ Î±p         â”‚  0.3~0.5   â”‚  0.7~1.0   â”‚    1.0     â”‚</span>
<span class="s2">    â”‚ ì ìš© ë¶„ì•¼   â”‚   ì •ìƒ     â”‚   ì •ìƒ     â”‚   ë¹„ì •ìƒ   â”‚</span>
<span class="s2">    â”‚ ê³„ì‚° ë¹„ìš©   â”‚   ë‚®ìŒ     â”‚   ì¤‘ê°„     â”‚   ë†’ìŒ     â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="s2">    ê° ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ ì°¨ì´:</span>

<span class="s2">    SIMPLE:</span>
<span class="s2">    - í‘œì¤€ ë°©ë²•, ê°„ë‹¨í•˜ê³  ê²¬ê³ í•¨</span>
<span class="s2">    - Under-relaxation í•„ìˆ˜ (Î±p ~ 0.3)</span>

<span class="s2">    SIMPLEC:</span>
<span class="s2">    - ì†ë„ ë³´ì • ì‹œ ì´ì›ƒ ê¸°ì—¬ ê³ ë ¤</span>
<span class="s2">    - Î±pë¥¼ 1ì— ê°€ê¹ê²Œ ì‚¬ìš© ê°€ëŠ¥</span>

<span class="s2">    PISO:</span>
<span class="s2">    - ë¹„ì •ìƒ ë¬¸ì œë¥¼ ìœ„í•œ predictor-corrector</span>
<span class="s2">    - ê° ì‹œê°„ ë‹¨ê³„ì—ì„œ 2íšŒ ì´ìƒ ë³´ì •</span>
<span class="s2">    - Courant ìˆ˜ 1 ì´í•˜ í•„ìš”</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">comparison</span><span class="p">)</span>

<span class="n">algorithm_comparison</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7">7. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="1-">ì—°ìŠµ 1: ìœ ë™í•¨ìˆ˜-ì™€ë„<a class="header-link" href="#1-" title="Permanent link">&para;</a></h3>
<p>ìœ ë™í•¨ìˆ˜ Ïˆ = xyì— í•´ë‹¹í•˜ëŠ” ì†ë„ì¥ê³¼ ì™€ë„ë¥¼ êµ¬í•˜ê³ , ì´ê²ƒì´ ë¹„ì••ì¶•ì„± ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ”ì§€ í™•ì¸í•˜ì‹œì˜¤.</p>
<h3 id="2-lid-driven-cavity">ì—°ìŠµ 2: Lid-Driven Cavity<a class="header-link" href="#2-lid-driven-cavity" title="Permanent link">&para;</a></h3>
<p>Re = 400ì—ì„œ Lid-Driven Cavity ì‹œë®¬ë ˆì´ì…˜ì„ ìˆ˜í–‰í•˜ê³ , Re = 100 ê²°ê³¼ì™€ ë¹„êµí•˜ì‹œì˜¤. ì½”ë„ˆ ì™€ë¥˜ì˜ ë°œë‹¬ì„ ê´€ì°°í•˜ì‹œì˜¤.</p>
<h3 id="3-simple-under-relaxation">ì—°ìŠµ 3: SIMPLE Under-relaxation<a class="header-link" href="#3-simple-under-relaxation" title="Permanent link">&para;</a></h3>
<p>SIMPLE ì•Œê³ ë¦¬ì¦˜ì—ì„œ under-relaxation ê³„ìˆ˜ Î±pë¥¼ 0.1, 0.3, 0.5ë¡œ ë³€í™”ì‹œí‚¤ë©° ìˆ˜ë ´ ì†ë„ë¥¼ ë¹„êµí•˜ì‹œì˜¤.</p>
<h3 id="4">ì—°ìŠµ 4: ê²©ì ìˆ˜ë ´<a class="header-link" href="#4" title="Permanent link">&para;</a></h3>
<p>Lid-Driven Cavity ë¬¸ì œì—ì„œ ê²©ì í¬ê¸°ë¥¼ 16x16, 32x32, 64x64ë¡œ ë³€í™”ì‹œí‚¤ë©° ìˆ˜ì¹˜í•´ì˜ ìˆ˜ë ´ì„ ë¶„ì„í•˜ì‹œì˜¤.</p>
<hr />
<h2 id="8">8. ì°¸ê³ ìë£Œ<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="_2">í•µì‹¬ ë…¼ë¬¸<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Ghia et al. (1982) "High-Re Solutions for Incompressible Flow Using the Navier-Stokes Equations and a Multigrid Method" - Lid-Driven Cavity ë²¤ì¹˜ë§ˆí¬</li>
<li>Patankar &amp; Spalding (1972) "A calculation procedure for heat, mass and momentum transfer in three-dimensional parabolic flows" - SIMPLE ì•Œê³ ë¦¬ì¦˜</li>
</ul>
<h3 id="_3">êµì¬<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<ul>
<li>Patankar, "Numerical Heat Transfer and Fluid Flow" (SIMPLE ìƒì„¸)</li>
<li>Ferziger &amp; Peric, "Computational Methods for Fluid Dynamics"</li>
<li>Moukalled et al., "The Finite Volume Method in Computational Fluid Dynamics"</li>
</ul>
<h3 id="cfd">CFD ì½”ë“œ<a class="header-link" href="#cfd" title="Permanent link">&para;</a></h3>
<ul>
<li>OpenFOAM: icoFoam (ë¹„ì••ì¶•ì„± ì¸µë¥˜)</li>
<li>SIMPLE êµ¬í˜„ íŠœí† ë¦¬ì–¼: CFD-Online, PyFR</li>
</ul>
<hr />
<h2 id="_4">ìš”ì•½<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>ë¹„ì••ì¶•ì„± ìœ ë™ í•µì‹¬:

1. ì§€ë°°ë°©ì •ì‹:
   - ì—°ì†: âˆ‡Â·u = 0
   - ìš´ë™ëŸ‰: Du/Dt = -âˆ‡p/Ï + Î½âˆ‡Â²u

2. ì •ì‹í™” ë°©ë²•:
   a) ìœ ë™í•¨ìˆ˜-ì™€ë„ (2D):
      - âˆ‡Â²Ïˆ = -Ï‰
      - âˆ‚Ï‰/âˆ‚t + (uÂ·âˆ‡)Ï‰ = Î½âˆ‡Â²Ï‰
   b) ì›ì‹œë³€ìˆ˜ + SIMPLE:
      - ì••ë ¥-ì†ë„ ê²°í•© ì²˜ë¦¬

3. ì—‡ê°ˆë¦° ê²©ì:
   - ì²´ì»¤ë³´ë“œ ë°©ì§€
   - u, vëŠ” ì…€ ë©´, pëŠ” ì…€ ì¤‘ì‹¬

4. SIMPLE ì•Œê³ ë¦¬ì¦˜:
   â‘  ì¶”ì¸¡ ì••ë ¥ìœ¼ë¡œ ìš´ë™ëŸ‰ ë°©ì •ì‹
   â‘¡ ì••ë ¥ ë³´ì • Poisson ë°©ì •ì‹
   â‘¢ ì†ë„/ì••ë ¥ ê°±ì‹ 
   â‘£ ìˆ˜ë ´ê¹Œì§€ ë°˜ë³µ

5. ìˆ˜ì¹˜ì  ê³ ë ¤ì‚¬í•­:
   - Under-relaxation: Î±p ~ 0.3, Î±u ~ 0.7
   - ê²©ì ìˆ˜ë ´ í™•ì¸ í•„ìˆ˜
   - CFL ì¡°ê±´ ì¤€ìˆ˜
</code></pre></div>

<hr />
<p>ë‹¤ìŒ ë ˆìŠ¨ì—ì„œëŠ” ì „ìê¸°í•™ì˜ ìˆ˜ì¹˜í•´ì„ê³¼ Maxwell ë°©ì •ì‹ì˜ ì´ì‚°í™”ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/13_CFD_Basics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">13. CFD ê¸°ì´ˆ (Computational Fluid Dynamics Basics)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/15_Electromagnetics_Numerical.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">15. ì „ìê¸°í•™ ìˆ˜ì¹˜í•´ì„ (Computational Electromagnetics)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}