{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>17. MHD ê¸°ì´ˆ ì´ë¡  (Magnetohydrodynamics Basics) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Numerical_Simulation/">Numerical Simulation</a>
    <span class="separator">/</span>
    <span class="current">17. MHD ê¸°ì´ˆ ì´ë¡  (Magnetohydrodynamics Basics)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>17. MHD ê¸°ì´ˆ ì´ë¡  (Magnetohydrodynamics Basics)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/16_FDTD_Implementation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">16. FDTD êµ¬í˜„ (FDTD Implementation)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/18_MHD_Numerical_Methods.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">18. MHD ìˆ˜ì¹˜í•´ë²• (MHD Numerical Methods)</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1-mhd">1. MHD ì†Œê°œ</a><ul>
<li><a href="#11">1.1 ì •ì˜ì™€ ì‘ìš©</a></li>
<li><a href="#12-mhd">1.2 MHD ì‹œê°„/ê³µê°„ ìŠ¤ì¼€ì¼</a></li>
</ul>
</li>
<li><a href="#2-mhd">2. MHD ê°€ì •</a><ul>
<li><a href="#21">2.1 ê¸°ë³¸ ê°€ì •</a></li>
</ul>
</li>
<li><a href="#3-mhd">3. ì´ìƒ MHD ë°©ì •ì‹</a><ul>
<li><a href="#31">3.1 ì§€ë°° ë°©ì •ì‹</a></li>
</ul>
</li>
<li><a href="#4-alfven">4. Alfven ì†ë„</a><ul>
<li><a href="#41">4.1 ì •ì˜ì™€ ë¬¼ë¦¬ì  ì˜ë¯¸</a></li>
</ul>
</li>
<li><a href="#5-mhd">5. MHD íŒŒë™</a><ul>
<li><a href="#51">5.1 íŒŒë™ ìœ í˜•</a></li>
<li><a href="#52-alfven">5.2 Alfven íŒŒ ì‹œê°í™”</a></li>
</ul>
</li>
<li><a href="#6">6. ìê¸°ì••ê³¼ ìê¸°ì¥ë ¥</a><ul>
<li><a href="#61">6.1 í˜ì˜ ë¶„í•´</a></li>
</ul>
</li>
<li><a href="#7-frozen-in">7. Frozen-in ì •ë¦¬</a><ul>
<li><a href="#71">7.1 ìê¸°ì¥ ë™ê²° ì¡°ê±´</a></li>
</ul>
</li>
<li><a href="#8">8. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-alfven">ì—°ìŠµ 1: Alfven ì†ë„</a></li>
<li><a href="#2-mhd_1">ì—°ìŠµ 2: MHD íŒŒë™ ì†ë„</a></li>
<li><a href="#3">ì—°ìŠµ 3: ìê¸°ì•• í‰í˜•</a></li>
<li><a href="#4-frozen-in">ì—°ìŠµ 4: Frozen-in</a></li>
</ul>
</li>
<li><a href="#9">9. ì°¸ê³ ìë£Œ</a><ul>
<li><a href="#_2">í•µì‹¬ êµì¬</a></li>
<li><a href="#_3">ë…¼ë¬¸/ë¦¬ë·°</a></li>
<li><a href="#_4">ì˜¨ë¼ì¸ ìë£Œ</a></li>
</ul>
</li>
<li><a href="#_5">ìš”ì•½</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="17-mhd-magnetohydrodynamics-basics">17. MHD ê¸°ì´ˆ ì´ë¡  (Magnetohydrodynamics Basics)<a class="header-link" href="#17-mhd-magnetohydrodynamics-basics" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ìê¸°ìœ ì²´ì—­í•™(MHD)ì˜ ê¸°ë³¸ ê°œë… ì´í•´</li>
<li>MHD ê°€ì •ê³¼ ì ìš© ë²”ìœ„ íŒŒì•…</li>
<li>ì´ìƒ MHD ë°©ì •ì‹ ìœ ë„</li>
<li>Alfven ì†ë„ì™€ MHD íŒŒë™ ì´í•´</li>
<li>ìê¸°ì••ê³¼ ìê¸°ì¥ë ¥ ê°œë… í•™ìŠµ</li>
</ul>
<hr />
<h2 id="1-mhd">1. MHD ì†Œê°œ<a class="header-link" href="#1-mhd" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ì •ì˜ì™€ ì‘ìš©<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ìê¸°ìœ ì²´ì—­í•™ (Magnetohydrodynamics, MHD):
- ì „ê¸° ì „ë„ì„± ìœ ì²´ì™€ ì „ìê¸°ì¥ì˜ ìƒí˜¸ì‘ìš©
- ìœ ì²´ì—­í•™ + ì „ìê¸°í•™ì˜ ê²°í•©

ì‘ìš© ë¶„ì•¼:
1. ì²œì²´ë¬¼ë¦¬: íƒœì–‘, í•­ì„±, ì€í•˜, ì„±ê°„ ë§¤ì§ˆ
2. í•µìœµí•©: í† ì¹´ë§‰, ìŠ¤í…”ëŸ¬ë ˆì´í„° í”Œë¼ì¦ˆë§ˆ ê°€ë‘ 
3. ì§€êµ¬ë¬¼ë¦¬: ì§€êµ¬ ìê¸°ì¥ ë‹¤ì´ë‚˜ëª¨
4. ê³µí•™: MHD ë°œì „, ì „ìê¸° íŒí”„, ê¸ˆì† ì£¼ì¡°
5. ìš°ì£¼ë¬¼ë¦¬: íƒœì–‘í’, ìê¸°ê¶Œ, ìš°ì£¼ ë‚ ì”¨

ì—­ì‚¬:
- AlfvÃ©n (1942): MHD íŒŒë™ ë°œê²¬ â†’ 1970 ë…¸ë²¨ ë¬¼ë¦¬í•™ìƒ
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>

<span class="c1"># ë¬¼ë¦¬ ìƒìˆ˜</span>
<span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-7</span>  <span class="c1"># ì§„ê³µ íˆ¬ììœ¨ [H/m]</span>
<span class="n">eps0</span> <span class="o">=</span> <span class="mf">8.854e-12</span>        <span class="c1"># ì§„ê³µ ìœ ì „ìœ¨ [F/m]</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>           <span class="c1"># ê´‘ì† [m/s]</span>
<span class="n">kB</span> <span class="o">=</span> <span class="mf">1.381e-23</span>          <span class="c1"># ë³¼ì¸ ë§Œ ìƒìˆ˜ [J/K]</span>
<span class="n">me</span> <span class="o">=</span> <span class="mf">9.109e-31</span>          <span class="c1"># ì „ì ì§ˆëŸ‰ [kg]</span>
<span class="n">mp</span> <span class="o">=</span> <span class="mf">1.673e-27</span>          <span class="c1"># ì–‘ì„±ì ì§ˆëŸ‰ [kg]</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">1.602e-19</span>           <span class="c1"># ê¸°ë³¸ ì „í•˜ [C]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mhd_introduction</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MHD ê°œìš”&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ìê¸°ìœ ì²´ì—­í•™ (MHD) ê°œìš”&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="n">intro</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    MHDì˜ í•µì‹¬ ê°œë…:</span>

<span class="s2">    1. ì „ë„ì„± ìœ ì²´:</span>
<span class="s2">       - í”Œë¼ì¦ˆë§ˆ, ì•¡ì²´ ê¸ˆì†, ì—¼ìˆ˜</span>
<span class="s2">       - ììœ  ì „í•˜ê°€ ì „ìê¸°ì¥ì— ë°˜ì‘</span>
<span class="s2">       - ì „ê¸° ì „ë„ë„ Ïƒ &gt; 0</span>

<span class="s2">    2. ìœ ì²´-ìê¸°ì¥ ìƒí˜¸ì‘ìš©:</span>
<span class="s2">       - ìê¸°ì¥ì´ ìœ ì²´ ìš´ë™ì— í˜ì„ ê°€í•¨ (Lorentz í˜)</span>
<span class="s2">       - ìœ ì²´ ìš´ë™ì´ ìê¸°ì¥ì„ ë³€í™”ì‹œí‚´ (ìœ ë„)</span>

<span class="s2">    3. ê²°í•© ë°©ì •ì‹:</span>
<span class="s2">       - ìœ ì²´ì—­í•™: ì—°ì†, ìš´ë™ëŸ‰, ì—ë„ˆì§€</span>
<span class="s2">       - ì „ìê¸°í•™: Maxwell ë°©ì •ì‹ (ì¼ë¶€)</span>

<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚                  MHD ì˜ì—­                        â”‚</span>
<span class="s2">    â”‚                                                  â”‚</span>
<span class="s2">    â”‚    [ìœ ì²´ì—­í•™]  â†â”€â”€â”€â”€ ê²°í•© â”€â”€â”€â”€â†’  [ì „ìê¸°í•™]      â”‚</span>
<span class="s2">    â”‚                                                  â”‚</span>
<span class="s2">    â”‚    Ï, v, p         J = Ïƒ(E + vÃ—B)      E, B     â”‚</span>
<span class="s2">    â”‚    ì—°ì†/ìš´ë™ëŸ‰        Ohm&#39;s law         Maxwell  â”‚</span>
<span class="s2">    â”‚    ì—ë„ˆì§€                              (ì¼ë¶€)    â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">intro</span><span class="p">)</span>

<span class="n">mhd_introduction</span><span class="p">()</span>
</code></pre></div>

<h3 id="12-mhd">1.2 MHD ì‹œê°„/ê³µê°„ ìŠ¤ì¼€ì¼<a class="header-link" href="#12-mhd" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mhd_scales</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MHD ê´€ë ¨ ì‹œê°„/ê³µê°„ ìŠ¤ì¼€ì¼ ë¹„êµ&quot;&quot;&quot;</span>

    <span class="c1"># íƒœì–‘ ì½”ë¡œë‚˜ í”Œë¼ì¦ˆë§ˆ ì˜ˆì‹œ</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mf">1e15</span>       <span class="c1"># ë°€ë„ [m^-3]</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">1e6</span>        <span class="c1"># ì˜¨ë„ [K]</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mf">1e-2</span>       <span class="c1"># ìê¸°ì¥ [T]</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">1e8</span>        <span class="c1"># íŠ¹ì„± ê¸¸ì´ [m]</span>

    <span class="c1"># í”Œë¼ì¦ˆë§ˆ ì£¼íŒŒìˆ˜</span>
    <span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">eps0</span> <span class="o">*</span> <span class="n">me</span><span class="p">))</span>
    <span class="n">omega_pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">eps0</span> <span class="o">*</span> <span class="n">mp</span><span class="p">))</span>

    <span class="c1"># ì‚¬ì´í´ë¡œíŠ¸ë¡  ì£¼íŒŒìˆ˜</span>
    <span class="n">omega_ce</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">me</span>
    <span class="n">omega_ci</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">mp</span>

    <span class="c1"># Debye ê¸¸ì´</span>
    <span class="n">lambda_D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eps0</span> <span class="o">*</span> <span class="n">kB</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># ì—´ì†ë„</span>
    <span class="n">v_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">kB</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">me</span><span class="p">)</span>
    <span class="n">v_ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">kB</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">mp</span><span class="p">)</span>

    <span class="c1"># Alfven ì†ë„</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">mp</span>
    <span class="n">v_A</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu0</span> <span class="o">*</span> <span class="n">rho</span><span class="p">)</span>

    <span class="c1"># ìŒì†</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">kB</span> <span class="o">*</span> <span class="n">T</span>
    <span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">rho</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;í”Œë¼ì¦ˆë§ˆ ìŠ¤ì¼€ì¼ (íƒœì–‘ ì½”ë¡œë‚˜ ì˜ˆì‹œ)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì…ë ¥ íŒŒë¼ë¯¸í„°:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ë°€ë„ n = </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m^-3&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì˜¨ë„ T = </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìê¸°ì¥ B = </span><span class="si">{</span><span class="n">B</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> mT&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  íŠ¹ì„± ê¸¸ì´ L = </span><span class="si">{</span><span class="n">L</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> Mm&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì£¼íŒŒìˆ˜:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì „ì í”Œë¼ì¦ˆë§ˆ ì£¼íŒŒìˆ˜ Ï‰pe = </span><span class="si">{</span><span class="n">omega_pe</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì´ì˜¨ í”Œë¼ì¦ˆë§ˆ ì£¼íŒŒìˆ˜ Ï‰pi = </span><span class="si">{</span><span class="n">omega_pi</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì „ì ì‚¬ì´í´ë¡œíŠ¸ë¡  Ï‰ce = </span><span class="si">{</span><span class="n">omega_ce</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì´ì˜¨ ì‚¬ì´í´ë¡œíŠ¸ë¡  Ï‰ci = </span><span class="si">{</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ì†ë„:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì „ì ì—´ì†ë„ vte = </span><span class="si">{</span><span class="n">v_te</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Mm/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì´ì˜¨ ì—´ì†ë„ vti = </span><span class="si">{</span><span class="n">v_ti</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Alfven ì†ë„ vA = </span><span class="si">{</span><span class="n">v_A</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ìŒì† cs = </span><span class="si">{</span><span class="n">c_s</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ê¸¸ì´ ìŠ¤ì¼€ì¼:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Debye ê¸¸ì´ Î»D = </span><span class="si">{</span><span class="n">lambda_D</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì „ì ê´€ì„± ê¸¸ì´ c/Ï‰pe = </span><span class="si">{</span><span class="n">c</span><span class="o">/</span><span class="n">omega_pe</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ì´ì˜¨ ê´€ì„± ê¸¸ì´ c/Ï‰pi = </span><span class="si">{</span><span class="n">c</span><span class="o">/</span><span class="n">omega_pi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>

    <span class="c1"># MHD ìœ íš¨ì„± ì¡°ê±´ í™•ì¸</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MHD ìœ íš¨ì„± ì¡°ê±´:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  L &gt;&gt; Î»D: </span><span class="si">{</span><span class="n">L</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> &gt;&gt; </span><span class="si">{</span><span class="n">lambda_D</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> âœ“&quot;</span> <span class="k">if</span> <span class="n">L</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="o">*</span><span class="n">lambda_D</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;  L &gt;&gt; Î»D: </span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2"> !&gt;&gt; </span><span class="si">{</span><span class="n">lambda_D</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  L &gt;&gt; c/Ï‰pi: </span><span class="si">{</span><span class="n">L</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> &gt;&gt; </span><span class="si">{</span><span class="n">c</span><span class="o">/</span><span class="n">omega_pi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> âœ“&quot;</span> <span class="k">if</span> <span class="n">L</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="n">omega_pi</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;  L &gt;&gt; c/Ï‰pi í™•ì¸ í•„ìš”&quot;</span><span class="p">)</span>

    <span class="c1"># ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">scales</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Î»D&#39;</span><span class="p">:</span> <span class="n">lambda_D</span><span class="p">,</span>
        <span class="s1">&#39;c/Ï‰pe&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">/</span><span class="n">omega_pe</span><span class="p">,</span>
        <span class="s1">&#39;c/Ï‰pi&#39;</span><span class="p">:</span> <span class="n">c</span><span class="o">/</span><span class="n">omega_pi</span><span class="p">,</span>
        <span class="s1">&#39;vA/Ï‰ci&#39;</span><span class="p">:</span> <span class="n">v_A</span><span class="o">/</span><span class="n">omega_ci</span><span class="p">,</span>
        <span class="s1">&#39;L (MHD)&#39;</span><span class="p">:</span> <span class="n">L</span>
    <span class="p">}</span>

    <span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scales</span><span class="p">))</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scales</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scales</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;logâ‚â‚€(Length [m])&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;í”Œë¼ì¦ˆë§ˆ ê¸¸ì´ ìŠ¤ì¼€ì¼ ë¹„êµ&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MHD ìŠ¤ì¼€ì¼&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mhd_scales.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># mhd_scales()</span>
</code></pre></div>

<hr />
<h2 id="2-mhd">2. MHD ê°€ì •<a class="header-link" href="#2-mhd" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ê¸°ë³¸ ê°€ì •<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>MHDì˜ í•µì‹¬ ê°€ì •:

1. ì¤€ì¤‘ì„± (Quasi-neutrality):
   ni â‰ˆ ne = n
   - Debye ê¸¸ì´ë³´ë‹¤ í° ìŠ¤ì¼€ì¼ì—ì„œ ì„±ë¦½
   - ì „í•˜ ë¶„ë¦¬ ë¬´ì‹œ

2. ì €ì£¼íŒŒ ê·¼ì‚¬ (Low-frequency):
   Ï‰ &lt;&lt; Ï‰ci &lt;&lt; Ï‰ce
   - ë³€ìœ„ ì „ë¥˜ ë¬´ì‹œ: âˆ‚D/âˆ‚t â‰ˆ 0
   - ì „ì ê´€ì„± ë¬´ì‹œ

3. ìœ ì²´ ê·¼ì‚¬:
   L &gt;&gt; Î»mfp (í‰ê·  ììœ  ê²½ë¡œ)
   - êµ­ì†Œ ì—´í‰í˜• ê°€ì •
   - ìš´ë™ë¡ ì  íš¨ê³¼ ë¬´ì‹œ

4. ë¹„ìƒëŒ€ë¡ ì :
   v &lt;&lt; c
   - ìƒëŒ€ë¡ ì  ë³´ì • ë¶ˆí•„ìš”

ê²°ê³¼:
- Maxwell ë°©ì •ì‹ ë‹¨ìˆœí™”
- ì „ê¸°ì¥ì€ ìê¸°ì¥ê³¼ ì†ë„ì—ì„œ ìœ ë„
- ìê¸° ìœ ë„ ë°©ì •ì‹ ë„ì¶œ
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mhd_assumptions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MHD ê°€ì •ì˜ ë¬¼ë¦¬ì  ì˜ë¯¸&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MHD ê°€ì •ê³¼ Maxwell ë°©ì •ì‹ ë‹¨ìˆœí™”&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="n">assumptions</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Maxwell ë°©ì •ì‹:</span>
<span class="s2">    (1) âˆ‡Â·E = Ïc/Îµâ‚€        â† MHDì—ì„œ: ì¤€ì¤‘ì„±, Ïc â‰ˆ 0</span>
<span class="s2">    (2) âˆ‡Â·B = 0            â† ê·¸ëŒ€ë¡œ ìœ ì§€</span>
<span class="s2">    (3) âˆ‡Ã—E = -âˆ‚B/âˆ‚t       â† ê·¸ëŒ€ë¡œ ìœ ì§€</span>
<span class="s2">    (4) âˆ‡Ã—B = Î¼â‚€J + Î¼â‚€Îµâ‚€âˆ‚E/âˆ‚t  â† ë³€ìœ„ ì „ë¥˜ ë¬´ì‹œ</span>

<span class="s2">    ë‹¨ìˆœí™”ëœ Maxwell ë°©ì •ì‹ (MHD):</span>
<span class="s2">    (1&#39;) âˆ‡Â·E â‰ˆ 0 (ì¤€ì¤‘ì„±)</span>
<span class="s2">    (2&#39;) âˆ‡Â·B = 0</span>
<span class="s2">    (3&#39;) âˆ‡Ã—E = -âˆ‚B/âˆ‚t</span>
<span class="s2">    (4&#39;) âˆ‡Ã—B = Î¼â‚€J  (AmpÃ¨re ë²•ì¹™)</span>

<span class="s2">    ì¼ë°˜í™”ëœ Ohmì˜ ë²•ì¹™:</span>
<span class="s2">    E + vÃ—B = Î·J + (JÃ—B)/ne - âˆ‡pe/ne + (me/neÂ²)âˆ‚J/âˆ‚t</span>
<span class="s2">                â†‘      â†‘        â†‘           â†‘</span>
<span class="s2">             ì €í•­   Hall    ì „ìì••ë ¥    ì „ìê´€ì„±</span>

<span class="s2">    ì´ìƒ MHD (Ideal MHD):</span>
<span class="s2">    E + vÃ—B = 0  (ëª¨ë“  ìš°ë³€ í•­ ë¬´ì‹œ)</span>
<span class="s2">    â†’ ìê¸°ì¥ì´ ìœ ì²´ì™€ í•¨ê»˜ &quot;ë™ê²°&quot; (frozen-in)</span>

<span class="s2">    ì €í•­ì„± MHD (Resistive MHD):</span>
<span class="s2">    E + vÃ—B = Î·J  (ì €í•­ íš¨ê³¼ë§Œ í¬í•¨)</span>
<span class="s2">    â†’ ìê¸°ì¥ í™•ì‚° ë° ì¬ê²°í•© ê°€ëŠ¥</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">assumptions</span><span class="p">)</span>

<span class="n">mhd_assumptions</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="3-mhd">3. ì´ìƒ MHD ë°©ì •ì‹<a class="header-link" href="#3-mhd" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ì§€ë°° ë°©ì •ì‹<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ì´ìƒ MHD ë°©ì •ì‹ ì²´ê³„:

1. ì§ˆëŸ‰ ë³´ì¡´:
   âˆ‚Ï/âˆ‚t + âˆ‡Â·(Ïv) = 0

2. ìš´ë™ëŸ‰ ë³´ì¡´:
   Ï(âˆ‚v/âˆ‚t + (vÂ·âˆ‡)v) = -âˆ‡p + JÃ—B + Ïg
                            â†‘
                        Lorentz í˜

   JÃ—B = (âˆ‡Ã—B)Ã—B/Î¼â‚€ = (BÂ·âˆ‡)B/Î¼â‚€ - âˆ‡(BÂ²/2Î¼â‚€)
                          â†‘           â†‘
                      ìê¸°ì¥ë ¥     ìê¸°ì••

3. ì—ë„ˆì§€ ë³´ì¡´ (ë‹¨ì—´):
   âˆ‚/âˆ‚t(p/Ï^Î³) + vÂ·âˆ‡(p/Ï^Î³) = 0

   ë˜ëŠ”: âˆ‚p/âˆ‚t + vÂ·âˆ‡p + Î³pâˆ‡Â·v = 0

4. ìœ ë„ ë°©ì •ì‹:
   âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B)

   (E = -vÃ—B ëŒ€ì…)

5. ë°œì‚° ì¡°ê±´:
   âˆ‡Â·B = 0 (í•­ìƒ ìœ ì§€)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ideal_mhd_equations</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ì´ìƒ MHD ë°©ì •ì‹ ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ì´ìƒ MHD ë°©ì •ì‹ ì²´ê³„&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="n">equations</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ë³´ì¡´ í˜•íƒœ (Conservative Form):</span>

<span class="s2">    âˆ‚U/âˆ‚t + âˆ‡Â·F = S</span>

<span class="s2">    ì—¬ê¸°ì„œ:</span>
<span class="s2">    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="s2">    â”‚ ë³´ì¡´ ë³€ìˆ˜ U:                                             â”‚</span>
<span class="s2">    â”‚   U = [Ï, Ïv, B, E]áµ€                                    â”‚</span>
<span class="s2">    â”‚   E = p/(Î³-1) + ÏvÂ²/2 + BÂ²/2Î¼â‚€ (ì´ ì—ë„ˆì§€)              â”‚</span>
<span class="s2">    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="s2">    â”‚ í”ŒëŸ­ìŠ¤ F (x ë°©í–¥):                                       â”‚</span>
<span class="s2">    â”‚   Fâ‚ = Ïvx                        (ì§ˆëŸ‰)                â”‚</span>
<span class="s2">    â”‚   Fâ‚‚ = Ïvxv - BxB/Î¼â‚€ + P*I       (ìš´ë™ëŸ‰)               â”‚</span>
<span class="s2">    â”‚   Fâ‚ƒ = vxB - Bxv                  (ìê¸°ì¥)               â”‚</span>
<span class="s2">    â”‚   Fâ‚„ = (E + P*)vx - Bx(vÂ·B)/Î¼â‚€   (ì—ë„ˆì§€)               â”‚</span>
<span class="s2">    â”‚                                                         â”‚</span>
<span class="s2">    â”‚   P* = p + BÂ²/2Î¼â‚€ (ì´ ì••ë ¥)                             â”‚</span>
<span class="s2">    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="s2">    â”‚ 8ê°œ ë³€ìˆ˜: Ï, vx, vy, vz, Bx, By, Bz, p                  â”‚</span>
<span class="s2">    â”‚ 8ê°œ ë°©ì •ì‹: ì—°ì†(1), ìš´ë™ëŸ‰(3), ìœ ë„(3), ì—ë„ˆì§€(1)       â”‚</span>
<span class="s2">    â”‚ + ì œì•½ì¡°ê±´: âˆ‡Â·B = 0                                     â”‚</span>
<span class="s2">    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">equations</span><span class="p">)</span>

    <span class="c1"># Lorentz í˜ ì‹œê°í™”</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># (1) ìê¸° ì••ë ¥</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># ê· ì¼ ìê¸°ì¥ ì˜ì—­ê³¼ ì™¸ë¶€</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># ìê¸°ì¥ (z ë°©í–¥, ì¤‘ì‹¬ ì˜ì—­ì—ì„œ ê°•í•¨)</span>
    <span class="n">Bz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># ìê¸° ì••ë ¥ âˆ‡(BÂ²/2Î¼â‚€)</span>
    <span class="n">B_pressure</span> <span class="o">=</span> <span class="n">Bz</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu0</span><span class="p">)</span>
    <span class="n">grad_Bp_x</span><span class="p">,</span> <span class="n">grad_Bp_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">B_pressure</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">B_pressure</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$B^2/2\mu_0$ [Î¼Pa]&#39;</span><span class="p">)</span>

    <span class="c1"># ìê¸°ì•• êµ¬ë°° (í˜) í‘œì‹œ</span>
    <span class="n">skip</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="o">-</span><span class="n">grad_Bp_x</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="o">-</span><span class="n">grad_Bp_y</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ìê¸° ì••ë ¥ $-\nabla(B^2/2\mu_0)$: ë°”ê¹¥ ë°©í–¥ í˜&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># (2) ìê¸° ì¥ë ¥</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># ê³¡ì„  ìê¸°ì¥ì„ </span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]:</span>
        <span class="n">x_line</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">theta</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">y_line</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">theta</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">y_line</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

    <span class="c1"># ì¥ë ¥ ë°©í–¥ í‘œì‹œ (ê³¡ë¥  ì¤‘ì‹¬ ë°©í–¥)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]:</span>
        <span class="n">theta_arrows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">theta_arrows</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

            <span class="c1"># ê³¡ë¥  ì¤‘ì‹¬ ë°©í–¥ (ëŒ€ëµì )</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="n">x0</span> <span class="o">*</span> <span class="mf">0.3</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="n">y0</span> <span class="o">*</span> <span class="mf">0.3</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span> <span class="n">y0</span><span class="o">+</span><span class="n">dy</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ìê¸° ì¥ë ¥ $(B\cdot\nabla)B/\mu_0$: ê³¡ë¥  ì¤‘ì‹¬ ë°©í–¥&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ë²”ë¡€</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ìê¸°ë ¥ì„ &#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì¥ë ¥ ë°©í–¥&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mhd_lorentz_force.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ideal_mhd_equations()</span>
</code></pre></div>

<hr />
<h2 id="4-alfven">4. Alfven ì†ë„<a class="header-link" href="#4-alfven" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ì •ì˜ì™€ ë¬¼ë¦¬ì  ì˜ë¯¸<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Alfven ì†ë„ (AlfvÃ©n velocity):

vA = B / âˆš(Î¼â‚€Ï)

ë¬¼ë¦¬ì  ì˜ë¯¸:
- ìê¸°ë ¥ì„ ì„ ë”°ë¼ ì „íŒŒí•˜ëŠ” íš¡íŒŒì˜ ì†ë„
- ìê¸° ì—ë„ˆì§€ì™€ ìš´ë™ ì—ë„ˆì§€ì˜ ë“±ë¶„ë°°
- BÂ²/2Î¼â‚€ ~ ÏvAÂ²/2

ë¬´ì°¨ì› íŒŒë¼ë¯¸í„°:
- Alfven Mach ìˆ˜: MA = v/vA
- í”Œë¼ì¦ˆë§ˆ ë² íƒ€: Î² = 2Î¼â‚€p/BÂ² = (cs/vA)Â² Ã— 2/Î³

  Î² &lt;&lt; 1: ìê¸°ì•• ì§€ë°° (íƒœì–‘ ì½”ë¡œë‚˜)
  Î² &gt;&gt; 1: ì—´ì•• ì§€ë°° (íƒœì–‘ ëŒ€ë¥˜ê¶Œ)
  Î² ~ 1: ë‘˜ ë‹¤ ì¤‘ìš”
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">alfven_velocity_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Alfven ì†ë„ ë¶„ì„&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># (1) ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œì˜ Alfven ì†ë„</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># í™˜ê²½ë³„ íŒŒë¼ë¯¸í„°</span>
    <span class="n">environments</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;íƒœì–‘ ì½”ë¡œë‚˜&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">1e14</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">},</span>
        <span class="s1">&#39;íƒœì–‘í’ (1AU)&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">5e6</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">1e5</span><span class="p">},</span>
        <span class="s1">&#39;ì„±ê°„ ë§¤ì§ˆ&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">3e-10</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">1e4</span><span class="p">},</span>
        <span class="s1">&#39;í† ì¹´ë§‰&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">1e20</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">1e8</span><span class="p">},</span>
        <span class="s1">&#39;ì•¡ì²´ ë‚˜íŠ¸ë¥¨&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">2.5e28</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mi">400</span><span class="p">}</span>  <span class="c1"># ë°€ë„ë¥¼ ì…ì ìˆ˜ë¡œ ë³€í™˜</span>
    <span class="p">}</span>

    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">v_A_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">v_s_values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">environments</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>

        <span class="c1"># ì´ì˜¨ ì§ˆëŸ‰ (í”Œë¼ì¦ˆë§ˆëŠ” ì–‘ì„±ì, ë‚˜íŠ¸ë¥¨ì€ Na)</span>
        <span class="k">if</span> <span class="s1">&#39;ë‚˜íŠ¸ë¥¨&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">m_ion</span> <span class="o">=</span> <span class="mi">23</span> <span class="o">*</span> <span class="n">mp</span>  <span class="c1"># Na ì§ˆëŸ‰</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m_ion</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m_ion</span> <span class="o">=</span> <span class="n">mp</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m_ion</span>

        <span class="c1"># Alfven ì†ë„</span>
        <span class="n">v_A</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu0</span> <span class="o">*</span> <span class="n">rho</span><span class="p">)</span>

        <span class="c1"># ìŒì†</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">kB</span> <span class="o">*</span> <span class="n">T</span>
        <span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">rho</span><span class="p">)</span>

        <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">v_A_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_A</span><span class="p">)</span>
        <span class="n">v_s_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_s</span><span class="p">)</span>

    <span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">v_A_values</span><span class="p">),</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$v_A$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">v_s_values</span><span class="p">),</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$c_s$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;logâ‚â‚€(velocity [m/s])&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œì˜ Alfven ì†ë„ì™€ ìŒì†&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (2) í”Œë¼ì¦ˆë§ˆ ë² íƒ€ ë ˆì§</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">B_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># ìê¸°ì¥ ë²”ìœ„</span>
    <span class="n">n_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e14</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">]</span>  <span class="c1"># ë°€ë„</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">1e6</span>  <span class="c1"># ê³ ì • ì˜¨ë„</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">mp</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">kB</span> <span class="o">*</span> <span class="n">T</span>

        <span class="c1"># í”Œë¼ì¦ˆë§ˆ ë² íƒ€</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mu0</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">B_range</span><span class="o">**</span><span class="mi">2</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">B_range</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">.0e</span><span class="si">}</span><span class="s1"> mâ»Â³&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\beta = 1$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">],</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\beta &lt; 1$ (ìê¸°ì•• ì§€ë°°)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\beta &gt; 1$ (ì—´ì•• ì§€ë°°)&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;B [T]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\beta = 2\mu_0 p / B^2$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;í”Œë¼ì¦ˆë§ˆ ë² íƒ€ (T = </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s1">.0e</span><span class="si">}</span><span class="s1"> K)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;alfven_velocity.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># alfven_velocity_analysis()</span>
</code></pre></div>

<hr />
<h2 id="5-mhd">5. MHD íŒŒë™<a class="header-link" href="#5-mhd" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 íŒŒë™ ìœ í˜•<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ì´ìƒ MHDì˜ ì„¸ ê°€ì§€ íŒŒë™ ëª¨ë“œ:

1. Alfven íŒŒ (ì „ë‹¨ Alfven íŒŒ):
   - ì†ë„: vA = Bâ‚€/âˆš(Î¼â‚€Ï)
   - ë°©í–¥: ìê¸°ì¥ ë°©í–¥ìœ¼ë¡œë§Œ ì „íŒŒ
   - íŠ¹ì„±: íš¡íŒŒ, ë¹„ì••ì¶•ì„±, ìê¸°ë ¥ì„  ì§„ë™
   - ì†ë„ ì„­ë™: Î´v âŠ¥ Bâ‚€, k

2. ë¹ ë¥¸ ìê¸°ìŒíŒŒ (Fast Magnetosonic):
   - ì†ë„: vf = âˆš[(vAÂ² + csÂ²)/2 + âˆš((vAÂ² + csÂ²)Â² - 4vAÂ²csÂ²cosÂ²Î¸)/2]
   - íŠ¹ì„±: ìê¸°ì•• + ì—´ì•• ë³µì›ë ¥
   - ë“±ë°©ì  ì „íŒŒ (ëª¨ë“  ë°©í–¥)

3. ëŠë¦° ìê¸°ìŒíŒŒ (Slow Magnetosonic):
   - ì†ë„: vs = âˆš[(vAÂ² + csÂ²)/2 - âˆš((vAÂ² + csÂ²)Â² - 4vAÂ²csÂ²cosÂ²Î¸)/2]
   - íŠ¹ì„±: ìê¸°ì••ê³¼ ì—´ì••ì˜ ë°˜ëŒ€ ì‘ìš©
   - ìê¸°ì¥ ë°©í–¥ ê·¼ì²˜ë¡œ ì „íŒŒ

ì—¬ê¸°ì„œ Î¸ = âˆ (k, Bâ‚€)

íŠ¹ìˆ˜ ê²½ìš°:
- Î¸ = 0 (í‰í–‰): vf = max(vA, cs), vs = min(vA, cs)
- Î¸ = Ï€/2 (ìˆ˜ì§): vf = âˆš(vAÂ² + csÂ²), vs = 0
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mhd_wave_speeds</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MHD íŒŒë™ ì†ë„ ë¶„ì‚° ê´€ê³„&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># (1) íŒŒë™ ì†ë„ vs ì „íŒŒ ê°ë„</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># vA/cs ë¹„ìœ¨ (í”Œë¼ì¦ˆë§ˆ ë² íƒ€ ê´€ë ¨)</span>
    <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>  <span class="c1"># vA/cs</span>

    <span class="k">for</span> <span class="n">ratio</span> <span class="ow">in</span> <span class="n">ratios</span><span class="p">:</span>
        <span class="n">vA</span> <span class="o">=</span> <span class="n">ratio</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="c1"># ë¹ ë¥¸/ëŠë¦° íŒŒ</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="n">vA</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">vA</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">vA</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="n">v_fast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span>
        <span class="n">v_slow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c1"># Alfven íŒŒ (ì„±ë¶„)</span>
        <span class="n">v_alfven</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vA</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">v_fast</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Fast (vA/cs=</span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">v_slow</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Slow (vA/cs=</span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">v_alfven</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Alfven (vA/cs=</span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Î¸ [degrees]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase velocity / cs&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MHD íŒŒë™ ì†ë„ vs ì „íŒŒ ê°ë„&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>

    <span class="c1"># (2) í”„ë¦¬ë“œë¦¬íˆìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ (ê·¹ì¢Œí‘œ)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">theta_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>

    <span class="n">vA</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="n">vA</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">vA</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">vA</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_full</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">v_fast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span>
    <span class="n">v_slow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">v_alfven</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vA</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_full</span><span class="p">))</span>

    <span class="c1"># ê·¹ì¢Œí‘œ -&gt; ì§êµì¢Œí‘œ</span>
    <span class="n">x_fast</span> <span class="o">=</span> <span class="n">v_fast</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_full</span><span class="p">)</span>
    <span class="n">y_fast</span> <span class="o">=</span> <span class="n">v_fast</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_full</span><span class="p">)</span>

    <span class="n">x_slow</span> <span class="o">=</span> <span class="n">v_slow</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_full</span><span class="p">)</span>
    <span class="n">y_slow</span> <span class="o">=</span> <span class="n">v_slow</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_full</span><span class="p">)</span>

    <span class="n">x_alf</span> <span class="o">=</span> <span class="n">v_alfven</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_full</span><span class="p">)</span>
    <span class="n">y_alf</span> <span class="o">=</span> <span class="n">v_alfven</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_full</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fast</span><span class="p">,</span> <span class="n">y_fast</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fast&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_slow</span><span class="p">,</span> <span class="n">y_slow</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Slow&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_alf</span><span class="p">,</span> <span class="n">y_alf</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Alfven&#39;</span><span class="p">)</span>

    <span class="c1"># Bâ‚€ ë°©í–¥ í‘œì‹œ</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$B_0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$v_\perp / c_s$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$v_\parallel / c_s$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Friedrichs ë‹¤ì´ì–´ê·¸ë¨ (vA/cs = </span><span class="si">{</span><span class="n">vA</span><span class="o">/</span><span class="n">cs</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mhd_waves.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># mhd_wave_speeds()</span>
</code></pre></div>

<h3 id="52-alfven">5.2 Alfven íŒŒ ì‹œê°í™”<a class="header-link" href="#52-alfven" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">alfven_wave_visualization</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Alfven íŒŒ ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># (1) Alfven íŒŒ ê°œë…ë„ (3D)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># í‰í˜• ìê¸°ì¥ ë°©í–¥ (z)</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># ì„­ë™ (y ë°©í–¥ ì§„ë™)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">k</span>  <span class="c1"># vA = 1ë¡œ ì •ê·œí™”</span>
    <span class="n">By</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># ìê¸°ë ¥ì„  ìœ„ì¹˜</span>
    <span class="n">x_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">y_line</span> <span class="o">=</span> <span class="n">By</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">y_line</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ìê¸°ë ¥ì„ &#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í‰í˜• ìœ„ì¹˜&#39;</span><span class="p">)</span>

    <span class="c1"># ì†ë„ ì„­ë™</span>
    <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>  <span class="c1"># v âˆ -B (Alfven ê´€ê³„)</span>
    <span class="n">skip</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x_line</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span> <span class="n">y_line</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span> <span class="n">z</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span>
              <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">[::</span><span class="n">skip</span><span class="p">])),</span> <span class="n">vy</span><span class="p">[::</span><span class="n">skip</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">[::</span><span class="n">skip</span><span class="p">])),</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">arrow_length_ratio</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì†ë„ ì„­ë™&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z (Bâ‚€ ë°©í–¥)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Alfven íŒŒ: ìê¸°ë ¥ì„  íš¡ë°©í–¥ ì§„ë™&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># (2) ì‹œê°„ ì „ê°œ</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">By</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta B_y$&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Alfven íŒŒ ì „íŒŒ&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (3) ì—ë„ˆì§€ ë¶„ë°°</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>

    <span class="c1"># ìê¸° ì—ë„ˆì§€ì™€ ìš´ë™ ì—ë„ˆì§€</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.5</span>

    <span class="n">B_pert</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">v_pert</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="c1"># ì—ë„ˆì§€ ë°€ë„ (ë‹¨ìœ„ ë¬´ì‹œ, ë¹„ë¡€ ê´€ê³„ë§Œ)</span>
    <span class="n">E_mag</span> <span class="o">=</span> <span class="n">B_pert</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># âˆ BÂ²/2Î¼â‚€</span>
    <span class="n">E_kin</span> <span class="o">=</span> <span class="n">v_pert</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># âˆ ÏvÂ²/2</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">E_mag</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\delta B^2/2\mu_0$ (ìê¸°)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">E_kin</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\rho\delta v^2/2$ (ìš´ë™)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">E_mag</span> <span class="o">+</span> <span class="n">E_kin</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy density&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Alfven íŒŒ ì—ë„ˆì§€ ë“±ë¶„ë°°&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (4) ì„­ë™ ê´€ê³„</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>

    <span class="c1"># Î´v = -Î´B/âˆš(Î¼â‚€Ï) (Alfven ê´€ê³„)</span>
    <span class="n">info_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Alfven íŒŒ íŠ¹ì„±:</span>

<span class="s2">1. ì „íŒŒ ë°©í–¥: Bâ‚€ ë°©í–¥ (k âˆ¥ Bâ‚€)</span>
<span class="s2">2. í¸ê´‘: íš¡íŒŒ (Î´v âŠ¥ Bâ‚€, Î´B âŠ¥ Bâ‚€)</span>
<span class="s2">3. ì†ë„: vA = Bâ‚€/âˆš(Î¼â‚€Ï)</span>

<span class="s2">ì„­ë™ ê´€ê³„:</span>
<span class="s2">Î´v = âˆ“ Î´B/âˆš(Î¼â‚€Ï)</span>
<span class="s2">(Â± for kÂ·Bâ‚€ â‰· 0)</span>

<span class="s2">íŠ¹ì§•:</span>
<span class="s2">- ë¹„ì••ì¶•ì„±: âˆ‡Â·Î´v = 0</span>
<span class="s2">- ë°€ë„/ì••ë ¥ ì„­ë™ ì—†ìŒ</span>
<span class="s2">- ìê¸°ë ¥ì„ ì´ &quot;ê¸°íƒ€ ì¤„&quot;ì²˜ëŸ¼ ì§„ë™</span>
<span class="s2">- ì¥ë ¥ì´ ë³µì›ë ¥ ì œê³µ</span>

<span class="s2">Alfven ì •ë¦¬ (ë™ê²° ì¡°ê±´):</span>
<span class="s2">ì´ìƒ MHDì—ì„œ ìê¸°ë ¥ì„ ì€</span>
<span class="s2">ìœ ì²´ì™€ í•¨ê»˜ ì›€ì§ì„</span>
<span class="s2">(&quot;frozen-in&quot; ì¡°ê±´)</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">info_text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax4</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;alfven_wave_detail.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># alfven_wave_visualization()</span>
</code></pre></div>

<hr />
<h2 id="6">6. ìê¸°ì••ê³¼ ìê¸°ì¥ë ¥<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 í˜ì˜ ë¶„í•´<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Lorentz í˜ ë¶„í•´:

JÃ—B = (1/Î¼â‚€)(âˆ‡Ã—B)Ã—B

ë²¡í„° í•­ë“±ì‹ ì‚¬ìš©:
(âˆ‡Ã—B)Ã—B = (BÂ·âˆ‡)B - âˆ‡(BÂ²/2)

ë”°ë¼ì„œ:
JÃ—B = (BÂ·âˆ‡)B/Î¼â‚€ - âˆ‡(BÂ²/2Î¼â‚€)
        â†‘           â†‘
     ìê¸°ì¥ë ¥    ìê¸°ì•• êµ¬ë°°

1. ìê¸° ì••ë ¥ (Magnetic Pressure):
   pm = BÂ²/2Î¼â‚€

   - ë“±ë°©ì  (ëª¨ë“  ë°©í–¥ ë™ì¼)
   - Bê°€ í° ì˜ì—­ì—ì„œ ì‘ì€ ì˜ì—­ìœ¼ë¡œ í˜
   - ìê¸°ì¥ì„  ë°€ì§‘ â†’ ë†’ì€ ì••ë ¥

2. ìê¸° ì¥ë ¥ (Magnetic Tension):
   T = (BÂ·âˆ‡)B/Î¼â‚€ = (BÂ²/Î¼â‚€)Îº

   - ê³¡ë¥  Îºì˜ ì¤‘ì‹¬ ë°©í–¥
   - íœœ ìê¸°ë ¥ì„ ì„ í´ë ¤ëŠ” í˜
   - &quot;ê¸°íƒ€ ì¤„ ì¥ë ¥&quot;ê³¼ ìœ ì‚¬
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">magnetic_pressure_tension</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ìê¸°ì••ê³¼ ìê¸°ì¥ë ¥ì˜ ê· í˜• ì˜ˆì‹œ&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># (1) ìê¸° ì••ë ¥ í‰í˜• (Z-pinch)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

    <span class="c1"># ìê¸°ì¥ (ì¶• ë°©í–¥ ì „ë¥˜ì— ì˜í•œ Î¸ ë°©í–¥ ìê¸°ì¥)</span>
    <span class="c1"># B_theta âˆ 1/r (ì™¸ë¶€), B_theta âˆ r (ë‚´ë¶€)</span>
    <span class="n">r_plasma</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">B_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="n">r_plasma</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="p">)</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>

    <span class="c1"># ìê¸°ì••</span>
    <span class="n">P_mag</span> <span class="o">=</span> <span class="n">B_theta</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">P_mag</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$B^2/2\mu_0$&#39;</span><span class="p">)</span>

    <span class="c1"># ìê¸°ë ¥ì„  (ë™ì‹¬ì›)</span>
    <span class="k">for</span> <span class="n">r_line</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]:</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">r_line</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

    <span class="c1"># ì••ë ¥ êµ¬ë°° ë°©í–¥</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;&lt;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Z-pinch: ìê¸°ì••ì´ í”Œë¼ì¦ˆë§ˆ ì••ì¶•&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># (2) ìê¸° ì¥ë ¥ (íœœ ìê¸°ë ¥ì„ )</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># íœœ ìê¸°ë ¥ì„ </span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">y_lines</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
              <span class="mf">0.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
              <span class="mf">0.9</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">y_lines</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># ì¥ë ¥ ë°©í–¥ (ê³¡ë¥  ì¤‘ì‹¬ ë°©í–¥ = ì•„ë˜)</span>
    <span class="n">x_arrows</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">xa</span> <span class="ow">in</span> <span class="n">x_arrows</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xa</span><span class="p">))</span>
        <span class="n">y_arrow</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">xa</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># ê³¡ë¥ ì´ ì–‘ìˆ˜ë©´ ì¥ë ¥ì€ ì•„ë˜</span>
        <span class="n">tension_dir</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">xa</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="k">if</span> <span class="n">xa</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">y_arrow</span> <span class="o">+</span> <span class="n">tension_dir</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">y_arrow</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìê¸° ì¥ë ¥: íœœ ìê¸°ë ¥ì„ ì„ í´ëŠ” í˜&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ë²”ë¡€</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ìê¸°ë ¥ì„ &#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì¥ë ¥ ë°©í–¥&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># (3) í‰í˜• ì˜ˆì‹œ</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">info_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">MHD í‰í˜• ì¡°ê±´:</span>

<span class="s2">ì •ì  í‰í˜•ì—ì„œ:</span>
<span class="s2">âˆ‡p = JÃ—B = (BÂ·âˆ‡)B/Î¼â‚€ - âˆ‡(BÂ²/2Î¼â‚€)</span>

<span class="s2">ì¬ë°°ì—´:</span>
<span class="s2">âˆ‡(p + BÂ²/2Î¼â‚€) = (BÂ·âˆ‡)B/Î¼â‚€</span>
<span class="s2">    â†‘               â†‘</span>
<span class="s2"> ì´ ì••ë ¥        ìê¸° ì¥ë ¥</span>

<span class="s2">ì‘ìš© ì˜ˆì‹œ:</span>

<span class="s2">1. Î¸-pinch:</span>
<span class="s2">   - Bz ë§Œ ì¡´ì¬ (ì§ì„ )</span>
<span class="s2">   - ì¥ë ¥ ì—†ìŒ, ì••ë ¥ í‰í˜•</span>
<span class="s2">   - âˆ‚/âˆ‚z(p + BÂ²/2Î¼â‚€) = 0</span>

<span class="s2">2. Z-pinch:</span>
<span class="s2">   - BÎ¸ ë§Œ ì¡´ì¬ (ì›í˜•)</span>
<span class="s2">   - ì••ë ¥ + ì¥ë ¥ì´ ì—´ì••ê³¼ ê· í˜•</span>
<span class="s2">   - (1/r)âˆ‚/âˆ‚r[r(p + BÂ²/2Î¼â‚€)] = BÎ¸Â²/Î¼â‚€r</span>

<span class="s2">3. ìŠ¤í¬ë¥˜ í•€ì¹˜:</span>
<span class="s2">   - Bz + BÎ¸ ì¡°í•©</span>
<span class="s2">   - ë³µì¡í•œ í‰í˜• ì¡°ê±´</span>
<span class="s2">   - í† ì¹´ë§‰ì˜ ê¸°ë³¸ í˜•íƒœ</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">info_text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;magnetic_pressure_tension.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># magnetic_pressure_tension()</span>
</code></pre></div>

<hr />
<h2 id="7-frozen-in">7. Frozen-in ì •ë¦¬<a class="header-link" href="#7-frozen-in" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ìê¸°ì¥ ë™ê²° ì¡°ê±´<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ìê¸°ë ¥ì„  ë™ê²° (Frozen-in Theorem):

ì´ìƒ MHDì—ì„œ:
E + vÃ—B = 0  (ë¬´ì €í•­)

ìœ ë„ ë°©ì •ì‹:
âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B)

ë¬¼ë¦¬ì  ì˜ë¯¸:
1. ìê¸°ë ¥ì„ ì€ ìœ ì²´ ìš”ì†Œì™€ í•¨ê»˜ ì›€ì§ì„
2. ìê¸°ë ¥ì„ ì— &quot;í‘œì§€&quot;ë¥¼ í•˜ë©´ ìœ ì²´ì™€ í•¨ê»˜ ì´ë™
3. ë‘ ìœ ì²´ ìš”ì†Œê°€ ê°™ì€ ìê¸°ë ¥ì„  ìœ„ì— ìˆìœ¼ë©´
   ì˜ì›íˆ ê°™ì€ ìê¸°ë ¥ì„  ìœ„ì— ìˆìŒ

ìê¸° í”ŒëŸ­ìŠ¤ ë³´ì¡´:
d/dt âˆ«âˆ« BÂ·dS = 0  (ì›€ì§ì´ëŠ” ë©´ì— ëŒ€í•´)

ìœ„ë°˜ ì¡°ê±´ (ì €í•­ì„± MHD):
E + vÃ—B = Î·J

ìœ ë„ ë°©ì •ì‹:
âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B) + Î·/Î¼â‚€ âˆ‡Â²B
                      â†‘
                  ìê¸° í™•ì‚°

ìê¸° Reynolds ìˆ˜:
Rm = Î¼â‚€vL/Î·

Rm &gt;&gt; 1: ë™ê²° ì¡°ê±´ ì„±ë¦½ (ëŒ€ë¶€ë¶„ì˜ ì²œì²´ í”Œë¼ì¦ˆë§ˆ)
Rm ~ 1: í™•ì‚°ê³¼ ëŒ€ë¥˜ ê²½ìŸ
Rm &lt;&lt; 1: í™•ì‚° ì§€ë°°
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">frozen_in_theorem</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Frozen-in ì •ë¦¬ ì‹œê°í™”&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># (1) ì´ìƒ MHD: ìê¸°ë ¥ì„ ì´ ìœ ì²´ì™€ í•¨ê»˜ ì´ë™</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># ì´ˆê¸° ê²©ìì™€ ìê¸°ë ¥ì„ </span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="c1"># ì´ˆê¸° ìƒíƒœ</span>
    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xi</span><span class="p">,</span> <span class="n">xi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">yi</span><span class="p">,</span> <span class="n">yi</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># ë³€í˜• í›„ (ì „ë‹¨ ìœ ë™)</span>
    <span class="c1"># v = (y, 0) -&gt; x&#39; = x + t*y</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
        <span class="n">x_new</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">yi</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">yi</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">y_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">x_line</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">y_line</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">y_line</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì´ˆê¸° (ìê¸°ë ¥ì„ )&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë³€í˜• í›„&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ì´ìƒ MHD: ìê¸°ë ¥ì„ ì´ ìœ ì²´ì™€ ë™ê²°&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (2) ìê¸° í”ŒëŸ­ìŠ¤ ë³´ì¡´</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># ì´ˆê¸° ì›í˜• ë£¨í”„</span>
    <span class="n">r0</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ì´ˆê¸° ë£¨í”„&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

    <span class="c1"># ë³€í˜•ëœ ë£¨í”„ (ì••ì¶•)</span>
    <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span>  <span class="c1"># ì••ì¶•/ì—°ì‹ </span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë³€í˜•ëœ ë£¨í”„&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="c1"># ë©´ì  ë¹„êµ</span>
    <span class="n">A0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r0</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">ry</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Î¦ = âˆ«BÂ·dA</span><span class="se">\n</span><span class="s1">ë³´ì¡´!&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Aâ‚€ = </span><span class="si">{</span><span class="n">A0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Aâ‚ = </span><span class="si">{</span><span class="n">A1</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìê¸° í”ŒëŸ­ìŠ¤ ë³´ì¡´&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># (3) ìê¸° Reynolds ìˆ˜</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># ë‹¤ì–‘í•œ í™˜ê²½ì˜ Rm</span>
    <span class="n">environments</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ì‹¤í—˜ì‹¤</span><span class="se">\n</span><span class="s1">í”Œë¼ì¦ˆë§ˆ&#39;</span><span class="p">:</span> <span class="mf">1e2</span><span class="p">,</span>
        <span class="s1">&#39;íƒœì–‘</span><span class="se">\n</span><span class="s1">ê´‘êµ¬&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">,</span>
        <span class="s1">&#39;íƒœì–‘</span><span class="se">\n</span><span class="s1">ì½”ë¡œë‚˜&#39;</span><span class="p">:</span> <span class="mf">1e12</span><span class="p">,</span>
        <span class="s1">&#39;ì„±ê°„</span><span class="se">\n</span><span class="s1">ë§¤ì§ˆ&#39;</span><span class="p">:</span> <span class="mf">1e18</span><span class="p">,</span>
        <span class="s1">&#39;ì•¡ì²´</span><span class="se">\n</span><span class="s1">ê¸ˆì†&#39;</span><span class="p">:</span> <span class="mf">1e1</span>
    <span class="p">}</span>

    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">environments</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">Rm_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">environments</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">Rm</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="k">else</span> <span class="s1">&#39;green&#39;</span> <span class="k">for</span> <span class="n">Rm</span> <span class="ow">in</span> <span class="n">Rm_values</span><span class="p">]</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Rm_values</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$R_m = 100$&#39;</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;logâ‚â‚€($R_m$)&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ìê¸° Reynolds ìˆ˜ ë¹„êµ&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># ë²”ë¡€</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ë™ê²° ì¡°ê±´ ì„±ë¦½&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;í™•ì‚° íš¨ê³¼ ì¤‘ìš”&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># (4) ê°œë… ì •ë¦¬</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">info_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Frozen-in ì •ë¦¬ ìš”ì•½:</span>

<span class="s2">ì¡°ê±´: ì´ìƒ MHD (Î· = 0, E + vÃ—B = 0)</span>

<span class="s2">ê²°ê³¼:</span>
<span class="s2">1. âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B)</span>
<span class="s2">2. d/dt âˆ«âˆ« BÂ·dS = 0 (ì´ë™ ë©´)</span>
<span class="s2">3. ìê¸°ë ¥ì„ ì€ ìœ ì²´ì™€ í•¨ê»˜ ì´ë™</span>

<span class="s2">ë¬¼ë¦¬ì  í•´ì„:</span>
<span class="s2">- ìê¸°ë ¥ì„ ì— &quot;ë™ê²°&quot;ëœ ìœ ì²´ ìš”ì†Œ</span>
<span class="s2">- ìê¸°ì¥ ì••ì¶• â†” ë°€ë„ ì¦ê°€</span>
<span class="s2">- B/Ï âˆ ìƒìˆ˜ (1D ì••ì¶•)</span>

<span class="s2">ìœ„ë°˜ ì‹œ (Î· â‰  0):</span>
<span class="s2">- ìê¸°ì¥ í™•ì‚°: Ï„_diff = Î¼â‚€LÂ²/Î·</span>
<span class="s2">- ìê¸° ì¬ê²°í•© ê°€ëŠ¥</span>
<span class="s2">- ì—ë„ˆì§€ ë³€í™˜ (ìê¸° â†’ ìš´ë™/ì—´)</span>

<span class="s2">ì¤‘ìš”ì„±:</span>
<span class="s2">- íƒœì–‘ í”Œë ˆì–´: ì¬ê²°í•©</span>
<span class="s2">- í† ì¹´ë§‰: ë™ê²° ì¡°ê±´ ì¤‘ìš”</span>
<span class="s2">- ìê¸°ê¶Œ: ì¬ê²°í•© í˜„ìƒ</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">info_text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax4</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;frozen_in_theorem.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># frozen_in_theorem()</span>
</code></pre></div>

<hr />
<h2 id="8">8. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="1-alfven">ì—°ìŠµ 1: Alfven ì†ë„<a class="header-link" href="#1-alfven" title="Permanent link">&para;</a></h3>
<p>íƒœì–‘ ì½”ë¡œë‚˜ì—ì„œ B = 10 G, n = 10^8 cm^-3 ì¼ ë•Œ Alfven ì†ë„ë¥¼ ê³„ì‚°í•˜ì‹œì˜¤. ì´ê²ƒì„ ìŒì†(T = 10^6 K)ê³¼ ë¹„êµí•˜ê³  í”Œë¼ì¦ˆë§ˆ ë² íƒ€ë¥¼ êµ¬í•˜ì‹œì˜¤.</p>
<h3 id="2-mhd_1">ì—°ìŠµ 2: MHD íŒŒë™ ì†ë„<a class="header-link" href="#2-mhd_1" title="Permanent link">&para;</a></h3>
<p>vA = 2cs ì¸ ê²½ìš°, ìê¸°ì¥ì— ìˆ˜ì§í•œ ë°©í–¥(Î¸ = 90Â°)ìœ¼ë¡œ ì „íŒŒí•˜ëŠ” ë¹ ë¥¸ ìê¸°ìŒíŒŒì˜ ìœ„ìƒ ì†ë„ë¥¼ êµ¬í•˜ì‹œì˜¤.</p>
<h3 id="3">ì—°ìŠµ 3: ìê¸°ì•• í‰í˜•<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>ê· ì¼í•œ ìê¸°ì¥ Bz ì˜ì—­ê³¼ ë¬´ìê¸°ì¥ ì˜ì—­ ì‚¬ì´ì˜ ê²½ê³„ì—ì„œ ì••ë ¥ í‰í˜• ì¡°ê±´ì„ êµ¬í•˜ì‹œì˜¤.</p>
<h3 id="4-frozen-in">ì—°ìŠµ 4: Frozen-in<a class="header-link" href="#4-frozen-in" title="Permanent link">&para;</a></h3>
<p>ê¸¸ì´ L = 1 Mm, ì „ë„ë„ Ïƒ = 10^6 S/mì¸ í”Œë¼ì¦ˆë§ˆì—ì„œ ìê¸° í™•ì‚° ì‹œê°„ì„ ê³„ì‚°í•˜ì‹œì˜¤. ì†ë„ v = 100 km/sì¼ ë•Œ ìê¸° Reynolds ìˆ˜ëŠ”?</p>
<hr />
<h2 id="9">9. ì°¸ê³ ìë£Œ<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="_2">í•µì‹¬ êµì¬<a class="header-link" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Goedbloed &amp; Poedts, "Principles of Magnetohydrodynamics"</li>
<li>Kulsrud, "Plasma Physics for Astrophysics"</li>
<li>Freidberg, "Ideal MHD"</li>
</ul>
<h3 id="_3">ë…¼ë¬¸/ë¦¬ë·°<a class="header-link" href="#_3" title="Permanent link">&para;</a></h3>
<ul>
<li>AlfvÃ©n (1942) ì›ë…¼ë¬¸ (MHD íŒŒë™)</li>
<li>Priest &amp; Forbes, "Magnetic Reconnection" (ì¬ê²°í•©)</li>
</ul>
<h3 id="_4">ì˜¨ë¼ì¸ ìë£Œ<a class="header-link" href="#_4" title="Permanent link">&para;</a></h3>
<ul>
<li>Thorne &amp; Blandford, "Modern Classical Physics" (Ch. 19)</li>
<li>Chen, "Introduction to Plasma Physics" (MHD ì¥)</li>
</ul>
<hr />
<h2 id="_5">ìš”ì•½<a class="header-link" href="#_5" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>MHD ê¸°ì´ˆ í•µì‹¬:

1. MHD ê°€ì •:
   - ì¤€ì¤‘ì„±, ì €ì£¼íŒŒ, ìœ ì²´ ê·¼ì‚¬
   - L &gt;&gt; Î»D, c/Ï‰pi
   - Maxwell ë‹¨ìˆœí™”

2. ì´ìƒ MHD ë°©ì •ì‹:
   - ì—°ì†: âˆ‚Ï/âˆ‚t + âˆ‡Â·(Ïv) = 0
   - ìš´ë™ëŸ‰: ÏDv/Dt = -âˆ‡p + JÃ—B
   - ì—ë„ˆì§€: D(p/Ï^Î³)/Dt = 0
   - ìœ ë„: âˆ‚B/âˆ‚t = âˆ‡Ã—(vÃ—B)
   - ì œì•½: âˆ‡Â·B = 0

3. ì£¼ìš” ì†ë„:
   - Alfven: vA = B/âˆš(Î¼â‚€Ï)
   - ìŒì†: cs = âˆš(Î³p/Ï)
   - í”Œë¼ì¦ˆë§ˆ ë² íƒ€: Î² = 2Î¼â‚€p/BÂ²

4. MHD íŒŒë™:
   - Alfven íŒŒ: vA (ìê¸°ì¥ ë°©í–¥)
   - ë¹ ë¥¸ ìê¸°ìŒíŒŒ: âˆš(vAÂ² + csÂ²) (ìˆ˜ì§)
   - ëŠë¦° ìê¸°ìŒíŒŒ: min(vA, cs) (í‰í–‰)

5. Lorentz í˜:
   JÃ—B = -âˆ‡(BÂ²/2Î¼â‚€) + (BÂ·âˆ‡)B/Î¼â‚€
          ìê¸°ì••        ìê¸°ì¥ë ¥

6. Frozen-in:
   - ì´ìƒ MHD: E + vÃ—B = 0
   - ìê¸°ë ¥ì„ ì´ ìœ ì²´ì™€ ë™ê²°
   - Rm &gt;&gt; 1 ì¼ ë•Œ ìœ íš¨
</code></pre></div>

<hr />
<p>ë‹¤ìŒ ë ˆìŠ¨ì—ì„œëŠ” MHD ë°©ì •ì‹ì˜ ìˆ˜ì¹˜í•´ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/16_FDTD_Implementation.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">16. FDTD êµ¬í˜„ (FDTD Implementation)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Numerical_Simulation/18_MHD_Numerical_Methods.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">18. MHD ìˆ˜ì¹˜í•´ë²• (MHD Numerical Methods)</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}