{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìœ í•œ ìš”ì†Œ ë°©ë²•(Finite Element Method, FEM) - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Numerical_Simulation/">Numerical Simulation</a>
    <span class="separator">/</span>
    <span class="current">ìœ í•œ ìš”ì†Œ ë°©ë²•(Finite Element Method, FEM)</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>ìœ í•œ ìš”ì†Œ ë°©ë²•(Finite Element Method, FEM)</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/21_Spectral_Methods.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ìŠ¤í™íŠ¸ëŸ¼ ë°©ë²•(Spectral Methods)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#_2">ëª©ì°¨</a></li>
<li><a href="#1-fem">1. FEM ì†Œê°œ</a><ul>
<li><a href="#11">1.1 ìœ í•œ ìš”ì†Œ ë°©ë²•ì´ë€?</a></li>
<li><a href="#12-1d">1.2 ëª¨ë¸ ë¬¸ì œ: 1D í‘¸ì•„ì†¡ ë°©ì •ì‹</a></li>
</ul>
</li>
<li><a href="#2">2. ì•½í˜•ì‹ê³¼ ë³€ë¶„ ì •ì‹í™”</a><ul>
<li><a href="#21">2.1 ì•½í˜•ì‹ ìœ ë„</a></li>
<li><a href="#22">2.2 ìŒì„ í˜• í˜•ì‹ê³¼ ë²”í•¨ìˆ˜</a></li>
</ul>
</li>
<li><a href="#3">3. ìœ í•œ ìš”ì†Œ ê³µê°„</a><ul>
<li><a href="#31">3.1 ë©”ì‹œì™€ ìš”ì†Œ</a></li>
<li><a href="#32-hat-functions">3.2 ëª¨ì í•¨ìˆ˜(Hat Functions) (ì„ í˜• ê¸°ì €)</a></li>
</ul>
</li>
<li><a href="#4">4. ìš”ì†Œ ê°•ì„± í–‰ë ¬ê³¼ ì¡°ë¦½</a><ul>
<li><a href="#41">4.1 ê°¤ëŸ¬í‚¨ ì´ì‚°í™”</a></li>
<li><a href="#42">4.2 ìš”ì†Œ ê°•ì„± í–‰ë ¬</a></li>
<li><a href="#43">4.3 ì¡°ë¦½</a></li>
</ul>
</li>
<li><a href="#5-1d-fem">5. 1D FEM êµ¬í˜„</a><ul>
<li><a href="#51-fem">5.1 ì™„ì „í•œ FEM ì†”ë²„</a></li>
<li><a href="#52">5.2 ê°€ë³€ ì†ŒìŠ¤ í•­</a></li>
</ul>
</li>
<li><a href="#6">6. ê²½ê³„ ì¡°ê±´</a><ul>
<li><a href="#61">6.1 ë””ë¦¬í´ë ˆ ê²½ê³„ ì¡°ê±´</a></li>
<li><a href="#62">6.2 ë…¸ì´ë§Œ ê²½ê³„ ì¡°ê±´</a></li>
</ul>
</li>
<li><a href="#7-2d-fem">7. 2D FEM ê°œìš”</a><ul>
<li><a href="#71-2d">7.1 2D í‘¸ì•„ì†¡ ë°©ì •ì‹</a></li>
<li><a href="#72">7.2 ì‚¼ê°í˜• ìš”ì†Œ</a></li>
<li><a href="#73-2d">7.3 ìš”ì†Œ ê°•ì„± í–‰ë ¬ (2D)</a></li>
</ul>
</li>
<li><a href="#8">8. ì˜¤ì°¨ ë¶„ì„ê³¼ ìˆ˜ë ´</a><ul>
<li><a href="#81">8.1 ìˆ˜ë ´ë¥ </a></li>
<li><a href="#82">8.2 ìˆ˜ë ´ í…ŒìŠ¤íŠ¸</a></li>
</ul>
</li>
<li><a href="#9">9. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1">ë¬¸ì œ 1: ê°€ë³€ ê³„ìˆ˜</a></li>
<li><a href="#2_1">ë¬¸ì œ 2: í˜¼í•© ê²½ê³„ ì¡°ê±´</a></li>
<li><a href="#3-2">ë¬¸ì œ 3: 2ì°¨ ìš”ì†Œ</a></li>
<li><a href="#4-2d">ë¬¸ì œ 4: ë‹¨ìœ„ ì •ì‚¬ê°í˜•ì—ì„œ 2D í‘¸ì•„ì†¡</a></li>
<li><a href="#5">ë¬¸ì œ 5: ê³ ì°¨ ìˆ˜ë ´</a></li>
</ul>
</li>
<li><a href="#_3">ì´ë™</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="finite-element-method-fem">ìœ í•œ ìš”ì†Œ ë°©ë²•(Finite Element Method, FEM)<a class="header-link" href="#finite-element-method-fem" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ì•½í˜•ì‹(weak formulation)ê³¼ ë³€ë¶„ ì›ë¦¬ ì´í•´í•˜ê¸°</li>
<li>ìœ í•œ ìš”ì†Œ ê³µê°„ê³¼ ê¸°ì € í•¨ìˆ˜ ë§ˆìŠ¤í„°í•˜ê¸°</li>
<li>ìš”ì†Œ ê°•ì„± í–‰ë ¬ êµ¬ì„± ë° ì¡°ë¦½ ìˆ˜í–‰í•˜ê¸°</li>
<li>í‘¸ì•„ì†¡ ë°©ì •ì‹ì„ ìœ„í•œ 1D FEM êµ¬í˜„í•˜ê¸°</li>
<li>ë””ë¦¬í´ë ˆ ë° ë…¸ì´ë§Œ ê²½ê³„ ì¡°ê±´ ë‹¤ë£¨ê¸°</li>
<li>ì˜¤ì°¨ ë¶„ì„ ë° ìˆ˜ë ´ë¥  ì´í•´í•˜ê¸°</li>
<li>2D FEM í™•ì¥ì— ëŒ€í•œ í†µì°° ì–»ê¸°</li>
</ul>
<h2 id="_2">ëª©ì°¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-fem-ì†Œê°œ">FEM ì†Œê°œ</a></li>
<li><a href="#2-ì•½í˜•ì‹ê³¼-ë³€ë¶„-ì •ì‹í™”">ì•½í˜•ì‹ê³¼ ë³€ë¶„ ì •ì‹í™”</a></li>
<li><a href="#3-ìœ í•œ-ìš”ì†Œ-ê³µê°„">ìœ í•œ ìš”ì†Œ ê³µê°„</a></li>
<li><a href="#4-ìš”ì†Œ-ê°•ì„±-í–‰ë ¬ê³¼-ì¡°ë¦½">ìš”ì†Œ ê°•ì„± í–‰ë ¬ê³¼ ì¡°ë¦½</a></li>
<li><a href="#5-1d-fem-êµ¬í˜„">1D FEM êµ¬í˜„</a></li>
<li><a href="#6-ê²½ê³„-ì¡°ê±´">ê²½ê³„ ì¡°ê±´</a></li>
<li><a href="#7-2d-fem-ê°œìš”">2D FEM ê°œìš”</a></li>
<li><a href="#8-ì˜¤ì°¨-ë¶„ì„ê³¼-ìˆ˜ë ´">ì˜¤ì°¨ ë¶„ì„ê³¼ ìˆ˜ë ´</a></li>
<li><a href="#9-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
</ol>
<hr />
<h2 id="1-fem">1. FEM ì†Œê°œ<a class="header-link" href="#1-fem" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ìœ í•œ ìš”ì†Œ ë°©ë²•ì´ë€?<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ìœ í•œ ìš”ì†Œ ë°©ë²•(FEM)ì€ í¸ë¯¸ë¶„ ë°©ì •ì‹(PDE)ì„ í’€ê¸° ìœ„í•œ ê°•ë ¥í•œ ìˆ˜ì¹˜ ê¸°ë²•ì…ë‹ˆë‹¤. ë„í•¨ìˆ˜ë¥¼ ì§ì ‘ ê·¼ì‚¬í•˜ëŠ” ìœ í•œ ì°¨ë¶„ ë°©ë²•ê³¼ ë‹¬ë¦¬, FEMì€:</p>
<ol>
<li>PDEë¥¼ <strong>ì•½í˜•ì‹(weak, variational form)</strong>ìœ¼ë¡œ ë³€í™˜</li>
<li>ì˜ì—­ì„ <strong>ìš”ì†Œ(elements)</strong>(ì‚¼ê°í˜•, ì‚¬ë©´ì²´ ë“±)ë¡œ ì´ì‚°í™”</li>
<li><strong>êµ¬ê°„ë³„ ë‹¤í•­ì‹ ê¸°ì € í•¨ìˆ˜</strong>ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ ê·¼ì‚¬</li>
<li>ë¬¸ì œë¥¼ ì„ í˜• ì‹œìŠ¤í…œ í’€ê¸°ë¡œ ì¶•ì†Œ</li>
</ol>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FEM ì›Œí¬í”Œë¡œìš°                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ê°•í˜•ì‹(Strong Form, PDE)                                   â”‚
â”‚       â†“                                                     â”‚
â”‚  ì•½í˜•ì‹(Weak Form) (í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë¡œ ê³±í•˜ê³  ì ë¶„)               â”‚
â”‚       â†“                                                     â”‚
â”‚  ì´ì‚°í™”(Discretization) (ë©”ì‹œ + ê¸°ì € í•¨ìˆ˜)                  â”‚
â”‚       â†“                                                     â”‚
â”‚  í–‰ë ¬ ì‹œìŠ¤í…œ(Matrix System) (Au = f)                        â”‚
â”‚       â†“                                                     â”‚
â”‚  í’€ê¸°(Solve) (ì§ì ‘ ë˜ëŠ” ë°˜ë³µ)                               â”‚
â”‚       â†“                                                     â”‚
â”‚  ê·¼ì‚¬ í•´(Approximate Solution)                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p><strong>ì¥ì :</strong>
- ë³µì¡í•œ í˜•ìƒ ì²˜ë¦¬ (ë¹„êµ¬ì¡° ë©”ì‹œ)
- ì—„ê²©í•œ ìˆ˜í•™ì  ê¸°ì´ˆ (ë³€ë¶„ë²•)
- ìœ ì—°ì„±: ë‹¤ì–‘í•œ ê²½ê³„ ì¡°ê±´ì— ì ìš©
- êµ¬ì¡° ì—­í•™, ì—´ ì „ë‹¬, ì „ìê¸°í•™ì— ì í•©</p>
<p><strong>ì‘ìš©:</strong>
- êµ¬ì¡° í•´ì„ (ì‘ë ¥, ë³€í˜•, ì§„ë™)
- ìœ ì²´ ì—­í•™ (ë‚˜ë¹„ì—-ìŠ¤í† í¬ìŠ¤ ë°©ì •ì‹)
- ì—´ ì „ë‹¬
- ì „ìê¸°í•™ (ë§¥ìŠ¤ì›° ë°©ì •ì‹)</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">lil_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">spsolve</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h3 id="12-1d">1.2 ëª¨ë¸ ë¬¸ì œ: 1D í‘¸ì•„ì†¡ ë°©ì •ì‹<a class="header-link" href="#12-1d" title="Permanent link">&para;</a></h3>
<p>1D í‘¸ì•„ì†¡ ë°©ì •ì‹ì— ì§‘ì¤‘í•˜ê² ìŠµë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code>-u&#39;&#39;(x) = f(x),  x âˆˆ (0, 1)
u(0) = 0,  u(1) = 0  (ë””ë¦¬í´ë ˆ ê²½ê³„ ì¡°ê±´)
</code></pre></div>

<p><strong>ì˜ˆì œ:</strong> f(x) = 1ì´ë©´, ì •í™•í•œ í•´ëŠ” u(x) = x(1-x)/2.</p>
<hr />
<h2 id="2">2. ì•½í˜•ì‹ê³¼ ë³€ë¶„ ì •ì‹í™”<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ì•½í˜•ì‹ ìœ ë„<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p><strong>ê°•í˜•ì‹:</strong></p>
<div class="highlight"><pre><span></span><code>-u&#39;&#39;(x) = f(x),  x âˆˆ (0, 1)
u(0) = u(1) = 0
</code></pre></div>

<p><strong>ë‹¨ê³„ 1:</strong> í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ v(x)ë¡œ ê³±í•˜ê³  ì ë¶„:</p>
<div class="highlight"><pre><span></span><code>-âˆ«â‚€Â¹ u&#39;&#39;(x) v(x) dx = âˆ«â‚€Â¹ f(x) v(x) dx
</code></pre></div>

<p><strong>ë‹¨ê³„ 2:</strong> ë¶€ë¶„ ì ë¶„ (ë„í•¨ìˆ˜ë¥¼ vë¡œ ì „ë‹¬):</p>
<div class="highlight"><pre><span></span><code>âˆ«â‚€Â¹ u&#39;(x) v&#39;(x) dx - [u&#39;(x) v(x)]â‚€Â¹ = âˆ«â‚€Â¹ f(x) v(x) dx
</code></pre></div>

<p>v(0) = v(1) = 0 (í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ëŠ” ê²½ê³„ì—ì„œ ì†Œë©¸)ì´ë¯€ë¡œ, ê²½ê³„ í•­ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code>âˆ«â‚€Â¹ u&#39;(x) v&#39;(x) dx = âˆ«â‚€Â¹ f(x) v(x) dx
</code></pre></div>

<p>ì´ê²ƒì´ <strong>ì•½í˜•ì‹(weak form)</strong> (ë˜ëŠ” <strong>ë³€ë¶„í˜•ì‹(variational form)</strong>)ì…ë‹ˆë‹¤.</p>
<h3 id="22">2.2 ìŒì„ í˜• í˜•ì‹ê³¼ ë²”í•¨ìˆ˜<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>ì •ì˜:
- ìŒì„ í˜• í˜•ì‹: a(u, v) = âˆ«â‚€Â¹ u'(x) v'(x) dx
- ì„ í˜• ë²”í•¨ìˆ˜: L(v) = âˆ«â‚€Â¹ f(x) v(x) dx</p>
<p><strong>ì•½ ì •ì‹í™”:</strong> ë‹¤ìŒì„ ë§Œì¡±í•˜ëŠ” uë¥¼ ì°¾ê¸°</p>
<div class="highlight"><pre><span></span><code>a(u, v) = L(v)  ëª¨ë“  í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ vì— ëŒ€í•´
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">weak_form_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ì•½í˜•ì‹ì˜ ê°œë…ì  ì‹œì—°.</span>

<span class="sd">    ê°•í˜•ì‹: -u&#39;&#39; = f</span>
<span class="sd">    ì•½í˜•ì‹: âˆ« u&#39; v&#39; dx = âˆ« f v dx</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Strong Form: -u&#39;&#39;(x) = f(x)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weak Form:   âˆ« u&#39;(x)v&#39;(x) dx = âˆ« f(x)v(x) dx&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benefits of weak form:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  1. Lower regularity requirement (only u&#39; needed, not u&#39;&#39;)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  2. Natural incorporation of Neumann boundary conditions&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  3. Foundation for Galerkin approximation&quot;</span><span class="p">)</span>

<span class="n">weak_form_example</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="3">3. ìœ í•œ ìš”ì†Œ ê³µê°„<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ë©”ì‹œì™€ ìš”ì†Œ<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>[0, 1]ì„ Nê°œ ìš”ì†Œë¡œ ë¶„í• :</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              1D ë©”ì‹œ (N=4 ìš”ì†Œ)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  xâ‚€=0    xâ‚      xâ‚‚      xâ‚ƒ      xâ‚„=1                     â”‚
â”‚   oâ”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€o                       â”‚
â”‚   â”‚ Elem1 â”‚ Elem2 â”‚ Elem3 â”‚ Elem4 â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>ê° ìš”ì†Œ [xáµ¢, xáµ¢â‚Šâ‚]ì€ ê¸¸ì´ h = 1/N (ê· ì¼ ë©”ì‹œì˜ ê²½ìš°).</p>
<h3 id="32-hat-functions">3.2 ëª¨ì í•¨ìˆ˜(Hat Functions) (ì„ í˜• ê¸°ì €)<a class="header-link" href="#32-hat-functions" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒê³¼ ê°™ì´ u(x)ë¥¼ ê·¼ì‚¬í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code>u(x) â‰ˆ uâ‚•(x) = Î£áµ¢â‚Œâ‚€á´º uáµ¢ Ï†áµ¢(x)
</code></pre></div>

<p>ì—¬ê¸°ì„œ Ï†áµ¢(x)ëŠ” <strong>ëª¨ì í•¨ìˆ˜(hat functions)</strong> (êµ¬ê°„ë³„ ì„ í˜•, ì ˆì  ê¸°ì €):</p>
<div class="highlight"><pre><span></span><code>Ï†áµ¢(x) = { (x - xáµ¢â‚‹â‚)/h,  x âˆˆ [xáµ¢â‚‹â‚, xáµ¢]
        { (xáµ¢â‚Šâ‚ - x)/h,  x âˆˆ [xáµ¢, xáµ¢â‚Šâ‚]
        { 0,              ê·¸ ì™¸

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ëª¨ì í•¨ìˆ˜                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Ï†â‚€    Ï†â‚    Ï†â‚‚    Ï†â‚ƒ    Ï†â‚„                         â”‚
â”‚          /\    /\    /\    /\    /\                        â”‚
â”‚         /  \  /  \  /  \  /  \  /  \                       â”‚
â”‚        /    \/    \/    \/    \/    \                      â”‚
â”‚       /      \    /\    /\    /      \                     â”‚
â”‚      /        \  /  \  /  \  /        \                    â”‚
â”‚     /          \/    \/    \/          \                   â”‚
â”‚    â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€oâ”€                 â”‚
â”‚   xâ‚€=0       xâ‚     xâ‚‚     xâ‚ƒ        xâ‚„=1                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p><strong>íŠ¹ì„±:</strong>
- Ï†áµ¢(xâ±¼) = Î´áµ¢â±¼ (í¬ë¡œë„¤ì»¤ ë¸íƒ€)
- êµ­ì†Œ ì§€ì§€: Ï†áµ¢(x) â‰  0 ì˜¤ì§ [xáµ¢â‚‹â‚, xáµ¢â‚Šâ‚]ì—ì„œë§Œ
- uâ‚•(xáµ¢) = uáµ¢ (ì ˆì  ë³´ê°„)</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hat_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi_minus</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">xi_plus</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    xië¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•œ ëª¨ì í•¨ìˆ˜ í‰ê°€.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># ì™¼ìª½ ê¸°ìš¸ê¸°</span>
    <span class="n">mask1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xi_minus</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">phi</span><span class="p">[</span><span class="n">mask1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">mask1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi_minus</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">xi_minus</span><span class="p">)</span>

    <span class="c1"># ì˜¤ë¥¸ìª½ ê¸°ìš¸ê¸°</span>
    <span class="n">mask2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xi</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xi_plus</span><span class="p">)</span>
    <span class="n">phi</span><span class="p">[</span><span class="n">mask2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">xi_plus</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">mask2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">xi_plus</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">phi</span>

<span class="c1"># ëª¨ì í•¨ìˆ˜ í”Œë¡¯</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">hat_function</span><span class="p">(</span><span class="n">x_fine</span><span class="p">,</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">hat_function</span><span class="p">(</span><span class="n">x_fine</span><span class="p">,</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">hat_function</span><span class="p">(</span><span class="n">x_fine</span><span class="p">,</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x_nodes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fine</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Ï†_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ï†áµ¢(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hat Functions (Linear Finite Elements)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hat_functions.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4">4. ìš”ì†Œ ê°•ì„± í–‰ë ¬ê³¼ ì¡°ë¦½<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ê°¤ëŸ¬í‚¨ ì´ì‚°í™”<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<p>ì•½í˜•ì‹ì— uâ‚• = Î£áµ¢ uáµ¢ Ï†áµ¢ ëŒ€ì…:</p>
<div class="highlight"><pre><span></span><code>Î£áµ¢<span class="w"> </span><span class="nv">u</span>áµ¢<span class="w"> </span>âˆ«â‚€Â¹<span class="w"> </span>Ï†áµ¢<span class="s1">&#39; Ï†â±¼&#39;</span><span class="w"> </span><span class="nv">dx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>âˆ«â‚€Â¹<span class="w"> </span><span class="nv">f</span><span class="w"> </span>Ï†â±¼<span class="w"> </span><span class="nv">dx</span>,<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="nv">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">1</span>,<span class="w"> </span>...,<span class="w"> </span><span class="nv">N</span>
</code></pre></div>

<p>ì´ê²ƒì€ ì„ í˜• ì‹œìŠ¤í…œ <strong>Au = f</strong>ë¥¼ ì œê³µí•˜ë©°, ì—¬ê¸°ì„œ:
- Aáµ¢â±¼ = âˆ«â‚€Â¹ Ï†áµ¢'(x) Ï†â±¼'(x) dx (ê°•ì„± í–‰ë ¬)
- fâ±¼ = âˆ«â‚€Â¹ f(x) Ï†â±¼(x) dx (í•˜ì¤‘ ë²¡í„°)</p>
<h3 id="42">4.2 ìš”ì†Œ ê°•ì„± í–‰ë ¬<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p>ìš”ì†Œ e = [xâ‚‘, xâ‚‘â‚Šâ‚]ì— ëŒ€í•œ êµ­ì†Œ ê°•ì„± í–‰ë ¬ì€:</p>
<div class="highlight"><pre><span></span><code>Aâ‚‘ = âˆ«_{xâ‚‘}^{xâ‚‘â‚Šâ‚} Ï†&#39;â‚‘,áµ¢ Ï†&#39;â‚‘,â±¼ dx

ì„ í˜• ìš”ì†Œì˜ ê²½ìš°:
  Ï†â‚‘,â‚(x) = (xâ‚‘â‚Šâ‚ - x)/h,  Ï†&#39;â‚‘,â‚ = -1/h
  Ï†â‚‘,â‚‚(x) = (x - xâ‚‘)/h,    Ï†&#39;â‚‘,â‚‚ = 1/h

  Aâ‚‘ = (1/h) [ 1  -1 ]
             [-1   1 ]
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">element_stiffness_1d</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D ì„ í˜• ìš”ì†Œì˜ ìš”ì†Œ ê°•ì„± í–‰ë ¬ ê³„ì‚°.</span>

<span class="sd">    Aâ‚‘ = (1/h) [ 1  -1 ]</span>
<span class="sd">               [-1   1 ]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A_elem</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                     <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">A_elem</span>

<span class="n">h</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># ìš”ì†Œ í¬ê¸°</span>
<span class="n">A_elem</span> <span class="o">=</span> <span class="n">element_stiffness_1d</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Element stiffness matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_elem</span><span class="p">)</span>
</code></pre></div>

<h3 id="43">4.3 ì¡°ë¦½<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<p>ê° ìš”ì†Œì˜ ê¸°ì—¬ë¥¼ í•©ì‚°í•˜ì—¬ ì „ì—­ í–‰ë ¬ Aë¥¼ ì¡°ë¦½:</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì¡°ë¦½ ê³¼ì • (N=3 ìš”ì†Œ)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  Element 1: [xâ‚€, xâ‚]  â†’  A[0:2, 0:2] += Aâ‚‘                â”‚
â”‚  Element 2: [xâ‚, xâ‚‚]  â†’  A[1:3, 1:3] += Aâ‚‘                â”‚
â”‚  Element 3: [xâ‚‚, xâ‚ƒ]  â†’  A[2:4, 2:4] += Aâ‚‘                â”‚
â”‚                                                            â”‚
â”‚  ê²°ê³¼: ì‚¼ì¤‘ëŒ€ê° ëŒ€ì¹­ í–‰ë ¬                                   â”‚
â”‚    [ 1  -1   0   0 ]                                      â”‚
â”‚    [-1   2  -1   0 ]  (1/h ì¸ìˆ˜)                          â”‚
â”‚    [ 0  -1   2  -1 ]                                      â”‚
â”‚    [ 0   0  -1   1 ]                                      â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">assemble_stiffness_1d</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D ë¬¸ì œì˜ ì „ì—­ ê°•ì„± í–‰ë ¬ ì¡°ë¦½.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    N : int, ìš”ì†Œ ê°œìˆ˜</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    A : (N+1) x (N+1) í¬ì†Œ í–‰ë ¬</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">lil_matrix</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">A_elem</span> <span class="o">=</span> <span class="n">element_stiffness_1d</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="c1"># ìš”ì†Œ eì˜ ì „ì—­ ì ˆì  ì¸ë±ìŠ¤</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># ìš”ì†Œ ê¸°ì—¬ ì¶”ê°€</span>
        <span class="k">for</span> <span class="n">i_local</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j_local</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">i_global</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i_local</span><span class="p">]</span>
                <span class="n">j_global</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">j_local</span><span class="p">]</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i_global</span><span class="p">,</span> <span class="n">j_global</span><span class="p">]</span> <span class="o">+=</span> <span class="n">A_elem</span><span class="p">[</span><span class="n">i_local</span><span class="p">,</span> <span class="n">j_local</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">A</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">assemble_stiffness_1d</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Global stiffness matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
</code></pre></div>

<hr />
<h2 id="5-1d-fem">5. 1D FEM êµ¬í˜„<a class="header-link" href="#5-1d-fem" title="Permanent link">&para;</a></h2>
<h3 id="51-fem">5.1 ì™„ì „í•œ FEM ì†”ë²„<a class="header-link" href="#51-fem" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fem_1d_poisson</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">f_func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FEMì„ ì‚¬ìš©í•˜ì—¬ 1D í‘¸ì•„ì†¡ ë°©ì •ì‹ í’€ê¸°.</span>

<span class="sd">    -u&#39;&#39;(x) = f(x),  x âˆˆ (0, 1)</span>
<span class="sd">    u(0) = u(1) = 0</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    N : int, ìš”ì†Œ ê°œìˆ˜</span>
<span class="sd">    f_func : function, ìš°ë³€ f(x)</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    x : array, ì ˆì  ì¢Œí‘œ</span>
<span class="sd">    u : array, ì ˆì ì—ì„œì˜ FEM í•´</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># ê°•ì„± í–‰ë ¬ ì¡°ë¦½</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">assemble_stiffness_1d</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="c1"># í•˜ì¤‘ ë²¡í„° ì¡°ë¦½</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">x_left</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
        <span class="n">x_right</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># ì ë¶„ì„ ìœ„í•œ ì¤‘ì  ê·œì¹™</span>
        <span class="n">x_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_left</span> <span class="o">+</span> <span class="n">x_right</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f_mid</span> <span class="o">=</span> <span class="n">f_func</span><span class="p">(</span><span class="n">x_mid</span><span class="p">)</span>

        <span class="c1"># í•˜ì¤‘ ë²¡í„° ê¸°ì—¬</span>
        <span class="n">f</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f_mid</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f</span><span class="p">[</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f_mid</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># ë””ë¦¬í´ë ˆ ê²½ê³„ ì¡°ê±´ ì ìš©: u(0) = u(N) = 0</span>
    <span class="c1"># ì²« ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ í–‰ ìˆ˜ì •</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tolil</span><span class="p">()</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>

    <span class="c1"># ì„ í˜• ì‹œìŠ¤í…œ í’€ê¸°</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span>

<span class="c1"># ì˜ˆì œ: f(x) = 1, ì •í™•í•œ í•´ u(x) = x(1-x)/2</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">u_exact</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">fem_1d_poisson</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

<span class="c1"># í”Œë¡¯</span>
<span class="n">x_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">u_exact_fine</span> <span class="o">=</span> <span class="n">u_exact</span><span class="p">(</span><span class="n">x_fine</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fine</span><span class="p">,</span> <span class="n">u_exact_fine</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;FEM (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;u(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;1D Poisson Equation: -u</span><span class="se">\&#39;\&#39;</span><span class="s1"> = 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fem_1d_poisson.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># ì˜¤ì°¨ ê³„ì‚°</span>
<span class="n">u_exact_nodes</span> <span class="o">=</span> <span class="n">u_exact</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">error_L2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact_nodes</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">N</span><span class="p">)))</span>
<span class="n">error_Linf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact_nodes</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L2 error:   </span><span class="si">{</span><span class="n">error_L2</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lâˆ error:   </span><span class="si">{</span><span class="n">error_Linf</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="52">5.2 ê°€ë³€ ì†ŒìŠ¤ í•­<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ì˜ˆì œ: f(x) = Ï€Â² sin(Ï€x), ì •í™•í•œ í•´ u(x) = sin(Ï€x)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f_sin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">u_exact_sin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">fem_1d_poisson</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">f_sin</span><span class="p">)</span>

<span class="n">x_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">u_exact_fine</span> <span class="o">=</span> <span class="n">u_exact_sin</span><span class="p">(</span><span class="n">x_fine</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fine</span><span class="p">,</span> <span class="n">u_exact_fine</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;FEM (N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;u(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;1D Poisson: -u</span><span class="se">\&#39;\&#39;</span><span class="s1"> = Ï€Â² sin(Ï€x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fem_1d_poisson_sin.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">u_exact_nodes</span> <span class="o">=</span> <span class="n">u_exact_sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">error_L2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact_nodes</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">N</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L2 error: </span><span class="si">{</span><span class="n">error_L2</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="6">6. ê²½ê³„ ì¡°ê±´<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ë””ë¦¬í´ë ˆ ê²½ê³„ ì¡°ê±´<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<p>ìœ„ì—ì„œ ì´ë¯¸ êµ¬í˜„ë¨: ì‹œìŠ¤í…œì˜ í–‰ì„ ìˆ˜ì •í•˜ì—¬ u(0) = Î±, u(1) = Î² ì„¤ì •.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fem_1d_dirichlet</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">f_func</span><span class="p">,</span> <span class="n">u_left</span><span class="p">,</span> <span class="n">u_right</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ë””ë¦¬í´ë ˆ BCë¡œ í’€ê¸°: u(0) = u_left, u(1) = u_right.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">assemble_stiffness_1d</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">x_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f_mid</span> <span class="o">=</span> <span class="n">f_func</span><span class="p">(</span><span class="n">x_mid</span><span class="p">)</span>
        <span class="n">f</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f_mid</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f</span><span class="p">[</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f_mid</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># BC ì ìš©</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tolil</span><span class="p">()</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_left</span>

    <span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_right</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span>

<span class="c1"># ì˜ˆì œ: u(0) = 0.5, u(1) = 0.2</span>
<span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">fem_1d_dirichlet</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">f_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">u_left</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">u_right</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;u(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FEM with Dirichlet BC: u(0)=0.5, u(1)=0.2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fem_dirichlet_bc.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h3 id="62">6.2 ë…¸ì´ë§Œ ê²½ê³„ ì¡°ê±´<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<p>ë…¸ì´ë§Œ BC (í”ŒëŸ­ìŠ¤ ì¡°ê±´)ì˜ ê²½ìš°, ì˜ˆ: u'(0) = gâ‚€, u'(1) = gâ‚:</p>
<p>ì•½í˜•ì‹ì€ ê²½ê³„ í•­ì„ í†µí•´ ë…¸ì´ë§Œ BCë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨:</p>
<div class="highlight"><pre><span></span><code>âˆ«â‚€Â¹ u&#39; v&#39; dx = âˆ«â‚€Â¹ f v dx + [u&#39; v]â‚€Â¹
             = âˆ«â‚€Â¹ f v dx + gâ‚ v(1) - gâ‚€ v(0)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fem_1d_neumann</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">f_func</span><span class="p">,</span> <span class="n">g_left</span><span class="p">,</span> <span class="n">g_right</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ë…¸ì´ë§Œ BCë¡œ í’€ê¸°: u&#39;(0) = g_left, u&#39;(1) = g_right.</span>

<span class="sd">    ì£¼ì˜: ìˆœìˆ˜ ë…¸ì´ë§Œ ë¬¸ì œëŠ” âˆ«f dx + g_right - g_left = 0ì¼ ë•Œë§Œ í•´ë¥¼ ê°€ì§.</span>
<span class="sd">    ë¬¸ì œë¥¼ ì˜ ì •ì˜í•˜ê¸° ìœ„í•´ u(0) = 0ìœ¼ë¡œ ê³ ì •.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">assemble_stiffness_1d</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">x_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f_mid</span> <span class="o">=</span> <span class="n">f_func</span><span class="p">(</span><span class="n">x_mid</span><span class="p">)</span>
        <span class="n">f</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f_mid</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f</span><span class="p">[</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f_mid</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># ë…¸ì´ë§Œ BC ê¸°ì—¬ ì¶”ê°€</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">g_left</span>
    <span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g_right</span>

    <span class="c1"># ì˜ê³µê°„ ì œê±°ë¥¼ ìœ„í•´ í•˜ë‚˜ì˜ ê°’ ê³ ì • (ì˜ˆ: u(0) = 0)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tolil</span><span class="p">()</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span>

<span class="c1"># ì˜ˆì œ: -u&#39;&#39; = 0, u&#39;(0) = 1, u&#39;(1) = 1 â†’ u(x) = x + C, u(0)=0ìœ¼ë¡œ C ê³ ì •</span>
<span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">fem_1d_neumann</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">f_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">g_left</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">g_right</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact u(x)=x&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;u(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FEM with Neumann BC: u</span><span class="se">\&#39;</span><span class="s1">(0)=1, u</span><span class="se">\&#39;</span><span class="s1">(1)=1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fem_neumann_bc.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="7-2d-fem">7. 2D FEM ê°œìš”<a class="header-link" href="#7-2d-fem" title="Permanent link">&para;</a></h2>
<h3 id="71-2d">7.1 2D í‘¸ì•„ì†¡ ë°©ì •ì‹<a class="header-link" href="#71-2d" title="Permanent link">&para;</a></h3>
<p>2Dì—ì„œ í‘¸ì•„ì†¡ ë°©ì •ì‹ì€:</p>
<div class="highlight"><pre><span></span><code>-Î”u = -âˆ‚Â²u/âˆ‚xÂ² - âˆ‚Â²u/âˆ‚yÂ² = f(x, y),  (x, y) âˆˆ Î©
u = 0 on âˆ‚Î© (ê²½ê³„)
</code></pre></div>

<p><strong>ì•½í˜•ì‹:</strong></p>
<div class="highlight"><pre><span></span><code>âˆ«_Î© âˆ‡u Â· âˆ‡v dA = âˆ«_Î© f v dA
</code></pre></div>

<h3 id="72">7.2 ì‚¼ê°í˜• ìš”ì†Œ<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<p>ì˜ì—­ Î©ëŠ” ì‚¼ê°í˜• ìš”ì†Œë¡œ ë¶„í• :</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              2D ì‚¼ê°í˜• ë©”ì‹œ                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚      oâ”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€o                                       â”‚
â”‚      â”‚\     â”‚\     â”‚                                       â”‚
â”‚      â”‚ \    â”‚ \    â”‚                                       â”‚
â”‚      â”‚  \   â”‚  \   â”‚                                       â”‚
â”‚      â”‚   \  â”‚   \  â”‚                                       â”‚
â”‚      â”‚    \ â”‚    \ â”‚                                       â”‚
â”‚      oâ”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€o                                       â”‚
â”‚      â”‚\     â”‚\     â”‚                                       â”‚
â”‚      â”‚ \    â”‚ \    â”‚                                       â”‚
â”‚      â”‚  \   â”‚  \   â”‚                                       â”‚
â”‚      oâ”€â”€â”€â”€â”€â”€oâ”€â”€â”€â”€â”€â”€o                                       â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>ê° ì‚¼ê°í˜•ì€ 3ê°œì˜ ê¼­ì§“ì (ì ˆì )ì„ ê°€ì§‘ë‹ˆë‹¤. ì„ í˜• ê¸°ì € í•¨ìˆ˜ Ï†áµ¢(x, y)ëŠ”:
- Ï†áµ¢(xâ±¼, yâ±¼) = Î´áµ¢â±¼
- Ï†áµ¢ëŠ” ê° ì‚¼ê°í˜• ë‚´ì—ì„œ ì„ í˜•
- Ï†áµ¢ = 0 ì ˆì  ië¥¼ í¬í•¨í•˜ëŠ” ì‚¼ê°í˜• ë°–ì—ì„œ</p>
<h3 id="73-2d">7.3 ìš”ì†Œ ê°•ì„± í–‰ë ¬ (2D)<a class="header-link" href="#73-2d" title="Permanent link">&para;</a></h3>
<p>ê¼­ì§“ì  (xâ‚, yâ‚), (xâ‚‚, yâ‚‚), (xâ‚ƒ, yâ‚ƒ)ì„ ê°€ì§„ ì‚¼ê°í˜•ì˜ ê²½ìš°:</p>
<div class="highlight"><pre><span></span><code>Aáµ¢â±¼ = âˆ«_T âˆ‡Ï†áµ¢ Â· âˆ‡Ï†â±¼ dA

where âˆ‡Ï†áµ¢ = [âˆ‚Ï†áµ¢/âˆ‚x, âˆ‚Ï†áµ¢/âˆ‚y]áµ€ (ì‚¼ê°í˜• ë‚´ì—ì„œ ìƒìˆ˜)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">triangle_area</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ê¼­ì§“ì  p1, p2, p3ì„ ê°€ì§„ ì‚¼ê°í˜•ì˜ ë©´ì  ê³„ì‚°.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">((</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">p3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span>
                     <span class="p">(</span><span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">triangle_stiffness_2d</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2D ì„ í˜• ì‚¼ê°í˜•ì˜ ìš”ì†Œ ê°•ì„± í–‰ë ¬ ê³„ì‚°.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    p1, p2, p3 : íŠœí”Œ (x, y), ì‚¼ê°í˜• ê¼­ì§“ì </span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    A_elem : 3x3 ë°°ì—´</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">p3</span>

    <span class="n">area</span> <span class="o">=</span> <span class="n">triangle_area</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>

    <span class="c1"># ê¸°ì € í•¨ìˆ˜ì˜ ê¸°ìš¸ê¸° (ì‚¼ê°í˜• ë‚´ì—ì„œ ìƒìˆ˜)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">-</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">])</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x3</span> <span class="o">-</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">])</span>

    <span class="c1"># ê°•ì„± í–‰ë ¬</span>
    <span class="n">A_elem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">A_elem</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">area</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">A_elem</span>

<span class="c1"># ì˜ˆì œ ì‚¼ê°í˜•</span>
<span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">A_elem</span> <span class="o">=</span> <span class="n">triangle_stiffness_2d</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2D triangle stiffness matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_elem</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="8">8. ì˜¤ì°¨ ë¶„ì„ê³¼ ìˆ˜ë ´<a class="header-link" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ìˆ˜ë ´ë¥ <a class="header-link" href="#81" title="Permanent link">&para;</a></h3>
<p>-u'' = fë¥¼ í‘¸ëŠ” ì„ í˜• ìœ í•œ ìš”ì†Œ(êµ¬ê°„ë³„ ì„ í˜• ê¸°ì €)ì˜ ê²½ìš°:</p>
<p><strong>ì´ë¡ ì  ìˆ˜ë ´:</strong>
- LÂ² ì˜¤ì°¨: ||u - uâ‚•||<em>{LÂ²} = O(hÂ²)
- HÂ¹ ì˜¤ì°¨: ||u - uâ‚•||</em>{HÂ¹} = O(h)  (ê¸°ìš¸ê¸° ì˜¤ì°¨)
- Lâˆ ì˜¤ì°¨: ||u - uâ‚•||_{Lâˆ} = O(hÂ²)</p>
<p>ì—¬ê¸°ì„œ hëŠ” ìš”ì†Œ í¬ê¸°.</p>
<h3 id="82">8.2 ìˆ˜ë ´ í…ŒìŠ¤íŠ¸<a class="header-link" href="#82" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convergence_test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Nì„ ì¦ê°€ì‹œí‚¤ë©´ì„œ -u&#39;&#39; = Ï€Â² sin(Ï€x)ë¥¼ í’€ì–´ FEM ìˆ˜ë ´ í…ŒìŠ¤íŠ¸.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
    <span class="n">errors_L2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">errors_Linf</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">h_values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_values</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">fem_1d_poisson</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">u_exact_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">N</span>
        <span class="n">h_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="n">error_L2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact_nodes</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">error_Linf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">u_exact_nodes</span><span class="p">))</span>

        <span class="n">errors_L2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
        <span class="n">errors_Linf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_Linf</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N=</span><span class="si">{</span><span class="n">N</span><span class="si">:</span><span class="s2">3d</span><span class="si">}</span><span class="s2">, h=</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">: L2=</span><span class="si">{</span><span class="n">error_L2</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">, Lâˆ=</span><span class="si">{</span><span class="n">error_Linf</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ìˆ˜ë ´ í”Œë¡¯</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">errors_L2</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LÂ² error&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">errors_Linf</span><span class="p">,</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lâˆ error&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="c1"># ì°¸ì¡° ê¸°ìš¸ê¸°</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_values</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(hÂ²)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_values</span><span class="p">),</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;O(h)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;h (element size)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FEM Convergence (Linear Elements)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;fem_convergence.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">convergence_test</span><span class="p">()</span>
</code></pre></div>

<p><strong>ì¶œë ¥:</strong></p>
<div class="highlight"><pre><span></span><code>N=  5, h=0.2000: L2=3.9464e-03, Lâˆ=4.9299e-03
N= 10, h=0.1000: L2=9.9067e-04, Lâˆ=1.2337e-03
N= 20, h=0.0500: L2=2.4794e-04, Lâˆ=3.0852e-04
N= 40, h=0.0250: L2=6.2007e-05, Lâˆ=7.7139e-05
N= 80, h=0.0125: L2=1.5504e-05, Lâˆ=1.9286e-05
</code></pre></div>

<p>ì˜¤ì°¨ê°€ O(hÂ²)ë¡œ ê°ì†Œí•˜ì—¬ ì´ë¡ ì  ì˜ˆì¸¡ì„ í™•ì¸í•©ë‹ˆë‹¤.</p>
<hr />
<h2 id="9">9. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="1">ë¬¸ì œ 1: ê°€ë³€ ê³„ìˆ˜<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>ê°€ë³€ ê³„ìˆ˜ ë¬¸ì œ í’€ê¸°:</p>
<div class="highlight"><pre><span></span><code>-(a(x) u&#39;(x))&#39; = f(x),  x âˆˆ (0, 1)
u(0) = u(1) = 0
</code></pre></div>

<p>a(x) = 1 + x ë° f(x) = 1. FEM êµ¬í˜„ ë° ìˆ˜ì¹˜ ì°¸ì¡°ì™€ ë¹„êµ.</p>
<p><strong>íŒíŠ¸:</strong> ì•½í˜•ì‹ì€ âˆ« a(x) u'(x) v'(x) dx = âˆ« f(x) v(x) dx.</p>
<h3 id="2_1">ë¬¸ì œ 2: í˜¼í•© ê²½ê³„ ì¡°ê±´<a class="header-link" href="#2_1" title="Permanent link">&para;</a></h3>
<p>u(0) = 0 (ë””ë¦¬í´ë ˆ) ë° u'(1) = -0.5 (ë…¸ì´ë§Œ)ë¡œ -u'' = 1 í’€ê¸°. ì •í™•í•œ í•´ì™€ ë¹„êµ.</p>
<h3 id="3-2">ë¬¸ì œ 3: 2ì°¨ ìš”ì†Œ<a class="header-link" href="#3-2" title="Permanent link">&para;</a></h3>
<p>2ì°¨ ê¸°ì € í•¨ìˆ˜(ìš”ì†Œë‹¹ 3ê°œ ì ˆì : ë‘ ëì  + ì¤‘ê°„ì )ë¥¼ ì‚¬ìš©í•˜ë„ë¡ 1D FEM ì½”ë“œ í™•ì¥. ì„ í˜• ìš”ì†Œì™€ ìˆ˜ë ´ë¥  ë¹„êµ.</p>
<h3 id="4-2d">ë¬¸ì œ 4: ë‹¨ìœ„ ì •ì‚¬ê°í˜•ì—ì„œ 2D í‘¸ì•„ì†¡<a class="header-link" href="#4-2d" title="Permanent link">&para;</a></h3>
<p>ê²½ê³„ì—ì„œ u=0ì¸ ë‹¨ìœ„ ì •ì‚¬ê°í˜• [0,1]Ã—[0,1]ì—ì„œ -Î”u = 1ì— ëŒ€í•œ 2D FEM êµ¬í˜„. êµ¬ì¡°í™”ëœ ì‚¼ê°í˜• ë©”ì‹œ ì‚¬ìš© ë° í•´ ê²€ì¦.</p>
<h3 id="5">ë¬¸ì œ 5: ê³ ì°¨ ìˆ˜ë ´<a class="header-link" href="#5" title="Permanent link">&para;</a></h3>
<p>ì •í™•í•œ í•´ u(x) = x(1-x) sin(Ï€x)ê°€ ë˜ë„ë¡ f(x)ê°€ ì„ íƒë˜ëŠ” ë°©ì •ì‹ -u'' = f(x)ì˜ ìˆ˜ë ´ í…ŒìŠ¤íŠ¸. ì„ í˜• ìš”ì†Œì— ëŒ€í•´ LÂ² ì˜¤ì°¨ê°€ O(hÂ²)ì¸ì§€ ê²€ì¦.</p>
<hr />
<h2 id="_3">ì´ë™<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li>ì´ì „: <a href="21_Spectral_Methods.md">21. ìŠ¤í™íŠ¸ëŸ¼ ë°©ë²•</a></li>
<li>ë‹¤ìŒ: <a href="00_Overview.md">ê°œìš”</a></li>
<li><a href="00_Overview.md">ê°œìš”ë¡œ ëŒì•„ê°€ê¸°</a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Numerical_Simulation/21_Spectral_Methods.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">ìŠ¤í™íŠ¸ëŸ¼ ë°©ë²•(Spectral Methods)</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Numerical_Simulation/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}