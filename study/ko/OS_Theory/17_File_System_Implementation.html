{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파일 시스템 구현 ⭐⭐⭐⭐ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/OS_Theory/">OS Theory</a>
    <span class="separator">/</span>
    <span class="current">파일 시스템 구현 ⭐⭐⭐⭐</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>파일 시스템 구현 ⭐⭐⭐⭐</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/OS_Theory/16_File_System_Basics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">파일 시스템 기초 ⭐⭐⭐</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/OS_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/OS_Theory/18_IO_and_IPC.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">I/O와 IPC ⭐⭐⭐</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_2">개요</a></li>
<li><a href="#_3">목차</a></li>
<li><a href="#1">1. 파일 시스템 구조</a><ul>
<li><a href="#11">1.1 디스크 레이아웃</a></li>
<li><a href="#12">1.2 주요 구성 요소</a></li>
</ul>
</li>
<li><a href="#2">2. 디스크 블록 할당</a><ul>
<li><a href="#21-contiguous-allocation">2.1 연속 할당 (Contiguous Allocation)</a></li>
<li><a href="#22-linked-allocation">2.2 연결 할당 (Linked Allocation)</a></li>
<li><a href="#23-fat-file-allocation-table">2.3 FAT (File Allocation Table)</a></li>
<li><a href="#24-indexed-allocation">2.4 인덱스 할당 (Indexed Allocation)</a></li>
</ul>
</li>
<li><a href="#3-inode">3. inode 구조</a><ul>
<li><a href="#31-unixlinux-inode">3.1 Unix/Linux inode</a></li>
<li><a href="#32">3.2 직접/간접 블록 포인터</a></li>
<li><a href="#33-inode">3.3 inode 크기 계산 예제</a></li>
</ul>
</li>
<li><a href="#4">4. 디렉토리 구현</a><ul>
<li><a href="#41">4.1 디렉토리 엔트리 구조</a></li>
<li><a href="#42">4.2 해시 테이블 디렉토리</a></li>
</ul>
</li>
<li><a href="#5">5. 파일 시스템 예시</a><ul>
<li><a href="#51-fat32">5.1 FAT32</a></li>
<li><a href="#52-ext4">5.2 ext4</a></li>
</ul>
</li>
<li><a href="#6">6. 저널링</a><ul>
<li><a href="#61">6.1 저널링의 필요성</a></li>
<li><a href="#62">6.2 저널링 동작</a></li>
<li><a href="#63">6.3 저널 모드</a></li>
</ul>
</li>
<li><a href="#7-raid">7. RAID</a><ul>
<li><a href="#71-raid">7.1 RAID 개요</a></li>
<li><a href="#72-raid">7.2 RAID 레벨</a></li>
<li><a href="#73-raid">7.3 RAID 레벨 비교</a></li>
</ul>
</li>
<li><a href="#_4">연습 문제</a><ul>
<li><a href="#1-inode">문제 1: inode 블록 포인터</a></li>
<li><a href="#2-fat">문제 2: FAT 체인</a></li>
<li><a href="#3">문제 3: 저널링 복구</a></li>
<li><a href="#4-raid">문제 4: RAID 용량 계산</a></li>
<li><a href="#5_1">문제 5: 파일 삭제 과정</a></li>
</ul>
</li>
<li><a href="#_5">다음 단계</a></li>
<li><a href="#_6">참고 자료</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="_1">파일 시스템 구현 ⭐⭐⭐⭐<a class="header-link" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">개요<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>파일 시스템이 디스크에 데이터를 어떻게 저장하고 관리하는지 학습합니다. 블록 할당 방식, inode 구조, 저널링, RAID 등 실제 구현에 필요한 핵심 개념을 다룹니다.</p>
<hr />
<h2 id="_3">목차<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-파일-시스템-구조">파일 시스템 구조</a></li>
<li><a href="#2-디스크-블록-할당">디스크 블록 할당</a></li>
<li><a href="#3-inode-구조">inode 구조</a></li>
<li><a href="#4-디렉토리-구현">디렉토리 구현</a></li>
<li><a href="#5-파일-시스템-예시">파일 시스템 예시</a></li>
<li><a href="#6-저널링">저널링</a></li>
<li><a href="#7-raid">RAID</a></li>
<li><a href="#연습-문제">연습 문제</a></li>
</ol>
<hr />
<h2 id="1">1. 파일 시스템 구조<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 디스크 레이아웃<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                     일반적인 파일 시스템 레이아웃                        │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │                         디스크 전체                              │   │
│   ├──────┬──────┬──────┬──────┬──────┬───────────────────────────────┤   │
│   │ MBR  │ 파티션│ 파티션│ 파티션│      │                            │   │
│   │      │  1   │  2   │  3   │ ...  │       빈 공간               │   │
│   └──────┴──────┴──────┴──────┴──────┴───────────────────────────────┘   │
│                  │                                                       │
│                  ▼                                                       │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │                      파티션 구조 (ext4 예)                       │   │
│   ├──────┬──────────┬──────────┬────────────────────────────────────┤   │
│   │ 부트 │  슈퍼   │  그룹    │            블록 그룹들             │   │
│   │ 블록 │  블록   │ 디스크립터│   0    │   1    │   2   │  ...   │   │
│   └──────┴──────────┴──────────┴────────────────────────────────────┘   │
│                                           │                              │
│                                           ▼                              │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │                        블록 그룹 구조                            │   │
│   ├──────────┬──────────┬──────────┬──────────────────────────────────┤  │
│   │  블록    │  inode   │  inode   │          데이터 블록            │  │
│   │  비트맵  │  비트맵  │  테이블  │                                  │  │
│   └──────────┴──────────┴──────────┴──────────────────────────────────┘  │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="12">1.2 주요 구성 요소<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                      파일 시스템 구성 요소                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌────────────────┬────────────────────────────────────────────────┐    │
│  │    구성 요소    │                    역할                        │    │
│  ├────────────────┼────────────────────────────────────────────────┤    │
│  │ 부트 블록       │ 부트스트랩 코드 (OS 로딩)                     │    │
│  │ (Boot Block)   │ 파티션 0번 블록                                │    │
│  ├────────────────┼────────────────────────────────────────────────┤    │
│  │ 슈퍼블록        │ 파일 시스템 메타데이터                         │    │
│  │ (Superblock)   │ - 블록 크기, 총 블록/inode 수                  │    │
│  │                │ - 자유 블록/inode 수                           │    │
│  │                │ - 마운트 횟수, 마지막 검사 시간                 │    │
│  ├────────────────┼────────────────────────────────────────────────┤    │
│  │ 블록 비트맵     │ 각 블록의 사용 여부 (0/1)                      │    │
│  │ (Block Bitmap) │ 빠른 자유 블록 탐색                            │    │
│  ├────────────────┼────────────────────────────────────────────────┤    │
│  │ inode 비트맵    │ 각 inode의 사용 여부 (0/1)                     │    │
│  ├────────────────┼────────────────────────────────────────────────┤    │
│  │ inode 테이블    │ 모든 inode 저장                                │    │
│  │                │ 파일 메타데이터의 핵심                         │    │
│  ├────────────────┼────────────────────────────────────────────────┤    │
│  │ 데이터 블록     │ 실제 파일/디렉토리 내용                        │    │
│  └────────────────┴────────────────────────────────────────────────┘    │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="2">2. 디스크 블록 할당<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-contiguous-allocation">2.1 연속 할당 (Contiguous Allocation)<a class="header-link" href="#21-contiguous-allocation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                         연속 할당                                        │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   디렉토리 엔트리:                                                       │
│   ┌───────────┬─────────┬────────┐                                      │
│   │ 파일명    │ 시작블록 │  길이  │                                      │
│   ├───────────┼─────────┼────────┤                                      │
│   │ file_a    │    0    │   3    │                                      │
│   │ file_b    │    6    │   2    │                                      │
│   │ file_c    │   10    │   4    │                                      │
│   └───────────┴─────────┴────────┘                                      │
│                                                                          │
│   디스크 블록:                                                           │
│   ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐        │
│   │ A │ A │ A │   │   │   │ B │ B │   │   │ C │ C │ C │ C │   │        │
│   └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘        │
│    0   1   2   3   4   5   6   7   8   9  10  11  12  13  14            │
│                                                                          │
│   장점:                                                                  │
│   - 순차 접근 빠름 (디스크 헤드 이동 최소)                              │
│   - 직접 접근 쉬움: 블록 n = 시작 + n                                   │
│                                                                          │
│   단점:                                                                  │
│   - 외부 단편화 발생 (블록 3-5, 8-9 낭비)                               │
│   - 파일 크기 증가 어려움                                               │
│   - 미리 크기 알아야 함                                                 │
│                                                                          │
│   사용: CD-ROM, DVD (읽기 전용)                                         │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="22-linked-allocation">2.2 연결 할당 (Linked Allocation)<a class="header-link" href="#22-linked-allocation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                         연결 할당                                        │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   디렉토리 엔트리:                                                       │
│   ┌───────────┬─────────┬─────────┐                                     │
│   │ 파일명    │ 시작블록 │ 끝블록  │                                     │
│   ├───────────┼─────────┼─────────┤                                     │
│   │ file_a    │    0    │   12    │                                     │
│   └───────────┴─────────┴─────────┘                                     │
│                                                                          │
│   디스크 블록 (각 블록에 다음 블록 포인터 포함):                        │
│                                                                          │
│   ┌───────────┐   ┌───────────┐   ┌───────────┐   ┌───────────┐        │
│   │ 블록 0    │   │ 블록 5    │   │ 블록 8    │   │ 블록 12   │        │
│   │ 데이터    │──▶│ 데이터    │──▶│ 데이터    │──▶│ 데이터    │        │
│   │ 다음: 5   │   │ 다음: 8   │   │ 다음: 12  │   │ 다음: -1  │        │
│   └───────────┘   └───────────┘   └───────────┘   └───────────┘        │
│        0               5               8              12                │
│                                                                          │
│   장점:                                                                  │
│   - 외부 단편화 없음                                                    │
│   - 파일 크기 동적 증가 가능                                            │
│                                                                          │
│   단점:                                                                  │
│   - 직접 접근 비효율 (n번째 블록 접근 시 n번 따라가야 함)               │
│   - 포인터 공간 낭비 (각 블록에 4바이트)                                │
│   - 신뢰성 문제 (포인터 손상 시 파일 손실)                              │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="23-fat-file-allocation-table">2.3 FAT (File Allocation Table)<a class="header-link" href="#23-fat-file-allocation-table" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                             FAT 구조                                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   FAT (메모리에 캐시됨)           디스크 블록                            │
│   ┌─────────────────┐            ┌───────────────────────────────────┐  │
│   │인덱스│ 다음블록 │            │                                   │  │
│   ├─────┼──────────┤            │  0  │  1  │  2  │  3  │  4  │ ... │  │
│   │  0  │    5     │────────────┼─ A ─┼─────┼─ B ─┼─────┼─────┼─────┤  │
│   │  1  │   FREE   │            │     │     │     │     │     │     │  │
│   │  2  │    4     │────────────┼─────┼─────┼─────┼─────┼─ B ─┼─────┤  │
│   │  3  │   FREE   │            │                                   │  │
│   │  4  │   EOF    │────────────┼─────┼─ A ─┼─────┼─────┼─────┼─────┤  │
│   │  5  │    7     │            │                                   │  │
│   │  6  │   FREE   │            │                                   │  │
│   │  7  │   EOF    │            └───────────────────────────────────┘  │
│   └─────┴──────────┘                                                    │
│                                                                          │
│   file_a: 0 → 5 → 7 → EOF                                              │
│   file_b: 2 → 4 → EOF                                                   │
│                                                                          │
│   장점:                                                                  │
│   - FAT가 메모리에 있으면 직접 접근 빠름                                │
│   - 포인터가 데이터 블록 외부에 있어 신뢰성 향상                        │
│                                                                          │
│   단점:                                                                  │
│   - FAT 크기가 클 수 있음 (대용량 디스크)                               │
│   - FAT 손상 시 전체 파일 시스템 문제                                   │
│                                                                          │
│   사용: MS-DOS, Windows (FAT32), USB 드라이브                           │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="24-indexed-allocation">2.4 인덱스 할당 (Indexed Allocation)<a class="header-link" href="#24-indexed-allocation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                        </span><span class="n">인덱스</span><span class="w"> </span><span class="n">할당</span><span class="w">                                       </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">디렉토리</span><span class="w"> </span><span class="nl">엔트리</span><span class="p">:</span><span class="w">                                                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌───────────┬───────────┐</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">파일명</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">인덱스블록</span><span class="w"> </span><span class="err">│</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">├───────────┼───────────┤</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="n">file_a</span><span class="w">    </span><span class="err">│</span><span class="w">     </span><span class="mi">8</span><span class="w">     </span><span class="err">│</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└───────────┴───────────┘</span><span class="w">                                             </span><span class="err">│</span>
<span class="err">│</span><span class="w">                    </span><span class="err">│</span><span class="w">                                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">                    </span><span class="err">▼</span><span class="w">                                                     </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="n">인덱스</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="p">(</span><span class="n">블록</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="err">:</span><span class="w">          </span><span class="n">데이터</span><span class="w"> </span><span class="nl">블록</span><span class="p">:</span><span class="w">                           </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌───────────────────┐</span><span class="w">          </span><span class="err">┌───────────────────────────────────┐</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="mi">3</span><span class="w">      </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">                                   </span><span class="err">│</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="mi">10</span><span class="w">     </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">15</span><span class="w">  </span><span class="err">│</span><span class="w"> </span><span class="mi">21</span><span class="w">  </span><span class="err">│</span><span class="w">  </span><span class="p">...</span><span class="w">     </span><span class="err">│</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="mi">15</span><span class="w">     </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="n">데이터</span><span class="err">│</span><span class="n">데이터</span><span class="err">│</span><span class="n">데이터</span><span class="err">│</span><span class="n">데이터</span><span class="err">│</span><span class="w">        </span><span class="err">│</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="o">[</span><span class="n">3</span><span class="o">]</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="mi">21</span><span class="w">     </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">     </span><span class="err">│</span><span class="w">          </span><span class="err">│</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="o">[</span><span class="n">4</span><span class="o">]</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">끝</span><span class="p">)</span><span class="w">     </span><span class="err">│</span><span class="w">          </span><span class="err">└───────────────────────────────────┘</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="p">...</span><span class="w">               </span><span class="err">│</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└───────────────────┘</span><span class="w">                                                 </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="nl">장점</span><span class="p">:</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">직접</span><span class="w"> </span><span class="n">접근</span><span class="w"> </span><span class="nl">가능</span><span class="p">:</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">인덱스</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">외부</span><span class="w"> </span><span class="n">단편화</span><span class="w"> </span><span class="n">없음</span><span class="w">                                                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="nl">단점</span><span class="p">:</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">인덱스</span><span class="w"> </span><span class="n">블록</span><span class="w"> </span><span class="n">오버헤드</span><span class="w">                                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">작은</span><span class="w"> </span><span class="n">파일에</span><span class="w"> </span><span class="n">비효율적</span><span class="w">                                                </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="nl">확장</span><span class="p">:</span><span class="w">                                                                  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">연결</span><span class="w"> </span><span class="nl">인덱스</span><span class="p">:</span><span class="w"> </span><span class="n">인덱스</span><span class="w"> </span><span class="n">블록들을</span><span class="w"> </span><span class="n">연결</span><span class="w">                                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">다단계</span><span class="w"> </span><span class="nl">인덱스</span><span class="p">:</span><span class="w"> </span><span class="n">트리</span><span class="w"> </span><span class="n">구조</span><span class="w"> </span><span class="p">(</span><span class="n">Unix</span><span class="w"> </span><span class="n">inode</span><span class="p">)</span><span class="w">                               </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">결합</span><span class="w"> </span><span class="nl">방식</span><span class="p">:</span><span class="w"> </span><span class="n">직접</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">간접</span><span class="w"> </span><span class="n">포인터</span><span class="w"> </span><span class="p">(</span><span class="n">Unix</span><span class="w"> </span><span class="n">inode</span><span class="p">)</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<hr />
<h2 id="3-inode">3. inode 구조<a class="header-link" href="#3-inode" title="Permanent link">&para;</a></h2>
<h3 id="31-unixlinux-inode">3.1 Unix/Linux inode<a class="header-link" href="#31-unixlinux-inode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                        inode 구조 (Unix/ext4)                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │                         inode                                    │   │
│   ├─────────────────────────────────────────────────────────────────┤   │
│   │  mode (권한, 유형)                                              │   │
│   │  uid (소유자)                                                   │   │
│   │  gid (그룹)                                                     │   │
│   │  size (파일 크기)                                               │   │
│   │  atime (접근 시간)                                              │   │
│   │  mtime (수정 시간)                                              │   │
│   │  ctime (상태 변경 시간)                                         │   │
│   │  link count (하드 링크 수)                                      │   │
│   ├─────────────────────────────────────────────────────────────────┤   │
│   │  블록 포인터 (데이터 위치)                                       │   │
│   │                                                                  │   │
│   │  ┌─────────────────────────────────────────────────────────┐    │   │
│   │  │ 직접 포인터    [0-11]  → 데이터 블록 (12개)            │    │   │
│   │  ├─────────────────────────────────────────────────────────┤    │   │
│   │  │ 단일 간접     [12]    → 인덱스 블록 → 데이터           │    │   │
│   │  ├─────────────────────────────────────────────────────────┤    │   │
│   │  │ 이중 간접     [13]    → 인덱스 → 인덱스 → 데이터       │    │   │
│   │  ├─────────────────────────────────────────────────────────┤    │   │
│   │  │ 삼중 간접     [14]    → 인덱스 → 인덱스 → 인덱스 → 데이터│   │   │
│   │  └─────────────────────────────────────────────────────────┘    │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="32">3.2 직접/간접 블록 포인터<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                  inode 블록 포인터 구조                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   블록 크기 = 4KB, 포인터 크기 = 4바이트                                │
│   포인터/블록 = 4KB / 4B = 1024개                                       │
│                                                                          │
│   inode                                                                  │
│   ┌───────────────┐                                                     │
│   │ 직접 [0]     │────────────────────────────────────▶ [데이터 블록]  │
│   │ 직접 [1]     │────────────────────────────────────▶ [데이터 블록]  │
│   │ ...          │                                                      │
│   │ 직접 [11]    │────────────────────────────────────▶ [데이터 블록]  │
│   ├───────────────┤                                                     │
│   │ 단일 간접[12]│──▶┌──────────┐                                      │
│   │              │    │인덱스블록│──▶ [데이터] × 1024                   │
│   │              │    └──────────┘                                      │
│   ├───────────────┤                                                     │
│   │ 이중 간접[13]│──▶┌──────────┐    ┌──────────┐                      │
│   │              │    │인덱스블록│──▶│인덱스블록│──▶ [데이터] × 1024   │
│   │              │    │ × 1024   │    └──────────┘    × 1024            │
│   │              │    └──────────┘                                      │
│   ├───────────────┤                                                     │
│   │ 삼중 간접[14]│──▶ (3단계 인덱스)                                   │
│   └───────────────┘                                                     │
│                                                                          │
│   최대 파일 크기 계산 (4KB 블록):                                       │
│   직접: 12 × 4KB = 48KB                                                 │
│   단일 간접: 1024 × 4KB = 4MB                                           │
│   이중 간접: 1024 × 1024 × 4KB = 4GB                                    │
│   삼중 간접: 1024 × 1024 × 1024 × 4KB = 4TB                             │
│   총: 약 4TB                                                             │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="33-inode">3.3 inode 크기 계산 예제<a class="header-link" href="#33-inode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// 파일의 n번째 블록 위치 찾기</span>
<span class="cp">#define BLOCK_SIZE 4096</span>
<span class="cp">#define PTRS_PER_BLOCK (BLOCK_SIZE / sizeof(uint32_t))  </span><span class="c1">// 1024</span>

<span class="cp">#define DIRECT_BLOCKS 12</span>
<span class="cp">#define SINGLE_INDIRECT_LIMIT (DIRECT_BLOCKS + PTRS_PER_BLOCK)</span>
<span class="cp">#define DOUBLE_INDIRECT_LIMIT (SINGLE_INDIRECT_LIMIT + PTRS_PER_BLOCK * PTRS_PER_BLOCK)</span>

<span class="kt">uint32_t</span><span class="w"> </span><span class="nf">get_block_number</span><span class="p">(</span><span class="n">inode_t</span><span class="o">*</span><span class="w"> </span><span class="n">inode</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">logical_block</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logical_block</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">DIRECT_BLOCKS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 직접 블록</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">inode</span><span class="o">-&gt;</span><span class="n">direct</span><span class="p">[</span><span class="n">logical_block</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">logical_block</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">DIRECT_BLOCKS</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logical_block</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PTRS_PER_BLOCK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 단일 간접</span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">indirect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_block</span><span class="p">(</span><span class="n">inode</span><span class="o">-&gt;</span><span class="n">single_indirect</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">indirect</span><span class="p">[</span><span class="n">logical_block</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">logical_block</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">PTRS_PER_BLOCK</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logical_block</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PTRS_PER_BLOCK</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">PTRS_PER_BLOCK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 이중 간접</span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">index1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logical_block</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PTRS_PER_BLOCK</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">index2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logical_block</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">PTRS_PER_BLOCK</span><span class="p">;</span>

<span class="w">        </span><span class="kt">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">level1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_block</span><span class="p">(</span><span class="n">inode</span><span class="o">-&gt;</span><span class="n">double_indirect</span><span class="p">);</span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">level2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_block</span><span class="p">(</span><span class="n">level1</span><span class="p">[</span><span class="n">index1</span><span class="p">]);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">level2</span><span class="p">[</span><span class="n">index2</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 삼중 간접 (생략)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="4">4. 디렉토리 구현<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 디렉토리 엔트리 구조<a class="header-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                      </span><span class="nx">디렉토리</span><span class="w"> </span><span class="nx">구현</span><span class="w"> </span><span class="nx">방식</span><span class="w">                                  </span><span class="err">│</span>
<span class="err">├─────────────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="nx">선형</span><span class="w"> </span><span class="nx">리스트</span><span class="w"> </span><span class="p">(</span><span class="nx">간단한</span><span class="w"> </span><span class="nx">구현</span><span class="p">):</span><span class="w">                                            </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌──────────────────────────────────────────────────────────────────┐</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nx">디렉토리</span><span class="w"> </span><span class="nx">파일</span><span class="w"> </span><span class="nx">내용</span><span class="w">                                                </span><span class="err">│</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">├────────────┬────────────────┬──────────────────────────────────────┤</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nx">inode</span><span class="w"> </span><span class="nx">번호</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="nx">엔트리</span><span class="w"> </span><span class="nx">길이</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="nx">파일</span><span class="w"> </span><span class="nx">이름</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">├────────────┼────────────────┼──────────────────────────────────────┤</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">       </span><span class="err">│</span><span class="w">     </span><span class="mi">12</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="p">.</span><span class="w">                                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="mi">2</span><span class="w">       </span><span class="err">│</span><span class="w">     </span><span class="mi">12</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="p">..</span><span class="w">                                  </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mi">15</span><span class="w">       </span><span class="err">│</span><span class="w">     </span><span class="mi">16</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="nx">file1</span><span class="p">.</span><span class="nx">txt</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mi">23</span><span class="w">       </span><span class="err">│</span><span class="w">     </span><span class="mi">20</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="nx">documents</span><span class="w">                           </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="mi">45</span><span class="w">       </span><span class="err">│</span><span class="w">     </span><span class="mi">24</span><span class="w">         </span><span class="err">│</span><span class="w"> </span><span class="nx">long_filename</span><span class="p">.</span><span class="nx">doc</span><span class="w">                   </span><span class="err">│</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└────────────┴────────────────┴──────────────────────────────────────┘</span><span class="w"> </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="nx">ext4</span><span class="w"> </span><span class="nx">디렉토리</span><span class="w"> </span><span class="nx">엔트리</span><span class="w"> </span><span class="p">(</span><span class="nx">struct</span><span class="w"> </span><span class="nx">ext4_dir_entry_2</span><span class="p">):</span><span class="w">                       </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">┌─────────────────────────────────────────────────────────────────┐</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nx">inode</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="nx">바이트</span><span class="p">)</span><span class="w">           </span><span class="p">:</span><span class="w"> </span><span class="nx">inode</span><span class="w"> </span><span class="nx">번호</span><span class="w">                          </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nx">rec_len</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nx">바이트</span><span class="p">)</span><span class="w">         </span><span class="p">:</span><span class="w"> </span><span class="nx">이</span><span class="w"> </span><span class="nx">엔트리의</span><span class="w"> </span><span class="nx">총</span><span class="w"> </span><span class="nx">길이</span><span class="w">                  </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nx">name_len</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="nx">바이트</span><span class="p">)</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="nx">파일</span><span class="w"> </span><span class="nx">이름</span><span class="w"> </span><span class="nx">길이</span><span class="w">                       </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nx">file_type</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="nx">바이트</span><span class="p">)</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="nx">파일</span><span class="w"> </span><span class="nx">유형</span><span class="w"> </span><span class="p">(</span><span class="nx">파일</span><span class="o">/</span><span class="nx">디렉토리</span><span class="o">/</span><span class="nx">링크</span><span class="w"> </span><span class="nx">등</span><span class="p">)</span><span class="w">    </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="p">(</span><span class="nx">가변</span><span class="p">)</span><span class="w">               </span><span class="p">:</span><span class="w"> </span><span class="nx">파일</span><span class="w"> </span><span class="nx">이름</span><span class="w">                            </span><span class="err">│</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">   </span><span class="err">└─────────────────────────────────────────────────────────────────┘</span><span class="w">   </span><span class="err">│</span>
<span class="err">│</span><span class="w">                                                                          </span><span class="err">│</span>
<span class="err">└─────────────────────────────────────────────────────────────────────────┘</span>
</code></pre></div>

<h3 id="42">4.2 해시 테이블 디렉토리<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                     해시 테이블 디렉토리                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   파일 이름 → 해시 함수 → 버킷 인덱스                                   │
│                                                                          │
│   해시 테이블                                                            │
│   ┌─────────┐                                                           │
│   │    0    │ → [readme.txt, inode 15]                                 │
│   ├─────────┤                                                           │
│   │    1    │ → [config.json, inode 23] → [data.csv, inode 45]         │
│   ├─────────┤                                                           │
│   │    2    │ → (비어있음)                                              │
│   ├─────────┤                                                           │
│   │    3    │ → [main.c, inode 67] → [test.c, inode 89]                │
│   ├─────────┤                                                           │
│   │   ...   │                                                           │
│   └─────────┘                                                           │
│                                                                          │
│   장점:                                                                  │
│   - 검색 O(1) 평균 (선형 리스트는 O(n))                                │
│   - 대용량 디렉토리에서 효과적                                          │
│                                                                          │
│   ext4의 htree (HTree Index):                                           │
│   - B-tree 기반 해시 디렉토리                                           │
│   - 수천 개 파일도 빠르게 검색                                          │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="5">5. 파일 시스템 예시<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-fat32">5.1 FAT32<a class="header-link" href="#51-fat32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                          FAT32 구조                                      │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │ Reserved │   FAT   │  FAT    │       데이터 영역              │   │
│   │  영역    │   1     │   2     │  (클러스터들)                   │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                          │
│   특징:                                                                  │
│   - 클러스터 크기: 4KB ~ 32KB                                          │
│   - FAT 엔트리: 32비트 (28비트 사용)                                   │
│   - 최대 파일 크기: 4GB - 1 (32비트 크기 필드)                         │
│   - 최대 볼륨 크기: 2TB                                                 │
│                                                                          │
│   디렉토리 엔트리 (32바이트):                                           │
│   ┌───────────────────────────────────────────────────────────────┐     │
│   │ 파일명 (8바이트) + 확장자 (3바이트) = 8.3 형식               │     │
│   │ 속성 (1바이트): 읽기전용, 숨김, 시스템, 디렉토리 등          │     │
│   │ 생성/수정/접근 시간 (10바이트)                                │     │
│   │ 시작 클러스터 번호 (4바이트)                                  │     │
│   │ 파일 크기 (4바이트)                                           │     │
│   └───────────────────────────────────────────────────────────────┘     │
│                                                                          │
│   VFAT: 긴 파일 이름 지원 (별도 엔트리 사용)                           │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="52-ext4">5.2 ext4<a class="header-link" href="#52-ext4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                          ext4 주요 특징                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   1. Extents (익스텐트)                                                 │
│      연속된 블록을 하나의 엔트리로 표현 → 대용량 파일에 효율적          │
│      ┌──────────────────────────────────────────────┐                   │
│      │ 시작 블록: 1000, 길이: 500                   │                   │
│      │ → 블록 1000~1499를 한 번에 참조             │                   │
│      └──────────────────────────────────────────────┘                   │
│                                                                          │
│   2. 저널링 (Journaling)                                                │
│      - 메타데이터 저널: 기본 모드, 빠름                                 │
│      - 데이터 저널: 데이터까지 저널링, 안전                            │
│                                                                          │
│   3. 대용량 지원                                                        │
│      - 최대 파일 크기: 16TB                                             │
│      - 최대 볼륨 크기: 1EB (Exabyte)                                    │
│                                                                          │
│   4. 기타 기능                                                          │
│      - Delayed allocation: 쓰기 최적화                                  │
│      - Multi-block allocation: 여러 블록 한 번에 할당                   │
│      - 디렉토리 htree: 빠른 검색                                        │
│      - 온라인 조각 모음                                                 │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="6">6. 저널링<a class="header-link" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 저널링의 필요성<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                         저널링 개념                                      │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   문제: 파일 시스템 비일관성                                            │
│                                                                          │
│   파일 삭제 과정 (저널링 없이):                                         │
│   1. 디렉토리에서 엔트리 제거                                           │
│   2. inode를 자유 목록에 추가                    ← 여기서 크래시!       │
│   3. 데이터 블록을 자유 목록에 추가                                     │
│                                                                          │
│   크래시 후 문제:                                                        │
│   - 디렉토리에서 삭제됨                                                 │
│   - 하지만 inode와 블록은 여전히 &#39;사용 중&#39; 표시                         │
│   - 해당 공간 접근 불가 + 복구 불가                                     │
│                                                                          │
│   해결: 저널링                                                          │
│   변경 전에 로그(저널)에 기록 → 크래시 후 로그 기반 복구                │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="62">6.2 저널링 동작<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│<span class="w">                       </span>저널링<span class="w"> </span>동작<span class="w"> </span>방식<span class="w">                                   </span>│
├─────────────────────────────────────────────────────────────────────────┤
│<span class="w">                                                                          </span>│
│<span class="w">   </span>┌─────────────────────────────────────────────────────────────────┐<span class="w">   </span>│
│<span class="w">   </span>│<span class="w">                       </span>저널<span class="w"> </span>영역<span class="w">                                  </span>│<span class="w">   </span>│
│<span class="w">   </span>├─────────────────────────────────────────────────────────────────┤<span class="w">   </span>│
│<span class="w">   </span>│<span class="w"> </span><span class="nv">TxB</span><span class="w"> </span>│<span class="w"> </span>데이터블록<span class="w"> </span>│<span class="w"> </span>메타데이터<span class="w"> </span>│<span class="w"> </span><span class="nv">TxE</span><span class="w"> </span>│<span class="w"> </span><span class="nv">TxB</span><span class="w"> </span>│<span class="w"> </span>...<span class="w"> </span>│<span class="w"> </span><span class="nv">TxE</span><span class="w"> </span>│<span class="w"> </span>...<span class="w">    </span>│<span class="w">   </span>│
│<span class="w">   </span>└──┬──┴───────────┴────────────┴──┬──┘<span class="w">                            </span>│<span class="w">   </span>│
│<span class="w">      </span>│<span class="w">                              </span>│<span class="w">                                </span>│<span class="w">   </span>│
│<span class="w">      </span>│<span class="w">      </span><span class="nv">Transaction</span><span class="w"> </span><span class="mi">1</span><span class="w">           </span>│<span class="w">      </span><span class="nv">Transaction</span><span class="w"> </span><span class="mi">2</span><span class="w">             </span>│<span class="w">   </span>│
│<span class="w">      </span>│<span class="w">                              </span>│<span class="w">                                </span>│<span class="w">   </span>│
│<span class="w">   </span><span class="nv">TxB</span>:<span class="w"> </span><span class="nv">Transaction</span><span class="w"> </span><span class="nv">Begin</span><span class="w">                                              </span>│<span class="w">   </span>│
│<span class="w">   </span><span class="nv">TxE</span>:<span class="w"> </span><span class="nv">Transaction</span><span class="w"> </span><span class="k">End</span><span class="w"> </span><span class="ss">(</span><span class="nv">Commit</span><span class="ss">)</span><span class="w">                                       </span>│<span class="w">   </span>│
│<span class="w">                                                                          </span>│
│<span class="w">   </span>쓰기<span class="w"> </span>과정:<span class="w">                                                            </span>│
│<span class="w">   </span><span class="mi">1</span>.<span class="w"> </span><span class="nv">Transaction</span><span class="w"> </span><span class="nv">Begin</span><span class="w"> </span>기록<span class="w">                                             </span>│
│<span class="w">   </span><span class="mi">2</span>.<span class="w"> </span>변경할<span class="w"> </span>블록들을<span class="w"> </span>저널에<span class="w"> </span>기록<span class="w">                                        </span>│
│<span class="w">   </span><span class="mi">3</span>.<span class="w"> </span><span class="nv">Transaction</span><span class="w"> </span><span class="k">End</span><span class="w"> </span>기록<span class="w"> </span><span class="ss">(</span>커밋<span class="ss">)</span><span class="w">                                        </span>│
│<span class="w">   </span><span class="mi">4</span>.<span class="w"> </span>실제<span class="w"> </span>위치에<span class="w"> </span>데이터<span class="w"> </span>쓰기<span class="w"> </span><span class="ss">(</span><span class="nv">Checkpoint</span><span class="ss">)</span><span class="w">                               </span>│
│<span class="w">   </span><span class="mi">5</span>.<span class="w"> </span>저널에서<span class="w"> </span>해당<span class="w"> </span>트랜잭션<span class="w"> </span>제거<span class="w">                                        </span>│
│<span class="w">                                                                          </span>│
│<span class="w">   </span>복구<span class="w"> </span>과정<span class="w"> </span><span class="ss">(</span>부팅<span class="w"> </span>시<span class="ss">)</span>:<span class="w">                                                   </span>│
│<span class="w">   </span><span class="mi">1</span>.<span class="w"> </span>저널<span class="w"> </span>검사<span class="w">                                                          </span>│
│<span class="w">   </span><span class="mi">2</span>.<span class="w"> </span>완료된<span class="w"> </span>트랜잭션<span class="w"> </span><span class="ss">(</span><span class="nv">TxE</span><span class="w"> </span>있음<span class="ss">)</span>:<span class="w"> </span>실제<span class="w"> </span>위치에<span class="w"> </span>다시<span class="w"> </span>쓰기<span class="w">                 </span>│
│<span class="w">   </span><span class="mi">3</span>.<span class="w"> </span>미완료<span class="w"> </span>트랜잭션<span class="w"> </span><span class="ss">(</span><span class="nv">TxE</span><span class="w"> </span>없음<span class="ss">)</span>:<span class="w"> </span>무시<span class="w"> </span><span class="ss">(</span><span class="nv">rollback</span><span class="ss">)</span><span class="w">                       </span>│
│<span class="w">                                                                          </span>│
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="63">6.3 저널 모드<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                        ext4 저널 모드                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌───────────────┬──────────────────────────────────────────────────┐   │
│  │    모드       │                     설명                         │   │
│  ├───────────────┼──────────────────────────────────────────────────┤   │
│  │ journal       │ 데이터 + 메타데이터 모두 저널링                  │   │
│  │               │ 가장 안전하지만 가장 느림 (2배 쓰기)            │   │
│  ├───────────────┼──────────────────────────────────────────────────┤   │
│  │ ordered       │ 메타데이터만 저널링                              │   │
│  │ (기본값)      │ 데이터 먼저 쓰고 메타데이터 저널링              │   │
│  │               │ 데이터 일관성 보장, 적절한 성능                  │   │
│  ├───────────────┼──────────────────────────────────────────────────┤   │
│  │ writeback     │ 메타데이터만 저널링                              │   │
│  │               │ 데이터 쓰기 순서 보장 안 함                      │   │
│  │               │ 가장 빠르지만 크래시 시 데이터 손실 가능         │   │
│  └───────────────┴──────────────────────────────────────────────────┘   │
│                                                                          │
│   # 마운트 시 옵션 지정                                                 │
│   $ mount -o data=ordered /dev/sda1 /mnt                                │
│   $ mount -o data=journal /dev/sda1 /mnt                                │
│   $ mount -o data=writeback /dev/sda1 /mnt                              │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<hr />
<h2 id="7-raid">7. RAID<a class="header-link" href="#7-raid" title="Permanent link">&para;</a></h2>
<h3 id="71-raid">7.1 RAID 개요<a class="header-link" href="#71-raid" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                          RAID 개요                                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   RAID = Redundant Array of Independent Disks                           │
│                                                                          │
│   목표:                                                                  │
│   1. 성능 향상 (Striping - 데이터 분산)                                 │
│   2. 신뢰성 향상 (Mirroring/Parity - 중복 저장)                         │
│   3. 대용량 (여러 디스크 결합)                                          │
│                                                                          │
│   구현 방식:                                                             │
│   - 하드웨어 RAID: RAID 컨트롤러 카드                                   │
│   - 소프트웨어 RAID: OS에서 구현 (mdadm)                                │
│   - 하이브리드: 메인보드 내장 RAID                                      │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="72-raid">7.2 RAID 레벨<a class="header-link" href="#72-raid" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────┐
│                       RAID 0 (Striping)                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌───────────────────────────────────────────────────┐                 │
│   │               데이터: A B C D E F G H             │                 │
│   └───────────────────────────────────────────────────┘                 │
│                           │                                              │
│           ┌───────────────┼───────────────┐                             │
│           ▼               ▼               ▼                             │
│      ┌─────────┐     ┌─────────┐     ┌─────────┐                       │
│      │ 디스크0 │     │ 디스크1 │     │ 디스크2 │                       │
│      │  A D G  │     │  B E H  │     │  C F    │                       │
│      └─────────┘     └─────────┘     └─────────┘                       │
│                                                                          │
│   특징:                                                                  │
│   - 모든 디스크에 데이터 분산 (스트라이핑)                              │
│   - 읽기/쓰기 속도: n배 향상                                            │
│   - 용량: 디스크 수 × 단일 용량                                         │
│   - 중복 없음: 한 디스크 고장 → 전체 데이터 손실                       │
│   - 용도: 성능 중요, 데이터 손실 감수 가능한 경우                       │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                       RAID 1 (Mirroring)                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌───────────────────────────────────────────────────┐                 │
│   │               데이터: A B C D                      │                 │
│   └───────────────────────────────────────────────────┘                 │
│                           │                                              │
│           ┌───────────────┴───────────────┐                             │
│           ▼                               ▼                             │
│      ┌─────────┐                     ┌─────────┐                       │
│      │ 디스크0 │                     │ 디스크1 │                       │
│      │ A B C D │ ◀── 동일 ──▶      │ A B C D │                       │
│      │ (원본)  │                     │ (미러)  │                       │
│      └─────────┘                     └─────────┘                       │
│                                                                          │
│   특징:                                                                  │
│   - 완벽한 복제 (미러링)                                                │
│   - 읽기 속도: 2배 (두 디스크에서 병렬 읽기)                            │
│   - 쓰기 속도: 동일 (두 곳에 써야 함)                                   │
│   - 용량: 단일 디스크 용량 (50% 효율)                                   │
│   - 한 디스크 고장해도 데이터 보존                                      │
│   - 용도: 중요 데이터, 시스템 드라이브                                  │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                  RAID 5 (Striping with Parity)                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌─────────────┬─────────────┬─────────────┬─────────────┐             │
│   │  디스크 0   │  디스크 1   │  디스크 2   │  디스크 3   │             │
│   ├─────────────┼─────────────┼─────────────┼─────────────┤             │
│   │     A1      │     A2      │     A3      │   Ap (패리티)│            │
│   ├─────────────┼─────────────┼─────────────┼─────────────┤             │
│   │     B1      │     B2      │  Bp (패리티)│     B3      │             │
│   ├─────────────┼─────────────┼─────────────┼─────────────┤             │
│   │     C1      │  Cp (패리티)│     C2      │     C3      │             │
│   ├─────────────┼─────────────┼─────────────┼─────────────┤             │
│   │  Dp (패리티)│     D1      │     D2      │     D3      │             │
│   └─────────────┴─────────────┴─────────────┴─────────────┘             │
│                                                                          │
│   패리티 계산: Ap = A1 XOR A2 XOR A3                                    │
│   복구: A1 = Ap XOR A2 XOR A3 (A1 손실 시)                              │
│                                                                          │
│   특징:                                                                  │
│   - 패리티가 분산됨 (RAID 4는 전용 디스크)                              │
│   - 용량: (n-1) × 단일 용량                                             │
│   - 1개 디스크 고장 허용                                                │
│   - 읽기 속도 향상, 쓰기는 패리티 계산으로 약간 느림                    │
│   - 용도: 대부분의 서버                                                 │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                  RAID 6 (Dual Parity)                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌─────────────┬─────────────┬─────────────┬─────────────┐             │
│   │  디스크 0   │  디스크 1   │  디스크 2   │  디스크 3   │             │
│   ├─────────────┼─────────────┼─────────────┼─────────────┤             │
│   │     A1      │     A2      │   Ap (P)    │   Aq (Q)    │             │
│   ├─────────────┼─────────────┼─────────────┼─────────────┤             │
│   │     B1      │   Bp (P)    │   Bq (Q)    │     B2      │             │
│   └─────────────┴─────────────┴─────────────┴─────────────┘             │
│                                                                          │
│   특징:                                                                  │
│   - 2개의 패리티 (P, Q) - 다른 알고리즘                                 │
│   - 2개 디스크 동시 고장 허용                                           │
│   - 용량: (n-2) × 단일 용량                                             │
│   - 최소 4개 디스크 필요                                                │
│   - RAID 5보다 안전, 쓰기 성능은 더 낮음                                │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                     RAID 10 (1+0, Mirror + Stripe)                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│                          데이터: A B C D                                │
│                               │                                         │
│               ┌───────────────┴───────────────┐                        │
│               ▼                               ▼                        │
│        ┌─────────────┐                 ┌─────────────┐                │
│        │  스트라이프0 │                 │  스트라이프1 │                │
│        │     A C     │                 │     B D     │                │
│        └──────┬──────┘                 └──────┬──────┘                │
│               │                               │                        │
│        ┌──────┴──────┐                 ┌──────┴──────┐                │
│        ▼             ▼                 ▼             ▼                │
│   ┌─────────┐   ┌─────────┐       ┌─────────┐   ┌─────────┐          │
│   │ 디스크0 │   │ 디스크1 │       │ 디스크2 │   │ 디스크3 │          │
│   │   A C   │   │   A C   │       │   B D   │   │   B D   │          │
│   │ (원본)  │   │ (미러)  │       │ (원본)  │   │ (미러)  │          │
│   └─────────┘   └─────────┘       └─────────┘   └─────────┘          │
│                                                                          │
│   특징:                                                                  │
│   - RAID 1 (미러) + RAID 0 (스트라이프) 결합                           │
│   - 성능: RAID 0에 가까움                                               │
│   - 안정성: RAID 1에 가까움                                             │
│   - 용량: 50% 효율                                                      │
│   - 각 미러 쌍에서 1개씩 고장 허용 (최대 2개)                           │
│   - 용도: 고성능 + 고신뢰성 필요한 경우                                 │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>

<h3 id="73-raid">7.3 RAID 레벨 비교<a class="header-link" href="#73-raid" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>┌────────────────────────────────────────────────────────────────────────────────┐
│                           RAID 레벨 비교표                                      │
├──────────┬──────────┬──────────┬──────────┬──────────┬─────────────────────────┤
│  RAID    │ 최소     │ 용량     │ 읽기     │ 쓰기     │ 고장 허용               │
│  레벨    │ 디스크   │ 효율     │ 속도     │ 속도     │                         │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────────┤
│  RAID 0  │    2     │  100%    │  n배     │  n배     │ 0개 (위험)              │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────────┤
│  RAID 1  │    2     │  50%     │  2배     │  1배     │ 1개                     │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────────┤
│  RAID 5  │    3     │  (n-1)/n │  빠름    │  보통    │ 1개                     │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────────┤
│  RAID 6  │    4     │  (n-2)/n │  빠름    │  느림    │ 2개                     │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────────┤
│  RAID 10 │    4     │  50%     │  빠름    │  빠름    │ 각 쌍에서 1개          │
└──────────┴──────────┴──────────┴──────────┴──────────┴─────────────────────────┘
</code></pre></div>

<hr />
<h2 id="_4">연습 문제<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="1-inode">문제 1: inode 블록 포인터<a class="header-link" href="#1-inode" title="Permanent link">&para;</a></h3>
<p>4KB 블록, 4바이트 포인터를 사용하는 Unix 파일 시스템에서 100MB 파일을 저장하려면 몇 개의 간접 블록이 필요한가?</p>
<details>
<summary>정답 보기</summary>


<div class="highlight"><pre><span></span><code>블록 크기: 4KB = 4096 바이트
포인터/블록: 4096 / 4 = 1024개
파일 크기: 100MB = 102,400KB = 25,600 블록

직접 블록: 12개 → 12 블록 커버
단일 간접: 1024개 → 1024 블록 커버
이중 간접: 1024 × 1024 = 1,048,576 블록 커버

필요 블록: 25,600개

직접: 12개 사용
단일 간접: 1024개 사용 (간접 블록 1개)
남은 블록: 25,600 - 12 - 1024 = 24,564개

이중 간접:
- 1차 간접 블록 수: ceil(24564 / 1024) = 24개
- 2차 간접 블록: 1개

총 간접 블록:
- 단일 간접 블록: 1개
- 이중 간접 1차: 1개
- 이중 간접 2차: 24개
총: 26개
</code></pre></div>



</details>

<h3 id="2-fat">문제 2: FAT 체인<a class="header-link" href="#2-fat" title="Permanent link">&para;</a></h3>
<p>FAT 테이블이 다음과 같을 때 파일 A(시작: 3)의 클러스터 체인을 나열하시오.</p>
<table>
<thead>
<tr>
<th>클러스터</th>
<th>값</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>FREE</td>
</tr>
<tr>
<td>1</td>
<td>8</td>
</tr>
<tr>
<td>2</td>
<td>FREE</td>
</tr>
<tr>
<td>3</td>
<td>7</td>
</tr>
<tr>
<td>4</td>
<td>EOF</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>FREE</td>
</tr>
<tr>
<td>7</td>
<td>4</td>
</tr>
<tr>
<td>8</td>
<td>EOF</td>
</tr>
</tbody>
</table>
<details>
<summary>정답 보기</summary>


<div class="highlight"><pre><span></span><code>파일 A 시작: 클러스터 3

체인 추적:
3 → FAT[3]=7 → FAT[7]=4 → FAT[4]=EOF

파일 A의 클러스터 체인: 3 → 7 → 4 → EOF

파일 크기: 3개 클러스터

참고로 클러스터 5부터 시작하는 또 다른 파일:
5 → FAT[5]=1 → FAT[1]=8 → FAT[8]=EOF
체인: 5 → 1 → 8 → EOF
</code></pre></div>



</details>

<h3 id="3">문제 3: 저널링 복구<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>시스템 크래시 후 저널에 다음 상태가 있습니다. 복구 후 파일 시스템 상태는?</p>
<div class="highlight"><pre><span></span><code><span class="n">저널</span><span class="w"> </span><span class="nl">내용</span><span class="p">:</span>
<span class="o">[</span><span class="n">TxB_1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">Block 100: 데이터A</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">Block 101: 메타데이터A</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">TxE_1</span><span class="o">]</span>
<span class="o">[</span><span class="n">TxB_2</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">Block 200: 데이터B</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">Block 201: 메타데이터B</span><span class="o">]</span>
<span class="p">(</span><span class="n">TxE_2</span><span class="w"> </span><span class="n">없음</span><span class="p">)</span>
</code></pre></div>

<details>
<summary>정답 보기</summary>


<div class="highlight"><pre><span></span><code>복구 과정:

1. Transaction 1 검사:
   <span class="k">-</span> TxB_1과 TxE_1 모두 존재
   <span class="k">-</span> 완료된 트랜잭션
   <span class="k">-</span> Block 100, 101을 실제 위치에 다시 쓰기 (redo)

2. Transaction 2 검사:
   <span class="k">-</span> TxB_2만 있고 TxE_2 없음
   <span class="k">-</span> 미완료 트랜잭션
   <span class="k">-</span> 이 트랜잭션 무시 (undo)
   <span class="k">-</span> Block 200, 201의 변경 적용 안 함

결과:
<span class="k">-</span> Transaction 1의 변경사항: 적용됨 (파일 A의 변경 완료)
<span class="k">-</span> Transaction 2의 변경사항: 적용 안 됨 (파일 B 변경 없음)

파일 시스템은 Transaction 1까지만 완료된 일관된 상태
</code></pre></div>



</details>

<h3 id="4-raid">문제 4: RAID 용량 계산<a class="header-link" href="#4-raid" title="Permanent link">&para;</a></h3>
<p>각각 2TB 디스크 6개로 다음 RAID를 구성할 때 사용 가능한 용량은?</p>
<ol>
<li>RAID 0</li>
<li>RAID 1</li>
<li>RAID 5</li>
<li>RAID 6</li>
<li>RAID 10</li>
</ol>
<details>
<summary>정답 보기</summary>


<div class="highlight"><pre><span></span><code><span class="err">디스크</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span><span class="err">개</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="n">TB</span><span class="w"> </span><span class="err">총</span><span class="w"> </span><span class="err">용량</span>

<span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="n">RAID</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="n">TB</span><span class="w"> </span><span class="o">(</span><span class="mi">100</span><span class="o">%)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">모든</span><span class="w"> </span><span class="err">공간</span><span class="w"> </span><span class="err">사용</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">중복</span><span class="w"> </span><span class="err">없음</span>

<span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="n">RAID</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="n">TB</span><span class="w"> </span><span class="o">(</span><span class="err">미러링</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="err">쌍</span><span class="o">)</span>
<span class="w">   </span><span class="err">또는</span><span class="w"> </span><span class="err">단순</span><span class="w"> </span><span class="mi">2</span><span class="err">개</span><span class="w"> </span><span class="err">미러</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="err">개를</span><span class="w"> </span><span class="mi">3</span><span class="err">쌍으로</span><span class="w"> </span><span class="err">미러링</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">각</span><span class="w"> </span><span class="err">쌍</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">합계</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="n">TB</span><span class="w"> </span><span class="o">(</span><span class="mi">50</span><span class="o">%)</span>

<span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="n">RAID</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="mi">6</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="n">TB</span><span class="w"> </span><span class="o">(</span><span class="mi">83</span><span class="o">%)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">패리티에</span><span class="w"> </span><span class="mi">1</span><span class="err">개</span><span class="w"> </span><span class="err">디스크분</span><span class="w"> </span><span class="err">사용</span>

<span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="n">RAID</span><span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="o">)</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="n">TB</span><span class="w"> </span><span class="o">(</span><span class="mi">67</span><span class="o">%)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">패리티에</span><span class="w"> </span><span class="mi">2</span><span class="err">개</span><span class="w"> </span><span class="err">디스크분</span><span class="w"> </span><span class="err">사용</span>

<span class="mi">5</span><span class="o">.</span><span class="w"> </span><span class="n">RAID</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="n">TB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="n">TB</span><span class="w"> </span><span class="o">(</span><span class="mi">50</span><span class="o">%)</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="err">개</span><span class="w"> </span><span class="err">스트라이프</span><span class="o">,</span><span class="w"> </span><span class="err">각각</span><span class="w"> </span><span class="err">미러</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="err">또는</span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="err">디스크</span><span class="w"> </span><span class="err">수</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="o">)</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="err">단일</span><span class="w"> </span><span class="err">용량</span>
</code></pre></div>



</details>

<h3 id="5_1">문제 5: 파일 삭제 과정<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>Unix 파일 시스템에서 <code>/home/user/file.txt</code> 삭제 시 일어나는 과정을 inode와 블록 관점에서 설명하시오.</p>
<details>
<summary>정답 보기</summary>


<div class="highlight"><pre><span></span><code>삭제 명령: rm /home/user/file.txt

1. 경로 분석:
   <span class="k">-</span> /home 디렉토리의 inode 찾기
   <span class="k">-</span> /home/user 디렉토리의 inode 찾기
   <span class="k">-</span> file.txt의 inode 번호 찾기 (예: inode 12345)

2. 권한 확인:
   <span class="k">-</span> 디렉토리(/home/user)에 쓰기 권한 있는지 확인
   <span class="k">-</span> 파일이 쓰기 잠금 상태인지 확인

3. 디렉토리 엔트리 제거:
   <span class="k">-</span> /home/user 디렉토리 파일에서 &quot;file.txt&quot; 엔트리 삭제
   <span class="k">-</span> rec_len 조정하여 공간 병합

4. inode 링크 카운트 감소:
   <span class="k">-</span> inode 12345의 link_count--
   <span class="k">-</span> link_count &gt; 0이면 여기서 끝 (다른 링크 존재)

5. link_count == 0이고 열린 파일 없으면:
   <span class="k">-</span> inode 비트맵에서 12345 해제 (0으로 표시)
   <span class="k">-</span> inode의 데이터 블록 포인터 확인
   <span class="k">-</span> 모든 데이터 블록을 블록 비트맵에서 해제
   <span class="k">-</span> 간접 블록도 해제

6. 슈퍼블록 업데이트:
   <span class="k">-</span> 자유 inode 수 증가
   <span class="k">-</span> 자유 블록 수 증가

주의: 실제 데이터는 지우지 않음
<span class="k">-</span> 블록이 &#39;사용 가능&#39;으로 표시될 뿐
<span class="k">-</span> 새 데이터로 덮어쓰기 전까지 복구 가능
</code></pre></div>



</details>

<hr />
<h2 id="_5">다음 단계<a class="header-link" href="#_5" title="Permanent link">&para;</a></h2>
<p><a href="./18_IO와_IPC.md">18_IO와_IPC.md</a>에서 I/O 시스템과 프로세스 간 통신을 배워봅시다!</p>
<hr />
<h2 id="_6">참고 자료<a class="header-link" href="#_6" title="Permanent link">&para;</a></h2>
<ul>
<li>Silberschatz, "Operating System Concepts" Chapters 14-15</li>
<li>Linux kernel source: <code>fs/ext4/</code>, <code>fs/fat/</code></li>
<li>ext4 documentation: https://www.kernel.org/doc/html/latest/filesystems/ext4/</li>
<li>RAID fundamentals: https://en.wikipedia.org/wiki/RAID</li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/OS_Theory/16_File_System_Basics.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">파일 시스템 기초 ⭐⭐⭐</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/OS_Theory/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/OS_Theory/18_IO_and_IPC.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">I/O와 IPC ⭐⭐⭐</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}