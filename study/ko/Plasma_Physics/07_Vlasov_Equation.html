{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7. Vlasov ë°©ì •ì‹ - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Plasma_Physics/">Plasma Physics</a>
    <span class="separator">/</span>
    <span class="current">7. Vlasov ë°©ì •ì‹</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>7. Vlasov ë°©ì •ì‹</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Plasma_Physics/06_Magnetic_Mirrors_Adiabatic_Invariants.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">6. ìê¸° ê±°ìš¸ê³¼ ë‹¨ì—´ ë¶ˆë³€ëŸ‰</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Plasma_Physics/08_Landau_Damping.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">8. Landau ê°ì‡ </span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">í•™ìŠµ ëª©í‘œ</a></li>
<li><a href="#1">1. ìœ„ìƒ ê³µê°„ê³¼ ë¶„í¬ í•¨ìˆ˜</a><ul>
<li><a href="#11">1.1 ìœ„ìƒ ê³µê°„</a></li>
<li><a href="#12">1.2 ë¶„í¬ í•¨ìˆ˜</a></li>
<li><a href="#13">1.3 ê·œê²©í™”</a></li>
<li><a href="#14">1.4 ëª¨ë©˜íŠ¸: ê±°ì‹œì  ë¬¼ë¦¬ëŸ‰</a></li>
<li><a href="#15-1d">1.5 ì˜ˆì œ: 1D ì†ë„ ë¶„í¬</a></li>
</ul>
</li>
<li><a href="#2-vlasov">2. Vlasov ë°©ì •ì‹</a><ul>
<li><a href="#21-liouville">2.1 Liouville ì •ë¦¬ë¡œë¶€í„°ì˜ ìœ ë„</a></li>
<li><a href="#22">2.2 ë¬¼ë¦¬ì  í•´ì„</a></li>
<li><a href="#23-vlasov-maxwell">2.3 ìê¸° ì¼ê´€ì„±: Vlasov-Maxwell ì‹œìŠ¤í…œ</a></li>
<li><a href="#24">2.4 ë‹¤ì¢… í”Œë¼ì¦ˆë§ˆ</a></li>
</ul>
</li>
<li><a href="#3">3. ë³´ì¡´ ë²•ì¹™</a><ul>
<li><a href="#31">3.1 ì…ì ë³´ì¡´</a></li>
<li><a href="#32">3.2 ìš´ë™ëŸ‰ ë³´ì¡´</a></li>
<li><a href="#33">3.3 ì—ë„ˆì§€ ë³´ì¡´</a></li>
<li><a href="#34-casimir">3.4 ì—”íŠ¸ë¡œí”¼ì™€ Casimir ë¶ˆë³€ëŸ‰</a></li>
</ul>
</li>
<li><a href="#4">4. í‰í˜• ë¶„í¬ í•¨ìˆ˜</a><ul>
<li><a href="#41-maxwellian">4.1 Maxwellian ë¶„í¬</a></li>
<li><a href="#42-jeans">4.2 Jeans ì •ë¦¬</a></li>
<li><a href="#43-bi-maxwellian">4.3 Bi-Maxwellian ë¶„í¬</a></li>
<li><a href="#44-kappa">4.4 Kappa ë¶„í¬</a></li>
<li><a href="#45-maxwellian">4.5 ë“œë¦¬í”„íŠ¸ Maxwellian (ë¹”)</a></li>
</ul>
</li>
<li><a href="#5">5. ì„ í˜•í™” ë° ì„­ë™ ì´ë¡ </a><ul>
<li><a href="#51">5.1 í‰í˜• + ì„­ë™</a></li>
<li><a href="#52-vlasov">5.2 ì„ í˜•í™”ëœ Vlasov ë°©ì •ì‹</a></li>
<li><a href="#53-bgk">5.3 BGK ëª¨ë“œ</a></li>
</ul>
</li>
<li><a href="#6-python">6. Python êµ¬í˜„</a><ul>
<li><a href="#61">6.1 ë¶„í¬ í•¨ìˆ˜ í”Œë¡œíŒ…</a></li>
<li><a href="#62">6.2 ëª¨ë©˜íŠ¸ ê³„ì‚°</a></li>
<li><a href="#63-1d-vlasov">6.3 ê°„ë‹¨í•œ 1D Vlasov ì†”ë²„ (ì—°ì‚°ì ë¶„ë¦¬)</a></li>
</ul>
</li>
<li><a href="#_2">ìš”ì•½</a></li>
<li><a href="#_3">ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-maxwellian">ë¬¸ì œ 1: ë“œë¦¬í”„íŠ¸ Maxwellianì˜ ëª¨ë©˜íŠ¸</a></li>
<li><a href="#2-bi-maxwellian">ë¬¸ì œ 2: Bi-Maxwellian ë¹„ë“±ë°©ì„±</a></li>
<li><a href="#3-kappa-maxwellian">ë¬¸ì œ 3: Kappa ë¶„í¬ ëŒ€ Maxwellian</a></li>
<li><a href="#4_1">ë¬¸ì œ 4: ì—”íŠ¸ë¡œí”¼ ë³´ì¡´</a></li>
<li><a href="#5-langmuir-vlasov-poisson">ë¬¸ì œ 5: Langmuir íŒŒë™ì— ëŒ€í•œ ì„ í˜•í™”ëœ Vlasov-Poisson</a></li>
</ul>
</li>
<li><a href="#_4">ë‚´ë¹„ê²Œì´ì…˜</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="7-vlasov">7. Vlasov ë°©ì •ì‹<a class="header-link" href="#7-vlasov" title="Permanent link">&para;</a></h1>
<h2 id="_1">í•™ìŠµ ëª©í‘œ<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>ìœ„ìƒ ê³µê°„ê³¼ ë¶„í¬ í•¨ìˆ˜ $f(\mathbf{x},\mathbf{v},t)$ ì´í•´í•˜ê¸°</li>
<li>ë¬´ì¶©ëŒ í”Œë¼ì¦ˆë§ˆì— ëŒ€í•œ Liouville ì •ë¦¬ë¡œë¶€í„° Vlasov ë°©ì •ì‹ ìœ ë„í•˜ê¸°</li>
<li>$f$ì˜ ëª¨ë©˜íŠ¸ë¡œë¶€í„° ê±°ì‹œì  ë¬¼ë¦¬ëŸ‰(ë°€ë„, í‰ê·  ì†ë„, ì••ë ¥) ê³„ì‚°í•˜ê¸°</li>
<li>í‰í˜• ë¶„í¬ í•¨ìˆ˜(Maxwellian, bi-Maxwellian, kappa) íƒêµ¬í•˜ê¸°</li>
<li>Vlasov ë°©ì •ì‹ìœ¼ë¡œë¶€í„° ë³´ì¡´ ë²•ì¹™(ì…ì, ìš´ë™ëŸ‰, ì—ë„ˆì§€, ì—”íŠ¸ë¡œí”¼) ë¶„ì„í•˜ê¸°</li>
<li>Pythonì„ ì‚¬ìš©í•˜ì—¬ Vlasov ë°©ì •ì‹ì˜ ìˆ˜ì¹˜ í•´ êµ¬í˜„í•˜ê¸°</li>
</ul>
<h2 id="1">1. ìœ„ìƒ ê³µê°„ê³¼ ë¶„í¬ í•¨ìˆ˜<a class="header-link" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ìœ„ìƒ ê³µê°„<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>ë‹¨ì¼ ì…ìì˜ ê²½ìš°, <strong>ìœ„ìƒ ê³µê°„</strong>ì€ ìœ„ì¹˜ì™€ ì†ë„ì˜ 6ì°¨ì› ê³µê°„ì…ë‹ˆë‹¤:</p>
<p>$$
(\mathbf{x}, \mathbf{v}) = (x, y, z, v_x, v_y, v_z)
$$</p>
<p>$N$ê°œ ì…ìì˜ ê²½ìš°, ì „ì²´ ìœ„ìƒ ê³µê°„ì€ $6N$ì°¨ì›ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ í° $N$ (í”Œë¼ì¦ˆë§ˆëŠ” $\sim 10^{20}$ê°œì˜ ì…ìë¥¼ ê°€ì§‘ë‹ˆë‹¤!)ì— ëŒ€í•´, ê°œë³„ ì…ìë¥¼ ì¶”ì í•˜ëŠ” ê²ƒì€ ë¹„ì‹¤ìš©ì ì…ë‹ˆë‹¤.</p>
<p>ëŒ€ì‹ , ìš°ë¦¬ëŠ” <strong>ë¶„í¬ í•¨ìˆ˜</strong>ë¥¼ í†µí•œ í†µê³„ì  ê¸°ìˆ ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<h3 id="12">1.2 ë¶„í¬ í•¨ìˆ˜<a class="header-link" href="#12" title="Permanent link">&para;</a></h3>
<p>ë¶„í¬ í•¨ìˆ˜ $f(\mathbf{x}, \mathbf{v}, t)$ëŠ” ìœ„ìƒ ê³µê°„ì—ì„œ <strong>ì…ìì˜ ìˆ˜ë°€ë„</strong>ë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
<p>$$
dN = f(\mathbf{x}, \mathbf{v}, t) \, d^3x \, d^3v
$$</p>
<p><strong>í•´ì„</strong>: $f\,d^3x\,d^3v$ëŠ” ì‹œê°„ $t$ì— $\mathbf{x}$ ì£¼ìœ„ì˜ ë¯¸ì†Œ ë¶€í”¼ $d^3x$ ì•ˆì—ì„œ $\mathbf{v}$ ì£¼ìœ„ì˜ ì†ë„ $d^3v$ë¥¼ ê°€ì§„ ì…ìì˜ ìˆ˜ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>    Phase space (6D)

    v_z â†‘
        |       â€¢ particle
        |     /
        |    /  represented by
        |   /   density f(x,v,t)
        |  /
        | /________________â†’ v_x
       /
      / v_y
     â†“

    Position space x,y,z (3D)
</code></pre></div>

<h3 id="13">1.3 ê·œê²©í™”<a class="header-link" href="#13" title="Permanent link">&para;</a></h3>
<p>ë¶€í”¼ $V$ ë‚´ì˜ ì „ì²´ ì…ì ìˆ˜ëŠ”:</p>
<p>$$
N(t) = \int_V d^3x \int_{-\infty}^{\infty} f(\mathbf{x}, \mathbf{v}, t) \, d^3v
$$</p>
<p>ì „ì²´ í”Œë¼ì¦ˆë§ˆì˜ ê²½ìš°:</p>
<p>$$
N_{\text{total}} = \int_{\text{all space}} d^3x \int_{-\infty}^{\infty} f(\mathbf{x}, \mathbf{v}, t) \, d^3v
$$</p>
<h3 id="14">1.4 ëª¨ë©˜íŠ¸: ê±°ì‹œì  ë¬¼ë¦¬ëŸ‰<a class="header-link" href="#14" title="Permanent link">&para;</a></h3>
<p>ê±°ì‹œì  ë¬¼ë¦¬ëŸ‰ì€ ì†ë„ ê³µê°„ì— ëŒ€í•´ $f$ë¥¼ ì ë¶„í•˜ì—¬ ì–»ìŠµë‹ˆë‹¤ (<strong>ëª¨ë©˜íŠ¸</strong>):</p>
<p><strong>ìˆ˜ë°€ë„</strong>:
$$
n(\mathbf{x}, t) = \int f(\mathbf{x}, \mathbf{v}, t) \, d^3v
$$</p>
<p><strong>í‰ê· (ìœ ì²´) ì†ë„</strong>:
$$
\mathbf{u}(\mathbf{x}, t) = \frac{1}{n(\mathbf{x}, t)} \int \mathbf{v} f(\mathbf{x}, \mathbf{v}, t) \, d^3v
$$</p>
<p><strong>ì••ë ¥ í…ì„œ</strong>:
$$
\mathbf{P}(\mathbf{x}, t) = m \int (\mathbf{v} - \mathbf{u})(\mathbf{v} - \mathbf{u}) f(\mathbf{x}, \mathbf{v}, t) \, d^3v
$$</p>
<p>ì—¬ê¸°ì„œ ì™¸ì  $(\mathbf{v} - \mathbf{u})(\mathbf{v} - \mathbf{u})$ëŠ” í…ì„œë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<p><strong>ìŠ¤ì¹¼ë¼ ì••ë ¥</strong> (ë“±ë°©ì„± ë¶„í¬ì˜ ê²½ìš°):
$$
P = \frac{1}{3}\text{Tr}(\mathbf{P}) = \frac{m}{3}\int |\mathbf{v} - \mathbf{u}|^2 f \, d^3v
$$</p>
<p><strong>ì˜¨ë„</strong> (ìš´ë™í•™ì  ì •ì˜):
$$
T = \frac{P}{nk_B} = \frac{m}{3nk_B}\int |\mathbf{v} - \mathbf{u}|^2 f \, d^3v
$$</p>
<p><strong>ì—ë„ˆì§€ ë°€ë„</strong>:
$$
\mathcal{E} = \frac{m}{2}\int v^2 f \, d^3v = \frac{1}{2}m n u^2 + \frac{3}{2}nk_BT
$$</p>
<p>(ìš´ë™ ì—ë„ˆì§€ = í‰ê·  íë¦„ + ì—´ ì—ë„ˆì§€)</p>
<h3 id="15-1d">1.5 ì˜ˆì œ: 1D ì†ë„ ë¶„í¬<a class="header-link" href="#15-1d" title="Permanent link">&para;</a></h3>
<p>$f = f(v_x)$ê°€ Gaussianì¸ 1D ë¬¸ì œë¥¼ ê³ ë ¤í•©ë‹ˆë‹¤:</p>
<p>$$
f(v_x) = n_0 \sqrt{\frac{m}{2\pi k_B T}} \exp\left(-\frac{m(v_x - u)^2}{2k_BT}\right)
$$</p>
<p>ëª¨ë©˜íŠ¸:
- $\int f \, dv_x = n_0$ (ë°€ë„)
- $\int v_x f \, dv_x = n_0 u$ (ìš´ë™ëŸ‰ ë°€ë„)
- $\int (v_x - u)^2 f \, dv_x = n_0 k_BT/m$ (ë¶„ì‚°)</p>
<h2 id="2-vlasov">2. Vlasov ë°©ì •ì‹<a class="header-link" href="#2-vlasov" title="Permanent link">&para;</a></h2>
<h3 id="21-liouville">2.1 Liouville ì •ë¦¬ë¡œë¶€í„°ì˜ ìœ ë„<a class="header-link" href="#21-liouville" title="Permanent link">&para;</a></h3>
<p>ê³ ì „ ì—­í•™ì—ì„œ, <strong>Liouville ì •ë¦¬</strong>ëŠ” ìœ„ìƒ ê³µê°„ ë°€ë„ê°€ ê¶¤ì ì„ ë”°ë¼ ë³´ì¡´ë¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤:</p>
<p>$$
\frac{df}{dt} = 0
$$</p>
<p>ì „ë¯¸ë¶„ì„ ì „ê°œí•˜ë©´:</p>
<p>$$
\frac{\partial f}{\partial t} + \frac{d\mathbf{x}}{dt}\cdot\frac{\partial f}{\partial \mathbf{x}} + \frac{d\mathbf{v}}{dt}\cdot\frac{\partial f}{\partial \mathbf{v}} = 0
$$</p>
<p>ì „í•˜ ì…ìì˜ ê²½ìš°:
- $\frac{d\mathbf{x}}{dt} = \mathbf{v}$
- $\frac{d\mathbf{v}}{dt} = \frac{q}{m}(\mathbf{E} + \mathbf{v}\times\mathbf{B})$</p>
<p>ëŒ€ì…í•˜ë©´:</p>
<p>$$
\boxed{\frac{\partial f}{\partial t} + \mathbf{v}\cdot\nabla f + \frac{q}{m}(\mathbf{E} + \mathbf{v}\times\mathbf{B})\cdot\frac{\partial f}{\partial \mathbf{v}} = 0}
$$</p>
<p>ì´ê²ƒì´ <strong>Vlasov ë°©ì •ì‹</strong>ì…ë‹ˆë‹¤ (<strong>ë¬´ì¶©ëŒ Boltzmann ë°©ì •ì‹</strong>ì´ë¼ê³ ë„ í•¨).</p>
<h3 id="22">2.2 ë¬¼ë¦¬ì  í•´ì„<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>Vlasov ë°©ì •ì‹ì€ ë¶„í¬ í•¨ìˆ˜ê°€ ì…ì ê¶¤ì ì— ì˜í•´ ìœ„ìƒ ê³µê°„ì„ í†µí•´ <strong>ëŒ€ë¥˜</strong>ë˜ë©°, (ë¬´ì¶©ëŒ í”Œë¼ì¦ˆë§ˆì— ëŒ€í•´) ì†ŒìŠ¤ë‚˜ ì‹±í¬ê°€ ì—†ìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>    Phase space flow

       f(x,v,t)   â†’   f(x+vÎ´t, v+aÎ´t, t+Î´t)

    Particles flow along trajectories in (x,v) space
    Distribution function is &quot;painted&quot; on phase space
    and advected by the flow
</code></pre></div>

<p>ê° í•­:
- $\frac{\partial f}{\partial t}$: ëª…ì‹œì  ì‹œê°„ ì˜ì¡´ì„±
- $\mathbf{v}\cdot\nabla f$: ìœ„ì¹˜ ê³µê°„ì—ì„œì˜ ì´ë¥˜
- $\frac{q}{m}(\mathbf{E}+\mathbf{v}\times\mathbf{B})\cdot\frac{\partial f}{\partial \mathbf{v}}$: ì†ë„ ê³µê°„ì—ì„œì˜ ê°€ì†</p>
<h3 id="23-vlasov-maxwell">2.3 ìê¸° ì¼ê´€ì„±: Vlasov-Maxwell ì‹œìŠ¤í…œ<a class="header-link" href="#23-vlasov-maxwell" title="Permanent link">&para;</a></h3>
<p>ì „ê¸°ì¥ê³¼ ìê¸°ì¥ $\mathbf{E}$ì™€ $\mathbf{B}$ëŠ” í”Œë¼ì¦ˆë§ˆ ìì²´ì— ì˜í•´ ìƒì„±ë©ë‹ˆë‹¤. ì´ë“¤ì€ <strong>Maxwell ë°©ì •ì‹</strong>ì„ ë§Œì¡±í•´ì•¼ í•©ë‹ˆë‹¤:</p>
<p>$$
\nabla\cdot\mathbf{E} = \frac{\rho}{\epsilon_0} = \frac{1}{\epsilon_0}\sum_s q_s \int f_s \, d^3v
$$</p>
<p>$$
\nabla\times\mathbf{E} = -\frac{\partial\mathbf{B}}{\partial t}
$$</p>
<p>$$
\nabla\cdot\mathbf{B} = 0
$$</p>
<p>$$
\nabla\times\mathbf{B} = \mu_0\mathbf{J} + \mu_0\epsilon_0\frac{\partial\mathbf{E}}{\partial t} = \mu_0\sum_s q_s\int\mathbf{v}f_s\,d^3v + \mu_0\epsilon_0\frac{\partial\mathbf{E}}{\partial t}
$$</p>
<p>ê²°í•©ëœ ì‹œìŠ¤í…œ (Vlasov + Maxwell)ì€ <strong>Vlasov-Maxwell ì‹œìŠ¤í…œ</strong>ì´ë©°, í”Œë¼ì¦ˆë§ˆì˜ ìê¸° ì¼ê´€ì  ìš´ë™í•™ì  ê¸°ìˆ ì…ë‹ˆë‹¤.</p>
<p>ì •ì „ê¸° ë¬¸ì œì˜ ê²½ìš° ($\mathbf{B}$ ë³€í™” ì—†ìŒ), <strong>Vlasov-Poisson ì‹œìŠ¤í…œ</strong>ì„ ê°–ìŠµë‹ˆë‹¤:</p>
<p>$$
\frac{\partial f}{\partial t} + \mathbf{v}\cdot\nabla f + \frac{q}{m}\mathbf{E}\cdot\frac{\partial f}{\partial \mathbf{v}} = 0
$$</p>
<p>$$
\nabla\cdot\mathbf{E} = \frac{1}{\epsilon_0}\sum_s q_s \int f_s \, d^3v
$$</p>
<h3 id="24">2.4 ë‹¤ì¢… í”Œë¼ì¦ˆë§ˆ<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<p>ì—¬ëŸ¬ ì¢…(ì „ì, ì´ì˜¨, ë¶ˆìˆœë¬¼)ì„ ê°€ì§„ í”Œë¼ì¦ˆë§ˆì˜ ê²½ìš°, ê° ì¢… $s$ì— ëŒ€í•´ ë³„ë„ì˜ ë¶„í¬ í•¨ìˆ˜ $f_s$ë¥¼ ê°–ìŠµë‹ˆë‹¤:</p>
<p>$$
\frac{\partial f_s}{\partial t} + \mathbf{v}\cdot\nabla f_s + \frac{q_s}{m_s}(\mathbf{E} + \mathbf{v}\times\mathbf{B})\cdot\frac{\partial f_s}{\partial \mathbf{v}} = 0
$$</p>
<p>$\mathbf{E}$ì™€ $\mathbf{B}$ëŠ” ëª¨ë“  ì¢…ì— ëŒ€í•œ í•©ìœ¼ë¡œ ê²°ì •ë©ë‹ˆë‹¤.</p>
<h2 id="3">3. ë³´ì¡´ ë²•ì¹™<a class="header-link" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ì…ì ë³´ì¡´<a class="header-link" href="#31" title="Permanent link">&para;</a></h3>
<p>Vlasov ë°©ì •ì‹ì„ ëª¨ë“  ì†ë„ì— ëŒ€í•´ ì ë¶„í•©ë‹ˆë‹¤:</p>
<p>$$
\int \frac{\partial f}{\partial t} d^3v + \int \mathbf{v}\cdot\nabla f \, d^3v + \int \frac{q}{m}(\mathbf{E}+\mathbf{v}\times\mathbf{B})\cdot\frac{\partial f}{\partial \mathbf{v}} d^3v = 0
$$</p>
<p>ì²« ë²ˆì§¸ í•­:
$$
\int \frac{\partial f}{\partial t} d^3v = \frac{\partial}{\partial t}\int f \, d^3v = \frac{\partial n}{\partial t}
$$</p>
<p>ë‘ ë²ˆì§¸ í•­:
$$
\int \mathbf{v}\cdot\nabla f \, d^3v = \nabla\cdot\int \mathbf{v}f \, d^3v = \nabla\cdot(n\mathbf{u})
$$</p>
<p>ì„¸ ë²ˆì§¸ í•­ (ë¶€ë¶„ ì ë¶„, $f\to 0$ë¥¼ $|\mathbf{v}|\to\infty$ì¼ ë•Œ ê°€ì •):
$$
\int \frac{q}{m}\mathbf{F}\cdot\frac{\partial f}{\partial \mathbf{v}} d^3v = -\frac{q}{m}\int f\nabla_v\cdot\mathbf{F} \, d^3v = 0
$$</p>
<p>ì™œëƒí•˜ë©´ $\nabla_v\cdot(\mathbf{E}+\mathbf{v}\times\mathbf{B}) = \nabla_v\cdot\mathbf{E} + \nabla_v\cdot(\mathbf{v}\times\mathbf{B}) = 0$ (EëŠ” vì™€ ë…ë¦½ì ì´ê³ , ì™¸ì ì€ ì†ë„ ê³µê°„ì—ì„œ ë°œì‚°ì´ 0).</p>
<p>ê²°ê³¼:
$$
\boxed{\frac{\partial n}{\partial t} + \nabla\cdot(n\mathbf{u}) = 0}
$$</p>
<p><strong>ì—°ì† ë°©ì •ì‹</strong>: ì…ì ìˆ˜ê°€ ë³´ì¡´ë©ë‹ˆë‹¤.</p>
<h3 id="32">3.2 ìš´ë™ëŸ‰ ë³´ì¡´<a class="header-link" href="#32" title="Permanent link">&para;</a></h3>
<p>Vlasov ë°©ì •ì‹ì— $m\mathbf{v}$ë¥¼ ê³±í•˜ê³  ì ë¶„í•©ë‹ˆë‹¤:</p>
<p>$$
\int m\mathbf{v}\frac{\partial f}{\partial t} d^3v + \int m\mathbf{v}(\mathbf{v}\cdot\nabla f) d^3v + \int q\mathbf{v}(\mathbf{E}+\mathbf{v}\times\mathbf{B})\cdot\frac{\partial f}{\partial\mathbf{v}} d^3v = 0
$$</p>
<p>ì•½ê°„ì˜ ëŒ€ìˆ˜ì  ê³„ì‚° í›„ (ë¶€ë¶„ ì ë¶„ ë“±):</p>
<p>$$
\frac{\partial}{\partial t}(mn\mathbf{u}) + \nabla\cdot\mathbf{P} = qn(\mathbf{E} + \mathbf{u}\times\mathbf{B})
$$</p>
<p>ì—¬ê¸°ì„œ $\mathbf{P}$ëŠ” ìš´ë™ëŸ‰ í”ŒëŸ­ìŠ¤ í…ì„œì…ë‹ˆë‹¤ (ì••ë ¥ê³¼ íë¦„ì„ í¬í•¨).</p>
<p><strong>ìš´ë™ëŸ‰ ë°©ì •ì‹</strong>: ìš´ë™ëŸ‰ì€ ì „ìê¸°ë ¥ìœ¼ë¡œ ì¸í•´ ë³€í™”í•©ë‹ˆë‹¤.</p>
<h3 id="33">3.3 ì—ë„ˆì§€ ë³´ì¡´<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<p>$\frac{1}{2}mv^2$ë¥¼ ê³±í•˜ê³  ì ë¶„í•©ë‹ˆë‹¤:</p>
<p>$$
\frac{\partial}{\partial t}\left(\frac{1}{2}mn\langle v^2\rangle\right) + \nabla\cdot\mathbf{Q} = qn\mathbf{u}\cdot\mathbf{E}
$$</p>
<p>ì—¬ê¸°ì„œ $\mathbf{Q}$ëŠ” ì—ë„ˆì§€ í”ŒëŸ­ìŠ¤ì…ë‹ˆë‹¤.</p>
<p><strong>ì—ë„ˆì§€ ë°©ì •ì‹</strong>: ìš´ë™ ì—ë„ˆì§€ëŠ” ì „ê¸°ì¥ì— ì˜í•´ ìˆ˜í–‰ëœ ì¼ë¡œ ì¸í•´ ë³€í™”í•©ë‹ˆë‹¤.</p>
<p>(ìê¸°ì¥ì€ ì¼ì„ í•˜ì§€ ì•ŠìŒ: $\mathbf{v}\times\mathbf{B}\perp\mathbf{v}$)</p>
<h3 id="34-casimir">3.4 ì—”íŠ¸ë¡œí”¼ì™€ Casimir ë¶ˆë³€ëŸ‰<a class="header-link" href="#34-casimir" title="Permanent link">&para;</a></h3>
<p><strong>ì—”íŠ¸ë¡œí”¼</strong>ë¥¼ ì •ì˜í•©ë‹ˆë‹¤:</p>
<p>$$
S = -k_B \int f \ln f \, d^3x \, d^3v
$$</p>
<p>Vlasov ë°©ì •ì‹ìœ¼ë¡œë¶€í„°, ìš°ë¦¬ëŠ” ë‹¤ìŒì„ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p>$$
\frac{dS}{dt} = 0
$$</p>
<p><strong>ì—”íŠ¸ë¡œí”¼ëŠ” ë¬´ì¶©ëŒ í”Œë¼ì¦ˆë§ˆì—ì„œ ë³´ì¡´ë©ë‹ˆë‹¤</strong> (ê°€ì—­ì  ë™ì—­í•™). ì´ê²ƒì€ ì—”íŠ¸ë¡œí”¼ê°€ ì¦ê°€í•˜ëŠ” ì¶©ëŒ ì‹œìŠ¤í…œ (H-ì •ë¦¬)ê³¼ ë§¤ìš° ë‹¤ë¦…ë‹ˆë‹¤.</p>
<p>ë” ì¼ë°˜ì ìœ¼ë¡œ, ë‹¤ìŒ í˜•íƒœì˜ ëª¨ë“  ë²”í•¨ìˆ˜:</p>
<p>$$
C = \int G(f) \, d^3x \, d^3v
$$</p>
<p>ì—¬ê¸°ì„œ $G$ëŠ” ì„ì˜ì˜ í•¨ìˆ˜ì´ë©°, $f$ê°€ Vlasov ë°©ì •ì‹ì„ ë§Œì¡±í•˜ë©´ ë³´ì¡´ë©ë‹ˆë‹¤. ì´ë¥¼ <strong>Casimir ë¶ˆë³€ëŸ‰</strong>ì´ë¼ê³  í•©ë‹ˆë‹¤.</p>
<h2 id="4">4. í‰í˜• ë¶„í¬ í•¨ìˆ˜<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-maxwellian">4.1 Maxwellian ë¶„í¬<a class="header-link" href="#41-maxwellian" title="Permanent link">&para;</a></h3>
<p>ê°€ì¥ ì¼ë°˜ì ì¸ í‰í˜•ì€ <strong>Maxwellian</strong>ì…ë‹ˆë‹¤ (ì—´í‰í˜•):</p>
<p>$$
\boxed{f_0(\mathbf{v}) = n_0 \left(\frac{m}{2\pi k_B T}\right)^{3/2} \exp\left(-\frac{m|\mathbf{v} - \mathbf{u}|^2}{2k_BT}\right)}
$$</p>
<p>ì—¬ê¸°ì„œ:
- $n_0$: í‰í˜• ë°€ë„
- $\mathbf{u}$: í‰ê·  ë“œë¦¬í”„íŠ¸ ì†ë„
- $T$: ì˜¨ë„</p>
<p><strong>ì„±ì§ˆ</strong>:
- $\mathbf{u}$ë¡œ ì›€ì§ì´ëŠ” í”„ë ˆì„ì—ì„œ ë“±ë°©ì„±
- ì£¼ì–´ì§„ ë°€ë„ì™€ ì—ë„ˆì§€ì— ëŒ€í•´ ì—”íŠ¸ë¡œí”¼ ìµœëŒ€í™”
- $\mathbf{E} = \mathbf{B} = 0$ (ë˜ëŠ” ê· ì¼í•œ $\mathbf{u} = \mathbf{E}\times\mathbf{B}/B^2$)ì¸ ê²½ìš° Vlasov ë°©ì •ì‹ì˜ ì •ìƒ í•´</p>
<h3 id="42-jeans">4.2 Jeans ì •ë¦¬<a class="header-link" href="#42-jeans" title="Permanent link">&para;</a></h3>
<p><strong>Jeans ì •ë¦¬</strong>: ìš´ë™ ìƒìˆ˜ì˜ ì„ì˜ì˜ í•¨ìˆ˜ëŠ” Vlasov ë°©ì •ì‹ì˜ ì •ìƒ í•´ì…ë‹ˆë‹¤.</p>
<p>ì¥ $\mathbf{E}$, $\mathbf{B}$ì—ì„œ ì…ìì— ëŒ€í•´, ì—ë„ˆì§€ $H = \frac{1}{2}mv^2 + q\Phi$ê°€ ë³´ì¡´ë˜ë©´:</p>
<p>$$
f = f(H)
$$</p>
<p>ëŠ” ì •ìƒ í•´ì…ë‹ˆë‹¤.</p>
<p>ë” ì¼ë°˜ì ìœ¼ë¡œ:
$$
f = f(H, \mathbf{P}_{\text{canonical}}, \mu, J, \Phi, \ldots)
$$</p>
<p>ì—¬ê¸°ì„œ ì¸ìˆ˜ëŠ” ì„ì˜ì˜ ìš´ë™ ìƒìˆ˜ì…ë‹ˆë‹¤ (ì—ë„ˆì§€, ì •ì¤€ ìš´ë™ëŸ‰, ë‹¨ì—´ ë¶ˆë³€ëŸ‰ ë“±).</p>
<h3 id="43-bi-maxwellian">4.3 Bi-Maxwellian ë¶„í¬<a class="header-link" href="#43-bi-maxwellian" title="Permanent link">&para;</a></h3>
<p>ìí™”ëœ í”Œë¼ì¦ˆë§ˆì—ì„œ, ë¹„ë“±ë°©ì„±ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ì¸ ëª¨ë¸ì€ <strong>bi-Maxwellian</strong>ì…ë‹ˆë‹¤:</p>
<p>$$
\boxed{f_0(v_\perp, v_\parallel) = n_0 \frac{m}{2\pi k_B} \frac{1}{T_\perp}\frac{1}{\sqrt{2\pi k_B T_\parallel/m}} \exp\left(-\frac{mv_\perp^2}{2k_BT_\perp} - \frac{m v_\parallel^2}{2k_BT_\parallel}\right)}
$$</p>
<p>ì—¬ê¸°ì„œ $T_\perp$ì™€ $T_\parallel$ëŠ” $\mathbf{B}$ì— ìˆ˜ì§ ë° í‰í–‰í•œ ì˜¨ë„ì…ë‹ˆë‹¤.</p>
<p><strong>ë¹„ë“±ë°©ì„± ë§¤ê°œë³€ìˆ˜</strong>:
$$
A = \frac{T_\perp}{T_\parallel} - 1
$$</p>
<ul>
<li>$A > 0$: ìˆ˜ì§ ê°€ì—´ (ì˜ˆ: ì‚¬ì´í´ë¡œíŠ¸ë¡  ê³µëª… ê°€ì—´)</li>
<li>$A < 0$: í‰í–‰ ê°€ì—´ (ì˜ˆ: ìê¸° ì••ì¶•)</li>
</ul>
<p>Bi-Maxwellian ë¶„í¬ëŠ” ë¶ˆì•ˆì •ì„±ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ì˜ˆ: $A > 0$ì— ëŒ€í•œ ì „ìê¸° ì´ì˜¨ ì‚¬ì´í´ë¡œíŠ¸ë¡  íŒŒë™).</p>
<h3 id="44-kappa">4.4 Kappa ë¶„í¬<a class="header-link" href="#44-kappa" title="Permanent link">&para;</a></h3>
<p>ìš°ì£¼ í”Œë¼ì¦ˆë§ˆ (íƒœì–‘í’, ìê¸°ê¶Œ)ì—ì„œ, ê´€ì¸¡ì€ <strong>ë¹„ì—´ì  ê¼¬ë¦¬</strong>ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤ â€” Maxwellianì´ ì˜ˆì¸¡í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ë§ì€ ê³ ì—ë„ˆì§€ ì…ì. ì¼ë°˜ì ì¸ ëª¨ë¸ì€ <strong>kappa ë¶„í¬</strong>ì…ë‹ˆë‹¤:</p>
<p>$$
\boxed{f_\kappa(v) = n_0 \frac{1}{(\pi\kappa\theta^2)^{3/2}} \frac{\Gamma(\kappa+1)}{\Gamma(\kappa-1/2)} \left(1 + \frac{v^2}{\kappa\theta^2}\right)^{-(\kappa+1)}}
$$</p>
<p>ì—¬ê¸°ì„œ:
- $\kappa > 3/2$: ìŠ¤í™íŠ¸ëŸ¼ ì§€ìˆ˜ (ë‚®ì€ $\kappa$ = ë” ëš±ëš±í•œ ê¼¬ë¦¬)
- $\theta^2 = \frac{2k_BT}{m}\frac{\kappa - 3/2}{\kappa}$: ì—´ì†ë„ ë§¤ê°œë³€ìˆ˜
- $\Gamma$: ê°ë§ˆ í•¨ìˆ˜</p>
<p><strong>ê·¹í•œ</strong>:
- $\kappa \to \infty$: Maxwellianìœ¼ë¡œ íšŒë³µ
- $\kappa \to 3/2$: ë©±ë²•ì¹™ ê¼¬ë¦¬ $f \propto v^{-2(\kappa+1)} = v^{-5}$</p>
<p>Kappa ë¶„í¬ëŠ” ë‹¤ìŒìœ¼ë¡œë¶€í„° ë°œìƒí•©ë‹ˆë‹¤:
- ê°„í—ì  ì…ì ê°€ì†
- ë¬´ì¶©ëŒ "ì¤€í‰í˜•" ì™„í™”
- ë‚œë¥˜ ê°€ì—´</p>
<h3 id="45-maxwellian">4.5 ë“œë¦¬í”„íŠ¸ Maxwellian (ë¹”)<a class="header-link" href="#45-maxwellian" title="Permanent link">&para;</a></h3>
<p>ë¹”ì´ ìˆëŠ” í”Œë¼ì¦ˆë§ˆëŠ” ë‘ ê°œì˜ ì§‘ë‹¨ì„ ê°–ìŠµë‹ˆë‹¤:</p>
<p>$$
f = f_{\text{bulk}} + f_{\text{beam}}
$$</p>
<p>ì˜ˆë¥¼ ë“¤ì–´:
$$
f(v) = n_b\left(\frac{m}{2\pi k_B T_b}\right)^{3/2}\exp\left(-\frac{m(v - v_b)^2}{2k_BT_b}\right) + n_c\left(\frac{m}{2\pi k_B T_c}\right)^{3/2}\exp\left(-\frac{mv^2}{2k_BT_c}\right)
$$</p>
<p>ì—¬ê¸°ì„œ ì•„ë˜ì²¨ì $b$ = ë¹”, $c$ = ì½”ì–´.</p>
<p><strong>Bump-on-tail</strong> (1D ë²„ì „):</p>
<div class="highlight"><pre><span></span><code>    f(v)
      â†‘
      |    Core
      |   /â€¾â€¾â€¾\
      |  /     \___
      | /          \___   Beam (bump)
      |/               \__/â€¾â€¾\_______
     â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ v
                               v_b

    Positive slope df/dv &gt; 0 at resonance
    â†’ Unstable (two-stream instability)
</code></pre></div>

<p>ì´ê²ƒì€ ë¶ˆì•ˆì •ì„± (two-stream, bump-on-tail)ì„ ìœ ë°œí•˜ì—¬, ë¹”ì—ì„œ íŒŒë™ìœ¼ë¡œ ì—ë„ˆì§€ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.</p>
<h2 id="5">5. ì„ í˜•í™” ë° ì„­ë™ ì´ë¡ <a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 í‰í˜• + ì„­ë™<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p>ì‘ì€ ì§„í­ íŒŒë™ì˜ ê²½ìš°, ë¶„í•´í•©ë‹ˆë‹¤:</p>
<p>$$
f = f_0(\mathbf{v}) + f_1(\mathbf{x}, \mathbf{v}, t)
$$</p>
<p>$$
\mathbf{E} = \mathbf{E}_0 + \mathbf{E}_1(\mathbf{x}, t)
$$</p>
<p>ì—¬ê¸°ì„œ ì•„ë˜ì²¨ì $0$ = í‰í˜•, $1$ = ì„­ë™ì´ë©° $|f_1| \ll f_0$.</p>
<h3 id="52-vlasov">5.2 ì„ í˜•í™”ëœ Vlasov ë°©ì •ì‹<a class="header-link" href="#52-vlasov" title="Permanent link">&para;</a></h3>
<p>Vlasovì— ëŒ€ì…í•˜ê³  1ì°¨ í•­ë§Œ ìœ ì§€í•©ë‹ˆë‹¤:</p>
<p>$$
\frac{\partial f_1}{\partial t} + \mathbf{v}\cdot\nabla f_1 + \frac{q}{m}(\mathbf{E}_0 + \mathbf{v}\times\mathbf{B}_0)\cdot\frac{\partial f_1}{\partial\mathbf{v}} = -\frac{q}{m}\mathbf{E}_1\cdot\frac{\partial f_0}{\partial\mathbf{v}}
$$</p>
<p>ì„ í˜•í™”ëœ Poissonê³¼ ê²°í•©:</p>
<p>$$
\nabla\cdot\mathbf{E}_1 = \frac{1}{\epsilon_0}\sum_s q_s \int f_1^{(s)} \, d^3v
$$</p>
<p>ì´ê²ƒì€ í”Œë¼ì¦ˆë§ˆ íŒŒë™ê³¼ ë¶ˆì•ˆì •ì„±ì˜ <strong>ì„ í˜• ìš´ë™í•™ ì´ë¡ </strong>ì˜ ê¸°ì´ˆì…ë‹ˆë‹¤ (Landau ê°ì‡ ì— ëŒ€í•´ Lesson 8ì—ì„œ ì´ê²ƒì„ í’€ ê²ƒì…ë‹ˆë‹¤).</p>
<h3 id="53-bgk">5.3 BGK ëª¨ë“œ<a class="header-link" href="#53-bgk" title="Permanent link">&para;</a></h3>
<p><strong>BGK (Bernstein-Greene-Kruskal) ëª¨ë“œ</strong>ëŠ” Vlasov-Poisson ì‹œìŠ¤í…œì˜ ì •í™•í•œ ë¹„ì„ í˜• í•´ì´ë©°, ê°‡íŒ ì…ìë¥¼ ê°€ì§„ ì •ì „ê¸° íŒŒë™ íŒ¨í‚·ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
<p>1Dì˜ ê²½ìš°:
$$
f(x, v, t) = f(v - u(x))
$$</p>
<p>ì—¬ê¸°ì„œ ì…ìëŠ” íŒŒë™ì˜ í¬í…ì…œ ìš°ë¬¼ì— ê°‡í˜€ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì€ ìœ„ìƒ ì†ë„ $v_{\text{ph}}$ì™€ í¬íš í­ì— ì˜í•´ ê²°ì •ë˜ëŠ” ì§„í­ì„ ê°€ì§„ ì§„í–‰íŒŒ í•´ì…ë‹ˆë‹¤.</p>
<p>BGK ëª¨ë“œëŠ” ë‹¤ìŒ ì‚¬ì´ì˜ ê· í˜•ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤:
- ì…ì í¬íš (ë¹„ì„ í˜• íš¨ê³¼)
- íŒŒë™ ì „íŒŒ</p>
<p>ì´ë“¤ì€ ë‹¤ìŒê³¼ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤:
- ë¹„ì„ í˜• Landau ê°ì‡ 
- ì „ì ë° ì´ì˜¨ í™€
- ì´ì¤‘ì¸µ</p>
<h2 id="6-python">6. Python êµ¬í˜„<a class="header-link" href="#6-python" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ë¶„í¬ í•¨ìˆ˜ í”Œë¡œíŒ…<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span>

<span class="c1"># Constants</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.380649e-23</span>  <span class="c1"># J/K</span>
<span class="n">m_p</span> <span class="o">=</span> <span class="mf">1.67e-27</span>      <span class="c1"># kg</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.11e-31</span>      <span class="c1"># kg</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">1.6e-19</span>         <span class="c1"># C</span>

<span class="k">def</span><span class="w"> </span><span class="nf">maxwellian_1d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D Maxwellian distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">maxwellian_3d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    3D Maxwellian (isotropic, speed distribution)</span>
<span class="sd">    f(v) dv = 4Ï€ v^2 f(v_vec) dv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">m</span> <span class="o">*</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kappa_1d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1D kappa distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta_sq</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">kappa</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">kappa</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kappa</span> <span class="o">*</span> <span class="n">theta_sq</span><span class="p">))</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="n">kappa</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="n">kappa</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">norm</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">kappa</span> <span class="o">*</span> <span class="n">theta_sq</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">kappa</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bi_maxwellian_vperp</span><span class="p">(</span><span class="n">v_perp</span><span class="p">,</span> <span class="n">v_para</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">T_perp</span><span class="p">,</span> <span class="n">T_para</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bi-Maxwellian: f(v_perp, v_para)</span>
<span class="sd">    Here we fix v_para and plot vs v_perp</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_perp</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_para</span><span class="p">))</span> <span class="o">*</span> \
           <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">m</span> <span class="o">*</span> <span class="n">v_perp</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_perp</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="o">*</span> <span class="n">v_para</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_para</span><span class="p">))</span>

<span class="c1"># Parameters</span>
<span class="n">n0</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># m^-3</span>
<span class="n">T_eV</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># eV</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">T_eV</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">k_B</span>  <span class="c1"># Kelvin</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">m_p</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">5e5</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># m/s</span>

<span class="c1"># Plot 1D distributions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Maxwellian</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">f_max</span> <span class="o">=</span> <span class="n">maxwellian_1d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">f_max</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Maxwellian&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;v (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(v) (s/mâ´)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1D Maxwellian Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Drifting Maxwellian (beam)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">f_core</span> <span class="o">=</span> <span class="n">maxwellian_1d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n0</span><span class="o">*</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">f_beam</span> <span class="o">=</span> <span class="n">maxwellian_1d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n0</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">T</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">2e5</span><span class="p">)</span>
<span class="n">f_total</span> <span class="o">=</span> <span class="n">f_core</span> <span class="o">+</span> <span class="n">f_beam</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">f_core</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Core&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">f_beam</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Beam&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">f_total</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;v (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(v) (s/mâ´)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bump-on-Tail Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Kappa distribution comparison</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">kappa_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">kappa_val</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">kappa_values</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">kappa_val</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">f_kappa</span> <span class="o">=</span> <span class="n">kappa_1d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kappa_val</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Îº = </span><span class="si">{</span><span class="n">kappa_val</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">kappa_val</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="k">else</span> <span class="s1">&#39;Îº â†’ âˆ (Maxwellian)&#39;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">f_kappa</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;v (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(v) (s/mâ´)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kappa Distributions (Non-thermal Tails)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># 3D speed distribution</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">v_speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">f_3d</span> <span class="o">=</span> <span class="n">maxwellian_3d</span><span class="p">(</span><span class="n">v_speed</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">v_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_speed</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">f_3d</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">v_th</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
          <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;v_th = </span><span class="si">{</span><span class="n">v_th</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> km/s&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Speed v (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(v) (s/mâ´)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;3D Maxwellian Speed Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;distribution_functions.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved: distribution_functions.png&quot;</span><span class="p">)</span>

<span class="c1"># Bi-Maxwellian</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">v_perp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">T_perp_eV</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">T_para_eV</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">T_perp</span> <span class="o">=</span> <span class="n">T_perp_eV</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">k_B</span>
<span class="n">T_para</span> <span class="o">=</span> <span class="n">T_para_eV</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">k_B</span>

<span class="c1"># Different v_para slices</span>
<span class="n">v_para_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">,</span> <span class="mf">2e5</span><span class="p">,</span> <span class="mf">3e5</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">v_para</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v_para_values</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">f_bi</span> <span class="o">=</span> <span class="n">bi_maxwellian_vperp</span><span class="p">(</span><span class="n">v_perp_array</span><span class="p">,</span> <span class="n">v_para</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">T_perp</span><span class="p">,</span> <span class="n">T_para</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_perp_array</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">f_bi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;v_para = </span><span class="si">{</span><span class="n">v_para</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> km/s&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;v_perp (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(v_perp, v_para) (s/mâ´)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Bi-Maxwellian: T_perp = </span><span class="si">{</span><span class="n">T_perp_eV</span><span class="si">}</span><span class="s1"> eV, T_para = </span><span class="si">{</span><span class="n">T_para_eV</span><span class="si">}</span><span class="s1"> eV&#39;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;bi_maxwellian.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved: bi_maxwellian.png&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="62">6.2 ëª¨ë©˜íŠ¸ ê³„ì‚°<a class="header-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">simps</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_moments</span><span class="p">(</span><span class="n">v_array</span><span class="p">,</span> <span class="n">f_array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute moments of 1D distribution function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Density</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">f_array</span><span class="p">,</span> <span class="n">v_array</span><span class="p">)</span>

    <span class="c1"># Mean velocity</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">v_array</span> <span class="o">*</span> <span class="n">f_array</span><span class="p">,</span> <span class="n">v_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>

    <span class="c1"># Variance (temperature measure)</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">simps</span><span class="p">((</span><span class="n">v_array</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f_array</span><span class="p">,</span> <span class="n">v_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>

    <span class="c1"># Thermal velocity</span>
    <span class="n">v_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v_th</span><span class="p">,</span> <span class="n">var</span>

<span class="c1"># Test with Maxwellian</span>
<span class="n">v_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">n_test</span> <span class="o">=</span> <span class="mf">1e19</span>
<span class="n">T_test</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">k_B</span>
<span class="n">u_test</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># drifting</span>

<span class="n">f_test</span> <span class="o">=</span> <span class="n">maxwellian_1d</span><span class="p">(</span><span class="n">v_test</span><span class="p">,</span> <span class="n">n_test</span><span class="p">,</span> <span class="n">T_test</span><span class="p">,</span> <span class="n">m_p</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">u_test</span><span class="p">)</span>

<span class="n">n_calc</span><span class="p">,</span> <span class="n">u_calc</span><span class="p">,</span> <span class="n">v_th_calc</span><span class="p">,</span> <span class="n">var_calc</span> <span class="o">=</span> <span class="n">compute_moments</span><span class="p">(</span><span class="n">v_test</span><span class="p">,</span> <span class="n">f_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Moment Calculation ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  n = </span><span class="si">{</span><span class="n">n_test</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m^-3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  u = </span><span class="si">{</span><span class="n">u_test</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  T = </span><span class="si">{</span><span class="n">T_test</span><span class="o">*</span><span class="n">k_B</span><span class="o">/</span><span class="n">e</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  v_th (expected) = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k_B</span><span class="o">*</span><span class="n">T_test</span><span class="o">/</span><span class="n">m_p</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Calculated from distribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  n = </span><span class="si">{</span><span class="n">n_calc</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m^-3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  u = </span><span class="si">{</span><span class="n">u_calc</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  v_th = </span><span class="si">{</span><span class="n">v_th_calc</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  T = </span><span class="si">{</span><span class="n">m_p</span><span class="o">*</span><span class="n">var_calc</span><span class="o">/</span><span class="n">k_B</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> K = </span><span class="si">{</span><span class="n">m_p</span><span class="o">*</span><span class="n">var_calc</span><span class="o">/</span><span class="n">e</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="n">errors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">n_calc</span> <span class="o">-</span> <span class="n">n_test</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_test</span><span class="p">,</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">u_calc</span> <span class="o">-</span> <span class="n">u_test</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">u_test</span><span class="p">),</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">v_th_calc</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k_B</span><span class="o">*</span><span class="n">T_test</span><span class="o">/</span><span class="n">m_p</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k_B</span><span class="o">*</span><span class="n">T_test</span><span class="o">/</span><span class="n">m_p</span><span class="p">)</span>
<span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Relative errors: </span><span class="si">{</span><span class="n">errors</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="63-1d-vlasov">6.3 ê°„ë‹¨í•œ 1D Vlasov ì†”ë²„ (ì—°ì‚°ì ë¶„ë¦¬)<a class="header-link" href="#63-1d-vlasov" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vlasov_1d_solver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">E_func</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple 1D Vlasov solver using operator splitting</span>

<span class="sd">    x: position grid</span>
<span class="sd">    v: velocity grid</span>
<span class="sd">    f0: initial distribution f(x,v,t=0)</span>
<span class="sd">    E_func: function E(x,t) giving electric field</span>
<span class="sd">    dt: timestep</span>
<span class="sd">    num_steps: number of steps</span>
<span class="sd">    q, m: charge and mass</span>

<span class="sd">    Returns: f(x,v,t) at final time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Nx</span><span class="p">,</span> <span class="n">Nv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># Storage for snapshots</span>
    <span class="n">snapshots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">snapshot_times</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="c1"># Step 1: Advection in x (âˆ‚f/âˆ‚t + v âˆ‚f/âˆ‚x = 0)</span>
        <span class="c1"># Use upwind scheme</span>
        <span class="n">f_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nv</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">i_up</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Nx</span>  <span class="c1"># periodic BC</span>
                    <span class="n">f_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="n">i_up</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">i_up</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Nx</span>
                    <span class="n">f_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i_up</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">f_new</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Step 2: Acceleration in v (âˆ‚f/âˆ‚t + (q/m)E âˆ‚f/âˆ‚v = 0)</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">E_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">f_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">q</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">m</span>  <span class="c1"># acceleration</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nv</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">j_up</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">f_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dv</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_up</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">j_up</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Nv</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">f_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dv</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_up</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">f_new</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Save snapshots</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_steps</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="n">snapshot_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">snapshots</span><span class="p">,</span> <span class="n">snapshot_times</span>

<span class="c1"># Setup 1D problem</span>
<span class="n">Nx</span><span class="p">,</span> <span class="n">Nv</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span>
<span class="n">Lx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">0.5</span>  <span class="c1"># wavelength</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Nx</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3e5</span><span class="p">,</span> <span class="mf">3e5</span><span class="p">,</span> <span class="n">Nv</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>

<span class="c1"># Initial condition: perturbed Maxwellian</span>
<span class="n">n0</span> <span class="o">=</span> <span class="mf">1e19</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="n">k_B</span>
<span class="n">k_wave</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># wavenumber (1/m)</span>
<span class="n">amplitude</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">f0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Nv</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
    <span class="n">n_pert</span> <span class="o">=</span> <span class="n">n0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">k_wave</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">f0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">maxwellian_1d</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n_pert</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">m_e</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Electric field (for this demo, use a static wave)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">E_field</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="n">E0</span> <span class="o">=</span> <span class="mf">1e2</span>  <span class="c1"># V/m</span>
    <span class="k">return</span> <span class="n">E0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">k_wave</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">1e5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

<span class="c1"># Solve</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Solving 1D Vlasov equation...&quot;</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">1e-8</span>  <span class="c1"># s</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">f_final</span><span class="p">,</span> <span class="n">snapshots</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">vlasov_1d_solver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">E_field</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">,</span> <span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">m_e</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed </span><span class="si">{</span><span class="n">num_steps</span><span class="si">}</span><span class="s2"> steps, final time = </span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>

<span class="c1"># Plot phase space evolution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">snap</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">f0</span><span class="p">]</span> <span class="o">+</span> <span class="n">snapshots</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">times</span><span class="p">[:</span><span class="mi">5</span><span class="p">])):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">snap</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> s&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x,v)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;vlasov_1d_evolution.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved: vlasov_1d_evolution.png&quot;</span><span class="p">)</span>

<span class="c1"># Density evolution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">snap</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">f0</span><span class="p">]</span> <span class="o">+</span> <span class="n">snapshots</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">times</span><span class="p">[::</span><span class="mi">2</span><span class="p">])):</span>
    <span class="n">n_x</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">snap</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n_x</span><span class="o">/</span><span class="n">n0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1"> s&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n(x,t) / n0&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Density Oscillation (1D Vlasov)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;vlasov_density.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved: vlasov_density.png&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_2">ìš”ì•½<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>ì´ ìˆ˜ì—…ì—ì„œ, ìš°ë¦¬ëŠ” Vlasov ë°©ì •ì‹ì„ ì‚¬ìš©í•˜ì—¬ í”Œë¼ì¦ˆë§ˆì˜ ìš´ë™í•™ ì´ë¡ ì„ ê°œë°œí–ˆìŠµë‹ˆë‹¤:</p>
<ol>
<li>
<p><strong>ìœ„ìƒ ê³µê°„ê³¼ ë¶„í¬ í•¨ìˆ˜</strong>: $f(\mathbf{x}, \mathbf{v}, t)$ëŠ” 6D ìœ„ìƒ ê³µê°„ì—ì„œ í”Œë¼ì¦ˆë§ˆì˜ í†µê³„ì  ìƒíƒœë¥¼ ê¸°ìˆ í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>ëª¨ë©˜íŠ¸</strong>: ê±°ì‹œì  ë¬¼ë¦¬ëŸ‰ (ë°€ë„, ì†ë„, ì••ë ¥, ì˜¨ë„)ì€ ì†ë„ ê³µê°„ì— ëŒ€í•´ $f$ë¥¼ ì ë¶„í•˜ì—¬ ì–»ìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>Vlasov ë°©ì •ì‹</strong>:
   $$
   \frac{\partial f}{\partial t} + \mathbf{v}\cdot\nabla f + \frac{q}{m}(\mathbf{E}+\mathbf{v}\times\mathbf{B})\cdot\frac{\partial f}{\partial\mathbf{v}} = 0
   $$
   Liouville ì •ë¦¬ë¡œë¶€í„° ìœ ë„ëœ, $f$ì˜ ë¬´ì¶©ëŒ ì§„í™”ë¥¼ ê¸°ìˆ í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>ìê¸° ì¼ê´€ì„±</strong>: Maxwell ë°©ì •ì‹ê³¼ ê²°í•©ëœ Vlasov ë°©ì •ì‹ì€ Vlasov-Maxwell ì‹œìŠ¤í…œì„ í˜•ì„±í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>ë³´ì¡´ ë²•ì¹™</strong>: Vlasov ë°©ì •ì‹ì€ ì…ì, ìš´ë™ëŸ‰, ì—ë„ˆì§€, ì—”íŠ¸ë¡œí”¼ (Casimir ë¶ˆë³€ëŸ‰)ë¥¼ ë³´ì¡´í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>í‰í˜• ë¶„í¬</strong>:</p>
</li>
<li><strong>Maxwellian</strong>: ì—´í‰í˜•</li>
<li><strong>Bi-Maxwellian</strong>: ë¹„ë“±ë°©ì„± ìí™” í”Œë¼ì¦ˆë§ˆ</li>
<li><strong>Kappa</strong>: ë¹„ì—´ì  ê¼¬ë¦¬ (ìš°ì£¼ í”Œë¼ì¦ˆë§ˆ)</li>
<li>
<p><strong>ë¹”</strong>: bump-on-tail (ë¶ˆì•ˆì •)</p>
</li>
<li>
<p><strong>ì„ í˜•í™”</strong>: ì‘ì€ ì§„í­ íŒŒë™ì— ëŒ€í•œ ì„­ë™ ì´ë¡ ì€ ì„ í˜• ìš´ë™í•™ ì´ë¡ ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤ (ë‹¤ìŒ ìˆ˜ì—…: Landau ê°ì‡ ).</p>
</li>
</ol>
<p>Vlasov ë°©ì •ì‹ì€ ìš´ë™í•™ì  í”Œë¼ì¦ˆë§ˆ ë¬¼ë¦¬í•™ì˜ ê¸°ì´ˆì´ë©°, ìœ ì²´ ëª¨ë¸ì´ ë†“ì¹˜ëŠ” í˜„ìƒì„ í¬ì°©í•©ë‹ˆë‹¤:
- Landau ê°ì‡  (ë¬´ì¶©ëŒ íŒŒë™ ê°ì‡ )
- ìš´ë™í•™ì  ë¶ˆì•ˆì •ì„±
- íŒŒë™-ì…ì ê³µëª…</p>
<h2 id="_3">ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="1-maxwellian">ë¬¸ì œ 1: ë“œë¦¬í”„íŠ¸ Maxwellianì˜ ëª¨ë©˜íŠ¸<a class="header-link" href="#1-maxwellian" title="Permanent link">&para;</a></h3>
<p>1D Maxwellian ë¶„í¬ë¥¼ ê³ ë ¤í•©ë‹ˆë‹¤:</p>
<p>$$
f(v) = n_0\sqrt{\frac{m}{2\pi k_B T}}\exp\left(-\frac{m(v-u_0)^2}{2k_BT}\right)
$$</p>
<p>(a) 0ì°¨ ëª¨ë©˜íŠ¸ (ë°€ë„)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤: $n = \int f(v) \, dv$.</p>
<p>(b) 1ì°¨ ëª¨ë©˜íŠ¸ (í‰ê·  ì†ë„)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤: $\langle v\rangle = \frac{1}{n}\int v f(v) \, dv$.</p>
<p>(c) 2ì°¨ ëª¨ë©˜íŠ¸ (ì˜¨ë„)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤: $T = \frac{m}{k_B}\int (v - \langle v\rangle)^2 f(v) \, dv$.</p>
<p>(d) ì œê³µëœ Python ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ìˆ˜ì¹˜ì ìœ¼ë¡œ ê²€ì¦í•©ë‹ˆë‹¤.</p>
<hr />
<h3 id="2-bi-maxwellian">ë¬¸ì œ 2: Bi-Maxwellian ë¹„ë“±ë°©ì„±<a class="header-link" href="#2-bi-maxwellian" title="Permanent link">&para;</a></h3>
<p>ìí™”ëœ í”Œë¼ì¦ˆë§ˆê°€ $T_\perp = 200$ eV ë° $T_\parallel = 50$ eVì¸ bi-Maxwellian ë¶„í¬ë¥¼ ê°–ìŠµë‹ˆë‹¤.</p>
<p>(a) ë¹„ë“±ë°©ì„± ë§¤ê°œë³€ìˆ˜ $A = T_\perp/T_\parallel - 1$ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
<p>(b) $n = 10^{19}$ m$^{-3}$ì— ëŒ€í•´ ì••ë ¥ í…ì„œ ì„±ë¶„ $P_\perp = nk_BT_\perp$ ë° $P_\parallel = nk_BT_\parallel$ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
<p>(c) ì´ ë¶„í¬ëŠ” ë“±ë°©ì„±ì…ë‹ˆê¹Œ? ì•ˆì •í•©ë‹ˆê¹Œ? (íŒíŠ¸: í° $A > 0$ëŠ” ì‚¬ì´í´ë¡œíŠ¸ë¡  ë¶ˆì•ˆì •ì„±ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)</p>
<p>(d) ë¹„ë“±ë°©ì„±ì—ì„œ ì´ìš© ê°€ëŠ¥í•œ ììœ  ì—ë„ˆì§€ë¥¼ ì¶”ì •í•©ë‹ˆë‹¤: $\Delta W = \frac{3}{2}nk_B(T_\perp - T_\parallel)$.</p>
<hr />
<h3 id="3-kappa-maxwellian">ë¬¸ì œ 3: Kappa ë¶„í¬ ëŒ€ Maxwellian<a class="header-link" href="#3-kappa-maxwellian" title="Permanent link">&para;</a></h3>
<p>$\kappa = 3$ì¸ kappa ë¶„í¬ì— ëŒ€í•´, ë™ì¼í•œ ë°€ë„ì™€ ì˜¨ë„ë¥¼ ê°€ì§„ Maxwellianì— ë¹„í•´ $v > 3v_{\text{th}}$ì¸ ì…ì (ì´ˆì—´ ì…ì)ì˜ ìˆ˜ì˜ ë¹„ìœ¨ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
<p>(a) Maxwellianì˜ ê²½ìš°, $v > 3v_{\text{th}}$ì¸ ì…ìì˜ ë¹„ìœ¨ì€ ëŒ€ëµ $\exp(-9/2) \approx 0.011$ (1.1%)ì…ë‹ˆë‹¤. ì´ê²ƒì„ ìˆ˜ì¹˜ì ìœ¼ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
<p>(b) kappa ë¶„í¬ì˜ ê²½ìš°, ë‹¤ìŒì„ ì ë¶„í•˜ì—¬ ë™ì¼í•œ ë¹„ìœ¨ì„ ìˆ˜ì¹˜ì ìœ¼ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤:
   $$
   f_{\text{super}} = \frac{\int_{3v_{th}}^\infty f_\kappa(v) \, dv}{\int_0^\infty f_\kappa(v) \, dv}
   $$</p>
<p>(c) ì¦ê°• ê³„ìˆ˜ (kappa/Maxwellian)ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?</p>
<p>(d) íƒœì–‘í’ê³¼ ìê¸°ê¶Œì—ì„œ kappa ë¶„í¬ê°€ ê´€ì¸¡ë˜ëŠ” ì´ìœ ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
<hr />
<h3 id="4_1">ë¬¸ì œ 4: ì—”íŠ¸ë¡œí”¼ ë³´ì¡´<a class="header-link" href="#4_1" title="Permanent link">&para;</a></h3>
<p>ì—”íŠ¸ë¡œí”¼ $S = -k_B\int f\ln f \, d^3x\,d^3v$ê°€ Vlasov ë°©ì •ì‹ì— ì˜í•´ ë³´ì¡´ë¨ì„ ë¶„ì„ì ìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.</p>
<p>(a) $\frac{dS}{dt} = -k_B\int\frac{\partial}{\partial t}(f\ln f) \, d^3x\,d^3v$ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.</p>
<p>(b) $\frac{\partial}{\partial t}(f\ln f) = (1 + \ln f)\frac{\partial f}{\partial t}$ë¥¼ ì‚¬ìš©í•˜ê³  Vlasov ë°©ì •ì‹ì„ ëŒ€ì…í•©ë‹ˆë‹¤.</p>
<p>(c) ë¶€ë¶„ ì ë¶„í•˜ê³  Lorentz ê°€ì†ì— ëŒ€í•´ $\nabla_x\cdot\mathbf{v} = 0$ ë° $\nabla_v\cdot\mathbf{a} = 0$ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<p>(d) ëª¨ë“  í•­ì´ ì†Œë©¸í•˜ì—¬, $\frac{dS}{dt} = 0$ì„ì„ ë³´ì…ë‹ˆë‹¤.</p>
<hr />
<h3 id="5-langmuir-vlasov-poisson">ë¬¸ì œ 5: Langmuir íŒŒë™ì— ëŒ€í•œ ì„ í˜•í™”ëœ Vlasov-Poisson<a class="header-link" href="#5-langmuir-vlasov-poisson" title="Permanent link">&para;</a></h3>
<p>ìí™”ë˜ì§€ ì•Šì€ í”Œë¼ì¦ˆë§ˆì—ì„œ 1D ì •ì „ê¸° ì„­ë™ì„ ê³ ë ¤í•©ë‹ˆë‹¤:</p>
<p>$$
f = f_0(v) + f_1(x, v, t)
$$</p>
<p>$$
E = E_1(x, t)
$$</p>
<p>ì—¬ê¸°ì„œ $f_0$ëŠ” ì •ì§€ ìƒíƒœì˜ Maxwellianì…ë‹ˆë‹¤.</p>
<p>(a) $f_1$ì— ëŒ€í•œ ì„ í˜•í™”ëœ Vlasov ë°©ì •ì‹ì„ ì‘ì„±í•©ë‹ˆë‹¤.</p>
<p>(b) $f_1$ì˜ í•­ìœ¼ë¡œ $E_1$ì— ëŒ€í•œ ì„ í˜•í™”ëœ Poisson ë°©ì •ì‹ì„ ì‘ì„±í•©ë‹ˆë‹¤.</p>
<p>(c) í‰ë©´íŒŒ í•´ë¥¼ ê°€ì •í•©ë‹ˆë‹¤: $f_1 \propto e^{i(kx - \omega t)}$, $E_1 \propto e^{i(kx - \omega t)}$. ë¶„ì‚° ê´€ê³„ë¥¼ ìœ ë„í•©ë‹ˆë‹¤ (ì‹¤ìˆ˜ $\omega$ì— ëŒ€í•´ Bohm-Gross ê´€ê³„ë¥¼ ì–»ì–´ì•¼ í•©ë‹ˆë‹¤; Lesson 8ì—ì„œ Landau ê°ì‡ ë¥¼ ë‹¤ë£° ê²ƒì…ë‹ˆë‹¤).</p>
<p>(d) $k\lambda_D \ll 1$ì— ëŒ€í•´, $\omega^2 \approx \omega_{pe}^2(1 + 3k^2\lambda_D^2)$ì„ì„ ë³´ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ $\lambda_D = \sqrt{\epsilon_0 k_BT/(ne^2)}$.</p>
<p><strong>íŒíŠ¸</strong>: ì´ ë¬¸ì œëŠ” Lesson 8ì„ ë¯¸ë¦¬ ë³´ì—¬ì¤ë‹ˆë‹¤. ì™„ì „í•œ í•´ëŠ” $v = \omega/k$ì—ì„œ ê·¹ì ì„ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤ (Landau ì²˜ë°©).</p>
<hr />
<h2 id="_4">ë‚´ë¹„ê²Œì´ì…˜<a class="header-link" href="#_4" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>ì´ì „</strong>: <a href="./06_Magnetic_Mirrors_Adiabatic_Invariants.md">ìê¸° ê±°ìš¸ê³¼ ë‹¨ì—´ ë¶ˆë³€ëŸ‰</a></li>
<li><strong>ë‹¤ìŒ</strong>: <a href="./08_Landau_Damping.md">Landau ê°ì‡ </a></li>
</ul>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Plasma_Physics/06_Magnetic_Mirrors_Adiabatic_Invariants.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">6. ìê¸° ê±°ìš¸ê³¼ ë‹¨ì—´ ë¶ˆë³€ëŸ‰</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Plasma_Physics/08_Landau_Damping.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">8. Landau ê°ì‡ </span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}