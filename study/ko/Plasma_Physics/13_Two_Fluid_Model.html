{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13. Two-Fluid Model - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">🏠</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">💻</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        한국어
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">☀️</span>
                    <span class="theme-icon dark">🌙</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Plasma_Physics/">Plasma Physics</a>
    <span class="separator">/</span>
    <span class="current">13. Two-Fluid Model</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>13. Two-Fluid Model</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Plasma_Physics/12_Wave_Heating_and_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">12. 파동 가열과 불안정성</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Plasma_Physics/14_From_Kinetic_to_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">14. From Kinetic to MHD</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">학습 목표</a></li>
<li><a href="#1-vlasov">1. Vlasov 방정식에서 유체 방정식으로</a><ul>
<li><a href="#11">1.1 모멘트 계층</a></li>
<li><a href="#12-0">1.2 0차 모멘트: 연속 방정식</a></li>
<li><a href="#13-1">1.3 1차 모멘트: 운동량 방정식</a></li>
<li><a href="#14-2">1.4 2차 모멘트: 에너지 방정식</a></li>
<li><a href="#15">1.5 닫힘 문제</a></li>
<li><a href="#16">1.6 이유체 방정식 요약</a></li>
</ul>
</li>
<li><a href="#2-ohm">2. 일반화된 Ohm의 법칙</a><ul>
<li><a href="#21">2.1 전자 운동량 방정식에서 유도</a></li>
<li><a href="#22">2.2 각 항의 물리적 해석</a></li>
<li><a href="#23">2.3 스케일 분석: 각 항이 언제 중요한가?</a></li>
<li><a href="#24">2.4 제한 경우</a></li>
</ul>
</li>
<li><a href="#3-hall">3. Hall 효과</a><ul>
<li><a href="#31-hall">3.1 Hall 항의 물리</a></li>
<li><a href="#32-hall">3.2 Hall 매개변수</a></li>
<li><a href="#33">3.3 자기장으로부터 이온의 분리</a></li>
<li><a href="#34-hall-mhd">3.4 Hall MHD 파동</a></li>
</ul>
</li>
<li><a href="#4">4. 반자성 표류</a><ul>
<li><a href="#41-vs">4.1 입자 표류 vs. 유체 표류</a></li>
<li><a href="#42">4.2 반자성 표류 유도</a></li>
<li><a href="#43">4.3 반자성 전류</a></li>
<li><a href="#44">4.4 물리적 해석: 자화 전류</a></li>
<li><a href="#45">4.5 예: 원통형 플라즈마 기둥</a></li>
</ul>
</li>
<li><a href="#5">5. 이유체 파동</a><ul>
<li><a href="#51-kinetic-alfven">5.1 Kinetic Alfvén 파동</a></li>
<li><a href="#52-whistler">5.2 이유체 관점에서의 Whistler 파동</a></li>
<li><a href="#53-">5.3 이온-사이클로트론 파동</a></li>
<li><a href="#54">5.4 이류 불안정성</a></li>
</ul>
</li>
<li><a href="#6-python">6. Python 코드 예제</a><ul>
<li><a href="#61-vs">6.1 이유체 vs. 단일 유체 분산 관계</a></li>
<li><a href="#62-ohm">6.2 일반화된 Ohm의 법칙: 상대적 항 크기</a></li>
<li><a href="#63">6.3 반자성 표류 시각화</a></li>
<li><a href="#64">6.4 이유체 닫힘 비교</a></li>
</ul>
</li>
<li><a href="#_2">요약</a></li>
<li><a href="#_3">연습 문제</a><ul>
<li><a href="#1">문제 1: 모멘트 계산</a></li>
<li><a href="#2-hall-mhd">문제 2: Hall MHD 분산</a></li>
<li><a href="#3">문제 3: 토카막의 반자성 전류</a></li>
<li><a href="#4-ohm">문제 4: 전류 시트에서의 일반화된 Ohm의 법칙</a></li>
<li><a href="#5_1">문제 5: 이유체 불안정성</a></li>
</ul>
</li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="13-two-fluid-model">13. Two-Fluid Model<a class="header-link" href="#13-two-fluid-model" title="Permanent link">&para;</a></h1>
<h2 id="_1">학습 목표<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>Vlasov 방정식의 속도 공간 모멘트를 취하여 유체 방정식 유도하기</li>
<li>닫힘 문제(closure problem)와 다양한 닫힘 근사(등온, 단열, CGL) 이해하기</li>
<li>전자 운동량 방정식으로부터 일반화된 Ohm의 법칙 유도하고 각 항의 물리적 의미 분석하기</li>
<li>Hall 효과와 작은 스케일에서 이온과 자기장의 분리에서의 역할 설명하기</li>
<li>입자 표류와 유체 표류의 차이, 특히 반자성 표류 구별하기</li>
<li>단일 유체 MHD를 넘어서는 파동 현상을 이해하기 위해 이유체 이론 적용하기</li>
</ul>
<h2 id="1-vlasov">1. Vlasov 방정식에서 유체 방정식으로<a class="header-link" href="#1-vlasov" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 모멘트 계층<a class="header-link" href="#11" title="Permanent link">&para;</a></h3>
<p>Vlasov 방정식은 입자 종류 $s$에 대한 분포함수 $f_s(\mathbf{r}, \mathbf{v}, t)$의 진화를 기술합니다:</p>
<p>$$\frac{\partial f_s}{\partial t} + \mathbf{v} \cdot \nabla f_s + \frac{q_s}{m_s}(\mathbf{E} + \mathbf{v} \times \mathbf{B}) \cdot \frac{\partial f_s}{\partial \mathbf{v}} = \left(\frac{\partial f_s}{\partial t}\right)_{\text{coll}}$$</p>
<p>Vlasov 방정식은 플라즈마에 대한 완전한 정보를 포함하지만, 계산적으로 비용이 많이 드는 6차원 편미분 방정식입니다. 많은 응용에서는 전체 분포함수가 필요하지 않으며, 밀도, 유동 속도, 압력과 같은 거시적 양만 필요합니다.</p>
<p><strong>모멘트 방법</strong>은 Vlasov 방정식을 다른 가중치로 속도 공간에 대해 적분하여 차원을 줄입니다. $n$차 모멘트는 Vlasov 방정식에 $v^n$을 곱하고 적분하여 얻습니다:</p>
<p>$$\int (\text{Vlasov 방정식}) \times (\text{가중함수}) \, d^3v$$</p>
<p>이는 유체 방정식의 계층을 생성하며, 각 방정식은 다음 고차 모멘트를 포함합니다.</p>
<h3 id="12-0">1.2 0차 모멘트: 연속 방정식<a class="header-link" href="#12-0" title="Permanent link">&para;</a></h3>
<p>0차 모멘트(가중치 = 1)는 <strong>연속 방정식</strong>을 제공합니다:</p>
<p>$$\int \frac{\partial f_s}{\partial t} d^3v + \int \mathbf{v} \cdot \nabla f_s d^3v + \int \frac{q_s}{m_s}(\mathbf{E} + \mathbf{v} \times \mathbf{B}) \cdot \frac{\partial f_s}{\partial \mathbf{v}} d^3v = 0$$</p>
<p>수밀도는:
$$n_s(\mathbf{r}, t) = \int f_s(\mathbf{r}, \mathbf{v}, t) d^3v$$</p>
<p>첫 번째 항에 대해:
$$\int \frac{\partial f_s}{\partial t} d^3v = \frac{\partial}{\partial t} \int f_s d^3v = \frac{\partial n_s}{\partial t}$$</p>
<p>두 번째 항에 대해, 속도 공간에서 발산 정리를 사용하면:
$$\int \mathbf{v} \cdot \nabla f_s d^3v = \nabla \cdot \int \mathbf{v} f_s d^3v = \nabla \cdot (n_s \mathbf{u}_s)$$</p>
<p>여기서 평균 유동 속도는:
$$\mathbf{u}_s = \frac{1}{n_s} \int \mathbf{v} f_s d^3v$$</p>
<p>세 번째 항인 Lorentz 힘 항은 다음과 같이 소멸합니다:
$$\int \frac{\partial f_s}{\partial \mathbf{v}} d^3v = [f_s]_{v=-\infty}^{v=+\infty} = 0$$</p>
<p>($|\mathbf{v}| \to \infty$일 때 $f_s \to 0$를 가정).</p>
<p>결과는 <strong>연속 방정식</strong>입니다:</p>
<p>$$\boxed{\frac{\partial n_s}{\partial t} + \nabla \cdot (n_s \mathbf{u}_s) = 0}$$</p>
<p>이것은 입자 보존입니다. 이온화/재결합이 존재하면 우변에 소스 항이 나타납니다.</p>
<h3 id="13-1">1.3 1차 모멘트: 운동량 방정식<a class="header-link" href="#13-1" title="Permanent link">&para;</a></h3>
<p>1차 모멘트(가중치 = $m_s \mathbf{v}$)는 <strong>운동량 방정식</strong>을 제공합니다. Vlasov 방정식에 $m_s \mathbf{v}$를 곱하고 적분합니다:</p>
<p>운동량 밀도를 정의:
$$\mathbf{p}_s = m_s n_s \mathbf{u}_s = m_s \int \mathbf{v} f_s d^3v$$</p>
<p>고유 속도(열속도)는:
$$\mathbf{w} = \mathbf{v} - \mathbf{u}_s$$</p>
<p>압력 텐서는:
$$\overleftrightarrow{P}_s = m_s \int \mathbf{w} \mathbf{w} f_s d^3v$$</p>
<p>상당한 대수적 계산(부분 적분과 발산 정리 사용) 후, 운동량 방정식은 다음과 같이 됩니다:</p>
<p>$$\boxed{m_s n_s \frac{d \mathbf{u}_s}{dt} = q_s n_s (\mathbf{E} + \mathbf{u}_s \times \mathbf{B}) - \nabla \cdot \overleftrightarrow{P}_s + \mathbf{R}_s}$$</p>
<p>여기서 $d/dt = \partial/\partial t + \mathbf{u}_s \cdot \nabla$는 대류 도함수이고, $\mathbf{R}_s$는 다른 종과의 충돌로 인한 운동량 전달입니다.</p>
<p>이것은 유체 요소에 대한 Newton의 제2법칙입니다:
- <strong>좌변</strong>: 질량 × 가속도
- <strong>우변</strong>: Lorentz 힘 + 압력 경사력 + 충돌력</p>
<p><strong>핵심 포인트</strong>: 이 방정식은 분포함수의 2차 모멘트인 압력 텐서 $\overleftrightarrow{P}_s$라는 새로운 양을 도입합니다.</p>
<h3 id="14-2">1.4 2차 모멘트: 에너지 방정식<a class="header-link" href="#14-2" title="Permanent link">&para;</a></h3>
<p>2차 모멘트(가중치 = $\frac{1}{2} m_s v^2$)는 <strong>에너지 방정식</strong>을 제공합니다:</p>
<p>열 에너지 밀도를 정의:
$$\mathcal{E}_s = \frac{1}{2} m_s \int w^2 f_s d^3v$$</p>
<p>등방 압력($\overleftrightarrow{P}_s = p_s \overleftrightarrow{I}$)에 대해:
$$p_s = \frac{1}{3} m_s \int w^2 f_s d^3v = \frac{2}{3} \mathcal{E}_s$$</p>
<p>에너지 방정식은 다음과 같이 됩니다:</p>
<p>$$\frac{\partial \mathcal{E}_s}{\partial t} + \nabla \cdot (\mathcal{E}_s \mathbf{u}_s) = -p_s \nabla \cdot \mathbf{u}_s - \nabla \cdot \mathbf{q}_s + Q_s$$</p>
<p>여기서:
- $\mathbf{q}_s = \frac{1}{2} m_s \int w^2 \mathbf{w} f_s d^3v$는 열유속 벡터(3차 모멘트)
- $Q_s$는 충돌 에너지 전달</p>
<p>$p_s = \frac{2}{3} \mathcal{E}_s$를 사용하면 다음과 같이 다시 쓸 수 있습니다:</p>
<p>$$\frac{3}{2} \frac{d p_s}{dt} + \frac{5}{2} p_s \nabla \cdot \mathbf{u}_s = -\nabla \cdot \mathbf{q}_s + Q_s$$</p>
<p><strong>닫힘 문제</strong>: 에너지 방정식은 3차 모멘트인 열유속 $\mathbf{q}_s$를 도입합니다. 3차 모멘트를 취하면 4차 모멘트를 포함하는 방정식을 얻게 되며, 계속됩니다. 이 무한 계층은 최고차 모멘트에 대한 가정을 통해 <strong>닫혀야</strong> 합니다.</p>
<h3 id="15">1.5 닫힘 문제<a class="header-link" href="#15" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>모멘트 계층:

0차 모멘트:  ∂n/∂t + ∇·(nu) = 0              (u 도입)
1차 모멘트:  mn(du/dt) = qn(E+u×B) - ∇·P + R  (P 도입)
2차 모멘트:  dp/dt = -p∇·u - ∇·q + Q          (q 도입)
3차 모멘트:  ...                              (다음 모멘트 도입)
...

각 방정식은 다음 고차 모멘트에서 새로운 미지수를 도입합니다.
이것이 닫힘 문제입니다.
</code></pre></div>

<p>최고 모멘트와 저차 모멘트 사이의 관계를 가정하여 계층을 <strong>절단</strong>해야 합니다. 일반적인 닫힘:</p>
<p><strong>1. 등온 닫힘</strong>: 일정한 온도 가정
$$p_s = n_s k_B T_s, \quad T_s = \text{const}$$</p>
<p>이는 열전도가 매우 효율적이어서 온도가 즉시 평형을 이룰 때 유효합니다.</p>
<p><strong>2. 단열 닫힘</strong>: 열유속이 없고($\mathbf{q}_s = 0$) 단열 진화를 가정
$$\frac{d}{dt}\left( \frac{p_s}{n_s^\gamma} \right) = 0$$</p>
<p>여기서 $\gamma$는 단열 지수입니다(단원자 기체의 경우 $\gamma = 5/3$). 이는 열전도가 무시할 수 있는 빠른 과정에 유효합니다.</p>
<p><strong>3. CGL 닫힘</strong> (Chew-Goldberger-Low): 무충돌 자화 플라즈마의 경우, 압력은 비등방적입니다:
$$\overleftrightarrow{P}_s = p_{\perp s} \overleftrightarrow{I} + (p_{\parallel s} - p_{\perp s}) \hat{\mathbf{b}} \hat{\mathbf{b}}$$</p>
<p>이중 단열 방정식:
$$\frac{d}{dt}\left( \frac{p_{\perp s}}{n_s B} \right) = 0, \quad \frac{d}{dt}\left( \frac{p_{\parallel s} B^2}{n_s^3} \right) = 0$$</p>
<p>CGL은 Lesson 14에서 논의할 것입니다.</p>
<h3 id="16">1.6 이유체 방정식 요약<a class="header-link" href="#16" title="Permanent link">&para;</a></h3>
<p>각 입자 종(전자 $e$, 이온 $i$)에 대해:</p>
<p><strong>연속</strong>:
$$\frac{\partial n_s}{\partial t} + \nabla \cdot (n_s \mathbf{u}_s) = 0$$</p>
<p><strong>운동량</strong>:
$$m_s n_s \frac{d \mathbf{u}_s}{dt} = q_s n_s (\mathbf{E} + \mathbf{u}_s \times \mathbf{B}) - \nabla p_s + \mathbf{R}_s$$</p>
<p>(등방 압력 가정)</p>
<p><strong>에너지</strong> (단열 닫힘):
$$\frac{d}{dt}\left( \frac{p_s}{n_s^\gamma} \right) = 0$$</p>
<p>이들은 <strong>Maxwell 방정식</strong>과 결합됩니다:
$$\nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}, \quad \nabla \times \mathbf{B} = \mu_0 \mathbf{J} + \mu_0 \epsilon_0 \frac{\partial \mathbf{E}}{\partial t}$$
$$\nabla \cdot \mathbf{E} = \frac{\rho}{\epsilon_0}, \quad \nabla \cdot \mathbf{B} = 0$$</p>
<p>여기서 전하와 전류 밀도는:
$$\rho = \sum_s q_s n_s, \quad \mathbf{J} = \sum_s q_s n_s \mathbf{u}_s$$</p>
<p>충돌 항 $\mathbf{R}_s$는 종들을 결합합니다. 전자-이온 충돌의 경우:
$$\mathbf{R}_e = -\mathbf{R}_i = -\frac{m_e n_e}{\tau_{ei}} (\mathbf{u}_e - \mathbf{u}_i)$$</p>
<p>여기서 $\tau_{ei}$는 전자-이온 충돌 시간입니다.</p>
<h2 id="2-ohm">2. 일반화된 Ohm의 법칙<a class="header-link" href="#2-ohm" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 전자 운동량 방정식에서 유도<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>이유체 이론에서 가장 중요한 결과 중 하나는 전기장과 전류를 연결하는 <strong>일반화된 Ohm의 법칙</strong>입니다. 이상적 MHD에서는 간단한 형태를 가집니다:
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = 0$$</p>
<p>하지만 이것은 심각한 근사입니다. 전자 운동량 방정식에서 완전한 형태를 유도하겠습니다.</p>
<p>시작:
$$m_e n_e \frac{d \mathbf{u}_e}{dt} = -e n_e (\mathbf{E} + \mathbf{u}_e \times \mathbf{B}) - \nabla p_e + \mathbf{R}_e$$</p>
<p>충돌 항은 다음과 같이 쓸 수 있습니다:
$$\mathbf{R}_e = -\frac{m_e n_e}{\tau_{ei}} (\mathbf{u}_e - \mathbf{u}_i) \approx -\frac{m_e n_e \mathbf{u}_e}{\tau_{ei}}$$</p>
<p>(전류를 운반하는 전자에 대해 $u_e \gg u_i$를 가정).</p>
<p>재배열:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = \frac{m_e}{e \tau_{ei}} \mathbf{u}_e - \frac{1}{e n_e} \nabla p_e + \frac{m_e}{e n_e} \frac{d \mathbf{u}_e}{dt}$$</p>
<p>이제 모든 것을 <strong>전류 밀도</strong> $\mathbf{J}$와 <strong>질량 중심 속도</strong> $\mathbf{v}$로 표현합니다.</p>
<p>정의:
$$\mathbf{J} = -e n_e \mathbf{u}_e + e n_i \mathbf{u}_i \approx -e n_e (\mathbf{u}_e - \mathbf{u}_i)$$
$$\mathbf{v} = \frac{m_i n_i \mathbf{u}_i + m_e n_e \mathbf{u}_e}{m_i n_i + m_e n_e} \approx \mathbf{u}_i$$</p>
<p>($m_i \gg m_e$와 준중성 $n_e \approx n_i \equiv n$ 사용).</p>
<p>전류 정의로부터:
$$\mathbf{u}_e = \mathbf{u}_i - \frac{\mathbf{J}}{e n} \approx \mathbf{v} - \frac{\mathbf{J}}{e n}$$</p>
<p>재배열된 전자 방정식에 대입:</p>
<p>$$\mathbf{E} + \left( \mathbf{v} - \frac{\mathbf{J}}{en} \right) \times \mathbf{B} = \frac{m_e}{e^2 n \tau_{ei}} \mathbf{J} - \frac{1}{en} \nabla p_e + \frac{m_e}{e^2 n} \frac{d}{dt}\left( -\frac{\mathbf{J}}{e n} \right)$$</p>
<p>외적 간소화:
$$\mathbf{u}_e \times \mathbf{B} = \mathbf{v} \times \mathbf{B} - \frac{\mathbf{J} \times \mathbf{B}}{en}$$</p>
<p>이것이 <strong>일반화된 Ohm의 법칙</strong>을 제공합니다:</p>
<p>$$\boxed{\mathbf{E} + \mathbf{v} \times \mathbf{B} = \eta \mathbf{J} + \frac{1}{en} \mathbf{J} \times \mathbf{B} - \frac{1}{en} \nabla p_e + \frac{m_e}{e^2 n^2} \frac{d \mathbf{J}}{dt}}$$</p>
<p>여기서 <strong>저항률</strong>은:
$$\eta = \frac{m_e}{e^2 n \tau_{ei}}$$</p>
<h3 id="22">2.2 각 항의 물리적 해석<a class="header-link" href="#22" title="Permanent link">&para;</a></h3>
<p>우변의 각 항을 확인해봅시다:</p>
<ol>
<li><strong>저항 항</strong>: $\eta \mathbf{J}$</li>
<li>전자-이온 충돌에 의한 Ohmic 소산</li>
<li>자기 확산을 야기(저항 MHD)</li>
<li>
<p>$\eta \sim T_e^{-3/2}$ (온도에 따라 감소)</p>
</li>
<li>
<p><strong>Hall 항</strong>: $\frac{1}{en} \mathbf{J} \times \mathbf{B}$</p>
</li>
<li>자기장으로부터 이온의 분리</li>
<li>이온 skin depth $d_i = c/\omega_{pi}$ 스케일에서 중요</li>
<li>
<p>빠른 자기 재결합 가능</p>
</li>
<li>
<p><strong>전자 압력 항</strong>: $-\frac{1}{en} \nabla p_e$</p>
</li>
<li>압력 경사가 E 장 없이도 전류를 구동</li>
<li>
<p>급격한 경사 영역에서 중요 (예: 전류 시트)</p>
</li>
<li>
<p><strong>전자 관성 항</strong>: $\frac{m_e}{e^2 n^2} \frac{d \mathbf{J}}{dt}$</p>
</li>
<li>전자 skin depth $d_e = c/\omega_{pe}$에서 중요</li>
<li>매우 빠른 현상에 관련 (whistler 파동, 재결합)</li>
</ol>
<h3 id="23">2.3 스케일 분석: 각 항이 언제 중요한가?<a class="header-link" href="#23" title="Permanent link">&para;</a></h3>
<p>각 항이 언제 중요한지 결정하기 위해 <strong>차수 분석</strong>을 수행합니다.</p>
<p>특성 스케일 정의:
- 길이: $L$
- 속도: $V$
- 자기장: $B_0$
- 밀도: $n_0$
- 전류: $J_0 \sim B_0/(\mu_0 L)$ (Ampère의 법칙에서)</p>
<p><strong>이상적 MHD 항</strong> (좌변):
$$\mathbf{v} \times \mathbf{B} \sim V B_0$$</p>
<p><strong>저항 항</strong>:
$$\eta \mathbf{J} \sim \eta \frac{B_0}{\mu_0 L}$$</p>
<p>비율:
$$\frac{\eta J}{\mathbf{v} \times \mathbf{B}} \sim \frac{\eta}{\mu_0 V L} = \frac{1}{R_m}$$</p>
<p>여기서 $R_m = \mu_0 V L / \eta$는 <strong>자기 Reynolds 수</strong>입니다. 저항률은 $R_m \lesssim 1$일 때 중요합니다.</p>
<p><strong>Hall 항</strong>:
$$\frac{\mathbf{J} \times \mathbf{B}}{en} \sim \frac{B_0^2}{\mu_0 e n_0 L}$$</p>
<p>비율:
$$\frac{J \times B / en}{\mathbf{v} \times \mathbf{B}} \sim \frac{B_0}{\mu_0 e n_0 V L} = \frac{V_A}{V} \frac{d_i}{L}$$</p>
<p>여기서 $d_i = c/\omega_{pi} = \sqrt{m_i / (\mu_0 e^2 n_0)}$는 <strong>이온 skin depth</strong>이고 $V_A = B_0/\sqrt{\mu_0 m_i n_0}$는 Alfvén 속도입니다.</p>
<p>Hall 항은 $L \lesssim d_i$ 또는 이온 스케일에서 $V \lesssim V_A$일 때 중요합니다.</p>
<p><strong>전자 압력 항</strong>:
$$\frac{\nabla p_e}{en} \sim \frac{k_B T_e}{eL}$$</p>
<p>비율:
$$\frac{\nabla p_e / en}{\mathbf{v} \times \mathbf{B}} \sim \frac{k_B T_e}{e V B_0 L} = \frac{v_{te}^2}{V^2} \frac{\rho_e}{L}$$</p>
<p>여기서 $v_{te} = \sqrt{k_B T_e / m_e}$는 전자 열속도이고 $\rho_e = v_{te}/\omega_{ce}$는 전자 gyroradius입니다.</p>
<p>이 항은 급격한 압력 경사 영역에서 중요합니다.</p>
<p><strong>전자 관성 항</strong>:
$$\frac{m_e}{e^2 n^2} \frac{dJ}{dt} \sim \frac{m_e}{e^2 n_0^2} \frac{B_0}{\mu_0 L} \frac{V}{L} = \frac{m_e V B_0}{\mu_0 e^2 n_0 L^2}$$</p>
<p>비율:
$$\frac{m_e dJ/dt / (e^2 n^2)}{v \times B} \sim \frac{m_e}{\mu_0 e^2 n_0 L^2} = \frac{d_e^2}{L^2}$$</p>
<p>여기서 $d_e = c/\omega_{pe}$는 <strong>전자 skin depth</strong>입니다.</p>
<p>이 항은 $L \lesssim d_e$일 때 중요합니다.</p>
<p><strong>요약</strong>:</p>
<div class="highlight"><pre><span></span><code>항                   스케일               언제 중요한가
----------------    -----------------   ------------------------
저항                1/R_m               R_m ~ 1 (낮은 T, 작은 L)
Hall                d_i/L               L ~ d_i (이온 스케일)
전자 압력           β_e ρ_e/L           급격한 경사
전자 관성           (d_e/L)^2           L ~ d_e (전자 스케일)

일반적 순서: d_e &lt;&lt; ρ_e &lt;&lt; d_i &lt;&lt; L (MHD)
</code></pre></div>

<h3 id="24">2.4 제한 경우<a class="header-link" href="#24" title="Permanent link">&para;</a></h3>
<p><strong>이상적 MHD</strong> ($R_m \to \infty$, $L \gg d_i$):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = 0$$</p>
<p>자기장은 유체에 동결됩니다.</p>
<p><strong>저항 MHD</strong> (저항 항 유지, 다른 항 무시):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \eta \mathbf{J}$$</p>
<p>자기 재결합을 허용하지만 느림(Sweet-Parker 속도).</p>
<p><strong>Hall MHD</strong> (Hall 항 유지, 저항/관성 무시):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \frac{1}{en} \mathbf{J} \times \mathbf{B}$$</p>
<p>빠른 재결합(Petschek 속도), whistler 파동 가능.</p>
<p><strong>전자 MHD</strong> (Hall + 관성 유지, 저항 무시):
$$\mathbf{E} + \mathbf{v} \times \mathbf{B} = \frac{1}{en} \mathbf{J} \times \mathbf{B} + \frac{m_e}{e^2 n^2} \frac{d \mathbf{J}}{dt}$$</p>
<p>전자 스케일에서 관련 (예: 재결합 확산 영역).</p>
<h2 id="3-hall">3. Hall 효과<a class="header-link" href="#3-hall" title="Permanent link">&para;</a></h2>
<h3 id="31-hall">3.1 Hall 항의 물리<a class="header-link" href="#31-hall" title="Permanent link">&para;</a></h3>
<p>Hall 항 $\frac{1}{en} \mathbf{J} \times \mathbf{B}$는 전자와 이온 운동의 차이에서 발생합니다. 전류가 자기장을 가로질러 흐를 때, 전자와 이온은 다른 Lorentz 힘을 경험하여 전하 분리를 만들고 따라서 <strong>$\mathbf{J}$와 $\mathbf{B}$ 모두에 수직인 전기장</strong>을 만듭니다.</p>
<p>자기장 $\mathbf{B} = B_0 \hat{\mathbf{z}}$에서 전류 $\mathbf{J} = J_x \hat{\mathbf{x}}$를 고려:</p>
<p>$$\mathbf{J} \times \mathbf{B} = J_x B_0 \hat{\mathbf{y}}$$</p>
<p>이것이 전기장을 만듭니다:
$$E_y = \frac{J_x B_0}{en}$$</p>
<p>이것이 <strong>Hall 전기장</strong>입니다.</p>
<h3 id="32-hall">3.2 Hall 매개변수<a class="header-link" href="#32-hall" title="Permanent link">&para;</a></h3>
<p><strong>Hall 매개변수</strong>는 자기장의 중요성을 정량화합니다:</p>
<p>$$\Omega_s \tau_s = \omega_{cs} \tau_{cs}$$</p>
<p>여기서 $\omega_{cs} = q_s B / m_s$는 cyclotron 주파수이고 $\tau_{cs}$는 충돌 시간입니다.</p>
<ul>
<li>$\Omega_s \tau_s \ll 1$일 때: 충돌이 지배적, 입자 궤도가 회전을 완료하기 전에 중단됨 → <strong>비자화</strong></li>
<li>$\Omega_s \tau_s \gg 1$일 때: 입자가 충돌 사이에 많은 회전 완료 → <strong>자화</strong></li>
</ul>
<p>일반적인 플라즈마에서 전자의 경우, $\Omega_e \tau_e \gg 1$ (강하게 자화됨).
이온의 경우, $\Omega_i \tau_i$는 다양함 (충돌 플라즈마에서 약하게 자화, 고온 핵융합 플라즈마에서 강하게 자화).</p>
<h3 id="33">3.3 자기장으로부터 이온의 분리<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<p>이온 skin depth $d_i$보다 큰 스케일에서는 전자와 이온 모두 자기장에 동결됩니다(이상적 MHD). 하지만 $L \lesssim d_i$ 스케일에서는 Hall 항이 중요해지고, <strong>이온이 자기장으로부터 분리</strong>됩니다.</p>
<p>이를 보기 위해 이온과 전자 운동량 방정식을 고려:</p>
<p><strong>이온</strong>:
$$m_i n \frac{d \mathbf{u}_i}{dt} = e n (\mathbf{E} + \mathbf{u}_i \times \mathbf{B}) - \nabla p_i$$</p>
<p><strong>전자</strong> (일반화된 Ohm의 법칙에서, Hall 항만 유지):
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} \approx \frac{1}{en} \mathbf{J} \times \mathbf{B}$$</p>
<p>$\mathbf{J} = en(\mathbf{u}_i - \mathbf{u}_e)$ 사용:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = \frac{1}{en} en (\mathbf{u}_i - \mathbf{u}_e) \times \mathbf{B}$$</p>
<p>재배열:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = (\mathbf{u}_i - \mathbf{u}_e) \times \mathbf{B}$$
$$\mathbf{E} + \mathbf{u}_i \times \mathbf{B} = 0$$</p>
<p>따라서 <strong>전자</strong>는 동결 조건을 만족합니다:
$$\mathbf{E} + \mathbf{u}_e \times \mathbf{B} = 0$$</p>
<p>하지만 <strong>이온</strong>은 그렇지 않습니다! 이온은 전기장을 경험합니다:
$$\mathbf{E} = -\mathbf{u}_i \times \mathbf{B} + (\mathbf{u}_i - \mathbf{u}_e) \times \mathbf{B} = \mathbf{u}_e \times \mathbf{B} \neq -\mathbf{u}_i \times \mathbf{B}$$</p>
<p>이것은 자기장이 이온 유체가 아닌 <strong>전자 유체에 동결</strong>되어 있음을 의미하며, $\sim d_i$ 스케일에서.</p>
<h3 id="34-hall-mhd">3.4 Hall MHD 파동<a class="header-link" href="#34-hall-mhd" title="Permanent link">&para;</a></h3>
<p>Hall 항을 포함하면 MHD 파동 분산이 수정됩니다. 주요 변화는 고주파수에서 <strong>whistler 파동</strong>의 출현입니다.</p>
<p>Hall MHD 분산 관계(저주파, 소진폭 한계)는 다음을 제공합니다:</p>
<p><strong>Alfvén/whistler 분기</strong>:
$$\omega = k_\parallel V_A \sqrt{1 + k^2 d_i^2}$$</p>
<ul>
<li>$k d_i \ll 1$ (큰 스케일)일 때: $\omega \approx k_\parallel V_A$ (Alfvén 파동)</li>
<li>$k d_i \gg 1$ (작은 스케일)일 때: $\omega \approx k_\parallel V_A k d_i = k \sqrt{k_\parallel V_A d_i}$ (whistler)</li>
</ul>
<p>Whistler 파동은:
- <strong>우선회 원편광</strong> (이온 프레임에서)
- <strong>분산적</strong>: 위상 속도가 $k$에 따라 증가
- <strong>이온 운동 없음</strong>: 전자만 반응</p>
<p>아래 Python 코드에서 이 분산 관계를 계산할 것입니다.</p>
<h2 id="4">4. 반자성 표류<a class="header-link" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-vs">4.1 입자 표류 vs. 유체 표류<a class="header-link" href="#41-vs" title="Permanent link">&para;</a></h3>
<p>Lesson 3에서 단일 입자 궤도 이론에서 <strong>입자 표류</strong>를 유도했습니다:</p>
<p>$$\mathbf{v}_E = \frac{\mathbf{E} \times \mathbf{B}}{B^2}, \quad \mathbf{v}_{\nabla B} = \frac{m v_\perp^2}{2 q B^3} \mathbf{B} \times \nabla B, \quad \text{등}$$</p>
<p>이들은 개별 입자의 표류입니다.</p>
<p>유체 이론에서는 압력 경사 및 기타 집단 효과에서 발생하는 <strong>유체 표류</strong>가 있습니다. 가장 중요한 것은 <strong>반자성 표류</strong>입니다.</p>
<h3 id="42">4.2 반자성 표류 유도<a class="header-link" href="#42" title="Permanent link">&para;</a></h3>
<p>$\mathbf{B}$에 수직인 압력 경사를 가진 자화 플라즈마에서 운동량 방정식을 고려:</p>
<p>$$m_s n_s \frac{d \mathbf{u}_s}{dt} = q_s n_s (\mathbf{E} + \mathbf{u}_s \times \mathbf{B}) - \nabla p_s$$</p>
<p>평형($d\mathbf{u}_s/dt = 0$)에서 전기장이 없을 때($\mathbf{E} = 0$):</p>
<p>$$0 = q_s n_s \mathbf{u}_s \times \mathbf{B} - \nabla p_s$$</p>
<p>$\mathbf{B}$와 외적을 취하면:</p>
<p>$$q_s n_s (\mathbf{u}_s \times \mathbf{B}) \times \mathbf{B} = -\nabla p_s \times \mathbf{B}$$</p>
<p>벡터 항등식 $(\mathbf{A} \times \mathbf{B}) \times \mathbf{C} = \mathbf{B}(\mathbf{A} \cdot \mathbf{C}) - \mathbf{A}(\mathbf{B} \cdot \mathbf{C})$ 사용:</p>
<p>$$q_s n_s [\mathbf{B} (\mathbf{u}_s \cdot \mathbf{B}) - \mathbf{u}_s B^2] = -\nabla p_s \times \mathbf{B}$$</p>
<p>유동이 $\mathbf{B}$에 수직이면(즉, $\mathbf{u}_s \cdot \mathbf{B} = 0$):</p>
<p>$$\mathbf{u}_s = \frac{\nabla p_s \times \mathbf{B}}{q_s n_s B^2} = -\frac{\mathbf{B} \times \nabla p_s}{q_s n_s B^2}$$</p>
<p>이것이 <strong>반자성 표류 속도</strong>입니다:</p>
<p>$$\boxed{\mathbf{v}_{*s} = -\frac{\mathbf{B} \times \nabla p_s}{q_s n_s B^2}}$$</p>
<p>전자($q_e = -e$)에 대해:
$$\mathbf{v}_{*e} = \frac{\mathbf{B} \times \nabla p_e}{e n_e B^2}$$</p>
<p>이온($q_i = +e$)에 대해:
$$\mathbf{v}_{*i} = -\frac{\mathbf{B} \times \nabla p_i}{e n_i B^2}$$</p>
<h3 id="43">4.3 반자성 전류<a class="header-link" href="#43" title="Permanent link">&para;</a></h3>
<p><strong>반자성 전류</strong>는:</p>
<p>$$\mathbf{J}_* = \sum_s q_s n_s \mathbf{v}_{*s} = -\frac{\mathbf{B} \times \nabla p_e}{B^2} - \frac{\mathbf{B} \times \nabla p_i}{B^2} = \frac{\mathbf{B} \times \nabla p}{B^2}$$</p>
<p>여기서 $p = p_e + p_i$는 총 압력입니다.</p>
<p>이것은 또한 다음과 같이 쓸 수 있습니다:
$$\mathbf{J}_* = -\nabla p \times \frac{\mathbf{B}}{B^2}$$</p>
<p><strong>핵심 포인트</strong>: 반자성 표류는 <strong>입자 표류가 아닙니다</strong>! 개별 입자 궤도를 풀면 이 표류를 찾을 수 없습니다. 이것은 압력 경사로 인한 <strong>분포함수의 공간 변화</strong>에서 발생합니다.</p>
<p>이를 보기 위해, 반자성 표류 속도가 경사 스케일 길이 $L_p = p / |\nabla p|$에 의존한다는 것을 주목:</p>
<p>$$v_* \sim \frac{p}{q n B L_p} = \frac{k_B T}{q B L_p} \sim \frac{\rho}{L_p} v_{th}$$</p>
<p>여기서 $\rho = v_{th}/\omega_c$는 gyroradius입니다.</p>
<p>무충돌 플라즈마에서, 다른 gyro-궤도의 입자들은 다른 밀도를 가지며, 분포에 대한 평균 시 순 표류를 만듭니다.</p>
<h3 id="44">4.4 물리적 해석: 자화 전류<a class="header-link" href="#44" title="Permanent link">&para;</a></h3>
<p>반자성 전류는 회전하는 입자의 자기 모멘트에서 발생하는 <strong>자화 전류</strong>로 이해될 수 있습니다.</p>
<p>자화는:
$$\mathbf{M} = -n \mu \frac{\mathbf{B}}{B}$$</p>
<p>여기서 $\mu = m v_\perp^2 / (2B)$는 자기 모멘트입니다.</p>
<p>자화 전류는:
$$\mathbf{J}_m = \nabla \times \mathbf{M}$$</p>
<p>$\mathbf{B}$에 수직인 압력 경사에 대해, 이것은 다음을 제공합니다:
$$\mathbf{J}_m = \frac{\mathbf{B} \times \nabla p_\perp}{B^2}$$</p>
<p>이것은 정확히 반자성 전류입니다.</p>
<h3 id="45">4.5 예: 원통형 플라즈마 기둥<a class="header-link" href="#45" title="Permanent link">&para;</a></h3>
<p>다음을 가진 원통형 플라즈마 기둥을 고려:
- 축방향 자기장: $\mathbf{B} = B_0 \hat{\mathbf{z}}$
- 방사형 압력 프로파일: $p(r) = p_0 \left(1 - \frac{r^2}{a^2}\right)$</p>
<p>압력 경사는:
$$\nabla p = \frac{dp}{dr} \hat{\mathbf{r}} = -\frac{2 p_0 r}{a^2} \hat{\mathbf{r}}$$</p>
<p>반자성 전류는:
$$\mathbf{J}_* = \frac{\mathbf{B} \times \nabla p}{B^2} = \frac{B_0 \hat{\mathbf{z}} \times \left( -\frac{2 p_0 r}{a^2} \hat{\mathbf{r}} \right)}{B_0^2} = \frac{2 p_0 r}{B_0 a^2} \hat{\boldsymbol{\theta}}$$</p>
<p>이것은 인가된 장에 반대하는 방위각 전류입니다(반자성).</p>
<p>전자에 대한 반자성 표류 속도는:
$$\mathbf{v}_{*e} = \frac{\mathbf{B} \times \nabla p_e}{e n_e B^2} = \frac{2 k_B T_e r}{e B_0 a^2} \hat{\boldsymbol{\theta}}$$</p>
<p>전자는 $+\hat{\boldsymbol{\theta}}$ 방향으로 표류합니다(위에서 볼 때 반시계 방향).</p>
<p>이온은 반대 방향으로 표류합니다:
$$\mathbf{v}_{*i} = -\frac{2 k_B T_i r}{e B_0 a^2} \hat{\boldsymbol{\theta}}$$</p>
<p>순 전류는 전자와 이온 기여의 합입니다.</p>
<h2 id="5">5. 이유체 파동<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-kinetic-alfven">5.1 Kinetic Alfvén 파동<a class="header-link" href="#51-kinetic-alfven" title="Permanent link">&para;</a></h3>
<p>이온 gyroradius에 접근하는 스케일에서, Alfvén 파동은 운동학적 효과에 의해 수정됩니다. <strong>kinetic Alfvén 파동(KAW)</strong>은 분산 관계를 가집니다:</p>
<p>$$\omega^2 = k_\parallel^2 V_A^2 \left( 1 + k_\perp^2 \rho_s^2 \right)$$</p>
<p>여기서 $\rho_s = c_s / \omega_{ci}$는 <strong>이온 음향 gyroradius</strong>(또는 hybrid gyroradius)이고, $c_s = \sqrt{k_B T_e / m_i}$는 이온 음향 속도입니다.</p>
<p>주요 특징:
- 유한 $k_\perp$가 파동 주파수를 증가시킴
- 전기장이 평행 성분을 가짐: $E_\parallel \neq 0$
- 전자가 $\mathbf{B}$에 평행하게 가속될 수 있음</p>
<p>KAW는 다음에서 중요합니다:
- 오로라 가속
- 태양풍 난류
- 토카막 가장자리 난류</p>
<h3 id="52-whistler">5.2 이유체 관점에서의 Whistler 파동<a class="header-link" href="#52-whistler" title="Permanent link">&para;</a></h3>
<p>Lesson 10에서 운동 이론에서 whistler 파동을 유도했습니다. 이유체 관점은 다음과 같습니다:</p>
<p>Hall MHD(전자 관성 무시)에서 시작하여, 전자기파의 분산 관계는:</p>
<p>$$\omega = \frac{k_\parallel^2 V_A^2}{\omega_{ci}} \equiv k_\parallel V_A k_\parallel d_i$$</p>
<p>이것이 <strong>whistler 파동</strong>입니다:
- 고주파($\omega \ll \omega_{ce}$, 하지만 $\omega \gg \omega_{ci}$)
- 우선회 편광(전자 회전, 이온 정지)
- 위상 속도가 $k$에 따라 증가(분산적)</p>
<p>Whistler 파동은 다음에서 주요 역할을 합니다:
- 자기 재결합(빠른 유입 가능)
- 복사 벨트 역학(고에너지 전자의 피치각 산란)
- 태양 코로나 가열</p>
<h3 id="53-">5.3 이온-사이클로트론 파동<a class="header-link" href="#53-" title="Permanent link">&para;</a></h3>
<p>이온 사이클로트론 주파수 근처의 주파수에서 <strong>이온-사이클로트론 파동</strong>(또는 <strong>이온 Bernstein 파동</strong>)이 나타납니다:</p>
<p>$$\omega \approx \omega_{ci} + k_\parallel^2 V_A^2 / \omega_{ci}$$</p>
<p>특징:
- 좌선회 편광(이온 회전, 전자 단열적 반응)
- $\omega = \omega_{ci}$에서 공명 흡수
- 플라즈마 가열에 사용(토카막의 ICRF 가열)</p>
<h3 id="54">5.4 이류 불안정성<a class="header-link" href="#54" title="Permanent link">&para;</a></h3>
<p>두 유체가 상대 흐름 속도 $u_0$를 가질 때, 시스템이 불안정할 수 있습니다. 이온이 정지하고 전자가 속도 $u_0$로 흐르는 경우를 고려:</p>
<p>분산 관계는 다음과 같이 됩니다:
$$\omega^2 - k^2 c_s^2 - \omega_{pe}^2 = 0, \quad \text{(이온 음향)}$$
$$(\omega - k u_0)^2 - \omega_{pe}^2 = 0 \quad \text{(Langmuir, Doppler로 이동)}$$</p>
<p>이 모드들이 결합되면, $u_0 > v_{te}$ (전자 열속도)일 때 <strong>이류 불안정성</strong>을 얻습니다.</p>
<p>성장률:
$$\gamma \sim \frac{\omega_{pe}}{3^{1/3}} \left( \frac{u_0}{v_{te}} \right)^{2/3}$$</p>
<p>이것은 <strong>운동학적 불안정성</strong>이지만, 적절한 닫힘으로 이유체 이론에서 포착될 수 있습니다.</p>
<h2 id="6-python">6. Python 코드 예제<a class="header-link" href="#6-python" title="Permanent link">&para;</a></h2>
<h3 id="61-vs">6.1 이유체 vs. 단일 유체 분산 관계<a class="header-link" href="#61-vs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Plasma parameters</span>
<span class="n">m_i</span> <span class="o">=</span> <span class="mf">1.67e-27</span>  <span class="c1"># proton mass (kg)</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.11e-31</span>  <span class="c1"># electron mass (kg)</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">1.6e-19</span>     <span class="c1"># elementary charge (C)</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">3e8</span>         <span class="c1"># speed of light (m/s)</span>
<span class="n">mu_0</span> <span class="o">=</span> <span class="mf">4e-7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># permeability</span>

<span class="n">n</span> <span class="o">=</span> <span class="mf">1e19</span>        <span class="c1"># density (m^-3)</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">0.1</span>         <span class="c1"># magnetic field (T)</span>
<span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>        <span class="c1"># electron temperature (eV)</span>
<span class="n">T_i</span> <span class="o">=</span> <span class="mi">10</span>        <span class="c1"># ion temperature (eV)</span>

<span class="c1"># Convert temperature to Joules</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-23</span>
<span class="n">T_e_J</span> <span class="o">=</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span>
<span class="n">T_i_J</span> <span class="o">=</span> <span class="n">T_i</span> <span class="o">*</span> <span class="n">e</span>

<span class="c1"># Derived quantities</span>
<span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">omega_pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_i</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">omega_ce</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">m_e</span>
<span class="n">omega_ci</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="n">m_i</span>

<span class="n">v_A</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu_0</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m_i</span><span class="p">)</span>  <span class="c1"># Alfvén speed</span>
<span class="n">c_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">T_e_J</span> <span class="o">+</span> <span class="n">T_i_J</span><span class="p">)</span> <span class="o">/</span> <span class="n">m_i</span><span class="p">)</span>  <span class="c1"># ion sound speed</span>
<span class="n">d_i</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">omega_pi</span>  <span class="c1"># ion skin depth</span>
<span class="n">d_e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">omega_pe</span>  <span class="c1"># electron skin depth</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plasma parameters:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Alfvén speed V_A = </span><span class="si">{</span><span class="n">v_A</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s = </span><span class="si">{</span><span class="n">v_A</span><span class="o">/</span><span class="n">c</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> c&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion sound speed c_s = </span><span class="si">{</span><span class="n">c_s</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion skin depth d_i = </span><span class="si">{</span><span class="n">d_i</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Electron skin depth d_e = </span><span class="si">{</span><span class="n">d_e</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion gyrofrequency ω_ci = </span><span class="si">{</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Electron gyrofrequency ω_ce = </span><span class="si">{</span><span class="n">omega_ce</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Wavenumber range (parallel to B)</span>
<span class="n">k_min</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">)</span>
<span class="n">k_max</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">k_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">k_max</span><span class="p">),</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># MHD Alfvén wave (single-fluid)</span>
<span class="n">omega_MHD</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v_A</span>

<span class="c1"># Hall MHD Alfvén/whistler wave (two-fluid)</span>
<span class="n">omega_Hall</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v_A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Kinetic Alfvén wave (with finite k_perp)</span>
<span class="n">k_perp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># assume oblique propagation</span>
<span class="n">rho_s</span> <span class="o">=</span> <span class="n">c_s</span> <span class="o">/</span> <span class="n">omega_ci</span>  <span class="c1"># ion sound gyroradius</span>
<span class="n">omega_KAW</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v_A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k_perp</span> <span class="o">*</span> <span class="n">rho_s</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot dispersion relations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">omega_MHD</span> <span class="o">/</span> <span class="n">omega_ci</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MHD Alfvén&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">omega_Hall</span> <span class="o">/</span> <span class="n">omega_ci</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hall MHD (whistler)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">omega_KAW</span> <span class="o">/</span> <span class="n">omega_ci</span><span class="p">,</span> <span class="s1">&#39;g-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kinetic Alfvén&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$k d_i = 1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$k d_i$ (normalized wavenumber)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega / \omega_</span><span class="si">{ci}</span><span class="s1">$ (normalized frequency)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Two-Fluid Dispersion Relations: Alfvén to Whistler Transition&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;two_fluid_dispersion.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At k d_i = 1:&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">d_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  MHD: ω/ω_ci = </span><span class="si">{</span><span class="n">omega_MHD</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Hall MHD: ω/ω_ci = </span><span class="si">{</span><span class="n">omega_Hall</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Kinetic Alfvén: ω/ω_ci = </span><span class="si">{</span><span class="n">omega_KAW</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">omega_ci</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="62-ohm">6.2 일반화된 Ohm의 법칙: 상대적 항 크기<a class="header-link" href="#62-ohm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate relative magnitudes of generalized Ohm&#39;s law terms.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    n: density (m^-3)</span>
<span class="sd">    T_e: electron temperature (eV)</span>
<span class="sd">    B: magnetic field (T)</span>
<span class="sd">    L: length scale (m)</span>
<span class="sd">    V: flow velocity (m/s)</span>
<span class="sd">    eta: resistivity (Ω·m), if None calculate from Spitzer</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">e</span> <span class="o">=</span> <span class="mf">1.6e-19</span>
    <span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.11e-31</span>
    <span class="n">m_i</span> <span class="o">=</span> <span class="mf">1.67e-27</span>
    <span class="n">mu_0</span> <span class="o">=</span> <span class="mf">4e-7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-23</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mf">3e8</span>

    <span class="c1"># Spitzer resistivity (if not provided)</span>
    <span class="k">if</span> <span class="n">eta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">T_e_eV</span> <span class="o">=</span> <span class="n">T_e</span>
        <span class="n">ln_Lambda</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Coulomb logarithm (typical)</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="mf">5.2e-5</span> <span class="o">*</span> <span class="n">ln_Lambda</span> <span class="o">*</span> <span class="n">T_e_eV</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Ω·m</span>

    <span class="c1"># Current density (from Ampere&#39;s law estimate)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">B</span> <span class="o">/</span> <span class="p">(</span><span class="n">mu_0</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>

    <span class="c1"># Characteristic electric field (ideal MHD)</span>
    <span class="n">E_ideal</span> <span class="o">=</span> <span class="n">V</span> <span class="o">*</span> <span class="n">B</span>

    <span class="c1"># Generalized Ohm&#39;s law terms</span>
    <span class="n">E_resistive</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">J</span>
    <span class="n">E_Hall</span> <span class="o">=</span> <span class="n">J</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">E_pressure</span> <span class="o">=</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">T_e</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>  <span class="c1"># ∇p_e ~ nkT/L</span>

    <span class="n">omega_pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
    <span class="n">d_e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">omega_pe</span>
    <span class="n">E_inertia</span> <span class="o">=</span> <span class="p">(</span><span class="n">m_e</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="p">(</span><span class="n">V</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span>

    <span class="c1"># Normalize to ideal MHD term</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Ideal (v×B)&#39;</span><span class="p">:</span> <span class="n">E_ideal</span><span class="p">,</span>
        <span class="s1">&#39;Resistive (ηJ)&#39;</span><span class="p">:</span> <span class="n">E_resistive</span><span class="p">,</span>
        <span class="s1">&#39;Hall (J×B/ne)&#39;</span><span class="p">:</span> <span class="n">E_Hall</span><span class="p">,</span>
        <span class="s1">&#39;Pressure (∇p_e/ne)&#39;</span><span class="p">:</span> <span class="n">E_pressure</span><span class="p">,</span>
        <span class="s1">&#39;Inertia (m_e dJ/dt)&#39;</span><span class="p">:</span> <span class="n">E_inertia</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">/</span><span class="n">E_ideal</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span> <span class="n">eta</span>

<span class="c1"># Parameter scan: vary length scale</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># 1 mm to 1 km</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">1e19</span>
<span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">V</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># 100 km/s</span>

<span class="n">terms_vs_L</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Ideal (v×B)&#39;</span><span class="p">,</span> <span class="s1">&#39;Resistive (ηJ)&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Hall (J×B/ne)&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure (∇p_e/ne)&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Inertia (m_e dJ/dt)&#39;</span><span class="p">]}</span>

<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span>
    <span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">terms_vs_L</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">terms_vs_L</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;Ideal (v×B)&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Mark characteristic scales</span>
<span class="n">d_e</span> <span class="o">=</span> <span class="mf">3e8</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.6e-19</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">9.11e-31</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">d_i</span> <span class="o">=</span> <span class="mf">3e8</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.6e-19</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.67e-27</span> <span class="o">*</span> <span class="mf">8.85e-12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">d_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$d_e$ = </span><span class="si">{</span><span class="n">d_e</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">d_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$d_i$ = </span><span class="si">{</span><span class="n">d_i</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Length scale L (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative magnitude (normalized to v×B)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Generalized Ohm</span><span class="se">\&#39;</span><span class="s1">s Law: Term Magnitudes vs. Scale&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ohm_law_terms.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print values at specific scales</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Relative term magnitudes:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At L = </span><span class="si">{</span><span class="n">d_e</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m (electron skin depth):&quot;</span><span class="p">)</span>
<span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">d_e</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">25s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At L = </span><span class="si">{</span><span class="n">d_i</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m (ion skin depth):&quot;</span><span class="p">)</span>
<span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">25s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At L = 1 m (macroscopic scale):&quot;</span><span class="p">)</span>
<span class="n">terms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ohm_law_terms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T_e</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">25s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="63">6.3 반자성 표류 시각화<a class="header-link" href="#63" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circle</span>

<span class="k">def</span><span class="w"> </span><span class="nf">diamagnetic_drift_cylinder</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize diamagnetic drift in a cylindrical plasma column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Plasma parameters</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># plasma radius (m)</span>
    <span class="n">B_0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># axial magnetic field (T)</span>
    <span class="n">p_0</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># peak pressure (Pa)</span>
    <span class="n">T_e</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># electron temperature (eV)</span>
    <span class="n">T_i</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># ion temperature (eV)</span>
    <span class="n">n_0</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># peak density (m^-3)</span>

    <span class="n">e</span> <span class="o">=</span> <span class="mf">1.6e-19</span>
    <span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-23</span>

    <span class="c1"># Radial grid</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Pressure profile (parabolic)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p_e</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">p_i</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Pressure gradient</span>
    <span class="n">dp_dr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p_0</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">dp_e_dr</span> <span class="o">=</span> <span class="n">dp_dr</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dp_i_dr</span> <span class="o">=</span> <span class="n">dp_dr</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Diamagnetic drift velocities</span>
    <span class="n">v_star_e</span> <span class="o">=</span> <span class="o">-</span><span class="n">dp_e_dr</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">B_0</span><span class="p">)</span>  <span class="c1"># azimuthal (θ) direction</span>
    <span class="n">v_star_i</span> <span class="o">=</span> <span class="n">dp_i_dr</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">B_0</span><span class="p">)</span>

    <span class="c1"># Diamagnetic current density</span>
    <span class="n">J_theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">dp_dr</span> <span class="o">/</span> <span class="n">B_0</span>

    <span class="c1"># Plot profiles</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Pressure profile</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p_e</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Electron&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p_i</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ion&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (kPa)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pressure Profile&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Diamagnetic drift velocities</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">v_star_e</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Electron&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">v_star_i</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ion&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Drift velocity (km/s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Diamagnetic Drift Velocity (azimuthal)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Diamagnetic current</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">J_theta</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radius (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Current density (kA/m²)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Diamagnetic Current Density (azimuthal)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># 2D visualization: top view</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">R</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>

    <span class="c1"># Pressure contour</span>
    <span class="n">P_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">Y</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">P_grid</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pressure (kPa)&#39;</span><span class="p">)</span>

    <span class="c1"># Velocity vectors (sample points)</span>
    <span class="n">n_arrows</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">r_arrows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">theta_arrows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_arrows</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">r_arrows</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">theta_arrows</span><span class="p">:</span>
            <span class="n">xi</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
            <span class="n">yi</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

            <span class="c1"># Diamagnetic drift is in theta direction</span>
            <span class="c1"># In Cartesian: v_theta = -sin(θ) v_r_hat + cos(θ) v_θ_hat</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">ri</span><span class="p">))</span>
            <span class="n">v_mag</span> <span class="o">=</span> <span class="n">v_star_e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

            <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">v_mag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
            <span class="n">vy</span> <span class="o">=</span> <span class="n">v_mag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">yi</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">vx</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">vy</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span>
                    <span class="n">head_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y (cm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Electron Diamagnetic Drift (top view)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">a</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;diamagnetic_drift.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Print values at r = a/2</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At r = a/2 = </span><span class="si">{</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> cm:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Pressure: </span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kPa&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Electron drift: </span><span class="si">{</span><span class="n">v_star_e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ion drift: </span><span class="si">{</span><span class="n">v_star_i</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> km/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current density: </span><span class="si">{</span><span class="n">J_theta</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kA/m²&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Drift frequency: </span><span class="si">{</span><span class="n">v_star_e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Compare to ω_ci = </span><span class="si">{</span><span class="n">e</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.67e-27</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>

<span class="n">diamagnetic_drift_cylinder</span><span class="p">()</span>
</code></pre></div>

<h3 id="64">6.4 이유체 닫힘 비교<a class="header-link" href="#64" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compare_closures</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compare different closure models: isothermal vs. adiabatic.</span>
<span class="sd">    Simulate compression of a plasma element.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initial conditions</span>
    <span class="n">n_0</span> <span class="o">=</span> <span class="mf">1e19</span>  <span class="c1"># m^-3</span>
    <span class="n">T_0</span> <span class="o">=</span> <span class="mi">10</span>    <span class="c1"># eV</span>
    <span class="n">V_0</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># m^3</span>

    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># adiabatic index</span>

    <span class="c1"># Compression ratio</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">V_0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">V_0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n_0</span> <span class="o">*</span> <span class="p">(</span><span class="n">V_0</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span>  <span class="c1"># density increases as volume decreases</span>

    <span class="c1"># Isothermal: T = const</span>
    <span class="n">T_isothermal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">*</span> <span class="n">T_0</span>
    <span class="n">p_isothermal</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">T_isothermal</span>

    <span class="c1"># Adiabatic: p V^γ = const</span>
    <span class="n">p_adiabatic</span> <span class="o">=</span> <span class="n">n_0</span> <span class="o">*</span> <span class="n">T_0</span> <span class="o">*</span> <span class="p">(</span><span class="n">V_0</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="n">gamma</span>
    <span class="n">T_adiabatic</span> <span class="o">=</span> <span class="n">p_adiabatic</span> <span class="o">/</span> <span class="n">n</span>

    <span class="c1"># Plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Temperature vs. compression</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="n">V_0</span><span class="p">,</span> <span class="n">T_isothermal</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Isothermal&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="n">V_0</span><span class="p">,</span> <span class="n">T_adiabatic</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Adiabatic (γ=5/3)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;V / V₀&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature Evolution under Compression&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Pressure vs. density</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">n_0</span><span class="p">,</span> <span class="n">p_isothermal</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Isothermal (p ∝ n)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">n_0</span><span class="p">,</span> <span class="n">p_adiabatic</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Adiabatic (p ∝ n^γ)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n / n₀&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;p / (n₀ T₀)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pressure vs. Density&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;closure_comparison.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># At 50% compression</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="n">V_0</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">At 50</span><span class="si">% c</span><span class="s2">ompression (V = 0.5 V₀):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Density: </span><span class="si">{</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">n_0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> n₀&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Isothermal:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    T = </span><span class="si">{</span><span class="n">T_isothermal</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (unchanged)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    p = </span><span class="si">{</span><span class="n">p_isothermal</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (n₀ T₀)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Adiabatic:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    T = </span><span class="si">{</span><span class="n">T_adiabatic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    p = </span><span class="si">{</span><span class="n">p_adiabatic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">n_0</span><span class="o">*</span><span class="n">T_0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (n₀ T₀)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Pressure ratio (adiabatic/isothermal): </span><span class="si">{</span><span class="n">p_adiabatic</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">p_isothermal</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">compare_closures</span><span class="p">()</span>
</code></pre></div>

<h2 id="_2">요약<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>이 수업에서 우리는 Vlasov 방정식의 속도 공간 모멘트를 취하여 이유체 모델을 유도했습니다. 핵심 포인트:</p>
<ol>
<li>
<p><strong>모멘트 계층</strong>: 각 모멘트 방정식은 다음 고차 모멘트를 도입하여 닫힘 문제를 야기합니다.</p>
</li>
<li>
<p><strong>닫힘 모델</strong>: 등온, 단열, CGL 닫힘은 다른 물리적 가정으로 계층을 절단합니다.</p>
</li>
<li>
<p><strong>일반화된 Ohm의 법칙</strong>: 완전한 형태는 저항, Hall, 전자 압력, 전자 관성 항을 포함합니다. 각 항은 다른 길이 스케일에서 중요해집니다:</p>
</li>
<li>저항: 낮은 $R_m$ (충돌 플라즈마)</li>
<li>Hall: $L \sim d_i$ (이온 skin depth)</li>
<li>전자 압력: 급격한 경사</li>
<li>
<p>전자 관성: $L \sim d_e$ (전자 skin depth)</p>
</li>
<li>
<p><strong>Hall 효과</strong>: $\lesssim d_i$ 스케일에서, 이온은 자기장으로부터 분리되지만 전자는 동결된 상태로 남습니다. 이는 빠른 자기 재결합과 whistler 파동 전파를 가능하게 합니다.</p>
</li>
<li>
<p><strong>반자성 표류</strong>: 압력 경사에서 발생하는 유체 표류로, 단일 입자 표류가 아닙니다. 전류 $\mathbf{J}_* = \mathbf{B} \times \nabla p / B^2$를 만듭니다.</p>
</li>
<li>
<p><strong>이유체 파동</strong>: Hall MHD는 작은 스케일에서 Alfvén 파동을 whistler 파동으로 수정합니다. Kinetic Alfvén 파동은 유한-$k_\perp$ 효과를 포함합니다.</p>
</li>
</ol>
<p>이유체 모델은 단일 입자 운동 이론과 단일 유체 MHD 사이의 간격을 메웁니다. 이상적 MHD에서 놓치지만 운동 이론의 완전한 복잡성을 필요로 하지 않는 중간 스케일(이온 gyroradius에서 이온 skin depth까지)에서 중요한 물리를 포착합니다.</p>
<h2 id="_3">연습 문제<a class="header-link" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="1">문제 1: 모멘트 계산<a class="header-link" href="#1" title="Permanent link">&para;</a></h3>
<p>Vlasov 방정식에서 시작하여, 2차 모멘트(에너지 방정식)을 명시적으로 유도하십시오. 열유속 $\mathbf{q}_s = \frac{1}{2} m_s \int w^2 \mathbf{w} f_s d^3v$가 나타남을 보이십시오. 열유속은 어떤 물리적 과정을 나타냅니까?</p>
<h3 id="2-hall-mhd">문제 2: Hall MHD 분산<a class="header-link" href="#2-hall-mhd" title="Permanent link">&para;</a></h3>
<p>Hall MHD에서 whistler 파동에 대한 분산 관계를 유도하십시오:
$$\omega = \frac{k_\parallel^2 V_A^2}{\omega_{ci}}$$
Hall 항을 가진 이유체 방정식에서 시작하여, $\omega \ll \omega_{ce}$와 $\omega \gg \omega_{ci}$를 가정하고, 냉 플라즈마 근사($p = 0$)를 사용하십시오.</p>
<h3 id="3">문제 3: 토카막의 반자성 전류<a class="header-link" href="#3" title="Permanent link">&para;</a></h3>
<p>주반경 $R_0 = 3$ m, 부반경 $a = 1$ m인 토카막에서, 전자 압력 프로파일은:
$$p_e(r) = p_0 \left(1 - \frac{r^2}{a^2}\right)^2$$
$p_0 = 5 \times 10^5$ Pa입니다. 토로이달 자기장은 $B_\phi = 5$ T입니다. 계산:
(a) $r = a/2$에서 반자성 전류 밀도.
(b) 반자성 효과로부터의 총 폴로이달 전류(단면에 대해 $J_\theta$ 적분).
(c) 이것을 bootstrap 전류와 비교(유사한 프로파일을 가짐).</p>
<h3 id="4-ohm">문제 4: 전류 시트에서의 일반화된 Ohm의 법칙<a class="header-link" href="#4-ohm" title="Permanent link">&para;</a></h3>
<p>자기 재결합 전류 시트에서, 길이 스케일은 $L = 10 d_i$이고, 여기서 $d_i = 100$ km는 이온 skin depth입니다. 플라즈마 밀도는 $n = 10^7$ m$^{-3}$ (태양풍), 전자 온도 $T_e = 100$ eV, 자기장 $B = 10$ nT입니다. 다음의 상대적 크기 계산:
(a) 이상적 MHD 항 $\mathbf{v} \times \mathbf{B}$
(b) Hall 항 $\mathbf{J} \times \mathbf{B} / (en)$
(c) 전자 압력 항 $\nabla p_e / (en)$
(d) 전자 관성 항
이 전류 시트에서 어떤 항이 중요합니까?</p>
<h3 id="5_1">문제 5: 이유체 불안정성<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>$T_e = T_i$이고 자기장 $\mathbf{B} = B_0 \hat{\mathbf{z}}$에서 밀도 경사 $\nabla n = -n_0 / L_n \hat{\mathbf{x}}$를 가진 이유체 플라즈마를 고려하십시오.
(a) 전자와 이온 반자성 표류 속도를 계산하십시오.
(b) 드리프트 파동 불안정성은 밀도와 전위 섭동 사이의 위상차가 파동 성장을 야기할 때 발생합니다. 연속 방정식과 준중성을 사용하여, 정전 드리프트 파동이 분산 관계를 가짐을 보이십시오:
$$\omega = \frac{k_y k_B T_e}{e B_0 L_n}$$
여기서 $k_y$는 $\mathbf{B}$와 $\nabla n$ 모두에 수직인 파수입니다.
(c) $L_n = 1$ cm, $T_e = 1$ eV, $B_0 = 0.1$ T, $k_y = 100$ m$^{-1}$에 대해, 드리프트 파동 주파수를 계산하십시오.</p>
<hr />
<p><strong>이전</strong>: <a href="./12_Wave_Heating_and_Instabilities.md">Wave Heating and Instabilities</a> | <strong>다음</strong>: <a href="./14_From_Kinetic_to_MHD.md">From Kinetic to MHD</a></p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Plasma_Physics/12_Wave_Heating_and_Instabilities.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">12. 파동 가열과 불안정성</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">🔗</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Plasma_Physics/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">📋</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Plasma_Physics/14_From_Kinetic_to_MHD.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">14. From Kinetic to MHD</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">↑</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}