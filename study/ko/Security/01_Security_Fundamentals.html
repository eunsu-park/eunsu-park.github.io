{% raw %}
<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security ê¸°ì´ˆì™€ Threat Modeling - Study Materials</title>
    <link rel="stylesheet" href="/study/static/css/style.css">
    <link rel="stylesheet" href="/study/static/css/highlight.css">
    <!-- KaTeX for LaTeX math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });"></script>
    
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/study/ko/" class="logo">Study Materials</a>
                <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                    <span></span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <a href="/study/ko/" class="nav-item ">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/study/examples/" class="nav-item ">
                    <span class="nav-icon">ğŸ’»</span>
                    <span class="nav-text">Examples</span>
                </a>
            </nav>

            <div class="sidebar-search">
                <form action="/study/ko/search.html" method="get" id="search-form">
                    <input type="search" name="q" placeholder="Search..." id="search-sidebar-input">
                </form>
            </div>

            <!-- Language Selector -->
            <div class="sidebar-lang">
                <select id="lang-select" class="lang-selector" onchange="switchLanguage(this.value)">
                    
                    <option value="en" >
                        English
                    </option>
                    
                    <option value="ko" selected>
                        í•œêµ­ì–´
                    </option>
                    
                </select>
            </div>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <span class="theme-icon light">â˜€ï¸</span>
                    <span class="theme-icon dark">ğŸŒ™</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" id="menu-toggle" aria-label="Open menu">
                    <span></span>
                </button>
                
<nav class="breadcrumb">
    <a href="/study/ko/">Topics</a>
    <span class="separator">/</span>
    <a href="/study/ko/Security/">Security</a>
    <span class="separator">/</span>
    <span class="current">Security ê¸°ì´ˆì™€ Threat Modeling</span>
</nav>

            </header>

            <div class="content">
                
<article class="lesson-article">
    <header class="lesson-header">
        <h1>Security ê¸°ì´ˆì™€ Threat Modeling</h1>
    </header>

    
<div class="lesson-toolbar lesson-toolbar--top">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Security</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/02_Cryptography_Basics.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Cryptography ê¸°ì´ˆ</span>
        </a>
        
    </div>
</div>


    
    <nav class="toc" id="toc">
        <h2>Table of Contents</h2>
        <div class="toc">
<ul>
<li><a href="#_1">ëª©ì°¨</a></li>
<li><a href="#1-cia-triad">1. CIA Triad</a><ul>
<li><a href="#11-confidentiality">1.1 Confidentiality (ê¸°ë°€ì„±)</a></li>
<li><a href="#12-integrity">1.2 Integrity (ë¬´ê²°ì„±)</a></li>
<li><a href="#13-availability">1.3 Availability (ê°€ìš©ì„±)</a></li>
<li><a href="#14-cia">1.4 CIA íŠ¸ë ˆì´ë“œì˜¤í”„</a></li>
</ul>
</li>
<li><a href="#2">2. í™•ì¥ëœ ë³´ì•ˆ ì†ì„±</a><ul>
<li><a href="#21">2.1 ì¸ì¦ ìš”ì†Œ</a></li>
</ul>
</li>
<li><a href="#3-stride-threat-modeling">3. STRIDEë¥¼ ì‚¬ìš©í•œ Threat Modeling</a><ul>
<li><a href="#31-stride">3.1 STRIDE ë¶„ì„ í”„ë¡œì„¸ìŠ¤</a></li>
<li><a href="#32-data-flow-diagram">3.2 Data Flow Diagram ìš”ì†Œ</a></li>
<li><a href="#33">3.3 ì˜ˆì‹œ: ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ„í˜‘ ëª¨ë¸</a></li>
</ul>
</li>
<li><a href="#4-dread">4. DREADë¥¼ ì‚¬ìš©í•œ ìœ„í—˜ ì ìˆ˜í™”</a></li>
<li><a href="#5">5. ê³µê²© í‘œë©´ê³¼ ìœ„í˜‘ ë²¡í„°</a><ul>
<li><a href="#51">5.1 ê³µê²© í‘œë©´ì´ë€?</a></li>
<li><a href="#52">5.2 ê³µê²© í‘œë©´ ì—´ê±°</a></li>
<li><a href="#53">5.3 ì¼ë°˜ì ì¸ ìœ„í˜‘ ë²¡í„°</a></li>
</ul>
</li>
<li><a href="#6-defense-in-depth">6. Defense in Depth</a><ul>
<li><a href="#61">6.1 ê³„ì¸µí™”ëœ ë³´ì•ˆ êµ¬í˜„</a></li>
</ul>
</li>
<li><a href="#7">7. ìµœì†Œ ê¶Œí•œ ì›ì¹™</a><ul>
<li><a href="#71">7.1 ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ì—ì„œì˜ ìµœì†Œ ê¶Œí•œ</a></li>
<li><a href="#72">7.2 ì½”ë“œì—ì„œì˜ ìµœì†Œ ê¶Œí•œ</a></li>
<li><a href="#73-aws-iam">7.3 í´ë¼ìš°ë“œì—ì„œì˜ ìµœì†Œ ê¶Œí•œ (AWS IAM ì˜ˆì‹œ)</a></li>
</ul>
</li>
<li><a href="#8-security-by-design-vs-security-by-obscurity">8. Security by Design vs Security by Obscurity</a><ul>
<li><a href="#81-security-by-design">8.1 Security by Design</a></li>
<li><a href="#82-security-by-obscurity">8.2 Security by Obscurity (ê·¸ë¦¬ê³  ì‹¤íŒ¨í•˜ëŠ” ì´ìœ )</a></li>
</ul>
</li>
<li><a href="#9">9. ìœ„í—˜ í‰ê°€ í”„ë ˆì„ì›Œí¬</a><ul>
<li><a href="#91">9.1 ì •ì„±ì  ìœ„í—˜ í‰ê°€</a></li>
<li><a href="#92">9.2 ì½”ë“œë¡œ í•˜ëŠ” ìœ„í—˜ í‰ê°€</a></li>
<li><a href="#93">9.3 ì£¼ìš” ìœ„í—˜ í”„ë ˆì„ì›Œí¬</a></li>
</ul>
</li>
<li><a href="#10-common-vulnerability-scoring-systemcvss">10. Common Vulnerability Scoring System(CVSS)</a><ul>
<li><a href="#101-cvss-v31-v40">10.1 CVSS v3.1 / v4.0 ë©”íŠ¸ë¦­</a></li>
<li><a href="#102-cvss">10.2 CVSS ì ìˆ˜ ê³„ì‚°ê¸°</a></li>
</ul>
</li>
<li><a href="#11">11. ì¢…í•© ì˜ˆì œ</a><ul>
<li><a href="#111">11.1 ì‹œìŠ¤í…œ ì„¤ëª…</a></li>
<li><a href="#112-stride">11.2 STRIDE ìœ„í˜‘ ìš”ì•½</a></li>
<li><a href="#113-defense-in-depth">11.3 ì ìš©ëœ Defense in Depth</a></li>
<li><a href="#114">11.4 ì ìš©ëœ ìµœì†Œ ê¶Œí•œ</a></li>
</ul>
</li>
<li><a href="#12">12. ì—°ìŠµ ë¬¸ì œ</a><ul>
<li><a href="#1-cia">ì—°ìŠµ 1: CIA ë¶„ì„ (ì´ˆê¸‰)</a></li>
<li><a href="#2-stride-threat-model">ì—°ìŠµ 2: STRIDE Threat Model (ì¤‘ê¸‰)</a></li>
<li><a href="#3-cvss">ì—°ìŠµ 3: CVSS ì ìˆ˜í™” (ì¤‘ê¸‰)</a></li>
<li><a href="#4-defense-in-depth">ì—°ìŠµ 4: Defense in Depth ì„¤ê³„ (ê³ ê¸‰)</a></li>
<li><a href="#5_1">ì—°ìŠµ 5: ìµœì†Œ ê¶Œí•œ ê°ì‚¬ (ê³ ê¸‰)</a></li>
<li><a href="#6-security-by-design">ì—°ìŠµ 6: Security by Design ê²€í†  (ê³ ê¸‰)</a></li>
</ul>
</li>
<li><a href="#13">13. ì°¸ê³  ìë£Œ</a></li>
<li><a href="#_2">ë‹¤ìŒ ë ˆìŠ¨</a></li>
</ul>
</div>

    </nav>
    

    <div class="lesson-content markdown-body">
        <h1 id="security-threat-modeling">Security ê¸°ì´ˆì™€ Threat Modeling<a class="header-link" href="#security-threat-modeling" title="Permanent link">&para;</a></h1>
<p><strong>ë‹¤ìŒ</strong>: <a href="./02_Cryptography_Basics.md">02. Cryptography ê¸°ì´ˆ</a></p>
<hr />
<p>ë³´ì•ˆ ì—”ì§€ë‹ˆì–´ë§ì€ ì•…ì˜, ì˜¤ë¥˜, ì‚¬ê³ ì— ì§ë©´í•˜ì—¬ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” í•™ë¬¸ì…ë‹ˆë‹¤. ì•”í˜¸í•™ì´ë‚˜ TLS ê°™ì€ êµ¬ì²´ì ì¸ ê¸°ìˆ ì— ë“¤ì–´ê°€ê¸° ì „ì—, ìœ„í˜‘, ìœ„í—˜, ë°©ì–´ì— ëŒ€í•´ ë…¼ì˜í•˜ê¸° ìœ„í•œ ê³µí†µëœ ìš©ì–´ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ ë ˆìŠ¨ì€ ëª¨ë“  í›„ì† ë ˆìŠ¨ì´ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ê°œë…ì  ê¸°ì´ˆë¥¼ í™•ë¦½í•©ë‹ˆë‹¤.</p>
<p><strong>ë‚œì´ë„</strong>: â­â­</p>
<p><strong>í•™ìŠµ ëª©í‘œ</strong>:
- CIA Triadì™€ í™•ì¥ëœ ë³´ì•ˆ ì†ì„± ì´í•´í•˜ê¸°
- ì‹¤ì œ ì‹œìŠ¤í…œì— Threat Modeling ë°©ë²•ë¡ (STRIDE, DREAD) ì ìš©í•˜ê¸°
- ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…ì²˜ì—ì„œ ê³µê²© í‘œë©´ê³¼ ìœ„í˜‘ ë²¡í„° ì‹ë³„í•˜ê¸°
- Defense-in-depth ì›ì¹™ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì¸µì  ë°©ì–´ ì„¤ê³„í•˜ê¸°
- ì‹œìŠ¤í…œ ì„¤ê³„ì—ì„œ ìµœì†Œ ê¶Œí•œ ì›ì¹™ ì ìš©í•˜ê¸°
- Security by designê³¼ security by obscurity êµ¬ë³„í•˜ê¸°
- í‘œì¤€ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ ìœ„í—˜ í‰ê°€ ìˆ˜í–‰í•˜ê¸°
- Common Vulnerability Scoring System(CVSS) ì ìˆ˜ í•´ì„í•˜ê¸°</p>
<hr />
<h2 id="_1">ëª©ì°¨<a class="header-link" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-cia-triad">CIA Triad</a></li>
<li><a href="#2-í™•ì¥ëœ-ë³´ì•ˆ-ì†ì„±">í™•ì¥ëœ ë³´ì•ˆ ì†ì„±</a></li>
<li><a href="#3-strideë¥¼-ì‚¬ìš©í•œ-threat-modeling">STRIDEë¥¼ ì‚¬ìš©í•œ Threat Modeling</a></li>
<li><a href="#4-dreadë¥¼-ì‚¬ìš©í•œ-ìœ„í—˜-ì ìˆ˜í™”">DREADë¥¼ ì‚¬ìš©í•œ ìœ„í—˜ ì ìˆ˜í™”</a></li>
<li><a href="#5-ê³µê²©-í‘œë©´ê³¼-ìœ„í˜‘-ë²¡í„°">ê³µê²© í‘œë©´ê³¼ ìœ„í˜‘ ë²¡í„°</a></li>
<li><a href="#6-defense-in-depth">Defense in Depth</a></li>
<li><a href="#7-ìµœì†Œ-ê¶Œí•œ-ì›ì¹™">ìµœì†Œ ê¶Œí•œ ì›ì¹™</a></li>
<li><a href="#8-security-by-design-vs-security-by-obscurity">Security by Design vs Security by Obscurity</a></li>
<li><a href="#9-ìœ„í—˜-í‰ê°€-í”„ë ˆì„ì›Œí¬">ìœ„í—˜ í‰ê°€ í”„ë ˆì„ì›Œí¬</a></li>
<li><a href="#10-common-vulnerability-scoring-systemcvss">Common Vulnerability Scoring System(CVSS)</a></li>
<li><a href="#11-ì¢…í•©-ì˜ˆì œ">ì¢…í•© ì˜ˆì œ</a></li>
<li><a href="#12-ì—°ìŠµ-ë¬¸ì œ">ì—°ìŠµ ë¬¸ì œ</a></li>
<li><a href="#13-ì°¸ê³ -ìë£Œ">ì°¸ê³  ìë£Œ</a></li>
</ol>
<hr />
<h2 id="1-cia-triad">1. CIA Triad<a class="header-link" href="#1-cia-triad" title="Permanent link">&para;</a></h2>
<p>CIA TriadëŠ” ì •ë³´ ë³´ì•ˆì—ì„œ ê°€ì¥ ê¸°ë³¸ì ì¸ ëª¨ë¸ì…ë‹ˆë‹¤. ëª¨ë“  ë³´ì•ˆ ì œì–´, ëª¨ë“  ê³µê²©, ëª¨ë“  ìœ„í—˜ì€ ì´ ì„¸ ê°€ì§€ ì†ì„±ì„ í†µí•´ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   Confidentiality     â”‚
                         â”‚                       â”‚
                         â”‚   &quot;ëˆ„ê°€ ë³¼ ìˆ˜ ìˆë‚˜?&quot;    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
                    â–¼                â–¼                â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    Integrity    â”‚              â”‚  Availability   â”‚
          â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚
          â”‚ &quot;ì‹ ë¢°í•  ìˆ˜       â”‚              â”‚ &quot;í•„ìš”í•  ë•Œ      â”‚
          â”‚  ìˆë‚˜?&quot;         â”‚              â”‚  ì ‘ê·¼í•  ìˆ˜      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  ìˆë‚˜?&quot;         â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="11-confidentiality">1.1 Confidentiality (ê¸°ë°€ì„±)<a class="header-link" href="#11-confidentiality" title="Permanent link">&para;</a></h3>
<p>ConfidentialityëŠ” ì •ë³´ê°€ ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ” ì‚¬ëŒë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ê¸°ë°€ì„± ì¹¨í•´ëŠ” ì •ë³´ì˜ ë¬´ë‹¨ ê³µê°œë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
<p><strong>ê¸°ë°€ì„±ì— ëŒ€í•œ ìœ„í˜‘:</strong>
- ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ë„ì²­(íŒ¨í‚· ìŠ¤ë‹ˆí•‘)
- ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ë¬´ë‹¨ ì ‘ê·¼
- Social engineering(í”¼ì‹±)
- Shoulder surfing, ì“°ë ˆê¸°í†µ ë’¤ì§€ê¸°
- ë‚´ë¶€ì ìœ„í˜‘</p>
<p><strong>ê¸°ë°€ì„±ì„ ìœ„í•œ ì œì–´:</strong>
- ì•”í˜¸í™”(ì €ì¥ ë°ì´í„° ë° ì „ì†¡ ë°ì´í„°)
- Access control lists(ACL)
- ì¸ì¦ ë©”ì»¤ë‹ˆì¦˜
- ë°ì´í„° ë¶„ë¥˜ ë° ì²˜ë¦¬ ì •ì±…
- ë¬¼ë¦¬ì  ë³´ì•ˆ ì œì–´</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Example: Demonstrating confidentiality through encryption</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.fernet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fernet</span>

<span class="c1"># Generate a secret key (only authorized parties should have this)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># Sensitive data</span>
<span class="n">secret_message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Patient diagnosis: confidential medical record&quot;</span>

<span class="c1"># Encrypt - now only key holders can read this</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">secret_message</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted: </span><span class="si">{</span><span class="n">encrypted</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="c1"># Decrypt - requires the key</span>
<span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Without the key, the data is meaningless</span>
<span class="n">wrong_key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span>
<span class="n">wrong_cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">wrong_key</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">wrong_cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unauthorized access denied: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="12-integrity">1.2 Integrity (ë¬´ê²°ì„±)<a class="header-link" href="#12-integrity" title="Permanent link">&para;</a></h3>
<p>IntegrityëŠ” ì •ë³´ê°€ ë¬´ë‹¨ìœ¼ë¡œ ë³€ê²½ë˜ì§€ ì•Šì•˜ìŒì„ ë³´ì¥í•©ë‹ˆë‹¤. ë°ì´í„°ëŠ” ì •í™•í•˜ê³  ì¼ê´€ë˜ë©° ì‹ ë¢°í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>
<p><strong>ë¬´ê²°ì„±ì— ëŒ€í•œ ìœ„í˜‘:</strong>
- Man-in-the-middle(MITM) ê³µê²©
- SQL injectionìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ë ˆì½”ë“œ ìˆ˜ì •
- íŒŒì¼ì„ ë³€ê²½í•˜ëŠ” ì•…ì„± ì½”ë“œ
- ë¬´ë‹¨ êµ¬ì„± ë³€ê²½
- Bit-rot ë˜ëŠ” ì €ì¥ì†Œ ì†ìƒ</p>
<p><strong>ë¬´ê²°ì„±ì„ ìœ„í•œ ì œì–´:</strong>
- ì•”í˜¸í™” í•´ì‹œ í•¨ìˆ˜(SHA-256)
- ë””ì§€í„¸ ì„œëª…
- Message Authentication Codes(MAC/HMAC)
- ë²„ì „ ì œì–´ ì‹œìŠ¤í…œ
- ë°ì´í„°ë² ì´ìŠ¤ ì œì•½ ì¡°ê±´ ë° íŠ¸ëœì­ì…˜</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_integrity_hash</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a SHA-256 hash of structured data for integrity verification.&quot;&quot;&quot;</span>
    <span class="c1"># Canonical JSON encoding ensures consistent hashing</span>
    <span class="n">canonical</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">canonical</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="c1"># Original financial record</span>
<span class="n">record</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;account&quot;</span><span class="p">:</span> <span class="s2">&quot;ACCT-001&quot;</span><span class="p">,</span>
    <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">1500.00</span><span class="p">,</span>
    <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2026-01-15T10:30:00Z&quot;</span>
<span class="p">}</span>

<span class="n">original_hash</span> <span class="o">=</span> <span class="n">compute_integrity_hash</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original hash: </span><span class="si">{</span><span class="n">original_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Verify integrity - unchanged data</span>
<span class="n">verified_hash</span> <span class="o">=</span> <span class="n">compute_integrity_hash</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verification:  </span><span class="si">{</span><span class="n">verified_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Integrity OK:  </span><span class="si">{</span><span class="n">original_hash</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">verified_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Tampered record - even a tiny change completely changes the hash</span>
<span class="n">tampered</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">tampered</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1500.01</span>  <span class="c1"># Changed by $0.01</span>
<span class="n">tampered_hash</span> <span class="o">=</span> <span class="n">compute_integrity_hash</span><span class="p">(</span><span class="n">tampered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tampered hash: </span><span class="si">{</span><span class="n">tampered_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Integrity OK:  </span><span class="si">{</span><span class="n">original_hash</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">tampered_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># False</span>
</code></pre></div>

<h3 id="13-availability">1.3 Availability (ê°€ìš©ì„±)<a class="header-link" href="#13-availability" title="Permanent link">&para;</a></h3>
<p>AvailabilityëŠ” ì •ë³´ì™€ ì‹œìŠ¤í…œì´ ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìê°€ í•„ìš”í•  ë•Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.</p>
<p><strong>ê°€ìš©ì„±ì— ëŒ€í•œ ìœ„í˜‘:</strong>
- Distributed Denial of Service(DDoS) ê³µê²©
- í•˜ë“œì›¨ì–´ ì¥ì• 
- ì†Œí”„íŠ¸ì›¨ì–´ ë²„ê·¸ ë° í¬ë˜ì‹œ
- ìì—° ì¬í•´
- ëœì„¬ì›¨ì–´</p>
<p><strong>ê°€ìš©ì„±ì„ ìœ„í•œ ì œì–´:</strong>
- ì´ì¤‘í™” ë° ì¥ì•  ì¡°ì¹˜ ì‹œìŠ¤í…œ
- ë¡œë“œ ë°¸ëŸ°ì‹±
- ì •ê¸° ë°±ì—… ë° ì¬í•´ ë³µêµ¬ ê³„íš
- DDoS ì™„í™” ì„œë¹„ìŠ¤
- ìš©ëŸ‰ ê³„íš ë° ëª¨ë‹ˆí„°ë§</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Example: Simple health check and availability monitor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ServiceHealthCheck</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor service availability.&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">endpoints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">check_history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate checking an endpoint&#39;s availability.&quot;&quot;&quot;</span>
        <span class="c1"># In production, this would make actual HTTP requests</span>
        <span class="n">is_up</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.1</span>  <span class="c1"># 90% uptime simulation</span>
        <span class="n">latency_ms</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_up</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;UP&quot;</span> <span class="k">if</span> <span class="n">is_up</span> <span class="k">else</span> <span class="s2">&quot;DOWN&quot;</span><span class="p">,</span>
            <span class="s2">&quot;latency_ms&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">latency_ms</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">latency_ms</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check all endpoints and compute availability.&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">check_endpoint</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span> <span class="k">for</span> <span class="n">ep</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">]</span>
        <span class="n">up_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UP&quot;</span><span class="p">)</span>
        <span class="n">availability</span> <span class="o">=</span> <span class="n">up_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;total_endpoints&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
            <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="n">up_count</span><span class="p">,</span>
            <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">-</span> <span class="n">up_count</span><span class="p">,</span>
            <span class="s2">&quot;availability_pct&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">availability</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="n">results</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">summary</span>

<span class="c1"># Define service endpoints</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">ServiceHealthCheck</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Payment API&quot;</span><span class="p">,</span>
    <span class="n">endpoints</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;https://api.example.com/v1/health&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://api-backup.example.com/v1/health&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://api-eu.example.com/v1/health&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Run health check</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">check_all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Availability: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;availability_pct&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]:</span>
    <span class="n">status_icon</span> <span class="o">=</span> <span class="s2">&quot;[OK]&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UP&quot;</span> <span class="k">else</span> <span class="s2">&quot;[!!]&quot;</span>
    <span class="n">latency</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;latency_ms&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">ms&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;latency_ms&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">status_icon</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">latency</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="14-cia">1.4 CIA íŠ¸ë ˆì´ë“œì˜¤í”„<a class="header-link" href="#14-cia" title="Permanent link">&para;</a></h3>
<p>ì‹¤ì œë¡œëŠ” ì„¸ ê°€ì§€ ì†ì„±ì´ ì¢…ì¢… ì„œë¡œ ê¸´ì¥ ê´€ê³„ì— ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CIA íŠ¸ë ˆì´ë“œì˜¤í”„ ì˜ˆì‹œ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì‹œë‚˜ë¦¬ì˜¤         â”‚ íŠ¸ë ˆì´ë“œì˜¤í”„                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì „ì²´ ë””ìŠ¤í¬      â”‚ Confidentiality â†‘  Availability â†“              â”‚
â”‚ ì•”í˜¸í™”           â”‚ (ë³µí˜¸í™”ê°€ ì§€ì—° ì¶”ê°€; í‚¤ ë¶„ì‹¤ = ë°ì´í„° ì—†ìŒ)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë°ì´í„°ë² ì´ìŠ¤     â”‚ Integrity â†‘  Availability â†“                    â”‚
â”‚ ë³µì œ             â”‚ (ë™ê¸° ë³µì œê°€ ì“°ê¸° ì†ë„ ì €í•˜)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì¸ì¦ ì—†ëŠ”        â”‚ Availability â†‘  Confidentiality â†“              â”‚
â”‚ ê³µê°œ API         â”‚ (ëˆ„êµ¬ë‚˜ ì ‘ê·¼ ê°€ëŠ¥; ìµœëŒ€ ê°€ìš©ì„±)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Air-gapped       â”‚ Confidentiality â†‘  Availability â†“              â”‚
â”‚ ë„¤íŠ¸ì›Œí¬         â”‚ (ë§¤ìš° ì•ˆì „í•˜ì§€ë§Œ ì›ê²© ì ‘ê·¼ ì–´ë ¤ì›€)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="2">2. í™•ì¥ëœ ë³´ì•ˆ ì†ì„±<a class="header-link" href="#2" title="Permanent link">&para;</a></h2>
<p>CIA Triadë¥¼ ë„˜ì–´ì„œ, ì™„ì „í•œ ë³´ì•ˆ ëª¨ë¸ì„ ìœ„í•´ ëª‡ ê°€ì§€ ì¶”ê°€ ì†ì„±ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     í™•ì¥ëœ ë³´ì•ˆ ì†ì„±                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Authentication        &quot;ë‹¹ì‹ ì€ ë‹¹ì‹ ì´ ì£¼ì¥í•˜ëŠ” ì‚¬ëŒì¸ê°€?&quot;            â”‚
â”‚  â”œâ”€â”€ ì•Œê³  ìˆëŠ” ê²ƒ (ë¹„ë°€ë²ˆí˜¸, PIN)                                   â”‚
â”‚  â”œâ”€â”€ ê°€ì§€ê³  ìˆëŠ” ê²ƒ (í† í°, ìŠ¤ë§ˆíŠ¸ ì¹´ë“œ, ì „í™”)                        â”‚
â”‚  â””â”€â”€ ìì‹ ì¸ ê²ƒ (ì§€ë¬¸, ì–¼êµ´, í™ì±„)                                   â”‚
â”‚                                                                     â”‚
â”‚  Authorization         &quot;ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ê°€?&quot;                        â”‚
â”‚  â”œâ”€â”€ Role-Based Access Control (RBAC)                               â”‚
â”‚  â”œâ”€â”€ Attribute-Based Access Control (ABAC)                          â”‚
â”‚  â””â”€â”€ Mandatory Access Control (MAC)                                 â”‚
â”‚                                                                     â”‚
â”‚  Non-repudiation       &quot;ì´ í–‰ìœ„ë¥¼ ë¶€ì¸í•  ìˆ˜ ìˆëŠ”ê°€?&quot;                 â”‚
â”‚  â”œâ”€â”€ ë””ì§€í„¸ ì„œëª…                                                     â”‚
â”‚  â”œâ”€â”€ ë³€ì¡° ë°©ì§€ ì €ì¥ì†Œê°€ ìˆëŠ” ê°ì‚¬ ë¡œê·¸                               â”‚
â”‚  â””â”€â”€ ë¸”ë¡ì²´ì¸ ê¸°ë°˜ ê¸°ë¡                                              â”‚
â”‚                                                                     â”‚
â”‚  Accountability        &quot;í–‰ìœ„ë¥¼ í–‰ìœ„ìê¹Œì§€ ì¶”ì í•  ìˆ˜ ìˆëŠ”ê°€?&quot;         â”‚
â”‚  â”œâ”€â”€ í¬ê´„ì ì¸ ë¡œê¹…                                                   â”‚
â”‚  â”œâ”€â”€ ì„¸ì…˜ ì¶”ì                                                        â”‚
â”‚  â””â”€â”€ í¬ë Œì‹ ë¶„ì„ ê¸°ëŠ¥                                                â”‚
â”‚                                                                     â”‚
â”‚  Privacy               &quot;ê°œì¸ ë°ì´í„°ê°€ ì ì ˆíˆ ë³´í˜¸ë˜ëŠ”ê°€?&quot;            â”‚
â”‚  â”œâ”€â”€ ë°ì´í„° ìµœì†Œí™”                                                   â”‚
â”‚  â”œâ”€â”€ ëª©ì  ì œí•œ                                                       â”‚
â”‚  â””â”€â”€ ë™ì˜ ê´€ë¦¬ (GDPR, CCPA)                                         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="21">2.1 ì¸ì¦ ìš”ì†Œ<a class="header-link" href="#21" title="Permanent link">&para;</a></h3>
<p>Multi-factor authentication(MFA)ì€ ë‘ ê°œ ì´ìƒì˜ ë…ë¦½ì ì¸ ìš”ì†Œë¥¼ ê²°í•©í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AuthFactor</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">KNOWLEDGE</span> <span class="o">=</span> <span class="s2">&quot;something_you_know&quot;</span>    <span class="c1"># Password, PIN</span>
    <span class="n">POSSESSION</span> <span class="o">=</span> <span class="s2">&quot;something_you_have&quot;</span>   <span class="c1"># TOTP token, smart card</span>
    <span class="n">INHERENCE</span> <span class="o">=</span> <span class="s2">&quot;something_you_are&quot;</span>     <span class="c1"># Biometric</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AuthenticationAttempt</span><span class="p">:</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">factors_provided</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SimpleAuthenticator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrates multi-factor authentication concepts.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_attempts</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lockout_duration</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># 5 minutes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register with salted password hash.&quot;&quot;&quot;</span>
        <span class="n">salt</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_hex</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">password_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span>
            <span class="p">(</span><span class="n">salt</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;salt&quot;</span><span class="p">:</span> <span class="n">salt</span><span class="p">,</span>
            <span class="s2">&quot;password_hash&quot;</span><span class="p">:</span> <span class="n">password_hash</span><span class="p">,</span>
            <span class="s2">&quot;totp_secret&quot;</span><span class="p">:</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_hex</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>  <span class="c1"># For MFA</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">verify_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify knowledge factor (password).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="c1"># Constant-time comparison to prevent user enumeration</span>
            <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;dummy_computation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
        <span class="n">computed</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span>
            <span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s2">&quot;salt&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">secrets</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">computed</span><span class="p">,</span> <span class="n">user</span><span class="p">[</span><span class="s2">&quot;password_hash&quot;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_locked_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if account is locked due to failed attempts.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attempts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_attempts</span><span class="p">:</span>
            <span class="n">last_attempt</span> <span class="o">=</span> <span class="n">attempts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_attempt</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockout_duration</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="c1"># Lockout expired, reset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attempt</span><span class="p">:</span> <span class="n">AuthenticationAttempt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process authentication attempt with multiple factors.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_locked_out</span><span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">username</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;Account locked. Try again later.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;factors_verified&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">}</span>

        <span class="n">factors_verified</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">attempt</span><span class="o">.</span><span class="n">factors_provided</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_password</span><span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]):</span>
                    <span class="n">factors_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">POSSESSION</span><span class="p">:</span>
                <span class="c1"># In production: verify TOTP code</span>
                <span class="n">factors_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AuthFactor</span><span class="o">.</span><span class="n">POSSESSION</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">factor</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">INHERENCE</span><span class="p">:</span>
                <span class="c1"># In production: verify biometric</span>
                <span class="n">factors_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AuthFactor</span><span class="o">.</span><span class="n">INHERENCE</span><span class="p">)</span>

        <span class="n">success</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">factors_verified</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>  <span class="c1"># Require at least 2 factors</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">attempt</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">success</span><span class="p">,</span>
            <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;MFA verified&quot;</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;Insufficient factors&quot;</span><span class="p">,</span>
            <span class="s2">&quot;factors_verified&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">factors_verified</span><span class="p">]</span>
        <span class="p">}</span>

<span class="c1"># Usage</span>
<span class="n">auth</span> <span class="o">=</span> <span class="n">SimpleAuthenticator</span><span class="p">()</span>
<span class="n">auth</span><span class="o">.</span><span class="n">register_user</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;correct-horse-battery-staple&quot;</span><span class="p">)</span>

<span class="c1"># Single factor - insufficient</span>
<span class="n">attempt_1fa</span> <span class="o">=</span> <span class="n">AuthenticationAttempt</span><span class="p">(</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span>
    <span class="n">factors_provided</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;correct-horse-battery-staple&quot;</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="n">ip_address</span><span class="o">=</span><span class="s2">&quot;192.168.1.100&quot;</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">attempt_1fa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1FA Result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># {&#39;success&#39;: False, &#39;reason&#39;: &#39;Insufficient factors&#39;, ...}</span>

<span class="c1"># Two factors - success</span>
<span class="n">attempt_2fa</span> <span class="o">=</span> <span class="n">AuthenticationAttempt</span><span class="p">(</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span>
    <span class="n">factors_provided</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">KNOWLEDGE</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;correct-horse-battery-staple&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">AuthFactor</span><span class="o">.</span><span class="n">POSSESSION</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;123456&quot;</span><span class="p">}</span>  <span class="c1"># TOTP code</span>
    <span class="p">],</span>
    <span class="n">ip_address</span><span class="o">=</span><span class="s2">&quot;192.168.1.100&quot;</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">attempt_2fa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2FA Result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># {&#39;success&#39;: True, &#39;reason&#39;: &#39;MFA verified&#39;, ...}</span>
</code></pre></div>

<hr />
<h2 id="3-stride-threat-modeling">3. STRIDEë¥¼ ì‚¬ìš©í•œ Threat Modeling<a class="header-link" href="#3-stride-threat-modeling" title="Permanent link">&para;</a></h2>
<p>STRIDEëŠ” Microsoftì—ì„œ ê°œë°œí•œ ìœ„í˜‘ ëª¨ë¸ë§ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. ê° ê¸€ìëŠ” íŠ¹ì • ë³´ì•ˆ ì†ì„± ìœ„ë°˜ê³¼ ë§¤í•‘ë˜ëŠ” ìœ„í˜‘ ë²”ì£¼ë¥¼ ì‹ë³„í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        STRIDE Threat Model                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ìœ„í˜‘           â”‚ ìœ„ë°˜ ì†ì„±            â”‚ ì˜ˆì‹œ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ S - Spoofing   â”‚ Authentication       â”‚ ê°€ì§œ ë¡œê·¸ì¸ í˜ì´ì§€,          â”‚
â”‚                â”‚                      â”‚ ìœ„ì¡°ëœ JWT í† í°              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ T - Tampering  â”‚ Integrity            â”‚ ìˆ˜ì •ëœ API ìš”ì²­,             â”‚
â”‚                â”‚                      â”‚ SQL injection                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R - Repudiationâ”‚ Non-repudiation      â”‚ íŠ¸ëœì­ì…˜ ë¶€ì¸,               â”‚
â”‚                â”‚                      â”‚ ë¡œê·¸ ì‚­ì œ                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ I - Informationâ”‚ Confidentiality      â”‚ ë°ì´í„° ìœ ì¶œ, íŒ¨í‚·            â”‚
â”‚   Disclosure   â”‚                      â”‚ ìŠ¤ë‹ˆí•‘, ì˜¤ë¥˜ ë©”ì‹œì§€          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ D - Denial of  â”‚ Availability         â”‚ DDoS, ë¦¬ì†ŒìŠ¤                 â”‚
â”‚   Service      â”‚                      â”‚ ê³ ê°ˆ, í¬ë˜ì‹œ ë²„ê·¸            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ E - Elevation  â”‚ Authorization        â”‚ ê¶Œí•œ ìƒìŠ¹,                   â”‚
â”‚   of Privilege â”‚                      â”‚ path traversal               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="31-stride">3.1 STRIDE ë¶„ì„ í”„ë¡œì„¸ìŠ¤<a class="header-link" href="#31-stride" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="mi">1</span><span class="err">ë‹¨ê³„</span><span class="o">:</span><span class="w"> </span><span class="err">ì‹œìŠ¤í…œ</span><span class="w"> </span><span class="err">ë¶„í•´</span>
<span class="w">         </span><span class="err">â”‚</span>
<span class="w">         </span><span class="err">â–¼</span>
<span class="mi">2</span><span class="err">ë‹¨ê³„</span><span class="o">:</span><span class="w"> </span><span class="n">Data</span><span class="w"> </span><span class="n">Flow</span><span class="w"> </span><span class="n">Diagram</span><span class="o">(</span><span class="n">DFD</span><span class="o">)</span><span class="w"> </span><span class="err">ìƒì„±</span>
<span class="w">         </span><span class="err">â”‚</span>
<span class="w">         </span><span class="err">â–¼</span>
<span class="mi">3</span><span class="err">ë‹¨ê³„</span><span class="o">:</span><span class="w"> </span><span class="err">ê°</span><span class="w"> </span><span class="err">ìš”ì†Œì—</span><span class="w"> </span><span class="n">STRIDEë¥¼</span><span class="w"> </span><span class="err">ì‚¬ìš©í•˜ì—¬</span><span class="w"> </span><span class="err">ìœ„í˜‘</span><span class="w"> </span><span class="err">ì‹ë³„</span>
<span class="w">         </span><span class="err">â”‚</span>
<span class="w">         </span><span class="err">â–¼</span>
<span class="mi">4</span><span class="err">ë‹¨ê³„</span><span class="o">:</span><span class="w"> </span><span class="err">ìœ„í˜‘</span><span class="w"> </span><span class="err">í‰ê°€</span><span class="w"> </span><span class="err">ë°</span><span class="w"> </span><span class="err">ìš°ì„ ìˆœìœ„</span><span class="w"> </span><span class="err">ì§€ì •</span>
<span class="w">         </span><span class="err">â”‚</span>
<span class="w">         </span><span class="err">â–¼</span>
<span class="mi">5</span><span class="err">ë‹¨ê³„</span><span class="o">:</span><span class="w"> </span><span class="err">ì™„í™”</span><span class="w"> </span><span class="err">ê³„íš</span><span class="w"> </span><span class="err">ìˆ˜ë¦½</span>
</code></pre></div>

<h3 id="32-data-flow-diagram">3.2 Data Flow Diagram ìš”ì†Œ<a class="header-link" href="#32-data-flow-diagram" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DFD ìš”ì†Œ íƒ€ì…                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    External Entity (ì‚¬ìš©ì, ì™¸ë¶€ ì‹œìŠ¤í…œ)           â”‚
â”‚  â”‚ Entity  â”‚    - ì‹ ë¢° ê²½ê³„ ì™¸ë¶€                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    - ë°ì´í„°ì˜ ì¶œë°œì§€ ë˜ëŠ” ëª©ì ì§€                   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Process (ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” ì½”ë“œ)                â”‚
â”‚  â”‚(Process)â”‚    - ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    - API, ì„œë¹„ìŠ¤, í•¨ìˆ˜                             â”‚
â”‚                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•    Data Store (ë°ì´í„°ë² ì´ìŠ¤, íŒŒì¼, ìºì‹œ)           â”‚
â”‚  â•‘ Store   â•‘    - ë°ì´í„°ê°€ ì§€ì†ë˜ëŠ” ê³³                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•    - ë°ì´í„°ë² ì´ìŠ¤, íŒŒì¼, í                        â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    Data Flow (ìš”ì†Œ ê°„ ë°ì´í„° ì´ë™)                 â”‚
â”‚                 - HTTP ìš”ì²­, API í˜¸ì¶œ, íŒŒì¼ ì½ê¸°                â”‚
â”‚                                                                 â”‚
â”‚  - - - - - -    Trust Boundary                                  â”‚
â”‚  |          |   - ì„œë¡œ ë‹¤ë¥¸ ì‹ ë¢° ìˆ˜ì¤€ì„ êµ¬ë¶„                     â”‚
â”‚  - - - - - -    - ë„¤íŠ¸ì›Œí¬ ê²½ê³„, í”„ë¡œì„¸ìŠ¤ ê²½ê³„                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="33">3.3 ì˜ˆì‹œ: ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ„í˜‘ ëª¨ë¸<a class="header-link" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ DFD                                 â”‚
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         HTTPS          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ Browser  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Web Server  â”‚              â”‚
â”‚   â”‚  (User)  â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (Nginx)     â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                               â”‚                      â”‚
â”‚   - - - - - - - - - - - - - - - - - - - - - -â”‚- - - - - - - - - -  â”‚
â”‚   â”‚    ì‹ ë¢° ê²½ê³„ (DMZ â†’ Internal)             â”‚                  â”‚  â”‚
â”‚   - - - - - - - - - - - - - - - - - - - - - -â”‚- - - - - - - - - -  â”‚
â”‚                                               â”‚                      â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                                        â”‚  App Server  â”‚             â”‚
â”‚                                        â”‚  (Flask/     â”‚             â”‚
â”‚                                        â”‚   Django)    â”‚             â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                               â”‚                      â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                               â”‚               â”‚               â”‚     â”‚
â”‚                        â•â•â•â•â•â•â•â–¼â•â•â•â•â•â•â• â•â•â•â•â•â•â•â–¼â•â•â•â•â•â•â• â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”‚
â”‚                        â•‘  PostgreSQL â•‘ â•‘   Redis     â•‘ â”‚ Externalâ”‚  â”‚
â”‚                        â•‘  (Users,   â•‘ â•‘   (Sessions,â•‘ â”‚ Payment â”‚  â”‚
â”‚                        â•‘   Orders)  â•‘ â•‘   Cache)    â•‘ â”‚ API     â”‚  â”‚
â”‚                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>ì´ì œ ê° ìš”ì†Œì— STRIDEë¥¼ ì ìš©í•©ë‹ˆë‹¤:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Threat</span><span class="p">:</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>       <span class="c1"># S, T, R, I, D, or E</span>
    <span class="n">element</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># Which DFD element</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>    <span class="c1"># What could go wrong</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>       <span class="c1"># Critical, High, Medium, Low</span>
    <span class="n">mitigation</span><span class="p">:</span> <span class="nb">str</span>     <span class="c1"># How to prevent it</span>

<span class="k">def</span><span class="w"> </span><span class="nf">stride_analysis</span><span class="p">(</span><span class="n">system_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Threat</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Example STRIDE analysis for a web application.&quot;&quot;&quot;</span>
    <span class="n">threats</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1"># Spoofing threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Spoofing&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Browser â†’ Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Attacker impersonates a legitimate user with &quot;</span>
                        <span class="s2">&quot;stolen credentials or forged session tokens&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Implement MFA, use short-lived JWTs, &quot;</span>
                       <span class="s2">&quot;enforce strong password policies&quot;</span>
        <span class="p">),</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Spoofing&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;App Server â†’ Payment API&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Attacker intercepts and replays API calls &quot;</span>
                        <span class="s2">&quot;to the payment processor&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Use mutual TLS (mTLS), API key rotation, &quot;</span>
                       <span class="s2">&quot;request signing with timestamps&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Tampering threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Tampering&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Browser â†’ Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Attacker modifies request parameters to change &quot;</span>
                        <span class="s2">&quot;order amounts or access other users&#39; data&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Server-side validation, HMAC on critical parameters, &quot;</span>
                       <span class="s2">&quot;parameterized queries&quot;</span>
        <span class="p">),</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Tampering&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;PostgreSQL&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;SQL injection allows attacker to modify database &quot;</span>
                        <span class="s2">&quot;records directly&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Prepared statements, ORM usage, input sanitization, &quot;</span>
                       <span class="s2">&quot;database-level access controls&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Repudiation threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Repudiation&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;App Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;User denies making a purchase; no audit trail exists&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Comprehensive audit logging with timestamps, &quot;</span>
                       <span class="s2">&quot;digital signatures on transactions&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Information Disclosure threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Information Disclosure&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Verbose error messages reveal stack traces, &quot;</span>
                        <span class="s2">&quot;database schema, or internal IPs&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Custom error pages, structured logging &quot;</span>
                       <span class="s2">&quot;(not exposed to clients), security headers&quot;</span>
        <span class="p">),</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Information Disclosure&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Redis&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Session data stored in Redis without encryption &quot;</span>
                        <span class="s2">&quot;is readable if Redis is compromised&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;Encrypt session data, enable Redis AUTH, &quot;</span>
                       <span class="s2">&quot;network isolation for Redis&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Denial of Service threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Denial of Service&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;Web Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Volumetric DDoS attack overwhelms the web server&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;CDN/WAF (e.g., Cloudflare), rate limiting, &quot;</span>
                       <span class="s2">&quot;auto-scaling infrastructure&quot;</span>
        <span class="p">),</span>

        <span class="c1"># Elevation of Privilege threats</span>
        <span class="n">Threat</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Elevation of Privilege&quot;</span><span class="p">,</span>
            <span class="n">element</span><span class="o">=</span><span class="s2">&quot;App Server&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Regular user accesses admin endpoints due to &quot;</span>
                        <span class="s2">&quot;missing authorization checks (IDOR/broken access control)&quot;</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
            <span class="n">mitigation</span><span class="o">=</span><span class="s2">&quot;RBAC enforcement on every endpoint, &quot;</span>
                       <span class="s2">&quot;automated authorization testing&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">threats</span>

<span class="c1"># Run analysis</span>
<span class="n">threats</span> <span class="o">=</span> <span class="n">stride_analysis</span><span class="p">(</span><span class="s2">&quot;E-Commerce Web App&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;STRIDE Analysis: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">threats</span><span class="p">)</span><span class="si">}</span><span class="s2"> threats identified</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Summary by category</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="n">by_category</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">category</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threats</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">by_category</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">cat</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> threats&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Critical threats</span>
<span class="n">critical</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threats</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="s2">&quot;Critical&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Critical threats (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">critical</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">critical</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">element</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Risk: </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Fix:  </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">mitigation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</code></pre></div>

<hr />
<h2 id="4-dread">4. DREADë¥¼ ì‚¬ìš©í•œ ìœ„í—˜ ì ìˆ˜í™”<a class="header-link" href="#4-dread" title="Permanent link">&para;</a></h2>
<p>DREADëŠ” ìœ„í˜‘ì˜ ìš°ì„ ìˆœìœ„ë¥¼ ì§€ì •í•˜ê¸° ìœ„í•œ ìˆ˜ì¹˜ ì ìˆ˜í™” ì‹œìŠ¤í…œì„ ì œê³µí•©ë‹ˆë‹¤. ê° ìš”ì†ŒëŠ” 1-10ìœ¼ë¡œ í‰ê°€ë©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DREAD ì ìˆ˜í™” ëª¨ë¸                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ìš”ì†Œ             â”‚ ì§ˆë¬¸                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ D - Damage       â”‚ ê³µê²©ì´ ì–¼ë§ˆë‚˜ ì‹¬ê°í•œê°€?                        â”‚
â”‚                  â”‚ 1 = ì‚¬ì†Œí•¨  10 = ì™„ì „í•œ ì‹œìŠ¤í…œ ì¹¨í•´            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R - Reproducibil.â”‚ ì¬í˜„í•˜ê¸° ì–¼ë§ˆë‚˜ ì‰¬ìš´ê°€?                        â”‚
â”‚                  â”‚ 1 = ë§¤ìš° ì–´ë ¤ì›€  10 = í•­ìƒ ì¬í˜„ ê°€ëŠ¥          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ E - Exploitab.   â”‚ ê³µê²©ì„ ì‹œì‘í•˜ëŠ” ë° ì–¼ë§ˆë‚˜ ë§ì€ ë…¸ë ¥ì´ í•„ìš”í•œê°€?â”‚
â”‚                  â”‚ 1 = ì „ë¬¸ê°€ + ë§ì¶¤ ë„êµ¬  10 = ë¸Œë¼ìš°ì €ë§Œ í•„ìš”   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ A - Affected     â”‚ ì–¼ë§ˆë‚˜ ë§ì€ ì‚¬ìš©ìê°€ ì˜í–¥ì„ ë°›ëŠ”ê°€?            â”‚
â”‚   Users          â”‚ 1 = ë‹¨ì¼ ì‚¬ìš©ì  10 = ëª¨ë“  ì‚¬ìš©ì             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ D - Discoverab.  â”‚ ì·¨ì•½ì ì„ ì°¾ê¸° ì–¼ë§ˆë‚˜ ì‰¬ìš´ê°€?                   â”‚
â”‚                  â”‚ 1 = ì†ŒìŠ¤ ì½”ë“œ í•„ìš”  10 = URLì—ì„œ ëª…ë°±         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DREAD ì ìˆ˜ = (D + R + E + A + D) / 5

í‰ê°€:    1-3 = Low    4-6 = Medium    7-9 = High    10 = Critical
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DREADScore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DREAD risk scoring for a vulnerability.&quot;&quot;&quot;</span>
    <span class="n">vulnerability</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">damage</span><span class="p">:</span> <span class="nb">int</span>          <span class="c1"># 1-10</span>
    <span class="n">reproducibility</span><span class="p">:</span> <span class="nb">int</span> <span class="c1"># 1-10</span>
    <span class="n">exploitability</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># 1-10</span>
    <span class="n">affected_users</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># 1-10</span>
    <span class="n">discoverability</span><span class="p">:</span> <span class="nb">int</span> <span class="c1"># 1-10</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">damage</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">reproducibility</span> <span class="o">+</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">exploitability</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_users</span> <span class="o">+</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">discoverability</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">total</span> <span class="o">/</span> <span class="mi">5</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rating</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;CRITICAL&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HIGH&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;MEDIUM&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;LOW&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vulnerability</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;  D=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">damage</span><span class="si">}</span><span class="s2"> R=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reproducibility</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;E=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exploitability</span><span class="si">}</span><span class="s2"> A=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">affected_users</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;D=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">discoverability</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;  Score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rating</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

<span class="c1"># Score several vulnerabilities</span>
<span class="n">vulns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;SQL Injection in login form&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">8</span>
    <span class="p">),</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;Missing rate limiting on password reset&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">7</span>
    <span class="p">),</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;XSS in user profile bio field&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">),</span>
    <span class="n">DREADScore</span><span class="p">(</span>
        <span class="n">vulnerability</span><span class="o">=</span><span class="s2">&quot;Cleartext password in debug log&quot;</span><span class="p">,</span>
        <span class="n">damage</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">reproducibility</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">exploitability</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">affected_users</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">discoverability</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Sort by score descending</span>
<span class="n">vulns</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DREAD Vulnerability Ranking&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vulns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">#</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="5">5. ê³µê²© í‘œë©´ê³¼ ìœ„í˜‘ ë²¡í„°<a class="header-link" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ê³µê²© í‘œë©´ì´ë€?<a class="header-link" href="#51" title="Permanent link">&para;</a></h3>
<p>ê³µê²© í‘œë©´ì€ ê³µê²©ìê°€ ì‹œìŠ¤í…œì—ì„œ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ì¶”ì¶œí•˜ë ¤ê³  ì‹œë„í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì§€ì ì˜ í•©ì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ê³µê²© í‘œë©´ ë²”ì£¼                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ë„¤íŠ¸ì›Œí¬ ê³µê²© í‘œë©´                                                  â”‚
â”‚  â”œâ”€â”€ ì—´ë¦° í¬íŠ¸ì™€ ì„œë¹„ìŠ¤ (SSH, HTTP, SMTP)                           â”‚
â”‚  â”œâ”€â”€ API ì—”ë“œí¬ì¸íŠ¸                                                  â”‚
â”‚  â”œâ”€â”€ DNS êµ¬ì„±                                                        â”‚
â”‚  â””â”€â”€ ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ (TCP, UDP, ICMP)                             â”‚
â”‚                                                                     â”‚
â”‚  ì†Œí”„íŠ¸ì›¨ì–´ ê³µê²© í‘œë©´                                                â”‚
â”‚  â”œâ”€â”€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì…ë ¥ (í¼, URL, í—¤ë”, ì¿ í‚¤)                      â”‚
â”‚  â”œâ”€â”€ íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥                                                â”‚
â”‚  â”œâ”€â”€ ì„œë“œíŒŒí‹° ì˜ì¡´ì„± (npm, pip íŒ¨í‚¤ì§€)                               â”‚
â”‚  â”œâ”€â”€ ë°ì´í„°ë² ì´ìŠ¤ ì¸í„°í˜ì´ìŠ¤                                         â”‚
â”‚  â””â”€â”€ IPC ë©”ì»¤ë‹ˆì¦˜ (íŒŒì´í”„, ì†Œì¼“, ê³µìœ  ë©”ëª¨ë¦¬)                        â”‚
â”‚                                                                     â”‚
â”‚  ë¬¼ë¦¬ì  ê³µê²© í‘œë©´                                                    â”‚
â”‚  â”œâ”€â”€ ì„œë²„ì˜ USB í¬íŠ¸                                                 â”‚
â”‚  â”œâ”€â”€ ë°ì´í„° ì„¼í„°ì— ëŒ€í•œ ë¬¼ë¦¬ì  ì ‘ê·¼                                  â”‚
â”‚  â”œâ”€â”€ ì´ë™ì‹ ë¯¸ë””ì–´                                                   â”‚
â”‚  â””â”€â”€ í•˜ë“œì›¨ì–´ ì„í”Œë€íŠ¸                                               â”‚
â”‚                                                                     â”‚
â”‚  ì¸ì  ê³µê²© í‘œë©´                                                      â”‚
â”‚  â”œâ”€â”€ í”¼ì‹± ëŒ€ìƒ (ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ” ì§ì›)                               â”‚
â”‚  â”œâ”€â”€ Social engineering (í—¬í”„ ë°ìŠ¤í¬, ì§€ì›)                         â”‚
â”‚  â”œâ”€â”€ ë‚´ë¶€ì ìœ„í˜‘                                                     â”‚
â”‚  â””â”€â”€ ì„œë“œíŒŒí‹° ë²¤ë” ë° ê³„ì•½ì                                         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="52">5.2 ê³µê²© í‘œë©´ ì—´ê±°<a class="header-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SurfaceType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">NETWORK</span> <span class="o">=</span> <span class="s2">&quot;network&quot;</span>
    <span class="n">SOFTWARE</span> <span class="o">=</span> <span class="s2">&quot;software&quot;</span>
    <span class="n">PHYSICAL</span> <span class="o">=</span> <span class="s2">&quot;physical&quot;</span>
    <span class="n">HUMAN</span> <span class="o">=</span> <span class="s2">&quot;human&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RiskLevel</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AttackSurfaceEntry</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">surface_type</span><span class="p">:</span> <span class="n">SurfaceType</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">risk_level</span><span class="p">:</span> <span class="n">RiskLevel</span>
    <span class="n">exposed_to</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># Who can reach this?</span>
    <span class="n">current_controls</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">recommendations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AttackSurfaceReport</span><span class="p">:</span>
    <span class="n">system_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">entries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AttackSurfaceEntry</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">AttackSurfaceEntry</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="n">by_type</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">by_risk</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">by_type</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">surface_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">by_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">surface_type</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">by_risk</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">by_risk</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;by_type&quot;</span><span class="p">:</span> <span class="n">by_type</span><span class="p">,</span> <span class="s2">&quot;by_risk&quot;</span><span class="p">:</span> <span class="n">by_risk</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attack Surface Report: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">system_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total attack surface entries: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;By type: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;by_type&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;By risk: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;by_risk&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Show critical/high items</span>
        <span class="n">urgent</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span>
                  <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">RiskLevel</span><span class="o">.</span><span class="n">HIGH</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">urgent</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">High/Critical Items (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">urgent</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">urgent</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">risk_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">surface_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">recommendations</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Recommendation: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">recommendations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Build an attack surface report</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">AttackSurfaceReport</span><span class="p">(</span><span class="s2">&quot;Corporate Web Portal&quot;</span><span class="p">)</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Public API (port 443)&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">NETWORK</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;REST API serving 50+ endpoints to internet&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Internet&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WAF&quot;</span><span class="p">,</span> <span class="s2">&quot;Rate limiting&quot;</span><span class="p">,</span> <span class="s2">&quot;JWT auth&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Add API gateway with stricter rate limits&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Admin panel (/admin)&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">SOFTWARE</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Django admin interface accessible on same domain&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Internet (by misconfiguration)&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Username/password&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Restrict to VPN only&quot;</span><span class="p">,</span> <span class="s2">&quot;Add MFA&quot;</span><span class="p">,</span> <span class="s2">&quot;Separate domain&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;npm dependencies (347 packages)&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">SOFTWARE</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Third-party JavaScript packages in frontend build&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Supply chain&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;npm audit in CI&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pin dependency versions&quot;</span><span class="p">,</span> <span class="s2">&quot;Use lockfile&quot;</span><span class="p">,</span> <span class="s2">&quot;Add Snyk/Dependabot&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AttackSurfaceEntry</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Employee email accounts&quot;</span><span class="p">,</span>
    <span class="n">surface_type</span><span class="o">=</span><span class="n">SurfaceType</span><span class="o">.</span><span class="n">HUMAN</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;150 employees with corporate email, potential phishing targets&quot;</span><span class="p">,</span>
    <span class="n">risk_level</span><span class="o">=</span><span class="n">RiskLevel</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
    <span class="n">exposed_to</span><span class="o">=</span><span class="s2">&quot;Internet (email)&quot;</span><span class="p">,</span>
    <span class="n">current_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Spam filter&quot;</span><span class="p">,</span> <span class="s2">&quot;Annual security training&quot;</span><span class="p">],</span>
    <span class="n">recommendations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Quarterly phishing simulations&quot;</span><span class="p">,</span> <span class="s2">&quot;DMARC/DKIM enforcement&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">report</span><span class="o">.</span><span class="n">print_report</span><span class="p">()</span>
</code></pre></div>

<h3 id="53">5.3 ì¼ë°˜ì ì¸ ìœ„í˜‘ ë²¡í„°<a class="header-link" href="#53" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ì¼ë°˜ì ì¸ ìœ„í˜‘ ë²¡í„°                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë²¡í„°             â”‚ ì„¤ëª… ë° ì˜ˆì‹œ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜    â”‚ â€¢ í¬íŠ¸ ìŠ¤ìºë‹ ë° ìµìŠ¤í”Œë¡œì‡                      â”‚
â”‚                  â”‚ â€¢ Man-in-the-middle ê³µê²©                        â”‚
â”‚                  â”‚ â€¢ DNS ìŠ¤í‘¸í•‘/ì¤‘ë…                                â”‚
â”‚                  â”‚ â€¢ ARP ìŠ¤í‘¸í•‘                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜  â”‚ â€¢ SQL injection (SQLi)                          â”‚
â”‚                  â”‚ â€¢ Cross-site scripting (XSS)                     â”‚
â”‚                  â”‚ â€¢ Cross-site request forgery (CSRF)              â”‚
â”‚                  â”‚ â€¢ Server-side request forgery (SSRF)             â”‚
â”‚                  â”‚ â€¢ Insecure direct object references (IDOR)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê³µê¸‰ë§           â”‚ â€¢ ì†ìƒëœ ì˜ì¡´ì„± (SolarWinds, log4j)             â”‚
â”‚                  â”‚ â€¢ íŒ¨í‚¤ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì˜ Typosquatting              â”‚
â”‚                  â”‚ â€¢ ë¹Œë“œ íŒŒì´í”„ë¼ì¸ì˜ ì•…ì„± ì½”ë“œ                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Social engineer. â”‚ â€¢ í”¼ì‹± (ì´ë©”ì¼, SMS, ìŒì„±)                       â”‚
â”‚                  â”‚ â€¢ Pretextingê³¼ baiting                          â”‚
â”‚                  â”‚ â€¢ Tailgating / piggybacking                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë¬¼ë¦¬ì            â”‚ â€¢ USB ë“œë¡­ ê³µê²©                                  â”‚
â”‚                  â”‚ â€¢ Evil maid ê³µê²©                                 â”‚
â”‚                  â”‚ â€¢ í•˜ë“œì›¨ì–´ ì„í”Œë€íŠ¸                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë‚´ë¶€ì           â”‚ â€¢ ë¶ˆë§Œì„ í’ˆì€ ì§ì›                               â”‚
â”‚                  â”‚ â€¢ ìš°ë°œì  ë°ì´í„° ë…¸ì¶œ                             â”‚
â”‚                  â”‚ â€¢ ìê²© ì¦ëª… ê³µìœ                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="6-defense-in-depth">6. Defense in Depth<a class="header-link" href="#6-defense-in-depth" title="Permanent link">&para;</a></h2>
<p>Defense in depthëŠ” ì •ë³´ ì‹œìŠ¤í…œ ì „ì²´ì— ê±¸ì³ ì—¬ëŸ¬ ê³„ì¸µì˜ ë³´ì•ˆ ì œì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì „ëµì…ë‹ˆë‹¤. í•œ ê³„ì¸µì´ ì‹¤íŒ¨í•˜ë©´ í›„ì† ê³„ì¸µì´ ê³„ì† ë³´í˜¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Defense in Depth ê³„ì¸µ                             â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Layer 7: DATA                                               â”‚    â”‚
â”‚  â”‚  ì €ì¥ ë°ì´í„° ì•”í˜¸í™”, DLP, ë°ì´í„° ë¶„ë¥˜, ë°±ì—…                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Layer 6: APPLICATION                                â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  ì…ë ¥ ê²€ì¦, WAF, ì•ˆì „í•œ ì½”ë”©, SAST/DAST              â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Layer 5: HOST                               â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  OS ê°•í™”, AV/EDR, íŒ¨ì¹­, FIM                  â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Layer 4: INTERNAL NETWORK           â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  ì„¸ê·¸ë¨¼í…Œì´ì…˜, VLAN, IDS/IPS, NTA    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Layer 3: PERIMETER          â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  ë°©í™”ë²½, DMZ, VPN, í”„ë¡ì‹œ    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Layer 2: PHYSICAL   â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  ê²½ë¹„, ìë¬¼ì‡ , CCTV  â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Layer 1:    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ POLICIES    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ &amp; TRAINING  â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="61">6.1 ê³„ì¸µí™”ëœ ë³´ì•ˆ êµ¬í˜„<a class="header-link" href="#61" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SecurityAction</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">ALLOW</span> <span class="o">=</span> <span class="s2">&quot;ALLOW&quot;</span>
    <span class="n">BLOCK</span> <span class="o">=</span> <span class="s2">&quot;BLOCK&quot;</span>
    <span class="n">LOG</span> <span class="o">=</span> <span class="s2">&quot;LOG&quot;</span>
    <span class="n">ALERT</span> <span class="o">=</span> <span class="s2">&quot;ALERT&quot;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityEvent</span><span class="p">:</span>
    <span class="n">source_ip</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">request_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">headers</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="n">body</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">blocked_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">actions_taken</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single layer in the defense-in-depth chain.&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">order</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">check</span><span class="p">:</span> <span class="n">Callable</span>  <span class="c1"># Function that returns (SecurityAction, reason)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DefenseInDepth</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Chain of security layers processed in order.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SecurityLayer</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">:</span> <span class="n">SecurityLayer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SecurityEvent</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process an event through all security layers.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
            <span class="n">action</span><span class="p">,</span> <span class="n">reason</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">actions_taken</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">blocked_by</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span>
                <span class="k">return</span> <span class="n">event</span>

        <span class="k">return</span> <span class="n">event</span>

<span class="c1"># Define security layers as check functions</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rate_limiter</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 1: Rate limiting (perimeter).&quot;&quot;&quot;</span>
    <span class="c1"># Simplified - in production, track request counts per IP</span>
    <span class="n">suspicious_ips</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;10.0.0.99&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.1.200&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">source_ip</span> <span class="ow">in</span> <span class="n">suspicious_ips</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;IP </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">source_ip</span><span class="si">}</span><span class="s2"> rate limited&quot;</span>
    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;Rate check passed&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">waf_check</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 2: Web Application Firewall.&quot;&quot;&quot;</span>
    <span class="c1"># Check for common attack patterns</span>
    <span class="n">sqli_patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">r</span><span class="s2">&quot;(\b(union|select|insert|update|delete|drop)\b.*\b(from|into|table)\b)&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;(--|#|/\*)&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;(\bor\b\s+\b\d+\b\s*=\s*\b\d+\b)&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">xss_patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">r</span><span class="s2">&quot;&lt;script[^&gt;]*&gt;&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;javascript:&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;on(load|error|click)\s*=&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">full_input</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">request_path</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">sqli_patterns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">full_input</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;SQLi pattern detected: </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">xss_patterns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">full_input</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;XSS pattern detected: </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;WAF check passed&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">auth_check</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 3: Authentication verification.&quot;&quot;&quot;</span>
    <span class="n">auth_header</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Authorization&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_header</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">request_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/api/&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="s2">&quot;Missing authentication for API endpoint&quot;</span>
    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;Auth check passed&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">input_validation</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SecurityEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Layer 4: Application-level input validation.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="s2">&quot;Request body exceeds maximum size&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;../&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">request_path</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">BLOCK</span><span class="p">,</span> <span class="s2">&quot;Path traversal attempt detected&quot;</span>
    <span class="k">return</span> <span class="n">SecurityAction</span><span class="o">.</span><span class="n">ALLOW</span><span class="p">,</span> <span class="s2">&quot;Input validation passed&quot;</span>

<span class="c1"># Assemble defense layers</span>
<span class="n">defense</span> <span class="o">=</span> <span class="n">DefenseInDepth</span><span class="p">()</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;Rate Limiter&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rate_limiter</span><span class="p">))</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;WAF&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">waf_check</span><span class="p">))</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;Auth Check&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">auth_check</span><span class="p">))</span>
<span class="n">defense</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">SecurityLayer</span><span class="p">(</span><span class="s2">&quot;Input Validation&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">input_validation</span><span class="p">))</span>

<span class="c1"># Test with various events</span>
<span class="n">events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">SecurityEvent</span><span class="p">(</span>
        <span class="n">source_ip</span><span class="o">=</span><span class="s2">&quot;203.0.113.50&quot;</span><span class="p">,</span>
        <span class="n">request_path</span><span class="o">=</span><span class="s2">&quot;/api/users/1&quot;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer eyJ...&quot;</span><span class="p">},</span>
        <span class="n">body</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="p">),</span>
    <span class="n">SecurityEvent</span><span class="p">(</span>
        <span class="n">source_ip</span><span class="o">=</span><span class="s2">&quot;203.0.113.51&quot;</span><span class="p">,</span>
        <span class="n">request_path</span><span class="o">=</span><span class="s2">&quot;/api/users&quot;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer eyJ...&quot;</span><span class="p">},</span>
        <span class="n">body</span><span class="o">=</span><span class="s2">&quot;name=test&#39; OR 1=1 --&quot;</span>
    <span class="p">),</span>
    <span class="n">SecurityEvent</span><span class="p">(</span>
        <span class="n">source_ip</span><span class="o">=</span><span class="s2">&quot;203.0.113.52&quot;</span><span class="p">,</span>
        <span class="n">request_path</span><span class="o">=</span><span class="s2">&quot;/api/files/../../../etc/passwd&quot;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer eyJ...&quot;</span><span class="p">},</span>
        <span class="n">body</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">defense</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;BLOCKED&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">blocked_by</span> <span class="k">else</span> <span class="s2">&quot;ALLOWED&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Event #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">request_path</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">actions_taken</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">blocked_by</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  &gt;&gt;&gt; Blocked by: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">blocked_by</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="7">7. ìµœì†Œ ê¶Œí•œ ì›ì¹™<a class="header-link" href="#7" title="Permanent link">&para;</a></h2>
<p>ìµœì†Œ ê¶Œí•œ ì›ì¹™(PoLP)ì€ ëª¨ë“  ëª¨ë“ˆ, ì‚¬ìš©ì ë˜ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ì‘ì—…ì„ ì™„ë£Œí•˜ëŠ” ë° í•„ìš”í•œ ìµœì†Œí•œì˜ ê¶Œí•œ ì§‘í•©ë§Œ ì‚¬ìš©í•˜ì—¬ ì‘ë™í•´ì•¼ í•œë‹¤ê³  ëª…ì‹œí•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="err">â”‚</span><span class="w">              </span><span class="err">ìµœì†Œ</span><span class="w"> </span><span class="err">ê¶Œí•œ</span><span class="w"> </span><span class="err">ì›ì¹™</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">ì˜ˆì‹œ</span><span class="w">                                   </span><span class="err">â”‚</span>
<span class="err">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ë‚˜ìœ</span><span class="w"> </span><span class="err">ì˜ˆ</span><span class="w"> </span><span class="p">(</span><span class="err">ê³¼ë„í•œ</span><span class="w"> </span><span class="err">ê¶Œí•œ</span><span class="p">):</span><span class="w">                                              </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">ì›¹</span><span class="w"> </span><span class="err">ì•±</span><span class="w"> </span><span class="err">ì„œë¹„ìŠ¤</span><span class="w"> </span><span class="err">ê³„ì •</span><span class="w">                                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">DB</span><span class="p">:</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="err">ì ‘ê·¼</span><span class="w"> </span><span class="p">(</span><span class="n">DROP</span><span class="w"> </span><span class="n">DATABASE</span><span class="w"> </span><span class="err">ê°€ëŠ¥</span><span class="p">)</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="err">íŒŒì¼</span><span class="p">:</span><span class="w"> </span><span class="err">ì „ì²´</span><span class="w"> </span><span class="err">íŒŒì¼ì‹œìŠ¤í…œ</span><span class="w"> </span><span class="err">ì½ê¸°</span><span class="o">/</span><span class="err">ì“°ê¸°</span><span class="w">                         </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="err">ë„¤íŠ¸ì›Œí¬</span><span class="p">:</span><span class="w"> </span><span class="err">ì œí•œ</span><span class="w"> </span><span class="err">ì—†ëŠ”</span><span class="w"> </span><span class="err">ì•„ì›ƒë°”ìš´ë“œ</span><span class="w">                          </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="err">í”„ë¡œì„¸ìŠ¤</span><span class="p">:</span><span class="w"> </span><span class="n">rootë¡œ</span><span class="w"> </span><span class="err">ë¬´ì—‡ì´ë“ </span><span class="w"> </span><span class="err">ì‹¤í–‰</span><span class="w"> </span><span class="err">ê°€ëŠ¥</span><span class="w">                     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">ì¢‹ì€</span><span class="w"> </span><span class="err">ì˜ˆ</span><span class="w"> </span><span class="p">(</span><span class="err">ìµœì†Œ</span><span class="w"> </span><span class="err">ê¶Œí•œ</span><span class="p">):</span><span class="w">                                                </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">ì›¹</span><span class="w"> </span><span class="err">ì•±</span><span class="w"> </span><span class="err">ì„œë¹„ìŠ¤</span><span class="w"> </span><span class="err">ê³„ì •</span><span class="w">                                           </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="n">DB</span><span class="p">:</span><span class="w"> </span><span class="n">app_db</span><span class="o">.</span><span class="n">users</span><span class="p">,</span><span class="w"> </span><span class="n">app_db</span><span class="o">.</span><span class="n">ordersì—ë§Œ</span><span class="w"> </span><span class="n">SELECT</span><span class="p">,</span><span class="w"> </span><span class="n">INSERT</span><span class="w">     </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="err">íŒŒì¼</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="k">static</span><span class="w"> </span><span class="err">ì½ê¸°</span><span class="w"> </span><span class="err">ì „ìš©</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">uploads</span><span class="w"> </span><span class="err">ì“°ê¸°</span><span class="w"> </span><span class="err">ì „ìš©</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â”œâ”€â”€</span><span class="w"> </span><span class="err">ë„¤íŠ¸ì›Œí¬</span><span class="p">:</span><span class="w"> </span><span class="n">payment</span><span class="o">-</span><span class="n">api</span><span class="o">.</span><span class="n">internal</span><span class="p">:</span><span class="mi">443</span><span class="err">ìœ¼ë¡œë§Œ</span><span class="w"> </span><span class="err">ì•„ì›ƒë°”ìš´ë“œ</span><span class="w">    </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€</span><span class="w"> </span><span class="err">í”„ë¡œì„¸ìŠ¤</span><span class="p">:</span><span class="w"> </span><span class="err">ë¹„íŠ¹ê¶Œ</span><span class="w"> </span><span class="err">ì‚¬ìš©ìë¡œ</span><span class="w"> </span><span class="err">ì‹¤í–‰</span><span class="w"> </span><span class="p">(</span><span class="n">uid</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w">              </span><span class="err">â”‚</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">  </span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">   </span><span class="err">â”‚</span>
<span class="err">â”‚</span><span class="w">                                                                      </span><span class="err">â”‚</span>
<span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre></div>

<h3 id="71">7.1 ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ì—ì„œì˜ ìµœì†Œ ê¶Œí•œ<a class="header-link" href="#71" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- BAD: Application uses root/superuser</span>
<span class="c1">-- GRANT ALL PRIVILEGES ON *.* TO &#39;webapp&#39;@&#39;%&#39;;</span>

<span class="c1">-- GOOD: Granular permissions per function</span>
<span class="c1">-- Read-only user for reporting</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;strong_random_pw&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">users</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">orders</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">products</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_reader&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>

<span class="c1">-- Write user for the application (limited tables and operations)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;another_strong_pw&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">users</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">orders</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="n">products</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;webapp_writer&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
<span class="c1">-- Note: No DELETE, no DROP, no ALTER, no access to other databases</span>

<span class="c1">-- Admin user (separate account, not used by the application)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;db_admin&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.1&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;very_strong_admin_pw&#39;</span><span class="p">;</span>
<span class="k">GRANT</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">app_db</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;db_admin&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.1&#39;</span><span class="p">;</span>
<span class="c1">-- Only accessible from a single bastion host IP</span>
</code></pre></div>

<h3 id="72">7.2 ì½”ë“œì—ì„œì˜ ìµœì†Œ ê¶Œí•œ<a class="header-link" href="#72" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SandboxedFileAccess</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enforce least privilege for file system access.&quot;&quot;&quot;</span>
    <span class="n">allowed_read_dirs</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">allowed_write_dirs</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">max_file_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># 10 MB default</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_within_allowed_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">dirs</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a resolved path falls within allowed directories.&quot;&quot;&quot;</span>
        <span class="n">resolved</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">resolved</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a file only if it&#39;s within allowed read directories.&quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="c1"># Prevent path traversal</span>
        <span class="k">if</span> <span class="s2">&quot;..&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path traversal not allowed: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_within_allowed_dirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_read_dirs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Read access denied: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2"> is outside allowed directories&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a file only if it&#39;s within allowed write directories.&quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;..&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path traversal not allowed: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_within_allowed_dirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_write_dirs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Write access denied: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2"> is outside allowed directories&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_file_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;File size </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="si">}</span><span class="s2"> exceeds max </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_file_size</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># Usage: application can only read from /app/config and write to /app/uploads</span>
<span class="n">sandbox</span> <span class="o">=</span> <span class="n">SandboxedFileAccess</span><span class="p">(</span>
    <span class="n">allowed_read_dirs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/app/config&quot;</span><span class="p">,</span> <span class="s2">&quot;/app/static&quot;</span><span class="p">],</span>
    <span class="n">allowed_write_dirs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/app/uploads&quot;</span><span class="p">],</span>
    <span class="n">max_file_size</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># 5 MB</span>
<span class="p">)</span>

<span class="c1"># This would succeed (within allowed read directory)</span>
<span class="c1"># content = sandbox.read_file(&quot;/app/config/settings.json&quot;)</span>

<span class="c1"># This would raise PermissionError (outside allowed directories)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">sandbox</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">PermissionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Blocked: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># This would raise PermissionError (path traversal attempt)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">sandbox</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;/app/config/../../etc/shadow&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">PermissionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Blocked: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="73-aws-iam">7.3 í´ë¼ìš°ë“œì—ì„œì˜ ìµœì†Œ ê¶Œí•œ (AWS IAM ì˜ˆì‹œ)<a class="header-link" href="#73-aws-iam" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Statement&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AllowS3ReadSpecificBucket&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;s3:GetObject&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;s3:ListBucket&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads/*&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AllowDynamoDBReadWrite&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;dynamodb:GetItem&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;dynamodb:PutItem&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;dynamodb:Query&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:dynamodb:us-east-1:123456789:table/users&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Sid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DenyAllElse&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Deny&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;NotResource&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:s3:::my-app-uploads/*&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;arn:aws:dynamodb:us-east-1:123456789:table/users&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="8-security-by-design-vs-security-by-obscurity">8. Security by Design vs Security by Obscurity<a class="header-link" href="#8-security-by-design-vs-security-by-obscurity" title="Permanent link">&para;</a></h2>
<h3 id="81-security-by-design">8.1 Security by Design<a class="header-link" href="#81-security-by-design" title="Permanent link">&para;</a></h3>
<p>Security by designì€ ë‚˜ì¤‘ì— ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì²˜ìŒë¶€í„° ì‹œìŠ¤í…œì— ë³´ì•ˆì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Security by Design ì›ì¹™                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  1. ê³µê²© í‘œë©´ ìµœì†Œí™”                                                 â”‚
â”‚     â””â”€â”€ ë¶ˆí•„ìš”í•œ ê¸°ëŠ¥, í¬íŠ¸, ì„œë¹„ìŠ¤ ì œê±°                             â”‚
â”‚                                                                      â”‚
â”‚  2. ì•ˆì „í•œ ê¸°ë³¸ê°’ ì„¤ì •                                               â”‚
â”‚     â””â”€â”€ ê¸°ë³¸ êµ¬ì„±ì´ ê°€ì¥ ì•ˆì „í•´ì•¼ í•¨                                 â”‚
â”‚                                                                      â”‚
â”‚  3. ìµœì†Œ ê¶Œí•œ ì›ì¹™                                                   â”‚
â”‚     â””â”€â”€ í•„ìš”í•œ ìµœì†Œ ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬                                   â”‚
â”‚                                                                      â”‚
â”‚  4. Defense in Depth                                                 â”‚
â”‚     â””â”€â”€ ì—¬ëŸ¬ ë…ë¦½ì ì¸ ë³´ì•ˆ ê³„ì¸µ                                      â”‚
â”‚                                                                      â”‚
â”‚  5. ì•ˆì „í•˜ê²Œ ì‹¤íŒ¨                                                    â”‚
â”‚     â””â”€â”€ ì˜¤ë¥˜ê°€ ë³´ì•ˆ ì·¨ì•½ì ì„ ë§Œë“¤ì–´ì„œëŠ” ì•ˆ ë¨                        â”‚
â”‚                                                                      â”‚
â”‚  6. ì„œë¹„ìŠ¤ë¥¼ ì‹ ë¢°í•˜ì§€ ë§ˆë¼                                           â”‚
â”‚     â””â”€â”€ ëª¨ë“  ì™¸ë¶€ ì…ë ¥ ë° ì‘ë‹µ ê²€ì¦                                  â”‚
â”‚                                                                      â”‚
â”‚  7. ì§ë¬´ ë¶„ë¦¬                                                        â”‚
â”‚     â””â”€â”€ ë‹¨ì¼ ì‚¬ëŒ/í”„ë¡œì„¸ìŠ¤ê°€ ëª¨ë“  ê²ƒì„ ì œì–´í•˜ì§€ ì•ŠìŒ                 â”‚
â”‚                                                                      â”‚
â”‚  8. ë³´ì•ˆì„ ë‹¨ìˆœí•˜ê²Œ ìœ ì§€                                             â”‚
â”‚     â””â”€â”€ ë³µì¡í•œ ë³´ì•ˆì€ ì¢…ì¢… ìš°íšŒë˜ê±°ë‚˜ ì˜ëª» êµ¬ì„±ë¨                    â”‚
â”‚                                                                      â”‚
â”‚  9. ë¬¸ì œë¥¼ ì˜¬ë°”ë¥´ê²Œ ìˆ˜ì •                                             â”‚
â”‚     â””â”€â”€ ì¦ìƒì´ ì•„ë‹Œ ê·¼ë³¸ ì›ì¸ í•´ê²°                                   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p><strong>Kerckhoffs' Principle (1883):</strong> ì•”í˜¸í™” ì‹œìŠ¤í…œì€ í‚¤ë¥¼ ì œì™¸í•œ ì‹œìŠ¤í…œì˜ ëª¨ë“  ê²ƒì´ ê³µê°œë˜ì–´ ìˆì–´ë„ ì•ˆì „í•´ì•¼ í•©ë‹ˆë‹¤. ì´ê²ƒì´ security by designì˜ ê¸ˆë³¸ìœ„ì œì…ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Security by Design: Fail-secure examples</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_user_role</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fail-secure: if anything goes wrong, return the most restrictive role.</span>
<span class="sd">    Never fail into a privileged state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">user</span><span class="o">.</span><span class="n">role</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">user</span><span class="o">.</span><span class="n">role</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Log this in production</span>

    <span class="c1"># Fail secure: default to no access</span>
    <span class="k">return</span> <span class="s2">&quot;none&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_authorized</span><span class="p">(</span><span class="n">user_role</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">required_role</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Security by design: explicit allowlist, not blocklist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">role_hierarchy</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;admin&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;editor&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;viewer&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;none&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Unknown roles get no access (fail secure)</span>
    <span class="n">user_level</span> <span class="o">=</span> <span class="n">role_hierarchy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_role</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">required_level</span> <span class="o">=</span> <span class="n">role_hierarchy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">required_role</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">user_level</span> <span class="o">&gt;=</span> <span class="n">required_level</span>


<span class="c1"># Secure defaults in configuration</span>
<span class="n">SECURE_DEFAULTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;session_timeout_minutes&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>       <span class="c1"># Short timeout</span>
    <span class="s2">&quot;max_login_attempts&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>             <span class="c1"># Lockout after failures</span>
    <span class="s2">&quot;password_min_length&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>           <span class="c1"># Strong passwords</span>
    <span class="s2">&quot;require_mfa&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>                 <span class="c1"># MFA on by default</span>
    <span class="s2">&quot;cors_origins&quot;</span><span class="p">:</span> <span class="p">[],</span>                  <span class="c1"># No CORS by default (deny all)</span>
    <span class="s2">&quot;debug_mode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>                 <span class="c1"># Never expose debug info</span>
    <span class="s2">&quot;tls_min_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2&quot;</span><span class="p">,</span>           <span class="c1"># No legacy TLS</span>
    <span class="s2">&quot;cookie_secure&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>               <span class="c1"># HTTPS-only cookies</span>
    <span class="s2">&quot;cookie_httponly&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>             <span class="c1"># No JS access to cookies</span>
    <span class="s2">&quot;cookie_samesite&quot;</span><span class="p">:</span> <span class="s2">&quot;Strict&quot;</span><span class="p">,</span>         <span class="c1"># Prevent CSRF</span>
    <span class="s2">&quot;content_security_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;default-src &#39;self&#39;&quot;</span><span class="p">,</span>  <span class="c1"># Strict CSP</span>
    <span class="s2">&quot;x_frame_options&quot;</span><span class="p">:</span> <span class="s2">&quot;DENY&quot;</span><span class="p">,</span>           <span class="c1"># Prevent clickjacking</span>
    <span class="s2">&quot;hsts_max_age&quot;</span><span class="p">:</span> <span class="mi">31536000</span><span class="p">,</span>           <span class="c1"># 1 year HSTS</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="82-security-by-obscurity">8.2 Security by Obscurity (ê·¸ë¦¬ê³  ì‹¤íŒ¨í•˜ëŠ” ì´ìœ )<a class="header-link" href="#82-security-by-obscurity" title="Permanent link">&para;</a></h3>
<p>Security by obscurityëŠ” ì„¤ê³„ì˜ ê±´ì „ì„±ì´ ì•„ë‹Œ êµ¬í˜„ì˜ ë¹„ë°€ì„±ì— ì˜ì¡´í•©ë‹ˆë‹¤. ë‹¨ë…ìœ¼ë¡œëŠ” ìœ íš¨í•œ ë³´ì•ˆ ì „ëµì´ ì•„ë‹™ë‹ˆë‹¤.</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Security by Obscurity - ì¼ë°˜ì ì¸ (ë‚˜ìœ) ì˜ˆì‹œ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  &quot;ì•„ë¬´ë„ /xK9mQ2pì˜ ê´€ë¦¬ì íŒ¨ë„ì„ ì°¾ì§€ ëª»í•  ê²ƒì´ë‹¤&quot;                 â”‚
â”‚    â†’ ë””ë ‰í† ë¦¬ ë¸Œë£¨íŠ¸í¬ì‹±, ë¡œê·¸ ë˜ëŠ” ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ë¡œ             â”‚
â”‚      ì‰½ê²Œ ë°œê²¬ë¨                                                     â”‚
â”‚                                                                      â”‚
â”‚  &quot;ìš°ë¦¬ì˜ ë§ì¶¤ ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì€ ë¹„ë°€ì´ë¯€ë¡œ ì•ˆì „í•˜ë‹¤&quot;                â”‚
â”‚    â†’ ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§ë˜ê±°ë‚˜ ìœ ì¶œë¨; í”¼ì–´ ë¦¬ë·° ì—†ìœ¼ë©´ ë²„ê·¸           â”‚
â”‚                                                                      â”‚
â”‚  &quot;ì„œë²„ ë²„ì „ í—¤ë”ë¥¼ ìˆ¨ê¸´ë‹¤&quot;                                           â”‚
â”‚    â†’ í•‘ê±°í”„ë¦°íŒ…ìœ¼ë¡œ ì—¬ì „íˆ ì„œë²„ ì†Œí”„íŠ¸ì›¨ì–´ ì‹ë³„ ê°€ëŠ¥                â”‚
â”‚                                                                      â”‚
â”‚  &quot;ë°ì´í„°ë² ì´ìŠ¤ í¬íŠ¸ë¥¼ 5432 ëŒ€ì‹  54321ë¡œ í•œë‹¤&quot;                       â”‚
â”‚    â†’ í¬íŠ¸ ìŠ¤ìºë„ˆê°€ 65535ê°œ í¬íŠ¸ë¥¼ ëª‡ ì´ˆ ë§Œì— ê²€ì‚¬                   â”‚
â”‚                                                                      â”‚
â”‚  &quot;API í‚¤ê°€ ë‚œë…í™”ëœ JavaScriptì— í¬í•¨ë˜ì–´ ìˆë‹¤&quot;                     â”‚
â”‚    â†’ ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ë¡œ ëª¨ë“  ê²ƒì´ ì¦‰ì‹œ ë…¸ì¶œë¨                   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                      â”‚
â”‚  ì°¸ê³ : ObscurityëŠ” ë³´ì¡° ê³„ì¸µ(defense in depth)ì´ ë  ìˆ˜ ìˆì§€ë§Œ      â”‚
â”‚  ì£¼ìš” ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜ì´ ë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.                           â”‚
â”‚                                                                      â”‚
â”‚  Obscurityê°€ í•œê³„ì  ê°€ì¹˜ë¥¼ ë”í•˜ëŠ” ì˜ˆ:                               â”‚
â”‚  - ê¸°ë³¸ SSH í¬íŠ¸ ë³€ê²½ (ë…¸ì´ì¦ˆ ê°ì†Œ, ì‹¤ì œ ê³µê²©ì€ ì•„ë‹˜)               â”‚
â”‚  - ë²„ì „ ë°°ë„ˆ ì œê±° (ìë™í™” ìŠ¤ìºë„ˆë¥¼ ì•½ê°„ ëŠë¦¬ê²Œ í•¨)                  â”‚
â”‚  - ë¹„í‘œì¤€ ë””ë ‰í† ë¦¬ ì´ë¦„ ì‚¬ìš© (ì¼ë°˜ì ì¸ íƒìƒ‰ ì–µì œ)                   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="9">9. ìœ„í—˜ í‰ê°€ í”„ë ˆì„ì›Œí¬<a class="header-link" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 ì •ì„±ì  ìœ„í—˜ í‰ê°€<a class="header-link" href="#91" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ìœ„í—˜ = ê°€ëŠ¥ì„± Ã— ì˜í–¥

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ìœ„í—˜ í‰ê°€ ë§¤íŠ¸ë¦­ìŠ¤ (5Ã—5)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚ ë¬´ì‹œí•  ìˆ˜â”‚  ê²½ë¯¸í•œ  â”‚  ì¤‘ê°„    â”‚  ì£¼ìš”    â”‚ ì¹˜ëª…ì        â”‚
â”‚          â”‚ ìˆëŠ” ì˜í–¥â”‚  ì˜í–¥    â”‚  ì˜í–¥    â”‚  ì˜í–¥    â”‚ ì˜í–¥         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê±°ì˜     â”‚  Medium  â”‚   High   â”‚   High   â”‚ Critical â”‚  Critical    â”‚
â”‚ í™•ì‹¤í•¨   â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê°€ëŠ¥ì„±   â”‚   Low    â”‚  Medium  â”‚   High   â”‚   High   â”‚  Critical    â”‚
â”‚ ë†’ìŒ     â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê°€ëŠ¥í•¨   â”‚   Low    â”‚  Medium  â”‚  Medium  â”‚   High   â”‚   High       â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê°€ëŠ¥ì„±   â”‚   Low    â”‚   Low    â”‚  Medium  â”‚  Medium  â”‚   High       â”‚
â”‚ ë‚®ìŒ     â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë“œë¬¾     â”‚   Low    â”‚   Low    â”‚   Low    â”‚  Medium  â”‚  Medium      â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="92">9.2 ì½”ë“œë¡œ í•˜ëŠ” ìœ„í—˜ í‰ê°€<a class="header-link" href="#92" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntEnum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Likelihood</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">RARE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">UNLIKELY</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">POSSIBLE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">LIKELY</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">ALMOST_CERTAIN</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Impact</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">NEGLIGIBLE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">MINOR</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">MODERATE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">MAJOR</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">CATASTROPHIC</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Risk</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">likelihood</span><span class="p">:</span> <span class="n">Likelihood</span>
    <span class="n">impact</span><span class="p">:</span> <span class="n">Impact</span>
    <span class="n">existing_controls</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">recommended_actions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">impact</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rating</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;CRITICAL&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HIGH&quot;</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;MEDIUM&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;LOW&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">response_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine risk response based on rating.&quot;&quot;&quot;</span>
        <span class="n">strategies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;CRITICAL&quot;</span><span class="p">:</span> <span class="s2">&quot;Mitigate immediately - stop and fix&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HIGH&quot;</span><span class="p">:</span> <span class="s2">&quot;Mitigate soon - plan remediation within sprint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MEDIUM&quot;</span><span class="p">:</span> <span class="s2">&quot;Accept with monitoring, or mitigate in backlog&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LOW&quot;</span><span class="p">:</span> <span class="s2">&quot;Accept - document and monitor&quot;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">strategies</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rating</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">risk_assessment</span><span class="p">(</span><span class="n">risks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Risk</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform and display a risk assessment.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RISK ASSESSMENT REPORT&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

    <span class="c1"># Sort by score (highest risk first)</span>
    <span class="n">sorted_risks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">risks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">risk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_risks</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;â”€&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Risk #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Description:  </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Likelihood:   </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">likelihood</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Impact:       </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">impact</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">impact</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:        </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">score</span><span class="si">}</span><span class="s2"> / 25&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating:       </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">rating</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Response:     </span><span class="si">{</span><span class="n">risk</span><span class="o">.</span><span class="n">response_strategy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Controls:     </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">risk</span><span class="o">.</span><span class="n">existing_controls</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Recommended:  </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">risk</span><span class="o">.</span><span class="n">recommended_actions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Summary statistics</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
    <span class="n">ratings</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">rating</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">risks</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rating</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;CRITICAL&quot;</span><span class="p">,</span> <span class="s2">&quot;HIGH&quot;</span><span class="p">,</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span> <span class="s2">&quot;LOW&quot;</span><span class="p">]:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rating</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">bar</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">count</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">rating</span><span class="si">:</span><span class="s2">10s</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">bar</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Example assessment</span>
<span class="n">risks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Unpatched web server&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Apache 2.4.49 with known path traversal CVE-2021-41773&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">ALMOST_CERTAIN</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">MAJOR</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WAF in front of server&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Patch immediately to 2.4.52+&quot;</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;No encryption at rest&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Customer PII stored in plaintext in PostgreSQL&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">POSSIBLE</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">CATASTROPHIC</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Database behind VPN&quot;</span><span class="p">,</span> <span class="s2">&quot;Access logging&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;Enable TDE or application-level encryption&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Classify and encrypt PII columns&quot;</span>
        <span class="p">]</span>
    <span class="p">),</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Weak password policy&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Minimum 6 characters, no complexity requirements&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">LIKELY</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">MODERATE</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Account lockout after 10 attempts&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;Require 12+ characters&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Check against breached password lists&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Implement MFA&quot;</span>
        <span class="p">]</span>
    <span class="p">),</span>
    <span class="n">Risk</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Missing CSRF protection&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;State-changing forms lack CSRF tokens&quot;</span><span class="p">,</span>
        <span class="n">likelihood</span><span class="o">=</span><span class="n">Likelihood</span><span class="o">.</span><span class="n">POSSIBLE</span><span class="p">,</span>
        <span class="n">impact</span><span class="o">=</span><span class="n">Impact</span><span class="o">.</span><span class="n">MODERATE</span><span class="p">,</span>
        <span class="n">existing_controls</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SameSite=Lax cookies&quot;</span><span class="p">],</span>
        <span class="n">recommended_actions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Add CSRF tokens to all forms&quot;</span><span class="p">,</span> <span class="s2">&quot;Use SameSite=Strict&quot;</span><span class="p">]</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="n">risk_assessment</span><span class="p">(</span><span class="n">risks</span><span class="p">)</span>
</code></pre></div>

<h3 id="93">9.3 ì£¼ìš” ìœ„í—˜ í”„ë ˆì„ì›Œí¬<a class="header-link" href="#93" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ìœ„í—˜ í‰ê°€ í”„ë ˆì„ì›Œí¬                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ í”„ë ˆì„ì›Œí¬      â”‚ ì„¤ëª…                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ NIST RMF        â”‚ Risk Management Framework (SP 800-37)             â”‚
â”‚ (SP 800-37)     â”‚ - ë¶„ë¥˜ â†’ ì„ íƒ â†’ êµ¬í˜„ â†’ í‰ê°€ â†’                    â”‚
â”‚                 â”‚   ìŠ¹ì¸ â†’ ëª¨ë‹ˆí„°ë§                                 â”‚
â”‚                 â”‚ - ë¯¸êµ­ ì •ë¶€ í‘œì¤€, ë„ë¦¬ ì±„íƒë¨                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ISO 27005       â”‚ ì •ë³´ ë³´ì•ˆ ìœ„í—˜ ê´€ë¦¬                               â”‚
â”‚                 â”‚ - ì»¨í…ìŠ¤íŠ¸ â†’ í‰ê°€ â†’ ì²˜ë¦¬ â†’ ëª¨ë‹ˆí„°ë§              â”‚
â”‚                 â”‚ - êµ­ì œ í‘œì¤€, ì¸ì¦ ê°€ëŠ¥                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FAIR            â”‚ Factor Analysis of Information Risk               â”‚
â”‚                 â”‚ - ì •ëŸ‰ì : ìœ„í—˜ì„ ë‹¬ëŸ¬ë¡œ ì¶”ì •                      â”‚
â”‚                 â”‚ - Loss Event Frequency Ã— Loss Magnitude           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OCTAVE          â”‚ Operationally Critical Threat, Asset, and        â”‚
â”‚                 â”‚ Vulnerability Evaluation                          â”‚
â”‚                 â”‚ - ìê¸° ì£¼ë„ì , ì¡°ì§ ì¤‘ì‹¬                          â”‚
â”‚                 â”‚ - ì†Œê·œëª¨ íŒ€ì— ì í•©                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OWASP Risk      â”‚ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ„í—˜ì— ì´ˆì                        â”‚
â”‚ Rating          â”‚ - ê°€ëŠ¥ì„± Ã— ì˜í–¥ with ìƒì„¸ ìš”ì†Œ                   â”‚
â”‚                 â”‚ - OWASP Top 10ê³¼ ì •ë ¬                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<hr />
<h2 id="10-common-vulnerability-scoring-systemcvss">10. Common Vulnerability Scoring System(CVSS)<a class="header-link" href="#10-common-vulnerability-scoring-systemcvss" title="Permanent link">&para;</a></h2>
<p>CVSSëŠ” ì·¨ì•½ì ì˜ ì£¼ìš” íŠ¹ì„±ì„ í¬ì°©í•˜ê³  ì‹¬ê°ë„ë¥¼ ë°˜ì˜í•˜ëŠ” ìˆ˜ì¹˜ ì ìˆ˜(0-10)ë¥¼ ìƒì„±í•˜ëŠ” í‘œì¤€í™”ëœ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
<h3 id="101-cvss-v31-v40">10.1 CVSS v3.1 / v4.0 ë©”íŠ¸ë¦­<a class="header-link" href="#101-cvss-v31-v40" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CVSS v3.1 ë©”íŠ¸ë¦­ ê·¸ë£¹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  BASE METRICS (ë³¸ì§ˆì ì¸ ì·¨ì•½ì  íŠ¹ì„±)                                 â”‚
â”‚  â”œâ”€â”€ Attack Vector (AV): Network / Adjacent / Local / Physical      â”‚
â”‚  â”œâ”€â”€ Attack Complexity (AC): Low / High                              â”‚
â”‚  â”œâ”€â”€ Privileges Required (PR): None / Low / High                    â”‚
â”‚  â”œâ”€â”€ User Interaction (UI): None / Required                          â”‚
â”‚  â”œâ”€â”€ Scope (S): Unchanged / Changed                                  â”‚
â”‚  â”œâ”€â”€ Confidentiality Impact (C): None / Low / High                  â”‚
â”‚  â”œâ”€â”€ Integrity Impact (I): None / Low / High                        â”‚
â”‚  â””â”€â”€ Availability Impact (A): None / Low / High                     â”‚
â”‚                                                                      â”‚
â”‚  TEMPORAL METRICS (ì‹œê°„ì— ë”°ë¼ ë³€í•˜ëŠ” ê²ƒ)                            â”‚
â”‚  â”œâ”€â”€ Exploit Code Maturity: Not Defined / Unproven / PoC /          â”‚
â”‚  â”‚                          Functional / High                        â”‚
â”‚  â”œâ”€â”€ Remediation Level: Not Defined / Official Fix / Temp Fix /     â”‚
â”‚  â”‚                      Workaround / Unavailable                    â”‚
â”‚  â””â”€â”€ Report Confidence: Not Defined / Unknown / Reasonable /        â”‚
â”‚                         Confirmed                                   â”‚
â”‚                                                                      â”‚
â”‚  ENVIRONMENTAL METRICS (ì¡°ì§ë³„ íŠ¹ì„±)                                 â”‚
â”‚  â”œâ”€â”€ ìˆ˜ì •ëœ Base ë©”íŠ¸ë¦­ (í™˜ê²½ì— ë§ê²Œ ì¡°ì •)                          â”‚
â”‚  â””â”€â”€ Security Requirements (CR, IR, AR): Low / Medium / High       â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì ìˆ˜ ë²”ìœ„:
  0.0        = ì—†ìŒ
  0.1 - 3.9  = Low
  4.0 - 6.9  = Medium
  7.0 - 8.9  = High
  9.0 - 10.0 = Critical
</code></pre></div>

<h3 id="102-cvss">10.2 CVSS ì ìˆ˜ ê³„ì‚°ê¸°<a class="header-link" href="#102-cvss" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CVSSv31</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplified CVSS v3.1 Base Score calculator.</span>
<span class="sd">    Reference: https://www.first.org/cvss/v3.1/specification-document</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Attack Vector</span>
    <span class="n">attack_vector</span><span class="p">:</span> <span class="nb">str</span>       <span class="c1"># N(etwork), A(djacent), L(ocal), P(hysical)</span>
    <span class="c1"># Attack Complexity</span>
    <span class="n">attack_complexity</span><span class="p">:</span> <span class="nb">str</span>   <span class="c1"># L(ow), H(igh)</span>
    <span class="c1"># Privileges Required</span>
    <span class="n">privileges_required</span><span class="p">:</span> <span class="nb">str</span> <span class="c1"># N(one), L(ow), H(igh)</span>
    <span class="c1"># User Interaction</span>
    <span class="n">user_interaction</span><span class="p">:</span> <span class="nb">str</span>    <span class="c1"># N(one), R(equired)</span>
    <span class="c1"># Scope</span>
    <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span>               <span class="c1"># U(nchanged), C(hanged)</span>
    <span class="c1"># Impact</span>
    <span class="n">confidentiality</span><span class="p">:</span> <span class="nb">str</span>     <span class="c1"># N(one), L(ow), H(igh)</span>
    <span class="n">integrity</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># N(one), L(ow), H(igh)</span>
    <span class="n">availability</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># N(one), L(ow), H(igh)</span>

    <span class="c1"># Metric value lookups</span>
    <span class="n">AV_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mf">0.62</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">}</span>
    <span class="n">AC_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.77</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.44</span><span class="p">}</span>
    <span class="n">PR_VALUES_UNCHANGED</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.62</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.27</span><span class="p">}</span>
    <span class="n">PR_VALUES_CHANGED</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.68</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">}</span>
    <span class="n">UI_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span> <span class="mf">0.62</span><span class="p">}</span>
    <span class="n">IMPACT_VALUES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">0.00</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">0.22</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">0.56</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vector_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CVSS:3.1/AV:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_vector</span><span class="si">}</span><span class="s2">/AC:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_complexity</span><span class="si">}</span><span class="s2">/&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;PR:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">privileges_required</span><span class="si">}</span><span class="s2">/UI:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">user_interaction</span><span class="si">}</span><span class="s2">/&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;S:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="si">}</span><span class="s2">/C:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">confidentiality</span><span class="si">}</span><span class="s2">/&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;I:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">integrity</span><span class="si">}</span><span class="s2">/A:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">availability</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_exploitability_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">av</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AV_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_vector</span><span class="p">]</span>
        <span class="n">ac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AC_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_complexity</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
            <span class="n">pr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PR_VALUES_CHANGED</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">privileges_required</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PR_VALUES_UNCHANGED</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">privileges_required</span><span class="p">]</span>

        <span class="n">ui</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UI_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">user_interaction</span><span class="p">]</span>
        <span class="k">return</span> <span class="mf">8.22</span> <span class="o">*</span> <span class="n">av</span> <span class="o">*</span> <span class="n">ac</span> <span class="o">*</span> <span class="n">pr</span> <span class="o">*</span> <span class="n">ui</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_impact_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMPACT_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">confidentiality</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMPACT_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">integrity</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMPACT_VALUES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">availability</span><span class="p">]</span>

        <span class="n">iss</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">6.42</span> <span class="o">*</span> <span class="n">iss</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">7.52</span> <span class="o">*</span> <span class="p">(</span><span class="n">iss</span> <span class="o">-</span> <span class="mf">0.029</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.25</span> <span class="o">*</span> <span class="p">((</span><span class="n">iss</span> <span class="o">-</span> <span class="mf">0.02</span><span class="p">)</span> <span class="o">**</span> <span class="mi">15</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">base_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">impact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_impact_score</span><span class="p">()</span>
        <span class="n">exploitability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exploitability_score</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">impact</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">impact</span> <span class="o">+</span> <span class="n">exploitability</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.08</span> <span class="o">*</span> <span class="p">(</span><span class="n">impact</span> <span class="o">+</span> <span class="n">exploitability</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Round up to nearest 0.1</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">score</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">severity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;NONE&quot;</span>
        <span class="k">elif</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="mf">3.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;LOW&quot;</span>
        <span class="k">elif</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="mf">6.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;MEDIUM&quot;</span>
        <span class="k">elif</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="mf">8.9</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HIGH&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;CRITICAL&quot;</span>

<span class="c1"># Example: Log4Shell (CVE-2021-44228)</span>
<span class="n">log4shell</span> <span class="o">=</span> <span class="n">CVSSv31</span><span class="p">(</span>
    <span class="n">attack_vector</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>      <span class="c1"># Network - remotely exploitable</span>
    <span class="n">attack_complexity</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>   <span class="c1"># Low - trivial to exploit</span>
    <span class="n">privileges_required</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="c1"># None - no auth needed</span>
    <span class="n">user_interaction</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>    <span class="c1"># None - no user action needed</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>               <span class="c1"># Changed - can affect other components</span>
    <span class="n">confidentiality</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>     <span class="c1"># High - full read access</span>
    <span class="n">integrity</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>           <span class="c1"># High - full write access</span>
    <span class="n">availability</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>        <span class="c1"># High - can crash/DoS</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Log4Shell (CVE-2021-44228)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vector: </span><span class="si">{</span><span class="n">log4shell</span><span class="o">.</span><span class="n">vector_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:  </span><span class="si">{</span><span class="n">log4shell</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating: </span><span class="si">{</span><span class="n">log4shell</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Example: A less severe vulnerability (local privilege escalation)</span>
<span class="n">local_vuln</span> <span class="o">=</span> <span class="n">CVSSv31</span><span class="p">(</span>
    <span class="n">attack_vector</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>      <span class="c1"># Local - requires local access</span>
    <span class="n">attack_complexity</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>   <span class="c1"># High - specific conditions needed</span>
    <span class="n">privileges_required</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="c1"># Low - needs basic user account</span>
    <span class="n">user_interaction</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>    <span class="c1"># None</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;U&quot;</span><span class="p">,</span>               <span class="c1"># Unchanged</span>
    <span class="n">confidentiality</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>     <span class="c1"># High</span>
    <span class="n">integrity</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>           <span class="c1"># High</span>
    <span class="n">availability</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>        <span class="c1"># None</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Local Privilege Escalation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vector: </span><span class="si">{</span><span class="n">local_vuln</span><span class="o">.</span><span class="n">vector_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:  </span><span class="si">{</span><span class="n">local_vuln</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating: </span><span class="si">{</span><span class="n">local_vuln</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Example: Low severity (reflected XSS requiring user interaction)</span>
<span class="n">xss_vuln</span> <span class="o">=</span> <span class="n">CVSSv31</span><span class="p">(</span>
    <span class="n">attack_vector</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
    <span class="n">attack_complexity</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="n">privileges_required</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
    <span class="n">user_interaction</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">,</span>    <span class="c1"># Requires user to click a link</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>               <span class="c1"># Can affect other origins</span>
    <span class="n">confidentiality</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>     <span class="c1"># Low - can steal some data</span>
    <span class="n">integrity</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span>           <span class="c1"># Low - can modify some page content</span>
    <span class="n">availability</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>        <span class="c1"># None</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reflected XSS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vector: </span><span class="si">{</span><span class="n">xss_vuln</span><span class="o">.</span><span class="n">vector_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Score:  </span><span class="si">{</span><span class="n">xss_vuln</span><span class="o">.</span><span class="n">base_score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rating: </span><span class="si">{</span><span class="n">xss_vuln</span><span class="o">.</span><span class="n">severity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="11">11. ì¢…í•© ì˜ˆì œ<a class="header-link" href="#11" title="Permanent link">&para;</a></h2>
<p>ê°€ìƒì˜ ì˜¨ë¼ì¸ ë±…í‚¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ì™„ì „í•œ ë³´ì•ˆ ë¶„ì„ì„ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<h3 id="111">11.1 ì‹œìŠ¤í…œ ì„¤ëª…<a class="header-link" href="#111" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì˜¨ë¼ì¸ ë±…í‚¹ ì‹œìŠ¤í…œ                                â”‚
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTPS     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     gRPC     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Mobile   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   API     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Accountâ”‚ â”‚
â”‚   â”‚ App      â”‚               â”‚  Gateway  â”‚             â”‚ Serviceâ”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTPS     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”     gRPC     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Web      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   Auth    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚Transferâ”‚ â”‚
â”‚   â”‚ Browser  â”‚               â”‚  Service  â”‚             â”‚Service â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Admin    â”‚ â”€â”€ VPN â”€â”€â”€â”€â”€â”€â–¶â”‚  Admin    â”‚ â”€â”€ SQL â”€â”€â”€â”€â–¶â”‚  DB    â”‚ â”‚
â”‚   â”‚ Console  â”‚               â”‚  Portal   â”‚              â”‚(PgSQL) â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="112-stride">11.2 STRIDE ìœ„í˜‘ ìš”ì•½<a class="header-link" href="#112-stride" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>ìœ„í˜‘</th>
<th>ë²”ì£¼</th>
<th>CIA ì˜í–¥</th>
<th>DREAD ì ìˆ˜</th>
<th>ì™„í™”</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>ë„ë‚œë‹¹í•œ ì„¸ì…˜ í† í° ì¬ì‚¬ìš©</td>
<td>Spoofing</td>
<td>C</td>
<td>7.2</td>
<td>ì§§ì€ ìˆ˜ëª…ì˜ JWT, í† í° ë°”ì¸ë”©</td>
</tr>
<tr>
<td>T2</td>
<td>ìˆ˜ì •ëœ ì´ì²´ ê¸ˆì•¡</td>
<td>Tampering</td>
<td>I</td>
<td>8.0</td>
<td>ìš”ì²­ ì„œëª…, ì„œë²„ ê²€ì¦</td>
</tr>
<tr>
<td>T3</td>
<td>ì‚¬ìš©ìê°€ ì´ì²´ ë¶€ì¸</td>
<td>Repudiation</td>
<td>Non-rep</td>
<td>5.4</td>
<td>ì„œëª…ëœ ê°ì‚¬ ë¡œê·¸, ë””ì§€í„¸ ì˜ìˆ˜ì¦</td>
</tr>
<tr>
<td>T4</td>
<td>ê³„ì¢Œ ë²ˆí˜¸ ìœ ì¶œ</td>
<td>Info Disc.</td>
<td>C</td>
<td>7.8</td>
<td>ì €ì¥ ë°ì´í„° ì•”í˜¸í™”, í•„ë“œ ë§ˆìŠ¤í‚¹</td>
</tr>
<tr>
<td>T5</td>
<td>API ê²Œì´íŠ¸ì›¨ì´ì— ëŒ€í•œ DDoS</td>
<td>DoS</td>
<td>A</td>
<td>6.2</td>
<td>CDN, rate limiting, ìë™ ìŠ¤ì¼€ì¼ë§</td>
</tr>
<tr>
<td>T6</td>
<td>ê´€ë¦¬ìê°€ ìŠˆí¼ ê´€ë¦¬ìë¡œ ìƒìŠ¹</td>
<td>Elev. Priv</td>
<td>Auth</td>
<td>8.6</td>
<td>RBAC, ìŠ¹ì¸ ì›Œí¬í”Œë¡œ, MFA</td>
</tr>
</tbody>
</table>
<h3 id="113-defense-in-depth">11.3 ì ìš©ëœ Defense in Depth<a class="header-link" href="#113-defense-in-depth" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Layer 1 - ì •ì±…:     ë³´ì•ˆ êµìœ¡, ì‚¬ê³  ëŒ€ì‘ ê³„íš
Layer 2 - ë¬¼ë¦¬ì :    ìƒì²´ ì¸ì¦ ì ‘ê·¼ì´ ìˆëŠ” ë°ì´í„° ì„¼í„°
Layer 3 - ê²½ê³„:     CDN/WAF, DDoS ë³´í˜¸, ê´€ë¦¬ììš© VPN
Layer 4 - ë„¤íŠ¸ì›Œí¬:  VLAN ì„¸ê·¸ë¨¼í…Œì´ì…˜, ì„œë¹„ìŠ¤ ê°„ mTLS
Layer 5 - í˜¸ìŠ¤íŠ¸:    ê°•í™”ëœ OS, ìë™ íŒ¨ì¹­, EDR ì—ì´ì „íŠ¸
Layer 6 - ì• í”Œë¦¬ì¼€ì´ì…˜:  ì…ë ¥ ê²€ì¦, CSRF í† í°, CSP í—¤ë”
Layer 7 - ë°ì´í„°:    ì €ì¥ ë°ì´í„° AES-256 ì•”í˜¸í™”, ì „ì†¡ ì¤‘ TLS 1.3
</code></pre></div>

<h3 id="114">11.4 ì ìš©ëœ ìµœì†Œ ê¶Œí•œ<a class="header-link" href="#114" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nt">Mobile</span><span class="w"> </span><span class="nt">App</span><span class="o">:</span><span class="w">     </span><span class="nt">API</span><span class="w"> </span><span class="nt">Gatewayë§Œ</span><span class="w"> </span><span class="nt">í˜¸ì¶œ</span><span class="w"> </span><span class="nt">ê°€ëŠ¥</span><span class="w"> </span><span class="o">(</span><span class="nt">ìì‹ ì˜</span><span class="w"> </span><span class="nt">ê³„ì •</span><span class="w"> </span><span class="nt">ì½ê¸°</span><span class="o">,</span><span class="w"> </span><span class="nt">ì´ì²´</span><span class="w"> </span><span class="nt">ì‹œì‘</span><span class="o">)</span>
<span class="nt">API</span><span class="w"> </span><span class="nt">Gateway</span><span class="o">:</span><span class="w">    </span><span class="nt">Auth</span><span class="w"> </span><span class="nt">ë°</span><span class="w"> </span><span class="nt">Account</span><span class="w"> </span><span class="nt">ì„œë¹„ìŠ¤ë¡œ</span><span class="w"> </span><span class="nt">ë¼ìš°íŒ…</span><span class="o">;</span><span class="w"> </span><span class="nt">ì§ì ‘</span><span class="w"> </span><span class="nt">DB</span><span class="w"> </span><span class="nt">ì ‘ê·¼</span><span class="w"> </span><span class="nt">ì—†ìŒ</span>
<span class="nt">Auth</span><span class="w"> </span><span class="nt">Service</span><span class="o">:</span><span class="w">   </span><span class="nt">users</span><span class="w"> </span><span class="nt">í…Œì´ë¸”</span><span class="w"> </span><span class="nt">ì½ê¸°</span><span class="w"> </span><span class="nt">ì „ìš©</span><span class="o">;</span><span class="w"> </span><span class="nt">sessions</span><span class="w"> </span><span class="nt">í…Œì´ë¸”</span><span class="w"> </span><span class="nt">ì“°ê¸°</span><span class="w"> </span><span class="nt">ì „ìš©</span>
<span class="nt">Account</span><span class="w"> </span><span class="nt">Svc</span><span class="o">:</span><span class="w">    </span><span class="nt">accounts</span><span class="w"> </span><span class="nt">í…Œì´ë¸”</span><span class="w"> </span><span class="nt">ì½ê¸°</span><span class="o">/</span><span class="nt">ì“°ê¸°</span><span class="o">;</span><span class="w"> </span><span class="nt">users</span><span class="w"> </span><span class="nt">ì ‘ê·¼</span><span class="w"> </span><span class="nt">ì—†ìŒ</span>
<span class="nt">Transfer</span><span class="w"> </span><span class="nt">Svc</span><span class="o">:</span><span class="w">   </span><span class="nt">transfers</span><span class="w"> </span><span class="nt">í…Œì´ë¸”</span><span class="w"> </span><span class="nt">ì‚½ì…</span><span class="w"> </span><span class="nt">ì „ìš©</span><span class="o">;</span><span class="w"> </span><span class="nt">accounts</span><span class="w"> </span><span class="nt">ì½ê¸°</span>
<span class="nt">Admin</span><span class="w"> </span><span class="nt">Portal</span><span class="o">:</span><span class="w">   </span><span class="nt">VPNì„</span><span class="w"> </span><span class="nt">í†µí•´ì„œë§Œ</span><span class="w"> </span><span class="nt">ì ‘ê·¼</span><span class="w"> </span><span class="nt">ê°€ëŠ¥</span><span class="o">;</span><span class="w"> </span><span class="nt">MFA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">ê´€ë¦¬ì</span><span class="w"> </span><span class="nt">ìŠ¹ì¸</span><span class="w"> </span><span class="nt">í•„ìš”</span>
<span class="nt">Database</span><span class="o">:</span><span class="w">       </span><span class="nt">ì¸í„°ë„·</span><span class="w"> </span><span class="nt">ì ‘ê·¼</span><span class="w"> </span><span class="nt">ì—†ìŒ</span><span class="o">;</span><span class="w"> </span><span class="nt">ì„œë¹„ìŠ¤</span><span class="w"> </span><span class="nt">VPCë¡œë¶€í„°ë§Œ</span><span class="w"> </span><span class="nt">ì—°ê²°</span>
</code></pre></div>

<hr />
<h2 id="12">12. ì—°ìŠµ ë¬¸ì œ<a class="header-link" href="#12" title="Permanent link">&para;</a></h2>
<h3 id="1-cia">ì—°ìŠµ 1: CIA ë¶„ì„ (ì´ˆê¸‰)<a class="header-link" href="#1-cia" title="Permanent link">&para;</a></h3>
<p>ì•„ë˜ ê° ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•´ ì£¼ë¡œ ìœ„ë°˜ë˜ëŠ” CIA ì†ì„±ì„ ì‹ë³„í•˜ê³  ì´ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆëŠ” ì œì–´ë¥¼ ì œì‹œí•˜ì„¸ìš”:</p>
<ol>
<li>ë³‘ì›ì˜ ì „ì ê±´ê°• ê¸°ë¡ ì‹œìŠ¤í…œì´ ëœì„¬ì›¨ì–´ ê³µê²©ìœ¼ë¡œ ì˜¤í”„ë¼ì¸ ìƒíƒœì…ë‹ˆë‹¤.</li>
<li>í•´ì»¤ê°€ ì „ììƒê±°ë˜ ë°ì´í„°ë² ì´ìŠ¤ì˜ í•­ëª© ê°€ê²©ì„ $99ì—ì„œ $0.01ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.</li>
<li>ì§ì›ì´ ê³ ê° ì‚¬íšŒë³´ì¥ë²ˆí˜¸ê°€ ë‹´ê¸´ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ ê°œì¸ ì´ë©”ì¼ë¡œ ë³´ëƒ…ë‹ˆë‹¤.</li>
<li>DNS ë ˆì½”ë“œê°€ ìˆ˜ì •ë˜ì–´ ì€í–‰ ê³ ê°ì´ í”¼ì‹± ì‚¬ì´íŠ¸ë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.</li>
<li>ë¶ˆë§Œì„ í’ˆì€ ì§ì›ì´ í”„ë¡œë•ì…˜ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…ì„ ì‚­ì œí•©ë‹ˆë‹¤.</li>
</ol>
<h3 id="2-stride-threat-model">ì—°ìŠµ 2: STRIDE Threat Model (ì¤‘ê¸‰)<a class="header-link" href="#2-stride-threat-model" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ êµ¬ì„± ìš”ì†Œë¥¼ ê°€ì§„ ìŒì‹ ë°°ë‹¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ Data Flow Diagramì„ ê·¸ë¦¬ì„¸ìš”:
- ê³ ê° ëª¨ë°”ì¼ ì•±
- ë ˆìŠ¤í† ë‘ ëŒ€ì‹œë³´ë“œ(ì›¹)
- API ì„œë²„
- ê²°ì œ ì²˜ë¦¬ê¸°(Stripe)
- ë°°ë‹¬ ì¶”ì  ì„œë¹„ìŠ¤
- PostgreSQL ë°ì´í„°ë² ì´ìŠ¤</p>
<p>STRIDEë¥¼ ì ìš©í•˜ì—¬ ìµœì†Œ 8ê°œì˜ ìœ„í˜‘ì„ ì‹ë³„í•˜ì„¸ìš”. ê° ìœ„í˜‘ì— ëŒ€í•´ ë‹¤ìŒì„ ëª…ì‹œí•˜ì„¸ìš”:
- STRIDE ë²”ì£¼
- ì˜í–¥ë°›ëŠ” DFD ìš”ì†Œ
- ì‹¬ê°ë„(DREAD ì ìˆ˜ ì‚¬ìš©)
- ìµœì†Œ í•œ ê°€ì§€ ì™„í™”</p>
<h3 id="3-cvss">ì—°ìŠµ 3: CVSS ì ìˆ˜í™” (ì¤‘ê¸‰)<a class="header-link" href="#3-cvss" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ ì·¨ì•½ì ì— ëŒ€í•œ CVSS v3.1 ê¸°ë³¸ ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ì„¸ìš”:</p>
<ol>
<li>
<p>ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ URL íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì‘í•˜ì—¬ ì„œë²„ì˜ ëª¨ë“  íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤(path traversal). ì‚¬ìš©ì ìƒí˜¸ì‘ìš©ì€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p>ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜ì— íŠ¹ë³„íˆ ì œì‘ëœ íŒŒì¼ì„ ì—´ë©´ íŠ¸ë¦¬ê±°ë  ìˆ˜ ìˆëŠ” ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ìˆìŠµë‹ˆë‹¤. ê³µê²©ìëŠ” í”¼í•´ìê°€ íŒŒì¼ì„ ì—´ì–´ì•¼ í•˜ë©°, ì„±ê³µì ì¸ ìµìŠ¤í”Œë¡œì‡ì€ ê³µê²©ìì—ê²Œ í”¼í•´ìì™€ ë™ì¼í•œ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p>API ì—”ë“œí¬ì¸íŠ¸ê°€ ì¸ì¦ì„ ìš”êµ¬í•˜ì§€ë§Œ ì¸ì¦ëœ ì‚¬ìš©ìê°€ ìš”ì²­ëœ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤(IDOR). ë™ì¼í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì˜ ë°ì´í„°ë§Œ ì˜í–¥ì„ ë°›ìŠµë‹ˆë‹¤.</p>
</li>
</ol>
<h3 id="4-defense-in-depth">ì—°ìŠµ 4: Defense in Depth ì„¤ê³„ (ê³ ê¸‰)<a class="header-link" href="#4-defense-in-depth" title="Permanent link">&para;</a></h3>
<p>ì‹ ìš©ì¹´ë“œ ê²°ì œë¥¼ ì²˜ë¦¬í•˜ëŠ” ìŠ¤íƒ€íŠ¸ì—…ì˜ ë³´ì•ˆ ì•„í‚¤í…ì²˜ë¥¼ ì„¤ê³„í•˜ê³  ìˆìŠµë‹ˆë‹¤. í˜„ì¬ ê·¸ë“¤ì€:
- ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ëª¨ë‘ ì‹¤í–‰í•˜ëŠ” ë‹¨ì¼ ì›¹ ì„œë²„
- ì €ì¥ ë°ì´í„° ì•”í˜¸í™” ì—†ìŒ
- ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ìœ¼ë¡œ SSHë¥¼ í†µí•œ ê´€ë¦¬ì ì ‘ê·¼
- ë¡œê¹… ë˜ëŠ” ëª¨ë‹ˆí„°ë§ ì—†ìŒ
- ëª¨ë“  ì§ì›ì´ í•˜ë‚˜ì˜ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ê³µìœ </p>
<p>7ê³„ì¸µ defense-in-depth ì „ëµì„ ì„¤ê³„í•˜ì„¸ìš”. ê° ê³„ì¸µì— ëŒ€í•´ ë‹¤ìŒì„ ëª…ì‹œí•˜ì„¸ìš”:
- ìµœì†Œ 2ê°œì˜ êµ¬ì²´ì ì¸ ì œì–´
- ê° ì œì–´ê°€ ì™„í™”í•˜ëŠ” ìœ„í˜‘
- ìš°ì„ ìˆœìœ„(ì²« ë²ˆì§¸/ë‘ ë²ˆì§¸/ì„¸ ë²ˆì§¸ êµ¬í˜„)</p>
<h3 id="5_1">ì—°ìŠµ 5: ìµœì†Œ ê¶Œí•œ ê°ì‚¬ (ê³ ê¸‰)<a class="header-link" href="#5_1" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ AWS IAM ì •ì±…ì—ì„œ ìµœì†Œ ê¶Œí•œì˜ ëª¨ë“  ìœ„ë°˜ ì‚¬í•­ì„ ì‹ë³„í•˜ê³  ì ì ˆí•˜ê²Œ ë²”ìœ„ê°€ ì§€ì •ë˜ë„ë¡ ë‹¤ì‹œ ì‘ì„±í•˜ì„¸ìš”:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Statement&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s3:*&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;ec2:*&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;rds:*&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;iam:*&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>ì»¨í…ìŠ¤íŠ¸: ì´ ì •ì±…ì€ ë‹¤ìŒì´ í•„ìš”í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°±ì—”ë“œë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤:
- ë‹¨ì¼ S3 ë²„í‚·(<code>my-app-uploads</code>)ì—ì„œ íŒŒì¼ ì½ê¸° ë° ì“°ê¸°
- RDS PostgreSQL ì¸ìŠ¤í„´ìŠ¤(<code>my-app-db</code>)ì—ì„œ ì½ê¸°
- EC2 ê´€ë¦¬ í•„ìš” ì—†ìŒ(ECSì—ì„œ ì‹¤í–‰)
- IAM ê´€ë¦¬ í•„ìš” ì—†ìŒ</p>
<h3 id="6-security-by-design">ì—°ìŠµ 6: Security by Design ê²€í†  (ê³ ê¸‰)<a class="header-link" href="#6-security-by-design" title="Permanent link">&para;</a></h3>
<p>ë‹¤ìŒ Flask ì½”ë“œë¥¼ ê²€í† í•˜ê³  ëª¨ë“  ë³´ì•ˆ ë¬¸ì œë¥¼ ì‹ë³„í•˜ì„¸ìš”. security-by-design ì›ì¹™ì— ë”°ë¼ ë‹¤ì‹œ ì‘ì„±í•˜ì„¸ìš”:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>

    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;users.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">password_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE username=&#39;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39; AND password=&#39;</span><span class="si">{</span><span class="n">password_hash</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="mi">3</span><span class="p">]})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;failed&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;No user found with username </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/admin/delete_user/&lt;user_id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">delete_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;users.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DELETE FROM users WHERE id=</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;deleted&quot;</span><span class="p">})</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">)</span>
</code></pre></div>

<p>ìµœì†Œ 10ê°œì˜ ë³´ì•ˆ ë¬¸ì œë¥¼ ì‹ë³„í•˜ê³  ìˆ˜ì •ëœ ì½”ë“œë¥¼ ì œê³µí•˜ì„¸ìš”.</p>
<hr />
<h2 id="13">13. ì°¸ê³  ìë£Œ<a class="header-link" href="#13" title="Permanent link">&para;</a></h2>
<ul>
<li>Anderson, R. (2020). <em>Security Engineering</em>, 3rd Edition. Wiley.</li>
<li>Shostack, A. (2014). <em>Threat Modeling: Designing for Security</em>. Wiley.</li>
<li>OWASP Threat Modeling - https://owasp.org/www-community/Threat_Modeling</li>
<li>NIST SP 800-30: Guide for Conducting Risk Assessments</li>
<li>NIST SP 800-37: Risk Management Framework</li>
<li>FIRST CVSS v3.1 Specification - https://www.first.org/cvss/v3.1/specification-document</li>
<li>Microsoft STRIDE - https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool-threats</li>
</ul>
<hr />
<h2 id="_2">ë‹¤ìŒ ë ˆìŠ¨<a class="header-link" href="#_2" title="Permanent link">&para;</a></h2>
<p><a href="./02_Cryptography_Basics.md">02. Cryptography ê¸°ì´ˆ</a>ì—ì„œëŠ” ëŒ€ì¹­ ë° ë¹„ëŒ€ì¹­ ì•”í˜¸í™”, í‚¤ êµí™˜, ë””ì§€í„¸ ì„œëª…ì„ ì‹¤ìš©ì ì¸ Python ì˜ˆì œì™€ í•¨ê»˜ ë‹¤ë£¹ë‹ˆë‹¤.</p>
    </div>

    
<div class="lesson-toolbar lesson-toolbar--bottom">
    <div class="toolbar-nav toolbar-nav--prev">
        
        <a href="/study/ko/Security/00_Overview.html" class="nav-prev">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Security</span>
        </a>
        
    </div>
    <div class="toolbar-actions">
        <button class="btn btn-copy-link" data-action="copy-link" title="Copy link">
            <span class="icon">ğŸ”—</span>
            <span class="text">Copy link</span>
        </button>
        <a href="/study/ko/Security/" class="btn btn-topic-link" title="Back to topic list">
            <span class="icon">ğŸ“‹</span>
            <span class="text">Topic list</span>
        </a>
    </div>
    <div class="toolbar-nav toolbar-nav--next">
        
        <a href="/study/ko/Security/02_Cryptography_Basics.html" class="nav-next">
            <span class="nav-label">Next</span>
            <span class="nav-title">Cryptography ê¸°ì´ˆ</span>
        </a>
        
    </div>
</div>


    <div class="toolbar-keyboard-hint">
        <kbd>&larr;</kbd> <kbd>&rarr;</kbd> to navigate between lessons
    </div>
</article>

<!-- Scroll to top floating button -->
<button class="scroll-to-top" id="scroll-to-top" title="Scroll to top" aria-label="Scroll to top">â†‘</button>

            </div>
        </main>
    </div>

    <script src="/study/static/js/app.js"></script>
    <script>
        function switchLanguage(newLang) {
            const path = window.location.pathname;
            const base = '/study';
            const currentLang = 'ko';
            const newPath = path.replace(base + '/' + currentLang + '/', base + '/' + newLang + '/');
            window.location.href = newPath + window.location.search;
        }
    </script>
    
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy link - independent feedback per button
        document.querySelectorAll('[data-action="copy-link"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href);
                var textEl = this.querySelector('.text');
                var originalText = textEl.textContent;
                textEl.textContent = 'Copied!';
                setTimeout(function() { textEl.textContent = originalText; }, 2000);
            });
        });

        // Add copy buttons to code blocks
        document.querySelectorAll('.lesson-content pre').forEach(function(pre) {
            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.addEventListener('click', function() {
                var code = pre.querySelector('code');
                var text = code ? code.textContent : pre.textContent;
                navigator.clipboard.writeText(text);
                copyBtn.textContent = 'Copied!';
                setTimeout(function() { copyBtn.textContent = 'Copy'; }, 2000);
            });
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
        });

        // Scroll to top button
        var scrollBtn = document.getElementById('scroll-to-top');
        window.addEventListener('scroll', function() {
            scrollBtn.classList.toggle('visible', window.scrollY > 300);
        });
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Keyboard shortcuts: left/right arrows for lesson navigation
        document.addEventListener('keydown', function(e) {
            var tag = document.activeElement.tagName;
            if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;

            if (e.key === 'ArrowLeft') {
                var prevLink = document.querySelector('.nav-prev');
                if (prevLink) prevLink.click();
            } else if (e.key === 'ArrowRight') {
                var nextLink = document.querySelector('.nav-next');
                if (nextLink) nextLink.click();
            }
        });
    });
</script>

</body>
</html>
{% endraw %}